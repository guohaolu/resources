WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/view-in-jira.js' */
AJS.bind("add-handler.property-panel",function(k,g){AJS.log("add-handler.property-panel: panel name \x3d "+g.name);"macro"==g.name&&g.registerButtonHandler("view-in-jira",function(a,c){if(AJS.Editor.JiraConnector.servers){a=AJS.Editor.JiraConnector.servers;c=AJS.$(c);var b=c.attr("data-macro-default-parameter");c=c.attr("data-macro-parameters")||"";var e=Confluence.MacroParameterSerializer.deserialize(c);(b=b||e.jqlQuery||e.key)||(b=c.indexOf("|"),b=0<=b?c.substring(0,b):c);c=b;b=e.server;var h=e.serverId;
e=c.match(/=|!=|~|>|<|!~| is | in /i);for(var f=null,d=0;d<a.length;d++){if(h&&a[d].id==h){f=a[d];break}if(b&&a[d].name==b||!b&&a[d].selected){f=a[d];break}}null!=f&&(a="undefined"!==typeof f.displayUrl?f.displayUrl:f.url,"/"==a.charAt(a.length-1)&&(a=a.substr(0,a.length-1)),b=tinymce.isIE?"_blank":"confluence-goto-jiralink-"+AJS.params.pageId,(e?window.open(a+"/secure/IssueNavigator.jspa?reset\x3dtrue\x26jqlQuery\x3d"+encodeURIComponent(c),b):window.open(a+"/browse/"+encodeURIComponent(c),b)).opener=
null)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/show-summary.js' */
AJS.bind("init.rte",function(){function a(b,d,e){if(e=AJS.$.grep(d,function(f){return"show-summary"==f.parameterName})[0])c(b)?"false"==AJS.SummaryHelper.getParam(b,"showSummary")?e.text="\u663e\u793a\u6c47\u603b":e.text="\u9690\u85cf\u6c47\u603b":e.className+=" hidden";else{AJS.logError("Jira Issues Macro - Show-summary : The system cannot find SummaryButton, all buttons are: ");for(var g in d)AJS.logError(d[g].text)}}function c(b){var d=
AJS.$(b).attr("src");if(!d)return!0;b=AJS.SummaryHelper.getParam(b,"count");return-1==d.indexOf("confluence.extra.jira/jira-table")&&"true"!=b?!0:!1}AJS.Confluence||AJS.Confluence.PropertyPanel||AJS.Confluence.PropertyPanel.Macro?(AJS.Confluence.PropertyPanel.Macro.registerInitHandler(a,"jira"),AJS.Confluence.PropertyPanel.Macro.registerInitHandler(a,"jiraissues")):AJS.logError("Jira Issues Macro : can't register property panel init handler since AJS.Confluence.PropertyPanel.Macro is undefined")});
AJS.bind("add-handler.property-panel",function(a,c){"macro"==c.name&&c.registerButtonHandler("show-summary",function(b,d){b=AJS.SummaryHelper.getParam(d,"showSummary");AJS.SummaryHelper.updateMacro("jira",d,"showSummary","false"==b?"true":"false")})});
AJS.SummaryHelper=function(){return{getCurrentParams:function(a){return Confluence.MacroParameterSerializer.deserialize(a.attr("data-macro-parameters"))},getParam:function(a,c){a=AJS.$(a);return AJS.SummaryHelper.getCurrentParams(a)[c]},updateMacro:function(a,c,b,d){c=AJS.$(c);AJS.Rte.getEditor().selection.select(c[0]);AJS.Rte.BookmarkManager.storeBookmark();var e=AJS.SummaryHelper.getCurrentParams(c);e[b]=d;a={contentId:Confluence.Editor.getContentId(),macro:{name:a,params:e,defaultParameterValue:c.attr("data-macro-default-parameter")}};
tinymce.confluence.MacroUtils.insertMacro(a)}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:lodash', location = '/custom-lodash/custom-lodash.js' */
/*

 Lodash (Custom Build) <https://lodash.com/>
 Build: `lodash include="bind,map,groupBy,compact,uniq,has,each,extend,filter,reject,bindAll,without,debounce,difference,forEach,take,find,chain,some,values,reduce" moduleId="jira-integration-plugin/custom-lodash"`
 Copyright JS Foundation and other contributors <https://js.foundation/>
 Released under MIT license <https://lodash.com/license>
 Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/
(function(){function va(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function Ic(a,b,c,d){for(var e=-1,g=null==a?0:a.length;++e<g;){var m=a[e];b(d,m,c(m),a)}return d}function C(a,b){for(var c=-1,d=null==a?0:a.length;++c<d&&!1!==b(a[c],c,a););return a}function wa(a,b){for(var c=-1,d=null==a?0:a.length,e=0,g=[];++c<d;){var m=a[c];b(m,c,a)&&(g[e++]=m)}return g}function Xa(a,b){var c;
if(c=!(null==a||!a.length)){if(b===b)a:{c=-1;for(var d=a.length;++c<d;)if(a[c]===b){a=c;break a}a=-1}else a=wb(a,Jc,0);c=-1<a}return c}function Kc(a,b,c){for(var d=-1,e=null==a?0:a.length;++d<e;)if(c(b,a[d]))return!0;return!1}function xa(a,b){for(var c=-1,d=null==a?0:a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function W(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}function xb(a,b,c,d){var e=-1,g=null==a?0:a.length;for(d&&g&&(c=a[++e]);++e<g;)c=b(c,a[e],e,a);return c}
function yb(a,b){for(var c=-1,d=null==a?0:a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function wb(a,b,c,d){var e=a.length;for(c+=d?1:-1;d?c--:++c<e;)if(b(a[c],c,a))return c;return-1}function Jc(a){return a!==a}function Lc(a){return function(b){return null==b?k:b[a]}}function Mc(a,b,c,d,e){e(a,function(a,e,h){c=d?(d=!1,a):b(c,a,e,h)});return c}function ya(a){return function(b){return a(b)}}function Nc(a,b){return xa(b,function(b){return a[b]})}function zb(a,b){return a.has(b)}function Ab(a){var b=
-1,c=Array(a.size);a.forEach(function(a,e){c[++b]=[e,a]});return c}function Bb(a,b){return function(c){return a(b(c))}}function da(a,b){for(var c=-1,d=a.length,e=0,g=[];++c<d;){var m=a[c];if(m===b||"__lodash_placeholder__"===m)a[c]="__lodash_placeholder__",g[e++]=c}return g}function za(a){var b=-1,c=Array(a.size);a.forEach(function(a){c[++b]=a});return c}function f(a){if(x(a)&&!v(a)&&!(a instanceof q)){if(a instanceof E)return a;if(w.call(a,"__wrapped__"))return Cb(a)}return new E(a)}function Aa(){}
function E(a,b){this.__wrapped__=a;this.__actions__=[];this.__chain__=!!b;this.__index__=0;this.__values__=k}function q(a){this.__wrapped__=a;this.__actions__=[];this.__dir__=1;this.__filtered__=!1;this.__iteratees__=[];this.__takeCount__=4294967295;this.__views__=[]}function P(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function J(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function K(a){var b=-1,c=null==
a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function X(a){var b=-1,c=null==a?0:a.length;for(this.__data__=new K;++b<c;)this.add(a[b])}function F(a){this.size=(this.__data__=new J(a)).size}function Db(a,b){var c=v(a),d=!c&&Ba(a),e=!c&&!d&&ea(a),g=!c&&!d&&!e&&Ya(a);if(c=c||d||e||g){d=a.length;for(var m=String,h=-1,n=Array(d);++h<d;)n[h]=m(h);d=n}else d=[];m=d.length;for(var f in a)!b&&!w.call(a,f)||c&&("length"==f||e&&("offset"==f||"parent"==f)||g&&("buffer"==f||"byteLength"==
f||"byteOffset"==f)||fa(f,m))||d.push(f);return d}function Eb(a,b,c){var d=a[b];w.call(a,b)&&ha(d,c)&&(c!==k||b in a)||Ca(a,b,c)}function Da(a,b){for(var c=a.length;c--;)if(ha(a[c][0],b))return c;return-1}function Oc(a,b,c,d){Y(a,function(a,g,m){b(d,a,c(a),m)});return d}function Pc(a,b){return a&&ia(b,G(b),a)}function Qc(a,b){return a&&ia(b,ja(b),a)}function Ca(a,b,c){"__proto__"==b&&Ea?Ea(a,b,{configurable:!0,enumerable:!0,value:c,writable:!0}):a[b]=c}function Fa(a,b,c,d,e,g){var m,h=b&1,n=b&2,f=
b&4;c&&(m=e?c(a,d,e,g):c(a));if(m!==k)return m;if(!y(a))return a;if(d=v(a)){if(m=Rc(a),!h)return M(a,m)}else{var l=A(a),p="[object Function]"==l||"[object GeneratorFunction]"==l;if(ea(a))return Sc(a,h);if("[object Object]"==l||"[object Arguments]"==l||p&&!e){if(m=n||p?{}:Tc(a),!h)return n?Uc(a,Qc(m,a)):Vc(a,Pc(m,a))}else{if(!t[l])return e?a:{};m=Wc(a,l,h)}}g||(g=new F);if(e=g.get(a))return e;g.set(a,m);if(Fb(a))return a.forEach(function(d){m.add(Fa(d,b,c,d,a,g))}),m;if(Gb(a))return a.forEach(function(d,
e){m.set(e,Fa(d,b,c,e,a,g))}),m;n=f?n?Xc:Za:n?ja:G;var r=d?k:n(a);C(r||a,function(d,e){r&&(e=d,d=a[e]);Eb(m,e,Fa(d,b,c,e,a,g))});return m}function Hb(a,b,c,d){var e=-1,g=Xa,m=!0,h=a.length,n=[],f=b.length;if(!h)return n;c&&(b=xa(b,ya(c)));d?(g=Kc,m=!1):200<=b.length&&(g=zb,m=!1,b=new X(b));a:for(;++e<h;){var l=a[e],k=null==c?l:c(l);l=d||0!==l?l:0;if(m&&k===k){for(var r=f;r--;)if(b[r]===k)continue a;n.push(l)}else g(b,k,d)||n.push(l)}return n}function Ib(a,b){var c=[];Y(a,function(a,e,g){b(a,e,g)&&
c.push(a)});return c}function $a(a,b,c,d,e){var g=-1,m=a.length;c||(c=Yc);for(e||(e=[]);++g<m;){var h=a[g];0<b&&c(h)?1<b?$a(h,b-1,c,d,e):W(e,h):d||(e[e.length]=h)}return e}function Ga(a,b){return a&&Zc(a,b,G)}function Jb(a,b){return wa(b,function(b){return ka(a[b])})}function ab(a,b){b=bb(b,a);for(var c=0,d=b.length;null!=a&&c<d;)a=a[Z(b[c++])];return c&&c==d?a:k}function Kb(a,b,c){b=b(a);return v(a)?b:W(b,c(a))}function Q(a){if(null==a)return a===k?"[object Undefined]":"[object Null]";if(R&&R in
Object(a)){var b=w.call(a,R),c=a[R];try{a[R]=k;var d=!0}catch(g){}var e=Lb.call(a);d&&(b?a[R]=c:delete a[R]);a=e}else a=Lb.call(a);return a}function $c(a,b){return null!=a&&w.call(a,b)}function ad(a,b){return null!=a&&b in Object(a)}function Mb(a){return x(a)&&"[object Arguments]"==Q(a)}function aa(a,b,c,d,e){if(a===b)return!0;if(null==a||null==b||!x(a)&&!x(b))return a!==a&&b!==b;a:{var g=v(a),m=v(b),h=g?"[object Array]":A(a),n=m?"[object Array]":A(b);h="[object Arguments]"==h?"[object Object]":h;
n="[object Arguments]"==n?"[object Object]":n;var f="[object Object]"==h;m="[object Object]"==n;if((n=h==n)&&ea(a)){if(!ea(b)){b=!1;break a}g=!0;f=!1}if(n&&!f)e||(e=new F),b=g||Ya(a)?Nb(a,b,c,d,aa,e):bd(a,b,h,c,d,aa,e);else{if(!(c&1)&&(g=f&&w.call(a,"__wrapped__"),h=m&&w.call(b,"__wrapped__"),g||h)){a=g?a.value():a;b=h?b.value():b;e||(e=new F);b=aa(a,b,c,d,e);break a}if(n)b:if(e||(e=new F),g=c&1,h=Za(a),m=h.length,n=Za(b).length,m==n||g){for(f=m;f--;){var l=h[f];if(!(g?l in b:w.call(b,l))){b=!1;break b}}if((n=
e.get(a))&&e.get(b))b=n==b;else{n=!0;e.set(a,b);e.set(b,a);for(var p=g;++f<m;){l=h[f];var r=a[l],q=b[l];if(d)var t=g?d(q,r,l,b,a,e):d(r,q,l,a,b,e);if(t===k?r!==q&&!aa(r,q,c,d,e):!t){n=!1;break}p||(p="constructor"==l)}n&&!p&&(c=a.constructor,d=b.constructor,c!=d&&"constructor"in a&&"constructor"in b&&!("function"==typeof c&&c instanceof c&&"function"==typeof d&&d instanceof d)&&(n=!1));e["delete"](a);e["delete"](b);b=n}}else b=!1;else b=!1}}return b}function cd(a){return x(a)&&"[object Map]"==A(a)}
function dd(a,b,c,d){var e=c.length,g=e,m=!d;if(null==a)return!g;for(a=Object(a);e--;){var h=c[e];if(m&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++e<g;){h=c[e];var f=h[0],z=a[f],l=h[1];if(m&&h[2]){if(z===k&&!(f in a))return!1}else{h=new F;if(d)var p=d(z,l,f,a,b,h);if(p===k?!aa(l,z,3,d,h):!p)return!1}}return!0}function ed(a){return x(a)&&"[object Set]"==A(a)}function fd(a){return x(a)&&Ha(a.length)&&!!u[Q(a)]}function Ob(a){return"function"==typeof a?a:null==a?ba:"object"==typeof a?v(a)?gd(a[0],
a[1]):hd(a):Pb(a)}function id(a,b){var c=-1,d=L(a)?Array(a.length):[];Y(a,function(a,g,m){d[++c]=b(a,g,m)});return d}function hd(a){var b=jd(a);return 1==b.length&&b[0][2]?Qb(b[0][0],b[0][1]):function(c){return c===a||dd(c,a,b)}}function gd(a,b){return cb(a)&&b===b&&!y(b)?Qb(Z(a),b):function(c){var d=db(c,a);return d===k&&d===b?Rb(c,a):aa(b,d,3)}}function kd(a){return function(b){return ab(b,a)}}function la(a,b){return eb(Sb(a,b,ba),a+"")}function Tb(a,b,c){var d=-1,e=a.length;0>b&&(b=-b>e?0:e+b);
c=c>e?e:c;0>c&&(c+=e);e=b>c?0:c-b>>>0;b>>>=0;for(c=Array(e);++d<e;)c[d]=a[d+b];return c}function ld(a,b){var c;Y(a,function(a,e,g){c=b(a,e,g);return!c});return!!c}function Ub(a){if("string"==typeof a)return a;if(v(a))return xa(a,Ub)+"";if(ma(a))return Vb?Vb.call(a):"";var b=a+"";return"0"==b&&1/a==-na?"-0":b}function Wb(a,b){a instanceof q&&(a=a.value());return xb(b,function(a,b){return b.func.apply(b.thisArg,W([a],b.args))},a)}function bb(a,b){return v(a)?a:cb(a,b)?[a]:md(Xb(a))}function Sc(a,b){if(b)return a.slice();
b=a.length;b=Yb?Yb(b):new a.constructor(b);a.copy(b);return b}function fb(a){var b=new a.constructor(a.byteLength);(new Ia(b)).set(new Ia(a));return b}function Zb(a,b,c,d){var e=-1,g=a.length,m=c.length,h=-1,f=b.length,k=H(g-m,0),l=Array(f+k);for(d=!d;++h<f;)l[h]=b[h];for(;++e<m;)if(d||e<g)l[c[e]]=a[e];for(;k--;)l[h++]=a[e++];return l}function $b(a,b,c,d){var e=-1,g=a.length,m=-1,h=c.length,f=-1,k=b.length,l=H(g-h,0),p=Array(l+k);for(d=!d;++e<l;)p[e]=a[e];for(l=e;++f<k;)p[l+f]=b[f];for(;++m<h;)if(d||
e<g)p[l+c[m]]=a[e++];return p}function M(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function ia(a,b,c,d){var e=!c;c||(c={});for(var g=-1,m=b.length;++g<m;){var h=b[g],f=d?d(c[h],a[h],h,c,a):k;f===k&&(f=a[h]);e?Ca(c,h,f):Eb(c,h,f)}return c}function Vc(a,b){return ia(a,gb(a),b)}function Uc(a,b){return ia(a,ac(a),b)}function nd(a,b,c){function d(){return(this&&this!==B&&this instanceof d?g:a).apply(e?c:this,arguments)}var e=b&1,g=oa(a);return d}function oa(a){return function(){var b=
arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=Ja(a.prototype);b=a.apply(c,b);return y(b)?b:c}}function od(a,b,c){function d(){for(var g=arguments.length,m=Array(g),h=g,f=hb(d);h--;)m[h]=arguments[h];h=3>g&&m[0]!==
f&&m[g-1]!==f?[]:da(m,f);g-=h.length;return g<c?bc(a,b,Ka,d.placeholder,k,m,h,k,k,c-g):va(this&&this!==B&&this instanceof d?e:a,this,m)}var e=oa(a);return d}function Ka(a,b,c,d,e,g,m,f,n,z){function h(){for(var l=arguments.length,r=Array(l),I=l;I--;)r[I]=arguments[I];if(v){var y=hb(h),x;I=r.length;for(x=0;I--;)r[I]===y&&++x}d&&(r=Zb(r,d,e,v));g&&(r=$b(r,g,m,v));l-=x;if(v&&l<z)return y=da(r,y),bc(a,b,Ka,h.placeholder,c,r,y,f,n,z-l);y=q?c:this;I=t?y[a]:a;l=r.length;if(f){x=r.length;for(var A=S(f.length,
x),D=M(r);A--;){var C=f[A];r[A]=fa(C,x)?D[C]:k}}else u&&1<l&&r.reverse();p&&n<l&&(r.length=n);this&&this!==B&&this instanceof h&&(I=w||oa(I));return I.apply(y,r)}var p=b&128,q=b&1,t=b&2,v=b&24,u=b&512,w=t?k:oa(a);return h}function pd(a,b,c,d){function e(){for(var b=-1,f=arguments.length,k=-1,l=d.length,p=Array(l+f),r=this&&this!==B&&this instanceof e?m:a;++k<l;)p[k]=d[k];for(;f--;)p[k++]=arguments[++b];return va(r,g?c:this,p)}var g=b&1,m=oa(a);return e}function bc(a,b,c,d,e,g,m,h,n,z){var l=b&8,p=
l?m:k;m=l?k:m;var r=l?g:k;g=l?k:g;b=(b|(l?32:64))&~(l?64:32);b&4||(b&=-4);e=[a,b,e,r,p,g,m,h,n,z];c=c.apply(k,e);b:for(h=a.name+"",n=pa[h],z=w.call(pa,h)?n.length:0;z--;)if(l=n[z],p=l.func,null==p||p==a){h=l.name;break b}n=f[h];"function"==typeof n&&h in q.prototype?a===n?h=!0:(h=cc(n),h=!!h&&a===h[0]):h=!1;h&&dc(c,e);c.placeholder=d;return ec(c,a,b)}function Nb(a,b,c,d,e,g){var m=c&1,f=a.length,n=b.length;if(f!=n&&!(m&&n>f))return!1;if((n=g.get(a))&&g.get(b))return n==b;n=-1;var z=!0,l=c&2?new X:
k;g.set(a,b);for(g.set(b,a);++n<f;){var p=a[n],r=b[n];if(d)var q=m?d(r,p,n,b,a,g):d(p,r,n,a,b,g);if(q!==k){if(q)continue;z=!1;break}if(l){if(!yb(b,function(a,b){if(!l.has(b)&&(p===a||e(p,a,c,d,g)))return l.push(b)})){z=!1;break}}else if(p!==r&&!e(p,r,c,d,g)){z=!1;break}}g["delete"](a);g["delete"](b);return z}function bd(a,b,c,d,e,g,f){switch(c){case "[object DataView]":if(a.byteLength!=b.byteLength||a.byteOffset!=b.byteOffset)break;a=a.buffer;b=b.buffer;case "[object ArrayBuffer]":if(a.byteLength!=
b.byteLength||!g(new Ia(a),new Ia(b)))break;return!0;case "[object Boolean]":case "[object Date]":case "[object Number]":return ha(+a,+b);case "[object Error]":return a.name==b.name&&a.message==b.message;case "[object RegExp]":case "[object String]":return a==b+"";case "[object Map]":var m=Ab;case "[object Set]":m||(m=za);if(a.size!=b.size&&!(d&1))break;if(c=f.get(a))return c==b;d|=2;f.set(a,b);b=Nb(m(a),m(b),d,e,g,f);f["delete"](a);return b;case "[object Symbol]":if(qa)return qa.call(a)==qa.call(b)}return!1}
function fc(a){return eb(Sb(a,k,gc),a+"")}function Za(a){return Kb(a,G,gb)}function Xc(a){return Kb(a,ja,ac)}function hb(a){return(w.call(f,"placeholder")?f:a).placeholder}function D(){var a=f.iteratee||ib;a=a===ib?Ob:a;return arguments.length?a(arguments[0],arguments[1]):a}function La(a,b){a=a.__data__;var c=typeof b;return("string"==c||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==b:null===b)?a["string"==typeof b?"string":"hash"]:a.map}function jd(a){for(var b=G(a),c=b.length;c--;){var d=
b[c],e=a[d];b[c]=[d,e,e===e&&!y(e)]}return b}function T(a,b){a=null==a?k:a[b];b=!y(a)||hc&&hc in a?!1:(ka(a)?qd:rd).test(U(a));return b?a:k}function ic(a,b,c){b=bb(b,a);for(var d=-1,e=b.length,g=!1;++d<e;){var f=Z(b[d]);if(!(g=null!=a&&c(a,f)))break;a=a[f]}if(g||++d!=e)return g;e=null==a?0:a.length;return!!e&&Ha(e)&&fa(f,e)&&(v(a)||Ba(a))}function Rc(a){var b=a.length,c=new a.constructor(b);b&&"string"==typeof a[0]&&w.call(a,"index")&&(c.index=a.index,c.input=a.input);return c}function Tc(a){return"function"!=
typeof a.constructor||jb(a)?{}:Ja(jc(a))}function Wc(a,b,c){var d=a.constructor;switch(b){case "[object ArrayBuffer]":return fb(a);case "[object Boolean]":case "[object Date]":return new d(+a);case "[object DataView]":return b=c?fb(a.buffer):a.buffer,new a.constructor(b,a.byteOffset,a.byteLength);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return b=
c?fb(a.buffer):a.buffer,new a.constructor(b,a.byteOffset,a.length);case "[object Map]":return new d;case "[object Number]":case "[object String]":return new d(a);case "[object RegExp]":return b=new a.constructor(a.source,sd.exec(a)),b.lastIndex=a.lastIndex,b;case "[object Set]":return new d;case "[object Symbol]":return qa?Object(qa.call(a)):{}}}function Yc(a){return v(a)||Ba(a)||!!(kc&&a&&a[kc])}function fa(a,b){var c=typeof a;b=null==b?9007199254740991:b;return!!b&&("number"==c||"symbol"!=c&&td.test(a))&&
-1<a&&0==a%1&&a<b}function lc(a,b,c){if(!y(c))return!1;var d=typeof b;return("number"==d?L(c)&&fa(b,c.length):"string"==d&&b in c)?ha(c[b],a):!1}function cb(a,b){if(v(a))return!1;var c=typeof a;return"number"==c||"symbol"==c||"boolean"==c||null==a||ma(a)?!0:ud.test(a)||!vd.test(a)||null!=b&&a in Object(b)}function jb(a){var b=a&&a.constructor;return a===("function"==typeof b&&b.prototype||Ma)}function Qb(a,b){return function(c){return null==c?!1:c[a]===b&&(b!==k||a in Object(c))}}function Sb(a,b,
c){b=H(b===k?a.length-1:b,0);return function(){for(var d=arguments,e=-1,g=H(d.length-b,0),f=Array(g);++e<g;)f[e]=d[b+e];e=-1;for(g=Array(b+1);++e<b;)g[e]=d[e];g[b]=c(f);return va(a,this,g)}}function ec(a,b,c){var d=b+"";b=eb;var e=(e=d.match(wd))?e[1].split(xd):[];c=yd(e,c);if(e=c.length){var g=e-1;c[g]=(1<e?"\x26 ":"")+c[g];c=c.join(2<e?", ":" ");d=d.replace(zd,"{\n/* [wrapped with "+c+"] */\n")}return b(a,d)}function mc(a){var b=0,c=0;return function(){var d=Ad(),e=16-(d-c);c=d;if(0<e){if(800<=
++b)return arguments[0]}else b=0;return a.apply(k,arguments)}}function Z(a){if("string"==typeof a||ma(a))return a;var b=a+"";return"0"==b&&1/a==-na?"-0":b}function U(a){if(null!=a){try{return nc.call(a)}catch(b){}return a+""}return""}function yd(a,b){C(Bd,function(c){var d="_."+c[0];b&c[1]&&!Xa(a,d)&&a.push(d)});return a.sort()}function Cb(a){if(a instanceof q)return a.clone();var b=new E(a.__wrapped__,a.__chain__);b.__actions__=M(a.__actions__);b.__index__=a.__index__;b.__values__=a.__values__;return b}
function oc(a,b,c){var d=null==a?0:a.length;if(!d)return-1;c=null==c?0:N(c);0>c&&(c=H(d+c,0));return wb(a,D(b,3),c)}function gc(a){return(null==a?0:a.length)?$a(a,1):[]}function pc(a){var b=null==a?0:a.length;return b?a[b-1]:k}function kb(a){return null==a?a:Cd.call(a)}function qc(a){a=f(a);a.__chain__=!0;return a}function Na(a,b){return b(a)}function Dd(){return this}function rc(a,b){return(v(a)?C:Y)(a,D(b,3))}function Oa(a,b){if("function"!=typeof a||null!=b&&"function"!=typeof b)throw new TypeError("Expected a function");
var c=function(){var d=arguments,e=b?b.apply(this,d):d[0],g=c.cache;if(g.has(e))return g.get(e);d=a.apply(this,d);c.cache=g.set(e,d)||g;return d};c.cache=new (Oa.Cache||K);return c}function lb(a){if("function"!=typeof a)throw new TypeError("Expected a function");return function(){var b=arguments;switch(b.length){case 0:return!a.call(this);case 1:return!a.call(this,b[0]);case 2:return!a.call(this,b[0],b[1]);case 3:return!a.call(this,b[0],b[1],b[2])}return!a.apply(this,b)}}function ha(a,b){return a===
b||a!==a&&b!==b}function L(a){return null!=a&&Ha(a.length)&&!ka(a)}function Pa(a){return x(a)&&L(a)}function ka(a){if(!y(a))return!1;a=Q(a);return"[object Function]"==a||"[object GeneratorFunction]"==a||"[object AsyncFunction]"==a||"[object Proxy]"==a}function Ha(a){return"number"==typeof a&&-1<a&&0==a%1&&9007199254740991>=a}function y(a){var b=typeof a;return null!=a&&("object"==b||"function"==b)}function x(a){return null!=a&&"object"==typeof a}function sc(a){return"string"==typeof a||!v(a)&&x(a)&&
"[object String]"==Q(a)}function ma(a){return"symbol"==typeof a||x(a)&&"[object Symbol]"==Q(a)}function tc(a){if(!a)return[];if(L(a))return sc(a)?Ed.test(a)?a.match(Fd)||[]:a.split(""):M(a);if(ra&&a[ra]){a=a[ra]();for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}b=A(a);return("[object Map]"==b?Ab:"[object Set]"==b?za:uc)(a)}function vc(a){if(!a)return 0===a?a:0;a=Qa(a);return a===na||a===-na?1.7976931348623157E308*(0>a?-1:1):a===a?a:0}function N(a){a=vc(a);var b=a%1;return a===a?b?a-b:
a:0}function Qa(a){if("number"==typeof a)return a;if(ma(a))return wc;y(a)&&(a="function"==typeof a.valueOf?a.valueOf():a,a=y(a)?a+"":a);if("string"!=typeof a)return 0===a?a:+a;a=a.replace(Gd,"");var b=Hd.test(a);return b||Id.test(a)?Jd(a.slice(2),b?2:8):Kd.test(a)?wc:+a}function Xb(a){return null==a?"":Ub(a)}function db(a,b,c){a=null==a?k:ab(a,b);return a===k?c:a}function Rb(a,b){return null!=a&&ic(a,b,ad)}function G(a){if(L(a))a=Db(a);else if(jb(a)){var b=[],c;for(c in Object(a))w.call(a,c)&&"constructor"!=
c&&b.push(c);a=b}else a=Ld(a);return a}function ja(a){if(L(a))a=Db(a,!0);else if(y(a)){var b=jb(a),c=[];for(d in a)("constructor"!=d||!b&&w.call(a,d))&&c.push(d);a=c}else{var d=[];if(null!=a)for(b in Object(a))d.push(b);a=d}return a}function uc(a){return null==a?[]:Nc(a,G(a))}function xc(a){return function(){return a}}function ba(a){return a}function ib(a){return Ob("function"==typeof a?a:Fa(a,1))}function mb(a,b,c){var d=G(b),e=Jb(b,d);null!=c||y(b)&&(e.length||!d.length)||(c=b,b=a,a=this,e=Jb(b,
G(b)));var g=!(y(c)&&"chain"in c)||!!c.chain,f=ka(a);C(e,function(c){var d=b[c];a[c]=d;f&&(a.prototype[c]=function(){var b=this.__chain__;if(g||b){var c=a(this.__wrapped__);(c.__actions__=M(this.__actions__)).push({func:d,args:arguments,thisArg:a});c.__chain__=b;return c}return d.apply(a,W([this.value()],arguments))})});return a}function nb(){}function Pb(a){return cb(a)?Lc(Z(a)):kd(a)}function ob(){return[]}function yc(){return!1}var k,na=1/0,wc=0/0,Bd=[["ary",128],["bind",1],["bindKey",2],["curry",
8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],vd=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ud=/^\w*$/,Md=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gd=/^\s+|\s+$/g,zd=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,wd=/\{\n\/\* \[wrapped with (.+)\] \*/,xd=/,? & /,Nd=/\\(\\)?/g,sd=/\w*$/,Kd=/^[-+]0x[0-9a-f]+$/i,Hd=/^0b[01]+$/i,rd=/^\[object .+?Constructor\]$/,Id=/^0o[0-7]+$/i,td=/^(?:0|[1-9]\d*)$/,Fd=
/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]?|[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,Ed=/[\u200d\ud800-\udfff\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff\ufe0e\ufe0f]/,
u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0;u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=
u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1;var t={};t["[object Arguments]"]=t["[object Array]"]=t["[object ArrayBuffer]"]=t["[object DataView]"]=t["[object Boolean]"]=t["[object Date]"]=t["[object Float32Array]"]=t["[object Float64Array]"]=t["[object Int8Array]"]=t["[object Int16Array]"]=t["[object Int32Array]"]=t["[object Map]"]=t["[object Number]"]=t["[object Object]"]=t["[object RegExp]"]=t["[object Set]"]=t["[object String]"]=t["[object Symbol]"]=t["[object Uint8Array]"]=
t["[object Uint8ClampedArray]"]=t["[object Uint16Array]"]=t["[object Uint32Array]"]=!0;t["[object Error]"]=t["[object Function]"]=t["[object WeakMap]"]=!1;var Jd=parseInt,zc="object"==typeof global&&global&&global.Object===Object&&global,Od="object"==typeof self&&self&&self.Object===Object&&self,B=zc||Od||Function("return this")(),pb="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ra=pb&&"object"==typeof module&&module&&!module.nodeType&&module,Ac=Ra&&Ra.exports===pb,qb=Ac&&zc.process;
a:{try{var V=qb&&qb.binding&&qb.binding("util");break a}catch(a){}V=void 0}var Bc=V&&V.isMap,Cc=V&&V.isSet,Dc=V&&V.isTypedArray,rb=Array.prototype,Ma=Object.prototype,sb=B["__core-js_shared__"],nc=Function.prototype.toString,w=Ma.hasOwnProperty,hc=function(){var a=/[^.]+$/.exec(sb&&sb.keys&&sb.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Lb=Ma.toString,qd=RegExp("^"+nc.call(w).replace(/[\\^$.*+?()[\]{}|]/g,"\\$\x26").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+
"$"),Sa=Ac?B.Buffer:k,O=B.Symbol,Ia=B.Uint8Array,Yb=Sa?Sa.allocUnsafe:k,jc=Bb(Object.getPrototypeOf,Object),Ec=Object.create,Fc=Ma.propertyIsEnumerable,Pd=rb.splice,kc=O?O.isConcatSpreadable:k,ra=O?O.iterator:k,R=O?O.toStringTag:k,Ea=function(){try{var a=T(Object,"defineProperty");a({},"",{});return a}catch(b){}}(),tb=Object.getOwnPropertySymbols,Qd=Sa?Sa.isBuffer:k,Ld=Bb(Object.keys,Object),H=Math.max,S=Math.min,Ad=Date.now,Cd=rb.reverse,ub=T(B,"DataView"),sa=T(B,"Map"),vb=T(B,"Promise"),ca=T(B,
"Set"),ta=T(B,"WeakMap"),ua=T(Object,"create"),Ta=ta&&new ta,pa={},Rd=U(ub),Sd=U(sa),Td=U(vb),Ud=U(ca),Vd=U(ta),Ua=O?O.prototype:k,qa=Ua?Ua.valueOf:k,Vb=Ua?Ua.toString:k,Ja=function(){function a(){}return function(b){if(!y(b))return{};if(Ec)return Ec(b);a.prototype=b;b=new a;a.prototype=k;return b}}();f.prototype=Aa.prototype;f.prototype.constructor=f;E.prototype=Ja(Aa.prototype);E.prototype.constructor=E;q.prototype=Ja(Aa.prototype);q.prototype.constructor=q;P.prototype.clear=function(){this.__data__=
ua?ua(null):{};this.size=0};P.prototype["delete"]=function(a){a=this.has(a)&&delete this.__data__[a];this.size-=a?1:0;return a};P.prototype.get=function(a){var b=this.__data__;return ua?(a=b[a],"__lodash_hash_undefined__"===a?k:a):w.call(b,a)?b[a]:k};P.prototype.has=function(a){var b=this.__data__;return ua?b[a]!==k:w.call(b,a)};P.prototype.set=function(a,b){var c=this.__data__;this.size+=this.has(a)?0:1;c[a]=ua&&b===k?"__lodash_hash_undefined__":b;return this};J.prototype.clear=function(){this.__data__=
[];this.size=0};J.prototype["delete"]=function(a){var b=this.__data__;a=Da(b,a);if(0>a)return!1;a==b.length-1?b.pop():Pd.call(b,a,1);--this.size;return!0};J.prototype.get=function(a){var b=this.__data__;a=Da(b,a);return 0>a?k:b[a][1]};J.prototype.has=function(a){return-1<Da(this.__data__,a)};J.prototype.set=function(a,b){var c=this.__data__,d=Da(c,a);0>d?(++this.size,c.push([a,b])):c[d][1]=b;return this};K.prototype.clear=function(){this.size=0;this.__data__={hash:new P,map:new (sa||J),string:new P}};
K.prototype["delete"]=function(a){a=La(this,a)["delete"](a);this.size-=a?1:0;return a};K.prototype.get=function(a){return La(this,a).get(a)};K.prototype.has=function(a){return La(this,a).has(a)};K.prototype.set=function(a,b){var c=La(this,a),d=c.size;c.set(a,b);this.size+=c.size==d?0:1;return this};X.prototype.add=X.prototype.push=function(a){this.__data__.set(a,"__lodash_hash_undefined__");return this};X.prototype.has=function(a){return this.__data__.has(a)};F.prototype.clear=function(){this.__data__=
new J;this.size=0};F.prototype["delete"]=function(a){var b=this.__data__;a=b["delete"](a);this.size=b.size;return a};F.prototype.get=function(a){return this.__data__.get(a)};F.prototype.has=function(a){return this.__data__.has(a)};F.prototype.set=function(a,b){var c=this.__data__;if(c instanceof J){var d=c.__data__;if(!sa||199>d.length)return d.push([a,b]),this.size=++c.size,this;c=this.__data__=new K(d)}c.set(a,b);this.size=c.size;return this};var Y=function(a,b){return function(c,d){if(null==c)return c;
if(!L(c))return a(c,d);for(var e=c.length,g=b?e:-1,f=Object(c);(b?g--:++g<e)&&!1!==d(f[g],g,f););return c}}(Ga),Zc=function(a){return function(b,c,d){var e=-1,g=Object(b);d=d(b);for(var f=d.length;f--;){var h=d[a?f:++e];if(!1===c(g[h],h,g))break}return b}}(),Gc=Ta?function(a,b){Ta.set(a,b);return a}:ba,Wd=Ea?function(a,b){return Ea(a,"toString",{configurable:!0,enumerable:!1,value:xc(b),writable:!0})}:ba,Xd=ca&&1/za(new ca([,-0]))[1]==na?function(a){return new ca(a)}:nb,cc=Ta?function(a){return Ta.get(a)}:
nb,gb=tb?function(a){if(null==a)return[];a=Object(a);return wa(tb(a),function(b){return Fc.call(a,b)})}:ob,ac=tb?function(a){for(var b=[];a;)W(b,gb(a)),a=jc(a);return b}:ob,A=Q;if(ub&&"[object DataView]"!=A(new ub(new ArrayBuffer(1)))||sa&&"[object Map]"!=A(new sa)||vb&&"[object Promise]"!=A(vb.resolve())||ca&&"[object Set]"!=A(new ca)||ta&&"[object WeakMap]"!=A(new ta))A=function(a){var b=Q(a);if(a=(a="[object Object]"==b?a.constructor:k)?U(a):"")switch(a){case Rd:return"[object DataView]";case Sd:return"[object Map]";
case Td:return"[object Promise]";case Ud:return"[object Set]";case Vd:return"[object WeakMap]"}return b};var dc=mc(Gc),eb=mc(Wd),md=function(a){a=Oa(a,function(a){500===b.size&&b.clear();return a});var b=a.cache;return a}(function(a){var b=[];46===a.charCodeAt(0)&&b.push("");a.replace(Md,function(a,d,e,g){b.push(e?g.replace(Nd,"$1"):d||a)});return b}),Yd=la(function(a,b){return Pa(a)?Hb(a,$a(b,1,Pa,!0)):[]}),Zd=la(function(a,b){return Pa(a)?Hb(a,b):[]});fc(function(a){var b=a.length,c=b?a[0]:0,d=
this.__wrapped__,e=function(b){for(var c=-1,d=a.length,e=Array(d),g=null==b;++c<d;)e[c]=g?k:db(b,a[c]);return e};if(1<b||this.__actions__.length||!(d instanceof q)||!fa(c))return this.thru(e);d=d.slice(c,+c+(b?1:0));d.__actions__.push({func:Na,args:[e],thisArg:k});return(new E(d,this.__chain__)).thru(function(a){b&&!a.length&&a.push(k);return a})});var $d=function(a){return function(b,c,d){var e=Object(b);if(!L(b)){var g=D(c,3);b=G(b);c=function(a){return g(e[a],a,e)}}c=a(b,c,d);return-1<c?e[g?b[c]:
c]:k}}(oc),ae=function(a,b){return function(c,d){var e=v(c)?Ic:Oc,g=b?b():{};return e(c,a,D(d,2),g)}}(function(a,b,c){w.call(a,c)?a[c].push(b):Ca(a,c,[b])}),Va=function(){return B.Date.now()},Wa=la(function(a,b,c){var d=1;if(c.length){var e=da(c,hb(Wa));d|=32}var g=b,f=c,h=e,n=void 0,q=void 0;c=d&2;if(!c&&"function"!=typeof a)throw new TypeError("Expected a function");b=f?f.length:0;b||(d&=-97,f=h=k);n=n===k?n:H(N(n),0);q=q===k?q:N(q);b-=h?h.length:0;if(d&64){var l=f,p=h;f=h=k}e=c?k:cc(a);l=[a,d,
g,f,h,l,p,void 0,n,q];if(e&&(p=l[1],a=e[1],d=p|a,g=128==a&&8==p||128==a&&256==p&&l[7].length<=e[8]||384==a&&e[7].length<=e[8]&&8==p,131>d||g)){a&1&&(l[2]=e[2],d|=p&1?0:4);if(p=e[3])g=l[3],l[3]=g?Zb(g,p,e[4]):p,l[4]=g?da(l[3],"__lodash_placeholder__"):e[4];if(p=e[5])g=l[5],l[5]=g?$b(g,p,e[6]):p,l[6]=g?da(l[5],"__lodash_placeholder__"):e[6];(p=e[7])&&(l[7]=p);a&128&&(l[8]=null==l[8]?e[8]:S(l[8],e[8]));null==l[9]&&(l[9]=e[9]);l[0]=e[0];l[1]=d}a=l[0];d=l[1];g=l[2];f=l[3];h=l[4];q=l[9]=l[9]===k?c?0:a.length:
H(l[9]-b,0);!q&&d&24&&(d&=-25);c=d&&1!=d?8==d||16==d?od(a,d,q):32!=d&&33!=d||h.length?Ka.apply(k,l):pd(a,d,g,f):nd(a,d,g);return ec((e?Gc:dc)(c,l),a,d)});Oa.Cache=K;var Ba=Mb(function(){return arguments}())?Mb:function(a){return x(a)&&w.call(a,"callee")&&!Fc.call(a,"callee")},v=Array.isArray,ea=Qd||yc,Gb=Bc?ya(Bc):cd,Fb=Cc?ya(Cc):ed,Ya=Dc?ya(Dc):fd,Hc=function(a){return la(function(b,c){var d=-1,e=c.length,g=1<e?c[e-1]:k,f=2<e?c[2]:k;g=3<a.length&&"function"==typeof g?(e--,g):k;f&&lc(c[0],c[1],f)&&
(g=3>e?k:g,e=1);for(b=Object(b);++d<e;)(f=c[d])&&a(b,f,d,g);return b})}(function(a,b){ia(b,ja(b),a)}),be=fc(function(a,b){C(b,function(b){b=Z(b);Ca(a,b,Wa(a[b],a))});return a});f.assignIn=Hc;f.bind=Wa;f.bindAll=be;f.chain=qc;f.compact=function(a){for(var b=-1,c=null==a?0:a.length,d=0,e=[];++b<c;){var g=a[b];g&&(e[d++]=g)}return e};f.constant=xc;f.debounce=function(a,b,c){function d(b){var c=n,d=q;n=q=k;t=b;return l=a.apply(d,c)}function e(a){var c=a-r;a-=t;return r===k||c>=b||0>c||u&&a>=x}function g(){var a=
Va();if(e(a))return f(a);var c=setTimeout;var d=a-t;a=b-(a-r);d=u?S(a,x-d):a;p=c(g,d)}function f(a){p=k;if(w&&n)return d(a);n=q=k;return l}function h(){var a=Va(),c=e(a);n=arguments;q=this;r=a;if(c){if(p===k)return t=a=r,p=setTimeout(g,b),v?d(a):l;if(u)return p=setTimeout(g,b),d(r)}p===k&&(p=setTimeout(g,b));return l}var n,q,l,p,r,t=0,v=!1,u=!1,w=!0;if("function"!=typeof a)throw new TypeError("Expected a function");b=Qa(b)||0;if(y(c)){v=!!c.leading;var x=(u="maxWait"in c)?H(Qa(c.maxWait)||0,b):x;
w="trailing"in c?!!c.trailing:w}h.cancel=function(){p!==k&&clearTimeout(p);t=0;n=r=q=p=k};h.flush=function(){return p===k?l:f(Va())};return h};f.difference=Yd;f.filter=function(a,b){return(v(a)?wa:Ib)(a,D(b,3))};f.flatten=gc;f.groupBy=ae;f.iteratee=ib;f.keys=G;f.keysIn=ja;f.map=function(a,b){return(v(a)?xa:id)(a,D(b,3))};f.memoize=Oa;f.mixin=mb;f.negate=lb;f.property=Pb;f.reject=function(a,b){return(v(a)?wa:Ib)(a,lb(D(b,3)))};f.reverse=kb;f.take=function(a,b,c){if(!a||!a.length)return[];b=c||b===
k?1:N(b);return Tb(a,0,0>b?0:b)};f.tap=function(a,b){b(a);return a};f.thru=Na;f.toArray=tc;f.uniq=function(a){if(a&&a.length)a:{var b=-1,c=Xa,d=a.length,e=!0,f=[];if(200<=d){if(c=Xd(a)){a=za(c);break a}e=!1;c=zb;var m=new X}else m=f;b:for(;++b<d;){var h=a[b],k=h;h=0!==h?h:0;if(e&&k===k){for(var q=m.length;q--;)if(m[q]===k)continue b;f.push(h)}else c(m,k,void 0)||(m!==f&&m.push(k),f.push(h))}a=f}else a=[];return a};f.values=uc;f.without=Zd;f.extend=Hc;mb(f,f);f.eq=ha;f.find=$d;f.findIndex=oc;f.forEach=
rc;f.get=db;f.has=function(a,b){return null!=a&&ic(a,b,$c)};f.hasIn=Rb;f.identity=ba;f.isArguments=Ba;f.isArray=v;f.isArrayLike=L;f.isArrayLikeObject=Pa;f.isBuffer=ea;f.isFunction=ka;f.isLength=Ha;f.isMap=Gb;f.isObject=y;f.isObjectLike=x;f.isSet=Fb;f.isString=sc;f.isSymbol=ma;f.isTypedArray=Ya;f.last=pc;f.stubArray=ob;f.stubFalse=yc;f.noop=nb;f.now=Va;f.reduce=function(a,b,c){var d=v(a)?xb:Mc,e=3>arguments.length;return d(a,D(b,4),c,e,Y)};f.some=function(a,b,c){var d=v(a)?yb:ld;c&&lc(a,b,c)&&(b=k);
return d(a,D(b,3))};f.toFinite=vc;f.toInteger=N;f.toNumber=Qa;f.toString=Xb;f.each=rc;mb(f,function(){var a={};Ga(f,function(b,c){w.call(f.prototype,c)||(a[c]=b)});return a}(),{chain:!1});f.VERSION="4.17.5";Wa.placeholder=f;C(["drop","take"],function(a,b){q.prototype[a]=function(c){c=c===k?1:H(N(c),0);var d=this.__filtered__&&!b?new q(this):this.clone();d.__filtered__?d.__takeCount__=S(c,d.__takeCount__):d.__views__.push({size:S(c,4294967295),type:a+(0>d.__dir__?"Right":"")});return d};q.prototype[a+
"Right"]=function(b){return this.reverse()[a](b).reverse()}});C(["filter","map","takeWhile"],function(a,b){var c=b+1,d=1==c||3==c;q.prototype[a]=function(a){var b=this.clone();b.__iteratees__.push({iteratee:D(a,3),type:c});b.__filtered__=b.__filtered__||d;return b}});C(["head","last"],function(a,b){var c="take"+(b?"Right":"");q.prototype[a]=function(){return this[c](1).value()[0]}});C(["initial","tail"],function(a,b){var c="drop"+(b?"":"Right");q.prototype[a]=function(){return this.__filtered__?new q(this):
this[c](1)}});q.prototype.compact=function(){return this.filter(ba)};q.prototype.find=function(a){return this.filter(a).head()};q.prototype.findLast=function(a){return this.reverse().find(a)};q.prototype.invokeMap=la(function(a,b){return"function"==typeof a?new q(this):this.map(function(c){var d=a;d=bb(d,c);c=2>d.length?c:ab(c,Tb(d,0,-1));d=null==c?c:c[Z(pc(d))];return null==d?k:va(d,c,b)})});q.prototype.reject=function(a){return this.filter(lb(D(a)))};q.prototype.slice=function(a,b){a=N(a);var c=
this;if(c.__filtered__&&(0<a||0>b))return new q(c);0>a?c=c.takeRight(-a):a&&(c=c.drop(a));b!==k&&(b=N(b),c=0>b?c.dropRight(-b):c.take(b-a));return c};q.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()};q.prototype.toArray=function(){return this.take(4294967295)};Ga(q.prototype,function(a,b){var c=/^(?:filter|find|map|reject)|While$/.test(b),d=/^(?:head|last)$/.test(b),e=f[d?"take"+("last"==b?"Right":""):b],g=d||/^find/.test(b);e&&(f.prototype[b]=function(){var b=this.__wrapped__,
h=d?[1]:arguments,n=b instanceof q,t=h[0],l=n||v(b),p=function(a){a=e.apply(f,W([a],h));return d&&r?a[0]:a};l&&c&&"function"==typeof t&&1!=t.length&&(n=l=!1);var r=this.__chain__,u=!!this.__actions__.length;t=g&&!r;n=n&&!u;if(!g&&l)return b=n?b:new q(this),b=a.apply(b,h),b.__actions__.push({func:Na,args:[p],thisArg:k}),new E(b,r);if(t&&n)return a.apply(this,h);b=this.thru(p);return t?d?b.value()[0]:b.value():b})});C("pop push shift sort splice unshift".split(" "),function(a){var b=rb[a],c=/^(?:push|sort|unshift)$/.test(a)?
"tap":"thru",d=/^(?:pop|shift)$/.test(a);f.prototype[a]=function(){var a=arguments;if(d&&!this.__chain__){var f=this.value();return b.apply(v(f)?f:[],a)}return this[c](function(c){return b.apply(v(c)?c:[],a)})}});Ga(q.prototype,function(a,b){if(a=f[b]){var c=a.name+"";(pa[c]||(pa[c]=[])).push({name:b,func:a})}});pa[Ka(k,2).name]=[{name:"wrapper",func:k}];q.prototype.clone=function(){var a=new q(this.__wrapped__);a.__actions__=M(this.__actions__);a.__dir__=this.__dir__;a.__filtered__=this.__filtered__;
a.__iteratees__=M(this.__iteratees__);a.__takeCount__=this.__takeCount__;a.__views__=M(this.__views__);return a};q.prototype.reverse=function(){if(this.__filtered__){var a=new q(this);a.__dir__=-1;a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a};q.prototype.value=function(){var a=this.__wrapped__.value(),b=this.__dir__,c=v(a),d=0>b,e=c?a.length:0;var f=0;for(var k=e,h=this.__views__,n=-1,q=h.length;++n<q;){var l=h[n],p=l.size;switch(l.type){case "drop":f+=p;break;case "dropRight":k-=
p;break;case "take":k=S(k,f+p);break;case "takeRight":f=H(f,k-p)}}h=k;k=h-f;f=d?h:f-1;h=this.__iteratees__;n=h.length;q=0;l=S(k,this.__takeCount__);if(!c||!d&&e==k&&l==k)return Wb(a,this.__actions__);c=[];a:for(;k--&&q<l;){f+=b;d=-1;for(e=a[f];++d<n;){var r=h[d];p=r.iteratee;r=r.type;p=p(e);if(2==r)e=p;else if(!p)if(1==r)continue a;else break a}c[q++]=e}return c};f.prototype.chain=function(){return qc(this)};f.prototype.commit=function(){return new E(this.value(),this.__chain__)};f.prototype.next=
function(){this.__values__===k&&(this.__values__=tc(this.value()));var a=this.__index__>=this.__values__.length,b=a?k:this.__values__[this.__index__++];return{done:a,value:b}};f.prototype.plant=function(a){for(var b,c=this;c instanceof Aa;){var d=Cb(c);d.__index__=0;d.__values__=k;b?e.__wrapped__=d:b=d;var e=d;c=c.__wrapped__}e.__wrapped__=a;return b};f.prototype.reverse=function(){var a=this.__wrapped__;return a instanceof q?(this.__actions__.length&&(a=new q(this)),a=a.reverse(),a.__actions__.push({func:Na,
args:[kb],thisArg:k}),new E(a,this.__chain__)):this.thru(kb)};f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=function(){return Wb(this.__wrapped__,this.__actions__)};f.prototype.first=f.prototype.head;ra&&(f.prototype[ra]=Dd);"function"==typeof define?(B.__jira_integration_plugin_lodash__=f,define("jira-integration-plugin/custom-lodash",function(){return f})):Ra?((Ra.exports=f)._=f,pb._=f):B.__jira_integration_plugin_lodash__=f}).call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.soy' */
// This file was automatically generated from fields.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.fields.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.fields == 'undefined') { jiraIntegration.templates.fields = {}; }


jiraIntegration.templates.fields.stringField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'long-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.stringField.soyTemplateName = 'jiraIntegration.templates.fields.stringField';
}


jiraIntegration.templates.fields.textareaField = function(opt_data, opt_ignored) {
  return '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><textarea rows="3" id="' + soy.$$escapeHtml(opt_data.name) + '" class="textarea long-field" data-name="' + soy.$$escapeHtml(opt_data.name) + '" name="' + soy.$$escapeHtml(opt_data.name) + '"' + ((opt_data.extraAttributes) ? ' ' + aui.renderExtraAttributes(opt_data) : '') + '>' + soy.$$escapeHtml(opt_data.value) + '</textarea>' + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.textareaField.soyTemplateName = 'jiraIntegration.templates.fields.textareaField';
}


jiraIntegration.templates.fields.arrayField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'long-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.arrayField.soyTemplateName = 'jiraIntegration.templates.fields.arrayField';
}


jiraIntegration.templates.fields.numberField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.numberField.soyTemplateName = 'jiraIntegration.templates.fields.numberField';
}


jiraIntegration.templates.fields.allowedValuesField = function(opt_data, opt_ignored) {
  return '' + ((opt_data.options.length) ? jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {type: 'select'})) : jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {type: 'value', value: '\u65e0'})));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.allowedValuesField.soyTemplateName = 'jiraIntegration.templates.fields.allowedValuesField';
}


jiraIntegration.templates.fields.timeTrackingField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.timeTrackingField.soyTemplateName = 'jiraIntegration.templates.fields.timeTrackingField';
}


jiraIntegration.templates.fields.radioField = function(opt_data, opt_ignored) {
  return '' + aui.form.radioField(soy.$$augmentMap(opt_data, {legendContent: opt_data.labelText, extraAttributes: {'data-name': opt_data.name, name: opt_data.name, 'data-jira-type': opt_data.jiraType}, extraClasses: 'jira-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.radioField.soyTemplateName = 'jiraIntegration.templates.fields.radioField';
}


jiraIntegration.templates.fields.unrenderableTypeField = function(opt_data, opt_ignored) {
  return '<div class="field-group jira-field jira-field-unrenderable' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '"><label>' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label>' + aui.form.value({content: opt_data.reasonContent}) + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.unrenderableTypeField.soyTemplateName = 'jiraIntegration.templates.fields.unrenderableTypeField';
}


jiraIntegration.templates.fields.dateField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.dateField.soyTemplateName = 'jiraIntegration.templates.fields.dateField';
}


jiraIntegration.templates.fields.checkboxField = function(opt_data, opt_ignored) {
  return '' + aui.form.checkboxField(soy.$$augmentMap(opt_data, {legendContent: opt_data.labelText, extraAttributes: {'data-name': opt_data.name, name: opt_data.name, 'data-jira-type': opt_data.jiraType}, extraClasses: 'jira-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.checkboxField.soyTemplateName = 'jiraIntegration.templates.fields.checkboxField';
}


jiraIntegration.templates.fields.select2WithIconField = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><select id="' + soy.$$escapeHtml(opt_data.name) + '" class="medium-field" name="' + soy.$$escapeHtml(opt_data.name) + '" data-name="' + soy.$$escapeHtml(opt_data.name) + '"' + ((opt_data.extraAttributes) ? ' ' + aui.renderExtraAttributes(opt_data) : '') + '>';
  var optionList112 = opt_data.options;
  var optionListLen112 = optionList112.length;
  for (var optionIndex112 = 0; optionIndex112 < optionListLen112; optionIndex112++) {
    var optionData112 = optionList112[optionIndex112];
    output += '<option value="' + soy.$$escapeHtml(optionData112.value) + '" ' + ((optionData112.selected) ? 'selected' : '') + ' data-icon-url="' + soy.$$escapeHtml(optionData112.iconUrl) + '">' + soy.$$escapeHtml(optionData112.text) + '</option>';
  }
  output += '</select>' + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconField.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconField';
}


jiraIntegration.templates.fields.select2WithIconOption = function(opt_data, opt_ignored) {
  return ((opt_data.iconUrl) ? aui.avatar.avatar({avatarImageUrl: opt_data.iconUrl, size: 'xsmall', isProject: opt_data.isProject, extraClasses: 'select-option-image', tagName: 'span'}) : '') + '<span class="select-option" title="' + soy.$$escapeHtml(opt_data.optionValue) + '">' + soy.$$escapeHtml(opt_data.optionValue) + '</span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconOption.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconOption';
}


jiraIntegration.templates.fields.labelFieldResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format('\x22{0}\x22 - (\u65b0\u6807\u7b7e)',opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.labelFieldResult.soyTemplateName = 'jiraIntegration.templates.fields.labelFieldResult';
}


jiraIntegration.templates.fields.userOptionSelect = function(opt_data, opt_ignored) {
  var output = '';
  var userOption__soy150 = '' + soy.$$escapeHtml(opt_data.displayName) + ((! opt_data.isSystemOption) ? ' - (' + soy.$$escapeHtml(opt_data.name) + ')' : '');
  output += '<span data-value="' + soy.$$escapeHtml(opt_data.name) + '" title="' + soy.$$filterNoAutoescape(userOption__soy150) + '">' + soy.$$filterNoAutoescape(userOption__soy150) + '</span>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.userOptionSelect.soyTemplateName = 'jiraIntegration.templates.fields.userOptionSelect';
}


jiraIntegration.templates.fields.sprintSelect = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.name) + '<span class="sprint-detail">' + ((opt_data.state == 'FUTURE') ? soy.$$escapeHtml(AJS.format('\uff08{0} \u4e2d\u7684\u672a\u6765\u51b2\u523a\uff09',opt_data.board)) : '') + ((opt_data.state == 'ACTIVE') ? soy.$$escapeHtml(AJS.format('\uff08{0} \u4e2d\u7684\u6d3b\u8dc3\u51b2\u523a\uff09',opt_data.board)) : '') + '</span></span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.sprintSelect.soyTemplateName = 'jiraIntegration.templates.fields.sprintSelect';
}


jiraIntegration.templates.fields.epicSelect = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.name) + ' (' + soy.$$escapeHtml(opt_data.key) + ')">' + soy.$$escapeHtml(opt_data.name) + ((opt_data.key) ? '<span class="epic-detail">' + soy.$$escapeHtml(opt_data.key) + '</span>' : '') + '</span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.epicSelect.soyTemplateName = 'jiraIntegration.templates.fields.epicSelect';
}


jiraIntegration.templates.fields.errors = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.errorTexts) {
    var errorList195 = opt_data.errorTexts;
    var errorListLen195 = errorList195.length;
    for (var errorIndex195 = 0; errorIndex195 < errorListLen195; errorIndex195++) {
      var errorData195 = errorList195[errorIndex195];
      output += '<div class="error">' + soy.$$escapeHtml(errorData195) + '</div>';
    }
  }
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.errors.soyTemplateName = 'jiraIntegration.templates.fields.errors';
}


jiraIntegration.templates.fields.fieldWithExtraAttributes = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type=' + soy.$$escapeHtml(opt_data.jiraType) + '>' + aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: '' + soy.$$escapeHtml(opt_data.labelText)});
  switch (opt_data.type) {
    case 'select':
      output += aui.form.select({id: opt_data.name, name: opt_data.name, labelContent: '' + soy.$$escapeHtml(opt_data.labelText), options: opt_data.options, isRequired: opt_data.isRequired, isMultiple: opt_data.isMultiple, extraAttributes: soy.$$augmentMap({'data-name': opt_data.name}, opt_data.extraAttributes), extraClasses: opt_data.extraFieldClasses});
      break;
    case 'value':
      output += aui.form.value({id: opt_data.name, content: '' + soy.$$escapeHtml(opt_data.value)});
      break;
    default:
      output += aui.form.input({id: opt_data.name, name: opt_data.name, type: 'text', value: opt_data.value, extraAttributes: soy.$$augmentMap({'data-name': opt_data.name}, opt_data.extraAttributes), extraClasses: opt_data.extraFieldClasses});
  }
  output += jiraIntegration.templates.fields.errors(opt_data) + '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.fieldWithExtraAttributes.soyTemplateName = 'jiraIntegration.templates.fields.fieldWithExtraAttributes';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.js' */
define("jira-integration-plugin/fields",["jquery","jira-integration-plugin/custom-lodash","jira-integration-plugin/label-picker"],function(h,g,W){function D(a,b,c,d){var e=b.schema.system||"customfield_"+b.schema.customId,k=b.schema.system||b.schema.custom||b.schema.customId,l=p[k],E=!(!l||l.canRender&&!l.canRender(b)),F=!(!b.operations||!b.operations.length);l=E&&F?l:X;return l.getContext({labelText:b.name,name:e,isRequired:b.required,value:c[e],errorTexts:d[e],jiraType:k,isRenderable:E,hasOperations:F,
handler:l,extraAttributes:b.required&&{"data-aui-validation-field":"",required:!0}},b,a,c)}function n(a,b,c){var d=a.name;a.value=(h.isPlainObject(a.value)?a.value.name:a.value)||c&&c.fields[d]||b&&b.defaultValue||"";return a}function t(a){return a.val()}function G(a){a=a.val();return/\d/.test(a)&&/^-?\d*\.?\d*$/.test(a)?Number(a):a||null}function H(a,b,c){var d=a.name;a.value=a.value&&a.value.join(",")||c&&c.fields[d]&&c.fields[d].join(",")||b&&b.defaultValue&&b.defaultValue.join(" ");return a}function I(a){return g.map(a.val().split(","),
h.trim)}function J(a,b,c){function d(a){return Array.isArray(a)?a.map(function(a){return a.name||a.id}):[a.name||a.id]}var e=a.name,k=a.value;c=c&&c.fields[e];e=b&&b.defaultValue;var l=k?d(k):c?d(c):e?d(e):[];a.options=g.map(b.allowedValues,function(a){return{value:a.id,text:a.name||a.value,selected:l.includes(a.name||a.id)}});b.required||"option"!==b.schema.type||a.options.unshift({value:-1,text:"\u65e0"});a.isMultiple=b.operations.includes("add");delete a.value;
return a}function x(a,b){var c=b.val(),d=function(b){var c={};c[a]=b;return c};return b.attr("multiple")?Array.isArray(c)?g.map(c,d):[d(c)]:d(c)}function K(a,b,c){var d=a.name;a.value=a.value&&a.value.name||c&&c.fields[d]&&c.fields[d].name||("assignee"===q(b)?-1:"")||b&&b.defaultValue&&b.defaultValue.name;a.extraClasses="array"===b.schema.type?"multi-user-picker":"single-user-picker";return a}function L(a,b,c){var d=a.value||c&&c.fields[a.name]||b&&b.defaultValue;a.fields=g.map(b.allowedValues,function(a){return{id:a.id,
value:a.id,labelText:a.name||a.value,isChecked:Array.isArray(d)?d.some(function(b){return b.id===a.id}):d&&d.id===a.id}});delete a.value;return a}function M(a){return a.find("input:checked").toArray().map(function(a){a=h(a);return{id:a.attr("value"),value:a.parent().find("label").text()}})}function y(a,b,c,d,e){var k=a.find("input"),l=a.attr("name");k.removeClass("text").removeClass("long-field").addClass("medium-long-field");k.auiSelect2(h.extend({minimumInputLength:1,id:l,name:l,query:function(a){r(b,
c,a.term,d).done(function(b){a.callback({results:b})})}},e));(e=k.auiSelect2("data"))&&-1!==e.id&&k.auiSelect2("val",e.id);a.find("div.aui-select2-container").addClass("jira-select2-drop-box")}function N(a,b,c,d,e){e=h.extend({},e,{multiple:"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker"===c,formatResult:function(a){return f.fields.userOptionSelect({name:a.id,displayName:a.text,isSystemOption:!!a.isSystemOption})}});y(a,b,c,d,e)}function r(a,b,c,d){a=h.extend({restType:b,issueKey:d&&
d.key||"",term:c},a);return h.ajax({type:"POST",timeout:0,contentType:"application/json",dataType:"json",url:AJS.contextPath()+"/rest/jira-integration/latest/fields/autocomplete",data:JSON.stringify(a)})}function O(a){var b;a.id&&(b=h(a.element).attr("data-icon-url"));return f.fields.select2WithIconOption({optionValue:a.text,iconUrl:b})}function z(a){return(a=a.auiSelect2("data"))&&-1===a.id?void 0:a}function q(a){return a.schema?a.schema.system||a.schema.custom||a.schema.customId:a}function A(a){return p[q(a)]}
function P(a){return(a=Q(a))&&A(a)}function Q(a){return a.closest(".jira-field").attr("data-jira-type")}function Y(a,b){return h.ajax({type:"GET",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+a.serverId+"/projects/"+a.projectKey+"/issue-types/"+a.issueType+"/fields-meta"}).pipe(function(a){var c=[];g.each(a.fields,function(a){var d=q(a);a.required&&!b.excludedFields.includes(d)&&c.push(a)});return c})}function R(a,b,c){var d=Q(a),e=d&&A(d);(e=e&&e.behavior)&&e(a,b,d,c)}function S(a){var b=
P(a);return b&&b.getValue&&b.getValue(a)}function u(a,b){return function(c,d){c=a[c.attr("id")];d(c||b)}}var f=window.jiraIntegration.templates,v={template:f.fields.stringField,getContext:n,getValue:t},Z={template:f.fields.stringField,getContext:function(a,b,c){var d={"data-aui-validation-field":"",pattern:"([a-zA-Z][a-zA-Z0-9-+.]*://.+)|^$","data-aui-validation-pattern-msg":"\u8f93\u5165\u6709\u6548 URL \u65b9\u6848"};return h.extend(!0,{},n(a,b,c),{extraAttributes:d})},getValue:t},aa=
{template:f.fields.stringField,getContext:K,getInternalValue:z,getValue:function(a){a=a.val();if("-1"!==a)return{name:a}},behavior:function(a,b,c,d){var e={minimumInputLength:0,initSelection:u(b,{id:-1,text:"\u81ea\u52a8",isSystemOption:!0}),query:function(a){function e(b){1===a.page&&(a.element.prop("required")||b.unshift({id:"",text:"\u672a\u5206\u914d",isSystemOption:!0}),b.unshift({id:-1,text:"\u81ea\u52a8",isSystemOption:!0}));
a.callback({results:b})}0<a.term.length?r(b,c,a.term,d).done(e):e([])}};N(a,b,c,d,e)}},B={template:f.fields.stringField,getContext:K,getValue:function(a){var b=function(a){return{name:a}},c=a.val();a=a.closest(".jira-field").is(".multi-user-picker");return c?a?g.map(c.split(","),b):b(c):a?[]:null},behavior:function(a,b,c,d){var e=a.find(".long-field").attr("value")||"";e={formatInputTooShort:function(){return "\u67e5\u627e\u7528\u6237......"},initSelection:u(b,{id:-1,text:e,isSystemOption:!1})};
N(a,b,c,d,e)}},ba={template:f.fields.arrayField,getContext:H,getValue:I,behavior:function(a,b,c,d){a=a.find("input");W.build(a,function(a){return r(b,c,a,d)})}},C={template:f.fields.textareaField,getContext:n,getValue:t},ca={template:f.fields.numberField,getContext:function(a,b,c){var d={"data-aui-validation-field":"",pattern:"(([0-9]*[.])?[0-9]+)|^$","data-aui-validation-pattern-msg":"\u8f93\u5165\u6709\u6548\u6570\u5b57"};return h.extend(!0,{},n(a,b,c),{extraAttributes:d})},getValue:G},
T={template:f.fields.arrayField,getContext:H,getValue:I},m={template:f.fields.allowedValuesField,getContext:J,getValue:g.bind(x,null,"id"),behavior:function(a){a.find("select[multiple]").auiSelect2()}},U={template:f.fields.allowedValuesField,getContext:J,getValue:g.bind(x,null,"id")},da={template:f.fields.timeTrackingField,getContext:function(a,b,c){b={"data-aui-validation-field":"",pattern:"(([0-9]+w|[0-9]+d|[0-9]+m|[0-9]+h|[0-9]+)\\s*)*","data-aui-validation-pattern-msg":"\u8f93\u5165\u6709\u6548\u65f6\u95f4\u9884\u4f30\u503c\uff08\u4f8b\u5982 3 \u5468 4 \u5929 12 \u5c0f\u65f6\uff09"};
a.value=a.value&&a.value.remainingEstimate||c&&c.fields[name]&&c.fields[name].remainingEstimate||"";return h.extend(!0,{},a,{extraAttributes:b})},getValue:function(a){return{remainingEstimate:a.val()}}},V={template:f.fields.dateField,getContext:function(a,b,c){var d={"data-aui-validation-field":"",pattern:"^([0-9]{2,4}-(0?[1-9]|10|11|12)-([0-2]?[1-9]|10|20|30|31))$|^$","data-aui-validation-pattern-msg":"\u8f93\u5165\u6709\u6548\u65e5\u671f"};return h.extend(!0,{},n(a,b,c),{extraAttributes:d})},
getValue:function(a){a=a.val();return""===a?null:a},behavior:function(a){var b=a.find("input");navigator.userAgent.match(/Trident/)&&"5.3.5">AJS.version?(a="placeholder"in document.createElement("input"),b.attr("placeholder","YYYY-MM-DD"),a||b.on("focus",function(){b.val()===b.attr("placeholder")&&b.val("")}).on("blur",function(){""===b.val()&&b.val(b.attr("placeholder"))}).blur()):WRM.require("wr!com.atlassian.auiplugin:aui-date-picker").done(function(){b.datePicker({overrideBrowserDefault:!0})})}},
ea={template:f.fields.select2WithIconField,getContext:function(a,b,c){var d=a.name,e=a.value&&a.value.id||b&&b.defaultValue&&b.defaultValue.id||"",k=a.value&&a.value.name||c&&c.fields&&c.fields[d]&&c.fields[d].name||b&&b.defaultValue&&b.defaultValue.id||"";delete a.value;a.options=g.map(b.allowedValues,function(a){return{value:a.id,text:a.name,selected:k===a.name||e===a.id,iconUrl:a.iconUrl}});return a},getValue:g.bind(x,null,"id"),behavior:function(a,b,c,d){h.fn.auiSelect2?(a=a.find("select"),a.addClass("jira-select2-drop-box"),
a.auiSelect2({hasAvatar:!0,minimumResultsForSearch:-1,formatSelection:O,formatResult:O})):AJS.log("AUI version 5.2 or greater is required as this plugin needs the .auiSelect2() jQuery plugin.")}},X={template:f.fields.unrenderableTypeField,getContext:function(a,b,c){a.reasonContent=a.isRenderable?a.hasOperations?null:c?AJS.format("\u5728 Jira \u4e2d{0}\u7f16\u8f91{1}\u8fd9\u4e2a\u5b57\u6bb5\u3002",'\x3ca href\x3d"'+c.url+'"\x3e',"\x3c/a\x3e"):AJS.escapeHtml("\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u5728 Jira \u4e2d\u7f16\u8f91\u6b64\u5b57\u6bb5\u3002"):c?AJS.format("\u5728 Jira \u4e2d{0}\u7f16\u8f91{1}\u8fd9\u4e2a\u5b57\u6bb5\u3002",
'\x3ca href\x3d"'+c.url+'"\x3e',"\x3c/a\x3e"):AJS.escapeHtml("\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u5728 Jira \u4e2d\u7f16\u8f91\u6b64\u5b57\u6bb5\u3002");return a}},p={"com.pyxis.greenhopper.jira:gh-epic-label":v,string:v,summary:v,"com.atlassian.jira.plugin.system.customfieldtypes:textfield":v,"com.atlassian.jira.plugin.system.customfieldtypes:url":Z,environment:C,"com.atlassian.jira.plugin.system.customfieldtypes:textarea":C,description:C,"com.atlassian.jira.plugin.system.customfieldtypes:float":ca,array:T,"com.atlassian.jira.plugin.system.customfieldtypes:labels":T,
labels:ba,priority:ea,resolution:m,fixVersions:m,versions:m,components:m,security:m,"com.atlassian.jira.plugin.system.customfieldtypes:version":m,"com.atlassian.jira.plugin.system.customfieldtypes:multiversion":m,"com.atlassian.jira.plugin.system.customfieldtypes:project":m,assignee:aa,reporter:B,"com.atlassian.jira.plugin.system.customfieldtypes:userpicker":B,"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker":B,timetracking:da,duedate:V,"com.atlassian.jira.plugin.system.customfieldtypes:datepicker":V,
"com.atlassian.jira.plugin.system.customfieldtypes:multiselect":U,"com.atlassian.jira.plugin.system.customfieldtypes:select":U,"com.pyxis.greenhopper.jira:gh-sprint":{template:f.fields.stringField,getContext:n,getInternalValue:z,getValue:G,behavior:function(a,b,c,d){var e={minimumInputLength:0,formatResult:function(a){return f.fields.sprintSelect({name:a.text,state:a.state,board:a.board})},query:function(a){r(b,c,a.term,d).done(function(b){var c=g.groupBy(b,function(a){return a.suggestion?"suggestions":
"all"});b=["suggestions","all"].filter(function(a){return c[a]&&0<c[a].length}).map(function(a){return{text:"suggestions"===a?"\u5efa\u8bae":"\u5168\u90e8\u51b2\u523a",children:c[a]}});a.callback({results:g.compact(b)})})},initSelection:u(b,{id:-1,text:"\u9009\u62e9\u4e00\u4e2a\u51b2\u523a"})};return y(a,b,c,d,e)}},"com.pyxis.greenhopper.jira:gh-epic-link":{template:f.fields.stringField,getContext:n,getInternalValue:z,getValue:function(a){return(a=
t(a))&&""!==a?a:void 0},behavior:function(a,b,c,d){var e={minimumInputLength:0,formatResult:function(a){return f.fields.epicSelect({name:a.text,key:a.id})},query:function(a){r(b,c,a.term,d).done(function(b){var c=g.uniq(b.map(function(a){return a.list})).map(function(a){return{text:a,children:b.filter(function(b){return b.list===a})}});a.callback({results:c})})},initSelection:u(b,{id:-1,text:"\u9009\u62e9\u4e00\u4e2a\u957f\u7bc7\u6545\u4e8b"})};return y(a,b,c,d,e)}},"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes":{template:f.fields.checkboxField,
getContext:L,getValue:M},"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons":{template:f.fields.radioField,getContext:L,getValue:function(a){a=M(a);return 1===a.length?a[0]:null}}},fa={ignoreFieldsWithDefaultValue:!1},w={addFieldHandler:function(a,b){g.has(p,a)&&console&&console.warn&&console.warn("Redefining handler for type "+a+".");p[a]=b},getFieldHandler:A,getFieldType:q,isKnownRestType:function(a){return p.hasOwnProperty(a)},canRender:function(a){var b=q(a);return(b=p[b])?a.operations&&
a.operations.length&&(!b.canRender||b.canRender(a)):!1},getContext:function(a,b,c,d){return D(a,b,c||{},d||{})},renderField:function(a,b,c,d){a=D(a,b,c||{},d||{});return a.handler.template(a)},getInternalJSON:function(a){var b=P(a);return b&&b.getInternalValue&&b.getInternalValue(a)||S(a)},getJSON:S,attachFieldBehavior:R,attachFieldBehaviors:function(a,b,c){a.find(".jira-field").each(function(a,e){a=h(e);R(a,b,c)})},setFieldError:function(a,b){a.find(".error").remove();b&&(b=f.fields.errors({errorTexts:b}),
a.append(b))},renderCreateRequiredFields:function(a,b,c,d,e){function f(b){d.ignoreFieldsWithDefaultValue&&(b=g.filter(b,function(a){return!a.hasDefaultValue}));var f=g.filter(b,function(a){return!w.canRender(a)});f.length?e&&e(f):(a.html(g.map(b,function(a){return w.renderField(null,a,null,null)}).join("")),w.attachFieldBehaviors(a,{serverId:c.serverId,projectKey:c.projectKey},null))}d=g.extend({},fa,d);d.requiredFields?f(d.requiredFields):Y(c,d).done(f)}};return w});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/label-picker.js' */
define("jira-integration-plugin/label-picker",[],function(){var d=window.jiraIntegration.templates;return{build:function(c,e){c.auiSelect2({tags:!0,multiple:!0,tokenSeparators:[","," "],createSearchChoice:function(a){return a?{id:a,text:a,isNew:!0}:null},query:function(a){e(a.term).done(function(b){a.callback({results:b})})},formatResult:function(a){return d.fields.labelFieldResult({label:{labelName:a.text,isNew:a.isNew}})},initSelection:function(a,b){a=c.auiSelect2("val").map(function(a){return{id:a,
text:a}});b(a)}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.js' */
define("jira-integration-plugin/jira-create-issue-form",["jquery","jira-integration-plugin/custom-lodash","jira-integration-plugin/jira-create-issue-form-data","jira-integration-plugin/jira-create-issue-form-field-helper","jira-integration-plugin/fields"],function(d,f,h,g,k){function b(a){this.configuration=f.extend({},b.defaults,a);this.configuration.renderSummaryAndDescription&&this.configuration.excludedField.push("summary","description");this._init()}function p(a,c){var e={};a.find(".create-issue-required-fields").find("input, select, textarea, fieldset").not(".select2-input, .select2-focusser").each(function(a){var m=
d(this),b=m.attr("data-name");b&&(e[b]=c(m,b,a))});return e}function n(a){d(".aui-message",a).remove()}var l=window.jiraIntegration.templates;b.defaults={allowUnsupportedFields:!1,ignoreFieldsWithDefaultValue:!0,excludedField:["project","issuetype","reporter"],formClass:"jira-interation-create-issue-form",requiredFieldsOnly:!0,renderSummaryAndDescription:!1,get$unsupportedFieldMessage:function(a,c){return d(l.jiraCreateIssueForm.unsupportedFieldsMessage({unsupportedFields:a,createIssueUrl:c}))},get$unexpectedError:function(a){return d(aui.message.error({content:AJS.escapeHtml(a)}))},
get$communicationError:function(a){return d(l.jiraCreateIssueForm.communicationErrorMessage({message:a}))},get$unauthorizeMessage:function(a){return d(l.jiraCreateIssueForm.authorize({extraClasses:"jira-oauth-dialog",applicationName:a}))},get$unsupportedServerMessage:function(a){return d(l.jiraCreateIssueForm.unsupportedServerMessage({serverUrl:a}))},get$unrenderableRequiredFieldsMessage:function(a,c){var e=a.map(function(a){return AJS.escapeHtml(a.name)}).join(", ");return d(l.jiraCreateIssueForm.unrenderableRequiredFieldsMessage({names:e,
count:a.length,serverUrl:c}))},ajax:function(a){alert("JiraCreateIssueForm requires the option 'ajax(options)' to be specified and respond like jQuery.ajax.\nThis method should handle response status codes other than 200 and 500 (those are handled by us).")}};b.prototype._trigger=function(a,c){var e=this.configuration[a];e&&e.apply(this,Array.prototype.slice.call(arguments,1))};b.prototype._selectServer=function(a,c){var e=this;if(this.currentServerId!==a||c)this.currentServerId=a,this.formIsLoading(this.defaultFields.server),
h.isIssueCreationSupported(a,this.configuration.ajax).done(function(c){c?(e._loadProjectData(a),e.formLoadingCompleted(e.defaultFields.server)):(c=h.getServerById(a).displayUrl,e._handleUnsupportedServer(c))}).fail(function(a){a[0]&&a[0].authenticationUri?e._handleAuthorizeError(a[0]):e._handleAjaxError(a)})};b.prototype._bindEventListener=function(){var a=this;this.defaultFields.server.on("change",function(c){a.fieldValues=f.extend({},a.fieldValues,a._getFieldValues());a.resetForm(!0);(c=this.value)?
a._selectServer(c):(g.resetSelectField(a.defaultFields.project),a.defaultFields.project.trigger("change"));a._trigger("onServerChanged",this.value)});this.defaultFields.project.on("change",function(){var c=this.value||d(this).select2("data").value,e=d(a.defaultFields.issueType).select2("data");a.fieldValues=f.extend({},a.fieldValues,a._getFieldValues());c?(d('option[value\x3d""]',a.defaultFields.project).remove(),a._loadIssueType(a.currentServerId,c,e)):g.resetSelectField(a.defaultFields.issueType);
a._trigger("onProjectChanged",this.value)});this.defaultFields.issueType.on("change",function(){a.fieldValues=f.extend({},a.fieldValues,a._getFieldValues());a.resetForm(!0);this.value?a._loadFields(a.fieldValues):(a.$containerRequireField&&a.$containerRequireField.html(""),n(this.$form));a._trigger("onTypeChanged",this.value)})};b.prototype._getFieldValues=function(){return this._getJSON({getFieldJSON:k.getInternalJSON,$form:this.$form})};b.prototype._init=function(){this.container=d(this.configuration.container);
this.fieldValues={};if(this.container.length)this._renderForm(),this._bindEventListener(),this._loadServerData();else throw Error("container property should be defined.");};b.prototype._renderForm=function(){var a=this;this.$form=d(l.jiraCreateIssueForm.form({formClass:this.configuration.formClass})).on("aui-valid-submit",function(c){a.configuration.onSubmit&&(c.preventDefault(),a.configuration.onSubmit())}).on("focus",".fake-tabbable",function(){const a=d("div#select2-drop.select2-drop-active").children()[0];
a&&a.children.length&&a.getElementsByTagName("input")[0].focus()});this.configuration.renderSummaryAndDescription&&this._renderSummaryAndDescription();this.container.append(this.$form);this.defaultFields=this._getDefaultFields();f.each(this.defaultFields,f.bind(function(a){this.createSelect2WithIcon(d(a))},this));this.$containerRequireField=d(".create-issue-required-fields",this.container);this._trigger("onFormRendered")};b.prototype._renderSummaryAndDescription=function(){var a=d(".create-issue-default-fields",
this.$form);a.append(aui.form.textField({labelContent:"\u6458\u8981",isRequired:!0,name:"summary",value:this._getSummaryFromConfiguration()}));a.append(aui.form.textareaField({labelContent:"\u63cf\u8ff0",name:"description"}))};b.prototype._getDefaultFields=function(){return{server:d(".server-select",this.$form),project:d(".project-select",this.$form),issueType:d(".issuetype-select",this.$form)}};b.prototype._loadServerData=
function(){var a=this;this.formIsLoading(this.defaultFields.server);h.loadServers(a.configuration.ajax).then(function(c){a.formLoadingCompleted(a.defaultFields.server);a._loadServerDataComplete(c)})};b.prototype._loadFields=function(a){const c=this,e=f.extend({},this.getContextJSON(),a);this.formIsLoading(this.defaultFields.issueType);h.getFieldMetadata(e,c.configuration.ajax).done(function(a){const b=c._filterFields(a);c.configuration.renderSummaryAndDescription&&(a=a.find(a=>"description"===a.fieldId),
c._setDescriptionAsRequiredField(!(!a||!a.required)));a=c._unrenderableRequiredFields(b);0===a.length?(c._renderFields(b,e),c._trigger("onFieldsRendered")):c._handleUnrenderableRequiredFields(a);c._fieldTypeAnalytics(b);c.formLoadingCompleted(c.defaultFields.issueType)}).fail(f.bind(c._handleAjaxError,this))};b.prototype._loadServerDataComplete=function(a){a.length?(1===a.length&&g.hideField(this.defaultFields.server),this._hasMultiServer=1<a.length,g.fillSelectData(this.defaultFields.server,a,this.configuration.serverId||
a[0].id),this._selectServer(this.configuration.serverId||a[0].id)):this._handlerUnexpectedError("\u6ca1\u6709 Jira \u670d\u52a1\u5668, \u8bf7\u68c0\u67e5\u5e94\u7528\u94fe\u63a5\u914d\u7f6e\u3002")};b.prototype._loadProjectData=function(a){var c=this;this.formIsLoading(this.defaultFields.project);h.loadProjects(a,c.configuration.ajax).then(function(a){a.errors&&a.errors.length?(a=a.errors[0],a.authenticationUri?c._handleAuthorizeError(a):c._handlerUnexpectedError(a.message)):a.length?g.fillSelectData(c.defaultFields.project,a,c.configuration.projectId):
c._handlerUnexpectedError("\u60a8\u6ca1\u6709\u5728\u6b64 Jira \u670d\u52a1\u5668\u4e0a\u521b\u5efa\u95ee\u9898\u7684\u6743\u9650\u3002");c.formLoadingCompleted(c.defaultFields.project)},f.bind(c._handleAjaxError,this))};b.prototype._loadIssueType=function(a,c,e){const b=this;this.formIsLoading(this.defaultFields.issueType);h.loadIssueTypes(a,c,b.configuration.ajax).then(function(a){g.fillSelectData(b.defaultFields.issueType,a,e&&e.id);b.formLoadingCompleted(b.defaultFields.issueType)}).fail(function(a){404===a.status&&b._handleCommunicationError(AJS.format("\u65e0\u6cd5\u4e0e Jira \u8fdb\u884c\u901a\u4fe1\uff08HTTP \u9519\u8bef {0}\uff09",
404));b.formHasError()})};b.prototype._fieldTypeAnalytics=function(a){var c=a.map(function(a){var c=k.getFieldType(a);return{required:a.required,restType:c,knownRestType:k.isKnownRestType(c)}}).reduce(function(a,c){c.knownRestType?a[c.required?"requiredFields":"otherFields"].push(c.restType):a[c.required?"unknownRequiredFieldsCount":"unknownOtherFieldsCount"]++;return a},{requiredFields:[],otherFields:[],unknownRequiredFieldsCount:0,unknownOtherFieldsCount:0});c=Object.keys(c).reduce(function(a,b){var e=
c[b];if(!Array.isArray(e))return a[b]=e,a;var d=e.length;a[b+".size"]=d;for(var m=0;m<d;m++)a[b+"["+m+"]"]=e[m];return a},{});AJS.trigger("analytics",{name:"jira.integration.issue.create.form.displayed",data:c})};b.prototype._renderFields=function(a,c){this.$containerRequireField.html("");var b=f.reject(a,k.canRender);!this.configuration.allowUnsupportedFields&&b.length?this._handleUnsupportedFields(b):(this.$containerRequireField.html(f.map(a,function(a){return k.renderField(null,a,c,null)}).join("")),
k.attachFieldBehaviors(this.$containerRequireField,c,null),this._trigger("onRequiredFieldsRendered",a,b))};b.prototype._setError=function(a){n(this.$form);this.$form.prepend(a);this.formLoadingCompleted();this.formHasError()};b.prototype._handleCommunicationError=function(a){a=this.configuration.get$communicationError(a);this._setError(a)};b.prototype._handlerUnexpectedError=function(a){a=this.configuration.get$unexpectedError(a);this._setError(a)};b.prototype._handleUnsupportedFields=function(a){a=
f.map(a,function(a){return AJS.escapeHtml(a.name)});a=this.configuration.get$unsupportedFieldMessage(a,this._getCreateJiraIssueUrl());n(this.$form);this.$form.prepend(a);this._trigger("onError");this.formLoadingCompleted()};b.prototype._handleUnsupportedServer=function(a){a=this.configuration.get$unsupportedServerMessage(a);this._setError(a)};b.prototype._handleAjaxError=function(a){if(500<=a.status&&600>a.status){var c=a.responseJSON.errors&&a.responseJSON.errors[0],b=c&&c.exceptionName;b&&"com.atlassian.integration.jira.JiraCommunicationException"===
b?this._handleCommunicationError(c.message):this._handlerUnexpectedError(AJS.format("\u65e0\u6cd5\u4e0e Jira \u8fdb\u884c\u901a\u4fe1\uff08HTTP \u9519\u8bef {0}\uff09",a.status))}else this._handlerUnexpectedError("\u4ece Jira \u63a5\u6536\u5230\u610f\u5916\u54cd\u5e94\u3002");this.formHasError()};b.prototype._handleAuthorizeError=function(a){var c=this;this.formHasError();var b=this.configuration.get$unauthorizeMessage(a.applicationName);this.$form.append(b);d(".applink-authenticate",b).on("click",function(b){AppLinks.authenticateRemoteCredentials(a.authenticationUri,
function(){c.resetForm();c._selectServer(c.currentServerId,!0)},function(){c._handlerUnexpectedError(AJS.format("\u4f60\u5df2\u7ecf\u88ab\u62d2\u7edd\u5141\u8bb8\u8bbf\u95ee{0}\u3002",a.applicationName))});b.preventDefault()})};b.prototype._handleUnrenderableRequiredFields=function(a){a=this.configuration.get$unrenderableRequiredFieldsMessage(a,this._getCreateJiraIssueUrl());n(this.$form);this.$form.append(a);this.formLoadingCompleted()};b.prototype._getCreateJiraIssueUrl=function(){var a=this.defaultFields.project.find("option:selected").val(),
c=this.defaultFields.issueType.find("option:selected").val(),b=h.getServerById(this.currentServerId).displayUrl;b=b+"/secure/CreateIssueDetails!Init.jspa?pid\x3d"+a+"\x26issuetype\x3d"+c;a=this._getFieldValue("summary");a.length&&(b=b+"\x26summary\x3d"+encodeURIComponent(a));a=this._getFieldValue("description");a.length&&(b=b+"\x26description\x3d"+encodeURIComponent(a));return b};b.prototype._filterFields=function(a){var c=this;return f.filter(a,function(a){var b=a.schema?a.schema.system||a.schema.custom||
a.schema.customId:a;return!(c.configuration.excludedField&&c.configuration.excludedField.includes(b)||c.configuration.ignoreFieldsWithDefaultValue&&a.hasDefaultValue||c.configuration.requiredFieldsOnly&&!a.required)})};b.prototype._unrenderableRequiredFields=function(a){return a.filter(function(a){return a.required&&!k.canRender(a)})};b.prototype._getFieldValue=function(a){return(a=d("[name\x3d'"+a+"']",this.$form))?d.trim(a.val()):""};b.prototype._setDescriptionAsRequiredField=function(a){var c=
d('.field-group [name\x3d"description"]',this.$form).prev("label");c.find(".aui-icon.aui-icon-required").remove();a&&c.append(aui.icons.icon({icon:"required"}))};b.prototype._getSummaryFromConfiguration=function(){var a=this.configuration.initialSummary;delete this.configuration.initialSummary;return a};b.prototype._getJSON=function(a){if(!a.verbose)return p(a.$form,function(c,b,e){return a.getFieldJSON(c)});var c=h.getCachedFieldMetadataEntry(this.getContextJSON()).value,b=Object.keys(c.fields).reduce(function(a,
b){a[b]=k.getContext(null,c.fields[b],null,null);return a},{});return p(this.$form,function(c,e,d){var f=b[e];return{name:e,jiraType:f.jiraType,required:f.isRequired,label:f.labelText,value:a.getFieldJSON(c),index:d}})};b.prototype.resetForm=function(a){n(this.$form);d(".field-group",this.$form).show();this.configuration.renderSummaryAndDescription&&this._setDescriptionAsRequiredField(!1);this._hasMultiServer||g.hideField(this.defaultFields.server);this.$containerRequireField.html("");this.fieldValues=
a?this.fieldValues:{}};b.prototype.formHasError=function(){d(".field-group",this.$form).hide();this.$containerRequireField.html("");this._hasMultiServer&&g.showField(this.defaultFields.server);g.setFieldDisabled(d(".insert-issue-button"),!0);this._trigger("onError");this.formLoadingCompleted()};b.prototype.getCurrentServer=function(){return h.getServerById(this.currentServerId)};b.prototype.formIsLoading=function(a){a&&g.setIsLoading(a,!0);a=d(":input",d(this.$form));g.setFieldDisabled(a,!0)};b.prototype.formLoadingCompleted=
function(a){a?g.setIsLoading(a,!1):d(".aui-icon.aui-icon-wait",this.$form).remove();a=d(":input",d(this.$form));g.setFieldDisabled(a,!1)};b.prototype.createSelect2WithIcon=function(a){if(a.is(".server-select"))a.auiSelect2({minimumResultsForSearch:-1});else{var c=a.is(".project-select")?{formatSelection:this.projectSelectFormat,formatResult:this.projectSelectFormat,extraAttributes:this.defaultFields}:{formatSelection:this.issueTypeSelectFormat,formatResult:this.issueTypeSelectFormat,minimumResultsForSearch:-1,
extraAttributes:this.defaultFields};a.auiSelect2(c)}a.auiSelect2("val","")};b.prototype.projectSelectFormat=function(a){var c=this.extraAttributes.server.select2("data").id;c=h.getProjectIconUrl(c,a.id);return l.fields.select2WithIconOption({optionValue:a.text,iconUrl:c,isProject:!0})};b.prototype.issueTypeSelectFormat=function(a){var c=this.extraAttributes.server.select2("data").id,b=this.extraAttributes.project.select2("data").id;c=h.getIssueTypeIconUrl(c,b,a.id);return l.fields.select2WithIconOption({optionValue:a.text,
iconUrl:c,isProject:!1})};b.prototype.getContextJSON=function(){var a=this.defaultFields.project.val()||d(this.defaultFields.project).select2("data").value;return{serverId:this.currentServerId,projectId:a,projectKey:h.getProjectById(this.currentServerId,a).key,issueTypeId:this.defaultFields.issueType.val(),summary:this._getSummaryFromConfiguration()}};b.prototype.getJSON=function(a){return b.prototype._getJSON({getFieldJSON:k.getJSON,verbose:a,$form:this.$form})};b.prototype.renderErrors=function(a){p(this.$form,
function(c,b){c=c.closest(".jira-field");var d=function(a){return 0===a.indexOf(b)};if(a.hasOwnProperty(b)||Object.keys(a).some(d)){a.hasOwnProperty(b)||(b=Object.keys(a).filter(d)[0]);var e=Array.isArray(a[b])?a[b]:[a[b]]}k.setFieldError(c,e)})};b.prototype.submit=function(){this.$form.submit()};return b});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-data.js' */
define("jira-integration-plugin/jira-create-issue-form-data",["jquery"],function(e){function q(a){var c=new URL(a.avatarUrls["16x16"]);const b=c.searchParams;b.get("pid")||b.append("pid",a.id);b.get("avatarId")||(a=c.pathname.split("/"),c=a.lastIndexOf("avatar"),b.append("avatarId",a[c+1]));return b.toString()}function l(a){a=g(a.serverId,a.projectKey,a.issueTypeId);return{key:a,value:m[a]}}function k(a){if(!d[a])throw Error("Can only be called after server is loaded.");return d[a].projects}function g(a,
c,b){return a+(c?"-"+c:"")+(b?"-"+b:"")}var d={},m={},r=AJS.contextPath()+"/plugins/servlet/jira-integration/icons?serverId\x3d{0}\x26iconType\x3d{1}\x26{2}",h=[],f=function(a,c,b){return a({dataType:"json",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers"+(c||""),statusCode:b})};const p=(a,c,b=[])=>{b=b.filter(a=>!a.subtask);const n={};b.forEach(a=>{n[a.id]=a.iconUrl});const d=q(a);h[g(c,a.id)]={iconUrl:AJS.format(r,c,"project",d),issueTypes:n};return b},t=(a,c)=>k(a).filter(function(a){return a.id===
c})[0];return{loadServers:function(a){return f(a,"").done(function(a){a.forEach(function(a){d[a.id]=a})})},loadProjects:function(a,c){var b=d[a]&&d[a].projects;return b?e.Deferred().resolve(b):f(c,"/"+a+"/projects").done(function(b){b.length&&(b.forEach(function(b){p(b,a)}),d[a].projects=b)})},loadIssueTypes:(a,c,b)=>f(b,`/${a}/projects/${c}/issue-types`,{404:!1}).then(b=>{const d=t(a,c);return b?p(d,a,b):[]}),getFieldMetadata:function(a,c){var b=l(a);return b.value?e.Deferred().resolve(b.value):
f(c,"/"+a.serverId+"/projects/"+a.projectKey+"/issue-types/"+a.issueTypeId+"/fields-meta").done(function(a){m[b.key]=a})},getCachedFieldMetadataEntry:l,getServerById:function(a){return d[a]},getProjectIconUrl:function(a,c){a=g(a,c);return h[a]?h[a].iconUrl:""},getIssueTypeIconUrl:function(a,c,b){a=g(a,c);return(a=h[a])&&a.issueTypes[b]?a.issueTypes[b]:""},getProjects:k,getProjectById:function(a,c){a=k(a);if(!a)return null;for(var b=0,d=a.length;b<d;b++){var e=a[b];if(e.id===c)return e}return null},
isIssueCreationSupported:function(a,c){if(!d[a])throw Error("Can only be called after server is loaded.");return"issueCreationSupported"in d[a]?e.Deferred().resolve(d[a].issueCreationSupported):f(c,"/"+a+"/features").then(function(b){if(b.errors)return e.Deferred().reject(b.errors);if(!Array.isArray(b))return e.Deferred().reject("Unexpected response from Jira");d[a].issueCreationSupported=-1!==b.indexOf("CREATE_ISSUE");return d[a].issueCreationSupported})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-field-helper.js' */
define("jira-integration-plugin/jira-create-issue-form-field-helper",["jquery","jira-integration-plugin/custom-lodash"],function(d,g){function f(a){a=a.attr("data-placeholder");return aui.form.optionOrOptgroup({value:"",text:a,iconUrl:""})}return{fillSelectData:function(a,b,d){var e=[],c;b.forEach(function(a){var b={value:AJS.escapeHtml(a.id),text:a.name,iconUrl:a.iconUrl?a.iconUrl:a.avatarUrls?a.avatarUrls["16x16"]:""};d===a.id&&(b.selected=!0,c=a);e.push(aui.form.optionOrOptgroup(b))});c?(c.text=
c.name,a.html(e.join("")),a.auiSelect2("data",c).trigger("change")):(e.unshift(f(a)),a.html(e.join("")),a.auiSelect2("val","").trigger("change"))},resetSelectField:function(a){a.html(f(a));a.auiSelect2("val","").trigger("change")},hideField:function(a){a.parent().hide()},showField:function(a){a.parent().show()},setFieldDisabled:function(a,b){b?d.fn.disable?a.disable():a.prop("disabled",!0):d.fn.enable?a.enable():a.prop("disabled",!1)},setIsLoading:function(a,b){return b?a.after(aui.icons.icon({icon:"wait"})):
a.next(".aui-icon.aui-icon-wait").remove()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.soy' */
// This file was automatically generated from jira-create-issue-form.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.jiraCreateIssueForm.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.jiraCreateIssueForm == 'undefined') { jiraIntegration.templates.jiraCreateIssueForm = {}; }


jiraIntegration.templates.jiraCreateIssueForm.form = function(opt_data, opt_ignored) {
  return '' + aui.form.form({extraClasses: (opt_data.formClass ? opt_data.formClass + ' ' : '') + 'jira-create-form', method: 'post', action: '#', content: '<fieldset class="create-issue-default-fields"><div class="fake-tabbable" tabindex="0" /><div class="field-group" data-jira-type="server"><label>' + soy.$$escapeHtml('\u670d\u52a1\u5668') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box server-select medium-long-field" name="server" data-placeholder="' + soy.$$escapeHtml('\u9009\u62e9\u4e00\u4e2a\u670d\u52a1\u5668') + '"><option disabled selected value="">' + soy.$$escapeHtml('\u9009\u62e9\u4e00\u4e2a\u670d\u52a1\u5668') + '</option></select></div><div class="field-group" data-jira-type="project"><label>' + soy.$$escapeHtml('\u9879\u76ee') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box project-select medium-long-field" name="project" data-placeholder="' + soy.$$escapeHtml('\u9009\u62e9\u4e00\u4e2a\u9879\u76ee') + '"><option disabled selected value="">' + soy.$$escapeHtml('\u9009\u62e9\u4e00\u4e2a\u9879\u76ee') + '</option></select></div><div class="field-group" data-jira-type="issuetype"><label>' + soy.$$escapeHtml('\u95ee\u9898\u7c7b\u578b') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box issuetype-select" name="issue-type" data-placeholder="' + soy.$$escapeHtml('\u9009\u62e9\u95ee\u9898\u7c7b\u578b') + '"><option disabled selected value="">' + soy.$$escapeHtml('\u9009\u62e9\u95ee\u9898\u7c7b\u578b') + '</option></select></div></fieldset><fieldset class="create-issue-required-fields"></fieldset>'});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.form.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.form';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage = function(opt_data, opt_ignored) {
  var param28 = '';
  if (opt_data.unsupportedFields.length == 1) {
    var field__soy31 = '<strong>' + soy.$$escapeHtml(opt_data.unsupportedFields) + '</strong>';
    param28 += soy.$$filterNoAutoescape(AJS.format('\u5fc5\u586b\u5b57\u6bb5 {0} \u5728\u8fd9\u4e2a\u8868\u683c\u4e2d\u4e0d\u53ef\u7528\u3002\u60a8\u9700\u8981',field__soy31));
  } else {
    var fieldList__soy38 = '' + jiraIntegration.templates.jiraCreateIssueForm.buildFieldList({fields: opt_data.unsupportedFields});
    param28 += soy.$$filterNoAutoescape(AJS.format('\u5fc5\u586b\u5b57\u6bb5 {0} \u5728\u8fd9\u5f20\u8868\u683c\u4e2d\u4e0d\u53ef\u7528\u3002\u60a8\u9700\u8981',fieldList__soy38));
  }
  param28 += ' <a href="' + soy.$$escapeHtml(opt_data.createIssueUrl) + '" target="_blank">' + soy.$$escapeHtml('\u76f4\u63a5\u5728 Jira \u4e2d\u521b\u5efa\u4e8b\u52a1') + '</a>.';
  var output = '' + aui.message.warning({content: param28});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.buildFieldList = function(opt_data, opt_ignored) {
  var output = '';
  var joinText__soy50 = '' + ((opt_data.fields.length == 2) ? ' ' + soy.$$escapeHtml('\u548c') + ' ' : ', ');
  var fieldList58 = opt_data.fields;
  var fieldListLen58 = fieldList58.length;
  for (var fieldIndex58 = 0; fieldIndex58 < fieldListLen58; fieldIndex58++) {
    var fieldData58 = fieldList58[fieldIndex58];
    output += ((! (fieldIndex58 == 0)) ? soy.$$escapeHtml(joinText__soy50) : '') + '<strong>' + soy.$$escapeHtml(fieldData58) + '</strong>';
  }
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.buildFieldList.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.buildFieldList';
}


jiraIntegration.templates.jiraCreateIssueForm.authorize = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var applicationNameEscaped__soy67 = '' + soy.$$escapeHtml(opt_data.applicationName);
  output += aui.message.info({content: '' + soy.$$filterNoAutoescape(AJS.format('{0}\u767b\u5f55\u5e76\u6279\u51c6{1}\u4ece{2}\u68c0\u7d22\u51fa\u7684\u6570\u636e','<a class="oauth-init applink-authenticate" href="#">','</a>',applicationNameEscaped__soy67))});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.authorize.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.authorize';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '' + soy.$$filterNoAutoescape(AJS.format('\u4e0d\u652f\u6301\u6240\u9009\u7684 Jira \u670d\u52a1\u5668\u7248\u672c\u3002 \u60a8\u53ef\u80fd\u9700\u8981\u5347\u7ea7\u5230\u7248\u672c 5.x \u4ee5\u4e0a\u6216{0}\u5728 Jira \u4e2d\u521b\u5efa\u4e8b\u52a1{1}\u3002','<a href="' + opt_data.serverUrl + '" target="_blank">','</a>'))});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '' + soy.$$filterNoAutoescape(AJS.format('\u5fc5\u586b\u7684 {1,choice,1#\u4e2a\u5b57\u6bb5|1\x3c\u4e2a\u5b57\u6bb5} \x3cstrong\x3e{0}\x3c/strong\x3e{1,choice,1#\u5728|1\x3c\u5728}\u6b64\u5bf9\u8bdd\u4e2d\u4e0d\u53ef\u7528\u3002\u60a8\u9700\u8981{2}\u76f4\u63a5\u5728 Jira \u4e2d\u521b\u5efa\u4e8b\u52a1{3}\u3002',opt_data.names,opt_data.count,'<a href="' + opt_data.serverUrl + '" target="_blank">','</a>'))});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.error({titleContent: '' + soy.$$escapeHtml('\u5f88\u9057\u61be\uff0c\u6211\u4eec\u5728\u8fde\u63a5 Jira \u65f6\u9047\u5230\u4e86\u95ee\u9898'), content: '<p>' + soy.$$escapeHtml(opt_data.message) + '</p>'});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:proxy-js', location = '/jira/proxy.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{makeRequest:function(a){var b=contextPath||AJS.contextPath();if(a.processData)a.appId?a.data=AJS.$.extend(a.data||{},{appId:a.appId}):a.appType&&(a.data=AJS.$.extend(a.data||{},{appType:a.appType})),a.data=AJS.$.extend(a.data||{},{path:a.url});else{var d=a.url;a=AJS.$.extend(a,{beforeSend:function(c){a.appId?c.setRequestHeader("X-AppId",a.appId):a.appType&&c.setRequestHeader("X-AppType",a.appType);c.setRequestHeader("X-AppPath",d)}})}a=AJS.$.extend(a,{url:b+
"/plugins/servlet/applinks/proxy"});return AJS.$.ajax(a)},createProxyGetUrl:function(a){var b="";a.includeContext&&(b=contextPath||AJS.contextPath());b+="/plugins/servlet/applinks/proxy";if(a.appId)b+="?appId\x3d"+encodeURIComponent(a.appId);else if(a.appType)b+="?appType\x3d"+encodeURIComponent(a.appType);else return AJS.log("You need to specify an appType or appId"),"";a.path&&(b+="\x26path\x3d"+encodeURIComponent(a.path));return b}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jqlHelper', location = '/jira/jqlhelper.js' */
AJS.JQLHelper=function(){var m=/^\s*((key|issuekey)\s*=\s*)?"*([A-Z]+)([0-9]+)?([A-Z]+)?-([0-9]+)"*\s*$/i,h=/\s*([A-Z][A-Z]+)-[0-9]+\s*/,n=/(issue|searchrequest)-xml/i,k=/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/i,p=/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,l=/(jqlQuery|jql)\s*=([^&]+)/i,e=/(\?|&)(requestId|filter)=([^&]+)/i,f=/(searchrequest-xml\/)([0-9]+)\/SearchRequest/i,q=/=|!=|~|>|<|!~| is | in | was | changed /i,g=function(a){var b=
"",c=k.exec(a);c?b="key\x3d"+c[2]:(c=l.exec(a))?b=c[2]:(a=h.exec(a))&&(b="key\x3d"+a[0]);return b=b.replace(/\+/g," ")},r=function(a,b){var c;a=decodeURIComponent(a);AJS.JQLHelper.getJqlQueryFromJiraFilter(a,b,function(d){d.jql&&(c=d.jql)});return c};return{isSingleKeyJQLExp:function(a){return m.exec(a)},isMultipleSingleKeyJQLExp:function(a){a=a.split(",");for(var b in a){var c=AJS.$.trim(a[b]);if(!AJS.JQLHelper.isSingleKeyJQLExp(c))return!1}return!0},isIssueUrlOrXmlUrl:function(a){return k.test(a)||
n.test(a)||l.test(a)||p.test(a)?!0:!1},isFilterUrl:function(a){return e.test(a)||f.test(a)},getFilterFromFilterUrl:function(a){if(e.test(a))return a=e.exec(a),a[2]+"\x3d"+a[3];if(f.test(a))return"filter\x3d"+f.exec(a)[2]},getJqlQueryFromJiraFilter:function(a,b,c,d){a=(e.exec(a)||f.exec(a))[2];b="/rest/jiraanywhere/1.0/jira/appLink/"+b+"/filter/"+a;AJS.$.ajax({async:!1,dataType:"json",url:Confluence.getContextPath()+b,success:c,error:d})},findServerIndexFromUrl:function(a,b){if("undefined"!==typeof b||
0<b.length)for(var c=a.toLowerCase(),d=0;d<b.length;d++)if(0==c.indexOf(b[d].url.toLowerCase())&&"/"==a.charAt(b[d].url.length))return d;return-1},getJqlQueryFromUrl:g,getJqlAndServerIndexFromUrl:function(a,b){var c={};c.serverIndex=this.findServerIndexFromUrl(a,b);c.jqlQuery=g(a);return c},checkQueryType:function(a){if(AJS.Editor.JiraAnalytics&&a&&0!=AJS.$.trim(a).length)return 0!=a.indexOf("http")?AJS.Editor.JiraAnalytics.linkTypes.jqlDirect:-1!=a.indexOf("jira.issueviews:searchrequest-xml")||-1!=
a.indexOf("jira.issueviews:issue-xml")?AJS.Editor.JiraAnalytics.linkTypes.xml:-1!=a.indexOf("jira.issueviews:searchrequest-rss")?AJS.Editor.JiraAnalytics.linkTypes.rss:-1!=a.indexOf("filter\x3d")||-1!=a.indexOf("filter\\\x3d")?AJS.Editor.JiraAnalytics.linkTypes.filter:AJS.Editor.JiraAnalytics.linkTypes.jql},convertToJQL:function(a,b){if(""!==AJS.$.trim(a))if(0===a.indexOf("http")&&this.isFilterUrl(a))var c=r(a,b);else 0===a.indexOf("http")&&this.isIssueUrlOrXmlUrl(a)?(a=g(decodeURIComponent(a)),0<
a.length&&(c=a)):c=0!==a.indexOf("http")&&a.match(q)?a:a.match(h)?"key\x3d"+a:'summary ~ "'+a+'" OR description ~ "'+a+'"';return c}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:legacy-editor-global-AVOID-IF-POSSIBLE', location = '/includes/js/amd/shim/confluence-editor-amd.js' */
define("confluence-editor/legacy",["confluence/legacy"],function(a){"undefined"===typeof a&&(a={});"undefined"===typeof a.Editor&&(a.Editor={});return a.Editor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/js/draft-changes.js' */
define("confluence/draft-changes","jquery ajs window confluence/legacy confluence/api/ajax confluence/api/event confluence/api/logger confluence/analytics-support confluence/dark-features confluence/meta confluence/aui-overrides wrm/context-path".split(" "),function(b,d,q,c,v,r,n,k,s,j,t,l){return{init:function(){var a,p=function(a){var c="\u60a8\u786e\u5b9a\u8981\u4e22\u5f03\u8fd9\u4e9b\u672a\u53d1\u8868\u7684\u53d8\u66f4\u5417\uff1f",f=b("#draft-"+a),h;if(confirm(c)){c=l()+"/rest/api/content/"+a+"?status=draft";h=b.ajax;h({url:c,type:"DELETE",data:{draftId:a},
contentType:"application/json",dataType:"json",success:function(a){if(a&&a.actionErrors){for(var b=["<ul>"],a=a.actionErrors,c=0;c<a.length;c++){n.log("error: "+a[c]);b.push("<li>"+a[c]+"</li>")}b.push("</ul>");d.messages.error("#errors",{title:"\u9519\u8bef",body:"\u5220\u9664\u8349\u7a3f\u65f6\u53d1\u751f\u9519\u8bef\u3002"+" "+b.join("\n")})}else{b=f.closest("table");a=b.closest(".drafts-container");f.remove();b.find("tbody tr").length===0&&a.append('<span id="no-drafts-message">'+
"\u672a\u627e\u5230\u8349\u7a3f\u3002"+"</span>")}},error:function(a){d.messages.error("#errors",{title:"\u5220\u9664\u8349\u7a3f\u65f6\u53d1\u751f\u9519\u8bef\u3002",body:a.errors||"\u53d1\u751f\u672a\u77e5\u9519\u8bef. \u8bf7\u68c0\u67e5\u65e5\u5fd7."})}});return true}return false};b("body").on("click",".view-diff-link",function(u){var o=this.id,f=b(this);if(!a){var h=o==="view-diff-link-notification";a=new d.Dialog(860,530,"view-diff-draft-dialog");var e="\u0027{0}\u0027\u7684\u672a\u53d1\u5e03\u66f4\u65b0";a.addHeader(e.replace(/\{0\}/,""));e=b(c.Templates.DraftChanges.dialogContent());
a.addPanel("Diff",e);if(h){a.addButton("\u7f16\u8f91",function(){a.hide();c.Editor&&c.Editor.Drafts?c.Editor.Drafts.useDraft():q.location=b(this).attr("data-href")},"resume-diff-link");a.addButton("\u653e\u5f03",function(){if(s.isEnabled("editor.ajax.save")&&j.get("remote-user")!==""){c.Editor.SafeSave.Draft.discardDraft(d.params.pageId,j.get("existing-draft-id")).done(c.Editor.SafeSave.Draft.onSuccessDiscardDraft).fail(c.Editor.SafeSave.Draft.onErrorDiscardDraft);a.hide()}else if(c.Editor&&
c.Editor.Drafts){a.hide();c.Editor.Drafts.discardDraft(j.get("existing-draft-id"));k.publish("rte.notification.draft.discard")}else{var g=b(this).data("draftid");p(g)&&a.hide()}},"discard-diff-link")}a.addCancel("\u53d6\u6d88",function(){a.hide();return false});e.removeClass("hidden")}a.addHeader("\u6b63\u5728\u8bfb\u53d6");b("#diff-view").html("<tr><td id='draft-changes-waiting-icon'>Loading...</td></tr>");var m,e=f.attr("class"),i=/draftPageId:([^ ]*)/.exec(e),f=i?i[1]:j.get("page-id"),
h=(i=/username:([^ ]*)/.exec(e))?i[1]:j.get("remote-user");m=(i=/draftId:([^ ]*)/.exec(e))?i[1]:null;b.ajax({url:l()+"/draftchanges/viewdraftchanges.action",type:"GET",dataType:"json",data:{pageId:f,username:h},success:function(g){if(g.actionErrors){for(var e="",g=g.actionErrors,f=0;f<g.length;f++){n.log("error: "+g[f]);e=e+"<div>"+g[f]+"</div>"}b("#diff-view").html(e)}else{b("#diff-view").html(g.htmlDiff);e=d.format("\u0027\u0027{0}\u0027\u0027\u7684\u672a\u53d1\u5e03\u66f4\u65b0",d.escapeHtml(g.title));a.addHeader(e);a.popup.element.find(".dialog-title").prepend(c.Templates.DraftChanges.helpLink());
b(".resume-diff-link").attr("data-href",l()+"/pages/resumedraft.action?draftId="+m);b(".discard-diff-link").data("draftid",m);t.setVisible("#merge-warning",g.isMergeRequired)}},error:function(a){a=a.errors||"An unknown error has occurred. Please check your logs";b("#diff-view").html(a)}});a.show();r.trigger("analytics",{name:"confluence.editor.view-diff-dialog.open",data:{elementTriggerId:o}});u.stopPropagation();return false});b(".drafts-by-space li.draft-actions-list-item").on("click",".discard-draft-link",
function(a){a.preventDefault();k.publish("confluence.draft-list.discard");a=b(this).data("draftid");p(a)}).on("click",".resume-draft-link",function(){k.publish("confluence.drafts.referrer",{referrerPage:"drafts",lozengeType:"Draft"})})}}});require("confluence/module-exporter").safeRequire("confluence/draft-changes",function(b){require("ajs").toInit(b.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/soy/draft-changes-dialog.soy' */
// This file was automatically generated from draft-changes-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.DraftChanges.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.DraftChanges == 'undefined') { Confluence.Templates.DraftChanges = {}; }


Confluence.Templates.DraftChanges.dialogContent = function(opt_data, opt_ignored) {
  return '<div id="draft-changes-dialog" class="hidden"><div id="diff-view" class="wiki-content"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.DraftChanges.dialogContent.soyTemplateName = 'Confluence.Templates.DraftChanges.dialogContent';
}


Confluence.Templates.DraftChanges.helpLink = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-80/Drafts#viewchange"});
};
if (goog.DEBUG) {
  Confluence.Templates.DraftChanges.helpLink.soyTemplateName = 'Confluence.Templates.DraftChanges.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:attachments-insert-utils-resources', location = 'utils/attachments-insert-utils.js' */
define("confluence-editor/utils/attachments-insert-utils",["underscore","confluence/meta","jquery"],function(c,b,d){return{insertFilePlaceholder:function(a,e,f){var g=require("tinymce");a.height="comment"===b.get("content-type")?"150":"250";a.ownerId&&a.ownerId===b.get("content-id")&&(delete a.page,delete a.space,delete a.date);a=c.omit(c.pick(a,"name","page","space","date","height"),function(a){return!a});a={contentId:b.get("content-id")||"0",macro:{name:"view-file",params:a}};g.confluence.MacroUtils.insertMacro(a,
e).done(function(a){f&&d(a).click()})}}});require("confluence/module-exporter").safeRequire("confluence-editor/utils/attachments-insert-utils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-editor-plugin:split_vendors~core~page-editor-quit-dialog', location = 'vendors~core~page-editor-quit-dialog.js' */
(window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff=window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff||[]).push([["vendors~core~page-editor-quit-dialog"],{0:function(e,t,o){"use strict";(function(t){e.exports="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this}).call(this,o(18))},18:function(e,t){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"==typeof window&&(o=window)}e.exports=o}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-editor-plugin:split_vendors~core', location = 'vendors~core.js' */
(window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff=window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff||[]).push([["vendors~core"],[,,,,,,function(e,t,n){(function(t,n){!function(){"use strict";var r=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},o=function(e){return{eq:e}},i=o((function(e,t){return e===t})),u=function(e){return o((function(t,n){if(t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e.eq(t[o],n[o]))return!1;return!0}))},a=function(e,t){return function(e,t){return o((function(n,r){return e.eq(t(n),t(r))}))}(u(e),(function(e){return function(e,t){return Array.prototype.slice.call(e).sort(t)}(e,t)}))},c=function(e){return o((function(t,n){var r=Object.keys(t),o=Object.keys(n);if(!a(i).eq(r,o))return!1;for(var u=r.length,c=0;c<u;c++){var f=r[c];if(!e.eq(t[f],n[f]))return!1}return!0}))},f=o((function(e,t){if(e===t)return!0;var n=r(e);return n===r(t)&&(function(e){return-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(e)}(n)?e===t:"array"===n?u(f).eq(e,t):"object"===n&&c(f).eq(e,t))})),l=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},s=function(e){return function(t){return typeof t===e}},d=function(e){return function(t){return e===t}},m=l("string"),g=l("object"),p=l("array"),h=d(null),v=s("boolean"),b=d(void 0),y=function(e){return null==e},C=function(e){return!y(e)},w=s("function"),x=s("number"),S=function(){},T=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))}},k=function(e,t){return function(n){return e(t(n))}},N=function(e){return function(){return e}},E=function(e){return e},R=function(e,t){return e===t};function _(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var D=function(e){return function(t){return!e(t)}},A=function(e){return e()},O=function(e){e()},B=N(!1),P=N(!0),L=function(){return I},I=function(){var e=function(e){return e()},t=E;return{fold:function(e,t){return e()},isSome:B,isNone:P,getOr:t,getOrThunk:e,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:N(null),getOrUndefined:N(void 0),or:t,orThunk:e,map:L,each:S,bind:L,exists:B,forall:P,filter:function(){return L()},toArray:function(){return[]},toString:N("none()")}}(),M=function(e){var t=N(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},isSome:P,isNone:B,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return M(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:I},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},F={some:M,none:L,from:function(e){return null==e?I:M(e)}},j=Array.prototype.slice,U=Array.prototype.indexOf,z=Array.prototype.push,H=function(e,t){return U.call(e,t)},V=function(e,t){return H(e,t)>-1},q=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},W=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},$=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},K=function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n)}},X=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var u=e[o];(t(u,o)?n:r).push(u)}return{pass:n,fail:r}},G=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},Y=function(e,t,n){return K(e,(function(e,r){n=t(n,e,r)})),n},Q=function(e,t,n){return $(e,(function(e,r){n=t(n,e,r)})),n},J=function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return F.some(i);if(n(i,r))break}return F.none()},Z=function(e,t){return J(e,t,B)},ee=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return F.some(n)}return F.none()},te=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!p(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);z.apply(t,e[n])}return t}(W(e,t))},ne=function(e,t){for(var n=0,r=e.length;n<r;++n){if(!0!==t(e[n],n))return!1}return!0},re=function(e){var t=j.call(e,0);return t.reverse(),t},oe=function(e,t){return G(e,(function(e){return!V(t,e)}))},ie=function(e,t){var n=j.call(e,0);return n.sort(t),n},ue=function(e,t){return t>=0&&t<e.length?F.some(e[t]):F.none()},ae=function(e){return ue(e,0)},ce=function(e){return ue(e,e.length-1)},fe=w(Array.from)?Array.from:function(e){return j.call(e)},le=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return F.none()},se=Object.keys,de=Object.hasOwnProperty,me=function(e,t){for(var n=se(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},ge=function(e,t){return pe(e,(function(e,n){return{k:n,v:t(e,n)}}))},pe=function(e,t){var n={};return me(e,(function(e,r){var o=t(e,r);n[o.k]=o.v})),n},he=function(e){return function(t,n){e[n]=t}},ve=function(e,t,n,r){return me(e,(function(e,o){(t(e,o)?n:r)(e,o)})),{}},be=function(e,t){var n={};return ve(e,t,he(n),S),n},ye=function(e){return function(e,t){var n=[];return me(e,(function(e,r){n.push(t(e,r))})),n}(e,E)},Ce=function(e,t){return we(e,t)?F.from(e[t]):F.none()},we=function(e,t){return de.call(e,t)},xe=function(e,t){return we(e,t)&&void 0!==e[t]&&null!==e[t]},Se=Array.isArray,Te=function(e,t,n){var r,o;if(!e)return!1;if(n=n||e,void 0!==e.length){for(r=0,o=e.length;r<o;r++)if(!1===t.call(n,e[r],r,e))return!1}else for(r in e)if(we(e,r)&&!1===t.call(n,e[r],r,e))return!1;return!0},ke=function(e,t){var n=[];return Te(e,(function(r,o){n.push(t(r,o,e))})),n},Ne=function(e,t){var n=[];return Te(e,(function(r,o){t&&!t(r,o,e)||n.push(r)})),n},Ee=function(e,t){if(e)for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},Re=function(e,t,n,r){for(var o=b(n)?e[0]:n,i=0;i<e.length;i++)o=t.call(r,o,e[i],i);return o},_e=function(e,t,n){var r,o;for(r=0,o=e.length;r<o;r++)if(t.call(n,e[r],r,e))return r;return-1},De=function(e){return e[e.length-1]},Ae=function(){return(Ae=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Oe(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var Be=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}},Pe=function(){return Le(0,0)},Le=function(e,t){return{major:e,minor:t}},Ie={nu:Le,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?Pe():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return Le(r(1),r(2))}(e,n)},unknown:Pe},Me=function(e,t){var n=String(t).toLowerCase();return Z(e,(function(e){return e.search(n)}))},Fe=function(e,t){return-1!==e.indexOf(t)},je=function(e,t){return function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t}(e,t,0)},Ue=function(e){return function(t){return t.replace(e,"")}},ze=Ue(/^\s+|\s+$/g),He=Ue(/^\s+/g),Ve=Ue(/\s+$/g),qe=function(e){return e.length>0},We=function(e){return!qe(e)},$e=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ke=function(e){return function(t){return Fe(t,e)}},Xe=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Fe(e,"edge/")&&Fe(e,"chrome")&&Fe(e,"safari")&&Fe(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,$e],search:function(e){return Fe(e,"chrome")&&!Fe(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Fe(e,"msie")||Fe(e,"trident")}},{name:"Opera",versionRegexes:[$e,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ke("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ke("firefox")},{name:"Safari",versionRegexes:[$e,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Fe(e,"safari")||Fe(e,"mobile/"))&&Fe(e,"applewebkit")}}],Ge=[{name:"Windows",search:Ke("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Fe(e,"iphone")||Fe(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ke("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ke("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ke("linux"),versionRegexes:[]},{name:"Solaris",search:Ke("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ke("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Ke("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Ye={browsers:N(Xe),oses:N(Ge)},Qe=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},Je={unknown:function(){return Qe({current:void 0,version:Ie.unknown()})},nu:Qe,edge:N("Edge"),chrome:N("Chrome"),ie:N("IE"),opera:N("Opera"),firefox:N("Firefox"),safari:N("Safari")},Ze=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},et={unknown:function(){return Ze({current:void 0,version:Ie.unknown()})},nu:Ze,windows:N("Windows"),ios:N("iOS"),android:N("Android"),linux:N("Linux"),osx:N("OSX"),solaris:N("Solaris"),freebsd:N("FreeBSD"),chromeos:N("ChromeOS")},tt=function(e,t,n){var r=Ye.browsers(),o=Ye.oses(),i=t.bind((function(e){return function(e,t){return le(t.brands,(function(t){var n=t.brand.toLowerCase();return Z(e,(function(e){var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return{current:e.name,version:Ie.nu(parseInt(t.version,10),0)}}))}))}(r,e)})).orThunk((function(){return function(e,t){return Me(e,t).map((function(e){var n=Ie.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(r,e)})).fold(Je.unknown,Je.nu),u=function(e,t){return Me(e,t).map((function(e){var n=Ie.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(o,e).fold(et.unknown,et.nu),a=function(e,t,n,r){var o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,u=e.isiOS()||e.isAndroid(),a=u||r("(pointer:coarse)"),c=o||!i&&u&&r("(min-device-width:768px)"),f=i||u&&!c,l=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),s=!f&&!c&&!l;return{isiPad:N(o),isiPhone:N(i),isTablet:N(c),isPhone:N(f),isTouch:N(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:N(l),isDesktop:N(s)}}(u,i,e,n);return{browser:i,os:u,deviceType:a}},nt=function(e){return window.matchMedia(e).matches},rt=Be((function(){return tt(navigator.userAgent,F.from(navigator.userAgentData),nt)})),ot=function(){return rt()},it=navigator.userAgent,ut=ot(),at=ut.browser,ct=ut.os,ft=ut.deviceType,lt=/WebKit/.test(it)&&!at.isEdge(),st="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL,dt=-1!==it.indexOf("Windows Phone"),mt={opera:at.isOpera(),webkit:lt,ie:!(!at.isIE()&&!at.isEdge())&&at.version.major,gecko:at.isFirefox(),mac:ct.isOSX()||ct.isiOS(),iOS:ft.isiPad()||ft.isiPhone(),android:ct.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:window.getSelection&&"Range"in window,documentMode:at.isIE()?document.documentMode||7:10,fileApi:st,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!at.isIE(),desktop:ft.isDesktop(),windowsPhone:dt,browser:{current:at.current,version:at.version,isChrome:at.isChrome,isEdge:at.isEdge,isFirefox:at.isFirefox,isIE:at.isIE,isOpera:at.isOpera,isSafari:at.isSafari},os:{current:ct.current,version:ct.version,isAndroid:ct.isAndroid,isChromeOS:ct.isChromeOS,isFreeBSD:ct.isFreeBSD,isiOS:ct.isiOS,isLinux:ct.isLinux,isOSX:ct.isOSX,isSolaris:ct.isSolaris,isWindows:ct.isWindows},deviceType:{isDesktop:ft.isDesktop,isiPad:ft.isiPad,isiPhone:ft.isiPhone,isPhone:ft.isPhone,isTablet:ft.isTablet,isTouch:ft.isTouch,isWebView:ft.isWebView}},gt=/^\s*|\s*$/g,pt=function(e){return null==e?"":(""+e).replace(gt,"")},ht=function(e,t){return t?!("array"!==t||!Se(e))||typeof e===t:void 0!==e},vt=function(e,t,n,r){r=r||this,e&&(n&&(e=e[n]),Te(e,(function(e,o){if(!1===t.call(r,e,o,n))return!1;vt(e,t,n,r)})))},bt={trim:pt,isArray:Se,is:ht,toArray:function(e){if(Se(e))return e;for(var t=[],n=0,r=e.length;n<r;n++)t[n]=e[n];return t},makeMap:function(e,t,n){var r;for(t=t||",","string"==typeof(e=e||[])&&(e=e.split(t)),n=n||{},r=e.length;r--;)n[e[r]]={};return n},each:Te,map:ke,grep:Ne,inArray:Ee,hasOwn:we,extend:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var o=t[r];for(var i in o)if(we(o,i)){var u=o[i];void 0!==u&&(e[i]=u)}}return e},create:function(e,t,n){var r,o,i,u=0,a=(e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e))[3].match(/(^|\.)(\w+)$/i)[2],c=this.createNS(e[3].replace(/\.\w+$/,""),n);if(!c[a]){if("static"===e[2])return c[a]=t,void(this.onCreate&&this.onCreate(e[2],e[3],c[a]));t[a]||(t[a]=function(){},u=1),c[a]=t[a],this.extend(c[a].prototype,t),e[5]&&(r=this.resolve(e[5]).prototype,o=e[5].match(/\.(\w+)$/i)[1],i=c[a],c[a]=u?function(){return r[o].apply(this,arguments)}:function(){return this.parent=r[o],i.apply(this,arguments)},c[a].prototype[a]=c[a],this.each(r,(function(e,t){c[a].prototype[t]=r[t]})),this.each(t,(function(e,t){r[t]?c[a].prototype[t]=function(){return this.parent=r[t],e.apply(this,arguments)}:t!==a&&(c[a].prototype[t]=e)}))),this.each(t.static,(function(e,t){c[a][t]=e}))}},walk:vt,createNS:function(e,t){var n,r;for(t=t||window,e=e.split("."),n=0;n<e.length;n++)t[r=e[n]]||(t[r]={}),t=t[r];return t},resolve:function(e,t){var n,r;for(t=t||window,n=0,r=(e=e.split(".")).length;n<r&&(t=t[e[n]]);n++);return t},explode:function(e,t){return!e||ht(e,"array")?e:ke(e.split(t||","),pt)},_addCacheSuffix:function(e){var t=mt.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},yt=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},Ct={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return yt(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return yt(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return yt(n)},fromDom:yt,fromPoint:function(e,t,n){return F.from(e.dom.elementFromPoint(t,n)).map(yt)}},wt=function(e,t){var n=[],r=function(e){return n.push(e),t(e)},o=t(e);do{o=o.bind(r)}while(o.isSome());return n},xt=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},St=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},Tt=function(e,t){return e.dom===t.dom},kt=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},Nt=function(e,t){return ot().browser.isIE()?kt(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)};"undefined"!=typeof window?window:Function("return this;")();var Et=function(e){return e.dom.nodeName.toLowerCase()},Rt=function(e){return e.dom.nodeType},_t=function(e){return function(t){return Rt(t)===e}},Dt=_t(1),At=_t(3),Ot=_t(9),Bt=_t(11),Pt=function(e){return Ct.fromDom(e.dom.ownerDocument)},Lt=function(e){return Ot(e)?e:Pt(e)},It=function(e){return Ct.fromDom(Lt(e).dom.defaultView)},Mt=function(e){return F.from(e.dom.parentNode).map(Ct.fromDom)},Ft=function(e){return F.from(e.dom.previousSibling).map(Ct.fromDom)},jt=function(e){return F.from(e.dom.nextSibling).map(Ct.fromDom)},Ut=function(e){return re(wt(e,Ft))},zt=function(e){return wt(e,jt)},Ht=function(e){return W(e.dom.childNodes,Ct.fromDom)},Vt=function(e,t){var n=e.dom.childNodes;return F.from(n[t]).map(Ct.fromDom)},qt=function(e){return Vt(e,0)},Wt=function(e){return Vt(e,e.dom.childNodes.length-1)},$t=function(e){return e.dom.childNodes.length},Kt=function(e){return Bt(e)&&C(e.dom.host)},Xt=w(Element.prototype.attachShadow)&&w(Node.prototype.getRootNode),Gt=N(Xt),Yt=Xt?function(e){return Ct.fromDom(e.dom.getRootNode())}:Lt,Qt=function(e){return Kt(e)?e:function(e){var t=e.dom.head;if(null==t)throw new Error("Head is not available yet");return Ct.fromDom(t)}(Lt(e))},Jt=function(e){return Ct.fromDom(e.dom.host)},Zt=function(e){return C(e.dom.shadowRoot)},en=function(e,t){Mt(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},tn=function(e,t){jt(e).fold((function(){Mt(e).each((function(e){rn(e,t)}))}),(function(e){en(e,t)}))},nn=function(e,t){qt(e).fold((function(){rn(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))},rn=function(e,t){e.dom.appendChild(t.dom)},on=function(e,t){$(t,(function(t){rn(e,t)}))},un=function(e){e.dom.textContent="",$(Ht(e),(function(e){an(e)}))},an=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},cn=function(e){var t,n=Ht(e);n.length>0&&(t=e,$(n,(function(e){en(t,e)}))),an(e)},fn=function(e){var t=At(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n=t.ownerDocument;return function(e){var t=Yt(e);return Kt(t)?F.some(t):F.none()}(Ct.fromDom(t)).fold((function(){return n.body.contains(t)}),k(fn,Jt))},ln=function(e,t){return{left:e,top:t,translate:function(n,r){return ln(e+n,t+r)}}},sn=ln,dn=function(e,t){return void 0!==e?e:void 0!==t?t:0},mn=function(e){var t=e.dom,n=t.ownerDocument.body;return n===t?sn(n.offsetLeft,n.offsetTop):fn(e)?function(e){var t=e.getBoundingClientRect();return sn(t.left,t.top)}(t):sn(0,0)},gn=function(e){var t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return sn(n,r)},pn=function(e,t,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollTo(e,t)},hn=function(e,t){ot().browser.isSafari()&&w(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},vn=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},bn=function(e){var t=void 0===e?window:e,n=t.document,r=gn(Ct.fromDom(n));return function(e){var t=void 0===e?window:e;return ot().browser.isFirefox()?F.none():F.from(t.visualViewport)}(t).fold((function(){var e=t.document.documentElement,n=e.clientWidth,o=e.clientHeight;return vn(r.left,r.top,n,o)}),(function(e){return vn(Math.max(e.pageLeft,r.left),Math.max(e.pageTop,r.top),e.width,e.height)}))},yn=function(e){return function(t){return!!t&&t.nodeType===e}},Cn=function(e){return!!e&&!Object.getPrototypeOf(e)},wn=yn(1),xn=function(e){var t=e.map((function(e){return e.toLowerCase()}));return function(e){if(e&&e.nodeName){var n=e.nodeName.toLowerCase();return V(t,n)}return!1}},Sn=function(e,t){var n=t.toLowerCase().split(" ");return function(t){if(wn(t))for(var r=0;r<n.length;r++){var o=t.ownerDocument.defaultView.getComputedStyle(t,null);if((o?o.getPropertyValue(e):null)===n[r])return!0}return!1}},Tn=function(e){return function(t){return wn(t)&&t.hasAttribute(e)}},kn=function(e){return wn(e)&&e.hasAttribute("data-mce-bogus")},Nn=function(e){return wn(e)&&"TABLE"===e.tagName},En=function(e){return function(t){if(wn(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1}},Rn=xn(["textarea","input"]),_n=yn(3),Dn=yn(8),An=yn(9),On=yn(11),Bn=xn(["br"]),Pn=xn(["img"]),Ln=En("true"),In=En("false"),Mn=xn(["td","th"]),Fn=xn(["video","audio","object","embed"]),jn=function(e,t,n){return void 0===n&&(n=R),e.exists((function(e){return n(e,t)}))},Un=function(e,t,n){return e.isSome()&&t.isSome()?F.some(n(e.getOrDie(),t.getOrDie())):F.none()},zn=function(e){return void 0!==e.style&&w(e.style.getPropertyValue)},Hn=function(e,t,n){if(!(m(n)||v(n)||x(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Vn=function(e,t,n){Hn(e.dom,t,n)},qn=function(e,t){var n=e.dom;me(t,(function(e,t){Hn(n,t,e)}))},Wn=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},$n=function(e,t){return F.from(Wn(e,t))},Kn=function(e,t){e.dom.removeAttribute(t)},Xn=function(e,t){var n=e.dom;me(t,(function(e,t){!function(e,t,n){if(!m(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);zn(e)&&e.style.setProperty(t,n)}(n,t,e)}))},Gn=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||fn(e)?r:Yn(n,t)},Yn=function(e,t){return zn(e)?e.style.getPropertyValue(t):""},Qn=function(e,t){var n=e.dom,r=Yn(n,t);return F.from(r).filter((function(e){return e.length>0}))},Jn=function(e){var t={},n=e.dom;if(zn(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t},Zn=ot().browser,er=function(e){return Z(e,Dt)},tr=function(e,t){return e.children&&V(e.children,t)},nr=function(e,t,n){var r=0,o=0,i=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&"static"===Gn(Ct.fromDom(e),"position")){var u=t.getBoundingClientRect();return{x:r=u.left+(i.documentElement.scrollLeft||e.scrollLeft)-i.documentElement.clientLeft,y:o=u.top+(i.documentElement.scrollTop||e.scrollTop)-i.documentElement.clientTop}}for(var a=t;a&&a!==n&&a.nodeType&&!tr(a,n);){var c=a;r+=c.offsetLeft||0,o+=c.offsetTop||0,a=c.offsetParent}for(a=t.parentNode;a&&a!==n&&a.nodeType&&!tr(a,n);)r-=a.scrollLeft||0,o-=a.scrollTop||0,a=a.parentNode;o+=function(e){return Zn.isFirefox()&&"table"===Et(e)?er(Ht(e)).filter((function(e){return"caption"===Et(e)})).bind((function(e){return er(zt(e)).map((function(t){var n=t.dom.offsetTop,r=e.dom.offsetTop,o=e.dom.offsetHeight;return n<=r?-o:0}))})).getOr(0):0}(Ct.fromDom(t))}return{x:r,y:o}},rr={},or={exports:rr};!function(e,r,o,i){!function(t,n){"object"==typeof r&&void 0!==o?o.exports=n():"function"==typeof e&&e.amd?e(n):(t="undefined"!=typeof globalThis?globalThis:t||self).EphoxContactWrapper=n()}(this,(function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},r={exports:{}};!function(t){!function(e){var r=setTimeout;function o(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(e,this)}function u(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void c(t.promise,e)}a(t.promise,r)}else(1===e._state?a:c)(t.promise,e._value)}))):e._deferreds.push(t)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void f(e);if("function"==typeof n)return void s((r=n,o=t,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=t,f(e)}catch(t){c(e,t)}var r,o}function c(e,t){e._state=2,e._value=t,f(e)}function f(e){2===e._state&&0===e._deferreds.length&&i._immediateFn((function(){e._handled||i._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)u(e,e._deferreds[t]);e._deferreds=null}function l(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function s(e,t){var n=!1;try{e((function(e){n||(n=!0,a(t,e))}),(function(e){n||(n=!0,c(t,e))}))}catch(e){if(n)return;n=!0,c(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return u(this,new l(e,t,n)),n},i.all=function(e){var t=Array.prototype.slice.call(e);return new i((function(e,n){if(0===t.length)return e([]);var r=t.length;function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(e){o(i,e)}),n)}t[i]=u,0==--r&&e(t)}catch(e){n(e)}}for(var i=0;i<t.length;i++)o(i,t[i])}))},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i((function(t){t(e)}))},i.reject=function(e){return new i((function(t,n){n(e)}))},i.race=function(e){return new i((function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)}))},i._immediateFn="function"==typeof n?function(e){n(e)}:function(e){r(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},t.exports?t.exports=i:e.Promise||(e.Promise=i)}(e)}(r);var o=r.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||o}}))}(void 0,rr,or);var ir=or.exports.boltExport,ur=function(e){var t=F.none(),n=[],r=function(e){o()?u(e):n.push(e)},o=function(){return t.isSome()},i=function(e){$(e,u)},u=function(e){t.each((function(t){setTimeout((function(){e(t)}),0)}))};return e((function(e){o()||(t=F.some(e),i(n),n=[])})),{get:r,map:function(e){return ur((function(t){r((function(n){t(e(n))}))}))},isReady:o}},ar={nu:ur,pure:function(e){return ur((function(t){t(e)}))}},cr=function(e){setTimeout((function(){throw e}),0)},fr=function(e){var t=function(t){e().then(t,cr)};return{map:function(t){return fr((function(){return e().then(t)}))},bind:function(t){return fr((function(){return e().then((function(e){return t(e).toPromise()}))}))},anonBind:function(t){return fr((function(){return e().then((function(){return t.toPromise()}))}))},toLazy:function(){return ar.nu(t)},toCached:function(){var t=null;return fr((function(){return null===t&&(t=e()),t}))},toPromise:e,get:t}},lr=function(e){return fr((function(){return new ir(e)}))},sr=function(e,t){return t((function(t){var n=[],r=0;0===e.length?t([]):$(e,(function(o,i){o.get(function(o){return function(i){n[o]=i,++r>=e.length&&t(n)}}(i))}))}))},dr=function(e){return{isValue:P,isError:B,getOr:N(e),getOrThunk:N(e),getOrDie:N(e),or:function(t){return dr(e)},orThunk:function(t){return dr(e)},fold:function(t,n){return n(e)},map:function(t){return dr(t(e))},mapError:function(t){return dr(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return F.some(e)}}},mr=function(e){return{isValue:B,isError:P,getOr:E,getOrThunk:function(e){return e()},getOrDie:function(){return(t=String(e),function(){throw new Error(t)})();var t},or:E,orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return mr(e)},mapError:function(t){return mr(t(e))},each:S,bind:function(t){return mr(e)},exists:B,forall:P,toOptional:F.none}},gr={value:dr,error:mr,fromOption:function(e,t){return e.fold((function(){return mr(t)}),dr)}},pr=function(e){if(!p(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return $(e,(function(r,o){var i=se(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!p(a))throw new Error("case arguments must be an array");t.push(u),n[u]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n.length;if(i!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+i);var c=function(e){var r=se(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!ne(t,(function(e){return V(r,e)})))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[u].apply(null,n)};return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);var i=t[o];return i.apply(null,n)},match:c,log:function(e){console.log(e,{constructors:t,constructor:u,params:n})}}}})),n};pr([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var hr=function(e){return e.fold(E,E)};function vr(e,t,n,r,o){return e(n,r)?F.some(n):w(o)&&o(n)?F.none():t(n,r,o)}var br,yr,Cr,wr,xr,Sr,Tr,kr,Nr,Er,Rr,_r,Dr,Ar,Or,Br,Pr,Lr,Ir,Mr,Fr=function(e,t,n){for(var r=e.dom,o=w(n)?n:B;r.parentNode;){r=r.parentNode;var i=Ct.fromDom(r);if(t(i))return F.some(i);if(o(i))break}return F.none()},jr=function(e,t,n){return vr((function(e,t){return t(e)}),Fr,e,t,n)},Ur=function(e,t){return Z(e.dom.childNodes,(function(e){return t(Ct.fromDom(e))})).map(Ct.fromDom)},zr=function(e,t,n){return Fr(e,(function(e){return xt(e,t)}),n)},Hr=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return St(n)?F.none():F.from(n.querySelector(e)).map(Ct.fromDom)}(t,e)},Vr=function(e,t,n){return vr((function(e,t){return xt(e,t)}),zr,e,t,n)},qr=window.Promise?window.Promise:ir,Wr=function(e,t){return"number"!=typeof t&&(t=0),setTimeout(e,t)},$r=function(e,t){return"number"!=typeof t&&(t=1),setInterval(e,t)},Kr=function(e,t){var n,r=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];clearTimeout(n),n=Wr((function(){e.apply(this,r)}),t)};return r.stop=function(){clearTimeout(n)},r},Xr={requestAnimationFrame:function(e,t){br?br.then(e):br=new qr((function(e){t||(t=document.body),function(e,t){for(var n=window.requestAnimationFrame,r=["ms","moz","webkit"],o=0;o<r.length&&!n;o++)n=window[r[o]+"RequestAnimationFrame"];n||(n=function(e){window.setTimeout(e,0)}),n(e,t)}(e,t)})).then(e)},setTimeout:Wr,setInterval:$r,setEditorTimeout:function(e,t,n){return Wr((function(){e.removed||t()}),n)},setEditorInterval:function(e,t,n){var r=$r((function(){e.removed?clearInterval(r):t()}),n);return r},debounce:Kr,throttle:Kr,clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)}},Gr=function(e,t){void 0===t&&(t={});var n=0,r={},o=Ct.fromDom(e),i=Lt(o),u=t.maxLoadTime||5e3,a=function(a,c,f){var l,s=bt._addCacheSuffix(a),d=function(e){return Ce(r,e).getOrThunk((function(){return{id:"mce-u"+n++,passed:[],failed:[],count:0}}))}(s);r[s]=d,d.count++;var m=function(e,t){for(var n=e.length;n--;)e[n]();d.status=t,d.passed=[],d.failed=[],l&&(l.onload=null,l.onerror=null,l=null)},g=function(){return m(d.passed,2)},p=function(){return m(d.failed,3)},h=function(){var t;t=h,function(){for(var t=e.styleSheets,n=t.length;n--;){var r=t[n].ownerNode;if(r&&r.id===l.id)return g(),!0}return!1}()||(Date.now()-y<u?Xr.setTimeout(t):p())};if(c&&d.passed.push(c),f&&d.failed.push(f),1!==d.status)if(2!==d.status)if(3!==d.status){d.status=1;var v=Ct.fromTag("link",i.dom);qn(v,{rel:"stylesheet",type:"text/css",id:d.id});var b,y=Date.now();t.contentCssCors&&Vn(v,"crossOrigin","anonymous"),t.referrerPolicy&&Vn(v,"referrerpolicy",t.referrerPolicy),(l=v.dom).onload=h,l.onerror=p,b=v,rn(Qt(o),b),Vn(v,"href",s)}else p();else g()},c=function(e){return lr((function(t){a(e,T(t,N(gr.value(e))),T(t,N(gr.error(e))))}))},f=function(e){var t=bt._addCacheSuffix(e);Ce(r,t).each((function(e){var n,i;0===--e.count&&(delete r[t],n=e.id,i=Qt(o),Hr(i,"#"+n).each(an))}))};return{load:a,loadAll:function(e,t,n){var r;(r=W(e,c),sr(r,lr)).get((function(e){var r=X(e,(function(e){return e.isValue()}));r.fail.length>0?n(r.fail.map(hr)):t(r.pass.map(hr))}))},unload:f,unloadAll:function(e){$(e,(function(e){f(e)}))},_setReferrerPolicy:function(e){t.referrerPolicy=e}}},Yr=function(){var e=new WeakMap;return{forElement:function(t,n){var r=Yt(t).dom;return F.from(e.get(r)).getOrThunk((function(){var t=Gr(r,n);return e.set(r,t),t}))}}}(),Qr=function(){function e(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}return e.prototype.current=function(){return this.node},e.prototype.next=function(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node},e.prototype.prev=function(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node},e.prototype.prev2=function(e){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",e),this.node},e.prototype.findSibling=function(e,t,n,r){var o,i;if(e){if(!r&&e[t])return e[t];if(e!==this.rootNode){if(o=e[n])return o;for(i=e.parentNode;i&&i!==this.rootNode;i=i.parentNode)if(o=i[n])return o}}},e.prototype.findPreviousNode=function(e,t,n,r){var o,i,u;if(e){if(o=e[n],this.rootNode&&o===this.rootNode)return;if(o){if(!r)for(u=o[t];u;u=u[t])if(!u[t])return u;return o}if((i=e.parentNode)&&i!==this.rootNode)return i}},e}(),Jr=function(e){var t;return function(n){return t=t||function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n}(e,P),we(t,Et(n))}},Zr=Jr(["h1","h2","h3","h4","h5","h6"]),eo=Jr(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),to=function(e){return Dt(e)&&!eo(e)},no=function(e){return Dt(e)&&"br"===Et(e)},ro=Jr(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),oo=Jr(["ul","ol","dl"]),io=Jr(["li","dd","dt"]),uo=Jr(["thead","tbody","tfoot"]),ao=Jr(["td","th"]),co=Jr(["pre","script","textarea","style"]),fo=function(e){return"\ufeff"===e},lo=function(e){return e.replace(/\uFEFF/g,"")},so=wn,mo=_n,go=function(e){return mo(e)&&(e=e.parentNode),so(e)&&e.hasAttribute("data-mce-caret")},po=function(e){return mo(e)&&fo(e.data)},ho=function(e){return go(e)||po(e)},vo=function(e){return e.firstChild!==e.lastChild||!Bn(e.firstChild)},bo=function(e){var t=e.container();return!!_n(t)&&("\ufeff"===t.data.charAt(e.offset())||e.isAtStart()&&po(t.previousSibling))},yo=function(e){var t=e.container();return!!_n(t)&&("\ufeff"===t.data.charAt(e.offset()-1)||e.isAtEnd()&&po(t.nextSibling))},Co=function(e,t,n){var r,o=t.ownerDocument.createElement(e);o.setAttribute("data-mce-caret",n?"before":"after"),o.setAttribute("data-mce-bogus","all"),o.appendChild(((r=document.createElement("br")).setAttribute("data-mce-bogus","1"),r));var i=t.parentNode;return n?i.insertBefore(o,t):t.nextSibling?i.insertBefore(o,t.nextSibling):i.appendChild(o),o},wo=function(e){return mo(e)&&"\ufeff"===e.data[0]},xo=function(e){return mo(e)&&"\ufeff"===e.data[e.data.length-1]},So=function(e){return e&&e.hasAttribute("data-mce-caret")?(t=e.getElementsByTagName("br"),n=t[t.length-1],kn(n)&&n.parentNode.removeChild(n),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("_moz_abspos"),e):null;var t,n},To=function(e){return go(e.startContainer)},ko=Ln,No=In,Eo=Bn,Ro=_n,_o=xn(["script","style","textarea"]),Do=xn(["img","input","textarea","hr","iframe","video","audio","object","embed"]),Ao=xn(["table"]),Oo=ho,Bo=function(e){return!Oo(e)&&(Ro(e)?!_o(e.parentNode):Do(e)||Eo(e)||Ao(e)||Po(e))},Po=function(e){return!1===function(e){return wn(e)&&"true"===e.getAttribute("unselectable")}(e)&&No(e)},Lo=function(e,t){return Bo(e)&&function(e,t){for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(Po(e))return!1;if(ko(e))return!0}return!0}(e,t)},Io=/^[ \t\r\n]*$/,Mo=function(e){return Io.test(e)},Fo=function(e,t){var n,r,o,i=Ct.fromDom(t),u=Ct.fromDom(e);return n=u,r="pre,code",o=_(Tt,i),zr(n,r,o).isSome()},jo=function(e,t){return Bo(e)&&!1===function(e,t){return _n(e)&&Mo(e.data)&&!1===Fo(e,t)}(e,t)||function(e){return wn(e)&&"A"===e.nodeName&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id"))}(e)||Uo(e)},Uo=Tn("data-mce-bookmark"),zo=Tn("data-mce-bogus"),Ho=(yr="data-mce-bogus",Cr="all",function(e){return wn(e)&&e.getAttribute(yr)===Cr}),Vo=function(e,t){return void 0===t&&(t=!0),function(e,t){var n=0;if(jo(e,e))return!1;var r=e.firstChild;if(!r)return!0;var o=new Qr(r,e);do{if(t){if(Ho(r)){r=o.next(!0);continue}if(zo(r)){r=o.next();continue}}if(Bn(r))n++,r=o.next();else{if(jo(r,e))return!1;r=o.next()}}while(r);return n<=1}(e.dom,t)},qo=function(e,t){return C(e)&&(jo(e,t)||to(Ct.fromDom(e)))},Wo=function(e){return function(e){return"span"===e.nodeName.toLowerCase()}(e)&&"bookmark"===e.getAttribute("data-mce-type")},$o=function(e,t){return _n(e)&&e.data.length>0&&function(e,t){var n=new Qr(e,t).prev(!1),r=new Qr(e,t).next(!1),o=b(n)||qo(n,t),i=b(r)||qo(r,t);return o&&i}(e,t)},Ko=function(e,t,n){var r=n||t;if(wn(t)&&Wo(t))return t;for(var o=t.childNodes,i=o.length-1;i>=0;i--)Ko(e,o[i],r);if(wn(t)){var u=t.childNodes;1===u.length&&Wo(u[0])&&t.parentNode.insertBefore(u[0],t)}return function(e){return On(e)||An(e)}(t)||jo(t,r)||function(e){return!!wn(e)&&e.childNodes.length>0}(t)||$o(t,r)||e.remove(t),t},Xo=bt.makeMap,Go=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Yo=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Qo=/[<>&\"\']/g,Jo=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,Zo={128:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",142:"",145:"",146:"",147:"",148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",158:"",159:""},ei={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},ti={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},ni=function(e,t){var n,r,o,i={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)r=String.fromCharCode(parseInt(e[n],t)),ei[r]||(o="&"+e[n+1]+";",i[r]=o,i[o]=r);return i}},ri=ni("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),oi=function(e,t){return e.replace(t?Go:Yo,(function(e){return ei[e]||e}))},ii=function(e,t){return e.replace(t?Go:Yo,(function(e){return e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":ei[e]||"&#"+e.charCodeAt(0)+";"}))},ui=function(e,t,n){return n=n||ri,e.replace(t?Go:Yo,(function(e){return ei[e]||n[e]||e}))},ai={encodeRaw:oi,encodeAllRaw:function(e){return(""+e).replace(Qo,(function(e){return ei[e]||e}))},encodeNumeric:ii,encodeNamed:ui,getEncodeFunc:function(e,t){var n=ni(t)||ri,r=Xo(e.replace(/\+/g,","));return r.named&&r.numeric?function(e,t){return e.replace(t?Go:Yo,(function(e){return void 0!==ei[e]?ei[e]:void 0!==n[e]?n[e]:e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"}))}:r.named?t?function(e,t){return ui(e,t,n)}:ui:r.numeric?ii:oi},decode:function(e){return e.replace(Jo,(function(e,t){return t?(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))>65535?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):Zo[t]||String.fromCharCode(t):ti[e]||ri[e]||function(e){var t=Ct.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e}(e)}))}},ci={},fi={},li=bt.makeMap,si=bt.each,di=bt.extend,mi=bt.explode,gi=bt.inArray,pi=function(e,t){return(e=bt.trim(e))?e.split(t||" "):[]},hi=function(e,t){var n;return e&&(n={},"string"==typeof e&&(e={"*":e}),si(e,(function(e,r){n[r]=n[r.toUpperCase()]="map"===t?li(e,/[, ]/):mi(e,/[, ]/)}))),n},vi=function(e){var t={},n={},r=[],o={},i={},u=function(t,n,r){var o=e[t];return o?o=li(o,/[, ]/,li(o.toUpperCase(),/[, ]/)):(o=ci[t])||(o=li(n," ",li(n.toUpperCase()," ")),o=di(o,r),ci[t]=o),o},a=function(e){var t,n,r,o,i,u,a={},c=function(e,n,r){var o,i,u,c=function(e,t){var n,r,o={};for(n=0,r=e.length;n<r;n++)o[e[n]]=t||{};return o};n=n||"","string"==typeof(r=r||[])&&(r=pi(r));var f=pi(e);for(o=f.length;o--;)u={attributes:c(i=pi([t,n].join(" "))),attributesOrder:i,children:c(r,fi)},a[f[o]]=u},f=function(e,t){var n,r,o,i,u=pi(e);n=u.length;for(var c=pi(t);n--;)for(r=a[u[n]],o=0,i=c.length;o<i;o++)r.attributes[c[o]]={},r.attributesOrder.push(c[o])};return ci[e]?ci[e]:(t="id accesskey class dir lang style tabindex title role",n="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",r="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(t+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",n+=" article aside details dialog figure main header footer hgroup section nav",r+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(t+=" xml:lang",r=[r,u="acronym applet basefont big font strike tt"].join(" "),si(pi(u),(function(e){c(e,"",r)})),n=[n,i="center dir isindex noframes"].join(" "),o=[n,r].join(" "),si(pi(i),(function(e){c(e,"",o)}))),o=o||[n,r].join(" "),c("html","manifest","head body"),c("head","","base command link meta noscript script style title"),c("title hr noscript br"),c("base","href target"),c("link","href rel media hreflang type sizes hreflang"),c("meta","name http-equiv content charset"),c("style","media type scoped"),c("script","src async defer type charset"),c("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",o),c("address dt dd div caption","",o),c("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",r),c("blockquote","cite",o),c("ol","reversed start type","li"),c("ul","","li"),c("li","value",o),c("dl","","dt dd"),c("a","href target rel media hreflang type",r),c("q","cite",r),c("ins del","cite datetime",o),c("img","src sizes srcset alt usemap ismap width height"),c("iframe","src name width height",o),c("embed","src type width height"),c("object","data type typemustmatch name usemap form width height",[o,"param"].join(" ")),c("param","name value"),c("map","name",[o,"area"].join(" ")),c("area","alt coords shape href target rel media hreflang type"),c("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),c("colgroup","span","col"),c("col","span"),c("tbody thead tfoot","","tr"),c("tr","","td th"),c("td","colspan rowspan headers",o),c("th","colspan rowspan headers scope abbr",o),c("form","accept-charset action autocomplete enctype method name novalidate target",o),c("fieldset","disabled form name",[o,"legend"].join(" ")),c("label","form for",r),c("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),c("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?o:r),c("select","disabled form multiple name required size","option optgroup"),c("optgroup","disabled label","option"),c("option","disabled label selected value"),c("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),c("menu","type label",[o,"li"].join(" ")),c("noscript","",o),"html4"!==e&&(c("wbr"),c("ruby","",[r,"rt rp"].join(" ")),c("figcaption","",o),c("mark rt rp summary bdi","",r),c("canvas","width height",o),c("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[o,"track source"].join(" ")),c("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[o,"track source"].join(" ")),c("picture","","img source"),c("source","src srcset type media sizes"),c("track","kind src srclang label default"),c("datalist","",[r,"option"].join(" ")),c("article section nav aside main header footer","",o),c("hgroup","","h1 h2 h3 h4 h5 h6"),c("figure","",[o,"figcaption"].join(" ")),c("time","datetime",r),c("dialog","open",o),c("command","type label icon disabled checked radiogroup command"),c("output","for form name",r),c("progress","value max",r),c("meter","value min max low high optimum",r),c("details","open",[o,"summary"].join(" ")),c("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(f("script","language xml:space"),f("style","xml:space"),f("object","declare classid code codebase codetype archive standby align border hspace vspace"),f("embed","align name hspace vspace"),f("param","valuetype type"),f("a","charset name rev shape coords"),f("br","clear"),f("applet","codebase archive code object alt name width height align hspace vspace"),f("img","name longdesc align border hspace vspace"),f("iframe","longdesc frameborder marginwidth marginheight scrolling align"),f("font basefont","size color face"),f("input","usemap align"),f("select"),f("textarea"),f("h1 h2 h3 h4 h5 h6 div p legend caption","align"),f("ul","type compact"),f("li","type"),f("ol dl menu dir","compact"),f("pre","width xml:space"),f("hr","align noshade size width"),f("isindex","prompt"),f("table","summary width frame rules cellspacing cellpadding align bgcolor"),f("col","width align char charoff valign"),f("colgroup","width align char charoff valign"),f("thead","align char charoff valign"),f("tr","align char charoff valign bgcolor"),f("th","axis align char charoff valign nowrap bgcolor width height"),f("form","accept"),f("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),f("tfoot","align char charoff valign"),f("tbody","align char charoff valign"),f("area","nohref"),f("body","background bgcolor text link vlink alink")),"html4"!==e&&(f("input button select textarea","autofocus"),f("input textarea","placeholder"),f("a","download"),f("link script img","crossorigin"),f("img","loading"),f("iframe","sandbox seamless allowfullscreen loading")),si(pi("a form meter progress dfn"),(function(e){a[e]&&delete a[e].children[e]})),delete a.caption.children.table,delete a.script,ci[e]=a,a)}((e=e||{}).schema);!1===e.verify_html&&(e.valid_elements="*[*]");var c=hi(e.valid_styles),f=hi(e.invalid_styles,"map"),l=hi(e.valid_classes,"map"),s=u("whitespace_elements","pre script noscript style textarea video audio iframe object code"),d=u("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),m=u("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),g=u("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),p=u("non_empty_elements","td th iframe video audio object script code pre",m),h=u("move_caret_before_on_enter_elements","td th iframe video audio object script code table",m),v=u("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),b=u("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",v),y=u("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp");si((e.special||"script noscript iframe noframes noembed title style textarea xmp").split(" "),(function(e){i[e]=new RegExp("</"+e+"[^>]*>","gi")}));var C=function(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")},w=function(e){var n,o,i,u,a,c,f,l,s,d,m,g,p,h,v,b,y,w,x=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,S=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,T=/[*?+]/;if(e){var k=pi(e,",");for(t["@"]&&(b=t["@"].attributes,y=t["@"].attributesOrder),n=0,o=k.length;n<o;n++)if(a=x.exec(k[n])){if(h=a[1],s=a[2],v=a[3],l=a[5],c={attributes:g={},attributesOrder:p=[]},"#"===h&&(c.paddEmpty=!0),"-"===h&&(c.removeEmpty=!0),"!"===a[4]&&(c.removeEmptyAttrs=!0),b&&(me(b,(function(e,t){g[t]=e})),p.push.apply(p,y)),l)for(i=0,u=(l=pi(l,"|")).length;i<u;i++)if(a=S.exec(l[i])){if(f={},m=a[1],d=a[2].replace(/[\\:]:/g,":"),h=a[3],w=a[4],"!"===m&&(c.attributesRequired=c.attributesRequired||[],c.attributesRequired.push(d),f.required=!0),"-"===m){delete g[d],p.splice(gi(p,d),1);continue}h&&("="===h&&(c.attributesDefault=c.attributesDefault||[],c.attributesDefault.push({name:d,value:w}),f.defaultValue=w),":"===h&&(c.attributesForced=c.attributesForced||[],c.attributesForced.push({name:d,value:w}),f.forcedValue=w),"<"===h&&(f.validValues=li(w,"?"))),T.test(d)?(c.attributePatterns=c.attributePatterns||[],f.pattern=C(d),c.attributePatterns.push(f)):(g[d]||p.push(d),g[d]=f)}b||"@"!==s||(b=g,y=p),v&&(c.outputName=s,t[v]=c),T.test(s)?(c.pattern=C(s),r.push(c)):t[s]=c}}},x=function(e){t={},r=[],w(e),si(a,(function(e,t){n[t]=e.children}))},S=function(e){var r=/^(~)?(.+)$/;e&&(ci.text_block_elements=ci.block_elements=null,si(pi(e,","),(function(e){var i=r.exec(e),u="~"===i[1],a=u?"span":"div",c=i[2];if(n[c]=n[a],o[c]=a,u||(b[c.toUpperCase()]={},b[c]={}),!t[c]){var f=t[a];delete(f=di({},f)).removeEmptyAttrs,delete f.removeEmpty,t[c]=f}si(n,(function(e,t){e[a]&&(n[t]=e=di({},n[t]),e[c]=e[a])}))})))},T=function(t){var r=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;ci[e.schema]=null,t&&si(pi(t,","),(function(e){var t,o,i=r.exec(e);i&&(o=i[1],t=o?n[i[2]]:n[i[2]]={"#comment":{}},t=n[i[2]],si(pi(i[3],"|"),(function(e){"-"===o?delete t[e]:t[e]={}})))}))},k=function(e){var n,o=t[e];if(o)return o;for(n=r.length;n--;)if((o=r[n]).pattern.test(e))return o};e.valid_elements?x(e.valid_elements):(si(a,(function(e,r){t[r]={attributes:e.attributes,attributesOrder:e.attributesOrder},n[r]=e.children})),"html5"!==e.schema&&si(pi("strong/b em/i"),(function(e){var n=pi(e,"/");t[n[1]].outputName=n[0]})),si(pi("ol ul sub sup blockquote span font a table tbody strong em b i"),(function(e){t[e]&&(t[e].removeEmpty=!0)})),si(pi("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),(function(e){t[e].paddEmpty=!0})),si(pi("span"),(function(e){t[e].removeEmptyAttrs=!0}))),S(e.custom_elements),T(e.valid_children),w(e.extended_valid_elements),T("+ol[ul|ol],+ul[ul|ol]"),si({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(function(e,n){t[n]&&(t[n].parentsRequired=pi(e))})),e.invalid_elements&&si(mi(e.invalid_elements),(function(e){t[e]&&delete t[e]})),k("span")||w("span[!data-mce-type|*]");var E=N(c),R=N(f),_=N(l),D=N(g),A=N(b),O=N(v),B=N(y),P=N(m),L=N(d),I=N(p),M=N(h),F=N(s),j=N(i),U=N(o);return{children:n,elements:t,getValidStyles:E,getValidClasses:_,getBlockElements:A,getInvalidStyles:R,getShortEndedElements:P,getTextBlockElements:O,getTextInlineElements:B,getBoolAttrs:D,getElementRule:k,getSelfClosingElements:L,getNonEmptyElements:I,getMoveCaretBeforeOnEnterElements:M,getWhiteSpaceElements:F,getSpecialElements:j,isValidChild:function(e,t){var r=n[e.toLowerCase()];return!(!r||!r[t.toLowerCase()])},isValid:function(e,t){var n,r,o=k(e);if(o){if(!t)return!0;if(o.attributes[t])return!0;if(n=o.attributePatterns)for(r=n.length;r--;)if(n[r].pattern.test(e))return!0}return!1},getCustomElements:U,addValidElements:w,setValidElements:x,addCustomElements:S,addValidChildren:T}},bi=function(e,t,n,r){var o=function(e){return(e=parseInt(e,10).toString(16)).length>1?e:"0"+e};return"#"+o(t)+o(n)+o(r)},yi=function(e,t){var n,r,o,i=this,u=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,a=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,c=/\s*([^:]+):\s*([^;]+);?/g,f=/\s+$/,l={};e=e||{},t&&(r=t.getValidStyles(),o=t.getInvalidStyles());var s="\\\" \\' \\; \\: ; : \ufeff".split(" ");for(n=0;n<s.length;n++)l[s[n]]="\ufeff"+n,l["\ufeff"+n]=s[n];return{toHex:function(e){return e.replace(u,bi)},parse:function(t){var r,o,s,d,m,g,p,h,v={},b=e.url_converter,y=e.url_converter_scope||i,C=function(e,t,r){var o=v[e+"-top"+t];if(o){var i=v[e+"-right"+t];if(i){var u=v[e+"-bottom"+t];if(u){var a=v[e+"-left"+t];if(a){var c=[o,i,u,a];for(n=c.length-1;n--&&c[n]===c[n+1];);n>-1&&r||(v[e+t]=-1===n?c[0]:c.join(" "),delete v[e+"-top"+t],delete v[e+"-right"+t],delete v[e+"-bottom"+t],delete v[e+"-left"+t])}}}}},w=function(e){var t,n=v[e];if(n){for(t=(n=n.split(" ")).length;t--;)if(n[t]!==n[0])return!1;return v[e]=n[0],!0}},x=function(e){return d=!0,l[e]},S=function(e,t){return d&&(e=e.replace(/\uFEFF[0-9]/g,(function(e){return l[e]}))),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e},T=function(e){return String.fromCharCode(parseInt(e.slice(1),16))},k=function(e){return e.replace(/\\[0-9a-f]+/gi,T)},N=function(t,n,r,o,i,u){if(i=i||u)return"'"+(i=S(i)).replace(/\'/g,"\\'")+"'";if(n=S(n||r||o),!e.allow_script_urls){var a=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(a))return"";if(!e.allow_svg_data_urls&&/^data:image\/svg/i.test(a))return""}return b&&(n=b.call(y,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(t){for(t=(t=t.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,x).replace(/\"[^\"]+\"|\'[^\']+\'/g,(function(e){return e.replace(/[;:]/g,x)}));r=c.exec(t);)if(c.lastIndex=r.index+r[0].length,o=r[1].replace(f,"").toLowerCase(),s=r[2].replace(f,""),o&&s){if(o=k(o),s=k(s),-1!==o.indexOf("\ufeff")||-1!==o.indexOf('"'))continue;if(!e.allow_script_urls&&("behavior"===o||/expression\s*\(|\/\*|\*\//.test(s)))continue;"font-weight"===o&&"700"===s?s="bold":"color"!==o&&"background-color"!==o||(s=s.toLowerCase()),s=(s=s.replace(u,bi)).replace(a,N),v[o]=d?S(s,!0):s}C("border","",!0),C("border","-width"),C("border","-color"),C("border","-style"),C("padding",""),C("margin",""),m="border",p="border-style",h="border-color",w(g="border-width")&&w(p)&&w(h)&&(v[m]=v[g]+" "+v[p]+" "+v[h],delete v[g],delete v[p],delete v[h]),"medium none"===v.border&&delete v.border,"none"===v["border-image"]&&delete v["border-image"]}return v},serialize:function(e,t){var n="",i=function(t){var o,i=r[t];if(i)for(var u=0,a=i.length;u<a;u++)t=i[u],(o=e[t])&&(n+=(n.length>0?" ":"")+t+": "+o+";")};return t&&r?(i("*"),i(t)):me(e,(function(e,r){!e||o&&!function(e,t){var n=o["*"];return(!n||!n[e])&&!((n=o[t])&&n[e])}(r,t)||(n+=(n.length>0?" ":"")+r+": "+e+";")})),n}}},Ci={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},wi=function(e){return e instanceof Event||w(e.initEvent)},xi=function(e,t,n,r){var o,i=function(e,t){var n=null!=t?t:{};for(var r in e)we(Ci,r)||(n[r]=e[r]);return C(n.composedPath)&&(n.composedPath=function(){return e.composedPath()}),n}(t,r);return i.type=e,y(i.target)&&(i.target=null!==(o=i.srcElement)&&void 0!==o?o:n),function(e){return y(e.preventDefault)||wi(e)}(t)&&(i.preventDefault=function(){i.defaultPrevented=!0,i.isDefaultPrevented=P,w(t.preventDefault)?t.preventDefault():wi(t)&&(t.returnValue=!1)},i.stopPropagation=function(){i.cancelBubble=!0,i.isPropagationStopped=P,w(t.stopPropagation)?t.stopPropagation():wi(t)&&(t.cancelBubble=!0)},i.stopImmediatePropagation=function(){i.isImmediatePropagationStopped=P,i.stopPropagation()},function(e){return e.isDefaultPrevented===P||e.isDefaultPrevented===B}(i)||(i.isDefaultPrevented=!0===i.defaultPrevented?P:B,i.isPropagationStopped=!0===i.cancelBubble?P:B,i.isImmediatePropagationStopped=B)),i},Si=/^(?:mouse|contextmenu)|click/,Ti=function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent&&e.attachEvent("on"+t,n)},ki=function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r||!1):e.detachEvent&&e.detachEvent("on"+t,n)},Ni=function(e,t){var n=xi(e.type,e,document,t);if(function(e){return C(e)&&Si.test(e.type)}(e)&&b(e.pageX)&&!b(e.clientX)){var r=n.target.ownerDocument||document,o=r.documentElement,i=r.body,u=n;u.pageX=e.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),u.pageY=e.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)}return b(n.metaKey)&&(n.metaKey=!1),n},Ei=function(e,t,n){var r=e.document,o={type:"ready"};if(n.domLoaded)t(o);else{var i=function(){ki(e,"DOMContentLoaded",i),ki(e,"load",i),n.domLoaded||(n.domLoaded=!0,t(o)),e=null};"complete"===r.readyState||"interactive"===r.readyState&&r.body?i():Ti(e,"DOMContentLoaded",i),n.domLoaded||Ti(e,"load",i)}},Ri=function(){function e(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}return e.prototype.bind=function(e,t,n,r){var o,i,u,a,c,f,l,s=this,d=window,m=function(e){s.executeHandlers(Ni(e||d.event),o)};if(e&&3!==e.nodeType&&8!==e.nodeType){e[s.expando]?o=e[s.expando]:(o=s.count++,e[s.expando]=o,s.events[o]={}),r=r||e;var g=t.split(" ");for(u=g.length;u--;)f=m,c=l=!1,"DOMContentLoaded"===(a=g[u])&&(a="ready"),s.domLoaded&&"ready"===a&&"complete"===e.readyState?n.call(r,Ni({type:a})):(s.hasMouseEnterLeave||(c=s.mouseEnterLeave[a])&&(f=function(e){var t=e.currentTarget,n=e.relatedTarget;if(n&&t.contains)n=t.contains(n);else for(;n&&n!==t;)n=n.parentNode;n||((e=Ni(e||d.event)).type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,s.executeHandlers(e,o))}),s.hasFocusIn||"focusin"!==a&&"focusout"!==a||(l=!0,c="focusin"===a?"focus":"blur",f=function(e){(e=Ni(e||d.event)).type="focus"===e.type?"focusin":"focusout",s.executeHandlers(e,o)}),(i=s.events[o][a])?"ready"===a&&s.domLoaded?n(Ni({type:a})):i.push({func:n,scope:r}):(s.events[o][a]=i=[{func:n,scope:r}],i.fakeName=c,i.capture=l,i.nativeHandler=f,"ready"===a?Ei(e,f,s):Ti(e,c||a,f,l)));return e=i=null,n}},e.prototype.unbind=function(e,t,n){var r,o,i,u,a;if(!e||3===e.nodeType||8===e.nodeType)return this;var c=e[this.expando];if(c){if(a=this.events[c],t){var f=t.split(" ");for(o=f.length;o--;)if(r=a[u=f[o]]){if(n)for(i=r.length;i--;)if(r[i].func===n){var l=r.nativeHandler,s=r.fakeName,d=r.capture;(r=r.slice(0,i).concat(r.slice(i+1))).nativeHandler=l,r.fakeName=s,r.capture=d,a[u]=r}n&&0!==r.length||(delete a[u],ki(e,r.fakeName||u,r.nativeHandler,r.capture))}}else me(a,(function(t,n){ki(e,t.fakeName||n,t.nativeHandler,t.capture)})),a={};for(u in a)if(we(a,u))return this;delete this.events[c];try{delete e[this.expando]}catch(t){e[this.expando]=null}}return this},e.prototype.fire=function(e,t,n){var r;if(!e||3===e.nodeType||8===e.nodeType)return this;var o=Ni({type:t,target:e},n);do{(r=e[this.expando])&&this.executeHandlers(o,r),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!o.isPropagationStopped());return this},e.prototype.clean=function(e){var t,n;if(!e||3===e.nodeType||8===e.nodeType)return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName)for(this.unbind(e),t=(n=e.getElementsByTagName("*")).length;t--;)(e=n[t])[this.expando]&&this.unbind(e);return this},e.prototype.destroy=function(){this.events={}},e.prototype.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1},e.prototype.executeHandlers=function(e,t){var n=this.events[t],r=n&&n[e.type];if(r)for(var o=0,i=r.length;o<i;o++){var u=r[o];if(u&&!1===u.func.call(u.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}},e.Event=new e,e}(),_i="sizzle"+-new Date,Di=window.document,Ai=0,Oi=0,Bi=lu(),Pi=lu(),Li=lu(),Ii=function(e,t){return e===t&&(Dr=!0),0},Mi={}.hasOwnProperty,Fi=[],ji=Fi.pop,Ui=Fi.push,zi=Fi.push,Hi=Fi.slice,Vi=Fi.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},qi="[\\x20\\t\\r\\n\\f]",Wi="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",$i="\\["+qi+"*("+Wi+")(?:"+qi+"*([*^$|!~]?=)"+qi+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Wi+"))|)"+qi+"*\\]",Ki=":("+Wi+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+$i+")*)|.*)\\)|)",Xi=new RegExp("^"+qi+"+|((?:^|[^\\\\])(?:\\\\.)*)"+qi+"+$","g"),Gi=new RegExp("^"+qi+"*,"+qi+"*"),Yi=new RegExp("^"+qi+"*([>+~]|"+qi+")"+qi+"*"),Qi=new RegExp("="+qi+"*([^\\]'\"]*?)"+qi+"*\\]","g"),Ji=new RegExp(Ki),Zi=new RegExp("^"+Wi+"$"),eu={ID:new RegExp("^#("+Wi+")"),CLASS:new RegExp("^\\.("+Wi+")"),TAG:new RegExp("^("+Wi+"|[*])"),ATTR:new RegExp("^"+$i),PSEUDO:new RegExp("^"+Ki),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+qi+"*(even|odd|(([+-]|)(\\d*)n|)"+qi+"*(?:([+-]|)"+qi+"*(\\d+)|))"+qi+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+qi+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+qi+"*((?:-\\d)?\\d*)"+qi+"*\\)|)(?=[^-]|$)","i")},tu=/^(?:input|select|textarea|button)$/i,nu=/^h\d$/i,ru=/^[^{]+\{\s*\[native \w/,ou=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,iu=/[+~]/,uu=/'|\\/g,au=new RegExp("\\\\([\\da-f]{1,6}"+qi+"?|("+qi+")|.)","ig"),cu=function(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)};try{zi.apply(Fi=Hi.call(Di.childNodes),Di.childNodes),Fi[Di.childNodes.length].nodeType}catch(e){zi={apply:Fi.length?function(e,t){Ui.apply(e,Hi.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}var fu=function(e,t,n,r){var o,i,u,a,c,f,l,s,d,m;if((t?t.ownerDocument||t:Di)!==Or&&Ar(t),n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=(t=t||Or).nodeType)&&9!==a)return[];if(Pr&&!r){if(o=ou.exec(e))if(u=o[1]){if(9===a){if(!(i=t.getElementById(u))||!i.parentNode)return n;if(i.id===u)return n.push(i),n}else if(t.ownerDocument&&(i=t.ownerDocument.getElementById(u))&&Mr(t,i)&&i.id===u)return n.push(i),n}else{if(o[2])return zi.apply(n,t.getElementsByTagName(e)),n;if((u=o[3])&&wr.getElementsByClassName)return zi.apply(n,t.getElementsByClassName(u)),n}if(wr.qsa&&(!Lr||!Lr.test(e))){if(s=l=_i,d=t,m=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(f=kr(e),(l=t.getAttribute("id"))?s=l.replace(uu,"\\$&"):t.setAttribute("id",s),s="[id='"+s+"'] ",c=f.length;c--;)f[c]=s+hu(f[c]);d=iu.test(e)&&gu(t.parentNode)||t,m=f.join(",")}if(m)try{return zi.apply(n,d.querySelectorAll(m)),n}catch(e){}finally{l||t.removeAttribute("id")}}}return Er(e.replace(Xi,"$1"),t,n,r)};function lu(){var e=[];return function t(n,r){return e.push(n+" ")>xr.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function su(e){return e[_i]=!0,e}function du(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function mu(e){return su((function(t){return t=+t,su((function(n,r){for(var o,i=e([],n.length,t),u=i.length;u--;)n[o=i[u]]&&(n[o]=!(r[o]=n[o]))}))}))}function gu(e){return e&&void 0!==e.getElementsByTagName&&e}function pu(){}function hu(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function vu(e,t,n){var r=t.dir,o=n&&"parentNode"===r,i=Oi++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,u){var a,c,f=[Ai,i];if(u){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,u))return!0}else for(;t=t[r];)if(1===t.nodeType||o){if((a=(c=t[_i]||(t[_i]={}))[r])&&a[0]===Ai&&a[1]===i)return f[2]=a[2];if(c[r]=f,f[2]=e(t,n,u))return!0}}}function bu(e){return e.length>1?function(t,n,r){for(var o=e.length;o--;)if(!e[o](t,n,r))return!1;return!0}:e[0]}function yu(e,t,n,r,o){for(var i,u=[],a=0,c=e.length,f=null!=t;a<c;a++)(i=e[a])&&(n&&!n(i,r,o)||(u.push(i),f&&t.push(a)));return u}function Cu(e,t,n,r,o,i){return r&&!r[_i]&&(r=Cu(r)),o&&!o[_i]&&(o=Cu(o,i)),su((function(i,u,a,c){var f,l,s,d=[],m=[],g=u.length,p=i||function(e,t,n){for(var r=0,o=t.length;r<o;r++)fu(e,t[r],n);return n}(t||"*",a.nodeType?[a]:a,[]),h=!e||!i&&t?p:yu(p,d,e,a,c),v=n?o||(i?e:g||r)?[]:u:h;if(n&&n(h,v,a,c),r)for(f=yu(v,m),r(f,[],a,c),l=f.length;l--;)(s=f[l])&&(v[m[l]]=!(h[m[l]]=s));if(i){if(o||e){if(o){for(f=[],l=v.length;l--;)(s=v[l])&&f.push(h[l]=s);o(null,v=[],f,c)}for(l=v.length;l--;)(s=v[l])&&(f=o?Vi.call(i,s):d[l])>-1&&(i[f]=!(u[f]=s))}}else v=yu(v===u?v.splice(g,v.length):v),o?o(null,u,v,c):zi.apply(u,v)}))}function wu(e){for(var t,n,r,o=e.length,i=xr.relative[e[0].type],u=i||xr.relative[" "],a=i?1:0,c=vu((function(e){return e===t}),u,!0),f=vu((function(e){return Vi.call(t,e)>-1}),u,!0),l=[function(e,n,r){var o=!i&&(r||n!==Rr)||((t=n).nodeType?c(e,n,r):f(e,n,r));return t=null,o}];a<o;a++)if(n=xr.relative[e[a].type])l=[vu(bu(l),n)];else{if((n=xr.filter[e[a].type].apply(null,e[a].matches))[_i]){for(r=++a;r<o&&!xr.relative[e[r].type];r++);return Cu(a>1&&bu(l),a>1&&hu(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(Xi,"$1"),n,a<r&&wu(e.slice(a,r)),r<o&&wu(e=e.slice(r)),r<o&&hu(e))}l.push(n)}return bu(l)}wr=fu.support={},Tr=fu.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},Ar=fu.setDocument=function(e){var t,n=e?e.ownerDocument||e:Di,r=n.defaultView;return n!==Or&&9===n.nodeType&&n.documentElement?(Or=n,Br=n.documentElement,Pr=!Tr(n),r&&r!==function(e){try{return e.top}catch(e){}return null}(r)&&(r.addEventListener?r.addEventListener("unload",(function(){Ar()}),!1):r.attachEvent&&r.attachEvent("onunload",(function(){Ar()}))),wr.attributes=!0,wr.getElementsByTagName=!0,wr.getElementsByClassName=ru.test(n.getElementsByClassName),wr.getById=!0,xr.find.ID=function(e,t){if(void 0!==t.getElementById&&Pr){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},xr.filter.ID=function(e){var t=e.replace(au,cu);return function(e){return e.getAttribute("id")===t}},xr.find.TAG=wr.getElementsByTagName?function(e,t){if(void 0!==t.getElementsByTagName)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],o=0,i=t.getElementsByTagName(e);if("*"===e){for(;n=i[o++];)1===n.nodeType&&r.push(n);return r}return i},xr.find.CLASS=wr.getElementsByClassName&&function(e,t){if(Pr)return t.getElementsByClassName(e)},Ir=[],Lr=[],wr.disconnectedMatch=!0,Lr=Lr.length&&new RegExp(Lr.join("|")),Ir=Ir.length&&new RegExp(Ir.join("|")),t=ru.test(Br.compareDocumentPosition),Mr=t||ru.test(Br.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},Ii=t?function(e,t){if(e===t)return Dr=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!wr.sortDetached&&t.compareDocumentPosition(e)===r?e===n||e.ownerDocument===Di&&Mr(Di,e)?-1:t===n||t.ownerDocument===Di&&Mr(Di,t)?1:_r?Vi.call(_r,e)-Vi.call(_r,t):0:4&r?-1:1)}:function(e,t){if(e===t)return Dr=!0,0;var r,o=0,i=e.parentNode,u=t.parentNode,a=[e],c=[t];if(!i||!u)return e===n?-1:t===n?1:i?-1:u?1:_r?Vi.call(_r,e)-Vi.call(_r,t):0;if(i===u)return du(e,t);for(r=e;r=r.parentNode;)a.unshift(r);for(r=t;r=r.parentNode;)c.unshift(r);for(;a[o]===c[o];)o++;return o?du(a[o],c[o]):a[o]===Di?-1:c[o]===Di?1:0},n):Or},fu.matches=function(e,t){return fu(e,null,null,t)},fu.matchesSelector=function(e,t){if((e.ownerDocument||e)!==Or&&Ar(e),t=t.replace(Qi,"='$1']"),wr.matchesSelector&&Pr&&(!Ir||!Ir.test(t))&&(!Lr||!Lr.test(t)))try{var n=(void 0).call(e,t);if(n||wr.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return fu(t,Or,null,[e]).length>0},fu.contains=function(e,t){return(e.ownerDocument||e)!==Or&&Ar(e),Mr(e,t)},fu.attr=function(e,t){(e.ownerDocument||e)!==Or&&Ar(e);var n=xr.attrHandle[t.toLowerCase()],r=n&&Mi.call(xr.attrHandle,t.toLowerCase())?n(e,t,!Pr):void 0;return void 0!==r?r:wr.attributes||!Pr?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},fu.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},fu.uniqueSort=function(e){var t,n=[],r=0,o=0;if(Dr=!wr.detectDuplicates,_r=!wr.sortStable&&e.slice(0),e.sort(Ii),Dr){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return _r=null,e},Sr=fu.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=Sr(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=Sr(t);return n},(xr=fu.selectors={cacheLength:50,createPseudo:su,match:eu,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(au,cu),e[3]=(e[3]||e[4]||e[5]||"").replace(au,cu),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||fu.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&fu.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return eu.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&Ji.test(n)&&(t=kr(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(au,cu).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=Bi[e+" "];return t||(t=new RegExp("(^|"+qi+")"+e+"("+qi+"|$)"))&&Bi(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var o=fu.attr(r,e);return null==o?"!="===t:!t||(o+="","="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&o.indexOf(n)>-1:"$="===t?n&&o.slice(-n.length)===n:"~="===t?(" "+o+" ").indexOf(n)>-1:"|="===t&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,o){var i="nth"!==e.slice(0,3),u="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===o?function(e){return!!e.parentNode}:function(t,n,c){var f,l,s,d,m,g,p=i!==u?"nextSibling":"previousSibling",h=t.parentNode,v=a&&t.nodeName.toLowerCase(),b=!c&&!a;if(h){if(i){for(;p;){for(s=t;s=s[p];)if(a?s.nodeName.toLowerCase()===v:1===s.nodeType)return!1;g=p="only"===e&&!g&&"nextSibling"}return!0}if(g=[u?h.firstChild:h.lastChild],u&&b){for(m=(f=(l=h[_i]||(h[_i]={}))[e]||[])[0]===Ai&&f[1],d=f[0]===Ai&&f[2],s=m&&h.childNodes[m];s=++m&&s&&s[p]||(d=m=0)||g.pop();)if(1===s.nodeType&&++d&&s===t){l[e]=[Ai,m,d];break}}else if(b&&(f=(t[_i]||(t[_i]={}))[e])&&f[0]===Ai)d=f[1];else for(;(s=++m&&s&&s[p]||(d=m=0)||g.pop())&&((a?s.nodeName.toLowerCase()!==v:1!==s.nodeType)||!++d||(b&&((s[_i]||(s[_i]={}))[e]=[Ai,d]),s!==t)););return(d-=o)===r||d%r==0&&d/r>=0}}},PSEUDO:function(e,t){var n,r=xr.pseudos[e]||xr.setFilters[e.toLowerCase()]||fu.error("unsupported pseudo: "+e);return r[_i]?r(t):r.length>1?(n=[e,e,"",t],xr.setFilters.hasOwnProperty(e.toLowerCase())?su((function(e,n){for(var o,i=r(e,t),u=i.length;u--;)e[o=Vi.call(e,i[u])]=!(n[o]=i[u])})):function(e){return r(e,0,n)}):r}},pseudos:{not:su((function(e){var t=[],n=[],r=Nr(e.replace(Xi,"$1"));return r[_i]?su((function(e,t,n,o){for(var i,u=r(e,null,o,[]),a=e.length;a--;)(i=u[a])&&(e[a]=!(t[a]=i))})):function(e,o,i){return t[0]=e,r(t,null,i,n),t[0]=null,!n.pop()}})),has:su((function(e){return function(t){return fu(e,t).length>0}})),contains:su((function(e){return e=e.replace(au,cu),function(t){return(t.textContent||t.innerText||Sr(t)).indexOf(e)>-1}})),lang:su((function(e){return Zi.test(e||"")||fu.error("unsupported lang: "+e),e=e.replace(au,cu).toLowerCase(),function(t){var n;do{if(n=Pr?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=window.location&&window.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===Br},focus:function(e){return e===Or.activeElement&&(!Or.hasFocus||Or.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!xr.pseudos.empty(e)},header:function(e){return nu.test(e.nodeName)},input:function(e){return tu.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:mu((function(){return[0]})),last:mu((function(e,t){return[t-1]})),eq:mu((function(e,t,n){return[n<0?n+t:n]})),even:mu((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:mu((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:mu((function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e})),gt:mu((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}}).pseudos.nth=xr.pseudos.eq,$(["radio","checkbox","file","password","image"],(function(e){xr.pseudos[e]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(e)})),$(["submit","reset"],(function(e){xr.pseudos[e]=function(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}(e)})),pu.prototype=xr.filters=xr.pseudos,xr.setFilters=new pu,kr=fu.tokenize=function(e,t){var n,r,o,i,u,a,c,f=Pi[e+" "];if(f)return t?0:f.slice(0);for(u=e,a=[],c=xr.preFilter;u;){for(i in n&&!(r=Gi.exec(u))||(r&&(u=u.slice(r[0].length)||u),a.push(o=[])),n=!1,(r=Yi.exec(u))&&(n=r.shift(),o.push({value:n,type:r[0].replace(Xi," ")}),u=u.slice(n.length)),xr.filter)xr.filter.hasOwnProperty(i)&&(!(r=eu[i].exec(u))||c[i]&&!(r=c[i](r))||(n=r.shift(),o.push({value:n,type:i,matches:r}),u=u.slice(n.length)));if(!n)break}return t?u.length:u?fu.error(e):Pi(e,a).slice(0)},Nr=fu.compile=function(e,t){var n,r=[],o=[],i=Li[e+" "];if(!i){for(t||(t=kr(e)),n=t.length;n--;)(i=wu(t[n]))[_i]?r.push(i):o.push(i);(i=Li(e,function(e,t){var n=t.length>0,r=e.length>0,o=function(o,i,u,a,c){var f,l,s,d=0,m="0",g=o&&[],p=[],h=Rr,v=o||r&&xr.find.TAG("*",c),b=Ai+=null==h?1:Math.random()||.1,y=v.length;for(c&&(Rr=i!==Or&&i);m!==y&&null!=(f=v[m]);m++){if(r&&f){for(l=0;s=e[l++];)if(s(f,i,u)){a.push(f);break}c&&(Ai=b)}n&&((f=!s&&f)&&d--,o&&g.push(f))}if(d+=m,n&&m!==d){for(l=0;s=t[l++];)s(g,p,i,u);if(o){if(d>0)for(;m--;)g[m]||p[m]||(p[m]=ji.call(a));p=yu(p)}zi.apply(a,p),c&&!o&&p.length>0&&d+t.length>1&&fu.uniqueSort(a)}return c&&(Ai=b,Rr=h),g};return n?su(o):o}(o,r))).selector=e}return i},Er=fu.select=function(e,t,n,r){var o,i,u,a,c,f="function"==typeof e&&e,l=!r&&kr(e=f.selector||e);if(n=n||[],1===l.length){if((i=l[0]=l[0].slice(0)).length>2&&"ID"===(u=i[0]).type&&wr.getById&&9===t.nodeType&&Pr&&xr.relative[i[1].type]){if(!(t=(xr.find.ID(u.matches[0].replace(au,cu),t)||[])[0]))return n;f&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(o=eu.needsContext.test(e)?0:i.length;o--&&(u=i[o],!xr.relative[a=u.type]);)if((c=xr.find[a])&&(r=c(u.matches[0].replace(au,cu),iu.test(i[0].type)&&gu(t.parentNode)||t))){if(i.splice(o,1),!(e=r.length&&hu(i)))return zi.apply(n,r),n;break}}return(f||Nr(e,l))(r,t,!Pr,n,iu.test(e)&&gu(t.parentNode)||t),n},wr.sortStable=_i.split("").sort(Ii).join("")===_i,wr.detectDuplicates=!!Dr,Ar(),wr.sortDetached=!0;var xu=document,Su=Array.prototype.push,Tu=Array.prototype.slice,ku=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Nu=Ri.Event,Eu=bt.makeMap("children,contents,next,prev"),Ru=function(e){return void 0!==e},_u=function(e){return"string"==typeof e},Du=function(e,t){var n,r=(t=t||xu).createElement("div"),o=t.createDocumentFragment();for(r.innerHTML=e;n=r.firstChild;)o.appendChild(n);return o},Au=function(e,t,n,r){var o;if(_u(t))t=Du(t,Wu(e[0]));else if(t.length&&!t.nodeType){if(t=Gu.makeArray(t),r)for(o=t.length-1;o>=0;o--)Au(e,t[o],n,r);else for(o=0;o<t.length;o++)Au(e,t[o],n,r);return e}if(t.nodeType)for(o=e.length;o--;)n.call(e[o],t);return e},Ou=function(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")},Bu=function(e,t,n){var r,o;return t=Gu(t)[0],e.each((function(){n&&r===this.parentNode||(r=this.parentNode,o=t.cloneNode(!1),this.parentNode.insertBefore(o,this)),o.appendChild(this)})),e},Pu=bt.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),Lu=bt.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),Iu={for:"htmlFor",class:"className",readonly:"readOnly"},Mu={float:"cssFloat"},Fu={},ju={},Uu=function(e,t){return new Gu.fn.init(e,t)},zu=/^\s*|\s*$/g,Hu=function(e){return null==e?"":(""+e).replace(zu,"")},Vu=function(e,t){var n,r,o,i;if(e)if(void 0===(n=e.length)){for(r in e)if(e.hasOwnProperty(r)&&(i=e[r],!1===t.call(i,r,i)))break}else for(o=0;o<n&&(i=e[o],!1!==t.call(i,o,i));o++);return e},qu=function(e,t){var n=[];return Vu(e,(function(e,r){t(r,e)&&n.push(r)})),n},Wu=function(e){return e?9===e.nodeType?e:e.ownerDocument:xu};Uu.fn=Uu.prototype={constructor:Uu,selector:"",context:null,length:0,init:function(e,t){var n,r;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(t&&t.nodeType)this.context=t;else{if(t)return Gu(e).attr(t);this.context=t=document}if(_u(e)){if(this.selector=e,!(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ku.exec(e)))return Gu(t).find(e);if(n[1])for(r=Du(e,Wu(t)).firstChild;r;)Su.call(this,r),r=r.nextSibling;else{if(!(r=Wu(t).getElementById(n[2])))return this;if(r.id!==n[2])return this.find(e);this.length=1,this[0]=r}}else this.add(e,!1);return this},toArray:function(){return bt.toArray(this)},add:function(e,t){var n,r;if(_u(e))return this.add(Gu(e));if(!1!==t)for(n=Gu.unique(this.toArray().concat(Gu.makeArray(e))),this.length=n.length,r=0;r<n.length;r++)this[r]=n[r];else Su.apply(this,Gu.makeArray(e));return this},attr:function(e,t){var n,r=this;if("object"==typeof e)Vu(e,(function(e,t){r.attr(e,t)}));else{if(!Ru(t)){if(r[0]&&1===r[0].nodeType){if((n=Fu[e])&&n.get)return n.get(r[0],e);if(Lu[e])return r.prop(e)?e:void 0;null===(t=r[0].getAttribute(e,2))&&(t=void 0)}return t}this.each((function(){var n;if(1===this.nodeType){if((n=Fu[e])&&n.set)return void n.set(this,t);null===t?this.removeAttribute(e,2):this.setAttribute(e,t,2)}}))}return r},removeAttr:function(e){return this.attr(e,null)},prop:function(e,t){var n=this;if("object"==typeof(e=Iu[e]||e))Vu(e,(function(e,t){n.prop(e,t)}));else{if(!Ru(t))return n[0]&&n[0].nodeType&&e in n[0]?n[0][e]:t;this.each((function(){1===this.nodeType&&(this[e]=t)}))}return n},css:function(e,t){var n,r,o=this,i=function(e){return e.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()}))},u=function(e){return e.replace(/[A-Z]/g,(function(e){return"-"+e}))};if("object"==typeof e)Vu(e,(function(e,t){o.css(e,t)}));else if(Ru(t))e=i(e),"number"!=typeof t||Pu[e]||(t=t.toString()+"px"),o.each((function(){var n=this.style;if((r=ju[e])&&r.set)r.set(this,t);else{try{this.style[Mu[e]||e]=t}catch(e){}null!==t&&""!==t||(n.removeProperty?n.removeProperty(u(e)):n.removeAttribute(e))}}));else{if(n=o[0],(r=ju[e])&&r.get)return r.get(n);if(!n.ownerDocument.defaultView)return n.currentStyle?n.currentStyle[i(e)]:"";try{return n.ownerDocument.defaultView.getComputedStyle(n,null).getPropertyValue(u(e))}catch(e){return}}return o},remove:function(){for(var e,t=this.length;t--;)e=this[t],Nu.clean(e),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var e,t=this.length;t--;)for(e=this[t];e.firstChild;)e.removeChild(e.firstChild);return this},html:function(e){var t;if(Ru(e)){t=this.length;try{for(;t--;)this[t].innerHTML=e}catch(n){Gu(this[t]).empty().append(e)}return this}return this[0]?this[0].innerHTML:""},text:function(e){var t;if(Ru(e)){for(t=this.length;t--;)"innerText"in this[t]?this[t].innerText=e:this[0].textContent=e;return this}return this[0]?this[0].innerText||this[0].textContent:""},append:function(){return Au(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(e)}))},prepend:function(){return Au(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(e,this.firstChild)}),!0)},before:function(){var e=this;return e[0]&&e[0].parentNode?Au(e,arguments,(function(e){this.parentNode.insertBefore(e,this)})):e},after:function(){var e=this;return e[0]&&e[0].parentNode?Au(e,arguments,(function(e){this.parentNode.insertBefore(e,this.nextSibling)}),!0):e},appendTo:function(e){return Gu(e).append(this),this},prependTo:function(e){return Gu(e).prepend(this),this},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return Bu(this,e)},wrapAll:function(e){return Bu(this,e,!0)},wrapInner:function(e){return this.each((function(){Gu(this).contents().wrapAll(e)})),this},unwrap:function(){return this.parent().each((function(){Gu(this).replaceWith(this.childNodes)}))},clone:function(){var e=[];return this.each((function(){e.push(this.cloneNode(!0))})),Gu(e)},addClass:function(e){return this.toggleClass(e,!0)},removeClass:function(e){return this.toggleClass(e,!1)},toggleClass:function(e,t){var n=this;return"string"!=typeof e||(-1!==e.indexOf(" ")?Vu(e.split(" "),(function(){n.toggleClass(this,t)})):n.each((function(n,r){var o=Ou(r,e);if(o!==t){var i=r.className;o?r.className=Hu((" "+i+" ").replace(" "+e+" "," ")):r.className+=i?" "+e:e}}))),n},hasClass:function(e){return Ou(this[0],e)},each:function(e){return Vu(this,e)},on:function(e,t){return this.each((function(){Nu.bind(this,e,t)}))},off:function(e,t){return this.each((function(){Nu.unbind(this,e,t)}))},trigger:function(e){return this.each((function(){"object"==typeof e?Nu.fire(this,e.type,e):Nu.fire(this,e)}))},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return Gu(Tu.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(e){var t,n,r=[];for(t=0,n=this.length;t<n;t++)Gu.find(e,this[t],r);return Gu(r)},filter:function(e){return Gu("function"==typeof e?qu(this.toArray(),(function(t,n){return e(n,t)})):Gu.filter(e,this.toArray()))},closest:function(e){var t=[];return e instanceof Gu&&(e=e[0]),this.each((function(n,r){for(;r;){if("string"==typeof e&&Gu(r).is(e)){t.push(r);break}if(r===e){t.push(r);break}r=r.parentNode}})),Gu(t)},offset:function(e){var t,n,r,o,i=0,u=0;return e?this.css(e):((t=this[0])&&(r=(n=t.ownerDocument).documentElement,t.getBoundingClientRect&&(i=(o=t.getBoundingClientRect()).left+(r.scrollLeft||n.body.scrollLeft)-r.clientLeft,u=o.top+(r.scrollTop||n.body.scrollTop)-r.clientTop)),{left:i,top:u})},push:Su,sort:Array.prototype.sort,splice:Array.prototype.splice},bt.extend(Uu,{extend:bt.extend,makeArray:function(e){return(t=e)&&t===t.window||e.nodeType?[e]:bt.toArray(e);var t},inArray:function(e,t){var n;if(t.indexOf)return t.indexOf(e);for(n=t.length;n--;)if(t[n]===e)return n;return-1},isArray:bt.isArray,each:Vu,trim:Hu,grep:qu,find:fu,expr:fu.selectors,unique:fu.uniqueSort,text:fu.getText,contains:fu.contains,filter:function(e,t,n){var r=t.length;for(n&&(e=":not("+e+")");r--;)1!==t[r].nodeType&&t.splice(r,1);return t=1===t.length?Gu.find.matchesSelector(t[0],e)?[t[0]]:[]:Gu.find.matches(e,t)}});var $u=function(e,t,n){var r=[],o=e[t];for("string"!=typeof n&&n instanceof Gu&&(n=n[0]);o&&9!==o.nodeType;){if(void 0!==n){if(o===n)break;if("string"==typeof n&&Gu(o).is(n))break}1===o.nodeType&&r.push(o),o=o[t]}return r},Ku=function(e,t,n,r){var o=[];for(r instanceof Gu&&(r=r[0]);e;e=e[t])if(!n||e.nodeType===n){if(void 0!==r){if(e===r)break;if("string"==typeof r&&Gu(e).is(r))break}o.push(e)}return o},Xu=function(e,t,n){for(e=e[t];e;e=e[t])if(e.nodeType===n)return e;return null};Vu({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return $u(e,"parentNode")},next:function(e){return Xu(e,"nextSibling",1)},prev:function(e){return Xu(e,"previousSibling",1)},children:function(e){return Ku(e.firstChild,"nextSibling",1)},contents:function(e){return bt.toArray(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},(function(e,t){Uu.fn[e]=function(n){var r=[];this.each((function(){var e=t.call(r,this,n,r);e&&(Gu.isArray(e)?r.push.apply(r,e):r.push(e))})),this.length>1&&(Eu[e]||(r=Gu.unique(r)),0===e.indexOf("parents")&&(r=r.reverse()));var o=Gu(r);return n?o.filter(n):o}})),Vu({parentsUntil:function(e,t){return $u(e,"parentNode",t)},nextUntil:function(e,t){return Ku(e,"nextSibling",1,t).slice(1)},prevUntil:function(e,t){return Ku(e,"previousSibling",1,t).slice(1)}},(function(e,t){Uu.fn[e]=function(n,r){var o=[];this.each((function(){var e=t.call(o,this,n,o);e&&(Gu.isArray(e)?o.push.apply(o,e):o.push(e))})),this.length>1&&(o=Gu.unique(o),0!==e.indexOf("parents")&&"prevUntil"!==e||(o=o.reverse()));var i=Gu(o);return r?i.filter(r):i}})),Uu.fn.is=function(e){return!!e&&this.filter(e).length>0},Uu.fn.init.prototype=Uu.fn,Uu.overrideDefaults=function(e){var t,n=function(r,o){return t=t||e(),0===arguments.length&&(r=t.element),o||(o=t.context),new n.fn.init(r,o)};return Gu.extend(n,this),n},Uu.attrHooks=Fu,Uu.cssHooks=ju;var Gu=Uu,Yu=bt.each,Qu=bt.grep,Ju=mt.ie,Zu=/^([a-z0-9],?)+$/i,ea=function(e,t){var n=t.attr("style"),r=e.serialize(e.parse(n),t[0].nodeName);r||(r=null),t.attr("data-mce-style",r)},ta=function(e,t){var n,r,o=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)r=e.nodeType,(!t||3!==r||r!==n&&e.nodeValue.length)&&(o++,n=r);return o},na=function(e,t){void 0===t&&(t={});var n={},r=window,o={},i=0,u=Yr.forElement(Ct.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),a=[],c=t.schema?t.schema:vi({}),f=yi({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),l=t.ownEvents?new Ri:Ri.Event,s=c.getBlockElements(),d=Gu.overrideDefaults((function(){return{context:e,element:V.getRoot()}})),g=function(t){return t&&e&&m(t)?e.getElementById(t):t},p=function(e){return d("string"==typeof e?g(e):e)},h=function(e,t,n){var r,o,i=p(e);return i.length&&(o=(r=q[t])&&r.get?r.get(i,t):i.attr(t)),void 0===o&&(o=n||""),o},v=function(e){var t=g(e);return t?t.attributes:[]},b=function(e,n,r){""===r&&(r=null);var o=p(e),i=o.attr(n);if(o.length){var u=q[n];u&&u.set?u.set(o,r,n):o.attr(n,r),i!==r&&t.onSetAttrib&&t.onSetAttrib({attrElm:o,attrName:n,attrValue:r})}},C=function(){return t.root_element||e.body},w=function(t,n){return nr(e.body,g(t),n)},x=function(e,t,n){var r=p(e);return n?r.css(t):("float"===(t=t.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()})))&&(t=mt.browser.isIE()?"styleFloat":"cssFloat"),r[0]&&r[0].style?r[0].style[t]:void 0)},T=function(e){var t,n;return e=g(e),t=x(e,"width"),n=x(e,"height"),-1===t.indexOf("px")&&(t=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(t,10)||e.offsetWidth||e.clientWidth,h:parseInt(n,10)||e.offsetHeight||e.clientHeight}},k=function(e,t){var n;if(!e)return!1;if(!Array.isArray(e)){if("*"===t)return 1===e.nodeType;if(Zu.test(t)){var r=t.toLowerCase().split(/,/),o=e.nodeName.toLowerCase();for(n=r.length-1;n>=0;n--)if(r[n]===o)return!0;return!1}if(e.nodeType&&1!==e.nodeType)return!1}var i=Array.isArray(e)?e:[e];return fu(t,i[0].ownerDocument||i[0],null,i).length>0},E=function(e,t,n,r){var o,i=[],u=g(e);for(r=void 0===r,n=n||("BODY"!==C().nodeName?C().parentNode:null),bt.is(t,"string")&&(o=t,t="*"===t?function(e){return 1===e.nodeType}:function(e){return k(e,o)});u&&!(u===n||y(u.nodeType)||An(u)||On(u));){if(!t||"function"==typeof t&&t(u)){if(!r)return[u];i.push(u)}u=u.parentNode}return r?i:null},R=function(e,t,n){var r=t;if(e)for("string"==typeof t&&(r=function(e){return k(e,t)}),e=e[n];e;e=e[n])if("function"==typeof r&&r(e))return e;return null},_=function(e,t,n){var r,o="string"==typeof e?g(e):e;if(!o)return!1;if(bt.isArray(o)&&(o.length||0===o.length))return r=[],Yu(o,(function(e,o){e&&r.push(t.call(n,"string"==typeof e?g(e):e,o))})),r;var i=n||this;return t.call(i,o)},D=function(e,t){p(e).each((function(e,n){Yu(t,(function(e,t){b(n,t,e)}))}))},A=function(e,t){var n=p(e);Ju?n.each((function(e,n){if(!1!==n.canHaveHTML){for(;n.firstChild;)n.removeChild(n.firstChild);try{n.innerHTML="<br>"+t,n.removeChild(n.firstChild)}catch(e){Gu("<div></div>").html("<br>"+t).contents().slice(1).appendTo(n)}return t}})):n.html(t)},O=function(t,n,r,o,i){return _(t,(function(t){var u="string"==typeof n?e.createElement(n):n;return D(u,r),o&&("string"!=typeof o&&o.nodeType?u.appendChild(o):"string"==typeof o&&A(u,o)),i?u:t.appendChild(u)}))},B=function(t,n,r){return O(e.createElement(t),t,n,r,!0)},P=ai.encodeAllRaw,L=function(e,t){var n=p(e);return t?n.each((function(){for(var e;e=this.firstChild;)3===e.nodeType&&0===e.data.length?this.removeChild(e):this.parentNode.insertBefore(e,this)})).remove():n.remove(),n.length>1?n.toArray():n[0]},I=function(e,t,n){p(e).toggleClass(t,n).each((function(){""===this.className&&Gu(this).attr("class",null)}))},M=function(e,t,n){return _(t,(function(t){return bt.is(t,"array")&&(e=e.cloneNode(!0)),n&&Yu(Qu(t.childNodes),(function(t){e.appendChild(t)})),t.parentNode.replaceChild(e,t)}))},F=function(e){if(wn(e)){var t="a"===e.nodeName.toLowerCase()&&!h(e,"href")&&h(e,"id");if(h(e,"name")||h(e,"data-mce-bookmark")||t)return!0}return!1},j=function(){return e.createRange()},U=function(n,o,i,u){if(bt.isArray(n)){for(var c=n.length,f=[];c--;)f[c]=U(n[c],o,i,u);return f}return!t.collect||n!==e&&n!==r||a.push([n,o,i,u]),l.bind(n,o,i,u||V)},z=function(t,n,o){if(bt.isArray(t)){for(var i=t.length,u=[];i--;)u[i]=z(t[i],n,o);return u}if(a.length>0&&(t===e||t===r))for(i=a.length;i--;){var c=a[i];t!==c[0]||n&&n!==c[1]||o&&o!==c[2]||l.unbind(c[0],c[1],c[2])}return l.unbind(t,n,o)},H=function(e){if(e&&wn(e)){var t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}return null},V={doc:e,settings:t,win:r,files:o,stdMode:!0,boxModel:!0,styleSheetLoader:u,boundEvents:a,styles:f,schema:c,events:l,isBlock:function(e){if("string"==typeof e)return!!s[e];if(e){var t=e.nodeType;if(t)return!(1!==t||!s[e.nodeName])}return!1},$:d,$$:p,root:null,clone:function(t,n){if(!Ju||1!==t.nodeType||n)return t.cloneNode(n);var r=e.createElement(t.nodeName);return Yu(v(t),(function(e){b(r,e.nodeName,h(t,e.nodeName))})),r},getRoot:C,getViewPort:function(e){var t=bn(e);return{x:t.x,y:t.y,w:t.width,h:t.height}},getRect:function(e){e=g(e);var t=w(e),n=T(e);return{x:t.x,y:t.y,w:n.w,h:n.h}},getSize:T,getParent:function(e,t,n){var r=E(e,t,n,!1);return r&&r.length>0?r[0]:null},getParents:E,get:g,getNext:function(e,t){return R(e,t,"nextSibling")},getPrev:function(e,t){return R(e,t,"previousSibling")},select:function(n,r){return fu(n,g(r)||t.root_element||e,[])},is:k,add:O,create:B,createHTML:function(e,t,n){var r,o="";for(r in o+="<"+e,t)xe(t,r)&&(o+=" "+r+'="'+P(t[r])+'"');return void 0!==n?o+">"+n+"</"+e+">":o+" />"},createFragment:function(t){var n,r=e.createElement("div"),o=e.createDocumentFragment();for(o.appendChild(r),t&&(r.innerHTML=t);n=r.firstChild;)o.appendChild(n);return o.removeChild(r),o},remove:L,setStyle:function(e,n,r){var o=m(n)?p(e).css(n,r):p(e).css(n);t.update_styles&&ea(f,o)},getStyle:x,setStyles:function(e,n){var r=p(e).css(n);t.update_styles&&ea(f,r)},removeAllAttribs:function(e){return _(e,(function(e){var t,n=e.attributes;for(t=n.length-1;t>=0;t--)e.removeAttributeNode(n.item(t))}))},setAttrib:b,setAttribs:D,getAttrib:h,getPos:w,parseStyle:function(e){return f.parse(e)},serializeStyle:function(e,t){return f.serialize(e,t)},addStyle:function(t){var r,o;if(V!==na.DOM&&e===document){if(n[t])return;n[t]=!0}(o=e.getElementById("mceDefaultStyles"))||((o=e.createElement("style")).id="mceDefaultStyles",o.type="text/css",(r=e.getElementsByTagName("head")[0]).firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o)),o.styleSheet?o.styleSheet.cssText+=t:o.appendChild(e.createTextNode(t))},loadCSS:function(e){e||(e=""),$(e.split(","),(function(e){o[e]=!0,u.load(e,S)}))},addClass:function(e,t){p(e).addClass(t)},removeClass:function(e,t){I(e,t,!1)},hasClass:function(e,t){return p(e).hasClass(t)},toggleClass:I,show:function(e){p(e).show()},hide:function(e){p(e).hide()},isHidden:function(e){return"none"===p(e).css("display")},uniqueId:function(e){return(e||"mce_")+i++},setHTML:A,getOuterHTML:function(e){var t="string"==typeof e?g(e):e;return wn(t)?t.outerHTML:Gu("<div></div>").append(Gu(t).clone()).html()},setOuterHTML:function(e,t){p(e).each((function(){try{if("outerHTML"in this)return void(this.outerHTML=t)}catch(e){}L(Gu(this).html(t),!0)}))},decode:ai.decode,encode:P,insertAfter:function(e,t){var n=g(t);return _(e,(function(e){var t=n.parentNode,r=n.nextSibling;return r?t.insertBefore(e,r):t.appendChild(e),e}))},replace:M,rename:function(e,t){var n;return e.nodeName!==t.toUpperCase()&&(n=B(t),Yu(v(e),(function(t){b(n,t.nodeName,h(e,t.nodeName))})),M(n,e,!0)),n||e},findCommonAncestor:function(e,t){for(var n,r=e;r;){for(n=t;n&&r!==n;)n=n.parentNode;if(r===n)break;r=r.parentNode}return!r&&e.ownerDocument?e.ownerDocument.documentElement:r},toHex:function(e){return f.toHex(bt.trim(e))},run:_,getAttribs:v,isEmpty:function(e,t){var n,r,o=0;if(F(e))return!1;if(e=e.firstChild){var i=new Qr(e,e.parentNode),u=c?c.getWhiteSpaceElements():{};t=t||(c?c.getNonEmptyElements():null);do{if(n=e.nodeType,wn(e)){var a=e.getAttribute("data-mce-bogus");if(a){e=i.next("all"===a);continue}if(r=e.nodeName.toLowerCase(),t&&t[r]){if("br"===r){o++,e=i.next();continue}return!1}if(F(e))return!1}if(8===n)return!1;if(3===n&&!Mo(e.nodeValue))return!1;if(3===n&&e.parentNode&&u[e.parentNode.nodeName]&&Mo(e.nodeValue))return!1;e=i.next()}while(e)}return o<=1},createRng:j,nodeIndex:ta,split:function(e,t,n){var r,o,i,u=j();if(e&&t)return u.setStart(e.parentNode,ta(e)),u.setEnd(t.parentNode,ta(t)),r=u.extractContents(),(u=j()).setStart(t.parentNode,ta(t)+1),u.setEnd(e.parentNode,ta(e)+1),o=u.extractContents(),(i=e.parentNode).insertBefore(Ko(V,r),e),n?i.insertBefore(n,e):i.insertBefore(t,e),i.insertBefore(Ko(V,o),e),L(e),n||t},bind:U,unbind:z,fire:function(e,t,n){return l.fire(e,t,n)},getContentEditable:H,getContentEditableParent:function(e){for(var t=C(),n=null;e&&e!==t&&null===(n=H(e));e=e.parentNode);return n},destroy:function(){if(a.length>0)for(var e=a.length;e--;){var t=a[e];l.unbind(t[0],t[1],t[2])}me(o,(function(e,t){u.unload(t),delete o[t]})),fu.setDocument&&fu.setDocument()},isChildOf:function(e,t){if(Ju){for(;e;){if(t===e)return!0;e=e.parentNode}return!1}return e===t||t.contains(e)},dumpRng:function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset}},q=function(e,t,n){var r=t.keep_values,o={set:function(e,r,o){t.url_converter&&null!==r&&(r=t.url_converter.call(t.url_converter_scope||n(),r,o,e[0])),e.attr("data-mce-"+o,r).attr(o,r)},get:function(e,t){return e.attr("data-mce-"+t)||e.attr(t)}},i={style:{set:function(t,n){null===n||"object"!=typeof n?(r&&t.attr("data-mce-style",n),null!==n&&"string"==typeof n?(t.removeAttr("style"),t.css(e.parse(n))):t.attr("style",n)):t.css(n)},get:function(t){var n=t.attr("data-mce-style")||t.attr("style");return n=e.serialize(e.parse(n),t[0].nodeName)}}};return r&&(i.href=i.src=o),i}(f,t,N(V));return V};na.DOM=na(document),na.nodeIndex=ta;var ra=na.DOM,oa=bt.each,ia=bt.grep,ua=function(){function e(e){void 0===e&&(e={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=e}return e.prototype._setReferrerPolicy=function(e){this.settings.referrerPolicy=e},e.prototype.loadScript=function(e,t,n){var r,o=ra,i=function(){o.remove(u),r&&(r.onerror=r.onload=r=null)},u=o.uniqueId();(r=document.createElement("script")).id=u,r.type="text/javascript",r.src=bt._addCacheSuffix(e),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=function(){i(),t()},r.onerror=function(){i(),w(n)?n():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(r)},e.prototype.isDone=function(e){return 2===this.states[e]},e.prototype.markDone=function(e){this.states[e]=2},e.prototype.add=function(e,t,n,r){var o=this.states[e];this.queue.push(e),void 0===o&&(this.states[e]=0),t&&(this.scriptLoadedCallbacks[e]||(this.scriptLoadedCallbacks[e]=[]),this.scriptLoadedCallbacks[e].push({success:t,failure:r,scope:n||this}))},e.prototype.load=function(e,t,n,r){return this.add(e,t,n,r)},e.prototype.remove=function(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]},e.prototype.loadQueue=function(e,t,n){this.loadScripts(this.queue,e,t,n)},e.prototype.loadScripts=function(e,t,n,r){var o=this,i=[],u=function(e,t){oa(o.scriptLoadedCallbacks[t],(function(t){w(t[e])&&t[e].call(t.scope)})),o.scriptLoadedCallbacks[t]=void 0};o.queueLoadedCallbacks.push({success:t,failure:r,scope:n||this});var a=function(){var t=ia(e);if(e.length=0,oa(t,(function(e){2!==o.states[e]?3!==o.states[e]?1!==o.states[e]&&(o.states[e]=1,o.loading++,o.loadScript(e,(function(){o.states[e]=2,o.loading--,u("success",e),a()}),(function(){o.states[e]=3,o.loading--,i.push(e),u("failure",e),a()}))):u("failure",e):u("success",e)})),!o.loading){var n=o.queueLoadedCallbacks.slice(0);o.queueLoadedCallbacks.length=0,oa(n,(function(e){0===i.length?w(e.success)&&e.success.call(e.scope):w(e.failure)&&e.failure.call(e.scope,i)}))}};a()},e.ScriptLoader=new e,e}(),aa=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},ca={},fa=aa("en"),la=function(){return Ce(ca,fa.get())},sa={getData:function(){return ge(ca,(function(e){return Ae({},e)}))},setCode:function(e){e&&fa.set(e)},getCode:function(){return fa.get()},add:function(e,t){var n=ca[e];n||(ca[e]=n={}),me(t,(function(e,t){n[t.toLowerCase()]=e}))},translate:function(e){var t,n=la().getOr({}),r=function(e){return w(e)?Object.prototype.toString.call(e):o(e)?"":""+e},o=function(e){return""===e||null==e},i=function(e){var t=r(e);return Ce(n,t.toLowerCase()).map(r).getOr(t)},u=function(e){return e.replace(/{context:\w+}$/,"")};if(o(e))return"";if(g(t=e)&&we(t,"raw"))return r(e.raw);if(function(e){return p(e)&&e.length>1}(e)){var a=e.slice(1);return u(i(e[0]).replace(/\{([0-9]+)\}/g,(function(e,t){return we(a,t)?r(a[t]):e})))}return u(i(e))},isRtl:function(){return la().bind((function(e){return Ce(e,"_dir")})).exists((function(e){return"rtl"===e}))},hasCode:function(e){return we(ca,e)}},da=function(){var e=[],t={},n={},r=[],o=function(e,t){var n=G(r,(function(n){return n.name===e&&n.state===t}));$(n,(function(e){return e.callback()}))},i=function(e){var t;return n[e]&&(t=n[e].dependencies),t||[]},u=function(e,t){return"object"==typeof t?t:"string"==typeof e?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}},a=function(e,r,c,f,l){if(!t[e]){var s="string"==typeof r?r:r.prefix+r.resource+r.suffix;0!==s.indexOf("/")&&-1===s.indexOf("://")&&(s=da.baseURL+"/"+s),t[e]=s.substring(0,s.lastIndexOf("/"));var d=function(){o(e,"loaded"),function(e,t,n,r){var o=i(e);$(o,(function(e){var n=u(t,e);a(n.resource,n,void 0,void 0)})),n&&(r?n.call(r):n.call(ua))}(e,r,c,f)};n[e]?d():ua.ScriptLoader.add(s,d,f,l)}},c=function(e,o,i){void 0===i&&(i="added"),we(n,e)&&"added"===i||we(t,e)&&"loaded"===i?o():r.push({name:e,state:i,callback:o})};return{items:e,urls:t,lookup:n,_listeners:r,get:function(e){if(n[e])return n[e].instance},dependencies:i,requireLangPack:function(e,n){!1!==da.languageLoad&&c(e,(function(){var r=sa.getCode();!r||n&&-1===(","+(n||"")+",").indexOf(","+r+",")||ua.ScriptLoader.add(t[e]+"/langs/"+r+".js")}),"loaded")},add:function(t,r,i){var u=r;return e.push(u),n[t]={instance:u,dependencies:i},o(t,"added"),u},remove:function(e){delete t[e],delete n[e]},createUrl:u,addComponents:function(e,n){var r=t[e];$(n,(function(e){ua.ScriptLoader.add(r+"/"+e)}))},load:a,waitFor:c}};da.languageLoad=!0,da.baseURL="",da.PluginManager=da(),da.ThemeManager=da();var ma=function(){var e=function(e){var t=aa(F.none()),n=function(){return t.get().each(e)};return{clear:function(){n(),t.set(F.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){n(),t.set(F.some(e))}}}(S);return Ae(Ae({},e),{on:function(t){return e.get().each(t)}})},ga=function(e,t){var n=null;return{cancel:function(){h(n)||(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];h(n)&&(n=setTimeout((function(){n=null,e.apply(null,r)}),t))}}},pa=function(e,t){var n=null,r=function(){h(n)||(clearTimeout(n),n=null)};return{cancel:r,throttle:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r(),n=setTimeout((function(){n=null,e.apply(null,o)}),t)}}},ha=function(e,t){var n=Wn(e,t);return void 0===n||""===n?[]:n.split(" ")},va=function(e){return void 0!==e.dom.classList},ba=function(e,t){return function(e,t,n){var r=ha(e,t).concat([n]);return Vn(e,t,r.join(" ")),!0}(e,"class",t)},ya=function(e,t){return function(e,t,n){var r=G(ha(e,t),(function(e){return e!==n}));return r.length>0?Vn(e,t,r.join(" ")):Kn(e,t),!1}(e,"class",t)},Ca=function(e,t){va(e)?e.dom.classList.add(t):ba(e,t)},wa=function(e){0===(va(e)?e.dom.classList:function(e){return ha(e,"class")}(e)).length&&Kn(e,"class")},xa=function(e,t){return va(e)&&e.dom.classList.contains(t)},Sa=function(e,t){var n=[];return $(Ht(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(Sa(e,t))})),n},Ta=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return St(n)?[]:W(n.querySelectorAll(e),Ct.fromDom)}(t,e)},ka=N("mce-annotation"),Na=N("data-mce-annotation"),Ea=N("data-mce-annotation-uid"),Ra=function(e,t){var n=e.selection.getRng(),r=Ct.fromDom(n.startContainer),o=Ct.fromDom(e.getBody()),i=t.fold((function(){return"."+ka()}),(function(e){return"["+Na()+'="'+e+'"]'})),u=Vt(r,n.startOffset).getOr(r),a=Vr(u,i,(function(e){return Tt(e,o)})),c=function(e,t){return function(e,t){var n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)}(e,t)?F.some(Wn(e,t)):F.none()};return a.bind((function(t){return c(t,""+Ea()).bind((function(n){return c(t,""+Na()).map((function(t){var r=_a(e,n);return{uid:n,name:t,elements:r}}))}))}))},_a=function(e,t){var n=Ct.fromDom(e.getBody());return Ta(n,"["+Ea()+'="'+t+'"]')},Da=function(e,t){var n=aa({}),r=function(){return{listeners:[],previous:ma()}},o=function(e,t){i(e,(function(e){return t(e),e}))},i=function(e,t){var o=n.get(),i=t(Ce(o,e).getOrThunk(r));o[e]=i,n.set(o)},u=pa((function(){var t=n.get(),r=ie(se(t));$(r,(function(t){i(t,(function(n){var r=n.previous.get();return Ra(e,F.some(t)).fold((function(){r.isSome()&&(!function(e){o(e,(function(t){$(t.listeners,(function(t){return t(!1,e)}))}))}(t),n.previous.clear())}),(function(e){var t=e.uid,i=e.name,u=e.elements;jn(r,t)||(!function(e,t,n){o(e,(function(r){$(r.listeners,(function(r){return r(!0,e,{uid:t,nodes:W(n,(function(e){return e.dom}))})}))}))}(i,t,u),n.previous.set(t))})),{previous:n.previous,listeners:n.listeners}}))}))}),30);e.on("remove",(function(){u.cancel()})),e.on("NodeChange",(function(){u.throttle()}));return{addListener:function(e,t){i(e,(function(e){return{previous:e.previous,listeners:e.listeners.concat([t])}}))}}},Aa=function(e,t){e.on("init",(function(){e.serializer.addNodeFilter("span",(function(e){$(e,(function(e){(function(e){return F.from(e.attr(Na())).bind(t.lookup)})(e).each((function(t){!1===t.persistent&&e.unwrap()}))}))}))}))},Oa=0,Ba=function(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++Oa+String(t)},Pa=function(e,t){var n,r,o=Pt(e).dom,i=Ct.fromDom(o.createDocumentFragment()),u=(n=t,(r=(o||document).createElement("div")).innerHTML=n,Ht(Ct.fromDom(r)));on(i,u),un(e),rn(e,i)},La=function(e,t){return Ct.fromDom(e.dom.cloneNode(t))},Ia=function(e){return La(e,!1)},Ma=function(e){return La(e,!0)},Fa=function(e,t,n){void 0===n&&(n=B);var r=new Qr(e,t),o=function(e){var t;do{t=r[e]()}while(t&&!_n(t)&&!n(t));return F.from(t).filter(_n)};return{current:function(){return F.from(r.current()).filter(_n)},next:function(){return o("next")},prev:function(){return o("prev")},prev2:function(){return o("prev2")}}},ja=function(e,t){var n=t||function(t){return e.isBlock(t)||Bn(t)||In(t)},r=function(e,t,n,o){if(_n(e)){var i=o(e,t,e.data);if(-1!==i)return F.some({container:e,offset:i})}return n().bind((function(e){return r(e.container,e.offset,n,o)}))};return{backwards:function(e,t,o,i){var u=Fa(e,i,n);return r(e,t,(function(){return u.prev().map((function(e){return{container:e,offset:e.length}}))}),o).getOrNull()},forwards:function(e,t,o,i){var u=Fa(e,i,n);return r(e,t,(function(){return u.next().map((function(e){return{container:e,offset:0}}))}),o).getOrNull()}}},Ua=Math.round,za=function(e){return e?{left:Ua(e.left),top:Ua(e.top),bottom:Ua(e.bottom),right:Ua(e.right),width:Ua(e.width),height:Ua(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},Ha=function(e,t){return e=za(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e},Va=function(e,t,n){return e>=0&&e<=Math.min(t.height,n.height)/2},qa=function(e,t){var n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&Va(t.top-e.bottom,e,t)},Wa=function(e,t){return e.top>t.bottom||!(e.bottom<t.top)&&Va(t.bottom-e.top,e,t)},$a=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},Ka=function(e){var t=e.startContainer,n=e.startOffset;return t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},Xa=function(e,t){if(wn(e)&&e.hasChildNodes()){var n=e.childNodes;return n[function(e,t,n){return Math.min(Math.max(e,t),n)}(t,0,n.length-1)]}return e},Ga=new RegExp("[-----------------------------------------------------------------------------------------------------------------------------------]"),Ya=function(e){return"string"==typeof e&&e.charCodeAt(0)>=768&&Ga.test(e)},Qa=wn,Ja=Bo,Za=Sn("display","block table"),ec=Sn("float","left right"),tc=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(!e[n](t))return!1;return!0}}(Qa,Ja,D(ec)),nc=D(Sn("white-space","pre pre-line pre-wrap")),rc=_n,oc=Bn,ic=na.nodeIndex,uc=function(e,t){return t<0&&wn(e)&&e.hasChildNodes()?void 0:Xa(e,t)},ac=function(e){return"createRange"in e?e.createRange():na.DOM.createRng()},cc=function(e){return e&&/[\r\n\t ]/.test(e)},fc=function(e){return!!e.setStart&&!!e.setEnd},lc=function(e){var t=e.startContainer,n=e.startOffset;if(cc(e.toString())&&nc(t.parentNode)&&_n(t)){var r=t.data;if(cc(r[n-1])||cc(r[n+1]))return!0}return!1},sc=function(e){return 0===e.left&&0===e.right&&0===e.top&&0===e.bottom},dc=function(e){var t,n=e.getClientRects();return t=n.length>0?za(n[0]):za(e.getBoundingClientRect()),!fc(e)&&oc(e)&&sc(t)?function(e){var t=e.ownerDocument,n=ac(t),r=t.createTextNode(""),o=e.parentNode;o.insertBefore(r,e),n.setStart(r,0),n.setEnd(r,1);var i=za(n.getBoundingClientRect());return o.removeChild(r),i}(e):sc(t)&&fc(e)?function(e){var t=e.startContainer,n=e.endContainer,r=e.startOffset,o=e.endOffset;if(t===n&&_n(n)&&0===r&&1===o){var i=e.cloneRange();return i.setEndAfter(n),dc(i)}return null}(e):t},mc=function(e,t){var n=Ha(e,t);return n.width=1,n.right=n.left+1,n},gc=function(e){var t=[],n=function(e){var n,r;0!==e.height&&(t.length>0&&(n=e,r=t[t.length-1],n.left===r.left&&n.top===r.top&&n.bottom===r.bottom&&n.right===r.right)||t.push(e))},r=function(e,r){var o=ac(e.ownerDocument);if(r<e.data.length){if(Ya(e.data[r]))return t;if(Ya(e.data[r-1])&&(o.setStart(e,r),o.setEnd(e,r+1),!lc(o)))return n(mc(dc(o),!1)),t}r>0&&(o.setStart(e,r-1),o.setEnd(e,r),lc(o)||n(mc(dc(o),!1))),r<e.data.length&&(o.setStart(e,r),o.setEnd(e,r+1),lc(o)||n(mc(dc(o),!0)))},o=e.container(),i=e.offset();if(rc(o))return r(o,i),t;if(Qa(o))if(e.isAtEnd()){var u=uc(o,i);rc(u)&&r(u,u.data.length),tc(u)&&!oc(u)&&n(mc(dc(u),!1))}else{u=uc(o,i);if(rc(u)&&r(u,0),tc(u)&&e.isAtEnd())return n(mc(dc(u),!1)),t;var a=uc(e.container(),e.offset()-1);tc(a)&&!oc(a)&&(Za(a)||Za(u)||!tc(u))&&n(mc(dc(a),!1)),tc(u)&&n(mc(dc(u),!0))}return t},pc=function(e,t,n){var r=function(){return n||(n=gc(pc(e,t))),n};return{container:N(e),offset:N(t),toRange:function(){var n=ac(e.ownerDocument);return n.setStart(e,t),n.setEnd(e,t),n},getClientRects:r,isVisible:function(){return r().length>0},isAtStart:function(){return rc(e),0===t},isAtEnd:function(){return rc(e)?t>=e.data.length:t>=e.childNodes.length},isEqual:function(n){return n&&e===n.container()&&t===n.offset()},getNode:function(n){return uc(e,n?t-1:t)}}};pc.fromRangeStart=function(e){return pc(e.startContainer,e.startOffset)},pc.fromRangeEnd=function(e){return pc(e.endContainer,e.endOffset)},pc.after=function(e){return pc(e.parentNode,ic(e)+1)},pc.before=function(e){return pc(e.parentNode,ic(e))},pc.isAbove=function(e,t){return Un(ae(t.getClientRects()),ce(e.getClientRects()),qa).getOr(!1)},pc.isBelow=function(e,t){return Un(ce(t.getClientRects()),ae(e.getClientRects()),Wa).getOr(!1)},pc.isAtStart=function(e){return!!e&&e.isAtStart()},pc.isAtEnd=function(e){return!!e&&e.isAtEnd()},pc.isTextPosition=function(e){return!!e&&_n(e.container())},pc.isElementPosition=function(e){return!1===pc.isTextPosition(e)};var hc,vc=function(e,t){_n(t)&&0===t.data.length&&e.remove(t)},bc=function(e,t,n){On(n)?function(e,t,n){var r=F.from(n.firstChild),o=F.from(n.lastChild);t.insertNode(n),r.each((function(t){return vc(e,t.previousSibling)})),o.each((function(t){return vc(e,t.nextSibling)}))}(e,t,n):function(e,t,n){t.insertNode(n),vc(e,n.previousSibling),vc(e,n.nextSibling)}(e,t,n)},yc=_n,Cc=kn,wc=na.nodeIndex,xc=function(e){var t=e.parentNode;return Cc(t)?xc(t):t},Sc=function(e){return e?Re(e.childNodes,(function(e,t){return Cc(t)&&"BR"!==t.nodeName?e=e.concat(Sc(t)):e.push(t),e}),[]):[]},Tc=function(e){return function(t){return e===t}},kc=function(e){return(yc(e)?"text()":e.nodeName.toLowerCase())+"["+function(e){var t,n;t=Sc(xc(e)),n=_e(t,Tc(e),e),t=t.slice(0,n+1);var r=Re(t,(function(e,n,r){return yc(n)&&yc(t[r-1])&&e++,e}),0);return t=Ne(t,xn([e.nodeName])),(n=_e(t,Tc(e),e))-r}(e)+"]"},Nc=function(e,t){var n,r,o,i,u,a=[];return n=t.container(),r=t.offset(),yc(n)?o=function(e,t){for(;(e=e.previousSibling)&&yc(e);)t+=e.data.length;return t}(n,r):(r>=(i=n.childNodes).length?(o="after",r=i.length-1):o="before",n=i[r]),a.push(kc(n)),u=function(e,t,n){var r=[];for(t=t.parentNode;t!==e&&(!n||!n(t));t=t.parentNode)r.push(t);return r}(e,n),u=Ne(u,D(kn)),(a=a.concat(ke(u,(function(e){return kc(e)})))).reverse().join("/")+","+o},Ec=function(e,t){var n;if(!t)return null;var r=t.split(","),o=r[0].split("/");n=r.length>1?r[1]:"before";var i=Re(o,(function(e,t){var n=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);return n?("text()"===n[1]&&(n[1]="#text"),function(e,t,n){var r=Sc(e);return r=Ne(r,(function(e,t){return!yc(e)||!yc(r[t-1])})),(r=Ne(r,xn([t])))[n]}(e,n[1],parseInt(n[2],10))):null}),e);return i?yc(i)?function(e,t){for(var n,r=e,o=0;yc(r);){if(n=r.data.length,t>=o&&t<=o+n){e=r,t-=o;break}if(!yc(r.nextSibling)){e=r,t=n;break}o+=n,r=r.nextSibling}return yc(e)&&t>e.data.length&&(t=e.data.length),pc(e,t)}(i,parseInt(n,10)):(n="after"===n?wc(i)+1:wc(i),pc(i.parentNode,n)):null},Rc=In,_c=function(e,t,n,r,o){var i,u=r[o?"startContainer":"endContainer"],a=r[o?"startOffset":"endOffset"],c=[],f=0,l=e.getRoot();for(_n(u)?c.push(n?function(e,t,n){var r,o;for(o=e(t.data.slice(0,n)).length,r=t.previousSibling;r&&_n(r);r=r.previousSibling)o+=e(r.data).length;return o}(t,u,a):a):(a>=(i=u.childNodes).length&&i.length&&(f=1,a=Math.max(0,i.length-1)),c.push(e.nodeIndex(i[a],n)+f));u&&u!==l;u=u.parentNode)c.push(e.nodeIndex(u,n));return c},Dc=function(e,t,n){var r=0;return bt.each(e.select(t),(function(e){if("all"!==e.getAttribute("data-mce-bogus"))return e!==n&&void r++})),r},Ac=function(e,t){var n,r,o,i=t?"start":"end";n=e[i+"Container"],r=e[i+"Offset"],wn(n)&&"TR"===n.nodeName&&(n=(o=n.childNodes)[Math.min(t?r:r-1,o.length-1)])&&(r=t?0:n.childNodes.length,e["set"+(t?"Start":"End")](n,r))},Oc=function(e){return Ac(e,!0),Ac(e,!1),e},Bc=function(e,t){var n;if(wn(e)&&(e=Xa(e,t),Rc(e)))return e;if(ho(e)){if(_n(e)&&go(e)&&(e=e.parentNode),n=e.previousSibling,Rc(n))return n;if(n=e.nextSibling,Rc(n))return n}},Pc=function(e,t,n){var r=n.getNode(),o=r?r.nodeName:null,i=n.getRng();if(Rc(r)||"IMG"===o)return{name:o,index:Dc(n.dom,o,r)};var u=function(e){return Bc(e.startContainer,e.startOffset)||Bc(e.endContainer,e.endOffset)}(i);return u?{name:o=u.tagName,index:Dc(n.dom,o,u)}:function(e,t,n,r){var o=t.dom,i={};return i.start=_c(o,e,n,r,!0),t.isCollapsed()||(i.end=_c(o,e,n,r,!1)),To(r)&&(i.isFakeCaret=!0),i}(e,n,t,i)},Lc=function(e,t,n){var r={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",r,"&#xFEFF;"):e.create("span",r)},Ic=function(e,t){var n=e.dom,r=e.getRng(),o=n.uniqueId(),i=e.isCollapsed(),u=e.getNode(),a=u.nodeName;if("IMG"===a)return{name:a,index:Dc(n,a,u)};var c=Oc(r.cloneRange());if(!i){c.collapse(!1);var f=Lc(n,o+"_end",t);bc(n,c,f)}(r=Oc(r)).collapse(!0);var l=Lc(n,o+"_start",t);return bc(n,r,l),e.moveToBookmark({id:o,keep:!0}),{id:o}},Mc=function(e,t,n){return 2===t?Pc(lo,n,e):3===t?function(e){var t=e.getRng();return{start:Nc(e.dom.getRoot(),pc.fromRangeStart(t)),end:Nc(e.dom.getRoot(),pc.fromRangeEnd(t))}}(e):t?function(e){return{rng:e.getRng()}}(e):Ic(e,!1)},Fc=_(Pc,E,!0),jc=na.DOM,Uc=function(e,t,n){var r=e.getParam(t,n);if(-1!==r.indexOf("=")){var o=e.getParam(t,"","hash");return Ce(o,e.id).getOr(n)}return r},zc=function(e){return e.getParam("content_security_policy","")},Hc=function(e){if(e.getParam("force_p_newlines",!1))return"p";var t=e.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t},Vc=function(e){return e.getParam("forced_root_block_attrs",{})},qc=function(e){return e.getParam("automatic_uploads",!0,"boolean")},Wc=function(e){return e.getParam("images_reuse_filename",!1,"boolean")},$c=function(e){return e.getParam("icons","","string")},Kc=function(e){return e.getParam("images_upload_url","","string")},Xc=function(e){return e.getParam("images_upload_base_path","","string")},Gc=function(e){return e.getParam("images_upload_credentials",!1,"boolean")},Yc=function(e){return e.getParam("images_upload_handler",null,"function")},Qc=function(e){return e.getParam("content_css_cors",!1,"boolean")},Jc=function(e){return e.getParam("referrer_policy","","string")},Zc=function(e){return e.getParam("language","en","string")},ef=function(e){return e.getParam("indent_use_margin",!1)},tf=function(e){var t=e.getParam("font_css",[]);return p(t)?t:W(t.split(","),ze)},nf=function(e){var t=e.getParam("object_resizing");return!1!==t&&!mt.iOS&&(m(t)?t:"table,img,figure.image,div,video,iframe")},rf=function(e){return e.getParam("event_root")},of=function(e){return e.getParam("theme")},uf=function(e){return e.getParam("validate")},af=function(e){return!1!==e.getParam("inline_boundaries")},cf=function(e){return e.getParam("content_css_cors")},ff=function(e){return e.getParam("plugins","","string")},lf=wn,sf=_n,df=function(e){var t=e.parentNode;t&&t.removeChild(e)},mf=function(e){var t=lo(e);return{count:e.length-t.length,text:t}},gf=function(e){for(var t;-1!==(t=e.data.lastIndexOf("\ufeff"));)e.deleteData(t,1)},pf=function(e,t){return yf(e),t},hf=function(e,t){var n=t.container(),r=function(e,t){var n=H(e,t);return-1===n?F.none():F.some(n)}(fe(n.childNodes),e).map((function(e){return e<t.offset()?pc(n,t.offset()-1):t})).getOr(t);return yf(e),r},vf=function(e,t){return sf(e)&&t.container()===e?function(e,t){var n=mf(e.data.substr(0,t.offset())),r=mf(e.data.substr(t.offset()));return(n.text+r.text).length>0?(gf(e),pc(e,t.offset()-n.count)):t}(e,t):pf(e,t)},bf=function(e,t){return pc.isTextPosition(t)?vf(e,t):function(e,t){return t.container()===e.parentNode?hf(e,t):pf(e,t)}(e,t)},yf=function(e){lf(e)&&ho(e)&&(vo(e)?e.removeAttribute("data-mce-caret"):df(e)),sf(e)&&(gf(e),0===e.data.length&&df(e))},Cf=ot().browser,wf=In,xf=Fn,Sf=Mn,Tf=function(e,t,n){var r,o,i=Ha(t.getBoundingClientRect(),n);if("BODY"===e.tagName){var u=e.ownerDocument.documentElement;r=e.scrollLeft||u.scrollLeft,o=e.scrollTop||u.scrollTop}else{var a=e.getBoundingClientRect();r=e.scrollLeft-a.left,o=e.scrollTop-a.top}i.left+=r,i.right+=r,i.top+=o,i.bottom+=o,i.width=1;var c=t.offsetWidth-t.clientWidth;return c>0&&(n&&(c*=-1),i.left+=c,i.right+=c),i},kf=function(e,t,n,r){var o,i,u=ma(),a=Hc(e),c=a.length>0?a:"p",f=function(){!function(e){for(var t=Ta(Ct.fromDom(e),"*[contentEditable=false],video,audio,embed,object"),n=0;n<t.length;n++){var r,o=t[n].dom,i=o.previousSibling;if(xo(i))1===(r=i.data).length?i.parentNode.removeChild(i):i.deleteData(r.length-1,1);if(i=o.nextSibling,wo(i))1===(r=i.data).length?i.parentNode.removeChild(i):i.deleteData(0,1)}}(t),i&&(yf(i),i=null),u.on((function(e){Gu(e.caret).remove(),u.clear()})),o&&(Xr.clearInterval(o),o=void 0)},l=function(){o=Xr.setInterval((function(){r()?Gu("div.mce-visual-caret",t).toggleClass("mce-visual-caret-hidden"):Gu("div.mce-visual-caret",t).addClass("mce-visual-caret-hidden")}),500)};return{show:function(e,r){var o;if(f(),Sf(r))return null;if(!n(r))return i=function(e,t){var n=e.ownerDocument.createTextNode("\ufeff"),r=e.parentNode;if(t){o=e.previousSibling;if(mo(o)){if(ho(o))return o;if(xo(o))return o.splitText(o.data.length-1)}r.insertBefore(n,e)}else{var o=e.nextSibling;if(mo(o)){if(ho(o))return o;if(wo(o))return o.splitText(1),o}e.nextSibling?r.insertBefore(n,e.nextSibling):r.appendChild(n)}return n}(r,e),o=r.ownerDocument.createRange(),Ef(i.nextSibling)?(o.setStart(i,0),o.setEnd(i,0)):(o.setStart(i,1),o.setEnd(i,1)),o;i=Co(c,r,e);var a=Tf(t,r,e);Gu(i).css("top",a.top);var s=Gu('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(Ae({},a)).appendTo(t)[0];return u.set({caret:s,element:r,before:e}),e&&Gu(s).addClass("mce-visual-caret-before"),l(),(o=r.ownerDocument.createRange()).setStart(i,0),o.setEnd(i,0),o},hide:f,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:function(){u.on((function(e){var n=Tf(t,e.element,e.before);Gu(e.caret).css(Ae({},n))}))},destroy:function(){return Xr.clearInterval(o)}}},Nf=function(){return Cf.isIE()||Cf.isEdge()||Cf.isFirefox()},Ef=function(e){return wf(e)||xf(e)},Rf=function(e){return Ef(e)||Nn(e)&&Nf()},_f=In,Df=Fn,Af=Sn("display","block table table-cell table-caption list-item"),Of=ho,Bf=go,Pf=wn,Lf=Bo,If=function(e){return e>0},Mf=function(e){return e<0},Ff=function(e,t){for(var n;n=e(t);)if(!Bf(n))return n;return null},jf=function(e,t,n,r,o){var i=new Qr(e,r),u=_f(e)||Bf(e);if(Mf(t)){if(u&&n(e=Ff(i.prev.bind(i),!0)))return e;for(;e=Ff(i.prev.bind(i),o);)if(n(e))return e}if(If(t)){if(u&&n(e=Ff(i.next.bind(i),!0)))return e;for(;e=Ff(i.next.bind(i),o);)if(n(e))return e}return null},Uf=function(e,t){for(;e&&e!==t;){if(Af(e))return e;e=e.parentNode}return null},zf=function(e,t,n){return Uf(e.container(),n)===Uf(t.container(),n)},Hf=function(e,t){if(!t)return null;var n=t.container(),r=t.offset();return Pf(n)?n.childNodes[r+e]:null},Vf=function(e,t){var n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},qf=function(e,t,n){return Uf(t,e)===Uf(n,e)},Wf=function(e,t,n){for(var r=e?"previousSibling":"nextSibling";n&&n!==t;){var o=n[r];if(Of(o)&&(o=o[r]),_f(o)||Df(o)){if(qf(t,o,n))return o;break}if(Lf(o))break;n=n.parentNode}return null},$f=_(Vf,!0),Kf=_(Vf,!1),Xf=function(e,t,n){var r,o=_(Wf,!0,t),i=_(Wf,!1,t),u=n.startContainer,a=n.startOffset;if(go(u)){Pf(u)||(u=u.parentNode);var c=u.getAttribute("data-mce-caret");if("before"===c&&(r=u.nextSibling,Rf(r)))return $f(r);if("after"===c&&(r=u.previousSibling,Rf(r)))return Kf(r)}if(!n.collapsed)return n;if(_n(u)){if(Of(u)){if(1===e){if(r=i(u))return $f(r);if(r=o(u))return Kf(r)}if(-1===e){if(r=o(u))return Kf(r);if(r=i(u))return $f(r)}return n}if(xo(u)&&a>=u.data.length-1)return 1===e&&(r=i(u))?$f(r):n;if(wo(u)&&a<=1)return-1===e&&(r=o(u))?Kf(r):n;if(a===u.data.length)return(r=i(u))?$f(r):n;if(0===a)return(r=o(u))?Kf(r):n}return n},Gf=function(e,t){return F.from(Hf(e?0:-1,t)).filter(_f)},Yf=function(e,t,n){var r=Xf(e,t,n);return-1===e?pc.fromRangeStart(r):pc.fromRangeEnd(r)},Qf=function(e){return F.from(e.getNode()).map(Ct.fromDom)},Jf=function(e,t){for(;t=e(t);)if(t.isVisible())return t;return t},Zf=function(e,t){var n=zf(e,t);return!(n||!Bn(e.getNode()))||n};!function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"}(hc||(hc={}));var el,tl=In,nl=_n,rl=wn,ol=Bn,il=Bo,ul=function(e){return Do(e)||function(e){return!!Po(e)&&!0!==Q(fe(e.getElementsByTagName("*")),(function(e,t){return e||ko(t)}),!1)}(e)},al=Lo,cl=function(e,t){return e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null},fl=function(e,t){if(If(e)){if(il(t.previousSibling)&&!nl(t.previousSibling))return pc.before(t);if(nl(t))return pc(t,0)}if(Mf(e)){if(il(t.nextSibling)&&!nl(t.nextSibling))return pc.after(t);if(nl(t))return pc(t,t.data.length)}return Mf(e)?ol(t)?pc.before(t):pc.after(t):pc.before(t)},ll=function(e,t,n){var r,o,i,u;if(!rl(n)||!t)return null;if(t.isEqual(pc.after(n))&&n.lastChild){if(u=pc.after(n.lastChild),Mf(e)&&il(n.lastChild)&&rl(n.lastChild))return ol(n.lastChild)?pc.before(n.lastChild):u}else u=t;var a=u.container(),c=u.offset();if(nl(a)){if(Mf(e)&&c>0)return pc(a,--c);if(If(e)&&c<a.length)return pc(a,++c);r=a}else{if(Mf(e)&&c>0&&(o=cl(a,c-1),il(o)))return!ul(o)&&(i=jf(o,e,al,o))?nl(i)?pc(i,i.data.length):pc.after(i):nl(o)?pc(o,o.data.length):pc.before(o);if(If(e)&&c<a.childNodes.length&&(o=cl(a,c),il(o)))return ol(o)?function(e,t){var n=t.nextSibling;return n&&il(n)?nl(n)?pc(n,0):pc.before(n):ll(hc.Forwards,pc.after(t),e)}(n,o):!ul(o)&&(i=jf(o,e,al,o))?nl(i)?pc(i,0):pc.before(i):nl(o)?pc(o,0):pc.after(o);r=o||u.getNode()}if((If(e)&&u.isAtEnd()||Mf(e)&&u.isAtStart())&&(r=jf(r,e,P,n,!0),al(r,n)))return fl(e,r);o=jf(r,e,al,n);var f=De(G(function(e,t){for(var n=[];e&&e!==t;)n.push(e),e=e.parentNode;return n}(a,n),tl));return!f||o&&f.contains(o)?o?fl(e,o):null:u=If(e)?pc.after(f):pc.before(f)},sl=function(e){return{next:function(t){return ll(hc.Forwards,t,e)},prev:function(t){return ll(hc.Backwards,t,e)}}},dl=function(e){return pc.isTextPosition(e)?0===e.offset():Bo(e.getNode())},ml=function(e){if(pc.isTextPosition(e)){var t=e.container();return e.offset()===t.data.length}return Bo(e.getNode(!0))},gl=function(e,t){return!pc.isTextPosition(e)&&!pc.isTextPosition(t)&&e.getNode()===t.getNode(!0)},pl=function(e,t,n){return e?!gl(t,n)&&(r=t,!(!pc.isTextPosition(r)&&Bn(r.getNode())))&&ml(t)&&dl(n):!gl(n,t)&&dl(t)&&ml(n);var r},hl=function(e,t,n){var r=sl(t);return F.from(e?r.next(n):r.prev(n))},vl=function(e,t,n){return hl(e,t,n).bind((function(r){return zf(n,r,t)&&pl(e,n,r)?hl(e,t,r):F.some(r)}))},bl=function(e,t,n,r){return vl(e,t,n).bind((function(n){return r(n)?bl(e,t,n,r):F.some(n)}))},yl=function(e,t){var n,r=e?t.firstChild:t.lastChild;return _n(r)?F.some(pc(r,e?0:r.data.length)):r?Bo(r)?F.some(e?pc.before(r):Bn(n=r)?pc.before(n):pc.after(n)):function(e,t,n){var r=e?pc.before(n):pc.after(n);return hl(e,t,r)}(e,t,r):F.none()},Cl=_(hl,!0),wl=_(hl,!1),xl=_(yl,!0),Sl=_(yl,!1),Tl=function(e){return wn(e)&&"_mce_caret"===e.id},kl=function(e,t){for(;t&&t!==e;){if("_mce_caret"===t.id)return t;t=t.parentNode}return null},Nl=function(e){return bt.isArray(e.start)},El=function(e,t){return wn(t)&&e.isBlock(t)&&!t.innerHTML&&!mt.ie&&(t.innerHTML='<br data-mce-bogus="1" />'),t},Rl=function(e,t){return Sl(e).fold(B,(function(e){return t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0}))},_l=function(e,t,n){return!(!function(e){return!1===e.hasChildNodes()}(t)||!kl(e,t))&&(function(e,t){var n=e.ownerDocument.createTextNode("\ufeff");e.appendChild(n),t.setStart(n,0),t.setEnd(n,0)}(t,n),!0)},Dl=function(e,t,n,r){var o,i,u,a,c=n[t?"start":"end"],f=e.getRoot();if(c){for(u=c[0],i=f,o=c.length-1;o>=1;o--){if(a=i.childNodes,_l(f,i,r))return!0;if(c[o]>a.length-1)return!!_l(f,i,r)||Rl(i,r);i=a[c[o]]}3===i.nodeType&&(u=Math.min(c[0],i.nodeValue.length)),1===i.nodeType&&(u=Math.min(c[0],i.childNodes.length)),t?r.setStart(i,u):r.setEnd(i,u)}return!0},Al=function(e){return _n(e)&&e.data.length>0},Ol=function(e,t,n){var r,o,i,u,a,c,f=e.get(n.id+"_"+t),l=n.keep;if(f){if(r=f.parentNode,"start"===t?(l?f.hasChildNodes()?(r=f.firstChild,o=1):Al(f.nextSibling)?(r=f.nextSibling,o=0):Al(f.previousSibling)?(r=f.previousSibling,o=f.previousSibling.data.length):(r=f.parentNode,o=e.nodeIndex(f)+1):o=e.nodeIndex(f),a=r,c=o):(l?f.hasChildNodes()?(r=f.firstChild,o=1):Al(f.previousSibling)?(r=f.previousSibling,o=f.previousSibling.data.length):(r=f.parentNode,o=e.nodeIndex(f)):o=e.nodeIndex(f),a=r,c=o),!l){for(u=f.previousSibling,i=f.nextSibling,bt.each(bt.grep(f.childNodes),(function(e){_n(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))}));f=e.get(n.id+"_"+t);)e.remove(f,!0);u&&i&&u.nodeType===i.nodeType&&_n(u)&&!mt.opera&&(o=u.nodeValue.length,u.appendData(i.nodeValue),e.remove(i),a=u,c=o)}return F.some(pc(a,c))}return F.none()},Bl=function(e,t){var n=e.dom;if(t){if(Nl(t))return function(e,t){var n=e.createRng();return Dl(e,!0,t,n)&&Dl(e,!1,t,n)?F.some(n):F.none()}(n,t);if(function(e){return m(e.start)}(t))return F.some(function(e,t){var n,r=e.createRng();return n=Ec(e.getRoot(),t.start),r.setStart(n.container(),n.offset()),n=Ec(e.getRoot(),t.end),r.setEnd(n.container(),n.offset()),r}(n,t));if(function(e){return we(e,"id")}(t))return function(e,t){var n=Ol(e,"start",t),r=Ol(e,"end",t);return Un(n,r.or(n),(function(t,n){var r=e.createRng();return r.setStart(El(e,t.container()),t.offset()),r.setEnd(El(e,n.container()),n.offset()),r}))}(n,t);if(function(e){return we(e,"name")}(t))return function(e,t){return F.from(e.select(t.name)[t.index]).map((function(t){var n=e.createRng();return n.selectNode(t),n}))}(n,t);if(function(e){return we(e,"rng")}(t))return F.some(t.rng)}return F.none()},Pl=function(e,t,n){return Mc(e,t,n)},Ll=function(e,t){Bl(e,t).each((function(t){e.setRng(t)}))},Il=function(e){return wn(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")},Ml=(el="",function(e){return el===e}),Fl=function(e){return""!==e&&-1!==" \f\n\r\t\v".indexOf(e)},jl=function(e){return!Fl(e)&&!Ml(e)},Ul=function(e){return!!e.nodeType},zl=function(e,t,n){var r=n.startOffset,o=n.startContainer;if((o!==n.endContainer||!function(e){return e&&/^(IMG)$/.test(e.nodeName)}(o.childNodes[r]))&&wn(o)){var i=o.childNodes,u=void 0;r<i.length?(o=i[r],u=new Qr(o,e.getParent(o,e.isBlock))):(o=i[i.length-1],(u=new Qr(o,e.getParent(o,e.isBlock))).next(!0));for(var a=u.current();a;a=u.next())if(_n(a)&&!Wl(a))return n.setStart(a,0),void t.setRng(n)}},Hl=function(e,t,n){if(e){var r=t?"nextSibling":"previousSibling";for(e=n?e:e[r];e;e=e[r])if(wn(e)||!Wl(e))return e}},Vl=function(e,t){return Ul(t)&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]},ql=function(e,t,n){return e.schema.isValidChild(t,n)},Wl=function(e,t){if(void 0===t&&(t=!1),C(e)&&_n(e)){var n=t?e.data.replace(/ /g,""):e.data;return Mo(n)}return!1},$l=function(e,t){return w(e)?e=e(t):C(t)&&(e=e.replace(/%(\w+)/g,(function(e,n){return t[n]||e}))),e},Kl=function(e,t){return t=t||"",e=""+((e=e||"").nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()},Xl=function(e,t,n){return"color"!==n&&"backgroundColor"!==n||(t=e.toHex(t)),"fontWeight"===n&&700===t&&(t="bold"),"fontFamily"===n&&(t=t.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+t},Gl=function(e,t,n){return Xl(e,e.getStyle(t,n),n)},Yl=function(e,t){var n;return e.getParent(t,(function(t){return(n=e.getStyle(t,"text-decoration"))&&"none"!==n})),n},Ql=function(e,t,n){return e.getParents(t,n,e.getRoot())},Jl=function(e,t,n){var r=["inline","block","selector","attributes","styles","classes"],o=function(e){return be(e,(function(e,t){return q(r,(function(e){return e===t}))}))};return q(e.formatter.get(t),(function(t){var r=o(t);return q(e.formatter.get(n),(function(e){var t=o(e);return function(e,t,n){return void 0===n&&(n=f),c(n).eq(e,t)}(r,t)}))}))},Zl=function(e){return xe(e,"block")},es=function(e){return xe(e,"selector")},ts=function(e){return xe(e,"inline")},ns=function(e){return es(e)&&!1!==e.expand&&!ts(e)},rs=Il,os=Ql,is=Wl,us=Vl,as=function(e,t){for(var n=t;n;){if(wn(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t},cs=function(e,t,n,r){for(var o=t.data,i=n;e?i>=0:i<o.length;e?i--:i++)if(r(o.charAt(i)))return e?i+1:i;return-1},fs=function(e,t,n){return cs(e,t,n,(function(e){return Ml(e)||Fl(e)}))},ls=function(e,t,n){return cs(e,t,n,jl)},ss=function(e,t,n,r,o,i){var u,a=e.getParent(n,e.isBlock)||t,c=function(t,n,r){var i=ja(e),c=o?i.backwards:i.forwards;return F.from(c(t,n,(function(e,t){return rs(e.parentNode)?-1:(u=e,r(o,e,t))}),a))};return c(n,r,fs).bind((function(e){return i?c(e.container,e.offset+(o?-1:0),ls):F.some(e)})).orThunk((function(){return u?F.some({container:u,offset:o?0:u.length}):F.none()}))},ds=function(e,t,n,r,o){_n(r)&&We(r.data)&&r[o]&&(r=r[o]);for(var i=os(e,r),u=0;u<i.length;u++)for(var a=0;a<t.length;a++){var c=t[a];if((!C(c.collapsed)||c.collapsed===n.collapsed)&&(es(c)&&e.is(i[u],c.selector)))return i[u]}return r},ms=function(e,t,n,r){var o=n,i=e.dom,u=i.getRoot(),a=t[0];if(Zl(a)&&(o=a.wrapper?null:i.getParent(n,a.block,u)),!o){var c=i.getParent(n,"LI,TD,TH");o=i.getParent(_n(n)?n.parentNode:n,(function(t){return t!==u&&us(e,t)}),c)}if(o&&Zl(a)&&a.wrapper&&(o=os(i,o,"ul,ol").reverse()[0]||o),!o)for(o=n;o[r]&&!i.isBlock(o[r])&&(o=o[r],!Kl(o,"br")););return o||n},gs=function(e,t,n,r){var o=n.parentNode;return!C(n[r])&&(!(o!==t&&!y(o)&&!e.isBlock(o))||gs(e,t,o,r))},ps=function(e,t,n,r,o){var i,u=n,a=o?"previousSibling":"nextSibling",c=e.getRoot();if(_n(n)&&!is(n)&&(o?r>0:r<n.data.length))return n;for(;;){if(!t[0].block_expand&&e.isBlock(u))return u;for(var f=u[a];f;f=f[a]){var l=_n(f)&&!gs(e,c,f,a);if(!rs(f)&&(!Bn(i=f)||!i.getAttribute("data-mce-bogus")||i.nextSibling)&&!is(f,l))return u}if(u===c||u.parentNode===c){n=u;break}u=u.parentNode}return n},hs=function(e){return rs(e.parentNode)||rs(e)},vs=function(e,t,n,r){void 0===r&&(r=!1);var o=t.startContainer,i=t.startOffset,u=t.endContainer,a=t.endOffset,c=e.dom,f=n[0];(wn(o)&&o.hasChildNodes()&&(o=Xa(o,i),_n(o)&&(i=0)),wn(u)&&u.hasChildNodes()&&(u=Xa(u,t.collapsed?a:a-1),_n(u)&&(a=u.nodeValue.length)),o=as(c,o),u=as(c,u),hs(o)&&(o=rs(o)?o:o.parentNode,o=t.collapsed?o.previousSibling||o:o.nextSibling||o,_n(o)&&(i=t.collapsed?o.length:0)),hs(u)&&(u=rs(u)?u:u.parentNode,u=t.collapsed?u.nextSibling||u:u.previousSibling||u,_n(u)&&(a=t.collapsed?0:u.length)),t.collapsed)&&(ss(c,e.getBody(),o,i,!0,r).each((function(e){var t=e.container,n=e.offset;o=t,i=n})),ss(c,e.getBody(),u,a,!1,r).each((function(e){var t=e.container,n=e.offset;u=t,a=n})));return(ts(f)||f.block_expand)&&(ts(f)&&_n(o)&&0!==i||(o=ps(c,n,o,i,!0)),ts(f)&&_n(u)&&a!==u.nodeValue.length||(u=ps(c,n,u,a,!1))),ns(f)&&(o=ds(c,n,t,o,"previousSibling"),u=ds(c,n,t,u,"nextSibling")),(Zl(f)||es(f))&&(o=ms(e,n,o,"previousSibling"),u=ms(e,n,u,"nextSibling"),Zl(f)&&(c.isBlock(o)||(o=ps(c,n,o,i,!0)),c.isBlock(u)||(u=ps(c,n,u,a,!1)))),wn(o)&&(i=c.nodeIndex(o),o=o.parentNode),wn(u)&&(a=c.nodeIndex(u)+1,u=u.parentNode),{startContainer:o,startOffset:i,endContainer:u,endOffset:a}},bs=function(e,t,n){var r=t.startOffset,o=Xa(t.startContainer,r),i=t.endOffset,u=Xa(t.endContainer,i-1),a=function(e){var t=e[0];_n(t)&&t===o&&r>=t.data.length&&e.splice(0,1);var n=e[e.length-1];return 0===i&&e.length>0&&n===u&&_n(n)&&e.splice(e.length-1,1),e},c=function(e,t,n){for(var r=[];e&&e!==n;e=e[t])r.push(e);return r},f=function(t,n){return e.getParent(t,(function(e){return e.parentNode===n}),n)},l=function(e,t,r){for(var o=r?"nextSibling":"previousSibling",i=e,u=i.parentNode;i&&i!==t;i=u){u=i.parentNode;var f=c(i===e?i:i[o],o);f.length&&(r||f.reverse(),n(a(f)))}};if(o===u)return n(a([o]));var s=e.findCommonAncestor(o,u);if(e.isChildOf(o,u))return l(o,s,!0);if(e.isChildOf(u,o))return l(u,s);var d=f(o,s)||o,m=f(u,s)||u;l(o,d,!0);var g=c(d===o?d:d.nextSibling,"nextSibling",m===u?m.nextSibling:m);g.length&&n(a(g)),l(u,m)},ys=function(e){var t=[];if(e)for(var n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},Cs=function(e){return G(function(e){return te(e,(function(e){var t=Ka(e);return t?[Ct.fromDom(t)]:[]}))}(e),ao)},ws=function(e,t){var n=Ta(t,"td[data-mce-selected],th[data-mce-selected]");return n.length>0?n:Cs(e)},xs=function(e){return ws(ys(e.selection.getSel()),Ct.fromDom(e.getBody()))},Ss=function(e,t){return zr(e,"table",t)},Ts=function(e){return qt(e).fold(N([e]),(function(t){return[e].concat(Ts(t))}))},ks=function(e){return Wt(e).fold(N([e]),(function(t){return"br"===Et(t)?Ft(t).map((function(t){return[e].concat(ks(t))})).getOr([]):[e].concat(ks(t))}))},Ns=function(e,t){return Un(function(e){var t=e.startContainer,n=e.startOffset;return _n(t)?0===n?F.some(Ct.fromDom(t)):F.none():F.from(t.childNodes[n]).map(Ct.fromDom)}(t),function(e){var t=e.endContainer,n=e.endOffset;return _n(t)?n===t.data.length?F.some(Ct.fromDom(t)):F.none():F.from(t.childNodes[n-1]).map(Ct.fromDom)}(t),(function(t,n){var r=Z(Ts(e),_(Tt,t)),o=Z(ks(e),_(Tt,n));return r.isSome()&&o.isSome()})).getOr(!1)},Es=function(e,t,n,r){var o=n,i=new Qr(n,o),u=be(e.schema.getMoveCaretBeforeOnEnterElements(),(function(e,t){return!V(["td","th","table"],t.toLowerCase())}));do{if(_n(n)&&0!==bt.trim(n.nodeValue).length)return void(r?t.setStart(n,0):t.setEnd(n,n.nodeValue.length));if(u[n.nodeName])return void(r?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n))}while(n=r?i.next():i.prev());"BODY"===o.nodeName&&(r?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},Rs=function(e){var t=e.selection.getSel();return t&&t.rangeCount>0},_s=function(e,t){var n=xs(e);n.length>0?$(n,(function(n){var r=n.dom,o=e.dom.createRng();o.setStartBefore(r),o.setEndAfter(r),t(o,!0)})):t(e.selection.getRng(),!1)},Ds=function(e,t,n){var r=Ic(e,t);n(r),e.moveToBookmark(r)},As=function(e,t){var n=function(t){return e(t)?F.from(t.dom.nodeValue):F.none()};return{get:function(r){if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r}}}(At,"text"),Os=function(e){return As.get(e)},Bs=function(e,t,n,r){return Mt(t).fold((function(){return"skipping"}),(function(o){return"br"===r||function(e){return At(e)&&"\ufeff"===Os(e)}(t)?"valid":function(e){return Dt(e)&&xa(e,ka())}(t)?"existing":Tl(t.dom)?"caret":ql(e,n,r)&&ql(e,Et(o),n)?"valid":"invalid-child"}))},Ps=function(e,t,n,r){var o=t.uid,i=void 0===o?Ba("mce-annotation"):o,u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["uid"]),a=Ct.fromTag("span",e);Ca(a,ka()),Vn(a,""+Ea(),i),Vn(a,""+Na(),n);var c=r(i,u),f=c.attributes,l=void 0===f?{}:f,s=c.classes,d=void 0===s?[]:s;return qn(a,l),function(e,t){$(t,(function(t){Ca(e,t)}))}(a,d),a},Ls=function(e,t,n,r,o){var i=[],u=Ps(e.getDoc(),o,n,r),a=ma(),c=function(){a.clear()},f=function(e){$(e,l)},l=function(t){switch(Bs(e,t,"span",Et(t))){case"invalid-child":c();var n=Ht(t);f(n),c();break;case"valid":!function(e,t){en(e,t),rn(t,e)}(t,a.get().getOrThunk((function(){var e=Ia(u);return i.push(e),a.set(e),e})))}};return bs(e.dom,t,(function(e){c(),function(e){var t=W(e,Ct.fromDom);f(t)}(e)})),i},Is=function(e,t,n,r){e.undoManager.transact((function(){var o=e.selection,i=o.getRng(),u=xs(e).length>0;if(i.collapsed&&!u&&function(e,t){var n=vs(e,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)}(e,i),o.getRng().collapsed&&!u){var a=Ps(e.getDoc(),r,t,n.decorate);Pa(a,""),o.getRng().insertNode(a.dom),o.select(a.dom)}else Ds(o,!1,(function(){_s(e,(function(o){Ls(e,o,t,n.decorate,r)}))}))}))},Ms=function(e){var t,n=(t={},{register:function(e,n){t[e]={name:e,settings:n}},lookup:function(e){return Ce(t,e).map((function(e){return e.settings}))}});Aa(e,n);var r=Da(e);return{register:function(e,t){n.register(e,t)},annotate:function(t,r){n.lookup(t).each((function(n){Is(e,t,n,r)}))},annotationChanged:function(e,t){r.addListener(e,t)},remove:function(t){Ra(e,F.some(t)).each((function(e){var t=e.elements;$(t,cn)}))},getAll:function(t){var n=function(e,t){var n=Ct.fromDom(e.getBody()),r=Ta(n,"["+Na()+'="'+t+'"]'),o={};return $(r,(function(e){var t=Wn(e,Ea()),n=Ce(o,t).getOr([]);o[t]=n.concat([e])})),o}(e,t);return ge(n,(function(e){return W(e,(function(e){return e.dom}))}))}}},Fs=function(e){return{getBookmark:_(Pl,e),moveToBookmark:_(Ll,e)}};Fs.isBookmarkNode=Il;var js=function(e,t){for(;t&&t!==e;){if(Ln(t)||In(t))return t;t=t.parentNode}return null},Us=function(e,t,n){if(n.collapsed)return!1;if(mt.browser.isIE()&&n.startOffset===n.endOffset-1&&n.startContainer===n.endContainer){var r=n.startContainer.childNodes[n.startOffset];if(wn(r))return q(r.getClientRects(),(function(n){return $a(n,e,t)}))}return q(n.getClientRects(),(function(n){return $a(n,e,t)}))},zs=function(e,t,n){return e.fire(t,n)},Hs=function(e,t,n,r){return e.fire("FormatApply",{format:t,node:n,vars:r})},Vs=function(e,t,n,r){return e.fire("FormatRemove",{format:t,node:n,vars:r})},qs={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||qs.metaKeyPressed(e)},metaKeyPressed:function(e){return mt.mac?e.metaKey:e.ctrlKey&&!e.altKey}},Ws=In,$s=function(e,t){var n,r,o,i,u,a,c,f,l,s,d,m,g,p,h,v=t.dom,b=bt.each,y=t.getDoc(),w=document,x=Math.abs,S=Math.round,T=t.getBody(),k={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},N=function(e){return e&&("IMG"===e.nodeName||t.dom.is(e,"figure.image"))},E=function(e){return Fn(e)||v.hasClass(e,"mce-preview-object")},R=function(e){var n=e.target;(function(e,t){if("longpress"===e.type||0===e.type.indexOf("touch")){var n=e.touches[0];return N(e.target)&&!Us(n.clientX,n.clientY,t)}return N(e.target)&&!Us(e.clientX,e.clientY,t)})(e,t.selection.getRng())&&!e.isDefaultPrevented()&&t.selection.select(n)},_=function(e){return v.is(e,"figure.image")?[e.querySelector("img")]:v.hasClass(e,"mce-preview-object")&&C(e.firstElementChild)?[e,e.firstElementChild]:[e]},D=function(e){var n=nf(t);return!!n&&("false"!==e.getAttribute("data-mce-resize")&&(e!==t.getBody()&&(v.hasClass(e,"mce-preview-object")?xt(Ct.fromDom(e.firstElementChild),n):xt(Ct.fromDom(e),n))))},A=function(e,n,r){if(C(r)){var o=_(e);$(o,(function(e){e.style[n]||!t.schema.isValid(e.nodeName.toLowerCase(),n)?v.setStyle(e,n,r):v.setAttrib(e,n,""+r)}))}},O=function(e,t,n){A(e,"width",t),A(e,"height",n)},B=function(e){var u,b,y,C;u=e.screenX-a,b=e.screenY-c,m=u*i[2]+f,g=b*i[3]+l,m=m<5?5:m,g=g<5?5:g,((N(n)||E(n))&&!1!==function(e){return e.getParam("resize_img_proportional",!0,"boolean")}(t)?!qs.modifierPressed(e):qs.modifierPressed(e))&&(x(u)>x(b)?(g=S(m*s),m=S(g/s)):(m=S(g/s),g=S(m*s))),O(r,m,g),y=(y=i.startPos.x+u)>0?y:0,C=(C=i.startPos.y+b)>0?C:0,v.setStyles(o,{left:y,top:C,display:"block"}),o.innerHTML=m+" &times; "+g,i[2]<0&&r.clientWidth<=m&&v.setStyle(r,"left",void 0+(f-m)),i[3]<0&&r.clientHeight<=g&&v.setStyle(r,"top",void 0+(l-g)),(u=T.scrollWidth-p)+(b=T.scrollHeight-h)!==0&&v.setStyles(o,{left:y-u,top:C-b}),d||(!function(e,t,n,r,o){e.fire("ObjectResizeStart",{target:t,width:n,height:r,origin:o})}(t,n,f,l,"corner-"+i.name),d=!0)},P=function(){var e=d;d=!1,e&&(A(n,"width",m),A(n,"height",g)),v.unbind(y,"mousemove",B),v.unbind(y,"mouseup",P),w!==y&&(v.unbind(w,"mousemove",B),v.unbind(w,"mouseup",P)),v.remove(r),v.remove(o),v.remove(u),L(n),e&&(!function(e,t,n,r,o){e.fire("ObjectResized",{target:t,width:n,height:r,origin:o})}(t,n,m,g,"corner-"+i.name),v.setAttrib(n,"style",v.getAttrib(n,"style"))),t.nodeChanged()},L=function(e){j();var d=v.getPos(e,T),C=d.x,x=d.y,S=e.getBoundingClientRect(),N=S.width||S.right-S.left,R=S.height||S.bottom-S.top;n!==e&&(I(),n=e,m=g=0);var A=t.fire("ObjectSelected",{target:e}),L=v.getAttrib(n,"data-mce-selected","1");D(e)&&!A.isDefaultPrevented()?b(k,(function(e,t){var d,m=function(d){var m,g=_(n)[0];a=d.screenX,c=d.screenY,f=g.clientWidth,l=g.clientHeight,s=l/f,(i=e).name=t,i.startPos={x:N*e[0]+C,y:R*e[1]+x},p=T.scrollWidth,h=T.scrollHeight,u=v.add(T,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),v.setStyles(u,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),r=E(m=n)?v.create("img",{src:mt.transparentSrc}):m.cloneNode(!0),v.addClass(r,"mce-clonedresizable"),v.setAttrib(r,"data-mce-bogus","all"),r.contentEditable="false",v.setStyles(r,{left:C,top:x,margin:0}),O(r,N,R),r.removeAttribute("data-mce-selected"),T.appendChild(r),v.bind(y,"mousemove",B),v.bind(y,"mouseup",P),w!==y&&(v.bind(w,"mousemove",B),v.bind(w,"mouseup",P)),o=v.add(T,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},f+" &times; "+l)};(d=v.get("mceResizeHandle"+t))&&v.remove(d),d=v.add(T,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+t+"-resize; margin:0; padding:0"}),11===mt.ie&&(d.contentEditable=!1),v.bind(d,"mousedown",(function(e){e.stopImmediatePropagation(),e.preventDefault(),m(e)})),e.elm=d,v.setStyles(d,{left:N*e[0]+C-d.offsetWidth/2,top:R*e[1]+x-d.offsetHeight/2})})):I(),v.getAttrib(n,"data-mce-selected")||n.setAttribute("data-mce-selected",L)},I=function(){j(),n&&n.removeAttribute("data-mce-selected"),me(k,(function(e,t){var n=v.get("mceResizeHandle"+t);n&&(v.unbind(n),v.remove(n))}))},M=function(n){var r,o=function(e,t){if(e)do{if(e===t)return!0}while(e=e.parentNode)};d||t.removed||(b(v.select("img[data-mce-selected],hr[data-mce-selected]"),(function(e){e.removeAttribute("data-mce-selected")})),r="mousedown"===n.type?n.target:e.getNode(),o(r=v.$(r).closest("table,img,figure.image,hr,video,span.mce-preview-object")[0],T)&&(U(),o(e.getStart(!0),r)&&o(e.getEnd(!0),r))?L(r):I())},F=function(e){return Ws(js(t.getBody(),e))},j=function(){me(k,(function(e){e.elm&&(v.unbind(e.elm),delete e.elm)}))},U=function(){try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(e){}};t.on("init",(function(){if(U(),mt.browser.isIE()||mt.browser.isEdge()){t.on("mousedown click",(function(e){var n=e.target,r=n.nodeName;d||!/^(TABLE|IMG|HR)$/.test(r)||F(n)||(2!==e.button&&t.selection.select(n,"TABLE"===r),"mousedown"===e.type&&t.nodeChanged())}));var e=function(e){var n=function(e){Xr.setEditorTimeout(t,(function(){return t.selection.select(e)}))};if(F(e.target)||Fn(e.target))return e.preventDefault(),void n(e.target);/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&n(e.target))};v.bind(T,"mscontrolselect",e),t.on("remove",(function(){return v.unbind(T,"mscontrolselect",e)}))}var r=Xr.throttle((function(e){t.composing||M(e)}));t.on("nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged",r),t.on("keyup compositionend",(function(e){n&&"TABLE"===n.nodeName&&r(e)})),t.on("hide blur",I),t.on("contextmenu longpress",R,!0)})),t.on("remove",j);return{isResizable:D,showResizeRect:L,hideResizeRect:I,updateResizeRect:M,destroy:function(){n=r=u=null}}},Ks=function(e){return Ln(e)||In(e)},Xs=function(e,t,n){var r,o,i=n;if(i.caretPositionFromPoint)(o=i.caretPositionFromPoint(e,t))&&((r=n.createRange()).setStart(o.offsetNode,o.offset),r.collapse(!0));else if(i.caretRangeFromPoint)r=i.caretRangeFromPoint(e,t);else if(i.body.createTextRange){r=i.body.createTextRange();try{r.moveToPoint(e,t),r.collapse(!0)}catch(o){r=function(e,t,n){var r,o=n.elementFromPoint(e,t),i=n.body.createTextRange();if(o&&"HTML"!==o.tagName||(o=n.body),i.moveToElementText(o),(r=(r=bt.toArray(i.getClientRects())).sort((function(e,n){return(e=Math.abs(Math.max(e.top-t,e.bottom-t)))-(n=Math.abs(Math.max(n.top-t,n.bottom-t)))}))).length>0){t=(r[0].bottom+r[0].top)/2;try{return i.moveToPoint(e,t),i.collapse(!0),i}catch(e){}}return null}(e,t,n)}return function(e,t){var n=e&&e.parentElement?e.parentElement():null;return In(function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(n,t,Ks))?null:e}(r,n.body)}return r},Gs=function(e,t){return e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},Ys=function(e,t,n){return null!==function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(e,t,n)},Qs=function(e,t,n){return Ys(e,t,(function(e){return e.nodeName===n}))},Js=function(e){return e&&"TABLE"===e.nodeName},Zs=function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)},ed=function(e,t){return ho(e)&&!1===Ys(e,t,Tl)},td=function(e,t,n){for(var r=new Qr(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());t=r[n?"prev":"next"]();)if(Bn(t))return!0},nd=function(e,t,n,r,o){var i,u,a=e.getRoot(),c=e.schema.getNonEmptyElements(),f=e.getParent(o.parentNode,e.isBlock)||a;if(r&&Bn(o)&&t&&e.isEmpty(f))return F.some(pc(o.parentNode,e.nodeIndex(o)));for(var l=new Qr(o,f);u=l[r?"prev":"next"]();){if("false"===e.getContentEditableParent(u)||ed(u,a))return F.none();if(_n(u)&&u.nodeValue.length>0)return!1===Qs(u,a,"A")?F.some(pc(u,r?u.nodeValue.length:0)):F.none();if(e.isBlock(u)||c[u.nodeName.toLowerCase()])return F.none();i=u}return n&&i?F.some(pc(i,0)):F.none()},rd=function(e,t,n,r){var o,i,u,a,c=e.getRoot(),f=!1;o=r[(n?"start":"end")+"Container"],i=r[(n?"start":"end")+"Offset"];var l=wn(o)&&i===o.childNodes.length,s=e.schema.getNonEmptyElements();if(a=n,ho(o))return F.none();if(wn(o)&&i>o.childNodes.length-1&&(a=!1),An(o)&&(o=c,i=0),o===c){if(a&&(u=o.childNodes[i>0?i-1:0])){if(ho(u))return F.none();if(s[u.nodeName]||Js(u))return F.none()}if(o.hasChildNodes()){if(i=Math.min(!a&&i>0?i-1:i,o.childNodes.length-1),o=o.childNodes[i],i=_n(o)&&l?o.data.length:0,!t&&o===c.lastChild&&Js(o))return F.none();if(function(e,t){for(;t&&t!==e;){if(In(t))return!0;t=t.parentNode}return!1}(c,o)||ho(o))return F.none();if(o.hasChildNodes()&&!1===Js(o)){u=o;var d=new Qr(o,c);do{if(In(u)||ho(u)){f=!1;break}if(_n(u)&&u.nodeValue.length>0){i=a?0:u.nodeValue.length,o=u,f=!0;break}if(s[u.nodeName.toLowerCase()]&&!Zs(u)){i=e.nodeIndex(u),o=u.parentNode,a||i++,f=!0;break}}while(u=a?d.next():d.prev())}}}return t&&(_n(o)&&0===i&&nd(e,l,t,!0,o).each((function(e){o=e.container(),i=e.offset(),f=!0})),wn(o)&&((u=o.childNodes[i])||(u=o.childNodes[i-1]),!u||!Bn(u)||function(e,t){return e.previousSibling&&e.previousSibling.nodeName===t}(u,"A")||td(e,u,!1)||td(e,u,!0)||nd(e,l,t,!0,u).each((function(e){o=e.container(),i=e.offset(),f=!0})))),a&&!t&&_n(o)&&i===o.nodeValue.length&&nd(e,l,t,!1,o).each((function(e){o=e.container(),i=e.offset(),f=!0})),f?F.some(pc(o,i)):F.none()},od=function(e,t){var n=t.collapsed,r=t.cloneRange(),o=pc.fromRangeStart(t);return rd(e,n,!0,r).each((function(e){n&&pc.isAbove(o,e)||r.setStart(e.container(),e.offset())})),n||rd(e,n,!1,r).each((function(e){r.setEnd(e.container(),e.offset())})),n&&r.collapse(!0),Gs(t,r)?F.none():F.some(r)},id=function(e,t){return e.splitText(t)},ud=function(e){var t=e.startContainer,n=e.startOffset,r=e.endContainer,o=e.endOffset;return t===r&&_n(t)?n>0&&n<t.nodeValue.length&&(t=(r=id(t,n)).previousSibling,o>n?(t=r=id(r,o-=n).previousSibling,o=r.nodeValue.length,n=0):o=0):(_n(t)&&n>0&&n<t.nodeValue.length&&(t=id(t,n),n=0),_n(r)&&o>0&&o<r.nodeValue.length&&(o=(r=id(r,o).previousSibling).nodeValue.length)),{startContainer:t,startOffset:n,endContainer:r,endOffset:o}},ad=function(e){return{walk:function(t,n){return bs(e,t,n)},split:ud,normalize:function(t){return od(e,t).fold(B,(function(e){return t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0}))}}};ad.compareRanges=Gs,ad.getCaretRangeFromPoint=Xs,ad.getSelectedNode=Ka,ad.getNode=Xa;var cd,fd=function(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=Gn(n,e);return parseFloat(o)||0}return r},r=function(e,t){return Q(t,(function(t,n){var r=Gn(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,n){if(!x(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;zn(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return t>o?t-o:0}}}("height",(function(e){var t=e.dom;return fn(e)?t.getBoundingClientRect().height:t.offsetHeight})),ld=function(e,t){return e.view(t).fold(N([]),(function(t){var n=e.owner(t),r=ld(e,n);return[t].concat(r)}))},sd=Object.freeze({__proto__:null,view:function(e){var t;return(e.dom===document?F.none():F.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(Ct.fromDom)},owner:function(e){return Lt(e)}}),dd=function(e){var t=Ct.fromDom(document),n=gn(t),r=function(e,t){var n=t.owner(e);return ld(t,n)}(e,sd),o=mn(e),i=Y(r,(function(e,t){var n=mn(t);return{left:e.left+n.left,top:e.top+n.top}}),{left:0,top:0});return sn(i.left+o.left+n.left,i.top+o.top+n.top)},md=function(e){return"textarea"===Et(e)},gd=function(e,t){var n=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return sn(n.offsetLeft,n.offsetTop);var i=dn(null==r?void 0:r.pageYOffset,o.scrollTop),u=dn(null==r?void 0:r.pageXOffset,o.scrollLeft),a=dn(o.clientTop,n.clientTop),c=dn(o.clientLeft,n.clientLeft);return mn(e).translate(u-c,i-a)}(e),r=function(e){return fd.get(e)}(e);return{element:e,bottom:n.top+r,height:r,pos:n,cleanup:t}},pd=function(e,t){var n=function(e,t){var n=Ht(e);if(0===n.length||md(e))return{element:e,offset:t};if(t<n.length&&!md(n[t]))return{element:n[t],offset:0};var r=n[n.length-1];return md(r)?{element:e,offset:t}:"img"===Et(r)?{element:r,offset:1}:At(r)?{element:r,offset:Os(r).length}:{element:r,offset:Ht(r).length}}(e,t),r=Ct.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">\ufeff</span>');return en(n.element,r),gd(r,(function(){return an(r)}))},hd=function(e,t,n,r){Cd(e,(function(o,i){return bd(e,t,n,r)}),n)},vd=function(e,t,n,r,o){var i={elm:r.element.dom,alignToTop:o};(function(e,t){return e.fire("ScrollIntoView",t).isDefaultPrevented()})(e,i)||(n(t,gn(t).top,r,o),function(e,t){e.fire("AfterScrollIntoView",t)}(e,i))},bd=function(e,t,n,r){var o=Ct.fromDom(e.getBody()),i=Ct.fromDom(e.getDoc());o.dom.offsetWidth;var u=pd(Ct.fromDom(n.startContainer),n.startOffset);vd(e,i,t,u,r),u.cleanup()},yd=function(e,t,n,r){var o=Ct.fromDom(e.getDoc());vd(e,o,n,function(e){return gd(Ct.fromDom(e),S)}(t),r)},Cd=function(e,t,n){var r=n.startContainer,o=n.startOffset,i=n.endContainer,u=n.endOffset;t(Ct.fromDom(r),Ct.fromDom(i));var a=e.dom.createRng();a.setStart(r,o),a.setEnd(i,u),e.selection.setRng(n)},wd=function(e,t,n,r){var o=e.pos;if(n)pn(o.left,o.top,r);else{var i=o.top-t+e.height;pn(o.left,i,r)}},xd=function(e,t,n,r,o){var i=n+t,u=r.pos.top,a=r.bottom,c=a-u>=n;if(u<t)wd(r,n,!1!==o,e);else if(u>i){wd(r,n,c?!1!==o:!0===o,e)}else a>i&&!c&&wd(r,n,!0===o,e)},Sd=function(e,t,n,r){var o=e.dom.defaultView.innerHeight;xd(e,t,o,n,r)},Td=function(e,t,n,r){var o=e.dom.defaultView.innerHeight;xd(e,t,o,n,r);var i=dd(n.element),u=bn(window);i.top<u.y?hn(n.element,!1!==r):i.top>u.bottom&&hn(n.element,!0===r)},kd=function(e,t,n){return hd(e,Sd,t,n)},Nd=function(e,t,n){return yd(e,t,Sd,n)},Ed=function(e,t,n){return hd(e,Td,t,n)},Rd=function(e,t,n){return yd(e,t,Td,n)},_d=function(e,t,n){(e.inline?kd:Ed)(e,t,n)},Dd=function(e){var t=Yt(e).dom;return e.dom===t.activeElement},Ad=function(e){return void 0===e&&(e=Ct.fromDom(document)),F.from(e.dom.activeElement).map(Ct.fromDom)},Od=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},Bd=pr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Pd=(Bd.before,Bd.on,Bd.after,function(e){return e.fold(E,E,E)}),Ld=pr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Id={domRange:Ld.domRange,relative:Ld.relative,exact:Ld.exact,exactFromRange:function(e){return Ld.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t=function(e){return e.match({domRange:function(e){return Ct.fromDom(e.startContainer)},relative:function(e,t){return Pd(e)},exact:function(e,t,n,r){return e}})}(e);return It(t)},range:Od},Md=ot().browser,Fd=function(e,t){var n=At(t)?Os(t).length:Ht(t).length+1;return e>n?n:e<0?0:e},jd=function(e){return Id.range(e.start,Fd(e.soffset,e.start),e.finish,Fd(e.foffset,e.finish))},Ud=function(e,t){return!Cn(t.dom)&&(Nt(e,t)||Tt(e,t))},zd=function(e){return function(t){return Ud(e,t.start)&&Ud(e,t.finish)}},Hd=function(e){return!0===e.inline||Md.isIE()},Vd=function(e){return Id.range(Ct.fromDom(e.startContainer),e.startOffset,Ct.fromDom(e.endContainer),e.endOffset)},qd=function(e){return function(e){var t=e.getSelection();return(t&&0!==t.rangeCount?F.from(t.getRangeAt(0)):F.none()).map(Vd)}(It(e).dom).filter(zd(e))},Wd=function(e){var t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),F.some(t)}catch(e){return F.none()}},$d=function(e){var t=Hd(e)?qd(Ct.fromDom(e.getBody())):F.none();e.bookmark=t.isSome()?t:e.bookmark},Kd=function(e){return(e.bookmark?e.bookmark:F.none()).bind((function(t){return function(e,t){return F.from(t).filter(zd(e)).map(jd)}(Ct.fromDom(e.getBody()),t)})).bind(Wd)},Xd={isEditorUIElement:function(e){var t=e.className.toString();return-1!==t.indexOf("tox-")||-1!==t.indexOf("mce-")}},Gd=function(e,t){ot().browser.isIE()?function(e){e.on("focusout",(function(){$d(e)}))}(e):function(e,t){e.on("mouseup touchend",(function(e){t.throttle()}))}(e,t),e.on("keyup NodeChange",(function(t){(function(e){return"nodechange"===e.type&&e.selectionChange})(t)||$d(e)}))},Yd=function(e){var t=ga((function(){$d(e)}),0);e.on("init",(function(){e.inline&&function(e,t){var n=function(){t.throttle()};na.DOM.bind(document,"mouseup",n),e.on("remove",(function(){na.DOM.unbind(document,"mouseup",n)}))}(e,t),Gd(e,t)})),e.on("remove",(function(){t.cancel()}))},Qd=na.DOM,Jd=function(e,t){var n=function(e){return e.getParam("custom_ui_selector","","string")}(e);return null!==Qd.getParent(t,(function(t){return function(e){return Xd.isEditorUIElement(e)}(t)||!!n&&e.dom.is(t,n)}))},Zd=function(e,t){var n=t.editor;Yd(n),n.on("focusin",(function(){var t=e.focusedEditor;t!==n&&(t&&t.fire("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.fire("focus",{blurredEditor:t}),n.focus(!0))})),n.on("focusout",(function(){Xr.setEditorTimeout(n,(function(){var t=e.focusedEditor;Jd(n,function(e){try{var t=Yt(Ct.fromDom(e.getElement()));return Ad(t).fold((function(){return document.body}),(function(e){return e.dom}))}catch(e){return document.body}}(n))||t!==n||(n.fire("blur",{focusedEditor:null}),e.focusedEditor=null)}))})),cd||(cd=function(t){var n=e.activeEditor;n&&function(e){if(Gt()&&C(e.target)){var t=Ct.fromDom(e.target);if(Dt(t)&&Zt(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return ae(n)}}return F.from(e.target)}(t).each((function(t){t.ownerDocument===document&&(t===document.body||Jd(n,t)||e.focusedEditor!==n||(n.fire("blur",{focusedEditor:null}),e.focusedEditor=null))}))},Qd.bind(document,"focusin",cd))},em=function(e,t){e.focusedEditor===t.editor&&(e.focusedEditor=null),e.activeEditor||(Qd.unbind(document,"focusin",cd),cd=null)},tm=function(e,t){return function(e){return e.collapsed?F.from(Xa(e.startContainer,e.startOffset)).map(Ct.fromDom):F.none()}(t).bind((function(t){return uo(t)?F.some(t):!1===Nt(e,t)?F.some(e):F.none()}))},nm=function(e,t){tm(Ct.fromDom(e.getBody()),t).bind((function(e){return xl(e.dom)})).fold((function(){e.selection.normalize()}),(function(t){return e.selection.setRng(t.toRange())}))},rm=function(e){if(e.setActive)try{e.setActive()}catch(t){e.focus()}else e.focus()},om=function(e){return Dd(e)||(t=e,Ad(Yt(t)).filter((function(e){return t.dom.contains(e.dom)}))).isSome();var t},im=function(e){return e.inline?function(e){var t=e.getBody();return t&&om(Ct.fromDom(t))}(e):function(e){return e.iframeElement&&Dd(Ct.fromDom(e.iframeElement))}(e)},um=function(e){return im(e)||function(e){var t=Yt(Ct.fromDom(e.getElement()));return Ad(t).filter((function(t){return n=t.dom,!(void 0!==(r=n.classList)&&(r.contains("tox-edit-area")||r.contains("tox-edit-area__iframe")||r.contains("mce-content-body")))&&Jd(e,t.dom);var n,r})).isSome()}(e)},am=function(e){return e.editorManager.setActive(e)},cm=function(e,t){e.removed||(t?am(e):function(e){var t=e.selection,n=e.getBody(),r=t.getRng();e.quirks.refreshContentEditable(),void 0!==e.bookmark&&!1===im(e)&&Kd(e).each((function(t){e.selection.setRng(t),r=t}));var o=function(e,t){return e.dom.getParent(t,(function(t){return"true"===e.dom.getContentEditable(t)}))}(e,t.getNode());if(e.$.contains(n,o))return rm(o),nm(e,r),void am(e);e.inline||(mt.opera||rm(n),e.getWin().focus()),(mt.gecko||e.inline)&&(rm(n),nm(e,r)),am(e)}(e))},fm=function(e,t,n,r,o){var i=n?t.startContainer:t.endContainer,u=n?t.startOffset:t.endOffset;return F.from(i).map(Ct.fromDom).map((function(e){return r&&t.collapsed?e:Vt(e,o(e,u)).getOr(e)})).bind((function(e){return Dt(e)?F.some(e):Mt(e).filter(Dt)})).map((function(e){return e.dom})).getOr(e)},lm=function(e,t,n){return fm(e,t,!0,n,(function(e,t){return Math.min($t(e),t)}))},sm=function(e,t,n){return fm(e,t,!1,n,(function(e,t){return t>0?t-1:t}))},dm=function(e,t){for(var n=e;e&&_n(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n},mm=function(e,t){return W(t,(function(t){var n=e.fire("GetSelectionRange",{range:t});return n.range!==t?n.range:t}))},gm={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},pm=function(e,t,n){var r=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[r])return e[r];if(e!==t){var i=e[o];if(i)return i;for(var u=e.parent;u&&u!==t;u=u.parent)if(i=u[o])return i}},hm=function(e){if(!Mo(e.value))return!1;var t=e.parent;return!t||"span"===t.name&&!t.attr("style")||!/^[ ]+$/.test(e.value)},vm=function(e){var t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t},bm=function(){function e(e,t){this.name=e,this.type=t,1===t&&(this.attributes=[],this.attributes.map={})}return e.create=function(t,n){var r=new e(t,gm[t]||1);return n&&me(n,(function(e,t){r.attr(t,e)})),r},e.prototype.replace=function(e){return e.parent&&e.remove(),this.insert(e,this),this.remove(),this},e.prototype.attr=function(e,t){var n,r=this;if("string"!=typeof e)return null!=e&&me(e,(function(e,t){r.attr(t,e)})),r;if(n=r.attributes){if(void 0!==t){if(null===t){if(e in n.map){delete n.map[e];for(var o=n.length;o--;)if(n[o].name===e)return n.splice(o,1),r}return r}if(e in n.map){for(o=n.length;o--;)if(n[o].name===e){n[o].value=t;break}}else n.push({name:e,value:t});return n.map[e]=t,r}return n.map[e]}},e.prototype.clone=function(){var t,n=new e(this.name,this.type);if(t=this.attributes){var r=[];r.map={};for(var o=0,i=t.length;o<i;o++){var u=t[o];"id"!==u.name&&(r[r.length]={name:u.name,value:u.value},r.map[u.name]=u.value)}n.attributes=r}return n.value=this.value,n.shortEnded=this.shortEnded,n},e.prototype.wrap=function(e){return this.parent.insert(e,this),e.append(this),this},e.prototype.unwrap=function(){for(var e=this.firstChild;e;){var t=e.next;this.insert(e,this,!0),e=t}this.remove()},e.prototype.remove=function(){var e=this.parent,t=this.next,n=this.prev;return e&&(e.firstChild===this?(e.firstChild=t,t&&(t.prev=null)):n.next=t,e.lastChild===this?(e.lastChild=n,n&&(n.next=null)):t.prev=n,this.parent=this.next=this.prev=null),this},e.prototype.append=function(e){e.parent&&e.remove();var t=this.lastChild;return t?(t.next=e,e.prev=t,this.lastChild=e):this.lastChild=this.firstChild=e,e.parent=this,e},e.prototype.insert=function(e,t,n){e.parent&&e.remove();var r=t.parent||this;return n?(t===r.firstChild?r.firstChild=e:t.prev.next=e,e.prev=t.prev,e.next=t,t.prev=e):(t===r.lastChild?r.lastChild=e:t.next.prev=e,e.next=t.next,e.prev=t,t.next=e),e.parent=r,e},e.prototype.getAll=function(e){for(var t=[],n=this.firstChild;n;n=pm(n,this))n.name===e&&t.push(n);return t},e.prototype.children=function(){for(var e=[],t=this.firstChild;t;t=t.next)e.push(t);return e},e.prototype.empty=function(){if(this.firstChild){for(var e=[],t=this.firstChild;t;t=pm(t,this))e.push(t);for(var n=e.length;n--;){(t=e[n]).parent=t.firstChild=t.lastChild=t.next=t.prev=null}}return this.firstChild=this.lastChild=null,this},e.prototype.isEmpty=function(e,t,n){void 0===t&&(t={});var r=this.firstChild;if(vm(this))return!1;if(r)do{if(1===r.type){if(r.attr("data-mce-bogus"))continue;if(e[r.name])return!1;if(vm(r))return!1}if(8===r.type)return!1;if(3===r.type&&!hm(r))return!1;if(3===r.type&&r.parent&&t[r.parent.name]&&Mo(r.value))return!1;if(n&&n(r))return!1}while(r=pm(r,this));return!0},e.prototype.walk=function(e){return pm(this,null,e)},e}(),ym=function(e,t){return e.replace(t.re,(function(e){return Ce(t.uris,e).getOr(e)}))},Cm=bt.each,wm=bt.trim,xm="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),Sm={ftp:21,http:80,https:443,mailto:25},Tm=["img","video"],km=function(e,t,n){return!e.allow_html_data_urls&&(/^data:image\//i.test(t)?function(e,t){return C(e)?!e:!C(t)||!V(Tm,t)}(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(t):/^data:/i.test(t))},Nm=function(){function e(t,n){t=wm(t),this.settings=n||{};var r=this.settings.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t))o.source=t;else{var i=0===t.indexOf("//");if(0!==t.indexOf("/")||i||(t=(r&&r.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){var u=this.settings.base_uri?this.settings.base_uri.path:new e(document.location.href).directory;if(this.settings.base_uri&&""==this.settings.base_uri.protocol)t="//mce_host"+o.toAbsPath(u,t);else{var a=/([^#?]*)([#?]?.*)/.exec(t);t=(r&&r.protocol||"http")+"://mce_host"+o.toAbsPath(u,a[1])+a[2]}}t=t.replace(/@@/g,"(mce_at)");var c=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);Cm(xm,(function(e,t){var n=c[t];n&&(n=n.replace(/\(mce_at\)/g,"@@")),o[e]=n})),r&&(o.protocol||(o.protocol=r.protocol),o.userInfo||(o.userInfo=r.userInfo),o.port||"mce_host"!==o.host||(o.port=r.port),o.host&&"mce_host"!==o.host||(o.host=r.host),o.source=""),i&&(o.protocol="")}}return e.parseDataUri=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},e.isDomSafe=function(e,t,n){if(void 0===n&&(n={}),n.allow_script_urls)return!0;var r=ai.decode(e).replace(/[\s\u0000-\u001F]+/g,"");try{r=decodeURIComponent(r)}catch(e){r=unescape(r)}return!/((java|vb)script|mhtml):/i.test(r)&&!km(n,r,t)},e.getDocumentBaseUrl=function(e){var t;return t=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/")),t},e.prototype.setPath=function(e){var t=/^(.*?)\/?(\w+)?$/.exec(e);this.path=t[0],this.directory=t[1],this.file=t[2],this.source="",this.getURI()},e.prototype.toRelative=function(t){var n;if("./"===t)return t;var r=new e(t,{base_uri:this});if("mce_host"!==r.host&&this.host!==r.host&&r.host||this.port!==r.port||this.protocol!==r.protocol&&""!==r.protocol)return r.getURI();var o=this.getURI(),i=r.getURI();return o===i||"/"===o.charAt(o.length-1)&&o.substr(0,o.length-1)===i?o:(n=this.toRelPath(this.path,r.path),r.query&&(n+="?"+r.query),r.anchor&&(n+="#"+r.anchor),n)},e.prototype.toAbsolute=function(t,n){var r=new e(t,{base_uri:this});return r.getURI(n&&this.isSameOrigin(r))},e.prototype.isSameOrigin=function(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;var t=Sm[this.protocol];if(t&&(this.port||t)==(e.port||t))return!0}return!1},e.prototype.toRelPath=function(e,t){var n,r,o=0,i="",u=e.substring(0,e.lastIndexOf("/")).split("/"),a=t.split("/");if(u.length>=a.length)for(n=0,r=u.length;n<r;n++)if(n>=a.length||u[n]!==a[n]){o=n+1;break}if(u.length<a.length)for(n=0,r=a.length;n<r;n++)if(n>=u.length||u[n]!==a[n]){o=n+1;break}if(1===o)return t;for(n=0,r=u.length-(o-1);n<r;n++)i+="../";for(n=o-1,r=a.length;n<r;n++)i+=n!==o-1?"/"+a[n]:a[n];return i},e.prototype.toAbsPath=function(e,t){var n,r,o=0,i=[],u=/\/$/.test(t)?"/":"",a=e.split("/"),c=t.split("/");for(Cm(a,(function(e){e&&i.push(e)})),a=i,n=c.length-1,i=[];n>=0;n--)0!==c[n].length&&"."!==c[n]&&(".."!==c[n]?o>0?o--:i.push(c[n]):o++);return 0!==(r=(n=a.length-o)<=0?re(i).join("/"):a.slice(0,n).join("/")+"/"+re(i).join("/")).indexOf("/")&&(r="/"+r),u&&r.lastIndexOf("/")!==r.length-1&&(r+=u),r},e.prototype.getURI=function(e){var t;return void 0===e&&(e=!1),this.source&&!e||(t="",e||(this.protocol?t+=this.protocol+"://":t+="//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source},e}(),Em=bt.makeMap("button,fieldset,form,iframe,img,image,input,object,output,select,textarea"),Rm=function(e,t,n){for(var r=/<([!?\/])?([A-Za-z0-9\-_:.]+)/g,o=/(?:\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g,i=e.getShortEndedElements(),u=1,a=n;0!==u;)for(r.lastIndex=a;;){var c=r.exec(t);if(null===c)return a;if("!"===c[1]){a=je(c[2],"--")?_m(t,!1,c.index+"!--".length):_m(t,!0,c.index+1);break}o.lastIndex=r.lastIndex;var f=o.exec(t);if(!h(f)&&f.index===r.lastIndex){"/"===c[1]?u-=1:we(i,c[2])||(u+=1),a=r.lastIndex+f[0].length;break}}return a},_m=function(e,t,n){void 0===n&&(n=0);var r=e.toLowerCase();if(-1!==r.indexOf("[if ",n)&&function(e,t){return/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(e.substr(t))}(r,n)){var o=r.indexOf("[endif]",n);return r.indexOf(">",o)}if(t){var i=r.indexOf(">",n);return-1!==i?i:r.length}var u=/--!?>/g;u.lastIndex=n;var a=u.exec(e);return a?a.index+a[0].length:r.length},Dm=function(e,t){var n=e.exec(t);if(n){var r=n[1],o=n[2];return"string"==typeof r&&"data-mce-bogus"===r.toLowerCase()?o:null}return null},Am=function(e,t){var n;void 0===t&&(t=vi());var r=null!==(n=(e=e||{}).document)&&void 0!==n?n:document,o=r.createElement("form");!1!==e.fix_self_closing&&(e.fix_self_closing=!0);var i=e.comment?e.comment:S,u=e.cdata?e.cdata:S,a=e.text?e.text:S,c=e.start?e.start:S,f=e.end?e.end:S,l=e.pi?e.pi:S,s=e.doctype?e.doctype:S,d=function(n,d){void 0===d&&(d="html");for(var m,g,p,h,v,b,y,C,w,x,S,T,k,N,E,R,_,D,A,O=n.html,B=0,P=[],L=0,I=ai.decode,M=bt.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),F="html"===d?0:1,j=function(e){var t,n;for(t=P.length;t--&&P[t].name!==e;);if(t>=0){for(n=P.length-1;n>=t;n--)(e=P[n]).valid&&f(e.name);P.length=t}},U=function(e,t){return a(ym(e,n),t)},z=function(t){""!==t&&(">"===t.charAt(0)&&(t=" "+t),e.allow_conditional_comments||"[if"!==t.substr(0,3).toLowerCase()||(t=" "+t),i(ym(t,n)))},H=function(e,t){var n=e||"",r=!je(n,"--"),o=_m(O,r,t);return e=O.substr(t,o-t),z(r?n+e:e),o+1},V=function(t,i,u,a,c){if(u=function(e){return ym(e,n)}((i=i.toLowerCase())in X?i:I(u||a||c||"")),G&&!C&&!1===function(e){return 0===e.indexOf("data-")||0===e.indexOf("aria-")}(i)){var f=N[i];if(!f&&E){for(var l=E.length;l--&&!(f=E[l]).pattern.test(i););-1===l&&(f=null)}if(!f)return;if(f.validValues&&!(u in f.validValues))return}("name"===i||"id"===i)&&t in Em&&(u in r||u in o)||M[i]&&!Nm.isDomSafe(u,t,e)||C&&(i in M||0===i.indexOf("on"))||(h.map[i]=u,h.push({name:i,value:u}))},q=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_:.]*)(\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>))","g"),W=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,$=t.getShortEndedElements(),K=e.self_closing_elements||t.getSelfClosingElements(),X=t.getBoolAttrs(),G=e.validate,Y=e.remove_internals,Q=e.fix_self_closing,J=t.getSpecialElements(),Z=O+">";m=q.exec(Z);){var ee=m[0];if(B<m.index&&U(I(O.substr(B,m.index-B))),g=m[7])":"===(g=g.toLowerCase()).charAt(0)&&(g=g.substr(1)),j(g);else if(g=m[8]){if(m.index+ee.length>O.length){U(I(O.substr(m.index))),B=m.index+ee.length;continue}":"===(g=g.toLowerCase()).charAt(0)&&(g=g.substr(1)),w=g in $,Q&&K[g]&&P.length>0&&P[P.length-1].name===g&&j(g);var te=Dm(W,m[9]);if(null!==te){if("all"===te){B=Rm(t,O,q.lastIndex),q.lastIndex=B;continue}S=!1}if(!G||(x=t.getElementRule(g))){if(S=!0,G&&(N=x.attributes,E=x.attributePatterns),(k=m[9])?((C=-1!==k.indexOf("data-mce-type"))&&Y&&(S=!1),(h=[]).map={},k.replace(W,(function(e,t,n,r,o){return V(g,t,n,r,o),""}))):(h=[]).map={},G&&!C){if(R=x.attributesRequired,_=x.attributesDefault,D=x.attributesForced,x.removeEmptyAttrs&&!h.length&&(S=!1),D)for(v=D.length;v--;)y=(T=D[v]).name,"{$uid}"===(A=T.value)&&(A="mce_"+L++),h.map[y]=A,h.push({name:y,value:A});if(_)for(v=_.length;v--;)(y=(T=_[v]).name)in h.map||("{$uid}"===(A=T.value)&&(A="mce_"+L++),h.map[y]=A,h.push({name:y,value:A}));if(R){for(v=R.length;v--&&!(R[v]in h.map););-1===v&&(S=!1)}if(T=h.map["data-mce-bogus"]){if("all"===T){B=Rm(t,O,q.lastIndex),q.lastIndex=B;continue}S=!1}}S&&c(g,h,w)}else S=!1;if(p=J[g]){p.lastIndex=B=m.index+ee.length,(m=p.exec(O))?(S&&(b=O.substr(B,m.index-B)),B=m.index+m[0].length):(b=O.substr(B),B=O.length),S&&(b.length>0&&U(b,!0),f(g)),q.lastIndex=B;continue}w||(k&&k.indexOf("/")===k.length-1?S&&f(g):P.push({name:g,valid:S}))}else if(g=m[1])z(g);else if(g=m[2]){if(!(1===F||e.preserve_cdata||P.length>0&&t.isValidChild(P[P.length-1].name,"#cdata"))){B=H("",m.index+2),q.lastIndex=B;continue}u(g)}else if(g=m[3])s(g);else{if((g=m[4])||"<!"===ee){B=H(g,m.index+ee.length),q.lastIndex=B;continue}if(g=m[5]){if(1!==F){B=H("?",m.index+2),q.lastIndex=B;continue}l(g,m[6])}}B=m.index+ee.length}for(B<O.length&&U(I(O.substr(B))),v=P.length-1;v>=0;v--)(g=P[v]).valid&&f(g.name)};return{parse:function(e,t){void 0===t&&(t="html"),d(function(e){for(var t,n=/data:[^;]+;base64,([a-z0-9\+\/=\s]+)/gi,r=[],o={},i=Ba("img"),u=0,a=0;t=n.exec(e);){var c=t[0],f=i+"_"+a++;o[f]=c,u<t.index&&r.push(e.substr(u,t.index-u)),r.push(f),u=t.index+c.length}var l=new RegExp(i+"_[0-9]+","g");return 0===u?{prefix:i,uris:o,html:e,re:l}:(u<e.length&&r.push(e.substr(u)),{prefix:i,uris:o,html:r.join(""),re:l})}(e),t)}}};Am.findEndTag=Rm;var Om=function(e,t){for(var n,r=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,o=e.schema,i=function(e,t){var n=new RegExp(["\\s?("+e.join("|")+')="[^"]+"'].join("|"),"gi");return t.replace(n,"")}(e.getTempAttrs(),t),u=o.getShortEndedElements();n=r.exec(i);){var a=r.lastIndex,c=n[0].length,f=void 0;f=u[n[1]]?a:Am.findEndTag(o,i,a),i=i.substring(0,a-c)+i.substring(f),r.lastIndex=a-c}return lo(i)},Bm=Om,Pm=function(e,t,n,r){var o,i=function(e,t){return Ae(Ae({},e),{format:t,get:!0,getInner:!0})}(t,n),u=t.no_events?i:e.fire("BeforeGetContent",i);return o="raw"===u.format?bt.trim(Bm(e.serializer,r.innerHTML)):"text"===u.format?e.dom.isEmpty(r)?"":lo(r.innerText||r.textContent):"tree"===u.format?e.serializer.serialize(r,u):function(e,t){var n=Hc(e),r=new RegExp("^(<"+n+"[^>]*>(&nbsp;|&#160;|\\s||<br \\/>|)<\\/"+n+">[\r\n]*|<br \\/>[\r\n]*)$");return t.replace(r,"")}(e,e.serializer.serialize(r,u)),V(["text","tree"],u.format)||co(Ct.fromDom(r))?u.content=o:u.content=bt.trim(o),u.no_events?u.content:e.fire("GetContent",u).content},Lm=bt.each,Im=function(e){return{compare:function(t,n){if(t.nodeName!==n.nodeName)return!1;var r=function(t){var n={};return Lm(e.getAttribs(t),(function(r){var o=r.nodeName.toLowerCase();0!==o.indexOf("_")&&"style"!==o&&0!==o.indexOf("data-")&&(n[o]=e.getAttrib(t,o))})),n},o=function(e,t){var n,r;for(r in e)if(we(e,r)){if(void 0===(n=t[r]))return!1;if(e[r]!==n)return!1;delete t[r]}for(r in t)if(we(t,r))return!1;return!0};return!!o(r(t),r(n))&&(!!o(e.parseStyle(e.getAttrib(t,"style")),e.parseStyle(e.getAttrib(n,"style")))&&(!Il(t)&&!Il(n)))}}},Mm=bt.makeMap,Fm=function(e){var t=[],n=(e=e||{}).indent,r=Mm(e.indent_before||""),o=Mm(e.indent_after||""),i=ai.getEncodeFunc(e.entity_encoding||"raw",e.entities),u="html"===e.element_format;return{start:function(e,a,c){var f,l,s,d;if(n&&r[e]&&t.length>0&&(d=t[t.length-1]).length>0&&"\n"!==d&&t.push("\n"),t.push("<",e),a)for(f=0,l=a.length;f<l;f++)s=a[f],t.push(" ",s.name,'="',i(s.value,!0),'"');t[t.length]=!c||u?">":" />",c&&n&&o[e]&&t.length>0&&(d=t[t.length-1]).length>0&&"\n"!==d&&t.push("\n")},end:function(e){var r;t.push("</",e,">"),n&&o[e]&&t.length>0&&(r=t[t.length-1]).length>0&&"\n"!==r&&t.push("\n")},text:function(e,n){e.length>0&&(t[t.length]=n?e:i(e))},cdata:function(e){t.push("<![CDATA[",e,"]]>")},comment:function(e){t.push("\x3c!--",e,"--\x3e")},pi:function(e,r){r?t.push("<?",e," ",i(r),"?>"):t.push("<?",e,"?>"),n&&t.push("\n")},doctype:function(e){t.push("<!DOCTYPE",e,">",n?"\n":"")},reset:function(){t.length=0},getContent:function(){return t.join("").replace(/\n$/,"")}}},jm=function(e,t){void 0===t&&(t=vi());var n=Fm(e);(e=e||{}).validate=!("validate"in e)||e.validate;return{serialize:function(r){var o=e.validate,i={3:function(e){n.text(e.value,e.raw)},8:function(e){n.comment(e.value)},7:function(e){n.pi(e.name,e.value)},10:function(e){n.doctype(e.value)},4:function(e){n.cdata(e.value)},11:function(e){if(e=e.firstChild)do{u(e)}while(e=e.next)}};n.reset();var u=function(e){var r=i[e.type];if(r)r(e);else{var a=e.name,c=e.shortEnded,f=e.attributes;if(o&&f&&f.length>1){var l=[];l.map={};var s=t.getElementRule(e.name);if(s){for(var d=0,m=s.attributesOrder.length;d<m;d++){if((p=s.attributesOrder[d])in f.map){var g=f.map[p];l.map[p]=g,l.push({name:p,value:g})}}for(d=0,m=f.length;d<m;d++){var p;if(!((p=f[d].name)in l.map)){g=f.map[p];l.map[p]=g,l.push({name:p,value:g})}}f=l}}if(n.start(e.name,f,c),!c){if(e=e.firstChild)do{u(e)}while(e=e.next);n.end(a)}}};return 1!==r.type||e.inner?i[11](r):u(r),n.getContent()}}},Um=new Set;$(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],(function(e){Um.add(e)}));var zm=["font","text-decoration","text-emphasis"],Hm=function(e,t){return se(e.parseStyle(e.getAttrib(t,"style")))},Vm=function(e,t){return ne(Hm(e,t),(function(e){return!function(e){return Um.has(e)}(e)}))},qm=function(e,t,n){var r=Hm(e,t),o=Hm(e,n),i=function(r){var o=e.getStyle(t,r),i=e.getStyle(n,r);return qe(o)&&qe(i)&&o!==i};return q(r,(function(e){var t=function(t){return q(t,(function(t){return t===e}))};if(!t(o)&&t(zm)){var n=G(o,(function(e){return q(zm,(function(t){return je(e,t)}))}));return q(n,i)}return i(e)}))},Wm=function(e,t,n){return F.from(n.container()).filter(_n).exists((function(r){var o=e?0:-1;return t(r.data.charAt(n.offset()+o))}))},$m=_(Wm,!0,Fl),Km=_(Wm,!1,Fl),Xm=function(e){var t=e.container();return _n(t)&&(0===t.data.length||fo(t.data)&&Fs.isBookmarkNode(t.parentNode))},Gm=function(e,t){return function(n){return F.from(Hf(e?0:-1,n)).filter(t).isSome()}},Ym=function(e){return Pn(e)&&"block"===Gn(Ct.fromDom(e),"display")},Qm=function(e){return In(e)&&!function(e){return wn(e)&&"all"===e.getAttribute("data-mce-bogus")}(e)},Jm=Gm(!0,Ym),Zm=Gm(!1,Ym),eg=Gm(!0,Fn),tg=Gm(!1,Fn),ng=Gm(!0,Nn),rg=Gm(!1,Nn),og=Gm(!0,Qm),ig=Gm(!1,Qm),ug=function(e){var t=Ta(e,"br"),n=G(function(e){for(var t=[],n=e.dom;n;)t.push(Ct.fromDom(n)),n=n.lastChild;return t}(e).slice(-1),no);t.length===n.length&&$(n,an)},ag=function(e){un(e),rn(e,Ct.fromHtml('<br data-mce-bogus="1">'))},cg=function(e){Wt(e).each((function(t){Ft(t).each((function(n){eo(e)&&no(t)&&eo(n)&&an(t)}))}))},fg=function(e,t,n){return Nt(t,e)?function(e,t){for(var n=w(t)?t:B,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=Ct.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o}(e,(function(e){return n(e)||Tt(e,t)})).slice(0,-1):[]},lg=function(e,t){return fg(e,t,B)},sg=function(e,t){return[e].concat(lg(e,t))},dg=function(e,t,n){return bl(e,t,n,Xm)},mg=function(e,t){return Z(sg(Ct.fromDom(t.container()),e),eo)},gg=function(e,t,n){return dg(e,t.dom,n).forall((function(e){return mg(t,n).fold((function(){return!1===zf(e,n,t.dom)}),(function(r){return!1===zf(e,n,t.dom)&&Nt(r,Ct.fromDom(e.container()))}))}))},pg=function(e,t,n){return mg(t,n).fold((function(){return dg(e,t.dom,n).forall((function(e){return!1===zf(e,n,t.dom)}))}),(function(t){return dg(e,t.dom,n).isNone()}))},hg=_(pg,!1),vg=_(pg,!0),bg=_(gg,!1),yg=_(gg,!0),Cg=function(e){return Qf(e).exists(no)},wg=function(e,t,n){var r=G(sg(Ct.fromDom(n.container()),t),eo),o=ae(r).getOr(t);return hl(e,o.dom,n).filter(Cg)},xg=function(e,t){return Qf(t).exists(no)||wg(!0,e,t).isSome()},Sg=function(e,t){return function(e){return F.from(e.getNode(!0)).map(Ct.fromDom)}(t).exists(no)||wg(!1,e,t).isSome()},Tg=_(wg,!1),kg=_(wg,!0),Ng=function(e){return pc.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd()},Eg=function(e,t){var n=G(sg(Ct.fromDom(t.container()),e),eo);return ae(n).getOr(e)},Rg=function(e,t){return Ng(t)?Km(t):Km(t)||wl(Eg(e,t).dom,t).exists(Km)},_g=function(e,t){return Ng(t)?$m(t):$m(t)||Cl(Eg(e,t).dom,t).exists($m)},Dg=function(e){return Qf(e).bind((function(e){return jr(e,Dt)})).exists((function(e){return function(e){return V(["pre","pre-wrap"],e)}(Gn(e,"white-space"))}))},Ag=function(e,t){return function(e,t){return wl(e.dom,t).isNone()}(e,t)||function(e,t){return Cl(e.dom,t).isNone()}(e,t)||hg(e,t)||vg(e,t)||Sg(e,t)||xg(e,t)},Og=function(e,t){return!Dg(t)&&(hg(e,t)||bg(e,t)||Sg(e,t)||Rg(e,t))},Bg=function(e,t){return!Dg(t)&&(vg(e,t)||yg(e,t)||xg(e,t)||_g(e,t))},Pg=function(e,t){return Og(e,t)||Bg(e,function(e){var t=e.container(),n=e.offset();return _n(t)&&n<t.data.length?pc(t,n+1):e}(t))},Lg=function(e,t){return Ml(e.charAt(t))},Ig=function(e){var t=e.container();return _n(t)&&Fe(t.data,"")},Mg=function(e){var t=e.data,n=function(e){var t=e.split("");return W(t,(function(e,n){return Ml(e)&&n>0&&n<t.length-1&&jl(t[n-1])&&jl(t[n+1])?" ":e})).join("")}(t);return n!==t&&(e.data=n,!0)},Fg=function(e,t){return F.some(t).filter(Ig).bind((function(t){var n=t.container();return function(e,t){var n=t.data,r=pc(t,0);return!(!Lg(n,0)||Pg(e,r))&&(t.data=" "+n.slice(1),!0)}(e,n)||Mg(n)||function(e,t){var n=t.data,r=pc(t,n.length-1);return!(!Lg(n,n.length-1)||Pg(e,r))&&(t.data=n.slice(0,-1)+" ",!0)}(e,n)?F.some(t):F.none()}))},jg=function(e){var t=Ct.fromDom(e.getBody());e.selection.isCollapsed()&&Fg(t,pc.fromRangeStart(e.selection.getRng())).each((function(t){e.selection.setRng(t.toRange())}))},Ug=function(e,t,n){if(0!==n){var r=Ct.fromDom(e),o=Fr(r,eo).getOr(r),i=e.data.slice(t,t+n),u=t+n>=e.data.length&&Bg(o,pc(e,e.data.length)),a=0===t&&Og(o,pc(e,0));e.replaceData(t,n,function(e,t,n){return Q(e,(function(r,o){return Fl(o)||Ml(o)?r.previousCharIsSpace||""===r.str&&t||r.str.length===e.length-1&&n?{previousCharIsSpace:!1,str:r.str+""}:{previousCharIsSpace:!0,str:r.str+" "}:{previousCharIsSpace:!1,str:r.str+o}}),{previousCharIsSpace:!1,str:""}).str}(i,a,u))}},zg=function(e,t){var n=e.data.slice(t),r=n.length-He(n).length;Ug(e,t,r)},Hg=function(e,t){var n=e.data.slice(0,t),r=n.length-Ve(n).length;Ug(e,t-r,r)},Vg=function(e,t,n,r){void 0===r&&(r=!0);var o=Ve(e.data).length,i=r?e:t,u=r?t:e;return r?i.appendData(u.data):i.insertData(0,u.data),an(Ct.fromDom(u)),n&&zg(i,o),i},qg=function(e,t){return function(e,t){var n=e.container(),r=e.offset();return!1===pc.isTextPosition(e)&&n===t.parentNode&&r>pc.before(t).offset()}(t,e)?pc(t.container(),t.offset()-1):t},Wg=function(e){return Bo(e.previousSibling)?F.some((t=e.previousSibling,_n(t)?pc(t,t.data.length):pc.after(t))):e.previousSibling?Sl(e.previousSibling):F.none();var t},$g=function(e){return Bo(e.nextSibling)?F.some((t=e.nextSibling,_n(t)?pc(t,0):pc.before(t))):e.nextSibling?xl(e.nextSibling):F.none();var t},Kg=function(e,t){return Wg(t).orThunk((function(){return $g(t)})).orThunk((function(){return function(e,t){var n=pc.before(t.previousSibling?t.previousSibling:t.parentNode);return wl(e,n).fold((function(){return Cl(e,pc.after(t))}),F.some)}(e,t)}))},Xg=function(e,t){return $g(t).orThunk((function(){return Wg(t)})).orThunk((function(){return function(e,t){return Cl(e,pc.after(t)).fold((function(){return wl(e,pc.before(t))}),F.some)}(e,t)}))},Gg=function(e,t,n){return function(e,t,n){return e?Xg(t,n):Kg(t,n)}(e,t,n).map(_(qg,n))},Yg=function(e,t,n){n.fold((function(){e.focus()}),(function(n){e.selection.setRng(n.toRange(),t)}))},Qg=function(e,t){return t&&we(e.schema.getBlockElements(),Et(t))},Jg=function(e){if(Vo(e)){var t=Ct.fromHtml('<br data-mce-bogus="1">');return un(e),rn(e,t),F.some(pc.before(t.dom))}return F.none()},Zg=function(e,t,n){var r,o,i,u,a=Ft(e).filter(At),c=jt(e).filter(At);return an(e),(r=a,o=c,i=t,u=function(e,t,r){var o=e.dom,i=t.dom,u=o.data.length;return Vg(o,i,n),r.container()===i?pc(o,u):r},r.isSome()&&o.isSome()&&i.isSome()?F.some(u(r.getOrDie(),o.getOrDie(),i.getOrDie())):F.none()).orThunk((function(){return n&&(a.each((function(e){return Hg(e.dom,e.dom.length)})),c.each((function(e){return zg(e.dom,0)}))),t}))},ep=function(e,t,n,r){void 0===r&&(r=!0);var o,i=Gg(t,e.getBody(),n.dom),u=Fr(n,_(Qg,e),(o=e.getBody(),function(e){return e.dom===o})),a=Zg(n,i,function(e,t){return we(e.schema.getTextInlineElements(),Et(t))}(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):u.bind(Jg).fold((function(){r&&Yg(e,t,a)}),(function(n){r&&Yg(e,t,F.some(n))}))},tp=function(e){return Ta(e,"td,th")},np=function(e,t){return{start:e,end:t}},rp=pr([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),op=function(e,t){return Vr(Ct.fromDom(e),"td,th",t)},ip=function(e){return!Tt(e.start,e.end)},up=function(e,t){return Ss(e.start,t).bind((function(n){return Ss(e.end,t).bind((function(e){return t=Tt(n,e),r=n,t?F.some(r):F.none();var t,r}))}))},ap=function(e){return function(t){return up(t,e).map((function(e){return function(e,t,n){return{rng:e,table:t,cells:n}}(t,e,tp(e))}))}},cp=function(e,t,n,r){if(n.collapsed||!e.forall(ip))return F.none();if(t.isSameTable){var o=e.bind(ap(r));return F.some({start:o,end:o})}var i=op(n.startContainer,r),u=op(n.endContainer,r),a=i.bind(function(e){return function(t){return Ss(t,e).bind((function(e){return ce(tp(e)).map((function(e){return np(t,e)}))}))}}(r)).bind(ap(r)),c=u.bind(function(e){return function(t){return Ss(t,e).bind((function(e){return ae(tp(e)).map((function(e){return np(e,t)}))}))}}(r)).bind(ap(r));return F.some({start:a,end:c})},fp=function(e,t){return ee(e,(function(e){return Tt(e,t)}))},lp=function(e){return Un(fp(e.cells,e.rng.start),fp(e.cells,e.rng.end),(function(t,n){return e.cells.slice(t,n+1)}))},sp=function(e,t,n){return e.exists((function(e){return function(e,t){return!ip(e)&&up(e,t).exists((function(e){var t=e.dom.rows;return 1===t.length&&1===t[0].cells.length}))}(e,n)&&Ns(e.start,t)}))},dp=function(e,t){var n=t.startTable,r=t.endTable,o=e.cloneRange();return n.each((function(e){return o.setStartAfter(e.dom)})),r.each((function(e){return o.setEndBefore(e.dom)})),o},mp=function(e,t){var n=function(e){return function(t){return Tt(e,t)}}(e),r=function(e,t){var n=op(e.startContainer,t),r=op(e.endContainer,t);return Un(n,r,np)}(t,n),o=function(e,t){var n=function(e){return Ss(Ct.fromDom(e),t)},r=n(e.startContainer),o=n(e.endContainer),i=r.isSome(),u=o.isSome(),a=Un(r,o,Tt).getOr(!1);return{startTable:r,endTable:o,isStartInTable:i,isEndInTable:u,isSameTable:a,isMultiTable:!a&&i&&u}}(t,n);return sp(r,t,n)?r.map((function(e){return rp.singleCellTable(t,e.start)})):o.isMultiTable?function(e,t,n,r){return cp(e,t,n,r).bind((function(e){var r=e.start,o=e.end,i=r.bind(lp).getOr([]),u=o.bind(lp).getOr([]);if(i.length>0&&u.length>0){var a=dp(n,t);return F.some(rp.multiTable(i,u,a))}return F.none()}))}(r,o,t,n):function(e,t,n,r){return cp(e,t,n,r).bind((function(e){var t=e.start,n=e.end;return t.or(n)})).bind((function(e){var r=t.isSameTable,o=lp(e).getOr([]);if(r&&e.cells.length===o.length)return F.some(rp.fullTable(e.table));if(o.length>0){if(r)return F.some(rp.partialTable(o,F.none()));var i=dp(n,t);return F.some(rp.partialTable(o,F.some(Ae(Ae({},t),{rng:i}))))}return F.none()}))}(r,o,t,n)},gp=function(e){var t;return(8===Rt(t=e)||"#comment"===Et(t)?Ft(e):Wt(e)).bind(gp).orThunk((function(){return F.some(e)}))},pp=function(e){return $(e,(function(e){Kn(e,"contenteditable"),ag(e)}))},hp=function(e,t,n,r){var o=n.cloneRange();r?(o.setStart(n.startContainer,n.startOffset),o.setEndAfter(t.dom.lastChild)):(o.setStartBefore(t.dom.firstChild),o.setEnd(n.endContainer,n.endOffset)),Cp(e,o,t,!1)},vp=function(e){var t=xs(e),n=Ct.fromDom(e.selection.getNode());Mn(n.dom)&&Vo(n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&q(t,(function(e){return Tt(e,n)}))&&Vn(n,"data-mce-selected","1")},bp=function(e,t,n){var r=e.selection.getRng(),o=n.bind((function(n){var o=n.rng,i=n.isStartInTable,u=function(e,t){return F.from(e.dom.getParent(t,e.dom.isBlock)).map(Ct.fromDom)}(e,i?o.endContainer:o.startContainer);o.deleteContents(),function(e,t,n){n.each((function(n){t?an(n):(ag(n),e.selection.setCursorLocation(n.dom,0))}))}(e,i,u.filter(Vo));var a=i?t[0]:t[t.length-1];return hp(e,a,r,i),Vo(a)?F.none():F.some(i?t.slice(1):t.slice(0,-1))})).getOr(t);return pp(o),vp(e),!0},yp=function(e,t,n,r){var o=e.selection.getRng(),i=t[0],u=n[n.length-1];hp(e,i,o,!0),hp(e,u,o,!1);var a=Vo(i)?t:t.slice(1),c=Vo(u)?n:n.slice(0,-1);return pp(a.concat(c)),r.deleteContents(),vp(e),!0},Cp=function(e,t,n,r){void 0===r&&(r=!0),t.deleteContents();var o,i=gp(n).getOr(n),u=Ct.fromDom(e.dom.getParent(i.dom,e.dom.isBlock));if(Vo(u)&&(ag(u),r&&e.selection.setCursorLocation(u.dom,0)),!Tt(n,u)){var a=jn(Mt(u),n)?[]:Mt(o=u).map(Ht).map((function(e){return G(e,(function(e){return!Tt(o,e)}))})).getOr([]);$(a.concat(Ht(n)),(function(e){Tt(e,u)||Nt(e,u)||!Vo(e)||an(e)}))}return!0},wp=function(e,t){return ep(e,!1,t),!0},xp=function(e,t,n,r){return Tp(t,r).fold((function(){return function(e,t,n){return mp(t,n).map((function(t){return t.fold(_(Cp,e),_(wp,e),_(bp,e),_(yp,e))}))}(e,t,n)}),(function(t){return function(e,t){return kp(e,t)}(e,t)})).getOr(!1)},Sp=function(e,t){return Z(sg(t,e),ao)},Tp=function(e,t){return Z(sg(t,e),(n="caption",function(e){return Dt(e)&&Et(e)===n}));var n},kp=function(e,t){return ag(t),e.selection.setCursorLocation(t.dom,0),F.some(!0)},Np=function(e,t,n,r,o){return vl(n,e.getBody(),o).bind((function(i){return function(e,t,n,r){return xl(e.dom).bind((function(o){return Sl(e.dom).map((function(e){return t?n.isEqual(o)&&r.isEqual(e):n.isEqual(e)&&r.isEqual(o)}))})).getOr(!0)}(r,n,o,i)?function(e,t){return kp(e,t)}(e,r):function(e,t,n){return Tp(e,Ct.fromDom(n.getNode())).map((function(e){return!1===Tt(e,t)}))}(t,r,i)})).or(F.some(!0))},Ep=function(e,t,n,r){var o=pc.fromRangeStart(e.selection.getRng());return Sp(n,r).bind((function(r){return Vo(r)?kp(e,r):function(e,t,n,r,o){return vl(n,e.getBody(),o).bind((function(e){return Sp(t,Ct.fromDom(e.getNode())).map((function(e){return!1===Tt(e,r)}))}))}(e,n,t,r,o)})).getOr(!1)},Rp=function(e,t){return e?ng(t):rg(t)},_p=function(e,t,n){var r=Ct.fromDom(e.getBody());return Tp(r,n).fold((function(){return Ep(e,t,r,n)||function(e,t){var n=pc.fromRangeStart(e.selection.getRng());return Rp(t,n)||hl(t,e.getBody(),n).exists((function(e){return Rp(t,e)}))}(e,t)}),(function(n){return function(e,t,n,r){var o=pc.fromRangeStart(e.selection.getRng());return Vo(r)?kp(e,r):Np(e,n,t,r,o)}(e,t,r,n).getOr(!1)}))},Dp=function(e,t){var n=Ct.fromDom(e.selection.getStart(!0)),r=xs(e);return e.selection.isCollapsed()&&0===r.length?_p(e,t,n):function(e,t,n){var r=Ct.fromDom(e.getBody()),o=e.selection.getRng();return 0!==n.length?bp(e,n,F.none()):xp(e,r,o,t)}(e,n,r)},Ap=function(e){var t=pc.fromRangeStart(e),n=pc.fromRangeEnd(e),r=e.commonAncestorContainer;return hl(!1,r,n).map((function(o){return!zf(t,n,r)&&zf(t,o,r)?function(e,t,n,r){var o=document.createRange();return o.setStart(e,t),o.setEnd(n,r),o}(t.container(),t.offset(),o.container(),o.offset()):e})).getOr(e)},Op=function(e){return e.collapsed?e:Ap(e)},Bp=function(e){return e&&e.firstChild&&e.firstChild===e.lastChild&&function(e){return""===e.data||Bn(e)}(e.firstChild)},Pp=function(e){return e.length>0&&(!(t=e[e.length-1]).firstChild||Bp(t))?e.slice(0,-1):e;var t},Lp=function(e,t){var n=e.getParent(t,e.isBlock);return n&&"LI"===n.nodeName?n:null},Ip=function(e,t){var n=pc.after(e),r=sl(t).prev(n);return r?r.toRange():null},Mp=function(e,t,n){var r=e.parentNode;return bt.each(t,(function(t){r.insertBefore(t,e)})),function(e,t){var n=pc.before(e),r=sl(t).next(n);return r?r.toRange():null}(e,n)},Fp=function(e,t,n,r){var o,i=function(e,t,n){var r=t.serialize(n);return function(e){var t=e.firstChild,n=e.lastChild;return t&&"META"===t.nodeName&&t.parentNode.removeChild(t),n&&"mce_marker"===n.id&&n.parentNode.removeChild(n),e}(e.createFragment(r))}(t,e,r),u=Lp(t,n.startContainer),a=Pp((o=i.firstChild,G(o.childNodes,(function(e){return"LI"===e.nodeName})))),c=t.getRoot(),f=function(e){var r=pc.fromRangeStart(n),o=sl(t.getRoot()),i=1===e?o.prev(r):o.next(r);return!i||Lp(t,i.getNode())!==u};return f(1)?Mp(u,a,c):f(2)?function(e,t,n,r){return r.insertAfter(t.reverse(),e),Ip(t[0],n)}(u,a,c,t):function(e,t,n,r){var o=function(e,t){var n=t.cloneRange(),r=t.cloneRange();return n.setStartBefore(e),r.setEndAfter(e),[n.cloneContents(),r.cloneContents()]}(e,r),i=e.parentNode;return i.insertBefore(o[0],e),bt.each(t,(function(t){i.insertBefore(t,e)})),i.insertBefore(o[1],e),i.removeChild(e),Ip(t[t.length-1],n)}(u,a,c,n)},jp=Mn,Up=function(e){var t=e.dom,n=Op(e.selection.getRng());e.selection.setRng(n);var r=t.getParent(n.startContainer,jp);!function(e,t,n){return null!==n&&(n===e.getParent(t.endContainer,jp)&&Ns(Ct.fromDom(n),t))}(t,n,r)?e.getDoc().execCommand("Delete",!1,null):Cp(e,n,Ct.fromDom(r))},zp=function(e,t,n){var r,o,i,u=e.selection,a=e.dom;/^ | $/.test(t)&&(t=function(e,t,n){var r=Ct.fromDom(e.getRoot());return n=Og(r,pc.fromRangeStart(t))?n.replace(/^ /,"&nbsp;"):n.replace(/^&nbsp;/," "),n=Bg(r,pc.fromRangeEnd(t))?n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n.replace(/&nbsp;(<br( \/)?>)?$/," ")}(a,u.getRng(),t));var c=e.parser,f=n.merge,l=jm({validate:uf(e)},e.schema),s='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>',d=e.fire("BeforeSetContent",{content:t,format:"html",selection:!0,paste:n.paste});if(d.isDefaultPrevented())e.fire("SetContent",{content:d.content,format:"html",selection:!0,paste:n.paste});else{-1===(t=d.content).indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,s);var m=(o=u.getRng()).startContainer||(o.parentElement?o.parentElement():null),g=e.getBody();m===g&&u.isCollapsed()&&a.isBlock(g.firstChild)&&function(e,t){return t&&!e.schema.getShortEndedElements()[t.nodeName]}(e,g.firstChild)&&a.isEmpty(g.firstChild)&&((o=a.createRng()).setStart(g.firstChild,0),o.setEnd(g.firstChild,0),u.setRng(o)),u.isCollapsed()||Up(e);var p,h={context:(r=u.getNode()).nodeName.toLowerCase(),data:n.data,insert:!0},v=c.parse(t,h);if(!0===n.paste&&function(e,t){var n=t.firstChild,r=t.lastChild;return n&&"meta"===n.name&&(n=n.next),r&&"mce_marker"===r.attr("id")&&(r=r.prev),function(e,t){var n=e.getNonEmptyElements();return t&&(t.isEmpty(n)||function(e,t){return e.getBlockElements()[t.name]&&function(e){return e.firstChild&&e.firstChild===e.lastChild}(t)&&function(e){return"br"===e.name||""===e.value}(t.firstChild)}(e,t))}(e,r)&&(r=r.prev),!(!n||n!==r)&&("ul"===n.name||"ol"===n.name)}(e.schema,v)&&function(e,t){return!!Lp(e,t)}(a,r))return o=Fp(l,a,u.getRng(),v),u.setRng(o),void e.fire("SetContent",d);if(function(e){for(var t=e;t=t.walk();)1===t.type&&t.attr("data-mce-fragment","1")}(v),"mce_marker"===(i=v.lastChild).attr("id")){var b=i;for(i=i.prev;i;i=i.walk(!0))if(3===i.type||!a.isBlock(i.name)){e.schema.isValidChild(i.parent.name,"span")&&i.parent.insert(b,i,"br"===i.name);break}}if(e._selectionOverrides.showBlockCaretContainer(r),h.invalid){e.selection.setContent(s),r=u.getNode();var y=e.getBody();for(9===r.nodeType?r=i=y:i=r;i!==y;)r=i,i=i.parentNode;t=r===y?y.innerHTML:a.getOuterHTML(r),t=l.serialize(c.parse(t.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,(function(){return l.serialize(v)})))),r===y?a.setHTML(y,t):a.setOuterHTML(r,t)}else!function(e,t,n){if("all"===n.getAttribute("data-mce-bogus"))n.parentNode.insertBefore(e.dom.createFragment(t),n);else{var r=n.firstChild,o=n.lastChild;!r||r===o&&"BR"===r.nodeName?e.dom.setHTML(n,t):e.selection.setContent(t)}}(e,t=l.serialize(v),r);!function(e,t){var n=e.schema.getTextInlineElements(),r=e.dom;if(t){var o=e.getBody(),i=Im(r);bt.each(r.select("*[data-mce-fragment]"),(function(e){if(C(n[e.nodeName.toLowerCase()])&&Vm(r,e))for(var t=e.parentNode;C(t)&&t!==o;t=t.parentNode){if(qm(r,e,t))break;if(i.compare(t,e)){r.remove(e,!0);break}}}))}}(e,f),function(e,t){var n,r=e.dom,o=e.selection;if(t){o.scrollIntoView(t);var i=js(e.getBody(),t);if("false"===r.getContentEditable(i))return r.remove(t),void o.select(i);var u=r.createRng(),a=t.previousSibling;if(_n(a)){if(u.setStart(a,a.nodeValue.length),!mt.ie){var c=t.nextSibling;_n(c)&&(a.appendData(c.data),c.parentNode.removeChild(c))}}else u.setStartBefore(t),u.setEndBefore(t);var f=r.getParent(t,r.isBlock);r.remove(t),f&&r.isEmpty(f)&&(e.$(f).empty(),u.setStart(f,0),u.setEnd(f,0),jp(f)||function(e){return!!e.getAttribute("data-mce-fragment")}(f)||!(n=function(t){var n=pc.fromRangeStart(t);if(n=sl(e.getBody()).next(n))return n.toRange()}(u))?r.add(f,r.create("br",{"data-mce-bogus":"1"})):(u=n,r.remove(f))),o.setRng(u)}}(e,a.get("mce_marker")),p=e.getBody(),bt.each(p.getElementsByTagName("*"),(function(e){e.removeAttribute("data-mce-fragment")})),function(e,t){F.from(e.getParent(t,"td,th")).map(Ct.fromDom).each(cg)}(a,u.getStart()),e.fire("SetContent",d),e.addVisual()}},Hp=function(e,t){t(e),e.firstChild&&Hp(e.firstChild,t),e.next&&Hp(e.next,t)},Vp=function(e,t,n){var r=function(e,t,n){var r={},o={},i=[];for(var u in n.firstChild&&Hp(n.firstChild,(function(n){$(e,(function(e){e.name===n.name&&(r[e.name]?r[e.name].nodes.push(n):r[e.name]={filter:e,nodes:[n]})})),$(t,(function(e){"string"==typeof n.attr(e.name)&&(o[e.name]?o[e.name].nodes.push(n):o[e.name]={filter:e,nodes:[n]})}))})),r)we(r,u)&&i.push(r[u]);for(var a in o)we(o,a)&&i.push(o[a]);return i}(e,t,n);$(r,(function(e){$(e.filter.callbacks,(function(t){t(e.nodes,e.filter.name,{})}))}))},qp=function(e){return e instanceof bm},Wp=function(e,t,n){e.dom.setHTML(e.getBody(),t),!0!==n&&function(e){im(e)&&xl(e.getBody()).each((function(t){var n=t.getNode(),r=Nn(n)?xl(n).getOr(t):t;e.selection.setRng(r.toRange())}))}(e)},$p=function(e,t,n){var r=function(e,t){return Ae(Ae({format:"html"},e),{set:!0,content:qp(t)?"":t})}(n,t),o=n.no_events?r:e.fire("BeforeSetContent",r);return qp(t)||(t=o.content),F.from(e.getBody()).fold(N(t),(function(n){return qp(t)?function(e,t,n,r){Vp(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);var o=jm({validate:e.validate},e.schema).serialize(n);return r.content=co(Ct.fromDom(t))?o:bt.trim(o),Wp(e,r.content,r.no_selection),r.no_events||e.fire("SetContent",r),n}(e,n,t,o):function(e,t,n,r){if(0===n.length||/^\s+$/.test(n)){var o='<br data-mce-bogus="1">';"TABLE"===t.nodeName?n="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+o+"</li>");var i=Hc(e);i&&e.schema.isValidChild(t.nodeName.toLowerCase(),i.toLowerCase())?(n=o,n=e.dom.createHTML(i,Vc(e),n)):n||(n='<br data-mce-bogus="1">'),Wp(e,n,r.no_selection),e.fire("SetContent",r)}else"raw"!==r.format&&(n=jm({validate:e.validate},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0}))),r.content=co(Ct.fromDom(t))?n:bt.trim(n),Wp(e,r.content,r.no_selection),r.no_events||e.fire("SetContent",r);return r.content}(e,n,t,o)}))},Kp=function(e,t){return function(e,t){var n=e.dom;return n.parentNode?Ur(Ct.fromDom(n.parentNode),(function(n){return!Tt(e,n)&&t(n)})):F.none()}(e,t).isSome()},Xp=function(e){return w(e)?e:B},Gp=function(e,t,n){var r=t(e),o=Xp(n);return r.orThunk((function(){return o(e)?F.none():function(e,t,n){for(var r=e.dom,o=Xp(n);r.parentNode;){r=r.parentNode;var i=Ct.fromDom(r),u=t(i);if(u.isSome())return u;if(o(i))break}return F.none()}(e,t,o)}))},Yp=Kl,Qp=function(e,t,n){var r=e.formatter.get(n);if(r)for(var o=0;o<r.length;o++){var i=r[o];if(es(i)&&!1===i.inherit&&e.dom.is(t,i.selector))return!0}return!1},Jp=function(e,t,n,r,o){var i=e.dom.getRoot();return t!==i&&(t=e.dom.getParent(t,(function(t){return!!Qp(e,t,n)||(t.parentNode===i||!!th(e,t,n,r,!0))})),!!th(e,t,n,r,o))},Zp=function(e,t,n){return!!Yp(t,n.inline)||(!!Yp(t,n.block)||(n.selector?1===t.nodeType&&e.is(t,n.selector):void 0))},eh=function(e,t,n,r,o,i){var u=n[r];if(w(n.onmatch))return n.onmatch(t,n,r);if(u)if(b(u.length)){for(var a in u)if(we(u,a)){var c="attributes"===r?e.getAttrib(t,a):Gl(e,t,a),f=$l(u[a],i),l=y(c)||We(c);if(l&&y(f))continue;if(o&&l&&!n.exact)return!1;if((!o||n.exact)&&!Yp(c,Xl(e,f,a)))return!1}}else for(var s=0;s<u.length;s++)if("attributes"===r?e.getAttrib(t,u[s]):Gl(e,t,u[s]))return!0;return!0},th=function(e,t,n,r,o){var i=e.formatter.get(n),u=e.dom;if(i&&t)for(var a=0;a<i.length;a++){var c=i[a];if(Zp(e.dom,t,c)&&eh(u,t,c,"attributes",o,r)&&eh(u,t,c,"styles",o,r)){var f=c.classes;if(f)for(var l=0;l<f.length;l++)if(!e.dom.hasClass(t,$l(f[l],r)))return;return c}}},nh=function(e,t,n,r,o){if(r)return Jp(e,r,t,n,o);if(r=e.selection.getNode(),Jp(e,r,t,n,o))return!0;var i=e.selection.getStart();return!(i===r||!Jp(e,i,t,n,o))},rh=function(e,t){var n=function(t){return Tt(t,Ct.fromDom(e.getBody()))};return F.from(e.selection.getStart(!0)).bind((function(r){return Gp(Ct.fromDom(r),(function(n){return le(t,(function(t){return function(t,n){return th(e,t.dom,n)?F.some(n):F.none()}(n,t)}))}),n)})).getOrNull()},oh=function(e,t,n){return Q(n,(function(n,r){var o=function(e,t){return q(e.formatter.get(t),(function(e){var t=function(e){return e.length>1&&"%"===e.charAt(0)};return q(["styles","attributes"],(function(n){return Ce(e,n).exists((function(e){var n=p(e)?e:ye(e);return q(n,t)}))}))}))}(e,r);return e.formatter.matchNode(t,r,{},o)?n.concat([r]):n}),[])},ih=function(e){return function(e){for(var t=[];e;){if(3===e.nodeType&&"\ufeff"!==e.nodeValue||e.childNodes.length>1)return[];1===e.nodeType&&t.push(e),e=e.firstChild}return t}(e).length>0},uh=function(e){if(e){var t=new Qr(e,e);for(e=t.current();e;e=t.next())if(_n(e))return e}return null},ah=function(e){var t=Ct.fromTag("span");return qn(t,{id:"_mce_caret","data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&rn(t,Ct.fromText("\ufeff")),t},ch=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,o=e.selection;if(ih(t))ep(e,!1,Ct.fromDom(t),n);else{var i=o.getRng(),u=r.getParent(t,r.isBlock),a=i.startContainer,c=i.startOffset,f=i.endContainer,l=i.endOffset,s=function(e){var t=uh(e);return t&&"\ufeff"===t.nodeValue.charAt(0)&&t.deleteData(0,1),t}(t);r.remove(t,!0),a===s&&c>0&&i.setStart(s,c-1),f===s&&l>0&&i.setEnd(s,l-1),u&&r.isEmpty(u)&&ag(Ct.fromDom(u)),o.setRng(i)}},fh=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,o=e.selection;if(t)ch(e,t,n);else if(!(t=kl(e.getBody(),o.getStart())))for(;t=r.get("_mce_caret");)ch(e,t,!1)},lh=function(e,t){return e.appendChild(t),t},sh=function(e,t){var n=Y(e,(function(e,t){return lh(e,t.cloneNode(!1))}),t);return lh(n,n.ownerDocument.createTextNode("\ufeff"))},dh=function(e,t,n,r){var o,i,u,a=e.dom,c=e.selection,f=[],l=c.getRng(),s=l.startContainer,d=l.startOffset;for(i=s,3===s.nodeType&&(d!==s.nodeValue.length&&(o=!0),i=i.parentNode);i;){if(th(e,i,t,n,r)){u=i;break}i.nextSibling&&(o=!0),f.push(i),i=i.parentNode}if(u)if(o){var m=c.getBookmark();l.collapse(!0);var g=vs(e,l,e.formatter.get(t),!0);g=ud(g),e.formatter.remove(t,n,g,r),c.moveToBookmark(m)}else{var p=kl(e.getBody(),u),h=ah(!1).dom;!function(e,t,n){var r=e.dom,o=r.getParent(n,_(Vl,e));o&&r.isEmpty(o)?n.parentNode.replaceChild(t,n):(ug(Ct.fromDom(n)),r.isEmpty(n)?n.parentNode.replaceChild(t,n):r.insertAfter(t,n))}(e,h,null!==p?p:u);var v=function(e,t,n,r,o,i){var u=e.formatter,a=e.dom,c=G(se(u.get()),(function(e){return e!==r&&!Fe(e,"removeformat")})),f=oh(e,n,c);if(G(f,(function(t){return!Jl(e,t,r)})).length>0){var l=n.cloneNode(!1);return a.add(t,l),u.remove(r,o,l,i),a.remove(l),F.some(l)}return F.none()}(e,h,u,t,n,r),b=sh(f.concat(v.toArray()),h);ch(e,p,!1),c.setCursorLocation(b,1),a.isEmpty(u)&&a.remove(u)}},mh=function(e){e.on("mouseup keydown",(function(t){!function(e,t){var n=e.selection,r=e.getBody();fh(e,null,!1),8!==t&&46!==t||!n.isCollapsed()||"\ufeff"!==n.getStart().innerHTML||fh(e,kl(r,n.getStart())),37!==t&&39!==t||fh(e,kl(r,n.getStart()))}(e,t.keyCode)}))},gh=function(e,t){var n=e.schema.getTextInlineElements();return we(n,Et(t))&&!Tl(t.dom)&&!kn(t.dom)},ph={},hh=Ne,vh=Te;!function(e,t){ph[e]||(ph[e]=[]),ph[e].push(t)}("pre",(function(e){var t,n=e.selection.getRng(),r=xn(["pre"]);n.collapsed||(t=e.selection.getSelectedBlocks(),vh(hh(hh(t,r),(function(e){return r(e.previousSibling)&&-1!==Ee(t,e.previousSibling)})),(function(e){var t,n;t=e.previousSibling,Gu(n=e).remove(),Gu(t).append("<br><br>").append(n.childNodes)})))}));var bh=bt.each,yh=function(e){return wn(e)&&!Il(e)&&!Tl(e)&&!kn(e)},Ch=function(e,t){for(var n=e;n;n=n[t]){if(_n(n)&&qe(n.data))return e;if(wn(n)&&!Il(n))return n}return e},wh=function(e,t,n){var r=Im(e);if(t&&n&&(t=Ch(t,"previousSibling"),n=Ch(n,"nextSibling"),r.compare(t,n))){for(var o=t.nextSibling;o&&o!==n;){var i=o;o=o.nextSibling,t.appendChild(i)}return e.remove(n),bt.each(bt.grep(n.childNodes),(function(e){t.appendChild(e)})),t}return n},xh=function(e,t,n,r){if(r&&!1!==t.merge_siblings){var o=wh(e,Hl(r),r);wh(e,o,Hl(o,!0))}},Sh=function(e,t,n){bh(e.childNodes,(function(e){yh(e)&&(t(e)&&n(e),e.hasChildNodes()&&Sh(e,t,n))}))},Th=function(e,t){return function(n){return!(!n||!Gl(e,n,t))}},kh=function(e,t,n){return function(r){e.setStyle(r,t,n),""===r.getAttribute("style")&&r.removeAttribute("style"),function(e,t){"SPAN"===t.nodeName&&0===e.getAttribs(t).length&&e.remove(t,!0)}(e,r)}},Nh=pr([{keep:[]},{rename:["name"]},{removed:[]}]),Eh=/^(src|href|style)$/,Rh=bt.each,_h=Kl,Dh=function(e,t,n){return e.isChildOf(t,n)&&t!==n&&!e.isBlock(n)},Ah=function(e,t,n){var r=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"];if(wn(r)){var i=r.childNodes.length-1;!n&&o&&o--,r=r.childNodes[o>i?i:o]}return _n(r)&&n&&o>=r.nodeValue.length&&(r=new Qr(r,e.getBody()).next()||r),_n(r)&&!n&&0===o&&(r=new Qr(r,e.getBody()).prev()||r),r},Oh=function(e,t){var n=t?"firstChild":"lastChild";if(function(e){return/^(TR|TH|TD)$/.test(e.nodeName)}(e)&&e[n]){var r=e[n];return"TR"===e.nodeName&&r[n]||r}return e},Bh=function(e,t,n,r){var o=e.create(n,r);return t.parentNode.insertBefore(o,t),o.appendChild(t),o},Ph=function(e,t,n,r,o){var i=Ct.fromDom(t),u=Ct.fromDom(e.create(r,o)),a=n?zt(i):Ut(i);return on(u,a),n?(en(i,u),nn(u,i)):(tn(i,u),rn(u,i)),u.dom},Lh=function(e,t,n,r){var o=Hl(t,n,r);return y(o)||"BR"===o.nodeName||e.isBlock(o)},Ih=function(e,t,n){var r,o=t.parentNode,i=e.dom,u=Hc(e);Zl(n)&&(u?o===i.getRoot()&&(n.list_block&&_h(t,n.list_block)||$(fe(t.childNodes),(function(t){ql(e,u,t.nodeName.toLowerCase())?r?r.appendChild(t):(r=Bh(i,t,u),i.setAttribs(r,e.settings.forced_root_block_attrs)):r=null}))):i.isBlock(t)&&!i.isBlock(o)&&(Lh(i,t,!1)||Lh(i,t.firstChild,!0,!0)||t.insertBefore(i.create("br"),t.firstChild),Lh(i,t,!0)||Lh(i,t.lastChild,!1,!0)||t.appendChild(i.create("br")))),function(e){return es(e)&&ts(e)&&jn(Ce(e,"mixed"),!0)}(n)&&!_h(n.inline,t)||i.remove(t,!0)},Mh=function(e,t,n,r,o){var i,u=e.dom;if(!function(e,t,n){return!(!ts(n)||!_h(t,n.inline))||(!(!Zl(n)||!_h(t,n.block))||(es(n)?wn(t)&&e.is(t,n.selector):void 0))}(u,r,t)&&!function(e,t){return t.links&&"A"===e.nodeName}(r,t))return Nh.keep();var a=r;if(ts(t)&&"all"===t.remove&&p(t.preserve_attributes)){var c=G(u.getAttribs(a),(function(e){return V(t.preserve_attributes,e.name.toLowerCase())}));if(u.removeAllAttribs(a),$(c,(function(e){return u.setAttrib(a,e.name,e.value)})),c.length>0)return Nh.rename("span")}if("all"!==t.remove){Rh(t.styles,(function(e,r){e=Xl(u,$l(e,n),r+""),x(r)&&(r=e,o=null),(t.remove_similar||!o||_h(Gl(u,o,r),e))&&u.setStyle(a,r,""),i=!0})),i&&""===u.getAttrib(a,"style")&&(a.removeAttribute("style"),a.removeAttribute("data-mce-style")),Rh(t.attributes,(function(e,r){var i;if(e=$l(e,n),x(r)&&(r=e,o=null),t.remove_similar||!o||_h(u.getAttrib(o,r),e)){if("class"===r&&(e=u.getAttrib(a,r))&&(i="",$(e.split(/\s+/),(function(e){/mce\-\w+/.test(e)&&(i+=(i?" ":"")+e)})),i))return void u.setAttrib(a,r,i);if(Eh.test(r)&&a.removeAttribute("data-mce-"+r),"style"===r&&xn(["li"])(a)&&"none"===u.getStyle(a,"list-style-type"))return a.removeAttribute(r),void u.setStyle(a,"list-style-type","none");"class"===r&&a.removeAttribute("className"),a.removeAttribute(r)}})),Rh(t.classes,(function(e){e=$l(e,n),o&&!u.hasClass(o,e)||u.removeClass(a,e)}));for(var f=u.getAttribs(a),l=0;l<f.length;l++){var s=f[l].nodeName;if(0!==s.indexOf("_")&&0!==s.indexOf("data-"))return Nh.keep()}}return"none"!==t.remove?(Ih(e,a,t),Nh.removed()):Nh.keep()},Fh=function(e,t,n,r,o){return Mh(e,t,n,r,o).fold(B,(function(t){return e.dom.rename(r,t),!0}),P)},jh=function(e,t,n,r){return Mh(e,t,n,r,r).fold(N(r),(function(t){return e.dom.createFragment().appendChild(r),e.dom.rename(r,t)}),N(null))},Uh=function(e,t,n,r,o){var i=e.formatter.get(t),u=i[0],a=!0,c=e.dom,f=e.selection,l=function(r){var a=function(e,t,n,r,o){var i;return $(Ql(e.dom,t.parentNode).reverse(),(function(t){if(!i&&"_start"!==t.id&&"_end"!==t.id){var u=th(e,t,n,r,o);u&&!1!==u.split&&(i=t)}})),i}(e,r,t,n,o);return function(e,t,n,r,o,i,u,a){var c,f,l,s=e.dom;if(n){for(var d=n.parentNode,m=r.parentNode;m&&m!==d;m=m.parentNode){c=s.clone(m,!1);for(var g=0;g<t.length&&null!==(c=jh(e,t[g],a,c));g++);c&&(f&&c.appendChild(f),l||(l=c),f=c)}!i||u.mixed&&s.isBlock(n)||(r=s.split(n,r)),f&&(o.parentNode.insertBefore(f,o),l.appendChild(o),ts(u)&&xh(s,u,0,f))}return r}(e,i,a,r,r,!0,u,n)},s=function(t){return q(i,(function(r){return Fh(e,r,n,t,t)}))},d=function(t){var n=!0,r=!1;wn(t)&&c.getContentEditable(t)&&(n=a,a="true"===c.getContentEditable(t),r=!0);var o=fe(t.childNodes);if(a&&!r){var f=s(t)||q(i,(function(e){return Zp(c,t,e)})),l=t.parentNode;!f&&C(l)&&ns(u)&&s(l)}if(u.deep&&o.length){for(var m=0;m<o.length;m++)d(o[m]);r&&(a=n)}$(["underline","line-through","overline"],(function(n){wn(t)&&e.dom.getStyle(t,"text-decoration")===n&&t.parentNode&&Yl(c,t.parentNode)===n&&Fh(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},null,t)}))},m=function(e){var t=c.get(e?"_start":"_end"),n=t[e?"firstChild":"lastChild"];return function(e){return Il(e)&&wn(e)&&("_start"===e.id||"_end"===e.id)}(n)&&(n=n[e?"firstChild":"lastChild"]),_n(n)&&0===n.data.length&&(n=e?t.previousSibling||t.nextSibling:t.nextSibling||t.previousSibling),c.remove(t,!0),n},g=function(t){var n,r,o=vs(e,t,i,t.collapsed);if(u.split){if(o=ud(o),(n=Ah(e,o,!0))!==(r=Ah(e,o))){if(n=Oh(n,!0),r=Oh(r,!1),Dh(c,n,r)){var a=F.from(n.firstChild).getOr(n);return l(Ph(c,a,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void m(!0)}if(Dh(c,r,n)){a=F.from(r.lastChild).getOr(r);return l(Ph(c,a,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void m(!1)}n=Bh(c,n,"span",{id:"_start","data-mce-type":"bookmark"}),r=Bh(c,r,"span",{id:"_end","data-mce-type":"bookmark"});var f=c.createRng();f.setStartAfter(n),f.setEndBefore(r),bs(c,f,(function(e){$(e,(function(e){Il(e)||Il(e.parentNode)||l(e)}))})),l(n),l(r),n=m(!0),r=m()}else n=r=l(n);o.startContainer=n.parentNode?n.parentNode:n,o.startOffset=c.nodeIndex(n),o.endContainer=r.parentNode?r.parentNode:r,o.endOffset=c.nodeIndex(r)+1}bs(c,o,(function(e){$(e,d)}))};if(r){if(Ul(r)){var p=c.createRng();p.setStartBefore(r),p.setEndAfter(r),g(p)}else g(r);Vs(e,t,r,n)}else if("false"!==c.getContentEditable(f.getNode()))f.isCollapsed()&&ts(u)&&!xs(e).length?dh(e,t,n,o):(Ds(f,!0,(function(){_s(e,g)})),ts(u)&&nh(e,t,n,f.getStart())&&zl(c,f,f.getRng()),e.nodeChanged()),Vs(e,t,r,n);else{r=f.getNode();for(var h=0;h<i.length&&(!i[h].ceFalseOverride||!Fh(e,i[h],n,r,r));h++);Vs(e,t,r,n)}},zh=bt.each,Hh=function(e,t,n,r){zh(t,(function(t){ts(t)&&zh(e.dom.select(t.inline,r),(function(r){yh(r)&&Fh(e,t,n,r,t.exact?r:null)})),function(e,t,n){if(t.clear_child_styles){var r=t.links?"*:not(a)":"*";bh(e.select(r,n),(function(n){yh(n)&&bh(t.styles,(function(t,r){e.setStyle(n,r,"")}))}))}}(e.dom,t,r)}))},Vh=bt.each,qh=function(e){return wn(e)&&!Il(e)&&!Tl(e)&&!kn(e)},Wh=function(e,t,n,r){var o=e.formatter.get(t),i=o[0],u=!r&&e.selection.isCollapsed(),a=e.dom,c=e.selection,f=function(e,t){if(void 0===t&&(t=i),w(t.onformat)&&t.onformat(e,t,n,r),Vh(t.styles,(function(t,r){a.setStyle(e,r,$l(t,n))})),t.styles){var o=a.getAttrib(e,"style");o&&a.setAttrib(e,"data-mce-style",o)}Vh(t.attributes,(function(t,r){a.setAttrib(e,r,$l(t,n))})),Vh(t.classes,(function(t){t=$l(t,n),a.hasClass(e,t)||a.addClass(e,t)}))},l=function(e,t){var n=!1;return Vh(e,(function(e){return!!es(e)&&(C(e.collapsed)&&e.collapsed!==u?void 0:a.is(t,e.selector)&&!Tl(t)?(f(t,e),n=!0,!1):void 0)})),n},s=function(e){if(m(e)){var t=a.create(e);return f(t),t}return null},d=function(r,u,a){var c=[],d=!0,m=i.inline||i.block,g=s(m);bs(r,u,(function(u){var s,p=function(u){var h=!1,v=d,b=u.nodeName.toLowerCase(),y=u.parentNode,w=y.nodeName.toLowerCase();if(wn(u)&&r.getContentEditable(u)&&(v=d,d="true"===r.getContentEditable(u),h=!0),Bn(u)&&!function(e,t,n,r){if(function(e){return e.getParam("format_empty_lines",!1,"boolean")}(e)&&ts(t)){var o=Ae(Ae({},e.schema.getTextBlockElements()),{td:{},th:{},li:{},dt:{},dd:{},figcaption:{},caption:{},details:{},summary:{}}),i=Kp(Ct.fromDom(n),(function(e){return Tl(e.dom)}));return xe(o,r)&&Vo(Ct.fromDom(n.parentNode),!1)&&!i}return!1}(e,i,u,w))return s=null,void(Zl(i)&&r.remove(u));if(Zl(i)&&i.wrapper&&th(e,u,t,n))s=null;else{if(d&&!h&&Zl(i)&&!i.wrapper&&Vl(e,b)&&ql(e,w,m)){var x=r.rename(u,m);return f(x),c.push(x),void(s=null)}if(es(i)){var S=l(o,u);if(!S&&C(y)&&ns(i)&&(S=l(o,y)),!ts(i)||S)return void(s=null)}!d||h||!ql(e,m,b)||!ql(e,w,m)||!a&&_n(u)&&fo(u.data)||Tl(u)||ts(i)&&r.isBlock(u)?(s=null,$(fe(u.childNodes),p),h&&(d=v),s=null):(s||(s=r.clone(g,!1),u.parentNode.insertBefore(s,u),c.push(s)),s.appendChild(u))}};$(u,p)})),!0===i.links&&$(c,(function(e){var t=function(e){"A"===e.nodeName&&f(e,i),$(fe(e.childNodes),t)};t(e)})),$(c,(function(u){var a=function(e){var t=0;return $(e.childNodes,(function(e){(function(e){return C(e)&&_n(e)&&0===e.length})(e)||Il(e)||t++})),t}(u);!(c.length>1)&&r.isBlock(u)||0!==a?(ts(i)||Zl(i)&&i.wrapper)&&(i.exact||1!==a||(u=function(e){return Z(e.childNodes,qh).filter((function(e){return Zp(r,e,i)})).map((function(t){var n=r.clone(t,!1);return f(n),r.replace(n,e,!0),r.remove(t,!0),n})).getOr(e)}(u)),Hh(e,o,n,u),function(e,t,n,r,o){th(e,o.parentNode,n,r)&&Fh(e,t,r,o)||t.merge_with_parents&&e.dom.getParent(o.parentNode,(function(i){if(th(e,i,n,r))return Fh(e,t,r,o),!0}))}(e,i,t,n,u),function(e,t,n,r){t.styles&&t.styles.backgroundColor&&Sh(r,Th(e,"fontSize"),kh(e,"backgroundColor",$l(t.styles.backgroundColor,n)))}(r,i,n,u),function(e,t,n,r){var o=function(t){if(1===t.nodeType&&t.parentNode&&1===t.parentNode.nodeType){var n=Yl(e,t.parentNode);e.getStyle(t,"color")&&n?e.setStyle(t,"text-decoration",n):e.getStyle(t,"text-decoration")===n&&e.setStyle(t,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(bt.walk(r,o,"childNodes"),o(r))}(r,i,0,u),function(e,t,n,r){!ts(t)||"sub"!==t.inline&&"sup"!==t.inline||(Sh(r,Th(e,"fontSize"),kh(e,"fontSize","")),e.remove(e.select("sup"===t.inline?"sub":"sup",r),!0))}(r,i,0,u),xh(r,i,0,u)):r.remove(u,!0)}))};if("false"!==a.getContentEditable(c.getNode())){if(i){if(r)if(Ul(r)){if(!l(o,r)){var g=a.createRng();g.setStartBefore(r),g.setEndAfter(r),d(a,vs(e,g,o),!0)}}else d(a,r,!0);else if(u&&ts(i)&&!xs(e).length)!function(e,t,n){var r,o,i=e.selection,u=i.getRng(),a=u.startOffset,c=u.startContainer.nodeValue;(r=kl(e.getBody(),i.getStart()))&&(o=uh(r));var f,l,s=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(c&&a>0&&a<c.length&&s.test(c.charAt(a))&&s.test(c.charAt(a-1))){var d=i.getBookmark();u.collapse(!0);var m=vs(e,u,e.formatter.get(t));m=ud(m),e.formatter.apply(t,n,m),i.moveToBookmark(d)}else r&&"\ufeff"===o.nodeValue||(f=e.getDoc(),l=ah(!0).dom,o=(r=f.importNode(l,!0)).firstChild,u.insertNode(r),a=1),e.formatter.apply(t,n,r),i.setCursorLocation(o,a)}(e,t,n);else{var p=c.getNode(),h=o[0];e.settings.forced_root_block||!h.defaultBlock||a.getParent(p,a.isBlock)||Wh(e,h.defaultBlock),c.setRng(Op(c.getRng())),Ds(c,!0,(function(){_s(e,(function(t,n){var r=n?t:vs(e,t,o);d(a,r,!1)}))})),zl(a,c,c.getRng()),e.nodeChanged()}!function(e,t){vh(ph[e],(function(e){e(t)}))}(t,e)}Hs(e,t,r,n)}else{r=c.getNode();for(var v=0,b=o.length;v<b;v++){var y=o[v];if(y.ceFalseOverride&&es(y)&&a.is(r,y.selector)){f(r,y);break}}Hs(e,t,r,n)}},$h=function(e){return we(e,"vars")},Kh=function(e){return e.selection.getStart()},Xh=function(e,t,n,r,o){return J(t,(function(t){var i=e.formatter.matchNode(t,n,null!=o?o:{},r);return!b(i)}),(function(t){return!!Qp(e,t,n)||!r&&C(e.formatter.matchNode(t,n,o,!0))}))},Gh=function(e,t){var n=null!=t?t:Kh(e);return G(Ql(e.dom,n),(function(e){return wn(e)&&!kn(e)}))},Yh=function(e,t,n){var r=Gh(e,t);me(n,(function(n,o){var i=function(n){var i=Xh(e,r,o,n.similar,$h(n)?n.vars:void 0),u=i.isSome();if(n.state.get()!==u){n.state.set(u);var a=i.getOr(t);$h(n)?n.callback(u,{node:a,format:o,parents:r}):$(n.callbacks,(function(e){return e(u,{node:a,format:o,parents:r})}))}};$([n.withSimilar,n.withoutSimilar],i),$(n.withVars,i)}))},Qh=function(e,t,n,r,o,i){return null===t.get()&&function(e,t){e.set({}),t.on("NodeChange",(function(n){Yh(t,n.element,e.get())})),t.on("FormatApply FormatRemove",(function(n){var r=F.from(n.node).map((function(e){return Ul(e)?e:e.startContainer})).bind((function(e){return wn(e)?F.some(e):F.from(e.parentElement)})).getOrThunk((function(){return Kh(t)}));Yh(t,r,e.get())}))}(t,e),function(e,t,n,r,o,i){var u=t.get();$(n.split(","),(function(t){var n=Ce(u,t).getOrThunk((function(){var e={withSimilar:{state:aa(!1),similar:!0,callbacks:[]},withoutSimilar:{state:aa(!1),similar:!1,callbacks:[]},withVars:[]};return u[t]=e,e})),a=function(){var n=Gh(e);return Xh(e,n,t,o,i).isSome()};if(b(i)){var c=o?n.withSimilar:n.withoutSimilar;c.callbacks.push(r),1===c.callbacks.length&&c.state.set(a())}else n.withVars.push({state:aa(a()),similar:o,vars:i,callback:r})})),t.set(u)}(e,t,n,r,o,i),{unbind:function(){return function(e,t,n){var r=e.get();$(t.split(","),(function(e){return Ce(r,e).each((function(t){r[e]={withSimilar:Ae(Ae({},t.withSimilar),{callbacks:G(t.withSimilar.callbacks,(function(e){return e!==n}))}),withoutSimilar:Ae(Ae({},t.withoutSimilar),{callbacks:G(t.withoutSimilar.callbacks,(function(e){return e!==n}))}),withVars:G(t.withVars,(function(e){return e.callback!==n}))}}))})),e.set(r)}(t,n,r)}}},Jh=function(e,t){var n=(t||document).createDocumentFragment();return $(e,(function(e){n.appendChild(e.dom)})),Ct.fromDom(n)},Zh=function(e,t,n){return{element:e,width:t,rows:n}},ev=function(e,t){return{element:e,cells:t}},tv=function(e,t){return{x:e,y:t}},nv=function(e,t){var n=parseInt(Wn(e,t),10);return isNaN(n)?1:n},rv=function(e,t,n){var r=e.rows;return!!(r[n]?r[n].cells:[])[t]},ov=function(e){return Q(e,(function(e,t){return t.cells.length>e?t.cells.length:e}),0)},iv=function(e,t){for(var n=e.rows,r=0;r<n.length;r++)for(var o=n[r].cells,i=0;i<o.length;i++)if(Tt(o[i],t))return F.some(tv(i,r));return F.none()},uv=function(e,t,n,r,o){for(var i=[],u=e.rows,a=n;a<=o;a++){var c=u[a].cells,f=t<r?c.slice(t,r+1):c.slice(r,t+1);i.push(ev(u[a].element,f))}return i},av=function(e){var t=Zh(Ia(e),0,[]);return $(Ta(e,"tr"),(function(e,n){$(Ta(e,"td,th"),(function(r,o){!function(e,t,n,r,o){for(var i=nv(o,"rowspan"),u=nv(o,"colspan"),a=e.rows,c=n;c<n+i;c++){a[c]||(a[c]=ev(Ma(r),[]));for(var f=t;f<t+u;f++){a[c].cells[f]=c===n&&f===t?o:Ia(o)}}}(t,function(e,t,n){for(;rv(e,t,n);)t++;return t}(t,o,n),n,e,r)}))})),Zh(t.element,ov(t.rows),t.rows)},cv=function(e){return function(e,t){var n=Ia(e.element),r=Ct.fromTag("tbody");return on(r,t),rn(n,r),n}(e,function(e){return W(e.rows,(function(e){var t=W(e.cells,(function(e){var t=Ma(e);return Kn(t,"colspan"),Kn(t,"rowspan"),t})),n=Ia(e.element);return on(n,t),n}))}(e))},fv=function(e,t,n){return iv(e,t).bind((function(t){return iv(e,n).map((function(n){return function(e,t,n){var r=t.x,o=t.y,i=n.x,u=n.y,a=o<u?uv(e,r,o,i,u):uv(e,r,u,i,o);return Zh(e.element,ov(a),a)}(e,t,n)}))}))},lv=function(e,t){return Z(e,(function(e){return"li"===Et(e)&&Ns(e,t)})).fold(N([]),(function(t){return function(e){return Z(e,(function(e){return"ul"===Et(e)||"ol"===Et(e)}))}(e).map((function(e){var t=Ct.fromTag(Et(e)),n=be(Jn(e),(function(e,t){return je(t,"list-style")}));return Xn(t,n),[Ct.fromTag("li"),t]})).getOr([])}))},sv=function(e,t){var n=Ct.fromDom(t.commonAncestorContainer),r=sg(n,e),o=G(r,(function(e){return to(e)||Zr(e)})),i=lv(r,t),u=o.concat(i.length?i:function(e){return io(e)?Mt(e).filter(oo).fold(N([]),(function(t){return[e,t]})):oo(e)?[e]:[]}(n));return W(u,Ia)},dv=function(){return Jh([])},mv=function(e,t){return n=Ct.fromDom(t.cloneContents()),r=sv(e,t),o=Q(r,(function(e,t){return rn(t,e),t}),n),r.length>0?Jh([o]):o;var n,r,o},gv=function(e,t){return(n=e,r=t[0],zr(r,"table",_(Tt,n))).bind((function(e){var n=t[0],r=t[t.length-1],o=av(e);return fv(o,n,r).map((function(e){return Jh([cv(e)])}))})).getOrThunk(dv);var n,r},pv=function(e,t){var n=ws(t,e);return n.length>0?gv(e,n):function(e,t){return t.length>0&&t[0].collapsed?dv():mv(e,t[0])}(e,t)},hv=function(e,t){return t>=0&&t<e.length&&Fl(e.charAt(t))},vv=function(e,t){var n=lo(e.innerText);return t?function(e){return e.replace(/^[ \f\n\r\t\v]+/,"")}(n):n},bv=function(e,t,n){void 0===n&&(n={});var r=function(e,t){return Ae(Ae({},e),{format:t,get:!0,selection:!0})}(n,t),o=e.fire("BeforeGetContent",r);if(o.isDefaultPrevented())return e.fire("GetContent",o),o.content;if("text"===o.format)return function(e){return F.from(e.selection.getRng()).map((function(t){var n=F.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),r=e.getBody(),o=function(e){return e.map((function(e){return e.nodeName})).getOr("div").toLowerCase()}(n),i=mt.browser.isIE()&&"pre"!==o,u=e.dom.add(r,o,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},t.cloneContents()),a=vv(u,i),c=lo(u.textContent);if(e.dom.remove(u),hv(c,0)||hv(c,c.length-1)){var f=n.getOr(r),l=vv(f,i),s=l.indexOf(a);return-1===s?a:(hv(l,s-1)?" ":"")+a+(hv(l,s+a.length)?" ":"")}return a})).getOr("")}(e);o.getInner=!0;var i=function(e,t){var n=e.selection.getRng(),r=e.dom.create("body"),o=e.selection.getSel(),i=mm(e,ys(o)),u=t.contextual?pv(Ct.fromDom(e.getBody()),i).dom:n.cloneContents();return u&&r.appendChild(u),e.selection.serializer.serialize(r,t)}(e,o);return"tree"===o.format?i:(o.content=e.selection.isCollapsed()?"":i,e.fire("GetContent",o),o.content)},yv=function(e){return wn(e)?e.outerHTML:_n(e)?ai.encodeRaw(e.data,!1):Dn(e)?"\x3c!--"+e.data+"--\x3e":""},Cv=function(e,t,n){var r=function(e){var t,n=document.createElement("div"),r=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)r.appendChild(t);return r}(t);if(e.hasChildNodes()&&n<e.childNodes.length){var o=e.childNodes[n];o.parentNode.insertBefore(r,o)}else e.appendChild(r)},wv=function(e,t){var n,r,o,i,u,a,c,f,l,s=W(fe(t.childNodes),yv);return function(e,t){var n=0;$(e,(function(e){0===e[0]?n++:1===e[0]?(Cv(t,e[1],n),n++):2===e[0]&&function(e,t){if(e.hasChildNodes()&&t<e.childNodes.length){var n=e.childNodes[t];n.parentNode.removeChild(n)}}(t,n)}))}((r=e,o=(n=s).length+r.length+2,i=new Array(o),u=new Array(o),a=function(e,t,o,i,u){var c=f(e,t,o,i);if(null===c||c.start===t&&c.diag===t-i||c.end===e&&c.diag===e-o)for(var l=e,s=o;l<t||s<i;)l<t&&s<i&&n[l]===r[s]?(u.push([0,n[l]]),++l,++s):t-e>i-o?(u.push([2,n[l]]),++l):(u.push([1,r[s]]),++s);else{a(e,c.start,o,c.start-c.diag,u);for(var d=c.start;d<c.end;++d)u.push([0,n[d]]);a(c.end,t,c.end-c.diag,i,u)}},c=function(e,t,o,i){for(var u=e;u-t<i&&u<o&&n[u]===r[u-t];)++u;return function(e,t,n){return{start:e,end:t,diag:n}}(e,u,t)},f=function(e,t,o,a){var f=t-e,l=a-o;if(0===f||0===l)return null;var s,d,m,g,p,h=f-l,v=l+f,b=(v%2==0?v:v+1)/2;for(i[1+b]=e,u[1+b]=t+1,s=0;s<=b;++s){for(d=-s;d<=s;d+=2){for(m=d+b,d===-s||d!==s&&i[m-1]<i[m+1]?i[m]=i[m+1]:i[m]=i[m-1]+1,p=(g=i[m])-e+o-d;g<t&&p<a&&n[g]===r[p];)i[m]=++g,++p;if(h%2!=0&&h-s<=d&&d<=h+s&&u[m-h]<=i[m])return c(u[m-h],d+e-o,t,a)}for(d=h-s;d<=h+s;d+=2){for(m=d+b-h,d===h-s||d!==h+s&&u[m+1]<=u[m-1]?u[m]=u[m+1]-1:u[m]=u[m-1],p=(g=u[m]-1)-e+o-d;g>=e&&p>=o&&n[g]===r[p];)u[m]=g--,p--;if(h%2==0&&-s<=d&&d<=s&&u[m]<=i[m+h])return c(u[m],d+e-o,t,a)}}},l=[],a(0,n.length,0,r.length,l),l),t),t},xv=Be((function(){return document.implementation.createHTMLDocument("undo")})),Sv=function(e){var t,n=(t=e.getBody(),G(W(fe(t.childNodes),yv),(function(e){return e.length>0}))),r=te(n,(function(t){var n=Om(e.serializer,t);return n.length>0?[n]:[]})),o=r.join("");return-1!==o.indexOf("</iframe>")?function(e){return{type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}}(r):function(e){return{type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}}(o)},Tv=function(e,t,n){var r=n?t.beforeBookmark:t.bookmark;"fragmented"===t.type?wv(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:!C(r)||!Nl(r)||!r.isFakeCaret}),e.selection.moveToBookmark(r)},kv=function(e){return"fragmented"===e.type?e.fragments.join(""):e.content},Nv=function(e){var t=Ct.fromTag("body",xv());return Pa(t,kv(e)),$(Ta(t,"*[data-mce-bogus]"),cn),t.dom.innerHTML},Ev=function(e,t){return!(!e||!t)&&(!!function(e,t){return kv(e)===kv(t)}(e,t)||function(e,t){return Nv(e)===Nv(t)}(e,t))},Rv=function(e){return 0===e.get()},_v=function(e,t,n){Rv(n)&&(e.typing=t)},Dv=function(e,t){e.typing&&(_v(e,!1,t),e.add())},Av=function(e){return{undoManager:{beforeChange:function(t,n){return function(e,t,n){Rv(t)&&n.set(Fc(e.selection))}(e,t,n)},add:function(t,n,r,o,i,u){return function(e,t,n,r,o,i,u){var a=Sv(e);if(i=i||{},i=bt.extend(i,a),!1===Rv(r)||e.removed)return null;var c=t.data[n.get()];if(e.fire("BeforeAddUndo",{level:i,lastLevel:c,originalEvent:u}).isDefaultPrevented())return null;if(c&&Ev(c,i))return null;t.data[n.get()]&&o.get().each((function(e){t.data[n.get()].beforeBookmark=e}));var f=function(e){return e.getParam("custom_undo_redo_levels",0,"number")}(e);if(f&&t.data.length>f){for(var l=0;l<t.data.length-1;l++)t.data[l]=t.data[l+1];t.data.length--,n.set(t.data.length)}i.bookmark=Fc(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(i),n.set(t.data.length-1);var s={level:i,lastLevel:c,originalEvent:u};return n.get()>0?(e.setDirty(!0),e.fire("AddUndo",s),e.fire("change",s)):e.fire("AddUndo",s),i}(e,t,n,r,o,i,u)},undo:function(t,n,r){return function(e,t,n,r){var o;return t.typing&&(t.add(),t.typing=!1,_v(t,!1,n)),r.get()>0&&(r.set(r.get()-1),o=t.data[r.get()],Tv(e,o,!0),e.setDirty(!0),e.fire("Undo",{level:o})),o}(e,t,n,r)},redo:function(t,n){return function(e,t,n){var r;return t.get()<n.length-1&&(t.set(t.get()+1),r=n[t.get()],Tv(e,r,!1),e.setDirty(!0),e.fire("Redo",{level:r})),r}(e,t,n)},clear:function(t,n){return function(e,t,n){t.data=[],n.set(0),t.typing=!1,e.fire("ClearUndos")}(e,t,n)},reset:function(e){return function(e){e.clear(),e.add()}(e)},hasUndo:function(t,n){return function(e,t,n){return n.get()>0||t.typing&&t.data[0]&&!Ev(Sv(e),t.data[0])}(e,t,n)},hasRedo:function(e,t){return function(e,t){return t.get()<e.data.length-1&&!e.typing}(e,t)},transact:function(e,t,n){return function(e,t,n){return Dv(e,t),e.beforeChange(),e.ignore(n),e.add()}(e,t,n)},ignore:function(e,t){return function(e,t){try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}}(e,t)},extra:function(t,n,r,o){return function(e,t,n,r,o){if(t.transact(r)){var i=t.data[n.get()].bookmark,u=t.data[n.get()-1];Tv(e,u,!0),t.transact(o)&&(t.data[n.get()-1].beforeBookmark=i)}}(e,t,n,r,o)}},formatter:{match:function(t,n,r,o){return nh(e,t,n,r,o)},matchAll:function(t,n){return function(e,t,n){var r=[],o={},i=e.selection.getStart();return e.dom.getParent(i,(function(i){for(var u=0;u<t.length;u++){var a=t[u];!o[a]&&th(e,i,a,n)&&(o[a]=!0,r.push(a))}}),e.dom.getRoot()),r}(e,t,n)},matchNode:function(t,n,r,o){return th(e,t,n,r,o)},canApply:function(t){return function(e,t){var n=e.formatter.get(t),r=e.dom;if(n)for(var o=e.selection.getStart(),i=Ql(r,o),u=n.length-1;u>=0;u--){var a=n[u];if(!es(a)||C(a.defaultBlock))return!0;for(var c=i.length-1;c>=0;c--)if(r.is(i[c],a.selector))return!0}return!1}(e,t)},closest:function(t){return rh(e,t)},apply:function(t,n,r){return Wh(e,t,n,r)},remove:function(t,n,r,o){return Uh(e,t,n,r,o)},toggle:function(t,n,r){return function(e,t,n,r){var o=e.formatter.get(t);!nh(e,t,n,r)||"toggle"in o[0]&&!o[0].toggle?Wh(e,t,n,r):Uh(e,t,n,r)}(e,t,n,r)},formatChanged:function(t,n,r,o,i){return Qh(e,t,n,r,o,i)}},editor:{getContent:function(t,n){return function(e,t,n){return F.from(e.getBody()).fold(N("tree"===t.format?new bm("body",11):""),(function(r){return Pm(e,t,n,r)}))}(e,t,n)},setContent:function(t,n){return $p(e,t,n)},insertContent:function(t,n){return zp(e,t,n)},addVisual:function(t){return function(e,t){var n=e.dom,r=C(t)?t:e.getBody();b(e.hasVisual)&&(e.hasVisual=function(e){return e.getParam("visual",!0,"boolean")}(e)),$(n.select("table,a",r),(function(t){switch(t.nodeName){case"TABLE":var r=function(e){return e.getParam("visual_table_class","mce-item-table","string")}(e),o=n.getAttrib(t,"border");o&&"0"!==o||!e.hasVisual?n.removeClass(t,r):n.addClass(t,r);break;case"A":if(!n.getAttrib(t,"href")){var i=n.getAttrib(t,"name")||t.id,u=function(e){return e.getParam("visual_anchor_class","mce-item-anchor","string")}(e);i&&e.hasVisual?n.addClass(t,u):n.removeClass(t,u)}}})),e.fire("VisualAid",{element:t,hasVisual:e.hasVisual})}(e,t)}},selection:{getContent:function(t,n){return bv(e,t,n)}},raw:{getModel:function(){return F.none()}}}},Ov=function(e){return we(e.plugins,"rtc")},Bv=function(e){var t=e;return function(e){return Ce(e.plugins,"rtc").bind((function(e){return F.from(e.setup)}))}(e).fold((function(){return t.rtcInstance=Av(e),F.none()}),(function(e){return t.rtcInstance=function(){var e=N(null),t=N("");return{undoManager:{beforeChange:S,add:e,undo:e,redo:e,clear:S,reset:S,hasUndo:B,hasRedo:B,transact:e,ignore:S,extra:S},formatter:{match:B,matchAll:N([]),matchNode:N(void 0),canApply:B,closest:t,apply:S,remove:S,toggle:S,formatChanged:N({unbind:S})},editor:{getContent:t,setContent:t,insertContent:S,addVisual:S},selection:{getContent:t},raw:{getModel:N(F.none())}}}(),F.some((function(){return e().then((function(e){return t.rtcInstance=function(e){var t=function(e){return g(e)?e:{}},n=e.undoManager,r=e.formatter,o=e.editor,i=e.selection,u=e.raw;return{undoManager:{beforeChange:n.beforeChange,add:n.add,undo:n.undo,redo:n.redo,clear:n.clear,reset:n.reset,hasUndo:n.hasUndo,hasRedo:n.hasRedo,transact:function(e,t,r){return n.transact(r)},ignore:function(e,t){return n.ignore(t)},extra:function(e,t,r,o){return n.extra(r,o)}},formatter:{match:function(e,n,o,i){return r.match(e,t(n),i)},matchAll:r.matchAll,matchNode:r.matchNode,canApply:function(e){return r.canApply(e)},closest:function(e){return r.closest(e)},apply:function(e,n,o){return r.apply(e,t(n))},remove:function(e,n,o,i){return r.remove(e,t(n))},toggle:function(e,n,o){return r.toggle(e,t(n))},formatChanged:function(e,t,n,o,i){return r.formatChanged(t,n,o,i)}},editor:{getContent:function(e,t){return o.getContent(e)},setContent:function(e,t){return o.setContent(e,t)},insertContent:function(e,t){return o.insertContent(e)},addVisual:o.addVisual},selection:{getContent:function(e,t){return i.getContent(t)}},raw:{getModel:function(){return F.some(u.getRawModel())}}}}(e),e.rtc.isRemote}))}))}))},Pv=function(e){return e.rtcInstance?e.rtcInstance:Av(e)},Lv=function(e){var t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},Iv=function(e,t){return void 0===t&&(t={}),function(e,t,n){return Lv(e).selection.getContent(t,n)}(e,t.format?t.format:"html",t)},Mv=function(e){return 0===e.dom.length?(an(e),F.none()):F.some(e)},Fv=function(e,t,n,r){e.bind((function(e){return(r?Hg:zg)(e.dom,r?e.dom.length:0),t.filter(At).map((function(t){return function(e,t,n,r){var o=e.dom,i=t.dom,u=r?o.length:i.length;r?(Vg(o,i,!1,!r),n.setStart(i,u)):(Vg(i,o,!1,!r),n.setEnd(i,u))}(e,t,n,r)}))})).orThunk((function(){return function(e,t){return e.filter((function(e){return Fs.isBookmarkNode(e.dom)})).bind(t?jt:Ft)}(t,r).or(t).filter(At).map((function(e){return function(e,t){Mt(e).each((function(n){var r=e.dom;t&&Og(n,pc(r,0))?zg(r,0):!t&&Bg(n,pc(r,r.length))&&Hg(r,r.length)}))}(e,r)}))}))},jv=function(e,t,n){void 0===n&&(n={});var r=function(e,t){return Ae(Ae({format:"html"},e),{set:!0,selection:!0,content:t})}(n,t),o=r;if(!r.no_events){var i=e.fire("BeforeSetContent",r);if(i.isDefaultPrevented())return void e.fire("SetContent",i);o=i}o.content=function(e,t){if("raw"!==t.format){var n=e.selection.getRng(),r=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=r?{context:r.nodeName.toLowerCase()}:{},i=e.parser.parse(t.content,Ae(Ae({isRootContent:!0,forced_root_block:!1},o),t));return jm({validate:e.validate},e.schema).serialize(i)}return t.content}(e,o);var u=e.selection.getRng();!function(e,t){var n=F.from(t.firstChild).map(Ct.fromDom),r=F.from(t.lastChild).map(Ct.fromDom);e.deleteContents(),e.insertNode(t);var o=n.bind(Ft).filter(At).bind(Mv),i=r.bind(jt).filter(At).bind(Mv);Fv(o,n,e,!0),Fv(i,r,e,!1),e.collapse(!1)}(u,u.createContextualFragment(o.content)),e.selection.setRng(u),_d(e,u),o.no_events||e.fire("SetContent",o)},Uv=function(e,t,n){if(e&&we(e,t)){var r=G(e[t],(function(e){return e!==n}));0===r.length?delete e[t]:e[t]=r}};var zv,Hv,Vv=function(e){return!!e.select},qv=function(e){return!(!e||!e.ownerDocument)&&Nt(Ct.fromDom(e.ownerDocument),Ct.fromDom(e))},Wv=function(e,t,n,r){var o,i,u=function(e,t){var n,r,o=function(t,n){return Z(n,(function(n){return e.is(n,t)}))},i=function(t){return e.getParents(t,null,e.getRoot())};return{selectorChangedWithUnbind:function(e,u){return n||(n={},r={},t.on("NodeChange",(function(e){var t=e.element,u=i(t),a={};bt.each(n,(function(e,t){o(t,u).each((function(n){r[t]||($(e,(function(e){e(!0,{node:n,selector:t,parents:u})})),r[t]=e),a[t]=e}))})),bt.each(r,(function(e,n){a[n]||(delete r[n],bt.each(e,(function(e){e(!1,{node:t,selector:n,parents:u})})))}))}))),n[e]||(n[e]=[]),n[e].push(u),o(e,i(t.selection.getStart())).each((function(){r[e]=n[e]})),{unbind:function(){Uv(n,e,u),Uv(r,e,u)}}}}}(e,r).selectorChangedWithUnbind,a=function(e,t){return jv(r,e,t)},c=function(e){var t=l();t.collapse(!!e),s(t)},f=function(){return t.getSelection?t.getSelection():t.document.selection},l=function(){var n,u,a,c=function(e,t,n){try{return t.compareBoundaryPoints(e,n)}catch(e){return-1}},l=t.document;if(void 0!==r.bookmark&&!1===im(r)){var s=Kd(r);if(s.isSome())return s.map((function(e){return mm(r,[e])[0]})).getOr(l.createRange())}try{(n=f())&&!Cn(n.anchorNode)&&(u=n.rangeCount>0?n.getRangeAt(0):n.createRange?n.createRange():l.createRange(),u=mm(r,[u])[0])}catch(e){}return u||(u=l.createRange?l.createRange():l.body.createTextRange()),u.setStart&&9===u.startContainer.nodeType&&u.collapsed&&(a=e.getRoot(),u.setStart(a,0),u.setEnd(a,0)),o&&i&&(0===c(u.START_TO_START,u,o)&&0===c(u.END_TO_END,u,o)?u=i:(o=null,i=null)),u},s=function(e,t){var n;if(function(e){return!!e&&(!!Vv(e)||qv(e.startContainer)&&qv(e.endContainer))}(e)){var u=Vv(e)?e:null;if(u){i=null;try{u.select()}catch(e){}}else{var a=f();if(e=r.fire("SetSelectionRange",{range:e,forward:t}).range,a){i=e;try{a.removeAllRanges(),a.addRange(e)}catch(e){}!1===t&&a.extend&&(a.collapse(e.endContainer,e.endOffset),a.extend(e.startContainer,e.startOffset)),o=a.rangeCount>0?a.getRangeAt(0):null}e.collapsed||e.startContainer!==e.endContainer||!a.setBaseAndExtent||mt.ie||e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()&&(n=e.startContainer.childNodes[e.startOffset])&&"IMG"===n.tagName&&(a.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),a.anchorNode===e.startContainer&&a.focusNode===e.endContainer||a.setBaseAndExtent(n,0,n,1)),r.fire("AfterSetSelectionRange",{range:e,forward:t})}}},d=function(){var t=f(),n=null==t?void 0:t.anchorNode,r=null==t?void 0:t.focusNode;if(!t||!n||!r||Cn(n)||Cn(r))return!0;var o=e.createRng();o.setStart(n,t.anchorOffset),o.collapse(!0);var i=e.createRng();return i.setStart(r,t.focusOffset),i.collapse(!0),o.compareBoundaryPoints(o.START_TO_START,i)<=0},m={bookmarkManager:null,controlSelection:null,dom:e,win:t,serializer:n,editor:r,collapse:c,setCursorLocation:function(t,n){var o=e.createRng();C(t)&&C(n)?(o.setStart(t,n),o.setEnd(t,n),s(o),c(!1)):(Es(e,o,r.getBody(),!0),s(o))},getContent:function(e){return Iv(r,e)},setContent:a,getBookmark:function(e,t){return g.getBookmark(e,t)},moveToBookmark:function(e){return g.moveToBookmark(e)},select:function(t,n){return function(e,t,n){return F.from(t).map((function(t){var r=e.nodeIndex(t),o=e.createRng();return o.setStart(t.parentNode,r),o.setEnd(t.parentNode,r+1),n&&(Es(e,o,t,!0),Es(e,o,t,!1)),o}))}(e,t,n).each(s),t},isCollapsed:function(){var e=l(),t=f();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},isForward:d,setNode:function(t){return a(e.getOuterHTML(t)),t},getNode:function(){return function(e,t){var n,r,o;if(!t)return e;r=t.startContainer,o=t.endContainer;var i=t.startOffset,u=t.endOffset;return n=t.commonAncestorContainer,!t.collapsed&&(r===o&&u-i<2&&r.hasChildNodes()&&(n=r.childNodes[i]),3===r.nodeType&&3===o.nodeType&&(r=r.length===i?dm(r.nextSibling,!0):r.parentNode,o=0===u?dm(o.previousSibling,!1):o.parentNode,r&&r===o))?r:n&&3===n.nodeType?n.parentNode:n}(r.getBody(),l())},getSel:f,setRng:s,getRng:l,getStart:function(e){return lm(r.getBody(),l(),e)},getEnd:function(e){return sm(r.getBody(),l(),e)},getSelectedBlocks:function(t,n){return function(e,t,n,r){var o,i=[],u=e.getRoot();if(n=e.getParent(n||lm(u,t,t.collapsed),e.isBlock),r=e.getParent(r||sm(u,t,t.collapsed),e.isBlock),n&&n!==u&&i.push(n),n&&r&&n!==r){o=n;for(var a=new Qr(n,u);(o=a.next())&&o!==r;)e.isBlock(o)&&i.push(o)}return r&&n!==r&&r!==u&&i.push(r),i}(e,l(),t,n)},normalize:function(){var t=l(),n=f();if(!(ys(n).length>1)&&Rs(r)){var o=od(e,t);return o.each((function(e){s(e,d())})),o.getOr(t)}return t},selectorChanged:function(e,t){return u(e,t),m},selectorChangedWithUnbind:u,getScrollContainer:function(){for(var t,n=e.getRoot();n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){t=n;break}n=n.parentNode}return t},scrollIntoView:function(e,t){C(e)?function(e,t,n){(e.inline?Nd:Rd)(e,t,n)}(r,e,t):_d(r,l(),t)},placeCaretAt:function(e,t){return s(Xs(e,t,r.getDoc()))},getBoundingClientRect:function(){var e=l();return e.collapsed?pc.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},destroy:function(){t=o=i=null,p.destroy()}},g=Fs(m),p=$s(m,r);return m.bookmarkManager=g,m.controlSelection=p,m},$v=function(e,t,n){e.addNodeFilter("font",(function(e){$(e,(function(e){var r=t.parse(e.attr("style")),o=e.attr("color"),i=e.attr("face"),u=e.attr("size");o&&(r.color=o),i&&(r["font-family"]=i),u&&(r["font-size"]=n[parseInt(e.attr("size"),10)-1]),e.name="span",e.attr("style",t.serialize(r)),function(e,t){$(t,(function(t){e.attr(t,null)}))}(e,["color","face","size"])}))}))},Kv=function(e,t){var n=yi();t.convert_fonts_to_spans&&$v(e,n,bt.explode(t.font_size_legacy_values)),function(e,t){e.addNodeFilter("strike",(function(e){$(e,(function(e){var n=t.parse(e.attr("style"));n["text-decoration"]="line-through",e.name="span",e.attr("style",t.serialize(n))}))}))}(e,n)},Xv=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},Gv=function(e,t){var n;try{n=atob(t)}catch(e){return F.none()}for(var r=new Uint8Array(n.length),o=0;o<r.length;o++)r[o]=n.charCodeAt(o);return F.some(new Blob([r],{type:e}))},Yv=function(e){return 0===e.indexOf("blob:")?function(e){return new qr((function(t,n){var r=function(){n("Cannot convert "+e+" to Blob. Resource might not exist or is inaccessible.")};try{var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){200===o.status?t(o.response):r()},o.onerror=r,o.send()}catch(e){r()}}))}(e):0===e.indexOf("data:")?(t=e,new qr((function(e){var n=Xv(t),r=n.type,o=n.data;Gv(r,o).fold((function(){return e(new Blob([]))}),e)}))):null;var t},Qv=0,Jv=function(e){return(e||"blobid")+Qv++},Zv=function(e,t,n,r){var o,i;if(0!==t.src.indexOf("blob:")){var u=Xv(t.src),a=u.data,c=u.type;o=a,(i=e.getByData(o,c))?n({image:t,blobInfo:i}):Yv(t.src).then((function(r){i=e.create(Jv(),r,o),e.add(i),n({image:t,blobInfo:i})}),(function(e){r(e)}))}else(i=e.getByUri(t.src))?n({image:t,blobInfo:i}):Yv(t.src).then((function(r){(function(e){return new qr((function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}))})(r).then((function(u){o=Xv(u).data,i=e.create(Jv(),r,o),e.add(i),n({image:t,blobInfo:i})}))}),(function(e){r(e)}))},eb=function(e,t){var n={};return{findAll:function(r,o){o||(o=P);var i=G(function(e){return e?fe(e.getElementsByTagName("img")):[]}(r),(function(t){var n=t.src;return!!mt.fileApi&&(!t.hasAttribute("data-mce-bogus")&&(!t.hasAttribute("data-mce-placeholder")&&(!(!n||n===mt.transparentSrc)&&(0===n.indexOf("blob:")?!e.isUploaded(n)&&o(t):0===n.indexOf("data:")&&o(t)))))})),u=W(i,(function(e){if(void 0!==n[e.src])return new qr((function(t){n[e.src].then((function(n){if("string"==typeof n)return n;t({image:e,blobInfo:n.blobInfo})}))}));var r=new qr((function(n,r){Zv(t,e,n,r)})).then((function(e){return delete n[e.image.src],e})).catch((function(t){return delete n[e.src],t}));return n[e.src]=r,r}));return qr.all(u)}}},tb=function(e,t,n,r){(e.padd_empty_with_br||t.insert)&&n[r.name]?r.empty().append(new bm("br",1)).shortEnded=!0:r.empty().append(new bm("#text",3)).value=""},nb=function(e,t){return e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t},rb=function(e,t,n,r){return r.isEmpty(t,n,(function(t){return function(e,t){var n=e.getElementRule(t.name);return n&&n.paddEmpty}(e,t)}))},ob=function(e,t){var n=t.blob_cache,r=function(e){var r=e.attr("src");(function(e){return e.attr("src")===mt.transparentSrc||C(e.attr("data-mce-placeholder"))})(e)||function(e){return C(e.attr("data-mce-bogus"))}(e)||function(e){var t=/data:([^;]+);base64,([a-z0-9\+\/=\s]+)/i.exec(e);return t?F.some({type:t[1],data:decodeURIComponent(t[2])}):F.none()}(r).filter((function(){return function(e,t){if(t.images_dataimg_filter){var n=new Image;return n.src=e.attr("src"),me(e.attributes.map,(function(e,t){n.setAttribute(t,e)})),t.images_dataimg_filter(n)}return!0}(e,t)})).bind((function(e){var t=e.type,r=e.data;return F.from(n.getByData(r,t)).orThunk((function(){return Gv(t,r).map((function(e){var t=n.create(Jv(),e,r);return n.add(t),t}))}))})).each((function(t){e.attr("src",t.blobUri())}))};n&&e.addAttributeFilter("src",(function(e){return $(e,r)}))},ib=bt.makeMap,ub=bt.each,ab=bt.explode,cb=bt.extend,fb=function(e,t){void 0===t&&(t=vi());var n={},r=[],o={},i={};(e=e||{}).validate=!("validate"in e)||e.validate,e.root_name=e.root_name||"body";var u=function(e){var t=e.name;t in n&&((a=o[t])?a.push(e):o[t]=[e]);for(var u=r.length;u--;){var a,c=r[u].name;if(c in e.attributes.map)(a=i[c])?a.push(e):i[c]=[e]}return e},a={schema:t,addAttributeFilter:function(e,t){ub(ab(e),(function(e){var n;for(n=0;n<r.length;n++)if(r[n].name===e)return void r[n].callbacks.push(t);r.push({name:e,callbacks:[t]})}))},getAttributeFilters:function(){return[].concat(r)},addNodeFilter:function(e,t){ub(ab(e),(function(e){var r=n[e];r||(n[e]=r=[]),r.push(t)}))},getNodeFilters:function(){var e=[];for(var t in n)we(n,t)&&e.push({name:t,callbacks:n[t]});return e},filterNode:u,parse:function(a,c){var f,l,s,d,m,g,p,h,v=[];c=c||{},o={},i={};var b=cb(ib("script,style,head,html,body,title,meta,param"),t.getBlockElements()),y=t.getNonEmptyElements(),C=t.children,w=e.validate,x=function(e){return!1===e?"":!0===e?"p":e}("forced_root_block"in c?c.forced_root_block:e.forced_root_block),S=t.getWhiteSpaceElements(),T=/^[ \t\r\n]+/,k=/[ \t\r\n]+$/,N=/[ \t\r\n]+/g,E=/^[ \t\r\n]+$/,R=we(S,c.context)||we(S,e.root_name),_=function(e,t){var r,i=new bm(e,t);return e in n&&((r=o[e])?r.push(i):o[e]=[i]),i},D=function(e){for(var n=t.getBlockElements(),r=e.prev;r&&3===r.type;){var o=r.value.replace(k,"");if(o.length>0)return void(r.value=o);var i=r.next;if(i){if(3===i.type&&i.value.length){r=r.prev;continue}if(!n[i.name]&&"script"!==i.name&&"style"!==i.name){r=r.prev;continue}}var u=r.prev;r.remove(),r=u}},A=Am({validate:w,document:e.document,allow_html_data_urls:e.allow_html_data_urls,allow_svg_data_urls:e.allow_svg_data_urls,allow_script_urls:e.allow_script_urls,allow_conditional_comments:e.allow_conditional_comments,preserve_cdata:e.preserve_cdata,self_closing_elements:function(e){var t={};for(var n in e)"li"!==n&&"p"!==n&&(t[n]=e[n]);return t}(t.getSelfClosingElements()),cdata:function(e){h.append(_("#cdata",4)).value=e},text:function(e,t){var n;R||(e=e.replace(N," "),function(e,t){return e&&(we(t,e.name)||"br"===e.name)}(h.lastChild,b)&&(e=e.replace(T,""))),0!==e.length&&((n=_("#text",3)).raw=!!t,h.append(n).value=e)},comment:function(e){h.append(_("#comment",8)).value=e},pi:function(e,t){h.append(_(e,7)).value=t,D(h)},doctype:function(e){h.append(_("#doctype",10)).value=e,D(h)},start:function(e,n,o){var u=w?t.getElementRule(e):{};if(u){var a=_(u.outputName||e,1);a.attributes=n,a.shortEnded=o,h.append(a);var c=C[h.name];c&&C[a.name]&&!c[a.name]&&v.push(a);for(var f=r.length;f--;){var l=r[f].name;l in n.map&&((g=i[l])?g.push(a):i[l]=[a])}b[e]&&D(a),o||(h=a),!R&&S[e]&&(R=!0)}},end:function(n){var r,o,i,u,a=w?t.getElementRule(n):{};if(a){if(b[n]&&!R){if((r=h.firstChild)&&3===r.type)if((o=r.value.replace(T,"")).length>0)r.value=o,r=r.next;else for(i=r.next,r.remove(),r=i;r&&3===r.type;)o=r.value,i=r.next,(0===o.length||E.test(o))&&(r.remove(),r=i),r=i;if((r=h.lastChild)&&3===r.type)if((o=r.value.replace(k,"")).length>0)r.value=o,r=r.prev;else for(i=r.prev,r.remove(),r=i;r&&3===r.type;)o=r.value,i=r.prev,(0===o.length||E.test(o))&&(r.remove(),r=i),r=i}if(R&&S[n]&&(R=!1),a.removeEmpty&&rb(t,y,S,h))return u=h.parent,b[h.name]?h.empty().remove():h.unwrap(),void(h=u);a.paddEmpty&&(function(e){return nb(e,"#text")&&""===e.firstChild.value}(h)||rb(t,y,S,h))&&tb(e,c,b,h),h=h.parent}}},t),O=h=new bm(c.context||e.root_name,11);if(A.parse(a,c.format),w&&v.length&&(c.context?c.invalid=!0:function(e){for(var n=ib("tr,td,th,tbody,thead,tfoot,table"),r=t.getNonEmptyElements(),o=t.getWhiteSpaceElements(),i=t.getTextBlockElements(),a=t.getSpecialElements(),c=function(e,n){if(void 0===n&&(n=e.parent),a[e.name])e.empty().remove();else{for(var r=0,o=e.children();r<o.length;r++){var i=o[r];t.isValidChild(n.name,i.name)||c(i,n)}e.unwrap()}},f=0;f<e.length;f++){var l=e[f],s=void 0,d=void 0,m=void 0;if(l.parent&&!l.fixed)if(i[l.name]&&"li"===l.parent.name){for(var g=l.next;g&&i[g.name];)g.name="li",g.fixed=!0,l.parent.insert(g,l.parent),g=g.next;l.unwrap()}else{var p=[l];for(s=l.parent;s&&!t.isValidChild(s.name,l.name)&&!n[s.name];s=s.parent)p.push(s);if(s&&p.length>1)if(t.isValidChild(s.name,l.name)){p.reverse();for(var h=d=u(p[0].clone()),v=0;v<p.length-1;v++){t.isValidChild(h.name,p[v].name)?(m=u(p[v].clone()),h.append(m)):m=h;for(var b=p[v].firstChild;b&&b!==p[v+1];){var y=b.next;m.append(b),b=y}h=m}rb(t,r,o,d)?s.insert(l,p[0],!0):(s.insert(d,p[0],!0),s.insert(l,d)),s=p[0],(rb(t,r,o,s)||nb(s,"br"))&&s.empty().remove()}else c(l);else if(l.parent){if("li"===l.name){if((g=l.prev)&&("ul"===g.name||"ol"===g.name)){g.append(l);continue}if((g=l.next)&&("ul"===g.name||"ol"===g.name)){g.insert(l,g.firstChild,!0);continue}l.wrap(u(new bm("ul",1)));continue}t.isValidChild(l.parent.name,"div")&&t.isValidChild("div",l.name)?l.wrap(u(new bm("div",1))):c(l)}}}}(v)),x&&("body"===O.name||c.isRootContent)&&function(){var n=O.firstChild,r=null,o=function(e){e&&((n=e.firstChild)&&3===n.type&&(n.value=n.value.replace(T,"")),(n=e.lastChild)&&3===n.type&&(n.value=n.value.replace(k,"")))};if(t.isValidChild(O.name,x.toLowerCase())){for(;n;){var i=n.next;3===n.type||1===n.type&&"p"!==n.name&&!b[n.name]&&!n.attr("data-mce-type")?(r||((r=_(x,1)).attr(e.forced_root_block_attrs),O.insert(r,n)),r.append(n)):(o(r),r=null),n=i}o(r)}}(),!c.invalid){for(p in o)if(we(o,p)){for(g=n[p],d=(f=o[p]).length;d--;)f[d].parent||f.splice(d,1);for(l=0,s=g.length;l<s;l++)g[l](f,p,c)}for(l=0,s=r.length;l<s;l++)if((g=r[l]).name in i){for(d=(f=i[g.name]).length;d--;)f[d].parent||f.splice(d,1);for(d=0,m=g.callbacks.length;d<m;d++)g.callbacks[d](f,g.name,c)}}return O}};return function(e,t){var n=e.schema;t.remove_trailing_brs&&e.addNodeFilter("br",(function(e,r,o){var i,u,a,c,f,l,s,d,m=e.length,g=bt.extend({},n.getBlockElements()),p=n.getNonEmptyElements(),h=n.getWhiteSpaceElements();for(g.body=1,i=0;i<m;i++)if(a=(u=e[i]).parent,g[u.parent.name]&&u===a.lastChild){for(f=u.prev;f;){if("span"!==(l=f.name)||"bookmark"!==f.attr("data-mce-type")){"br"===l&&(u=null);break}f=f.prev}u&&(u.remove(),rb(n,p,h,a)&&(s=n.getElementRule(a.name))&&(s.removeEmpty?a.remove():s.paddEmpty&&tb(t,o,g,a)))}else{for(c=u;a&&a.firstChild===c&&a.lastChild===c&&(c=a,!g[a.name]);)a=a.parent;c===a&&!0!==t.padd_empty_with_br&&((d=new bm("#text",3)).value="",u.replace(d))}})),e.addAttributeFilter("href",(function(e){var n,r,o=e.length;if(!t.allow_unsafe_link_target)for(;o--;){var i=e[o];"a"===i.name&&"_blank"===i.attr("target")&&i.attr("rel",(n=i.attr("rel"),r=void 0,r=n?bt.trim(n):"",/\b(noopener)\b/g.test(r)?r:function(e){return e.split(" ").filter((function(e){return e.length>0})).concat(["noopener"]).sort().join(" ")}(r)))}})),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",(function(e){for(var t,n,r,o,i=e.length;i--;)if("a"===(o=e[i]).name&&o.firstChild&&!o.attr("href")){r=o.parent,t=o.lastChild;do{n=t.prev,r.insert(t,o),t=n}while(t)}})),t.fix_list_elements&&e.addNodeFilter("ul,ol",(function(e){for(var t,n,r=e.length;r--;)if("ul"===(n=(t=e[r]).parent).name||"ol"===n.name)if(t.prev&&"li"===t.prev.name)t.prev.append(t);else{var o=new bm("li",1);o.attr("style","list-style-type: none"),t.wrap(o)}})),t.validate&&n.getValidClasses()&&e.addAttributeFilter("class",(function(e){for(var t=n.getValidClasses(),r=e.length;r--;){for(var o=e[r],i=o.attr("class").split(" "),u="",a=0;a<i.length;a++){var c=i[a],f=!1,l=t["*"];l&&l[c]&&(f=!0),l=t[o.name],!f&&l&&l[c]&&(f=!0),f&&(u&&(u+=" "),u+=c)}u.length||(u=null),o.attr("class",u)}})),ob(e,t)}(a,e),function(e,t){t.inline_styles&&Kv(e,t)}(a,e),a},lb=function(e,t,n){return function(e,t){return e&&e.hasEventListeners("PreProcess")&&!t.no_events}(e,n)?function(e,t,n){var r,o=e.dom,i=t.cloneNode(!0),u=document.implementation;if(u.createHTMLDocument){var a=u.createHTMLDocument("");bt.each("BODY"===i.nodeName?i.childNodes:[i],(function(e){a.body.appendChild(a.importNode(e,!0))})),i="BODY"!==i.nodeName?a.body.firstChild:a.body,r=o.doc,o.doc=a}return function(e,t){e.fire("PreProcess",t)}(e,Ae(Ae({},n),{node:i})),r&&(o.doc=r),i}(e,t,n):t},sb=function(e,t,n){-1===bt.inArray(t,n)&&(e.addAttributeFilter(n,(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)})),t.push(n))},db=function(e,t,n,r,o){return function(e,t,n){return!t.no_events&&e?function(e,t){return e.fire("PostProcess",t)}(e,Ae(Ae({},t),{content:n})).content:n}(e,o,function(e,t,n){return jm(e,t).serialize(n)}(t,n,r))},mb=function(e,t){var n=["data-mce-selected"],r=t&&t.dom?t.dom:na.DOM,o=t&&t.schema?t.schema:vi(e);e.entity_encoding=e.entity_encoding||"named",e.remove_trailing_brs=!("remove_trailing_brs"in e)||e.remove_trailing_brs;var i=fb(e,o);!function(e,t,n){e.addAttributeFilter("data-mce-tabindex",(function(e,t){for(var n=e.length;n--;){var r=e[n];r.attr("tabindex",r.attr("data-mce-tabindex")),r.attr(t,null)}})),e.addAttributeFilter("src,href,style",(function(e,r){for(var o="data-mce-"+r,i=t.url_converter,u=t.url_converter_scope,a=e.length;a--;){var c=e[a],f=c.attr(o);void 0!==f?(c.attr(r,f.length>0?f:null),c.attr(o,null)):(f=c.attr(r),"style"===r?f=n.serializeStyle(n.parseStyle(f),c.name):i&&(f=i.call(u,f,r,c.name)),c.attr(r,f.length>0?f:null))}})),e.addAttributeFilter("class",(function(e){for(var t=e.length;t--;){var n=e[t],r=n.attr("class");r&&(r=n.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),n.attr("class",r.length>0?r:null))}})),e.addAttributeFilter("data-mce-type",(function(e,t,n){for(var r=e.length;r--;){var o=e[r];if("bookmark"===o.attr("data-mce-type")&&!n.cleanup)F.from(o.firstChild).exists((function(e){return!fo(e.value)}))?o.unwrap():o.remove()}})),e.addNodeFilter("noscript",(function(e){for(var t=e.length;t--;){var n=e[t].firstChild;n&&(n.value=ai.decode(n.value))}})),e.addNodeFilter("script,style",(function(e,n){for(var r=function(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")},o=e.length;o--;){var i=e[o],u=i.firstChild?i.firstChild.value:"";if("script"===n){var a=i.attr("type");a&&i.attr("type","mce-no/type"===a?null:a.replace(/^mce\-/,"")),"xhtml"===t.element_format&&u.length>0&&(i.firstChild.value="// <![CDATA[\n"+r(u)+"\n// ]]>")}else"xhtml"===t.element_format&&u.length>0&&(i.firstChild.value="\x3c!--\n"+r(u)+"\n--\x3e")}})),e.addNodeFilter("#comment",(function(e){for(var r=e.length;r--;){var o=e[r];t.preserve_cdata&&0===o.value.indexOf("[CDATA[")?(o.name="#cdata",o.type=4,o.value=n.decode(o.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===o.value.indexOf("mce:protected ")&&(o.name="#text",o.type=3,o.raw=!0,o.value=unescape(o.value).substr(14))}})),e.addNodeFilter("xml:namespace,input",(function(e,t){for(var n=e.length;n--;){var r=e[n];7===r.type?r.remove():1===r.type&&("input"!==t||r.attr("type")||r.attr("type","text"))}})),e.addAttributeFilter("data-mce-type",(function(t){$(t,(function(t){"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(e.schema.getNonEmptyElements())?t.remove():t.unwrap())}))})),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}))}(i,e,r);return{schema:o,addNodeFilter:i.addNodeFilter,addAttributeFilter:i.addAttributeFilter,serialize:function(n,u){void 0===u&&(u={});var a=Ae({format:"html"},u),c=lb(t,n,a),f=function(e,t,n){var r=lo(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||co(Ct.fromDom(t))?r:bt.trim(r)}(r,c,a),l=function(e,t,n){var r=n.selection?Ae({forced_root_block:!1},n):n,o=e.parse(t,r);return function(e){var t=function(e){return e&&"br"===e.name},n=e.lastChild;if(t(n)){var r=n.prev;t(r)&&(n.remove(),r.remove())}}(o),o}(i,f,a);return"tree"===a.format?l:db(t,e,o,l,a)},addRules:o.addValidElements,setRules:o.setValidElements,addTempAttr:_(sb,i,n),getTempAttrs:N(n),getNodeFilters:i.getNodeFilters,getAttributeFilters:i.getAttributeFilters}},gb=function(e,t){var n=mb(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters}},pb=function(e,t){return void 0===t&&(t={}),function(e,t,n){return Pv(e).editor.getContent(t,n)}(e,t,t.format?t.format:"html")},hb=function(e,t,n){return void 0===n&&(n={}),function(e,t,n){return Pv(e).editor.setContent(t,n)}(e,t,n)},vb=na.DOM,bb=function(e){return F.from(e).each((function(e){return e.destroy()}))},yb=function(e){if(!e.removed){var t=e._selectionOverrides,n=e.editorUpload,r=e.getBody(),o=e.getElement();r&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&o&&vb.remove(o.nextSibling),function(e){e.fire("remove")}(e),e.editorManager.remove(e),!e.inline&&r&&function(e){vb.setStyle(e.id,"display",e.orgDisplay)}(e),function(e){e.fire("detach")}(e),vb.remove(e.getContainer()),bb(t),bb(n),e.destroy()}},Cb=function(e,t){var n=e.selection,r=e.dom;e.destroyed||(t||e.removed?(t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),bb(n),bb(r)),function(e){var t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,t._mceOldSubmit=null),vb.unbind(t,"submit reset",e.formEventDelegate))}(e),function(e){e.contentAreaContainer=e.formElement=e.container=e.editorContainer=null,e.bodyElement=e.contentDocument=e.contentWindow=null,e.iframeElement=e.targetElm=null,e.selection&&(e.selection=e.selection.win=e.selection.dom=e.selection.dom.doc=null)}(e),e.destroyed=!0):e.remove())},wb=(zv=function(e,t){return g(e)&&g(t)?wb(e,t):t},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<e.length;r++){var o=e[r];for(var i in o)we(o,i)&&(n[i]=zv(n[i],o[i]))}return n}),xb="autoresize_on_init,content_editable_state,convert_fonts_to_spans,inline_styles,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),Sb="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),Tb="imagetools,toc".split(","),kb=function(e){var t=G(xb,(function(t){return we(e,t)})),n=e.forced_root_block;return!1!==n&&""!==n||t.push("forced_root_block (false only)"),ie(t)},Nb=function(e){var t=bt.makeMap(e.plugins," "),n=function(e){return we(t,e)},r=Oe(Oe([],G(Sb,n),!0),te(Tb,(function(e){return n(e)?[e+" (moving to premium)"]:[]})),!0);return ie(r)},Eb=ot().deviceType,Rb=Eb.isTouch(),_b=Eb.isPhone(),Db=Eb.isTablet(),Ab=["lists","autolink","autosave"],Ob={table_grid:!1,object_resizing:!1,resize:!1},Bb=function(e){var t=p(e)?e.join(" "):e,n=W(m(t)?t.split(" "):[],ze);return G(n,(function(e){return e.length>0}))},Pb=function(e,t){var n,r,o=(r={},ve(t,(function(t,n){return V(e,n)}),he(n={}),he(r)),{t:n,f:r});return function(e,t){return{sections:N(e),settings:N(t)}}(o.t,o.f)},Lb=function(e,t){return we(e.sections(),t)},Ib=function(e,t){return Ce(e,"toolbar_mode").orThunk((function(){return Ce(e,"toolbar_drawer").map((function(e){return!1===e?"wrap":e}))})).getOr(t)},Mb=function(e,t){var n={resize:!1,toolbar_mode:Ib(e,"scrolling"),toolbar_sticky:!1};return Ae(Ae(Ae({},Ob),n),t?{menubar:!1}:{})},Fb=function(e,t){var n=t.external_plugins?t.external_plugins:{};return e&&e.external_plugins?bt.extend({},e.external_plugins,n):n},jb=function(e,t,n,r){return e&&function(e,t,n){var r=e.sections();return Lb(e,t)&&r[t].theme===n}(t,"mobile","mobile")?G(r,_(V,Ab)):e&&Lb(t,"mobile")?r:n},Ub=function(e,t,n,r){var o=Bb(n.forced_plugins),i=Bb(r.plugins),u=function(e,t){return Lb(e,t)?e.sections()[t]:{}}(t,"mobile"),a=u.plugins?Bb(u.plugins):i,c=function(e,t){return[].concat(Bb(e)).concat(Bb(t))}(o,jb(e,t,i,a));if(mt.browser.isIE()&&V(c,"rtc"))throw new Error("RTC plugin is not supported on IE 11.");return bt.extend(r,{plugins:c.join(" ")})},zb=function(e,t,n,r,o){var i=e?{mobile:Mb(o.mobile||{},t)}:{},u=Pb(["mobile"],wb(i,o)),a=bt.extend(n,r,u.settings(),function(e,t){return e&&Lb(t,"mobile")}(e,u)?function(e,t,n){void 0===n&&(n={});var r=e.sections(),o=Ce(r,t).getOr({});return bt.extend({},n,o)}(u,"mobile"):{},{validate:!0,external_plugins:Fb(r,u.settings())});return Ub(e,u,r,a)},Hb=function(e,t,n,r,o){var i=function(e,t,n,r,o){var i={id:t,theme:"silver",toolbar_mode:Ib(e,"floating"),plugins:"",document_base_url:n,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:o.convertURL,url_converter_scope:o};return Ae(Ae({},i),r?Ob:{})}(o,t,n,Rb,e),u=zb(_b||Db,_b,i,r,o);return!1!==u.deprecation_warnings&&function(e,t){var n=kb(e),r=Nb(t),o=r.length>0,i=n.length>0,u="mobile"===t.theme;if(o||i||u){var a=u?"\n\nThemes:\n- mobile":"",c=o?"\n\nPlugins:\n- "+r.join("\n- "):"",f=i?"\n\nSettings:\n- "+n.join("\n- "):"";console.warn("The following deprecated features are currently enabled, these will be removed in TinyMCE 6.0. See https://www.tiny.cloud/docs/release-notes/6.0-upcoming-changes/ for more information."+a+c+f)}}(o,u),u},Vb=function(e,t,n){return F.from(t.settings[n]).filter(e)},qb=function(e,t,n,r){var o,i=t in e.settings?e.settings[t]:n;return"hash"===r?function(e){var t={};return"string"==typeof e?$(e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(","),(function(e){var n=e.split("=");n.length>1?t[bt.trim(n[0])]=bt.trim(n[1]):t[bt.trim(n[0])]=bt.trim(n[0])})):t=e,t}(i):"string"===r?Vb(m,e,t).getOr(n):"number"===r?Vb(x,e,t).getOr(n):"boolean"===r?Vb(v,e,t).getOr(n):"object"===r?Vb(g,e,t).getOr(n):"array"===r?Vb(p,e,t).getOr(n):"string[]"===r?Vb((o=m,function(e){return p(e)&&ne(e,o)}),e,t).getOr(n):"function"===r?Vb(w,e,t).getOr(n):i},Wb=(Hv={},{add:function(e,t){Hv[e]=t},get:function(e){return Hv[e]?Hv[e]:{icons:{}}},has:function(e){return we(Hv,e)}}),$b=function(e,t){return t.dom[e]},Kb=function(e,t){return parseInt(Gn(t,e),10)},Xb=_($b,"clientWidth"),Gb=_($b,"clientHeight"),Yb=_(Kb,"margin-top"),Qb=_(Kb,"margin-left"),Jb=function(e,t,n){var r,o=Ct.fromDom(e.getBody()),i=e.inline?o:(r=o,Ct.fromDom(Lt(r).dom.documentElement)),u=function(e,t,n,r){var o=function(e){return e.dom.getBoundingClientRect()}(t);return{x:n-(e?o.left+t.dom.clientLeft+Qb(t):0),y:r-(e?o.top+t.dom.clientTop+Yb(t):0)}}(e.inline,i,t,n);return function(e,t,n){var r=Xb(e),o=Gb(e);return t>=0&&n>=0&&t<=r&&n<=o}(i,u.x,u.y)},Zb=function(e){var t,n=e.inline?e.getBody():e.getContentAreaContainer();return(t=n,F.from(t).map(Ct.fromDom)).map(fn).getOr(!1)},ey=function(e){var t=[],n=function(){var t,n=e.theme;return n&&n.getNotificationManagerImpl?n.getNotificationManagerImpl():{open:t=function(){throw new Error("Theme did not provide a NotificationManager implementation.")},close:t,reposition:t,getArgs:t}},r=function(){return F.from(t[0])},o=function(){t.length>0&&n().reposition(t)},i=function(e){ee(t,(function(t){return t===e})).each((function(e){t.splice(e,1)}))},u=function(u,a){if(void 0===a&&(a=!0),!e.removed&&Zb(e))return a&&e.fire("BeforeOpenNotification",{notification:u}),Z(t,(function(e){return t=n().getArgs(e),r=u,!(t.type!==r.type||t.text!==r.text||t.progressBar||t.timeout||r.progressBar||r.timeout);var t,r})).getOrThunk((function(){e.editorManager.setActive(e);var a=n().open(u,(function(){i(a),o(),r().fold((function(){return e.focus()}),(function(e){return Ct.fromDom(e.getEl()).dom.focus()}))}));return function(e){t.push(e)}(a),o(),e.fire("OpenNotification",{notification:Ae({},a)}),a}))},a=N(t);return function(e){e.on("SkinLoaded",(function(){var t=function(e){return e.getParam("service_message")}(e);t&&u({text:t,type:"warning",timeout:0},!1),o()})),e.on("show ResizeEditor ResizeWindow NodeChange",(function(){Xr.requestAnimationFrame(o)})),e.on("remove",(function(){$(t.slice(),(function(e){n().close(e)}))}))}(e),{open:u,close:function(){r().each((function(e){n().close(e),i(e),o()}))},getNotifications:a}},ty=da.PluginManager,ny=da.ThemeManager;var ry=function(e){var t=[],n=function(){var t,n=e.theme;return n&&n.getWindowManagerImpl?n.getWindowManagerImpl():{open:t=function(){throw new Error("Theme did not provide a WindowManager implementation.")},openUrl:t,alert:t,confirm:t,close:t,getParams:t,setParams:t}},r=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t?t.apply(e,n):void 0}},o=function(n){t.push(n),function(t){e.fire("OpenWindow",{dialog:t})}(n)},i=function(n){!function(t){e.fire("CloseWindow",{dialog:t})}(n),0===(t=G(t,(function(e){return e!==n}))).length&&e.focus()},u=function(t){e.editorManager.setActive(e),$d(e);var n=t();return o(n),n};return e.on("remove",(function(){$(t,(function(e){n().close(e)}))})),{open:function(e,t){return u((function(){return n().open(e,t,i)}))},openUrl:function(e){return u((function(){return n().openUrl(e,i)}))},alert:function(e,t,o){var i=n();i.alert(e,r(o||i,t))},confirm:function(e,t,o){var i=n();i.confirm(e,r(o||i,t))},close:function(){F.from(t[t.length-1]).each((function(e){n().close(e),i(e)}))}}},oy=function(e,t){e.notificationManager.open({type:"error",text:t})},iy=function(e,t){e._skinLoaded?oy(e,t):e.on("SkinLoaded",(function(){oy(e,t)}))},uy=function(e,t,n){zs(e,t,{message:n}),console.error(n)},ay=function(e,t,n){return n?"Failed to load "+e+": "+n+" from url "+t:"Failed to load "+e+" url: "+t},cy=function(e,t,n){uy(e,"PluginLoadError",ay("plugin",t,n))},fy=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=window.console;r&&(r.error?r.error.apply(r,Oe([e],t,!1)):r.log.apply(r,Oe([e],t,!1)))},ly=function(e){return sy(e,function(e){var t=e.getParam("content_css");return m(t)?W(t.split(","),ze):p(t)?t:!1===t||e.inline?[]:["default"]}(e))},sy=function(e,t){var n=e.editorManager.baseURL+"/skins/content",r="content"+e.editorManager.suffix+".css",o=!0===e.inline;return W(t,(function(t){return function(e){return/^[a-z0-9\-]+$/i.test(e)}(t)&&!o?n+"/"+t+"/"+r:e.documentBaseURI.toAbsolute(t)}))},dy=function(e){e.contentCSS=e.contentCSS.concat(ly(e),function(e){return sy(e,tf(e))}(e))},my=function(){var e={},t=function(e,t){return{status:e,resultUri:t}},n=function(t){return t in e};return{hasBlobUri:n,getResultUri:function(t){var n=e[t];return n?n.resultUri:null},isPending:function(t){return!!n(t)&&1===e[t].status},isUploaded:function(t){return!!n(t)&&2===e[t].status},markPending:function(n){e[n]=t(1,null)},markUploaded:function(n,r){e[n]=t(2,r)},removeFailed:function(t){delete e[t]},destroy:function(){e={}}}},gy=0,py=function(e){return e+gy+++(t=function(){return Math.round(4294967295*Math.random()).toString(36)},"s"+(new Date).getTime().toString(36)+t()+t()+t());var t},hy=function(e,t){var n={},r=function(e,n,r,o){var i=new XMLHttpRequest;i.open("POST",t.url),i.withCredentials=t.credentials,i.upload.onprogress=function(e){o(e.loaded/e.total*100)},i.onerror=function(){r("Image upload failed due to a XHR Transport error. Code: "+i.status)},i.onload=function(){if(i.status<200||i.status>=300)r("HTTP Error: "+i.status);else{var e,o,u=JSON.parse(i.responseText);if(u&&"string"==typeof u.location)n((e=t.basePath,o=u.location,e?e.replace(/\/$/,"")+"/"+o.replace(/^\//,""):o));else r("Invalid JSON: "+i.responseText)}};var u=new FormData;u.append("file",e.blob(),e.filename()),i.send(u)},o=function(e,t){return{url:t,blobInfo:e,status:!0}},i=function(e,t,n){return{url:"",blobInfo:e,status:!1,error:{message:t,options:n}}},u=function(e,t){bt.each(n[e],(function(e){e(t)})),delete n[e]},a=function(r,a){return r=bt.grep(r,(function(t){return!e.isUploaded(t.blobUri())})),qr.all(bt.map(r,(function(r){return e.isPending(r.blobUri())?function(e){var t=e.blobUri();return new qr((function(e){n[t]=n[t]||[],n[t].push(e)}))}(r):function(t,n,r){return e.markPending(t.blobUri()),new qr((function(a){var c;try{var f=function(){c&&(c.close(),S)};n(t,(function(n){f(),e.markUploaded(t.blobUri(),n),u(t.blobUri(),o(t,n)),a(o(t,n))}),(function(n,r){var o=r||{};f(),e.removeFailed(t.blobUri()),u(t.blobUri(),i(t,n,o)),a(i(t,n,o))}),(function(e){e<0||e>100||F.from(c).orThunk((function(){return F.from(r).map(A)})).each((function(t){c=t,t.progressBar.value(e)}))}))}catch(e){a(i(t,e.message,{}))}}))}(r,t.handler,a)})))};return!1===w(t.handler)&&(t.handler=r),{upload:function(e,n){return t.url||t.handler!==r?a(e,n):new qr((function(e){e([])}))}}},vy=function(e){return function(){return e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})}},by=function(e,t){return hy(t,{url:Kc(e),basePath:Xc(e),credentials:Gc(e),handler:Yc(e)})},yy=function(e){var t,n,r=function(){var e=[],t=function(e){if(!e.blob||!e.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");var t,n=e.id||py("blobid"),r=e.name||n,o=e.blob;return{id:N(n),name:N(r),filename:N(e.filename||r+"."+(t=o.type,{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[t.toLowerCase()]||"dat")),blob:N(o),base64:N(e.base64),blobUri:N(e.blobUri||URL.createObjectURL(o)),uri:N(e.uri)}},n=function(t){return Z(e,t).getOrUndefined()},r=function(e){return n((function(t){return t.id()===e}))};return{create:function(e,n,r,o,i){if(m(e))return t({id:e,name:o,filename:i,blob:n,base64:r});if(g(e))return t(e);throw new Error("Unknown input type")},add:function(t){r(t.id())||e.push(t)},get:r,getByUri:function(e){return n((function(t){return t.blobUri()===e}))},getByData:function(e,t){return n((function(n){return n.base64()===e&&n.blob().type===t}))},findFirst:n,removeByUri:function(t){e=G(e,(function(e){return e.blobUri()!==t||(URL.revokeObjectURL(e.blobUri()),!1)}))},destroy:function(){$(e,(function(e){URL.revokeObjectURL(e.blobUri())})),e=[]}}}(),o=my(),i=[],u=function(e){var t=aa(null);e.on("change AddUndo",(function(e){t.set(Ae({},e.level))}));return{fireIfChanged:function(){var n=e.undoManager.data;ce(n).filter((function(e){return!Ev(t.get(),e)})).each((function(t){e.setDirty(!0),e.fire("change",{level:t,lastLevel:ue(n,n.length-2).getOrNull()})}))}}}(e),a=function(t){return function(n){return e.selection?t(n):[]}},c=function(e,t,n){var r=0;do{-1!==(r=e.indexOf(t,r))&&(e=e.substring(0,r)+n+e.substr(r+t.length),r+=n.length-t.length+1)}while(-1!==r);return e},f=function(e,t,n){var r='src="'+n+'"'+(n===mt.transparentSrc?' data-mce-placeholder="1"':"");return e=c(e,'src="'+t+'"',r),e=c(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"')},l=function(t,n){$(e.undoManager.data,(function(e){"fragmented"===e.type?e.fragments=W(e.fragments,(function(e){return f(e,t,n)})):e.content=f(e.content,t,n)}))},s=function(n){return t||(t=by(e,o)),h().then(a((function(o){var i=W(o,(function(e){return e.blobInfo}));return t.upload(i,vy(e)).then(a((function(t){var i=[],a=W(t,(function(t,n){var u=o[n].blobInfo,a=o[n].image;return t.status&&function(e){return e.getParam("images_replace_blob_uris",!0,"boolean")}(e)?(r.removeByUri(a.src),Ov(e)||function(t,n){var r,o=e.convertURL(n,"src");l(t.src,n),e.$(t).attr({src:Wc(e)?(r=n,r+(-1===r.indexOf("?")?"?":"&")+(new Date).getTime()):n,"data-mce-src":o})}(a,t.url)):t.error&&(t.error.options.remove&&(l(a.getAttribute("src"),mt.transparentSrc),i.push(a)),function(e,t){iy(e,sa.translate(["Failed to upload image: {0}",t]))}(e,t.error.message)),{element:a,status:t.status,uploadUri:t.url,blobInfo:u}}));return a.length>0&&u.fireIfChanged(),i.length>0&&(Ov(e)?console.error("Removing images on failed uploads is currently unsupported for RTC"):e.undoManager.transact((function(){$(i,(function(t){e.dom.remove(t),r.removeByUri(t.src)}))}))),n&&n(a),a})))})))},d=function(t){if(qc(e))return s(t)},p=function(t){return!1!==ne(i,(function(e){return e(t)}))&&(0!==t.getAttribute("src").indexOf("data:")||function(e){return e.getParam("images_dataimg_filter",P,"function")}(e)(t))},h=function(){return n||(n=eb(o,r)),n.findAll(e.getBody(),p).then(a((function(t){return t=G(t,(function(t){return"string"!=typeof t||(iy(e,t),!1)})),Ov(e)||$(t,(function(e){l(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")})),t})))},v=function(t){return t.replace(/src="(blob:[^"]+)"/g,(function(t,n){var i=o.getResultUri(n);if(i)return'src="'+i+'"';var u=r.getByUri(n);return u||(u=Q(e.editorManager.get(),(function(e,t){return e||t.editorUpload&&t.editorUpload.blobCache.getByUri(n)}),null)),u?'src="data:'+u.blob().type+";base64,"+u.base64()+'"':t}))};return e.on("SetContent",(function(){qc(e)?d():h()})),e.on("RawSaveContent",(function(e){e.content=v(e.content)})),e.on("GetContent",(function(e){e.source_view||"raw"===e.format||"tree"===e.format||(e.content=v(e.content))})),e.on("PostRender",(function(){e.parser.addNodeFilter("img",(function(e){$(e,(function(e){var t=e.attr("src");if(!r.getByUri(t)){var n=o.getResultUri(t);n&&e.attr("src",n)}}))}))})),{blobCache:r,addFilter:function(e){i.push(e)},uploadImages:s,uploadImagesAuto:d,scanForImages:h,destroy:function(){r.destroy(),o.destroy(),n=t=null}}},Cy=function(e){var t={},n=function(e,r){e&&(m(e)?(p(r)||(r=[r]),$(r,(function(e){b(e.deep)&&(e.deep=!es(e)),b(e.split)&&(e.split=!es(e)||ts(e)),b(e.remove)&&es(e)&&!ts(e)&&(e.remove="none"),es(e)&&ts(e)&&(e.mixed=!0,e.block_expand=!0),m(e.classes)&&(e.classes=e.classes.split(/\s+/))})),t[e]=r):me(e,(function(e,t){n(t,e)})))};return n(function(e){var t={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all",preserve_attributes:["class","style"]},{inline:"s",remove:"all",preserve_attributes:["class","style"]}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",defaultBlock:"p",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(e,t,n){return wn(e)&&e.hasAttribute("href")},onformat:function(t,n,r){bt.each(r,(function(n,r){e.setAttrib(t,r,n)}))}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":function(e){var t;return null!==(t=null==e?void 0:e.customValue)&&void 0!==t?t:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return bt.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),(function(e){t[e]={block:e,remove:"all"}})),t}(e.dom)),n(function(e){return e.getParam("formats")}(e)),{get:function(e){return C(e)?t[e]:t},has:function(e){return we(t,e)},register:n,unregister:function(e){return e&&t[e]&&delete t[e],t}}},wy=bt.each,xy=na.DOM,Sy=function(e,t){var n,r,o,i=t&&t.schema||vi({}),u=function(e){r="string"==typeof e?{name:e,classes:[],attrs:{}}:e;var t=xy.create(r.name);return function(e,t){t.classes.length&&xy.addClass(e,t.classes.join(" ")),xy.setAttribs(e,t.attrs)}(t,r),t},a=function(e,t,n){var r,o,c=t.length>0&&t[0],f=c&&c.name,l=function(e,t){var n="string"!=typeof e?e.nodeName.toLowerCase():e,r=i.getElementRule(n),o=r&&r.parentsRequired;return!(!o||!o.length)&&(t&&-1!==bt.inArray(o,t)?t:o[0])}(e,f);if(l)f===l?(o=t[0],t=t.slice(1)):o=l;else if(c)o=t[0],t=t.slice(1);else if(!n)return e;return o&&(r=u(o)).appendChild(e),n&&(r||(r=xy.create("div")).appendChild(e),bt.each(n,(function(t){var n=u(t);r.insertBefore(n,e)}))),a(r,t,o&&o.siblings)};return e&&e.length?(r=e[0],n=u(r),(o=xy.create("div")).appendChild(a(n,e.slice(1),r.siblings)),o):""},Ty=function(e){var t,n={classes:[],attrs:{}};return"*"!==(e=n.selector=bt.trim(e))&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(function(e,t,r,o,i){switch(t){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":-1!==bt.inArray("checked disabled enabled read-only required".split(" "),r)&&(n.attrs[r]=r)}if("["===o){var u=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);u&&(n.attrs[u[1]]=u[2])}return""}))),n.name=t||"div",n},ky=function(e,t){var n,r,o,i="",u=function(e){var t=e.getParam("preview_styles","font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow");return m(t)?t:""}(e);if(""===u)return"";var a=function(e){return e.replace(/%(\w+)/g,"")};if("string"==typeof t){if(!(t=e.formatter.get(t)))return;t=t[0]}if("preview"in t){var c=Ce(t,"preview");if(jn(c,!1))return"";u=c.getOr(u)}n=t.block||t.inline||"span";var f,l=(f=t.selector)&&"string"==typeof f?(f=(f=f.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),bt.map(f.split(/(?:>|\s+(?![^\[\]]+\]))/),(function(e){var t=bt.map(e.split(/(?:~\+|~|\+)/),Ty),n=t.pop();return t.length&&(n.siblings=t),n})).reverse()):[];l.length?(l[0].name||(l[0].name=n),n=t.selector,r=Sy(l,e)):r=Sy([n],e);var s=xy.select(n,r)[0]||r.firstChild;return wy(t.styles,(function(e,t){var n=a(e);n&&xy.setStyle(s,t,n)})),wy(t.attributes,(function(e,t){var n=a(e);n&&xy.setAttrib(s,t,n)})),wy(t.classes,(function(e){var t=a(e);xy.hasClass(s,t)||xy.addClass(s,t)})),e.fire("PreviewFormats"),xy.setStyles(r,{position:"absolute",left:-65535}),e.getBody().appendChild(r),o=xy.getStyle(e.getBody(),"fontSize",!0),o=/px$/.test(o)?parseInt(o,10):0,wy(u.split(" "),(function(t){var n=xy.getStyle(s,t,!0);if(!("background-color"===t&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)&&(n=xy.getStyle(e.getBody(),t,!0),"#ffffff"===xy.toHex(n).toLowerCase())||"color"===t&&"#000000"===xy.toHex(n).toLowerCase())){if("font-size"===t&&/em|%$/.test(n)){if(0===o)return;n=parseFloat(n)/(/%$/.test(n)?100:1)*o+"px"}"border"===t&&n&&(i+="padding:0 2px;"),i+=t+":"+n+";"}})),e.fire("AfterPreviewFormats"),xy.remove(r),i},Ny=function(e){var t=Cy(e),n=aa(null);return function(e){e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(var t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])}(e),mh(e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:function(t,n,r){!function(e,t,n,r){Lv(e).formatter.apply(t,n,r)}(e,t,n,r)},remove:function(t,n,r,o){!function(e,t,n,r,o){Lv(e).formatter.remove(t,n,r,o)}(e,t,n,r,o)},toggle:function(t,n,r){!function(e,t,n,r){Lv(e).formatter.toggle(t,n,r)}(e,t,n,r)},match:function(t,n,r,o){return function(e,t,n,r,o){return Lv(e).formatter.match(t,n,r,o)}(e,t,n,r,o)},closest:function(t){return function(e,t){return Lv(e).formatter.closest(t)}(e,t)},matchAll:function(t,n){return function(e,t,n){return Lv(e).formatter.matchAll(t,n)}(e,t,n)},matchNode:function(t,n,r,o){return function(e,t,n,r,o){return Lv(e).formatter.matchNode(t,n,r,o)}(e,t,n,r,o)},canApply:function(t){return function(e,t){return Lv(e).formatter.canApply(t)}(e,t)},formatChanged:function(t,r,o,i){return function(e,t,n,r,o,i){return Lv(e).formatter.formatChanged(t,n,r,o,i)}(e,n,t,r,o,i)},getCssText:_(ky,e)}},Ey=function(e){switch(e.toLowerCase()){case"undo":case"redo":case"mcerepaint":case"mcefocus":return!0;default:return!1}},Ry=function(e){var t=ma(),n=aa(0),r=aa(0),o={data:[],typing:!1,beforeChange:function(){!function(e,t,n){Lv(e).undoManager.beforeChange(t,n)}(e,n,t)},add:function(i,u){return function(e,t,n,r,o,i,u){return Lv(e).undoManager.add(t,n,r,o,i,u)}(e,o,r,n,t,i,u)},undo:function(){return function(e,t,n,r){return Lv(e).undoManager.undo(t,n,r)}(e,o,n,r)},redo:function(){return function(e,t,n){return Lv(e).undoManager.redo(t,n)}(e,r,o.data)},clear:function(){!function(e,t,n){Lv(e).undoManager.clear(t,n)}(e,o,r)},reset:function(){!function(e,t){Lv(e).undoManager.reset(t)}(e,o)},hasUndo:function(){return function(e,t,n){return Lv(e).undoManager.hasUndo(t,n)}(e,o,r)},hasRedo:function(){return function(e,t,n){return Lv(e).undoManager.hasRedo(t,n)}(e,o,r)},transact:function(t){return function(e,t,n,r){return Lv(e).undoManager.transact(t,n,r)}(e,o,n,t)},ignore:function(t){!function(e,t,n){Lv(e).undoManager.ignore(t,n)}(e,n,t)},extra:function(t,n){!function(e,t,n,r,o){Lv(e).undoManager.extra(t,n,r,o)}(e,o,r,t,n)}};return Ov(e)||function(e,t,n){var r=aa(!1),o=function(e){_v(t,!1,n),t.add({},e)};e.on("init",(function(){t.add()})),e.on("BeforeExecCommand",(function(e){var r=e.command;Ey(r)||(Dv(t,n),t.beforeChange())})),e.on("ExecCommand",(function(e){var t=e.command;Ey(t)||o(e)})),e.on("ObjectResizeStart cut",(function(){t.beforeChange()})),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",(function(n){var i=n.keyCode;n.isDefaultPrevented()||((i>=33&&i<=36||i>=37&&i<=40||45===i||n.ctrlKey)&&(o(),e.nodeChanged()),46!==i&&8!==i||e.nodeChanged(),r.get()&&t.typing&&!1===Ev(Sv(e),t.data[0])&&(!1===e.isDirty()&&(e.setDirty(!0),e.fire("change",{level:t.data[0],lastLevel:null})),e.fire("TypingUndo"),r.set(!1),e.nodeChanged()))})),e.on("keydown",(function(e){var i=e.keyCode;if(!e.isDefaultPrevented())if(i>=33&&i<=36||i>=37&&i<=40||45===i)t.typing&&o(e);else{var u=e.ctrlKey&&!e.altKey||e.metaKey;!(i<16||i>20)||224===i||91===i||t.typing||u||(t.beforeChange(),_v(t,!0,n),t.add({},e),r.set(!0))}})),e.on("mousedown",(function(e){t.typing&&o(e)}));e.on("input",(function(e){e.inputType&&("insertReplacementText"===e.inputType||function(e){return"insertText"===e.inputType&&null===e.data}(e)||function(e){return"insertFromPaste"===e.inputType||"insertFromDrop"===e.inputType}(e))&&o(e)})),e.on("AddUndo Undo Redo ClearUndos",(function(t){t.isDefaultPrevented()||e.nodeChanged()}))}(e,o,n),function(e){e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")}(e),o},_y=[9,27,qs.HOME,qs.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,qs.DOWN,qs.UP,qs.LEFT,qs.RIGHT].concat(mt.browser.isFirefox()?[224]:[]),Dy=function(e){return"keydown"===e.type||"keyup"===e.type},Ay=function(e){var t=e.keyCode;return t===qs.BACKSPACE||t===qs.DELETE},Oy=function(e){var t=e.dom,n=Hc(e),r=function(e){return e.getParam("placeholder",jc.getAttrib(e.getElement(),"placeholder"),"string")}(e),o=function(i,u){if(!function(e){if(Dy(e)){var t=e.keyCode;return!Ay(e)&&(qs.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||V(_y,t))}return!1}(i)){var a=e.getBody(),c=!function(e){return Dy(e)&&!(Ay(e)||"keyup"===e.type&&229===e.keyCode)}(i)&&function(e,t,n){if(Vo(Ct.fromDom(t),!1)){var r=""===n,o=t.firstElementChild;return!o||!e.getStyle(t.firstElementChild,"padding-left")&&!e.getStyle(t.firstElementChild,"padding-right")&&(r?!e.isBlock(o):n===o.nodeName.toLowerCase())}return!1}(t,a,n);(""!==t.getAttrib(a,"data-mce-placeholder")!==c||u)&&(t.setAttrib(a,"data-mce-placeholder",c?r:null),t.setAttrib(a,"aria-placeholder",c?r:null),function(e,t){e.fire("PlaceholderToggle",{state:t})}(e,c),e.on(c?"keydown":"keyup",o),e.off(c?"keyup":"keydown",o))}};r&&e.on("init",(function(t){o(t,!0),e.on("change SetContent ExecCommand",o),e.on("paste",(function(t){return Xr.setEditorTimeout(e,(function(){return o(t)}))}))}))},By=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,Py=function(e,t){return xt(Ct.fromDom(t),function(e){return e.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string")}(e))},Ly=function(e){return"rtl"===na.DOM.getStyle(e,"direction",!0)||(t=e.textContent,By.test(t));var t},Iy=function(e,t,n){var r=function(e,t,n){return G(na.DOM.getParents(n.container(),"*",t),e)}(e,t,n);return F.from(r[r.length-1])},My=function(e,t){if(!t)return t;var n=t.container(),r=t.offset();return e?po(n)?_n(n.nextSibling)?pc(n.nextSibling,0):pc.after(n):bo(t)?pc(n,r+1):t:po(n)?_n(n.previousSibling)?pc(n.previousSibling,n.previousSibling.data.length):pc.before(n):yo(t)?pc(n,r-1):t},Fy=_(My,!0),jy=_(My,!1),Uy=function(e){return ro(e)||io(e)},zy=function(e,t){return Nt(e,t)?jr(t,Uy,function(e){return function(t){return Tt(e,Ct.fromDom(t.dom.parentNode))}}(e)):F.none()},Hy=function(e){e.dom.isEmpty(e.getBody())&&(e.setContent(""),function(e){var t=e.getBody(),n=t.firstChild&&e.dom.isBlock(t.firstChild)?t.firstChild:t;e.selection.setCursorLocation(n,0)}(e))},Vy=function(e,t){return{from:e,to:t}},qy=function(e,t){var n=Ct.fromDom(e),r=Ct.fromDom(t.container());return zy(n,r).map((function(e){return function(e,t){return{block:e,position:t}}(e,t)}))},Wy=function(e,t,n){var r=qy(e,pc.fromRangeStart(n)),o=r.bind((function(n){return hl(t,e,n.position).bind((function(n){return qy(e,n).map((function(n){return function(e,t,n){return Bn(n.position.getNode())&&!1===Vo(n.block)?yl(!1,n.block.dom).bind((function(r){return r.isEqual(n.position)?hl(t,e,r).bind((function(t){return qy(e,t)})):F.some(n)})).getOr(n):n}(e,t,n)}))}))}));return Un(r,o,Vy).filter((function(e){return function(e){return!1===Tt(e.from.block,e.to.block)}(e)&&function(e){return Mt(e.from.block).bind((function(t){return Mt(e.to.block).filter((function(e){return Tt(t,e)}))})).isSome()}(e)&&function(e){return!1===In(e.from.block.dom)&&!1===In(e.to.block.dom)}(e)}))},$y=function(e){var t=Ht(e);return ee(t,eo).fold(N(t),(function(e){return t.slice(0,e)}))},Ky=function(e){var t=$y(e);return $(t,an),t},Xy=function(e,t){var n=sg(t,e);return Z(n.reverse(),(function(e){return Vo(e)})).each(an)},Gy=function(e,t,n,r){if(Vo(n))return ag(n),xl(n.dom);0===G(Ut(r),(function(e){return!Vo(e)})).length&&Vo(t)&&en(r,Ct.fromTag("br"));var o=wl(n.dom,pc.before(r.dom));return $(Ky(t),(function(e){en(r,e)})),Xy(e,t),o},Yy=function(e,t,n){if(Vo(n))return an(n),Vo(t)&&ag(t),xl(t.dom);var r=Sl(n.dom);return $(Ky(t),(function(e){rn(n,e)})),Xy(e,t),r},Qy=function(e,t){return Nt(t,e)?function(e,t){var n=sg(t,e);return F.from(n[n.length-1])}(t,e):F.none()},Jy=function(e,t){yl(e,t.dom).map((function(e){return e.getNode()})).map(Ct.fromDom).filter(no).each(an)},Zy=function(e,t,n){return Jy(!0,t),Jy(!1,n),Qy(t,n).fold(_(Yy,e,t,n),_(Gy,e,t,n))},eC=function(e,t,n,r){return t?Zy(e,r,n):Zy(e,n,r)},tC=function(e,t){var n=Ct.fromDom(e.getBody()),r=function(e,t,n){return n.collapsed?Wy(e,t,n):F.none()}(n.dom,t,e.selection.getRng()).bind((function(e){return eC(n,t,e.from.block,e.to.block)}));return r.each((function(t){e.selection.setRng(t.toRange())})),r.isSome()},nC=function(e,t){var n=Ct.fromDom(t),r=_(Tt,e);return Fr(n,ao,r).isSome()},rC=function(e,t){var n=wl(e.dom,pc.fromRangeStart(t)).isNone(),r=Cl(e.dom,pc.fromRangeEnd(t)).isNone();return!function(e,t){return nC(e,t.startContainer)||nC(e,t.endContainer)}(e,t)&&n&&r},oC=function(e){var t=Ct.fromDom(e.getBody()),n=e.selection.getRng();return rC(t,n)?function(e){return e.setContent(""),e.selection.setCursorLocation(),!0}(e):function(e,t){var n=t.getRng();return Un(zy(e,Ct.fromDom(n.startContainer)),zy(e,Ct.fromDom(n.endContainer)),(function(r,o){return!1===Tt(r,o)&&(n.deleteContents(),eC(e,!0,r,o).each((function(e){t.setRng(e.toRange())})),!0)})).getOr(!1)}(t,e.selection)},iC=function(e,t){return!e.selection.isCollapsed()&&oC(e)},uC=Ln,aC=In,cC=function(e,t,n,r,o){return F.from(t._selectionOverrides.showCaret(e,n,r,o))},fC=function(e,t){return e.fire("BeforeObjectSelected",{target:t}).isDefaultPrevented()?F.none():F.some(function(e){var t=e.ownerDocument.createRange();return t.selectNode(e),t}(t))},lC=function(e,t,n){var r=Xf(1,e.getBody(),t),o=pc.fromRangeStart(r),i=o.getNode();if(Ef(i))return cC(1,e,i,!o.isAtEnd(),!1);var u=o.getNode(!0);if(Ef(u))return cC(1,e,u,!1,!1);var a=e.dom.getParent(o.getNode(),(function(e){return aC(e)||uC(e)}));return Ef(a)?cC(1,e,a,!1,n):F.none()},sC=function(e,t,n){return t.collapsed?lC(e,t,n).getOr(t):t},dC=function(e){return og(e)||eg(e)},mC=function(e){return ig(e)||tg(e)},gC=function(e,t,n,r,o,i){return cC(r,e,i.getNode(!o),o,!0).each((function(n){if(t.collapsed){var r=t.cloneRange();o?r.setEnd(n.startContainer,n.startOffset):r.setStart(n.endContainer,n.endOffset),r.deleteContents()}else t.deleteContents();e.selection.setRng(n)})),function(e,t){_n(t)&&0===t.data.length&&e.remove(t)}(e.dom,n),!0},pC=function(e,t){return function(e,t){var n=e.selection.getRng();if(!_n(n.commonAncestorContainer))return!1;var r=t?hc.Forwards:hc.Backwards,o=sl(e.getBody()),i=_(Jf,t?o.next:o.prev),u=t?dC:mC,a=Yf(r,e.getBody(),n),c=My(t,i(a));if(!c||!Zf(a,c))return!1;if(u(c))return gC(e,n,a.getNode(),r,t,c);var f=i(c);return!!(f&&u(f)&&Zf(c,f))&&gC(e,n,a.getNode(),r,t,f)}(e,t)},hC=pr([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),vC=function(e,t,n,r){var o=r.getNode(!1===t);return zy(Ct.fromDom(e),Ct.fromDom(n.getNode())).map((function(e){return Vo(e)?hC.remove(e.dom):hC.moveToElement(o)})).orThunk((function(){return F.some(hC.moveToElement(o))}))},bC=function(e,t,n){return hl(t,e,n).bind((function(r){return o=r.getNode(),ao(Ct.fromDom(o))||io(Ct.fromDom(o))||function(e,t,n,r){var o=function(t){return to(Ct.fromDom(t))&&!zf(n,r,e)};return Gf(!t,n).fold((function(){return Gf(t,r).fold(B,o)}),o)}(e,t,n,r)?F.none():t&&In(r.getNode())||!1===t&&In(r.getNode(!0))?vC(e,t,n,r):t&&ig(n)||!1===t&&og(n)?F.some(hC.moveToPosition(r)):F.none();var o}))},yC=function(e,t,n){return function(e,t){var n=t.getNode(!1===e),r=e?"after":"before";return wn(n)&&n.getAttribute("data-mce-caret")===r}(t,n)?function(e,t){return e&&In(t.nextSibling)?F.some(hC.moveToElement(t.nextSibling)):!1===e&&In(t.previousSibling)?F.some(hC.moveToElement(t.previousSibling)):F.none()}(t,n.getNode(!1===t)).fold((function(){return bC(e,t,n)}),F.some):bC(e,t,n).bind((function(t){return function(e,t,n){return n.fold((function(e){return F.some(hC.remove(e))}),(function(e){return F.some(hC.moveToElement(e))}),(function(n){return zf(t,n,e)?F.none():F.some(hC.moveToPosition(n))}))}(e,n,t)}))},CC=function(e,t){return F.from(js(e.getBody(),t))},wC=function(e,t){var n=e.selection.getNode();return CC(e,n).filter(In).fold((function(){return function(e,t,n){var r=Xf(t?1:-1,e,n),o=pc.fromRangeStart(r),i=Ct.fromDom(e);return!1===t&&ig(o)?F.some(hC.remove(o.getNode(!0))):t&&og(o)?F.some(hC.remove(o.getNode())):!1===t&&og(o)&&Sg(i,o)?Tg(i,o).map((function(e){return hC.remove(e.getNode())})):t&&ig(o)&&xg(i,o)?kg(i,o).map((function(e){return hC.remove(e.getNode())})):yC(e,t,o)}(e.getBody(),t,e.selection.getRng()).exists((function(n){return n.fold(function(e,t){return function(n){return e._selectionOverrides.hideFakeCaret(),ep(e,t,Ct.fromDom(n)),!0}}(e,t),function(e,t){return function(n){var r=t?pc.before(n):pc.after(n);return e.selection.setRng(r.toRange()),!0}}(e,t),function(e){return function(t){return e.selection.setRng(t.toRange()),!0}}(e))}))}),P)},xC=function(e,t){var n=e.selection.getNode();return!(!In(n)||Mn(n))&&CC(e,n.parentNode).filter(In).fold((function(){var n;return n=Ct.fromDom(e.getBody()),$(Ta(n,".mce-offscreen-selection"),an),ep(e,t,Ct.fromDom(e.selection.getNode())),Hy(e),!0}),P)},SC=function(e){var t=e.dom,n=e.selection,r=js(e.getBody(),n.getNode());if(Ln(r)&&t.isBlock(r)&&t.isEmpty(r)){var o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(r,""),r.appendChild(o),n.setRng(pc.before(o).toRange())}return!0},TC=function(e,t){return e.selection.isCollapsed()?wC(e,t):xC(e,t)},kC=function(e,t){return!!e.selection.isCollapsed()&&function(e,t){var n=pc.fromRangeStart(e.selection.getRng());return hl(t,e.getBody(),n).filter((function(e){return t?Jm(e):Zm(e)})).bind((function(e){return F.from(Hf(t?0:-1,e))})).exists((function(t){return e.selection.select(t),!0}))}(e,t)},NC=_n,EC=function(e){return NC(e)&&"\ufeff"===e.data[0]},RC=function(e){return NC(e)&&"\ufeff"===e.data[e.data.length-1]},_C=function(e){return e.ownerDocument.createTextNode("\ufeff")},DC=function(e,t){return e?function(e){if(NC(e.previousSibling))return RC(e.previousSibling)||e.previousSibling.appendData("\ufeff"),e.previousSibling;if(NC(e))return EC(e)||e.insertData(0,"\ufeff"),e;var t=_C(e);return e.parentNode.insertBefore(t,e),t}(t):function(e){if(NC(e.nextSibling))return EC(e.nextSibling)||e.nextSibling.insertData(0,"\ufeff"),e.nextSibling;if(NC(e))return RC(e)||e.appendData("\ufeff"),e;var t=_C(e);return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t}(t)},AC=_(DC,!0),OC=_(DC,!1),BC=function(e,t){return _n(e.container())?DC(t,e.container()):DC(t,e.getNode())},PC=function(e,t){var n=t.get();return n&&e.container()===n&&po(n)},LC=function(e,t){return t.fold((function(t){yf(e.get());var n=AC(t);return e.set(n),F.some(pc(n,n.length-1))}),(function(t){return xl(t).map((function(t){if(PC(t,e))return pc(e.get(),1);yf(e.get());var n=BC(t,!0);return e.set(n),pc(n,1)}))}),(function(t){return Sl(t).map((function(t){if(PC(t,e))return pc(e.get(),e.get().length-1);yf(e.get());var n=BC(t,!1);return e.set(n),pc(n,n.length-1)}))}),(function(t){yf(e.get());var n=OC(t);return e.set(n),F.some(pc(n,1))}))},IC=function(e,t){for(var n=0;n<e.length;n++){var r=e[n].apply(null,t);if(r.isSome())return r}return F.none()},MC=pr([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),FC=function(e,t){var n=Uf(t,e);return n||e},jC=function(e,t,n){var r=Fy(n),o=FC(t,r.container());return Iy(e,o,r).fold((function(){return Cl(o,r).bind(_(Iy,e,o)).map((function(e){return MC.before(e)}))}),F.none)},UC=function(e,t){return null===kl(e,t)},zC=function(e,t,n){return Iy(e,t,n).filter(_(UC,t))},HC=function(e,t,n){var r=jy(n);return zC(e,t,r).bind((function(e){return wl(e,r).isNone()?F.some(MC.start(e)):F.none()}))},VC=function(e,t,n){var r=Fy(n);return zC(e,t,r).bind((function(e){return Cl(e,r).isNone()?F.some(MC.end(e)):F.none()}))},qC=function(e,t,n){var r=jy(n),o=FC(t,r.container());return Iy(e,o,r).fold((function(){return wl(o,r).bind(_(Iy,e,o)).map((function(e){return MC.after(e)}))}),F.none)},WC=function(e){return!1===Ly(KC(e))},$C=function(e,t,n){return IC([jC,HC,VC,qC],[e,t,n]).filter(WC)},KC=function(e){return e.fold(E,E,E,E)},XC=function(e){return e.fold(N("before"),N("start"),N("end"),N("after"))},GC=function(e){return e.fold(MC.before,MC.before,MC.after,MC.after)},YC=function(e){return e.fold(MC.start,MC.start,MC.end,MC.end)},QC=function(e,t,n,r,o,i){return Un(Iy(t,n,r),Iy(t,n,o),(function(t,r){return t!==r&&function(e,t,n){var r=Uf(t,e),o=Uf(n,e);return r&&r===o}(n,t,r)?MC.after(e?t:r):i})).getOr(i)},JC=function(e,t){return e.fold(P,(function(e){return r=t,!(XC(n=e)===XC(r)&&KC(n)===KC(r));var n,r}))},ZC=function(e,t){return e?t.fold(T(F.some,MC.start),F.none,T(F.some,MC.after),F.none):t.fold(F.none,T(F.some,MC.before),F.none,T(F.some,MC.end))},ew=function(e,t,n,r){var o=My(e,r),i=$C(t,n,o);return $C(t,n,o).bind(_(ZC,e)).orThunk((function(){return function(e,t,n,r,o){var i=My(e,o);return hl(e,n,i).map(_(My,e)).fold((function(){return r.map(GC)}),(function(o){return $C(t,n,o).map(_(QC,e,t,n,i,o)).filter(_(JC,r))})).filter(WC)}(e,t,n,i,r)}))};_(ew,!1),_(ew,!0);var tw,nw=function(e,t,n){var r=e?1:-1;return t.setRng(pc(n.container(),n.offset()+r).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},rw=function(e,t){var n=t.selection.getRng(),r=e?pc.fromRangeEnd(n):pc.fromRangeStart(n);return!!function(e){return w(e.selection.getSel().modify)}(t)&&(e&&bo(r)?nw(!0,t.selection,r):!(e||!yo(r))&&nw(!1,t.selection,r))};!function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"}(tw||(tw={}));var ow,iw=function(e,t){return e===hc.Backwards?re(t):t},uw=function(e,t,n){return e===hc.Forwards?t.next(n):t.prev(n)},aw=function(e,t,n,r){return Bn(r.getNode(t===hc.Forwards))?tw.Br:!1===zf(n,r)?tw.Block:tw.Wrap},cw=function(e,t,n,r){for(var o=sl(n),i=r,u=[];i;){var a=uw(t,o,i);if(!a)break;if(Bn(a.getNode(!1)))return t===hc.Forwards?{positions:iw(t,u).concat([a]),breakType:tw.Br,breakAt:F.some(a)}:{positions:iw(t,u),breakType:tw.Br,breakAt:F.some(a)};if(a.isVisible()){if(e(i,a)){var c=aw(0,t,i,a);return{positions:iw(t,u),breakType:c,breakAt:F.some(a)}}u.push(a),i=a}else i=a}return{positions:iw(t,u),breakType:tw.Eol,breakAt:F.none()}},fw=function(e,t,n,r){return t(n,r).breakAt.map((function(r){var o=t(n,r).positions;return e===hc.Backwards?o.concat(r):[r].concat(o)})).getOr([])},lw=function(e,t){return Q(e,(function(e,n){return e.fold((function(){return F.some(n)}),(function(r){return Un(ae(r.getClientRects()),ae(n.getClientRects()),(function(e,o){var i=Math.abs(t-e.left);return Math.abs(t-o.left)<=i?n:r})).or(e)}))}),F.none())},sw=function(e,t){return ae(t.getClientRects()).bind((function(t){return lw(e,t.left)}))},dw=_(cw,pc.isAbove,-1),mw=_(cw,pc.isBelow,1),gw=_(fw,-1,dw),pw=_(fw,1,mw),hw=function(e){var t=function(t){return W(t,(function(t){var n=za(t);return n.node=e,n}))};if(wn(e))return t(e.getClientRects());if(_n(e)){var n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}},vw=function(e){return te(e,hw)};!function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"}(ow||(ow={}));var bw,yw,Cw=function(e,t,n,r,o,i){var u=0,a=[],c=function(r){var i=vw([r]);-1===e&&(i=i.reverse());for(var c=0;c<i.length;c++){var l=i[c];if(!n(l,f)){if(a.length>0&&t(l,De(a))&&u++,l.line=u,o(l))return!0;a.push(l)}}},f=De(i.getClientRects());if(!f)return a;var l=i.getNode();return c(l),function(e,t,n,r){for(;r=jf(r,e,Lo,t);)if(n(r))return}(e,r,c,l),a},ww=_(Cw,ow.Up,qa,Wa),xw=_(Cw,ow.Down,Wa,qa),Sw=function(e){return function(t){return function(e,t){return t.line>e}(e,t)}},Tw=function(e){return function(t){return function(e,t){return t.line===e}(e,t)}},kw=In,Nw=jf,Ew=function(e,t){return Math.abs(e.left-t)},Rw=function(e,t){return Math.abs(e.right-t)},_w=function(e,t){return e>=t.left&&e<=t.right},Dw=function(e,t){return e>=t.top&&e<=t.bottom},Aw=function(e,t,n){return void 0===n&&(n=P),Re(e,(function(e,r){if(_w(t,r))return n(r)?r:e;if(_w(t,e))return n(e)?e:r;var o=Math.min(Ew(e,t),Rw(e,t)),i=Math.min(Ew(r,t),Rw(r,t));return i===o&&xe(r,"node")&&kw(r.node)||i<o?r:e}))},Ow=function(e,t,n,r,o){var i=Nw(r,e,Lo,t,!o);do{if(!i||n(i))return}while(i=Nw(i,e,Lo,t))},Bw=function(e,t,n){var r=vw(function(e){return G(fe(e.getElementsByTagName("*")),Rf)}(e)),o=G(r,_(Dw,n)),i=function(e){return!Nn(e.node)&&!Fn(e.node)},u=Aw(o,t,i);if(u){var a=i(u);if((u=Aw(function(e,t,n){void 0===n&&(n=!0);var r=[],o=function(e,n){var o=G(vw([n]),(function(n){return!e(n,t)}));return r=r.concat(o),0===o.length};return r.push(t),Ow(ow.Up,e,_(o,qa),t.node,n),Ow(ow.Down,e,_(o,Wa),t.node,n),r}(e,u,a),t,i))&&Rf(u.node))return function(e,t){return{node:e.node,before:Ew(e,t)<Rw(e,t)}}(u,t)}return null},Pw=function(e,t){e.selection.setRng(t),_d(e,e.selection.getRng())},Lw=function(e,t,n){return F.some(sC(e,t,n))},Iw=function(e,t,n,r,o,i){var u=t===hc.Forwards,a=sl(e.getBody()),c=_(Jf,u?a.next:a.prev),f=u?r:o;if(!n.collapsed){var l=Ka(n);if(i(l))return cC(t,e,l,t===hc.Backwards,!1)}var s=Yf(t,e.getBody(),n);if(f(s))return fC(e,s.getNode(!u));var d=My(u,c(s)),m=To(n);if(!d)return m?F.some(n):F.none();if(f(d))return cC(t,e,d.getNode(!u),u,!1);var g=c(d);return g&&f(g)&&Zf(d,g)?cC(t,e,g.getNode(!u),u,!1):m?Lw(e,d.toRange(),!1):F.none()},Mw=function(e,t,n,r,o,i){var u=Yf(t,e.getBody(),n),a=De(u.getClientRects()),c=t===ow.Down;if(!a)return F.none();var f,l=(c?xw:ww)(e.getBody(),Sw(1),u),s=G(l,Tw(1)),d=a.left,m=Aw(s,d);if(m&&i(m.node)){var g=Math.abs(d-m.left),p=Math.abs(d-m.right);return cC(t,e,m.node,g<p,!1)}if(f=r(u)?u.getNode():o(u)?u.getNode(!0):Ka(n)){var h=function(e,t,n,r){var o,i,u,a,c=sl(t),f=[],l=0,s=function(e){return De(e.getClientRects())};1===e?(o=c.next,i=Wa,u=qa,a=pc.after(r)):(o=c.prev,i=qa,u=Wa,a=pc.before(r));var d=s(a);do{if(a.isVisible()){var m=s(a);if(!u(m,d)){f.length>0&&i(m,De(f))&&l++;var g=za(m);if(g.position=a,g.line=l,n(g))return f;f.push(g)}}}while(a=o(a));return f}(t,e.getBody(),Sw(1),f),v=Aw(G(h,Tw(1)),d);if(v)return Lw(e,v.position.toRange(),!1);if(v=De(G(h,Tw(0))))return Lw(e,v.position.toRange(),!1)}return 0===s.length?Fw(e,c).filter(c?o:r).map((function(t){return sC(e,t.toRange(),!1)})):F.none()},Fw=function(e,t){var n=e.selection.getRng(),r=e.getBody();if(t){var o=pc.fromRangeEnd(n),i=mw(r,o);return ce(i.positions)}o=pc.fromRangeStart(n),i=dw(r,o);return ae(i.positions)},jw=function(e,t,n){return Fw(e,t).filter(n).exists((function(t){return e.selection.setRng(t.toRange()),!0}))},Uw=function(e,t){var n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},zw=function(e,t){e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},Hw=function(e,t,n){return LC(t,n).map((function(t){return Uw(e,t),n}))},Vw=function(e,t){if(e.selection.isCollapsed()&&!0!==e.composing&&t.get()){var n=pc.fromRangeStart(e.selection.getRng());pc.isTextPosition(n)&&!1===function(e){return bo(e)||yo(e)}(n)&&(Uw(e,bf(t.get(),n)),t.set(null))}},qw=function(e,t,n){return!!af(e)&&function(e,t,n){var r=e.getBody(),o=pc.fromRangeStart(e.selection.getRng()),i=_(Py,e);return ew(n,i,r,o).bind((function(n){return Hw(e,t,n)}))}(e,t,n).isSome()},Ww=function(e,t,n){return!!af(t)&&rw(e,t)},$w=function(e){var t=aa(null),n=_(Py,e);return e.on("NodeChange",(function(r){!af(e)||mt.browser.isIE()&&r.initial||(function(e,t,n){var r=W(Ta(Ct.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),(function(e){return e.dom})),o=G(r,e),i=G(n,e);$(oe(o,i),_(zw,!1)),$(oe(i,o),_(zw,!0))}(n,e.dom,r.parents),Vw(e,t),function(e,t,n,r){if(t.selection.isCollapsed()){var o=G(r,e);$(o,(function(r){var o=pc.fromRangeStart(t.selection.getRng());$C(e,t.getBody(),o).bind((function(e){return Hw(t,n,e)}))}))}}(n,e,t,r.parents))})),t},Kw=_(Ww,!0),Xw=_(Ww,!1),Gw=function(e,t,n){if(af(e)){var r=Fw(e,t).getOrThunk((function(){var n=e.selection.getRng();return t?pc.fromRangeEnd(n):pc.fromRangeStart(n)}));return $C(_(Py,e),e.getBody(),r).exists((function(t){var r=GC(t);return LC(n,r).exists((function(t){return Uw(e,t),!0}))}))}return!1},Yw=function(e,t){return function(n){return LC(t,n).exists((function(t){return Uw(e,t),!0}))}},Qw=function(e,t,n,r){var o=e.getBody(),i=_(Py,e);e.undoManager.ignore((function(){e.selection.setRng(function(e,t){var n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n}(n,r)),e.execCommand("Delete"),$C(i,o,pc.fromRangeStart(e.selection.getRng())).map(YC).map(Yw(e,t))})),e.nodeChanged()},Jw=function(e,t,n,r){var o=function(e,t){var n=Uf(t,e);return n||e}(e.getBody(),r.container()),i=_(Py,e),u=$C(i,o,r);return u.bind((function(e){return n?e.fold(N(F.some(YC(e))),F.none,N(F.some(GC(e))),F.none):e.fold(F.none,N(F.some(GC(e))),F.none,N(F.some(YC(e))))})).map(Yw(e,t)).getOrThunk((function(){var a=vl(n,o,r),c=a.bind((function(e){return $C(i,o,e)}));return Un(u,c,(function(){return Iy(i,o,r).exists((function(t){return!!function(e){return Un(xl(e),Sl(e),(function(t,n){var r=My(!0,t),o=My(!1,n);return Cl(e,r).forall((function(e){return e.isEqual(o)}))})).getOr(!0)}(t)&&(ep(e,n,Ct.fromDom(t)),!0)}))})).orThunk((function(){return c.bind((function(o){return a.map((function(o){return n?Qw(e,t,r,o):Qw(e,t,o,r),!0}))}))})).getOr(!1)}))},Zw=function(e,t,n){if(e.selection.isCollapsed()&&af(e)){var r=pc.fromRangeStart(e.selection.getRng());return Jw(e,t,n,r)}return!1},ex=function(e){return 1===$t(e)},tx=function(e,t,n,r){var o=_(gh,t),i=W(G(r,o),(function(e){return e.dom}));if(0===i.length)ep(t,e,n);else{var u=function(e,t){var n=ah(!1),r=sh(t,n.dom);return en(Ct.fromDom(e),n),an(Ct.fromDom(e)),pc(r,0)}(n.dom,i);t.selection.setRng(u.toRange())}},nx=function(e,t){var n=Ct.fromDom(e.getBody()),r=Ct.fromDom(e.selection.getStart()),o=G(function(e,t){var n=sg(t,e);return ee(n,eo).fold(N(n),(function(e){return n.slice(0,e)}))}(n,r),ex);return ce(o).exists((function(n){var r,i=pc.fromRangeStart(e.selection.getRng());return!(!function(e,t,n){return Un(xl(n),Sl(n),(function(r,o){var i=My(!0,r),u=My(!1,o),a=My(!1,t);return e?Cl(n,a).exists((function(e){return e.isEqual(u)&&t.isEqual(i)})):wl(n,a).exists((function(e){return e.isEqual(i)&&t.isEqual(u)}))})).getOr(!0)}(t,i,n.dom)||(r=n,Tl(r.dom)&&ih(r.dom)))&&(tx(t,e,n,o),!0)}))},rx=function(e,t){return!!e.selection.isCollapsed()&&nx(e,t)},ox=function(e,t,n){return e._selectionOverrides.hideFakeCaret(),ep(e,t,Ct.fromDom(n)),!0},ix=function(e,t){return e.selection.isCollapsed()?function(e,t){var n=t?eg:tg,r=t?hc.Forwards:hc.Backwards,o=Yf(r,e.getBody(),e.selection.getRng());return n(o)?ox(e,t,o.getNode(!t)):F.from(My(t,o)).filter((function(e){return n(e)&&Zf(o,e)})).exists((function(n){return ox(e,t,n.getNode(!t))}))}(e,t):function(e,t){var n=e.selection.getNode();return!!Fn(n)&&ox(e,t,n)}(e,t)},ux=function(e){var t=parseInt(e,10);return isNaN(t)?0:t},ax=function(e,t){return(e||"table"===Et(t)?"margin":"padding")+("rtl"===Gn(t,"direction")?"-right":"-left")},cx=function(e){var t=lx(e);return!e.mode.isReadOnly()&&(t.length>1||function(e,t){return ne(t,(function(t){var n=ax(ef(e),t),r=Qn(t,n).map(ux).getOr(0);return"false"!==e.dom.getContentEditable(t.dom)&&r>0}))}(e,t))},fx=function(e){return oo(e)||io(e)},lx=function(e){return G((t=e.selection.getSelectedBlocks(),W(t,Ct.fromDom)),(function(e){return!fx(e)&&!function(e){return Mt(e).exists(fx)}(e)&&jr(e,(function(e){return Ln(e.dom)||In(e.dom)})).exists((function(e){return Ln(e.dom)}))}));var t},sx=function(e,t){var n=e.dom,r=e.selection,o=e.formatter,i=function(e){return e.getParam("indentation","40px","string")}(e),u=/[a-z%]+$/i.exec(i)[0],a=parseInt(i,10),c=ef(e),f=Hc(e);e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertOrderedList")||""!==f||n.getParent(r.getNode(),n.isBlock)||o.apply("div"),$(lx(e),(function(e){!function(e,t,n,r,o,i){var u=ax(n,Ct.fromDom(i));if("outdent"===t){var a=Math.max(0,ux(i.style[u])-r);e.setStyle(i,u,a?a+o:"")}else{a=ux(i.style[u])+r+o;e.setStyle(i,u,a)}}(n,t,c,a,u,e.dom)}))},dx=function(e,t){if(e.selection.isCollapsed()&&cx(e)){var n=e.dom,r=e.selection.getRng(),o=pc.fromRangeStart(r),i=n.getParent(r.startContainer,n.isBlock);if(null!==i&&hg(Ct.fromDom(i),o))return sx(e,"outdent"),!0}return!1},mx=function(e,t){e.getDoc().execCommand(t,!1,null)},gx=function(e,t){e.addCommand("delete",(function(){!function(e,t){dx(e)||TC(e,!1)||pC(e,!1)||Zw(e,t,!1)||tC(e,!1)||Dp(e)||kC(e,!1)||ix(e,!1)||iC(e)||rx(e,!1)||(mx(e,"Delete"),Hy(e))}(e,t)})),e.addCommand("forwardDelete",(function(){!function(e,t){TC(e,!0)||pC(e,!0)||Zw(e,t,!0)||tC(e,!0)||Dp(e)||kC(e,!0)||ix(e,!0)||iC(e)||rx(e,!0)||mx(e,"ForwardDelete")}(e,t)}))},px=function(e){return void 0===e.touches||1!==e.touches.length?F.none():F.some(e.touches[0])},hx=function(e){var t=ma(),n=aa(!1),r=pa((function(t){e.fire("longpress",Ae(Ae({},t),{type:"longpress"})),n.set(!0)}),400);e.on("touchstart",(function(e){px(e).each((function(o){r.cancel();var i={x:o.clientX,y:o.clientY,target:e.target};r.throttle(e),n.set(!1),t.set(i)}))}),!0),e.on("touchmove",(function(o){r.cancel(),px(o).each((function(r){t.on((function(o){(function(e,t){var n=Math.abs(e.clientX-t.x),r=Math.abs(e.clientY-t.y);return n>5||r>5})(r,o)&&(t.clear(),n.set(!1),e.fire("longpresscancel"))}))}))}),!0),e.on("touchend touchcancel",(function(o){r.cancel(),"touchcancel"!==o.type&&t.get().filter((function(e){return e.target.isEqualNode(o.target)})).each((function(){n.get()?o.preventDefault():e.fire("tap",Ae(Ae({},o),{type:"tap"}))}))}),!0)},vx=function(e,t){return we(e,t.nodeName)},bx=function(e,t){return!!_n(t)||!!wn(t)&&(!vx(e,t)&&!Il(t))},yx=function(e,t){if(_n(t)){if(0===t.nodeValue.length)return!0;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||vx(e,t.nextSibling)))return!0}return!1},Cx=function(e){var t,n,r,o=e.dom,i=e.selection,u=e.schema,a=u.getBlockElements(),c=i.getStart(),f=e.getBody(),l=Hc(e);if(c&&wn(c)&&l){var s=f.nodeName.toLowerCase();if(u.isValidChild(s,l.toLowerCase())&&!function(e,t,n){return q(lg(Ct.fromDom(n),Ct.fromDom(t)),(function(t){return vx(e,t.dom)}))}(a,f,c)){var d=i.getRng(),m=d.startContainer,g=d.startOffset,p=d.endContainer,h=d.endOffset,v=im(e);for(c=f.firstChild;c;)if(bx(a,c)){if(yx(a,c)){n=c,c=c.nextSibling,o.remove(n);continue}t||(t=o.create(l,Vc(e)),c.parentNode.insertBefore(t,c),r=!0),n=c,c=c.nextSibling,t.appendChild(n)}else t=null,c=c.nextSibling;r&&v&&(d.setStart(m,g),d.setEnd(p,h),i.setRng(d),e.nodeChanged())}}},wx=function(e,t){t.hasAttribute("data-mce-caret")&&(So(t),function(e){e.selection.setRng(e.selection.getRng())}(e),e.selection.scrollIntoView(t))},xx=function(e,t){var n=function(e){return Hr(Ct.fromDom(e.getBody()),"*[data-mce-caret]").map((function(e){return e.dom})).getOrNull()}(e);if(n)return"compositionstart"===t.type?(t.preventDefault(),t.stopPropagation(),void wx(e,n)):void(vo(n)&&(wx(e,n),e.undoManager.add()))},Sx=In,Tx=function(e,t,n){var r=sl(e.getBody()),o=_(Jf,1===t?r.next:r.prev);if(n.collapsed&&function(e){return""!==Hc(e)}(e)){var i=e.dom.getParent(n.startContainer,"PRE");if(!i)return;if(!o(pc.fromRangeStart(n))){var u=function(e){var t=e.dom.create(Hc(e));return(!mt.ie||mt.ie>=11)&&(t.innerHTML='<br data-mce-bogus="1">'),t}(e);1===t?e.$(i).after(u):e.$(i).before(u),e.selection.select(u,!0),e.selection.collapse()}}},kx=function(e,t){var n=t?hc.Forwards:hc.Backwards,r=e.selection.getRng();return function(e,t,n){return Iw(t,e,n,og,ig,Sx)}(n,e,r).orThunk((function(){return Tx(e,n,r),F.none()}))},Nx=function(e,t){var n=t?1:-1,r=e.selection.getRng();return function(e,t,n){return Mw(t,e,n,(function(e){return og(e)||ng(e)}),(function(e){return ig(e)||rg(e)}),Sx)}(n,e,r).orThunk((function(){return Tx(e,n,r),F.none()}))},Ex=function(e,t){return kx(e,t).exists((function(t){return Pw(e,t),!0}))},Rx=function(e,t){return Nx(e,t).exists((function(t){return Pw(e,t),!0}))},_x=function(e,t){return jw(e,t,t?ig:og)},Dx=function(e){return V(["figcaption"],Et(e))},Ax=function(e){var t=document.createRange();return t.setStartBefore(e.dom),t.setEndBefore(e.dom),t},Ox=function(e,t,n){n?rn(e,t):nn(e,t)},Bx=function(e,t,n,r){return""===t?function(e,t){var n=Ct.fromTag("br");return Ox(e,n,t),Ax(n)}(e,r):function(e,t,n,r){var o=Ct.fromTag(n),i=Ct.fromTag("br");return qn(o,r),rn(o,i),Ox(e,o,t),Ax(i)}(e,r,t,n)},Px=function(e,t,n){return t?function(e,t){return mw(e,t).breakAt.isNone()}(e.dom,n):function(e,t){return dw(e,t).breakAt.isNone()}(e.dom,n)},Lx=function(e,t){var n=Ct.fromDom(e.getBody()),r=pc.fromRangeStart(e.selection.getRng()),o=Hc(e),i=Vc(e);return function(e,t){var n=_(Tt,t);return jr(Ct.fromDom(e.container()),eo,n).filter(Dx)}(r,n).exists((function(){if(Px(n,t,r)){var u=Bx(n,o,i,t);return e.selection.setRng(u),!0}return!1}))},Ix=function(e,t){return!!e.selection.isCollapsed()&&Lx(e,t)},Mx=function(e,t){return te(function(e){return W(e,(function(e){return Ae({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:S},e)}))}(e),(function(e){return function(e,t){return t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey}(e,t)?[e]:[]}))},Fx=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){return e.apply(null,t)}},jx=function(e,t){return Z(Mx(e,t),(function(e){return e.action()}))},Ux=function(e,t){var n=t?hc.Forwards:hc.Backwards,r=e.selection.getRng();return Iw(e,n,r,eg,tg,Fn).exists((function(t){return Pw(e,t),!0}))},zx=function(e,t){var n=t?1:-1,r=e.selection.getRng();return Mw(e,n,r,eg,tg,Fn).exists((function(t){return Pw(e,t),!0}))},Hx=function(e,t){return jw(e,t,t?tg:eg)},Vx=function(e,t,n,r,o){var i=Ta(Ct.fromDom(n),"td,th,caption").map((function(e){return e.dom}));return function(e,t,n){return Q(e,(function(e,r){return e.fold((function(){return F.some(r)}),(function(e){var o=Math.sqrt(Math.abs(e.x-t)+Math.abs(e.y-n)),i=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n));return F.some(i<o?r:e)}))}),F.none())}(G(function(e,t){return te(t,(function(t){var n=function(e,t){return{left:e.left-t,top:e.top-t,right:e.right+2*t,bottom:e.bottom+2*t,width:e.width+t,height:e.height+t}}(za(t.getBoundingClientRect()),-1);return[{x:n.left,y:e(n),cell:t},{x:n.right,y:e(n),cell:t}]}))}(e,i),(function(e){return t(e,o)})),r,o).map((function(e){return e.cell}))},qx=_(Vx,(function(e){return e.bottom}),(function(e,t){return e.y<t})),Wx=_(Vx,(function(e){return e.top}),(function(e,t){return e.y>t})),$x=function(e,t){return ae(t.getClientRects()).bind((function(t){return qx(e,t.left,t.top)})).bind((function(e){return sw(Sl(n=e).map((function(e){return dw(n,e).positions.concat(e)})).getOr([]),t);var n}))},Kx=function(e,t){return ce(t.getClientRects()).bind((function(t){return Wx(e,t.left,t.top)})).bind((function(e){return sw(xl(n=e).map((function(e){return[e].concat(mw(n,e).positions)})).getOr([]),t);var n}))},Xx=function(e,t,n){var r=e(t,n);return function(e){return e.breakType===tw.Wrap&&0===e.positions.length}(r)||!Bn(n.getNode())&&function(e){return e.breakType===tw.Br&&1===e.positions.length}(r)?!function(e,t,n){return n.breakAt.exists((function(n){return e(t,n).breakAt.isSome()}))}(e,t,r):r.breakAt.isNone()},Gx=_(Xx,dw),Yx=_(Xx,mw),Qx=function(e,t,n,r){var o=e.selection.getRng(),i=t?1:-1;return!(!Nf()||!function(e,t,n){var r=pc.fromRangeStart(t);return yl(!e,n).exists((function(e){return e.isEqual(r)}))}(t,o,n))&&(cC(i,e,n,!t,!1).each((function(t){Pw(e,t)})),!0)},Jx=function(e,t){var n=t.getNode(e);return wn(n)&&"TABLE"===n.nodeName?F.some(n):F.none()},Zx=function(e,t,n){var r=Jx(!!t,n),o=!1===t;r.fold((function(){return Pw(e,n.toRange())}),(function(r){return yl(o,e.getBody()).filter((function(e){return e.isEqual(n)})).fold((function(){return Pw(e,n.toRange())}),(function(o){return function(e,t,n,r){var o=Hc(t);o?t.undoManager.transact((function(){var r=Ct.fromTag(o);qn(r,Vc(t)),rn(r,Ct.fromTag("br")),e?tn(Ct.fromDom(n),r):en(Ct.fromDom(n),r);var i=t.dom.createRng();i.setStart(r.dom,0),i.setEnd(r.dom,0),Pw(t,i)})):Pw(t,r.toRange())}(t,e,r,n)}))}))},eS=function(e,t,n,r){var o=e.selection.getRng(),i=pc.fromRangeStart(o),u=e.getBody();if(!t&&Gx(r,i)){var a=function(e,t,n){return $x(t,n).orThunk((function(){return ae(n.getClientRects()).bind((function(n){return lw(gw(e,pc.before(t)),n.left)}))})).getOr(pc.before(t))}(u,n,i);return Zx(e,t,a),!0}if(t&&Yx(r,i)){a=function(e,t,n){return Kx(t,n).orThunk((function(){return ae(n.getClientRects()).bind((function(n){return lw(pw(e,pc.after(t)),n.left)}))})).getOr(pc.after(t))}(u,n,i);return Zx(e,t,a),!0}return!1},tS=function(e,t,n){return F.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind((function(r){return F.from(e.dom.getParent(r,"table")).map((function(o){return n(e,t,o,r)}))})).getOr(!1)},nS=function(e,t){return tS(e,t,Qx)},rS=function(e,t){return tS(e,t,eS)},oS=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){var r=ot().os;jx([{keyCode:qs.RIGHT,action:Fx(Ex,e,!0)},{keyCode:qs.LEFT,action:Fx(Ex,e,!1)},{keyCode:qs.UP,action:Fx(Rx,e,!1)},{keyCode:qs.DOWN,action:Fx(Rx,e,!0)},{keyCode:qs.RIGHT,action:Fx(nS,e,!0)},{keyCode:qs.LEFT,action:Fx(nS,e,!1)},{keyCode:qs.UP,action:Fx(rS,e,!1)},{keyCode:qs.DOWN,action:Fx(rS,e,!0)},{keyCode:qs.RIGHT,action:Fx(Ux,e,!0)},{keyCode:qs.LEFT,action:Fx(Ux,e,!1)},{keyCode:qs.UP,action:Fx(zx,e,!1)},{keyCode:qs.DOWN,action:Fx(zx,e,!0)},{keyCode:qs.RIGHT,action:Fx(qw,e,t,!0)},{keyCode:qs.LEFT,action:Fx(qw,e,t,!1)},{keyCode:qs.RIGHT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:Fx(Kw,e,t)},{keyCode:qs.LEFT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:Fx(Xw,e,t)},{keyCode:qs.UP,action:Fx(Ix,e,!1)},{keyCode:qs.DOWN,action:Fx(Ix,e,!0)}],n).each((function(e){n.preventDefault()}))}(e,t,n)}))},iS=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){jx([{keyCode:qs.BACKSPACE,action:Fx(dx,e,!1)},{keyCode:qs.BACKSPACE,action:Fx(TC,e,!1)},{keyCode:qs.DELETE,action:Fx(TC,e,!0)},{keyCode:qs.BACKSPACE,action:Fx(pC,e,!1)},{keyCode:qs.DELETE,action:Fx(pC,e,!0)},{keyCode:qs.BACKSPACE,action:Fx(Zw,e,t,!1)},{keyCode:qs.DELETE,action:Fx(Zw,e,t,!0)},{keyCode:qs.BACKSPACE,action:Fx(Dp,e,!1)},{keyCode:qs.DELETE,action:Fx(Dp,e,!0)},{keyCode:qs.BACKSPACE,action:Fx(kC,e,!1)},{keyCode:qs.DELETE,action:Fx(kC,e,!0)},{keyCode:qs.BACKSPACE,action:Fx(ix,e,!1)},{keyCode:qs.DELETE,action:Fx(ix,e,!0)},{keyCode:qs.BACKSPACE,action:Fx(iC,e,!1)},{keyCode:qs.DELETE,action:Fx(iC,e,!0)},{keyCode:qs.BACKSPACE,action:Fx(tC,e,!1)},{keyCode:qs.DELETE,action:Fx(tC,e,!0)},{keyCode:qs.BACKSPACE,action:Fx(rx,e,!1)},{keyCode:qs.DELETE,action:Fx(rx,e,!0)}],n).each((function(e){n.preventDefault()}))}(e,t,n)})),e.on("keyup",(function(t){!1===t.isDefaultPrevented()&&function(e,t){jx([{keyCode:qs.BACKSPACE,action:Fx(SC,e)},{keyCode:qs.DELETE,action:Fx(SC,e)}],t)}(e,t)}))},uS=function(e,t){var n,r=t,o=e.dom,i=e.schema.getMoveCaretBeforeOnEnterElements();if(t){if(/^(LI|DT|DD)$/.test(t.nodeName)){var u=function(e){for(;e;){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}}(t.firstChild);u&&/^(UL|OL|DL)$/.test(u.nodeName)&&t.insertBefore(o.doc.createTextNode(""),t.firstChild)}var a=o.createRng();if(t.normalize(),t.hasChildNodes()){for(var c=new Qr(t,t);n=c.current();){if(_n(n)){a.setStart(n,0),a.setEnd(n,0);break}if(i[n.nodeName.toLowerCase()]){a.setStartBefore(n),a.setEndBefore(n);break}r=n,n=c.next()}n||(a.setStart(r,0),a.setEnd(r,0))}else Bn(t)?t.nextSibling&&o.isBlock(t.nextSibling)?(a.setStartBefore(t),a.setEndBefore(t)):(a.setStartAfter(t),a.setEndAfter(t)):(a.setStart(t,0),a.setEnd(t,0));e.selection.setRng(a),_d(e,a)}},aS=function(e){return F.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock))},cS=function(e,t){return e&&e.parentNode&&e.parentNode.nodeName===t},fS=function(e){return e&&/^(OL|UL|LI)$/.test(e.nodeName)},lS=function(e){var t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e},sS=function(e,t,n){for(var r=e[n?"firstChild":"lastChild"];r&&!wn(r);)r=r[n?"nextSibling":"previousSibling"];return r===t},dS=function(e,t,n,r,o){var i=e.dom,u=e.selection.getRng();if(n!==e.getBody()){var a;fS(a=n)&&fS(a.parentNode)&&(o="LI");var c=o?t(o):i.create("BR");if(sS(n,r,!0)&&sS(n,r,!1))if(cS(n,"LI")){var f=lS(n);i.insertAfter(c,f),!function(e){var t;return(null===(t=e.parentNode)||void 0===t?void 0:t.firstChild)===e}(n)?i.remove(n):i.remove(f)}else i.replace(c,n);else if(sS(n,r,!0))cS(n,"LI")?(i.insertAfter(c,lS(n)),c.appendChild(i.doc.createTextNode(" ")),c.appendChild(n)):n.parentNode.insertBefore(c,n),i.remove(r);else if(sS(n,r,!1))i.insertAfter(c,lS(n)),i.remove(r);else{n=lS(n);var l=u.cloneRange();l.setStartAfter(r),l.setEndAfter(n);var s=l.extractContents();"LI"===o&&function(e,t){return e.firstChild&&e.firstChild.nodeName===t}(s,"LI")?(c=s.firstChild,i.insertAfter(s,n)):(i.insertAfter(s,n),i.insertAfter(c,n)),i.remove(r)}uS(e,c)}},mS=function(e,t){return t&&"A"===t.nodeName&&e.isEmpty(t)},gS=function(e){e.innerHTML='<br data-mce-bogus="1">'},pS=function(e,t){return e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t},hS=function(e,t){return t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t)},vS=function(e,t,n){return!1===_n(t)?n:e?1===n&&"\ufeff"===t.data.charAt(n-1)?0:n:n===t.data.length-1&&"\ufeff"===t.data.charAt(n)?t.data.length:n},bS=function(e,t){var n,r,o=e.getRoot();for(n=t;n!==o&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==o?r:o},yS=function(e,t){var n=Hc(e);n&&n.toLowerCase()===t.tagName.toLowerCase()&&function(e,t,n){var r=e.dom;F.from(n.style).map(r.parseStyle).each((function(e){var n=Jn(Ct.fromDom(t)),o=Ae(Ae({},n),e);r.setStyles(t,o)}));var o=F.from(n.class).map((function(e){return e.split(/\s+/)})),i=F.from(t.className).map((function(e){return G(e.split(/\s+/),(function(e){return""!==e}))}));Un(o,i,(function(e,n){var o=G(n,(function(t){return!V(e,t)})),i=Oe(Oe([],e,!0),o,!0);r.setAttrib(t,"class",i.join(" "))}));var u=["style","class"],a=be(n,(function(e,t){return!V(u,t)}));r.setAttribs(t,a)}(e,t,Vc(e))},CS=function(e,t){var n,r,o,i,u,a,c,f,l,s,d=e.dom,m=e.schema,g=m.getNonEmptyElements(),p=e.selection.getRng(),h=function(t){var n,o,u,a=r,c=m.getTextInlineElements();if(u=n=t||"TABLE"===f||"HR"===f?d.create(t||l):i.cloneNode(!1),!1===function(e){return e.getParam("keep_styles",!0)}(e))d.setAttrib(n,"style",null),d.setAttrib(n,"class",null);else do{if(c[a.nodeName]){if(Tl(a)||Il(a))continue;o=a.cloneNode(!1),d.setAttrib(o,"id",""),n.hasChildNodes()?(o.appendChild(n.firstChild),n.appendChild(o)):(u=o,n.appendChild(o))}}while((a=a.parentNode)&&a!==w);return yS(e,n),gS(u),n},v=function(e){var t,n,u=vS(e,r,o);if(_n(r)&&(e?u>0:u<r.nodeValue.length))return!1;if(r.parentNode===i&&s&&!e)return!0;if(e&&wn(r)&&r===i.firstChild)return!0;if(pS(r,"TABLE")||pS(r,"HR"))return s&&!e||!s&&e;var a=new Qr(r,i);for(_n(r)&&(e&&0===u?a.prev():e||u!==r.nodeValue.length||a.next());t=a.current();){if(wn(t)){if(!t.getAttribute("data-mce-bogus")&&(n=t.nodeName.toLowerCase(),g[n]&&"br"!==n))return!1}else if(_n(t)&&!Mo(t.nodeValue))return!1;e?a.prev():a.next()}return!0},b=function(){u=/^(H[1-6]|PRE|FIGURE)$/.test(f)&&"HGROUP"!==x?h(l):h(),function(e){return e.getParam("end_container_on_empty_block",!1)}(e)&&hS(d,c)&&d.isEmpty(i)?u=d.split(c,i):d.insertAfter(u,i),uS(e,u)};od(d,p).each((function(e){p.setStart(e.startContainer,e.startOffset),p.setEnd(e.endContainer,e.endOffset)})),r=p.startContainer,o=p.startOffset,l=Hc(e);var y=!(!t||!t.shiftKey),C=!(!t||!t.ctrlKey);wn(r)&&r.hasChildNodes()&&(s=o>r.childNodes.length-1,r=r.childNodes[Math.min(o,r.childNodes.length-1)]||r,o=s&&_n(r)?r.nodeValue.length:0);var w=bS(d,r);if(w){(l&&!y||!l&&y)&&(r=function(e,t,n,r,o){var i,u,a,c,f,l,s=t||"P",d=e.dom,m=bS(d,r);if(!(u=d.getParent(r,d.isBlock))||!hS(d,u)){if(l=(u=u||m)===e.getBody()||function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)}(u)?u.nodeName.toLowerCase():u.parentNode.nodeName.toLowerCase(),!u.hasChildNodes())return i=d.create(s),yS(e,i),u.appendChild(i),n.setStart(i,0),n.setEnd(i,0),i;for(c=r;c.parentNode!==u;)c=c.parentNode;for(;c&&!d.isBlock(c);)a=c,c=c.previousSibling;if(a&&e.schema.isValidChild(l,s.toLowerCase())){for(i=d.create(s),yS(e,i),a.parentNode.insertBefore(i,a),c=a;c&&!d.isBlock(c);)f=c.nextSibling,i.appendChild(c),c=f;n.setStart(r,o),n.setEnd(r,o)}}return r}(e,l,p,r,o)),i=d.getParent(r,d.isBlock),c=i?d.getParent(i.parentNode,d.isBlock):null,f=i?i.nodeName.toUpperCase():"";var x=c?c.nodeName.toUpperCase():"";"LI"!==x||C||(i=c,c=c.parentNode,f=x),/^(LI|DT|DD)$/.test(f)&&d.isEmpty(i)?dS(e,h,c,i,l):l&&i===e.getBody()||(l=l||"P",go(i)?(u=So(i),d.isEmpty(i)&&gS(i),yS(e,u),uS(e,u)):v()?b():v(!0)?(u=i.parentNode.insertBefore(h(),i),uS(e,pS(i,"HR")?u:i)):((n=function(e){var t=e.cloneRange();return t.setStart(e.startContainer,vS(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,vS(!1,e.endContainer,e.endOffset)),t}(p).cloneRange()).setEndAfter(i),function(e){$(Sa(Ct.fromDom(e),At),(function(e){var t=e.dom;t.nodeValue=lo(t.nodeValue)}))}(a=n.extractContents()),function(e){do{_n(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild}while(e)}(a),u=a.firstChild,d.insertAfter(a,i),function(e,t,n){var r,o=n,i=[];if(o){for(;o=o.firstChild;){if(e.isBlock(o))return;wn(o)&&!t[o.nodeName.toLowerCase()]&&i.push(o)}for(r=i.length;r--;)(!(o=i[r]).hasChildNodes()||o.firstChild===o.lastChild&&""===o.firstChild.nodeValue||mS(e,o))&&e.remove(o)}}(d,g,u),function(e,t){t.normalize();var n=t.lastChild;n&&!/^(left|right)$/gi.test(e.getStyle(n,"float",!0))||e.add(t,"br")}(d,i),d.isEmpty(i)&&gS(i),u.normalize(),d.isEmpty(u)?(d.remove(u),b()):(yS(e,u),uS(e,u))),d.setAttrib(u,"id",""),e.fire("NewBlock",{newBlock:u}))}},wS=function(e,t,n){var r=e.dom.createRng();n?(r.setStartBefore(t),r.setEndBefore(t)):(r.setStartAfter(t),r.setEndAfter(t)),e.selection.setRng(r),_d(e,r)},xS=function(e,t){var n,r,o=e.selection,i=e.dom,u=o.getRng();od(i,u).each((function(e){u.setStart(e.startContainer,e.startOffset),u.setEnd(e.endContainer,e.endOffset)}));var a=u.startOffset,c=u.startContainer;if(1===c.nodeType&&c.hasChildNodes()){var f=a>c.childNodes.length-1;c=c.childNodes[Math.min(a,c.childNodes.length-1)]||c,a=f&&3===c.nodeType?c.nodeValue.length:0}var l=i.getParent(c,i.isBlock),s=l?i.getParent(l.parentNode,i.isBlock):null,d=s?s.nodeName.toUpperCase():"",m=!(!t||!t.ctrlKey);"LI"!==d||m||(l=s),c&&3===c.nodeType&&a>=c.nodeValue.length&&(function(e,t,n){for(var r,o=new Qr(t,n),i=e.getNonEmptyElements();r=o.next();)if(i[r.nodeName.toLowerCase()]||r.length>0)return!0}(e.schema,c,l)||(n=i.create("br"),u.insertNode(n),u.setStartAfter(n),u.setEndAfter(n),r=!0)),n=i.create("br"),bc(i,u,n),wS(e,n,r),e.undoManager.add()},SS=function(e,t){var n=Ct.fromTag("br");en(Ct.fromDom(t),n),e.undoManager.add()},TS=function(e,t){kS(e.getBody(),t)||tn(Ct.fromDom(t),Ct.fromTag("br"));var n=Ct.fromTag("br");tn(Ct.fromDom(t),n),wS(e,n.dom,!1),e.undoManager.add()},kS=function(e,t){return n=pc.after(t),!!Bn(n.getNode())||Cl(e,pc.after(t)).map((function(e){return Bn(e.getNode())})).getOr(!1);var n},NS=function(e){return e&&"A"===e.nodeName&&"href"in e},ES=function(e){return e.fold(B,NS,NS,B)},RS=function(e,t){t.fold(S,_(SS,e),_(TS,e),S)},_S=function(e,t){var n=function(e){var t=_(Py,e),n=pc.fromRangeStart(e.selection.getRng());return $C(t,e.getBody(),n).filter(ES)}(e);n.isSome()?n.each(_(RS,e)):xS(e,t)},DS=function(e,t){return aS(e).filter((function(e){return t.length>0&&xt(Ct.fromDom(e),t)})).isSome()},AS=pr([{br:[]},{block:[]},{none:[]}]),OS=function(e,t){return function(e){return DS(e,function(e){return e.getParam("no_newline_selector","")}(e))}(e)},BS=function(e){return function(t,n){return""===Hc(t)===e}},PS=function(e){return function(t,n){return function(e){return aS(e).filter((function(e){return io(Ct.fromDom(e))})).isSome()}(t)===e}},LS=function(e,t){return function(n,r){return function(e){return aS(e).fold(N(""),(function(e){return e.nodeName.toUpperCase()}))}(n)===e.toUpperCase()===t}},IS=function(e){return LS("pre",e)},MS=function(e){return function(t,n){return function(e){return e.getParam("br_in_pre",!0)}(t)===e}},FS=function(e,t){return function(e){return DS(e,function(e){return e.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")}(e))}(e)},jS=function(e,t){return t},US=function(e){var t=Hc(e),n=function(e,t){var n,r,o=e.getRoot();for(n=t;n!==o&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==o?r:o}(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t||"P")},zS=function(e,t){return function(n,r){return Q(e,(function(e,t){return e&&t(n,r)}),!0)?F.some(t):F.none()}},HS=function(e,t){(function(e,t){return IC([zS([OS],AS.none()),zS([LS("summary",!0)],AS.br()),zS([IS(!0),MS(!1),jS],AS.br()),zS([IS(!0),MS(!1)],AS.block()),zS([IS(!0),MS(!0),jS],AS.block()),zS([IS(!0),MS(!0)],AS.br()),zS([PS(!0),jS],AS.br()),zS([PS(!0)],AS.block()),zS([BS(!0),jS,US],AS.block()),zS([BS(!0)],AS.br()),zS([FS],AS.br()),zS([BS(!1),jS],AS.br()),zS([US],AS.block())],[e,!(!t||!t.shiftKey)]).getOr(AS.none())})(e,t).fold((function(){_S(e,t)}),(function(){CS(e,t)}),S)},VS=function(e){e.on("keydown",(function(t){t.keyCode===qs.ENTER&&function(e,t){var n;t.isDefaultPrevented()||(t.preventDefault(),(n=e.undoManager).typing&&(n.typing=!1,n.add()),e.undoManager.transact((function(){!1===e.selection.isCollapsed()&&e.execCommand("Delete"),HS(e,t)})))}(e,t)}))},qS=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){jx([{keyCode:qs.END,action:Fx(_x,e,!0)},{keyCode:qs.HOME,action:Fx(_x,e,!1)},{keyCode:qs.END,action:Fx(Hx,e,!0)},{keyCode:qs.HOME,action:Fx(Hx,e,!1)},{keyCode:qs.END,action:Fx(Gw,e,!0,t)},{keyCode:qs.HOME,action:Fx(Gw,e,!1,t)}],n).each((function(e){n.preventDefault()}))}(e,t,n)}))},WS=ot().browser,$S=function(e){!function(e){var t=ga((function(){e.composing||jg(e)}),0);WS.isIE()&&(e.on("keypress",(function(e){t.throttle()})),e.on("remove",(function(e){t.cancel()})))}(e),e.on("input",(function(t){!1===t.isComposing&&jg(e)}))},KS=ot(),XS=function(e){return e.stopImmediatePropagation()},GS=function(e){return e.keyCode===qs.PAGE_UP||e.keyCode===qs.PAGE_DOWN},YS=function(e,t,n){n&&!e.get()?t.on("NodeChange",XS,!0):!n&&e.get()&&t.off("NodeChange",XS),e.set(n)},QS=function(e,t){if(!KS.os.isOSX()){var n=aa(!1);e.on("keydown",(function(t){GS(t)&&YS(n,e,!0)})),e.on("keyup",(function(r){!1===r.isDefaultPrevented()&&function(e,t,n){jx([{keyCode:qs.PAGE_UP,action:Fx(Gw,e,!1,t)},{keyCode:qs.PAGE_DOWN,action:Fx(Gw,e,!0,t)}],n)}(e,t,r),GS(r)&&n.get()&&(YS(n,e,!1),e.nodeChanged())}))}},JS=function(e,t){var n=t.container(),r=t.offset();return _n(n)?(n.insertData(r,e),F.some(pc(n,r+e.length))):Qf(t).map((function(n){var r=Ct.fromText(e);return t.isAtEnd()?tn(n,r):en(n,r),pc(r.dom,e.length)}))},ZS=_(JS,""),eT=_(JS," "),tT=function(e,t){return function(n){return function(e,t){return!Dg(t)&&(Ag(e,t)||Rg(e,t)||_g(e,t))}(e,n)?ZS(t):eT(t)}},nT=function(e){var t=pc.fromRangeStart(e.selection.getRng()),n=Ct.fromDom(e.getBody());if(e.selection.isCollapsed()){var r=_(Py,e),o=pc.fromRangeStart(e.selection.getRng());return $C(r,e.getBody(),o).bind(function(e){return function(t){return t.fold((function(t){return wl(e.dom,pc.before(t))}),(function(e){return xl(e)}),(function(e){return Sl(e)}),(function(t){return Cl(e.dom,pc.after(t))}))}}(n)).bind(tT(n,t)).exists(function(e){return function(t){return e.selection.setRng(t.toRange()),e.nodeChanged(),!0}}(e))}return!1},rT=function(e){e.on("keydown",(function(t){!1===t.isDefaultPrevented()&&function(e,t){jx([{keyCode:qs.SPACEBAR,action:Fx(nT,e)}],t).each((function(e){t.preventDefault()}))}(e,t)}))},oT=function(e){var t=$w(e);return function(e){e.on("keyup compositionstart",_(xx,e))}(e),oS(e,t),iS(e,t),VS(e),rT(e),$S(e),qS(e,t),QS(e,t),t},iT=function(){function e(e){var t;this.lastPath=[],this.editor=e;var n=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",(function(n){var r=e.selection.getRng(),o={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};"nodechange"!==n.type&&Gs(o,t)||e.fire("SelectionChange"),t=o})),e.on("contextmenu",(function(){e.fire("SelectionChange")})),e.on("SelectionChange",(function(){var t=e.selection.getStart(!0);!t||!mt.range&&e.selection.isCollapsed()||Rs(e)&&!n.isSameElementPath(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:!0})})),e.on("mouseup",(function(t){!t.isDefaultPrevented()&&Rs(e)&&("IMG"===e.selection.getNode().nodeName?Xr.setEditorTimeout(e,(function(){e.nodeChanged()})):e.nodeChanged())}))}return e.prototype.nodeChanged=function(e){var t,n,r,o=this.editor.selection;this.editor.initialized&&o&&!this.editor.getParam("disable_nodechange")&&!this.editor.mode.isReadOnly()&&(r=this.editor.getBody(),(t=o.getStart(!0)||r).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(t,r)||(t=r),n=[],this.editor.dom.getParent(t,(function(e){if(e===r)return!0;n.push(e)})),(e=e||{}).element=t,e.parents=n,this.editor.fire("NodeChange",e))},e.prototype.isSameElementPath=function(e){var t,n=this.editor.$(e).parentsUntil(this.editor.getBody()).add(e);if(n.length===this.lastPath.length){for(t=n.length;t>=0&&n[t]===this.lastPath[t];t--);if(-1===t)return this.lastPath=n,!0}return this.lastPath=n,!1},e}(),uT=function(e){!function(e){e.on("click",(function(t){e.dom.getParent(t.target,"details")&&t.preventDefault()}))}(e),function(e){e.parser.addNodeFilter("details",(function(e){$(e,(function(e){e.attr("data-mce-open",e.attr("open")),e.attr("open","open")}))})),e.serializer.addNodeFilter("details",(function(e){$(e,(function(e){var t=e.attr("data-mce-open");e.attr("open",m(t)?t:null),e.attr("data-mce-open",null)}))}))}(e)},aT=function(e){return wn(e)&&ro(Ct.fromDom(e))},cT=function(e){e.on("click",(function(t){t.detail>=3&&function(e){var t=e.selection.getRng(),n=pc.fromRangeStart(t),r=pc.fromRangeEnd(t);if(pc.isElementPosition(n)){var o=n.container();aT(o)&&xl(o).each((function(e){return t.setStart(e.container(),e.offset())}))}if(pc.isElementPosition(r)){o=n.container();aT(o)&&Sl(o).each((function(e){return t.setEnd(e.container(),e.offset())}))}e.selection.setRng(Op(t))}(e)}))},fT=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.documentElement,o=n.defaultView;return{top:t.top+o.pageYOffset-r.clientTop,left:t.left+o.pageXOffset-r.clientLeft}},lT=function(e,t){return function(e,t,n){return{pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}}(function(e){return e.inline?fT(e.getBody()):{left:0,top:0}}(e),function(e){var t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}}(e),function(e,t){if(t.target.ownerDocument!==e.getDoc()){var n=fT(e.getContentAreaContainer()),r=function(e){var t=e.getBody(),n=e.getDoc().documentElement,r={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?r:o}(e);return{left:t.pageX-n.left+r.left,top:t.pageY-n.top+r.top}}return{left:t.pageX,top:t.pageY}}(e,t))},sT=In,dT=Ln,mT=function(e,t,n,r){var o=e.dom,i=t.cloneNode(!0);o.setStyles(i,{width:n,height:r}),o.setAttrib(i,"data-mce-selected",null);var u=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(u,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:r}),o.setStyles(i,{margin:0,boxSizing:"border-box"}),u.appendChild(i),u},gT=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},pT=function(e,t){return function(n){if(function(e){return 0===e.button}(n)){var r=Z(t.dom.getParents(n.target),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(e[n](t))return!0;return!1}}(sT,dT)).getOr(null);if(a=t.getBody(),sT(c=r)&&c!==a){var o=t.dom.getPos(r),i=t.getBody(),u=t.getDoc().documentElement;e.set({element:r,dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?i.scrollWidth:u.offsetWidth)-2,maxY:(t.inline?i.scrollHeight:u.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:r.offsetWidth,height:r.offsetHeight,ghost:mT(t,r,r.offsetWidth,r.offsetHeight)})}}var a,c}},hT=function(e,t){return function(n){e.on((function(e){if(e.dragging){if(function(e,t,n){return t!==n&&!e.dom.isChildOf(t,n)&&!sT(t)}(t,(u=t.selection,3===(a=u.getSel().getRangeAt(0).startContainer).nodeType?a.parentNode:a),e.element)){var r=(o=e.element,(i=o.cloneNode(!0)).removeAttribute("data-mce-selected"),i);t.fire("drop",{clientX:n.clientX,clientY:n.clientY}).isDefaultPrevented()||t.undoManager.transact((function(){gT(e.element),t.insertContent(t.dom.getOuterHTML(r)),t._selectionOverrides.hideFakeCaret()}))}t.fire("dragend")}var o,i,u,a})),vT(e)}},vT=function(e){e.on((function(e){gT(e.ghost)})),e.clear()},bT=function(e){var t=ma(),n=na.DOM,r=document,o=pT(t,e),i=function(e,t){var n=Xr.throttle((function(e,n){t._selectionOverrides.hideFakeCaret(),t.selection.placeCaretAt(e,n)}),0);return t.on("remove",n.stop),function(r){return e.on((function(e){var o,i,u=Math.max(Math.abs(r.screenX-e.screenX),Math.abs(r.screenY-e.screenY));if(!e.dragging&&u>10){if(t.fire("dragstart",{target:e.element}).isDefaultPrevented())return;e.dragging=!0,t.focus()}if(e.dragging){var a=function(e,t){return{pageX:t.pageX-e.relX,pageY:t.pageY+5}}(e,lT(t,r));o=e.ghost,i=t.getBody(),o.parentNode!==i&&i.appendChild(o),function(e,t,n,r,o,i){var u=0,a=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(u=t.pageX+n-o),t.pageY+r>i&&(a=t.pageY+r-i),e.style.width=n-u+"px",e.style.height=r-a+"px"}(e.ghost,a,e.width,e.height,e.maxX,e.maxY),n(r.clientX,r.clientY)}}))}}(t,e),u=hT(t,e),a=function(e,t){return function(){e.on((function(e){e.dragging&&t.fire("dragend")})),vT(e)}}(t,e);e.on("mousedown",o),e.on("mousemove",i),e.on("mouseup",u),n.bind(r,"mousemove",i),n.bind(r,"mouseup",a),e.on("remove",(function(){n.unbind(r,"mousemove",i),n.unbind(r,"mouseup",a)})),e.on("keydown",(function(e){e.keyCode===qs.ESC&&a()}))},yT=function(e){bT(e),function(e){e.on("drop",(function(t){var n=void 0!==t.clientX?e.getDoc().elementFromPoint(t.clientX,t.clientY):null;(sT(n)||"false"===e.dom.getContentEditableParent(n))&&t.preventDefault()}))}(e),function(e){return e.getParam("block_unsupported_drop",!0,"boolean")}(e)&&function(e){var t=function(t){if(!t.isDefaultPrevented()){var n=t.dataTransfer;n&&(V(n.types,"Files")||n.files.length>0)&&(t.preventDefault(),"drop"===t.type&&iy(e,"Dropped file type is not supported"))}},n=function(n){Jd(e,n.target)&&t(n)},r=function(){var r=na.DOM,o=e.dom,i=document,u=e.inline?e.getBody():e.getDoc(),a=["drop","dragover"];$(a,(function(e){r.bind(i,e,n),o.bind(u,e,t)})),e.on("remove",(function(){$(a,(function(e){r.unbind(i,e,n),o.unbind(u,e,t)}))}))};e.on("init",(function(){Xr.setEditorTimeout(e,r,0)}))}(e)},CT=Ln,wT=In,xT=function(e,t){return js(e.getBody(),t)},ST=function(e){var t,n=e.selection,r=e.dom,o=r.isBlock,i=e.getBody(),u=kf(e,i,o,(function(){return im(e)})),a="sel-"+r.uniqueId(),c=function(e){return e!==i&&(wT(e)||Fn(e))&&r.isChildOf(e,i)},f=function(e){return og(e)||ig(e)||eg(e)||tg(e)},l=function(e){e&&n.setRng(e)},s=n.getRng,d=function(t,r,o,i){return void 0===i&&(i=!0),e.fire("ShowCaret",{target:r,direction:t,before:o}).isDefaultPrevented()?null:(i&&n.scrollIntoView(r,-1===t),u.show(o,r))},m=function(e){return ho(e)||wo(e)||xo(e)},g=function(e){return m(e.startContainer)||m(e.endContainer)},p=function(t){var n=e.schema.getShortEndedElements(),o=r.createRng(),i=t.startContainer,u=t.startOffset,a=t.endContainer,c=t.endOffset;return we(n,i.nodeName.toLowerCase())?0===u?o.setStartBefore(i):o.setStartAfter(i):o.setStart(i,u),we(n,a.nodeName.toLowerCase())?0===c?o.setEndBefore(a):o.setEndAfter(a):o.setEnd(a,c),o},h=function(o){var i=o.cloneNode(!0),u=e.fire("ObjectSelected",{target:o,targetClone:i});if(u.isDefaultPrevented())return null;var c=function(t,o,i){var u=e.$,c=Hr(Ct.fromDom(e.getBody()),"#"+a).fold((function(){return u([])}),(function(e){return u([e.dom])}));0===c.length&&(c=u('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",a)).appendTo(e.getBody());var f=r.createRng();o===i&&mt.ie?(c.empty().append('<p style="font-size: 0" data-mce-bogus="all"></p>').append(o),f.setStartAfter(c[0].firstChild.firstChild),f.setEndAfter(o)):(c.empty().append("").append(o).append(""),f.setStart(c[0].firstChild,1),f.setEnd(c[0].lastChild,0)),c.css({top:r.getPos(t,e.getBody()).y}),c[0].focus();var l=n.getSel();return l.removeAllRanges(),l.addRange(f),f}(o,u.targetClone,i),f=Ct.fromDom(o);return $(Ta(Ct.fromDom(e.getBody()),"*[data-mce-selected]"),(function(e){Tt(f,e)||Kn(e,"data-mce-selected")})),r.getAttrib(o,"data-mce-selected")||o.setAttribute("data-mce-selected","1"),t=o,C(),c},v=function(e,t){if(!e)return null;if(e.collapsed){if(!g(e)){var n=t?1:-1,o=Yf(n,i,e),u=o.getNode(!t);if(Rf(u))return d(n,u,!!t&&!o.isAtEnd(),!1);var a=o.getNode(t);if(Rf(a))return d(n,a,!t&&!o.isAtEnd(),!1)}return null}var f=e.startContainer,l=e.startOffset,s=e.endOffset;if(3===f.nodeType&&0===l&&wT(f.parentNode)&&(f=f.parentNode,l=r.nodeIndex(f),f=f.parentNode),1!==f.nodeType)return null;if(s===l+1&&f===e.endContainer){var m=f.childNodes[l];if(c(m))return h(m)}return null},b=function(){t&&t.removeAttribute("data-mce-selected"),Hr(Ct.fromDom(e.getBody()),"#"+a).each(an),t=null},C=function(){u.hide()};return mt.ceFalse&&!Ov(e)&&function(){e.on("mouseup",(function(t){var n=s();n.collapsed&&Jb(e,t.clientX,t.clientY)&&lC(e,n,!1).each(l)})),e.on("click",(function(t){var o=xT(e,t.target);o&&(wT(o)&&(t.preventDefault(),e.focus()),CT(o)&&r.isChildOf(o,n.getNode())&&b())})),e.on("blur NewBlock",b),e.on("ResizeWindow FullscreenStateChanged",u.reposition);var m=function(t,n){var i,u,a=r.getParent(t,o),c=r.getParent(n,o);return!y(a)&&(!(t===c||!r.isChildOf(a,c)||!1!==wT(xT(e,a)))||!r.isChildOf(c,a)&&(i=a,u=c,!(r.getParent(i,o)===r.getParent(u,o)))&&function(e){var t=e.firstChild;if(y(t))return!1;var n=pc.before(t);if(Bn(n.getNode())&&1===e.childNodes.length)return!f(n);var r=sl(e).next(n);return r&&!f(r)}(a))};e.on("tap",(function(t){var n=t.target,r=xT(e,n);wT(r)?(t.preventDefault(),fC(e,r).each(v)):c(n)&&fC(e,n).each(v)}),!0),e.on("mousedown",(function(t){var o=t.target;if((o===i||"HTML"===o.nodeName||r.isChildOf(o,i))&&!1!==Jb(e,t.clientX,t.clientY)){var u=xT(e,o);if(u)wT(u)?(t.preventDefault(),fC(e,u).each(v)):(b(),CT(u)&&t.shiftKey||Us(t.clientX,t.clientY,n.getRng())||(C(),n.placeCaretAt(t.clientX,t.clientY)));else if(c(o))fC(e,o).each(v);else if(!1===Rf(o)){b(),C();var a=Bw(i,t.clientX,t.clientY);if(a&&!m(o,a.node)){t.preventDefault();var f=d(1,a.node,a.before,!1);l(f),e.getBody().focus()}}}})),e.on("keypress",(function(e){qs.modifierPressed(e)||wT(n.getNode())&&e.preventDefault()})),e.on("GetSelectionRange",(function(e){var n=e.range;if(t){if(!t.parentNode)return void(t=null);(n=n.cloneRange()).selectNode(t),e.range=n}})),e.on("SetSelectionRange",(function(e){e.range=p(e.range);var t=v(e.range,e.forward);t&&(e.range=t)}));e.on("AfterSetSelectionRange",(function(e){var t=e.range,n=t.startContainer.parentNode;g(t)||"mcepastebin"===n.id||C(),function(e){return r.hasClass(e,"mce-offscreen-selection")}(n)||b()})),e.on("copy",(function(e){var t,n=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!mt.ie){var o=(t=r.get(a))?t.getElementsByTagName("*")[0]:t;o&&(e.preventDefault(),n.clearData(),n.setData("text/html",o.outerHTML),n.setData("text/plain",o.outerText||o.innerText))}})),yT(e),function(e){var t=ga((function(){if(!e.removed&&e.getBody().contains(document.activeElement)){var t=e.selection.getRng();if(t.collapsed){var n=sC(e,t,!1);e.selection.setRng(n)}}}),0);e.on("focus",(function(){t.throttle()})),e.on("blur",(function(){t.cancel()}))}(e),function(e){e.on("init",(function(){e.on("focusin",(function(t){var n=t.target;if(Fn(n)){var r=js(e.getBody(),n),o=In(r)?r:n;e.selection.getNode()!==o&&fC(e,o).each((function(t){return e.selection.setRng(t)}))}}))}))}(e)}(),{showCaret:d,showBlockCaretContainer:function(e){e.hasAttribute("data-mce-caret")&&(So(e),l(s()),n.scrollIntoView(e))},hideFakeCaret:C,destroy:function(){u.destroy(),t=null}}},TT=function(e){var t,n,r=bt.each,o=qs.BACKSPACE,i=qs.DELETE,u=e.dom,a=e.selection,c=e.parser,f=mt.gecko,l=mt.ie,s=mt.webkit,d=l?"Text":"URL",m=function(t,n){try{e.getDoc().execCommand(t,!1,n)}catch(e){}},g=function(e){return e.isDefaultPrevented()},p=function(){var t=function(e){var t=u.create("body"),n=e.cloneContents();return t.appendChild(n),a.serializer.serialize(t,{format:"html"})};e.on("keydown",(function(n){var r,a,c=n.keyCode;if(!g(n)&&(c===i||c===o)){if(r=e.selection.isCollapsed(),a=e.getBody(),r&&!u.isEmpty(a))return;if(!r&&!function(n){var r=t(n),o=u.createRng();return o.selectNode(e.getBody()),r===t(o)}(e.selection.getRng()))return;n.preventDefault(),e.setContent(""),a.firstChild&&u.isBlock(a.firstChild)?e.selection.setCursorLocation(a.firstChild,0):e.selection.setCursorLocation(a,0),e.nodeChanged()}}))},h=function(){e.shortcuts.add("meta+a",null,"SelectAll")},v=function(){e.inline||u.bind(e.getDoc(),"mousedown mouseup",(function(t){var n;if(t.target===e.getDoc().documentElement)if(n=a.getRng(),e.getBody().focus(),"mousedown"===t.type){if(ho(n.startContainer))return;a.placeCaretAt(t.clientX,t.clientY)}else a.setRng(n)}))},b=function(){Range.prototype.getClientRects||e.on("mousedown",(function(t){if(!g(t)&&"HTML"===t.target.nodeName){var n=e.getBody();n.blur(),Xr.setEditorTimeout(e,(function(){n.focus()}))}}))},y=function(){e.on("click",(function(t){var n=t.target;/^(IMG|HR)$/.test(n.nodeName)&&"false"!==u.getContentEditableParent(n)&&(t.preventDefault(),e.selection.select(n),e.nodeChanged()),"A"===n.nodeName&&u.hasClass(n,"mce-item-anchor")&&(t.preventDefault(),a.select(n))}))},C=function(){e.on("keydown",(function(e){if(!g(e)&&e.keyCode===o&&a.isCollapsed()&&0===a.getRng().startOffset){var t=a.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}}))},w=function(){(function(e){return e.getParam("readonly")})(e)||e.on("BeforeExecCommand mousedown",(function(){m("StyleWithCSS",!1),m("enableInlineTableEditing",!1),nf(e)||m("enableObjectResizing",!1)}))},x=function(){e.on("SetContent ExecCommand",(function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||r(u.select("a"),(function(e){var t=e.parentNode,n=u.getRoot();if(t.lastChild===e){for(;t&&!u.isBlock(t);){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}u.add(t,"br",{"data-mce-bogus":1})}}))}))},T=function(){e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},k=function(){e.inline||e.on("keydown",(function(){document.activeElement===document.body&&e.getWin().focus()}))},N=function(){e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",(function(t){var n;if("HTML"===t.target.nodeName){if(mt.ie>11)return void e.getBody().focus();n=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(n),e.selection.normalize(),e.nodeChanged()}})))},E=function(){mt.mac&&e.on("keydown",(function(t){!qs.metaKeyPressed(t)||t.shiftKey||37!==t.keyCode&&39!==t.keyCode||(t.preventDefault(),e.selection.getSel().modify("move",37===t.keyCode?"backward":"forward","lineboundary"))}))},R=function(){e.on("click",(function(e){var t=e.target;do{if("A"===t.tagName)return void e.preventDefault()}while(t=t.parentNode)})),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},_=function(){e.on("init",(function(){e.dom.bind(e.getBody(),"submit",(function(e){e.preventDefault()}))}))},D=function(){e.on("dragstart",(function(t){!function(t){var n,r;t.dataTransfer&&(e.selection.isCollapsed()&&"IMG"===t.target.tagName&&a.select(t.target),(n=e.selection.getContent()).length>0&&(r="data:text/mce-internal,"+escape(e.id)+","+escape(n),t.dataTransfer.setData(d,r)))}(t)})),e.on("drop",(function(t){if(!g(t)){var n=function(e){var t;return e.dataTransfer&&(t=e.dataTransfer.getData(d))&&t.indexOf("data:text/mce-internal,")>=0?(t=t.substr("data:text/mce-internal,".length).split(","),{id:unescape(t[0]),html:unescape(t[1])}):null}(t);if(n&&n.id!==e.id){t.preventDefault();var r=Xs(t.x,t.y,e.getDoc());a.setRng(r),o=n.html,i=!0,e.queryCommandSupported("mceInsertClipboardContent")?e.execCommand("mceInsertClipboardContent",!1,{content:o,internal:i}):e.execCommand("mceInsertContent",!1,o)}}var o,i}))},A=S;return Ov(e)?(s&&(v(),y(),_(),h(),mt.iOS&&(k(),N(),R())),f&&(b(),w(),T(),E())):(e.on("keydown",(function(t){var n,r;if(!g(t)&&t.keyCode===qs.BACKSPACE){var o=(n=a.getRng()).startContainer,i=n.startOffset,c=u.getRoot();if(r=o,n.collapsed&&0===i){for(;r&&r.parentNode&&r.parentNode.firstChild===r&&r.parentNode!==c;)r=r.parentNode;"BLOCKQUOTE"===r.tagName&&(e.formatter.toggle("blockquote",null,r),(n=u.createRng()).setStart(o,0),n.setEnd(o,0),a.setRng(n))}}})),p(),mt.windowsPhone||e.on("keyup focusin mouseup",(function(e){qs.modifierPressed(e)||a.normalize()}),!0),s&&(v(),y(),Hc(e)&&e.on("init",(function(){m("DefaultParagraphSeparator",Hc(e))})),_(),C(),c.addNodeFilter("br",(function(e){for(var t=e.length;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()})),mt.iOS?(k(),N(),R()):h()),mt.ie>=11&&(N(),C()),mt.ie&&(h(),m("AutoUrlDetect",!1),D()),f&&(e.on("keydown",(function(t){if(!g(t)&&t.keyCode===o){if(!e.getBody().getElementsByTagName("hr").length)return;if(a.isCollapsed()&&0===a.getRng().startOffset){var n=a.getNode(),r=n.previousSibling;if("HR"===n.nodeName)return u.remove(n),void t.preventDefault();r&&r.nodeName&&"hr"===r.nodeName.toLowerCase()&&(u.remove(r),t.preventDefault())}}})),b(),t=function(){var t=u.getAttribs(a.getStart().cloneNode(!1));return function(){var n=a.getStart();n!==e.getBody()&&(u.setAttrib(n,"style",null),r(t,(function(e){n.setAttributeNode(e.cloneNode(!0))})))}},n=function(){return!a.isCollapsed()&&u.getParent(a.getStart(),u.isBlock)!==u.getParent(a.getEnd(),u.isBlock)},e.on("keypress",(function(r){var o;if(!g(r)&&(8===r.keyCode||46===r.keyCode)&&n())return o=t(),e.getDoc().execCommand("delete",!1,null),o(),r.preventDefault(),!1})),u.bind(e.getDoc(),"cut",(function(r){var o;!g(r)&&n()&&(o=t(),Xr.setEditorTimeout(e,(function(){o()})))})),w(),x(),T(),E(),C())),{refreshContentEditable:A,isHidden:function(){if(!f||e.removed)return!1;var t=e.selection.getSel();return!t||!t.rangeCount||0===t.rangeCount}}},kT=na.DOM,NT=function(e){return e.inline?e.getElement().nodeName.toLowerCase():void 0},ET=function(e){return be(e,(function(e){return!1===b(e)}))},RT=function(e){var t=e.settings,n=e.editorUpload.blobCache;return ET({allow_conditional_comments:t.allow_conditional_comments,allow_html_data_urls:t.allow_html_data_urls,allow_svg_data_urls:t.allow_svg_data_urls,allow_html_in_named_anchor:t.allow_html_in_named_anchor,allow_script_urls:t.allow_script_urls,allow_unsafe_link_target:t.allow_unsafe_link_target,convert_fonts_to_spans:t.convert_fonts_to_spans,fix_list_elements:t.fix_list_elements,font_size_legacy_values:t.font_size_legacy_values,forced_root_block:t.forced_root_block,forced_root_block_attrs:t.forced_root_block_attrs,padd_empty_with_br:t.padd_empty_with_br,preserve_cdata:t.preserve_cdata,remove_trailing_brs:t.remove_trailing_brs,inline_styles:t.inline_styles,root_name:NT(e),validate:!0,blob_cache:n,document:e.getDoc(),images_dataimg_filter:t.images_dataimg_filter})},_T=function(e){var t=e.dom.getRoot();e.inline||Rs(e)&&e.selection.getStart(!0)!==t||xl(t).each((function(t){var n=t.getNode(),r=Nn(n)?xl(n).getOr(t):t;mt.browser.isIE()?function(e,t){var n=Ct.fromDom(e.getBody()),r=(Hd(e)?F.from(t):F.none()).map(Vd).filter(zd(n));e.bookmark=r.isSome()?r:e.bookmark}(e,r.toRange()):e.selection.setRng(r.toRange())}))},DT=function(e){e.bindPendingEventDelegates(),e.initialized=!0,function(e){e.fire("Init")}(e),e.focus(!0),_T(e),e.nodeChanged({initial:!0}),e.execCallback("init_instance_callback",e),function(e){e.settings.auto_focus&&Xr.setEditorTimeout(e,(function(){var t;(t=!0===e.settings.auto_focus?e:e.editorManager.get(e.settings.auto_focus)).destroyed||t.focus()}),100)}(e)},AT=function(e){return e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader},OT=function(e){var t=AT(e),n=tf(e),r=e.contentCSS,o=function(){t.unloadAll(r),e.inline||e.ui.styleSheetLoader.unloadAll(n)},i=function(){e.removed?o():e.on("remove",o)};if(e.contentStyles.length>0){var u="";bt.each(e.contentStyles,(function(e){u+=e+"\r\n"})),e.dom.addStyle(u)}var a=qr.all(function(e,t,n){var r=[new qr((function(n,r){return AT(e).loadAll(t,n,r)}))];return e.inline?r:r.concat([new qr((function(t,r){return e.ui.styleSheetLoader.loadAll(n,t,r)}))])}(e,r,n)).then(i).catch(i);return e.settings.content_style&&function(e,t){var n=Ct.fromDom(e.getBody()),r=Qt(Yt(n)),o=Ct.fromTag("style");Vn(o,"type","text/css"),rn(o,Ct.fromText(t)),rn(r,o),e.on("remove",(function(){an(o)}))}(e,e.settings.content_style),a},BT=function(e){var t=e.settings,n=e.getDoc(),r=e.getBody();!function(e){e.fire("PreInit")}(e),t.browser_spellcheck||t.gecko_spellcheck||(n.body.spellcheck=!1,kT.setAttrib(r,"spellcheck","false")),e.quirks=TT(e),function(e){e.fire("PostRender")}(e);var o=function(e){return e.getParam("directionality",sa.isRtl()?"rtl":void 0)}(e);void 0!==o&&(r.dir=o),t.protect&&e.on("BeforeSetContent",(function(e){bt.each(t.protect,(function(t){e.content=e.content.replace(t,(function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"}))}))})),e.on("SetContent",(function(){e.addVisual(e.getBody())})),e.on("compositionstart compositionend",(function(t){e.composing="compositionstart"===t.type}))},PT=function(e){!0!==e.removed&&(!function(e){Ov(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})}(e),DT(e))},LT=function(e,t){var n=e.settings,r=e.getElement(),o=e.getDoc();n.inline||(e.getElement().style.visibility=e.orgVisibility),t||e.inline||(o.open(),o.write(e.iframeHTML),o.close()),e.inline&&(kT.addClass(r,"mce-content-body"),e.contentDocument=o=document,e.contentWindow=window,e.bodyElement=r,e.contentAreaContainer=r);var i=e.getBody();i.disabled=!0,e.readonly=!!n.readonly,e.readonly||(e.inline&&"static"===kT.getStyle(i,"position",!0)&&(i.style.position="relative"),i.contentEditable=e.getParam("content_editable_state",!0)),i.disabled=!1,e.editorUpload=yy(e),e.schema=vi(n),e.dom=na(o,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,hex_colors:n.force_hex_style_colors,update_styles:!0,root_element:e.inline?e.getBody():null,collect:function(){return e.inline},schema:e.schema,contentCssCors:Qc(e),referrerPolicy:Jc(e),onSetAttrib:function(t){e.fire("SetAttrib",t)}}),e.parser=function(e){var t=fb(RT(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(function(t,n){for(var r,o,i=t.length,u=e.dom,a="data-mce-"+n;i--;)if((o=(r=t[i]).attr(n))&&!r.attr(a)){if(0===o.indexOf("data:")||0===o.indexOf("blob:"))continue;"style"===n?((o=u.serializeStyle(u.parseStyle(o),r.name)).length||(o=null),r.attr(a,o),r.attr(n,o)):"tabindex"===n?(r.attr(a,o),r.attr(n,null)):r.attr(a,e.convertURL(o,n,r.name))}})),t.addNodeFilter("script",(function(e){for(var t=e.length;t--;){var n=e[t],r=n.attr("type")||"no/type";0!==r.indexOf("mce-")&&n.attr("type","mce-"+r)}})),e.settings.preserve_cdata&&t.addNodeFilter("#cdata",(function(t){for(var n=t.length;n--;){var r=t[n];r.type=8,r.name="#comment",r.value="[CDATA["+e.dom.encode(r.value)+"]]"}})),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",(function(t){for(var n=t.length,r=e.schema.getNonEmptyElements();n--;){var o=t[n];o.isEmpty(r)&&0===o.getAll("br").length&&(o.append(new bm("br",1)).shortEnded=!0)}})),t}(e),e.serializer=gb(function(e){var t=e.settings;return Ae(Ae({},RT(e)),ET({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope,element_format:t.element_format,entities:t.entities,entity_encoding:t.entity_encoding,indent:t.indent,indent_after:t.indent_after,indent_before:t.indent_before,block_elements:t.block_elements,boolean_attributes:t.boolean_attributes,custom_elements:t.custom_elements,extended_valid_elements:t.extended_valid_elements,invalid_elements:t.invalid_elements,invalid_styles:t.invalid_styles,move_caret_before_on_enter_elements:t.move_caret_before_on_enter_elements,non_empty_elements:t.non_empty_elements,schema:t.schema,self_closing_elements:t.self_closing_elements,short_ended_elements:t.short_ended_elements,special:t.special,text_block_elements:t.text_block_elements,text_inline_elements:t.text_inline_elements,valid_children:t.valid_children,valid_classes:t.valid_classes,valid_elements:t.valid_elements,valid_styles:t.valid_styles,verify_html:t.verify_html,whitespace_elements:t.whitespace_elements}))}(e),e),e.selection=Wv(e.dom,e.getWin(),e.serializer,e),e.annotator=Ms(e),e.formatter=Ny(e),e.undoManager=Ry(e),e._nodeChangeDispatcher=new iT(e),e._selectionOverrides=ST(e),hx(e),uT(e),Ov(e)||cT(e);var u=function(e){return Ov(e)?aa(null):oT(e)}(e);gx(e,u),function(e){Hc(e)&&e.on("NodeChange",_(Cx,e))}(e),Oy(e);var a=Bv(e);BT(e),a.fold((function(){OT(e).then((function(){return PT(e)}))}),(function(t){e.setProgressState(!0),OT(e).then((function(){t().then((function(t){e.setProgressState(!1),PT(e)}),(function(t){e.notificationManager.open({type:"error",text:String(t)}),PT(e)}))}))}))},IT=na.DOM,MT=function(e){var t=function(e){return e.getParam("doctype","<!DOCTYPE html>")}(e)+"<html><head>";(function(e){return e.getParam("document_base_url","")})(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';var n=function(e){return Uc(e,"body_id","tinymce")}(e),r=function(e){return Uc(e,"body_class","")}(e),o=e.translate(function(e){return e.getParam("iframe_aria_text","Rich Text Area. Press ALT-0 for help.","string")}(e));return zc(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+zc(e)+'" />'),t+='</head><body id="'+n+'" class="mce-content-body '+r+'" data-id="'+e.id+'" aria-label="'+o+'"><br></body></html>'},FT=function(e,t){var n,r,o,i,u=e.translate("Rich Text Area"),a=(n=e.id,r=u,t.height,o=function(e){return e.getParam("iframe_attrs",{})}(e),i=Ct.fromTag("iframe"),qn(i,o),qn(i,{id:n+"_ifr",frameBorder:"0",allowTransparency:"true",title:r}),Ca(i,"tox-edit-area__iframe"),i).dom;a.onload=function(){a.onload=null,e.fire("load")};var c=function(e,t){if(document.domain!==window.location.hostname&&mt.browser.isIE()){var n=py("mce");e[n]=function(){LT(e)};var r='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+e.id+'");document.write(ed.iframeHTML);document.close();ed.'+n+"(true);})()";return IT.setAttrib(t,"src",r),!0}return!1}(e,a);return e.contentAreaContainer=t.iframeContainer,e.iframeElement=a,e.iframeHTML=MT(e),IT.add(t.iframeContainer,a),c},jT=na.DOM,UT=function(e,t,n){var r=ty.get(n),o=ty.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=bt.trim(n),r&&-1===bt.inArray(t,n)){if(bt.each(ty.dependencies(n),(function(n){UT(e,t,n)})),e.plugins[n])return;try{var i=new r(e,o,e.$);e.plugins[n]=i,i.init&&(i.init(e,o),t.push(n))}catch(t){!function(e,t,n){var r=sa.translate(["Failed to initialize plugin: {0}",t]);zs(e,"PluginLoadError",{message:r}),fy(r,n),iy(e,r)}(e,n,t)}}},zT=function(e){return e.replace(/^\-/,"")},HT=function(e){return{editorContainer:e,iframeContainer:e,api:{}}},VT=function(e){var t=e.getElement();return e.inline?HT(null):function(e){var t=jT.create("div");return jT.insertAfter(t,e),HT(t)}(t)},qT=function(e){var t=e.getElement();return e.orgDisplay=t.style.display,m(of(e))?function(e){return e.theme.renderUI()}(e):w(of(e))?function(e){var t=e.getElement(),n=of(e)(e,t);return n.editorContainer.nodeType&&(n.editorContainer.id=n.editorContainer.id||e.id+"_parent"),n.iframeContainer&&n.iframeContainer.nodeType&&(n.iframeContainer.id=n.iframeContainer.id||e.id+"_iframecontainer"),n.height=n.iframeHeight?n.iframeHeight:t.offsetHeight,n}(e):VT(e)},WT=function(e){e.fire("ScriptsLoaded"),function(e){var t=bt.trim($c(e)),n=e.ui.registry.getAll().icons,r=Ae(Ae({},Wb.get("default").icons),Wb.get(t).icons);me(r,(function(t,r){we(n,r)||e.ui.registry.addIcon(r,t)}))}(e),function(e){var t=of(e);if(m(t)){e.settings.theme=zT(t);var n=ny.get(t);e.theme=new n(e,ny.urls[t]),e.theme.init&&e.theme.init(e,ny.urls[t]||e.documentBaseUrl.replace(/\/$/,""),e.$)}else e.theme={}}(e),function(e){var t=[];bt.each(ff(e).split(/[ ,]/),(function(n){UT(e,t,zT(n))}))}(e);var t=qT(e);!function(e,t){var n={show:F.from(t.show).getOr(S),hide:F.from(t.hide).getOr(S),disable:F.from(t.disable).getOr(S),isDisabled:F.from(t.isDisabled).getOr(B),enable:function(){e.mode.isReadOnly()||F.from(t.enable).map(O)}};e.ui=Ae(Ae({},e.ui),n)}(e,F.from(t.api).getOr({}));var n={editorContainer:t.editorContainer,iframeContainer:t.iframeContainer};return e.editorContainer=n.editorContainer?n.editorContainer:null,dy(e),e.inline?LT(e):function(e,t){var n=FT(e,t);t.editorContainer&&(IT.get(t.editorContainer).style.display=e.orgDisplay,e.hidden=IT.isHidden(t.editorContainer)),e.getElement().style.display="none",IT.setAttrib(e.id,"aria-hidden","true"),n||LT(e)}(e,n)},$T=na.DOM,KT=function(e){return"-"===e.charAt(0)},XT=function(e,t){var n=Zc(t),r=function(e){return e.getParam("language_url","","string")}(t);if(!1===sa.hasCode(n)&&"en"!==n){var o=""!==r?r:t.editorManager.baseURL+"/langs/"+n+".js";e.add(o,S,void 0,(function(){!function(e,t,n){uy(e,"LanguageLoadError",ay("language",t,n))}(t,o,n)}))}},GT=function(e,t,n){return F.from(t).filter((function(e){return e.length>0&&!Wb.has(e)})).map((function(t){return{url:e.editorManager.baseURL+"/icons/"+t+"/icons"+n+".js",name:F.some(t)}}))},YT=function(e,t,n){var r=GT(t,"default",n),o=function(e){return F.from(function(e){return e.getParam("icons_url","","string")}(e)).filter((function(e){return e.length>0})).map((function(e){return{url:e,name:F.none()}}))}(t).orThunk((function(){return GT(t,$c(t),"")}));$(function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t}([r,o]),(function(n){e.add(n.url,S,void 0,(function(){!function(e,t,n){uy(e,"IconsLoadError",ay("icons",t,n))}(t,n.url,n.name.getOrUndefined())}))}))},QT=function(e,t){var n=ua.ScriptLoader;!function(e,t,n,r){var o=of(t);if(m(o)){if(!KT(o)&&!we(ny.urls,o)){var i=function(e){return e.getParam("theme_url")}(t);i?ny.load(o,t.documentBaseURI.toAbsolute(i)):ny.load(o,"themes/"+o+"/theme"+n+".js")}e.loadQueue((function(){ny.waitFor(o,r)}))}else r()}(n,e,t,(function(){XT(n,e),YT(n,e,t),function(e,t){bt.each(function(e){return e.getParam("external_plugins")}(e),(function(t,n){ty.load(n,t,S,void 0,(function(){cy(e,t,n)})),e.settings.plugins+=" "+n})),bt.each(ff(e).split(/[ ,]/),(function(n){if((n=bt.trim(n))&&!ty.urls[n])if(KT(n)){n=n.substr(1,n.length);var r=ty.dependencies(n);bt.each(r,(function(n){var r={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"},o=ty.createUrl(r,n);ty.load(o.resource,o,S,void 0,(function(){cy(e,o.prefix+o.resource+o.suffix,o.resource)}))}))}else{var o={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"};ty.load(n,o,S,void 0,(function(){cy(e,o.prefix+o.resource+o.suffix,n)}))}}))}(e,t),n.loadQueue((function(){e.removed||WT(e)}),e,(function(){e.removed||WT(e)}))}))},JT=function(e){var t=e.id;sa.setCode(Zc(e));var n=function(){$T.unbind(window,"ready",n),e.render()};if(Ri.Event.domLoaded){if(e.getElement()&&mt.contentEditable){var r=Ct.fromDom(e.getElement()),o=function(e){return Q(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})}(r);e.on("remove",(function(){K(r.dom.attributes,(function(e){return Kn(r,e.name)})),qn(r,o)})),e.ui.styleSheetLoader=function(e,t){return Yr.forElement(e,{contentCssCors:cf(t),referrerPolicy:Jc(t)})}(r,e),!function(e){return e.getParam("inline")}(e)?(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden"):e.inline=!0;var i=e.getElement().form||$T.getParent(t,"form");i&&(e.formElement=i,function(e){return e.getParam("hidden_input")}(e)&&!Rn(e.getElement())&&($T.insertAfter($T.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=function(t){e.fire(t.type,t)},$T.bind(i,"submit reset",e.formEventDelegate),e.on("reset",(function(){e.resetContent()})),!function(e){return e.getParam("submit_patch")}(e)||i.submit.nodeType||i.submit.length||i._mceOldSubmit||(i._mceOldSubmit=i.submit,i.submit=function(){return e.editorManager.triggerSave(),e.setDirty(!1),i._mceOldSubmit(i)})),e.windowManager=ry(e),e.notificationManager=ey(e),function(e){return"xml"===e.getParam("encoding")}(e)&&e.on("GetContent",(function(e){e.save&&(e.content=$T.encode(e.content))})),function(e){return e.getParam("add_form_submit_trigger")}(e)&&e.on("submit",(function(){e.initialized&&e.save()})),function(e){return e.getParam("add_unload_trigger")}(e)&&(e._beforeUnload=function(){!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),QT(e,e.suffix)}}else $T.bind(window,"ready",n)},ZT=function(e,t){return function(e,t){return Lv(e).editor.addVisual(t)}(e,t)},ek={"font-size":"size","font-family":"face"},tk=function(e,t,n){return Gp(Ct.fromDom(n),(function(t){return function(t){return Qn(t,e).orThunk((function(){return"font"===Et(t)?Ce(ek,e).bind((function(e){return $n(t,e)})):F.none()}))}(t)}),(function(e){return Tt(Ct.fromDom(t),e)}))},nk=function(e){return function(t,n){return F.from(n).map(Ct.fromDom).filter(Dt).bind((function(n){return tk(e,t,n.dom).or(function(e,t){return F.from(na.DOM.getStyle(t,e,!0))}(e,n.dom))})).getOr("")}},rk=nk("font-size"),ok=T((function(e){return e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")}),nk("font-family")),ik=function(e){return xl(e.getBody()).map((function(e){var t=e.container();return _n(t)?t.parentNode:t}))},uk=function(e,t){return function(e){return F.from(e.selection.getRng()).bind((function(t){var n=e.getBody();return t.startContainer===n&&0===t.startOffset?F.none():F.from(e.selection.getStart(!0))}))}(e).orThunk(_(ik,e)).map(Ct.fromDom).filter(Dt).bind(t)},ak=function(e,t){return uk(e,k(F.some,t))},ck=function(e,t){if(/^[0-9.]+$/.test(t)){var n=parseInt(t,10);if(n>=1&&n<=7){var r=function(e){return bt.explode(e.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large"))}(e),o=function(e){return bt.explode(e.getParam("font_size_classes",""))}(e);return o?o[n-1]||t:r[n-1]||t}return t}return t},fk=function(e){var t=e.split(/\s*,\s*/);return W(t,(function(e){return-1===e.indexOf(" ")||je(e,'"')||je(e,"'")?e:"'"+e+"'"})).join(",")},lk=function(e,t){var n=function(e){if("string"!=typeof e){var t=bt.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}}(t);!function(e,t,n){Pv(e).editor.insertContent(t,n)}(e,n.content,n.details)},sk=bt.each,dk=bt.map,mk=bt.inArray,gk=function(){function e(e){this.commands={state:{},exec:{},value:{}},this.editor=e,this.setupCommands(e)}return e.prototype.execCommand=function(e,t,n,r){var o,i=!1,u=this;if(!u.editor.removed){var a;if("mcefocus"!==e.toLowerCase()&&(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(e)||r&&r.skip_focus?(a=u.editor,Kd(a).each((function(e){return a.selection.setRng(e)}))):u.editor.focus()),(r=u.editor.fire("BeforeExecCommand",{command:e,ui:t,value:n})).isDefaultPrevented())return!1;var c=e.toLowerCase();if(o=u.commands.exec[c])return o(c,t,n),u.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;if(sk(this.editor.plugins,(function(r){if(r.execCommand&&r.execCommand(e,t,n))return u.editor.fire("ExecCommand",{command:e,ui:t,value:n}),i=!0,!1})),i)return i;if(u.editor.theme&&u.editor.theme.execCommand&&u.editor.theme.execCommand(e,t,n))return u.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;try{i=u.editor.getDoc().execCommand(e,t,n)}catch(e){}return!!i&&(u.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0)}},e.prototype.queryCommandState=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.state[e])return t(e);try{return this.editor.getDoc().queryCommandState(e)}catch(e){}return!1}},e.prototype.queryCommandValue=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.value[e])return t(e);try{return this.editor.getDoc().queryCommandValue(e)}catch(e){}}},e.prototype.addCommands=function(e,t){void 0===t&&(t="exec");var n=this;sk(e,(function(e,r){sk(r.toLowerCase().split(","),(function(r){n.commands[t][r]=e}))}))},e.prototype.addCommand=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.exec[e]=function(e,o,i,u){return t.call(n||r.editor,o,i,u)}},e.prototype.queryCommandSupported=function(e){if(e=e.toLowerCase(),this.commands.exec[e])return!0;try{return this.editor.getDoc().queryCommandSupported(e)}catch(e){}return!1},e.prototype.addQueryStateHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.state[e]=function(){return t.call(n||r.editor)}},e.prototype.addQueryValueHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.value[e]=function(){return t.call(n||r.editor)}},e.prototype.hasCustomCommand=function(e){return e=e.toLowerCase(),!!this.commands.exec[e]},e.prototype.execNativeCommand=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=null),this.editor.getDoc().execCommand(e,t,n)},e.prototype.isFormatMatch=function(e){return this.editor.formatter.match(e)},e.prototype.toggleFormat=function(e,t){this.editor.formatter.toggle(e,t),this.editor.nodeChanged()},e.prototype.storeSelection=function(e){this.selectionBookmark=this.editor.selection.getBookmark(e)},e.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},e.prototype.setupCommands=function(e){var t=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":S,"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},mceFocus:function(t,n,r){cm(e,r)},"Cut,Copy,Paste":function(n){var r,o=e.getDoc();try{t.execNativeCommand(n)}catch(e){r=!0}if("paste"!==n||o.queryCommandEnabled(n)||(r=!0),r||!o.queryCommandSupported(n)){var i=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");mt.mac&&(i=i.replace(/Ctrl\+/g,"+")),e.notificationManager.open({text:i,type:"error"})}},unlink:function(){if(e.selection.isCollapsed()){var t=e.dom.getParent(e.selection.getStart(),"a");t&&e.dom.remove(t,!0)}else e.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(n){var r=n.substring(7);"full"===r&&(r="justify"),sk("left,center,right,justify".split(","),(function(t){r!==t&&e.formatter.remove("align"+t)})),"none"!==r&&t.toggleFormat("align"+r)},"InsertUnorderedList,InsertOrderedList":function(n){var r;t.execNativeCommand(n);var o=e.dom.getParent(e.selection.getNode(),"ol,ul");o&&(r=o.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(r.nodeName)&&(t.storeSelection(),e.dom.split(r,o),t.restoreSelection()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){t.toggleFormat(e)},"ForeColor,HiliteColor":function(e,n,r){t.toggleFormat(e,{value:r})},FontName:function(t,n,r){!function(e,t){var n=ck(e,t);e.formatter.toggle("fontname",{value:fk(n)}),e.nodeChanged()}(e,r)},FontSize:function(t,n,r){!function(e,t){e.formatter.toggle("fontsize",{value:ck(e,t)}),e.nodeChanged()}(e,r)},LineHeight:function(t,n,r){!function(e,t){e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()}(e,r)},Lang:function(e,n,r){t.toggleFormat(e,{value:r.code,customValue:r.customCode})},RemoveFormat:function(t){e.formatter.remove(t)},mceBlockQuote:function(){t.toggleFormat("blockquote")},FormatBlock:function(e,n,r){return t.toggleFormat(r||"p")},mceCleanup:function(){var t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},mceRemoveNode:function(n,r,o){var i=o||e.selection.getNode();i!==e.getBody()&&(t.storeSelection(),e.dom.remove(i,!0),t.restoreSelection())},mceSelectNodeDepth:function(t,n,r){var o=0;e.dom.getParent(e.selection.getNode(),(function(t){if(1===t.nodeType&&o++===r)return e.selection.select(t),!1}),e.getBody())},mceSelectNode:function(t,n,r){e.selection.select(r)},mceInsertContent:function(t,n,r){lk(e,r)},mceInsertRawHTML:function(t,n,r){e.selection.setContent("tiny_mce_marker");var o=e.getContent();e.setContent(o.replace(/tiny_mce_marker/g,(function(){return r})))},mceInsertNewLine:function(t,n,r){HS(e,r)},mceToggleFormat:function(e,n,r){t.toggleFormat(r)},mceSetContent:function(t,n,r){e.setContent(r)},"Indent,Outdent":function(t){sx(e,t)},mceRepaint:S,InsertHorizontalRule:function(){e.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual,e.addVisual()},mceReplaceContent:function(t,n,r){e.execCommand("mceInsertContent",!1,r.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceInsertLink:function(t,n,r){"string"==typeof r&&(r={href:r});var o=e.dom.getParent(e.selection.getNode(),"a");r.href=r.href.replace(/ /g,"%20"),o&&r.href||e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,o)},selectAll:function(){var t=e.dom.getParent(e.selection.getStart(),Ln);if(t){var n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}},mceNewDocument:function(){e.setContent("")},InsertLineBreak:function(t,n,r){return _S(e,r),!0}});var n=function(t){return function(){var n=e.selection,r=n.isCollapsed()?[e.dom.getParent(n.getNode(),e.dom.isBlock)]:n.getSelectedBlocks(),o=dk(r,(function(n){return!!e.formatter.matchNode(n,t)}));return-1!==mk(o,!0)}};t.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return t.isFormatMatch(e)},mceBlockQuote:function(){return t.isFormatMatch("blockquote")},Outdent:function(){return cx(e)},"InsertUnorderedList,InsertOrderedList":function(t){var n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===t&&"UL"===n.tagName||"insertorderedlist"===t&&"OL"===n.tagName)}},"state"),t.addCommands({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}}),t.addQueryValueHandler("FontName",(function(){return function(e){return ak(e,(function(t){return ok(e.getBody(),t.dom)})).getOr("")}(e)}),this),t.addQueryValueHandler("FontSize",(function(){return function(e){return ak(e,(function(t){return rk(e.getBody(),t.dom)})).getOr("")}(e)}),this),t.addQueryValueHandler("LineHeight",(function(){return function(e){return ak(e,(function(t){var n=Ct.fromDom(e.getBody());return Gp(t,(function(e){return Qn(e,"line-height")}),_(Tt,n)).getOrThunk((function(){var e=parseFloat(Gn(t,"line-height")),n=parseFloat(Gn(t,"font-size"));return String(e/n)}))})).getOr("")}(e)}),this)},e}(),pk=function(e,t,n){xa(e,t)&&!1===n?function(e,t){va(e)?e.dom.classList.remove(t):ya(e,t);wa(e)}(e,t):n&&Ca(e,t)},hk=function(e,t,n){try{e.getDoc().execCommand(t,!1,String(n))}catch(e){}},vk=function(e,t){e.dom.contentEditable=t?"true":"false"},bk=function(e,t){var n=Ct.fromDom(e.getBody());pk(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),function(e){F.from(e.selection.getNode()).each((function(e){e.removeAttribute("data-mce-selected")}))}(e),e.readonly=!0,vk(n,!1),$(Ta(n,'*[contenteditable="true"]'),(function(e){Vn(e,"data-mce-contenteditable","true"),vk(e,!1)}))):(e.readonly=!1,vk(n,!0),function(e){$(Ta(e,'*[data-mce-contenteditable="true"]'),(function(e){Kn(e,"data-mce-contenteditable"),vk(e,!0)}))}(n),hk(e,"StyleWithCSS",!1),hk(e,"enableInlineTableEditing",!1),hk(e,"enableObjectResizing",!1),um(e)&&e.focus(),function(e){e.selection.setRng(e.selection.getRng())}(e),e.nodeChanged())},yk=function(e){return e.readonly},Ck=function(e){e.parser.addAttributeFilter("contenteditable",(function(t){yk(e)&&$(t,(function(e){e.attr("data-mce-contenteditable",e.attr("contenteditable")),e.attr("contenteditable","false")}))})),e.serializer.addAttributeFilter("data-mce-contenteditable",(function(t){yk(e)&&$(t,(function(e){e.attr("contenteditable",e.attr("data-mce-contenteditable"))}))})),e.serializer.addTempAttr("data-mce-contenteditable")},wk=function(e,t){if(function(e){return"click"===e.type}(t)&&!qs.metaKeyPressed(t)){var n=Ct.fromDom(t.target);(function(e,t){return Vr(t,"a",(function(t){return Tt(t,Ct.fromDom(e.getBody()))})).bind((function(e){return $n(e,"href")}))})(e,n).each((function(n){if(t.preventDefault(),/^#/.test(n)){var r=e.dom.select(n+',[name="'+((je(o=n,i="#")?function(e,t){return e.substring(t)}(o,i.length):o)+'"]'));r.length&&e.selection.scrollIntoView(r[0],!0)}else window.open(n,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes");var o,i}))}},xk=bt.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),Sk=function(){function e(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||B}return e.isNative=function(e){return!!xk[e.toLowerCase()]},e.prototype.fire=function(e,t){var n=e.toLowerCase(),r=xi(n,t||{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(r);var o=this.bindings[n];if(o)for(var i=0,u=o.length;i<u;i++){var a=o[i];if(!a.removed){if(a.once&&this.off(n,a.func),r.isImmediatePropagationStopped())return r;if(!1===a.func.call(this.scope,r))return r.preventDefault(),r}}return r},e.prototype.on=function(e,t,n,r){if(!1===t&&(t=B),t){var o={func:t,removed:!1};r&&bt.extend(o,r);for(var i=e.toLowerCase().split(" "),u=i.length;u--;){var a=i[u],c=this.bindings[a];c||(c=[],this.toggleEvent(a,!0)),c=n?Oe([o],c,!0):Oe(Oe([],c,!0),[o],!1),this.bindings[a]=c}}return this},e.prototype.off=function(e,t){var n=this;if(e)for(var r=e.toLowerCase().split(" "),o=r.length;o--;){var i=r[o],u=this.bindings[i];if(!i)return me(this.bindings,(function(e,t){n.toggleEvent(t,!1),delete n.bindings[t]})),this;if(u){if(t){var a=X(u,(function(e){return e.func===t}));u=a.fail,this.bindings[i]=u,$(a.pass,(function(e){e.removed=!0}))}else u.length=0;u.length||(this.toggleEvent(e,!1),delete this.bindings[i])}}else me(this.bindings,(function(e,t){n.toggleEvent(t,!1)})),this.bindings={};return this},e.prototype.once=function(e,t,n){return this.on(e,t,n,{once:!0})},e.prototype.has=function(e){return e=e.toLowerCase(),!(!this.bindings[e]||0===this.bindings[e].length)},e}(),Tk=function(e){return e._eventDispatcher||(e._eventDispatcher=new Sk({scope:e,toggleEvent:function(t,n){Sk.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher},kk={fire:function(e,t,n){if(this.removed&&"remove"!==e&&"detach"!==e)return t;var r=Tk(this).fire(e,t);if(!1!==n&&this.parent)for(var o=this.parent();o&&!r.isPropagationStopped();)o.fire(e,r,!1),o=o.parent();return r},on:function(e,t,n){return Tk(this).on(e,t,n)},off:function(e,t){return Tk(this).off(e,t)},once:function(e,t){return Tk(this).once(e,t)},hasEventListeners:function(e){return Tk(this).has(e)}},Nk=na.DOM,Ek=function(e,t){if("selectionchange"===t)return e.getDoc();if(!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t))return e.getDoc().documentElement;var n=rf(e);return n?(e.eventRoot||(e.eventRoot=Nk.select(n)[0]),e.eventRoot):e.getBody()},Rk=function(e,t,n){!function(e){return!e.hidden&&!yk(e)}(e)?yk(e)&&wk(e,n):e.fire(t,n)},_k=function(e,t){var n;if(e.delegates||(e.delegates={}),!e.delegates[t]&&!e.removed){var r=Ek(e,t);if(rf(e)){if(bw||(bw={},e.editorManager.on("removeEditor",(function(){e.editorManager.activeEditor||bw&&(me(bw,(function(t,n){e.dom.unbind(Ek(e,n))})),bw=null)}))),bw[t])return;n=function(n){for(var r=n.target,o=e.editorManager.get(),i=o.length;i--;){var u=o[i].getBody();(u===r||Nk.isChildOf(r,u))&&Rk(o[i],t,n)}},bw[t]=n,Nk.bind(r,t,n)}else n=function(n){Rk(e,t,n)},Nk.bind(r,t,n),e.delegates[t]=n}},Dk=Ae(Ae({},kk),{bindPendingEventDelegates:function(){var e=this;bt.each(e._pendingNativeEvents,(function(t){_k(e,t)}))},toggleNativeEvent:function(e,t){"focus"!==e&&"blur"!==e&&(this.removed||(t?this.initialized?_k(this,e):this._pendingNativeEvents?this._pendingNativeEvents.push(e):this._pendingNativeEvents=[e]:this.initialized&&(this.dom.unbind(Ek(this,e),e,this.delegates[e]),delete this.delegates[e])))},unbindAllNativeEvents:function(){var e=this,t=e.getBody(),n=e.dom;e.delegates&&(me(e.delegates,(function(t,n){e.dom.unbind(Ek(e,n),n,t)})),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}}),Ak=["design","readonly"],Ok=function(e,t,n,r){var o=n[t.get()],i=n[r];try{i.activate()}catch(e){return void console.error("problem while activating editor mode "+r+":",e)}o.deactivate(),o.editorReadOnly!==i.editorReadOnly&&bk(e,i.editorReadOnly),t.set(r),function(e,t){e.fire("SwitchMode",{mode:t})}(e,r)},Bk=function(e){var t=aa("design"),n=aa({design:{activate:S,deactivate:S,editorReadOnly:!1},readonly:{activate:S,deactivate:S,editorReadOnly:!0}});return function(e){e.serializer?Ck(e):e.on("PreInit",(function(){Ck(e)}))}(e),function(e){e.on("ShowCaret",(function(t){yk(e)&&t.preventDefault()})),e.on("ObjectSelected",(function(t){yk(e)&&t.preventDefault()}))}(e),{isReadOnly:function(){return yk(e)},set:function(r){return function(e,t,n,r){if(r!==n.get()){if(!we(t,r))throw new Error("Editor mode '"+r+"' is invalid");e.initialized?Ok(e,n,t,r):e.on("init",(function(){return Ok(e,n,t,r)}))}}(e,n.get(),t,r)},get:function(){return t.get()},register:function(e,t){n.set(function(e,t,n){var r;if(V(Ak,t))throw new Error("Cannot override default mode "+t);return Ae(Ae({},e),((r={})[t]=Ae(Ae({},n),{deactivate:function(){try{n.deactivate()}catch(e){console.error("problem while deactivating editor mode "+t+":",e)}}}),r))}(n.get(),e,t))}}},Pk=bt.each,Lk=bt.explode,Ik={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},Mk=bt.makeMap("alt,ctrl,shift,meta,access"),Fk=function(e){var t,n={};Pk(Lk(e.toLowerCase(),"+"),(function(e){e in Mk?n[e]=!0:/^[0-9]{2,}$/.test(e)?n.keyCode=parseInt(e,10):(n.charCode=e.charCodeAt(0),n.keyCode=Ik[e]||e.toUpperCase().charCodeAt(0))}));var r=[n.keyCode];for(t in Mk)n[t]?r.push(t):n[t]=!1;return n.id=r.join(","),n.access&&(n.alt=!0,mt.mac?n.ctrl=!0:n.shift=!0),n.meta&&(mt.mac?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n},jk=function(){function e(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;var t=this;e.on("keyup keypress keydown",(function(e){!t.hasModifier(e)&&!t.isFunctionKey(e)||e.isDefaultPrevented()||(Pk(t.shortcuts,(function(n){if(t.matchShortcut(e,n))return t.pendingPatterns=n.subpatterns.slice(0),"keydown"===e.type&&t.executeShortcutAction(n),!0})),t.matchShortcut(e,t.pendingPatterns[0])&&(1===t.pendingPatterns.length&&"keydown"===e.type&&t.executeShortcutAction(t.pendingPatterns[0]),t.pendingPatterns.shift()))}))}return e.prototype.add=function(e,t,n,r){var o=this,i=o.normalizeCommandFunc(n);return Pk(Lk(bt.trim(e)),(function(e){var n=o.createShortcut(e,t,i,r);o.shortcuts[n.id]=n})),!0},e.prototype.remove=function(e){var t=this.createShortcut(e);return!!this.shortcuts[t.id]&&(delete this.shortcuts[t.id],!0)},e.prototype.normalizeCommandFunc=function(e){var t=this,n=e;return"string"==typeof n?function(){t.editor.execCommand(n,!1,null)}:bt.isArray(n)?function(){t.editor.execCommand(n[0],n[1],n[2])}:n},e.prototype.createShortcut=function(e,t,n,r){var o=bt.map(Lk(e,">"),Fk);return o[o.length-1]=bt.extend(o[o.length-1],{func:n,scope:r||this.editor}),bt.extend(o[0],{desc:this.editor.translate(t),subpatterns:o.slice(1)})},e.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},e.prototype.isFunctionKey=function(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123},e.prototype.matchShortcut=function(e,t){return!!t&&(t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&(t.alt===e.altKey&&t.shift===e.shiftKey&&(!!(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0))))},e.prototype.executeShortcutAction=function(e){return e.func?e.func.call(e.scope):null},e}(),Uk=function(){var e=function(){var e={},t={},n={},r={},o={},i={},u={},a=function(e,t){return function(n,r){return e[n.toLowerCase()]=Ae(Ae({},r),{type:t})}};return{addButton:a(e,"button"),addGroupToolbarButton:a(e,"grouptoolbarbutton"),addToggleButton:a(e,"togglebutton"),addMenuButton:a(e,"menubutton"),addSplitButton:a(e,"splitbutton"),addMenuItem:a(t,"menuitem"),addNestedMenuItem:a(t,"nestedmenuitem"),addToggleMenuItem:a(t,"togglemenuitem"),addAutocompleter:a(n,"autocompleter"),addContextMenu:a(o,"contextmenu"),addContextToolbar:a(i,"contexttoolbar"),addContextForm:a(i,"contextform"),addSidebar:a(u,"sidebar"),addIcon:function(e,t){return r[e.toLowerCase()]=t},getAll:function(){return{buttons:e,menuItems:t,icons:r,popups:n,contextMenus:o,contextToolbars:i,sidebars:u}}}}();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,getAll:e.getAll}},zk=na.DOM,Hk=bt.extend,Vk=bt.each,qk=bt.resolve,Wk=mt.ie,$k=function(){function e(e,t,n){var r=this;this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,Hk(this,Dk),this.settings=Hb(this,e,this.documentBaseUrl,n.defaultSettings,t),this.settings.suffix&&(n.suffix=this.settings.suffix),this.suffix=n.suffix,this.settings.base_url&&n._setBaseUrl(this.settings.base_url),this.baseUri=n.baseURI,this.settings.referrer_policy&&(ua.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),na.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),da.languageLoad=this.settings.language_load,da.baseURL=n.baseURL,this.id=e,this.setDirty(!1),this.documentBaseURI=new Nm(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new jk(this),this.editorCommands=new gk(this),this.settings.cache_suffix&&(mt.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:Uk(),styleSheetLoader:void 0,show:S,hide:S,enable:S,disable:S,isDisabled:B};var o=Bk(this);this.mode=o,this.setMode=o.set,n.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=Gu.overrideDefaults((function(){return{context:r.inline?r.getBody():r.getDoc(),element:r.getBody()}}))}return e.prototype.render=function(){JT(this)},e.prototype.focus=function(e){this.execCommand("mceFocus",!1,e)},e.prototype.hasFocus=function(){return im(this)},e.prototype.execCallback=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,o=this,i=o.settings[e];if(i)return o.callbackLookup&&(r=o.callbackLookup[e])&&(i=r.func,r=r.scope),"string"==typeof i&&(r=(r=i.replace(/\.\w+$/,""))?qk(r):0,i=qk(i),o.callbackLookup=o.callbackLookup||{},o.callbackLookup[e]={func:i,scope:r}),i.apply(r||o,t)},e.prototype.translate=function(e){return sa.translate(e)},e.prototype.getParam=function(e,t,n){return qb(this,e,t,n)},e.prototype.hasPlugin=function(e,t){return!!V(ff(this).split(/[ ,]/),e)&&(!t||void 0!==ty.get(e))},e.prototype.nodeChanged=function(e){this._nodeChangeDispatcher.nodeChanged(e)},e.prototype.addCommand=function(e,t,n){this.editorCommands.addCommand(e,t,n)},e.prototype.addQueryStateHandler=function(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)},e.prototype.addQueryValueHandler=function(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)},e.prototype.addShortcut=function(e,t,n,r){this.shortcuts.add(e,t,n,r)},e.prototype.execCommand=function(e,t,n,r){return this.editorCommands.execCommand(e,t,n,r)},e.prototype.queryCommandState=function(e){return this.editorCommands.queryCommandState(e)},e.prototype.queryCommandValue=function(e){return this.editorCommands.queryCommandValue(e)},e.prototype.queryCommandSupported=function(e){return this.editorCommands.queryCommandSupported(e)},e.prototype.show=function(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(zk.show(this.getContainer()),zk.hide(this.id)),this.load(),this.fire("show"))},e.prototype.hide=function(){var e=this.getDoc();this.hidden||(Wk&&e&&!this.inline&&e.execCommand("SelectAll"),this.save(),this.inline?(this.getBody().contentEditable="false",this===this.editorManager.focusedEditor&&(this.editorManager.focusedEditor=null)):(zk.hide(this.getContainer()),zk.setStyle(this.id,"display",this.orgDisplay)),this.hidden=!0,this.fire("hide"))},e.prototype.isHidden=function(){return!!this.hidden},e.prototype.setProgressState=function(e,t){this.fire("ProgressState",{state:e,time:t})},e.prototype.load=function(e){var t,n=this.getElement();if(this.removed)return"";if(n){(e=e||{}).load=!0;var r=Rn(n)?n.value:n.innerHTML;return t=this.setContent(r,e),e.element=n,e.no_events||this.fire("LoadContent",e),e.element=n=null,t}},e.prototype.save=function(e){var t,n,r=this,o=r.getElement();if(o&&r.initialized&&!r.removed)return(e=e||{}).save=!0,e.element=o,e.content=r.getContent(e),e.no_events||r.fire("SaveContent",e),"raw"===e.format&&r.fire("RawSaveContent",e),t=e.content,Rn(o)?o.value=t:(!e.is_removing&&r.inline||(o.innerHTML=t),(n=zk.getParent(r.id,"form"))&&Vk(n.elements,(function(e){if(e.name===r.id)return e.value=t,!1}))),e.element=o=null,!1!==e.set_dirty&&r.setDirty(!1),t},e.prototype.setContent=function(e,t){return hb(this,e,t)},e.prototype.getContent=function(e){return pb(this,e)},e.prototype.insertContent=function(e,t){t&&(e=Hk({content:e},t)),this.execCommand("mceInsertContent",!1,e)},e.prototype.resetContent=function(e){void 0===e?hb(this,this.startContent,{format:"raw"}):hb(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},e.prototype.isDirty=function(){return!this.isNotDirty},e.prototype.setDirty=function(e){var t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.fire("dirty")},e.prototype.getContainer=function(){return this.container||(this.container=zk.get(this.editorContainer||this.id+"_parent")),this.container},e.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},e.prototype.getElement=function(){return this.targetElm||(this.targetElm=zk.get(this.id)),this.targetElm},e.prototype.getWin=function(){var e;return this.contentWindow||(e=this.iframeElement)&&(this.contentWindow=e.contentWindow),this.contentWindow},e.prototype.getDoc=function(){var e;return this.contentDocument||(e=this.getWin())&&(this.contentDocument=e.document),this.contentDocument},e.prototype.getBody=function(){var e=this.getDoc();return this.bodyElement||(e?e.body:null)},e.prototype.convertURL=function(e,t,n){var r=this.settings;return r.urlconverter_callback?this.execCallback("urlconverter_callback",e,n,!0,t):!r.convert_urls||n&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:r.relative_urls?this.documentBaseURI.toRelative(e):e=this.documentBaseURI.toAbsolute(e,r.remove_script_host)},e.prototype.addVisual=function(e){ZT(this,e)},e.prototype.remove=function(){yb(this)},e.prototype.destroy=function(e){Cb(this,e)},e.prototype.uploadImages=function(e){return this.editorUpload.uploadImages(e)},e.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},e.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},e.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},e.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},e.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},e}(),Kk=na.DOM,Xk=bt.explode,Gk=bt.each,Yk=bt.extend,Qk=0,Jk=!1,Zk=[],eN=[],tN=function(e){var t=e.type;Gk(iN.get(),(function(n){switch(t){case"scroll":n.fire("ScrollWindow",e);break;case"resize":n.fire("ResizeWindow",e)}}))},nN=function(e){e!==Jk&&(e?Gu(window).on("resize scroll",tN):Gu(window).off("resize scroll",tN),Jk=e)},rN=function(e){var t=eN;delete Zk[e.id];for(var n=0;n<Zk.length;n++)if(Zk[n]===e){Zk.splice(n,1);break}return eN=G(eN,(function(t){return e!==t})),iN.activeEditor===e&&(iN.activeEditor=eN.length>0?eN[0]:null),iN.focusedEditor===e&&(iN.focusedEditor=null),t.length!==eN.length},oN="CSS1Compat"!==document.compatMode,iN=Ae(Ae({},kk),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:Gu,majorVersion:"5",minorVersion:"10.4",releaseDate:"2022-04-27",editors:Zk,i18n:sa,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var e,t,n="";t=Nm.getDocumentBaseUrl(document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/"));var r,o=window.tinymce||window.tinyMCEPreInit;if(o)e=o.base||o.baseURL,n=o.suffix;else{for(var i=document.getElementsByTagName("script"),u=0;u<i.length;u++){var a;if(""!==(a=i[u].src||"")){var c=a.substring(a.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(a)){-1!==c.indexOf(".min")&&(n=".min"),e=a.substring(0,a.lastIndexOf("/"));break}}}if(!e&&document.currentScript)-1!==(a=document.currentScript.src).indexOf(".min")&&(n=".min"),e=a.substring(0,a.lastIndexOf("/"))}this.baseURL=new Nm(t).toAbsolute(e),this.documentBaseURL=t,this.baseURI=new Nm(this.baseURL),this.suffix=n,(r=this).on("AddEditor",_(Zd,r)),r.on("RemoveEditor",_(em,r))},overrideDefaults:function(e){var t=e.base_url;t&&this._setBaseUrl(t);var n=e.suffix;e.suffix&&(this.suffix=n),this.defaultSettings=e;var r=e.plugin_base_urls;void 0!==r&&me(r,(function(e,t){da.PluginManager.urls[t]=e}))},init:function(e){var t,n=this,r=bt.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=function(e){var t=e.id;return t||(t=Ce(e,"name").filter((function(e){return!Kk.get(e)})).getOrThunk(Kk.uniqueId),e.setAttribute("id",t)),t},i=function(e,t){return t.constructor===RegExp?t.test(e.className):Kk.hasClass(e,t)},u=function(e){t=e},a=function(){var t,c=0,f=[],l=function(e,r,o){var i=new $k(e,r,n);f.push(i),i.on("init",(function(){++c===t.length&&u(f)})),i.targetElm=i.targetElm||o,i.render()};Kk.unbind(window,"ready",a),function(t){var r=e[t];if(r)r.apply(n,[])}("onpageload"),t=Gu.unique(function(e){var t=[];if(mt.browser.isIE()&&mt.browser.version.major<11)return fy("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(oN)return fy("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(e.types)return Gk(e.types,(function(e){t=t.concat(Kk.select(e.selector))})),t;if(e.selector)return Kk.select(e.selector);if(e.target)return[e.target];switch(e.mode){case"exact":var n=e.elements||"";n.length>0&&Gk(Xk(n),(function(e){var n=Kk.get(e);n?t.push(n):Gk(document.forms,(function(n){Gk(n.elements,(function(n){n.name===e&&(e="mce_editor_"+Qk++,Kk.setAttrib(n,"id",e),t.push(n))}))}))}));break;case"textareas":case"specific_textareas":Gk(Kk.select("textarea"),(function(n){e.editor_deselector&&i(n,e.editor_deselector)||e.editor_selector&&!i(n,e.editor_selector)||t.push(n)}))}return t}(e)),e.types?Gk(e.types,(function(n){bt.each(t,(function(t){return!Kk.is(t,n.selector)||(l(o(t),Yk({},e,n),t),!1)}))})):(bt.each(t,(function(e){var t;(t=n.get(e.id))&&t.initialized&&!(t.getContainer()||t.getBody()).parentNode&&(rN(t),t.unbindAllNativeEvents(),t.destroy(!0),t.removed=!0,t=null)})),0===(t=bt.grep(t,(function(e){return!n.get(e.id)}))).length?u([]):Gk(t,(function(t){!function(e,t){return e.inline&&t.tagName.toLowerCase()in r}(e,t)?l(o(t),e,t):fy("Could not initialize inline editor on invalid inline target element",t)})))};return n.settings=e,Kk.bind(window,"ready",a),new qr((function(e){t?e(t):u=function(t){e(t)}}))},get:function(e){return 0===arguments.length?eN.slice(0):m(e)?Z(eN,(function(t){return t.id===e})).getOr(null):x(e)&&eN[e]?eN[e]:null},add:function(e){var t=this;return Zk[e.id]===e||(null===t.get(e.id)&&("length"!==e.id&&(Zk[e.id]=e),Zk.push(e),eN.push(e)),nN(!0),t.activeEditor=e,t.fire("AddEditor",{editor:e}),yw||(yw=function(e){var n=t.fire("BeforeUnload");if(n.returnValue)return e.preventDefault(),e.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",yw))),e},createEditor:function(e,t){return this.add(new $k(e,t,this))},remove:function(e){var t,n,r=this;if(e){if(!m(e))return n=e,h(r.get(n.id))?null:(rN(n)&&r.fire("RemoveEditor",{editor:n}),0===eN.length&&window.removeEventListener("beforeunload",yw),n.remove(),nN(eN.length>0),n);Gk(Kk.select(e),(function(e){(n=r.get(e.id))&&r.remove(n)}))}else for(t=eN.length-1;t>=0;t--)r.remove(eN[t])},execCommand:function(e,t,n){var r=this.get(n);switch(e){case"mceAddEditor":return this.get(n)||new $k(n,this.settings,this).render(),!0;case"mceRemoveEditor":return r&&r.remove(),!0;case"mceToggleEditor":return r?(r.isHidden()?r.show():r.hide(),!0):(this.execCommand("mceAddEditor",!1,n),!0)}return!!this.activeEditor&&this.activeEditor.execCommand(e,t,n)},triggerSave:function(){Gk(eN,(function(e){e.save()}))},addI18n:function(e,t){sa.add(e,t)},translate:function(e){return sa.translate(e)},setActive:function(e){var t=this.activeEditor;this.activeEditor!==e&&(t&&t.fire("deactivate",{relatedTarget:e}),e.fire("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl:function(e){this.baseURL=new Nm(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new Nm(this.baseURL)}});iN.setup();var uN,aN,cN,fN,lN=Math.min,sN=Math.max,dN=Math.round,mN=function(e,t,n){var r=t.x,o=t.y,i=e.w,u=e.h,a=t.w,c=t.h,f=(n||"").split("");return"b"===f[0]&&(o+=c),"r"===f[1]&&(r+=a),"c"===f[0]&&(o+=dN(c/2)),"c"===f[1]&&(r+=dN(a/2)),"b"===f[3]&&(o-=u),"r"===f[4]&&(r-=i),"c"===f[3]&&(o-=dN(u/2)),"c"===f[4]&&(r-=dN(i/2)),gN(r,o,i,u)},gN=function(e,t,n,r){return{x:e,y:t,w:n,h:r}},pN={inflate:function(e,t,n){return gN(e.x-t,e.y-n,e.w+2*t,e.h+2*n)},relativePosition:mN,findBestRelativePosition:function(e,t,n,r){var o,i;for(i=0;i<r.length;i++)if((o=mN(e,t,r[i])).x>=n.x&&o.x+o.w<=n.w+n.x&&o.y>=n.y&&o.y+o.h<=n.h+n.y)return r[i];return null},intersect:function(e,t){var n=sN(e.x,t.x),r=sN(e.y,t.y),o=lN(e.x+e.w,t.x+t.w),i=lN(e.y+e.h,t.y+t.h);return o-n<0||i-r<0?null:gN(n,r,o-n,i-r)},clamp:function(e,t,n){var r=e.x,o=e.y,i=e.x+e.w,u=e.y+e.h,a=t.x+t.w,c=t.y+t.h,f=sN(0,t.x-r),l=sN(0,t.y-o),s=sN(0,i-a),d=sN(0,u-c);return r+=f,o+=l,n&&(i+=f,u+=l,r-=s,o-=d),gN(r,o,(i-=s)-r,(u-=d)-o)},create:gN,fromClientRect:function(e){return gN(e.left,e.top,e.width,e.height)}},hN=(uN={},aN={},{load:function(e,t){var n='Script at URL "'+t+'" failed to load',r='Script at URL "'+t+"\" did not call `tinymce.Resource.add('"+e+"', data)` within 1 second";if(void 0!==uN[e])return uN[e];var o=new qr((function(o,i){var u=function(e,t,n){void 0===n&&(n=1e3);var r=!1,o=null,i=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r||(r=!0,null!==o&&(clearTimeout(o),o=null),e.apply(null,t))}},u=i(e),a=i(t);return{start:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r||null!==o||(o=setTimeout((function(){return a.apply(null,e)}),n))},resolve:u,reject:a}}(o,i);aN[e]=u.resolve,ua.ScriptLoader.loadScript(t,(function(){return u.start(r)}),(function(){return u.reject(n)}))}));return uN[e]=o,o},add:function(e,t){void 0!==aN[e]&&(aN[e](t),delete aN[e]),uN[e]=qr.resolve(t)}}),vN=bt.each,bN=bt.extend,yN=function(){};yN.extend=cN=function(e){var t=this.prototype,n=function(){var e,t,n,r=this;if(!fN&&(r.init&&r.init.apply(r,arguments),t=r.Mixins))for(e=t.length;e--;)(n=t[e]).init&&n.init.apply(r,arguments)},r=function(){return this};fN=!0;var o=new this;return fN=!1,e.Mixins&&(vN(e.Mixins,(function(t){for(var n in t)"init"!==n&&(e[n]=t[n])})),t.Mixins&&(e.Mixins=t.Mixins.concat(e.Mixins))),e.Methods&&vN(e.Methods.split(","),(function(t){e[t]=r})),e.Properties&&vN(e.Properties.split(","),(function(t){var n="_"+t;e[t]=function(e){return void 0!==e?(this[n]=e,this):this[n]}})),e.Statics&&vN(e.Statics,(function(e,t){n[t]=e})),e.Defaults&&t.Defaults&&(e.Defaults=bN({},t.Defaults,e.Defaults)),me(e,(function(e,n){"function"==typeof e&&t[n]?o[n]=function(e,n){return function(){var r=this,o=r._super;r._super=t[e];var i=n.apply(r,arguments);return r._super=o,i}}(n,e):o[n]=e})),n.prototype=o,n.constructor=n,n.extend=cN,n};var CN,wN=Math.min,xN=Math.max,SN=Math.round,TN={serialize:function(e){var t=JSON.stringify(e);return m(t)?t.replace(/[\u0080-\uFFFF]/g,(function(e){var t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substring(t.length)+t})):t},parse:function(e){try{return JSON.parse(e)}catch(e){}}},kN={callbacks:{},count:0,send:function(e){var t=this,n=na.DOM,r=void 0!==e.count?e.count:t.count,o="tinymce_jsonp_"+r;t.callbacks[r]=function(i){n.remove(o),delete t.callbacks[r],e.callback(i)},n.add(n.doc.body,"script",{id:o,src:e.url,type:"text/javascript"}),t.count++}},NN=Ae(Ae({},kk),{send:function(e){var t,n=0,r=function(){!e.async||4===t.readyState||n++>1e4?(e.success&&n<1e4&&200===t.status?e.success.call(e.success_scope,""+t.responseText,t,e):e.error&&e.error.call(e.error_scope,n>1e4?"TIMED_OUT":"GENERAL",t,e),t=null):Xr.setTimeout(r,10)};if(e.scope=e.scope||this,e.success_scope=e.success_scope||e.scope,e.error_scope=e.error_scope||e.scope,e.async=!1!==e.async,e.data=e.data||"",NN.fire("beforeInitialize",{settings:e}),(t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType(e.content_type),t.open(e.type||(e.data?"POST":"GET"),e.url,e.async),e.crossDomain&&(t.withCredentials=!0),e.content_type&&t.setRequestHeader("Content-Type",e.content_type),e.requestheaders&&bt.each(e.requestheaders,(function(e){t.setRequestHeader(e.key,e.value)})),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),(t=NN.fire("beforeSend",{xhr:t,settings:e}).xhr).send(e.data),!e.async)return r();Xr.setTimeout(r,10)}}),EN=bt.extend,RN=function(){function e(e){this.settings=EN({},e),this.count=0}return e.sendRPC=function(t){return(new e).send(t)},e.prototype.send=function(e){var t=e.error,n=e.success,r=EN(this.settings,e);r.success=function(e,o){void 0===(e=TN.parse(e))&&(e={error:"JSON Parse error."}),e.error?t.call(r.error_scope||r.scope,e.error,o):n.call(r.success_scope||r.scope,e.result)},r.error=function(e,n){t&&t.call(r.error_scope||r.scope,e,n)},r.data=TN.serialize({id:e.id||"c"+this.count++,method:e.method,params:e.params}),r.content_type="application/json",NN.send(r)},e}();try{var _N="__storage_test__";(CN=window.localStorage).setItem(_N,_N),CN.removeItem(_N)}catch(e){CN=function(){var e={},t=[],n={getItem:function(t){var n=e[t];return n||null},setItem:function(n,r){t.push(n),e[n]=String(r)},key:function(e){return t[e]},removeItem:function(n){t=t.filter((function(e){return e===n})),delete e[n]},clear:function(){t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:function(){return t.length},configurable:!1,enumerable:!1}),n}()}var DN={geom:{Rect:pN},util:{Promise:qr,Delay:Xr,Tools:bt,VK:qs,URI:Nm,Class:yN,EventDispatcher:Sk,Observable:kk,I18n:sa,XHR:NN,JSON:TN,JSONRequest:RN,JSONP:kN,LocalStorage:CN,Color:function(e){var t={},n=0,r=0,o=0,i=function(e){var i;return"object"==typeof e?"r"in e?(n=e.r,r=e.g,o=e.b):"v"in e&&function(e,t,i){if(e=(parseInt(e,10)||0)%360,t=parseInt(t,10)/100,i=parseInt(i,10)/100,t=xN(0,wN(t,1)),i=xN(0,wN(i,1)),0!==t){var u=e/60,a=i*t,c=a*(1-Math.abs(u%2-1)),f=i-a;switch(Math.floor(u)){case 0:n=a,r=c,o=0;break;case 1:n=c,r=a,o=0;break;case 2:n=0,r=a,o=c;break;case 3:n=0,r=c,o=a;break;case 4:n=c,r=0,o=a;break;case 5:n=a,r=0,o=c;break;default:n=r=o=0}n=SN(255*(n+f)),r=SN(255*(r+f)),o=SN(255*(o+f))}else n=r=o=SN(255*i)}(e.h,e.s,e.v):(i=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e))?(n=parseInt(i[1],10),r=parseInt(i[2],10),o=parseInt(i[3],10)):(i=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e))?(n=parseInt(i[1],16),r=parseInt(i[2],16),o=parseInt(i[3],16)):(i=/#([0-F])([0-F])([0-F])/gi.exec(e))&&(n=parseInt(i[1]+i[1],16),r=parseInt(i[2]+i[2],16),o=parseInt(i[3]+i[3],16)),n=n<0?0:n>255?255:n,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,t};return e&&i(e),t.toRgb=function(){return{r:n,g:r,b:o}},t.toHsv=function(){return function(e,t,n){var r,o;o=0;var i=wN(e/=255,wN(t/=255,n/=255)),u=xN(e,xN(t,n));return i===u?{h:0,s:0,v:100*(o=i)}:(r=(u-i)/u,o=u,{h:SN(60*((e===i?3:n===i?1:5)-(e===i?t-n:n===i?e-t:n-e)/(u-i))),s:SN(100*r),v:SN(100*o)})}(n,r,o)},t.toHex=function(){var e=function(e){return(e=parseInt(e,10).toString(16)).length>1?e:"0"+e};return"#"+e(n)+e(r)+e(o)},t.parse=i,t},ImageUploader:function(e){var t=my(),n=by(e,t);return{upload:function(t,r){return void 0===r&&(r=!0),n.upload(t,r?vy(e):void 0)}}}},dom:{EventUtils:Ri,Sizzle:fu,DomQuery:Gu,TreeWalker:Qr,TextSeeker:ja,DOMUtils:na,ScriptLoader:ua,RangeUtils:ad,Serializer:gb,StyleSheetLoader:Gr,ControlSelection:$s,BookmarkManager:Fs,Selection:Wv,Event:Ri.Event},html:{Styles:yi,Entities:ai,Node:bm,Schema:vi,SaxParser:Am,DomParser:fb,Writer:Fm,Serializer:jm},Env:mt,AddOnManager:da,Annotator:Ms,Formatter:Ny,UndoManager:Ry,EditorCommands:gk,WindowManager:ry,NotificationManager:ey,EditorObservable:Dk,Shortcuts:jk,Editor:$k,FocusManager:Xd,EditorManager:iN,DOM:na.DOM,ScriptLoader:ua.ScriptLoader,PluginManager:ty,ThemeManager:ny,IconManager:Wb,Resource:hN,trim:bt.trim,isArray:bt.isArray,is:bt.is,toArray:bt.toArray,makeMap:bt.makeMap,each:bt.each,map:bt.map,grep:bt.grep,inArray:bt.inArray,extend:bt.extend,create:bt.create,walk:bt.walk,createNS:bt.createNS,resolve:bt.resolve,explode:bt.explode,_addCacheSuffix:bt._addCacheSuffix,isOpera:mt.opera,isWebKit:mt.webkit,isIE:mt.ie,isGecko:mt.gecko,isMac:mt.mac},AN=bt.extend(iN,DN);!function(e){window.tinymce=e,window.tinyMCE=e}(AN),function(t){try{e.exports=t}catch(e){}}(AN)}()}).call(this,n(18),n(39).setImmediate)},,,,,,,,,,,,,,function(e,t,n){var r;"undefined"!=typeof self&&self,void 0===(r=function(){return function(){var e=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(e,n,r,o){var i=r;return n.replace(t,(function(e,t,n,r,u){t=t||r,i&&(t+":html"in i?(i=i[t+":html"],o=!0):t in i&&(i=i[t]),u&&"function"==typeof i&&(i=i()))})),null!=i&&i!==r||(i=e),i=String(i),o||(i=u.escape(i)),i},r=function(t){return this.template=this.template.replace(e,(function(e,r){return n(e,r,t,!0)})),this},o=function(t){return this.template=this.template.replace(e,(function(e,r){return n(e,r,t)})),this},i=function(){return this.template},u=function(e){function t(){return t.template}return t.template=String(e),t.toString=t.valueOf=i,t.fill=o,t.fillHtml=r,t},a={},c=[];u.load=function(e){if(e=String(e),!a.hasOwnProperty(e)){c.length>=1e3&&delete a[c.shift()],c.push(e);var t=function(e){return document.querySelector('script[title="'+e+'"]')}(e);t&&(a[e]=t.text)}return this(a[e])};var f={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","`":"&#96;"},l=new RegExp("["+Object.keys(f).join("")+"]","g");return u.escape=function(e){return String(e||"").replace(l,(function(e){return f[e]}))},u}()}.call(t,n,t,e))||(e.exports=r)},,,,,,,,,function(e,t,n){"use strict";t.decode=t.parse=n(53),t.encode=t.stringify=n(54)},,,,,function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},,,,,function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(40),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(18))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,o,i,u,a,c=1,f={},l=!1,s=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){g(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){g(e.data)},r=function(e){i.port2.postMessage(e)}):s&&"onreadystatechange"in s.createElement("script")?(o=s.documentElement,r=function(e){var t=s.createElement("script");t.onreadystatechange=function(){g(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):r=function(e){setTimeout(g,0,e)}:(u="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(u)&&g(+t.data.slice(u.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),r=function(t){e.postMessage(u+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return f[c]=o,r(c),c++},d.clearImmediate=m}function m(e){delete f[e]}function g(e){if(l)setTimeout(g,0,e);else{var t=f[e];if(t){l=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{m(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(18),n(41))},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var c,f=[],l=!1,s=-1;function d(){l&&c&&(l=!1,c.length?f=c.concat(f):s=-1,f.length&&m())}function m(){if(!l){var e=a(d);l=!0;for(var t=f.length;t;){for(c=f,f=[];++s<t;)c&&c[s].run();s=-1,t=f.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function p(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new g(e,t)),1!==f.length||l||a(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=p,o.addListener=p,o.once=p,o.off=p,o.removeListener=p,o.removeAllListeners=p,o.emit=p,o.prependListener=p,o.prependOnceListener=p,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){n(43)},function(e,t){!function(){"use strict";var e=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},t=function(e){return function(t){return typeof t===e}},n=function(e){return function(t){return e===t}},r=e("string"),o=e("object"),i=e("array"),u=n(null),a=t("boolean"),c=n(void 0),f=function(e){return!function(e){return null==e}(e)},l=t("function"),s=t("number"),d=function(){},m=function(e){return function(){return e}},g=function(e){return e},p=function(e,t){return e===t};function h(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var v,b,y=function(e){return function(t){return!e(t)}},C=m(!1),w=m(!0),x=function(){return S},S={fold:function(e,t){return e()},isSome:C,isNone:w,getOr:b=g,getOrThunk:v=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:m(null),getOrUndefined:m(void 0),or:b,orThunk:v,map:x,each:d,bind:x,exists:C,forall:w,filter:function(){return x()},toArray:function(){return[]},toString:m("none()")},T=function(e){var t=m(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},isSome:w,isNone:C,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return T(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:S},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},k={some:T,none:x,from:function(e){return null==e?S:T(e)}},N=Array.prototype.slice,E=Array.prototype.indexOf,R=Array.prototype.push,_=function(e,t){return n=e,r=t,E.call(n,r)>-1;var n,r},D=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},A=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},O=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},B=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},P=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var u=e[o];(t(u,o)?n:r).push(u)}return{pass:n,fail:r}},L=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},I=function(e,t,n){return function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n)}}(e,(function(e,r){n=t(n,e,r)})),n},M=function(e,t,n){return B(e,(function(e,r){n=t(n,e,r)})),n},F=function(e,t){return function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return k.some(i);if(n(i,r))break}return k.none()}(e,t,C)},j=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return k.some(n)}return k.none()},U=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!i(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);R.apply(t,e[n])}return t},z=function(e,t){return U(O(e,t))},H=function(e,t){for(var n=0,r=e.length;n<r;++n){if(!0!==t(e[n],n))return!1}return!0},V=function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n},q=function(e){return[e]},W=function(e,t){return t>=0&&t<e.length?k.some(e[t]):k.none()},$=function(e){return W(e,0)},K=function(e){return W(e,e.length-1)},X=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return k.none()},G=function(){return(G=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Y(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var Q=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}},J=function(){return Z(0,0)},Z=function(e,t){return{major:e,minor:t}},ee={nu:Z,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?J():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return Z(r(1),r(2))}(e,n)},unknown:J},te=function(e,t){var n=String(t).toLowerCase();return F(e,(function(e){return e.search(n)}))},ne=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},re=function(e,t){return-1!==e.indexOf(t)},oe=function(e,t){return ne(e,t,0)},ie=function(e,t){return ne(e,t,e.length-t.length)},ue=function(e){return function(t){return t.replace(e,"")}}(/^\s+|\s+$/g),ae=function(e){return e.length>0},ce=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,fe=function(e){return function(t){return re(t,e)}},le=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return re(e,"edge/")&&re(e,"chrome")&&re(e,"safari")&&re(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ce],search:function(e){return re(e,"chrome")&&!re(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return re(e,"msie")||re(e,"trident")}},{name:"Opera",versionRegexes:[ce,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:fe("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:fe("firefox")},{name:"Safari",versionRegexes:[ce,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(re(e,"safari")||re(e,"mobile/"))&&re(e,"applewebkit")}}],se=[{name:"Windows",search:fe("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return re(e,"iphone")||re(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:fe("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:fe("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:fe("linux"),versionRegexes:[]},{name:"Solaris",search:fe("sunos"),versionRegexes:[]},{name:"FreeBSD",search:fe("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:fe("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],de={browsers:m(le),oses:m(se)},me=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},ge={unknown:function(){return me({current:void 0,version:ee.unknown()})},nu:me,edge:m("Edge"),chrome:m("Chrome"),ie:m("IE"),opera:m("Opera"),firefox:m("Firefox"),safari:m("Safari")},pe=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},he={unknown:function(){return pe({current:void 0,version:ee.unknown()})},nu:pe,windows:m("Windows"),ios:m("iOS"),android:m("Android"),linux:m("Linux"),osx:m("OSX"),solaris:m("Solaris"),freebsd:m("FreeBSD"),chromeos:m("ChromeOS")},ve=function(e,t,n){var r=de.browsers(),o=de.oses(),i=t.bind((function(e){return function(e,t){return X(t.brands,(function(t){var n=t.brand.toLowerCase();return F(e,(function(e){var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return{current:e.name,version:ee.nu(parseInt(t.version,10),0)}}))}))}(r,e)})).orThunk((function(){return function(e,t){return te(e,t).map((function(e){var n=ee.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(r,e)})).fold(ge.unknown,ge.nu),u=function(e,t){return te(e,t).map((function(e){var n=ee.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(o,e).fold(he.unknown,he.nu),a=function(e,t,n,r){var o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,u=e.isiOS()||e.isAndroid(),a=u||r("(pointer:coarse)"),c=o||!i&&u&&r("(min-device-width:768px)"),f=i||u&&!c,l=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),s=!f&&!c&&!l;return{isiPad:m(o),isiPhone:m(i),isTablet:m(c),isPhone:m(f),isTouch:m(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:m(l),isDesktop:m(s)}}(u,i,e,n);return{browser:i,os:u,deviceType:a}},be=function(e){return window.matchMedia(e).matches},ye=Q((function(){return ve(navigator.userAgent,k.from(navigator.userAgentData),be)})),Ce=function(){return ye()},we=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},xe={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return we(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return we(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return we(n)},fromDom:we,fromPoint:function(e,t,n){return k.from(e.dom.elementFromPoint(t,n)).map(we)}},Se=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Te=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},ke=function(e,t){var n=void 0===t?document:t.dom;return Te(n)?k.none():k.from(n.querySelector(e)).map(xe.fromDom)},Ne=function(e,t){return e.dom===t.dom},Ee=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},Re=function(e,t){return Ce().browser.isIE()?Ee(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)},_e=Se,De=Object.keys,Ae=Object.hasOwnProperty,Oe=function(e,t){for(var n=De(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},Be=function(e,t){return Pe(e,(function(e,n){return{k:n,v:t(e,n)}}))},Pe=function(e,t){var n={};return Oe(e,(function(e,r){var o=t(e,r);n[o.k]=o.v})),n},Le=function(e,t){var n={};return function(e,t,n,r){Oe(e,(function(e,o){(t(e,o)?n:r)(e,o)}))}(e,t,function(e){return function(t,n){e[n]=t}}(n),d),n},Ie=function(e,t){var n=[];return Oe(e,(function(e,r){n.push(t(e,r))})),n},Me=function(e){return Ie(e,g)},Fe=function(e){return De(e).length},je=function(e,t){return Ue(e,t)?k.from(e[t]):k.none()},Ue=function(e,t){return Ae.call(e,t)},ze=function(e,t){return Ue(e,t)&&void 0!==e[t]&&null!==e[t]},He=["tfoot","thead","tbody","colgroup"],Ve=function(e,t,n){return{element:e,rowspan:t,colspan:n}},qe=function(e,t,n){return{element:e,cells:t,section:n}},We=function(e,t,n){return{element:e,isNew:t,isLocked:n}},$e=function(e,t,n,r){return{element:e,cells:t,section:n,isNew:r}};"undefined"!=typeof window?window:Function("return this;")();var Ke=function(e){return e.dom.nodeName.toLowerCase()},Xe=function(e){return e.dom.nodeType},Ge=function(e){return function(t){return Xe(t)===e}},Ye=function(e){return 8===Xe(e)||"#comment"===Ke(e)},Qe=Ge(1),Je=Ge(3),Ze=Ge(9),et=Ge(11),tt=function(e){return function(t){return Qe(t)&&Ke(t)===e}},nt=function(e){return xe.fromDom(e.dom.ownerDocument)},rt=function(e){return Ze(e)?e:nt(e)},ot=function(e){return k.from(e.dom.parentNode).map(xe.fromDom)},it=function(e,t){for(var n=l(t)?t:C,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=xe.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o},ut=function(e){return k.from(e.dom.previousSibling).map(xe.fromDom)},at=function(e){return k.from(e.dom.nextSibling).map(xe.fromDom)},ct=function(e){return O(e.dom.childNodes,xe.fromDom)},ft=function(e,t){var n=e.dom.childNodes;return k.from(n[t]).map(xe.fromDom)},lt=l(Element.prototype.attachShadow)&&l(Node.prototype.getRootNode),st=m(lt),dt=lt?function(e){return xe.fromDom(e.dom.getRootNode())}:rt,mt=function(e){var t,n=dt(e);return et(t=n)&&f(t.dom.host)?k.some(n):k.none()},gt=function(e){return xe.fromDom(e.dom.host)},pt=function(e){return f(e.dom.shadowRoot)},ht=function(e){var t=Je(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,r,o=t.ownerDocument;return mt(xe.fromDom(t)).fold((function(){return o.body.contains(t)}),(n=ht,r=gt,function(e){return n(r(e))}))},vt=function(e){var t=e.dom.body;if(null==t)throw new Error("Body is not available yet");return xe.fromDom(t)},bt=function(e,t){var n=[];return B(ct(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(bt(e,t))})),n},yt=function(e,t,n){return function(e,t,n){return L(it(e,n),t)}(e,(function(e){return Se(e,t)}),n)},Ct=function(e,t){return function(e,t){return L(ct(e),t)}(e,(function(e){return Se(e,t)}))},wt=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return Te(n)?[]:O(n.querySelectorAll(e),xe.fromDom)}(t,e)};function xt(e,t,n,r,o){return e(n,r)?k.some(n):l(o)&&o(n)?k.none():t(n,r,o)}var St=function(e,t,n){for(var r=e.dom,o=l(n)?n:C;r.parentNode;){r=r.parentNode;var i=xe.fromDom(r);if(t(i))return k.some(i);if(o(i))break}return k.none()},Tt=function(e,t,n){return St(e,(function(e){return Se(e,t)}),n)},kt=function(e,t){return function(e,t){return F(e.dom.childNodes,(function(e){return t(xe.fromDom(e))})).map(xe.fromDom)}(e,(function(e){return Se(e,t)}))},Nt=function(e,t){return ke(t,e)},Et=function(e,t,n){return xt((function(e,t){return Se(e,t)}),Tt,e,t,n)},Rt=function(e,t,n){if(!(r(n)||a(n)||s(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},_t=function(e,t,n){Rt(e.dom,t,n)},Dt=function(e,t){var n=e.dom;Oe(t,(function(e,t){Rt(n,t,e)}))},At=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},Ot=function(e,t){return k.from(At(e,t))},Bt=function(e,t){e.dom.removeAttribute(t)},Pt=function(e){return M(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})},Lt=function(e,t,n){return void 0===n&&(n=p),e.exists((function(e){return n(e,t)}))},It=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},Mt=function(e,t,n){return e.isSome()&&t.isSome()?k.some(n(e.getOrDie(),t.getOrDie())):k.none()},Ft=function(e,t){return e?k.some(t):k.none()},jt=function(e){return void 0!==e.style&&l(e.style.getPropertyValue)},Ut=function(e,t,n){if(!r(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);jt(e)&&e.style.setProperty(t,n)},zt=function(e,t,n){var r=e.dom;Ut(r,t,n)},Ht=function(e,t){var n=e.dom;Oe(t,(function(e,t){Ut(n,t,e)}))},Vt=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||ht(e)?r:qt(n,t)},qt=function(e,t){return jt(e)?e.style.getPropertyValue(t):""},Wt=function(e,t){var n=e.dom,r=qt(n,t);return k.from(r).filter((function(e){return e.length>0}))},$t=function(e,t){!function(e,t){jt(e)&&e.style.removeProperty(t)}(e.dom,t),Lt(Ot(e,"style").map(ue),"")&&Bt(e,"style")},Kt=function(e,t,n){return void 0===n&&(n=0),Ot(e,t).map((function(e){return parseInt(e,10)})).getOr(n)},Xt=function(e,t){return Kt(e,t,1)},Gt=function(e){return tt("col")(e)?Kt(e,"span",1)>1:Xt(e,"colspan")>1},Yt=function(e){return Xt(e,"rowspan")>1},Qt=function(e,t){return parseInt(Vt(e,t),10)},Jt=m(10),Zt=m(10),en=function(e,t){return tn(e,t,w)},tn=function(e,t,n){return z(ct(e),(function(e){return Se(e,t)?n(e)?[e]:[]:tn(e,t,n)}))},nn=function(e,t){return function(e,t,n){if(void 0===n&&(n=C),n(t))return k.none();if(_(e,Ke(t)))return k.some(t);return Tt(t,e.join(","),(function(e){return Se(e,"table")||n(e)}))}(["td","th"],e,t)},rn=function(e){return en(e,"th,td")},on=function(e){return Se(e,"colgroup")?Ct(e,"col"):z(cn(e),(function(e){return Ct(e,"col")}))},un=function(e,t){return Et(e,"table",t)},an=function(e){return en(e,"tr")},cn=function(e){return un(e).fold(m([]),(function(e){return Ct(e,"colgroup")}))},fn=function(e,t){return O(e,(function(e){if("colgroup"===Ke(e)){var n=O(on(e),(function(e){var t=Kt(e,"span",1);return Ve(e,1,t)}));return qe(e,n,"colgroup")}n=O(rn(e),(function(e){var t=Kt(e,"rowspan",1),n=Kt(e,"colspan",1);return Ve(e,t,n)}));return qe(e,n,t(e))}))},ln=function(e){return ot(e).map((function(e){var t=Ke(e);return function(e){return _(He,e)}(t)?t:"tbody"})).getOr("tbody")},sn=function(e){var t=an(e),n=Y(Y([],cn(e),!0),t,!0);return fn(n,ln)},dn=function(e,t,n){var r=e.cells,o=r.slice(0,t),i=r.slice(t),u=o.concat(n).concat(i);return pn(e,u)},mn=function(e,t,n){return dn(e,t,[n])},gn=function(e,t,n){e.cells[t]=n},pn=function(e,t){return $e(e.element,t,e.section,e.isNew)},hn=function(e,t){return e.cells[t]},vn=function(e,t){return hn(e,t).element},bn=function(e){return e.cells.length},yn=function(e){var t=P(e,(function(e){return"colgroup"===e.section}));return{rows:t.fail,cols:t.pass}},Cn=function(e,t,n){var r=O(e.cells,n);return $e(t(e.element),r,e.section,!0)},wn="data-snooker-locked-cols",xn=function(e){return Ot(e,wn).bind((function(e){return k.from(e.match(/\d+/g))})).map((function(e){return V(e,w)}))},Sn=function(e){var t=M(yn(e).rows,(function(e,t){return B(t.cells,(function(t,n){t.isLocked&&(e[n]=!0)})),e}),{});return function(e,t){var n=N.call(e,0);return n.sort(t),n}(Ie(t,(function(e,t){return parseInt(t,10)})))},Tn=function(e,t){return e+","+t},kn=function(e,t){var n=z(e.all,(function(e){return e.cells}));return L(n,t)},Nn=function(e){var t={},n=[],r=$(e).map((function(e){return e.element})).bind(un).bind(xn).getOr({}),o=0,i=0,u=0,a=P(e,(function(e){return"colgroup"===e.section})),c=a.pass,f=a.fail;B(f,(function(e){var a=[];B(e.cells,(function(e){for(var n=0;void 0!==t[Tn(u,n)];)n++;for(var o=ze(r,n.toString()),c=function(e,t,n,r,o,i){return{element:e,rowspan:t,colspan:n,row:r,column:o,isLocked:i}}(e.element,e.rowspan,e.colspan,u,n,o),f=0;f<e.colspan;f++)for(var l=0;l<e.rowspan;l++){var s=n+f,d=Tn(u+l,s);t[d]=c,i=Math.max(i,s+1)}a.push(c)})),o++,n.push(qe(e.element,a,e.section)),u++}));var l=K(c).map((function(e){var t=function(e){var t={},n=0;return B(e.cells,(function(e){var r=e.colspan;A(r,(function(o){var i=n+o;t[i]=function(e,t,n){return{element:e,colspan:t,column:n}}(e.element,r,i)})),n+=r})),t}(e);return{colgroups:[function(e,t){return{element:e,columns:t}}(e.element,Me(t))],columns:t}})).getOrThunk((function(){return{colgroups:[],columns:{}}})),s=l.columns,d=l.colgroups;return{grid:function(e,t){return{rows:e,columns:t}}(o,i),access:t,all:n,columns:s,colgroups:d}},En={fromTable:function(e){var t=sn(e);return Nn(t)},generate:Nn,getAt:function(e,t,n){return k.from(e.access[Tn(t,n)])},findItem:function(e,t,n){var r=kn(e,(function(e){return n(t,e.element)}));return r.length>0?k.some(r[0]):k.none()},filterItems:kn,justCells:function(e){return z(e.all,(function(e){return e.cells}))},justColumns:function(e){return Me(e.columns)},hasColumns:function(e){return De(e.columns).length>0},getColumnAt:function(e,t){return k.from(e.columns[t])}},Rn=function(e,t){var n=t.column,r=t.column+t.colspan-1,o=t.row,i=t.row+t.rowspan-1;return n<=e.finishCol&&r>=e.startCol&&o<=e.finishRow&&i>=e.startRow},_n=function(e,t){return t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow},Dn=function(e,t,n){var r=En.findItem(e,t,Ne),o=En.findItem(e,n,Ne);return r.bind((function(e){return o.map((function(t){return n=e,r=t,o=Math.min(n.row,r.row),i=Math.min(n.column,r.column),u=Math.max(n.row+n.rowspan-1,r.row+r.rowspan-1),a=Math.max(n.column+n.colspan-1,r.column+r.colspan-1),{startRow:o,startCol:i,finishRow:u,finishCol:a};var n,r,o,i,u,a}))}))},An=function(e,t,n){return Dn(e,t,n).bind((function(t){return function(e,t){for(var n=!0,r=h(_n,t),o=t.startRow;o<=t.finishRow;o++)for(var i=t.startCol;i<=t.finishCol;i++)n=n&&En.getAt(e,o,i).exists(r);return n?k.some(t):k.none()}(e,t)}))},On=function(e,t,n){return Dn(e,t,n).map((function(t){var n=En.filterItems(e,h(Rn,t));return O(n,(function(e){return e.element}))}))},Bn=function(e,t){return En.findItem(e,t,(function(e,t){return Re(t,e)})).map((function(e){return e.element}))},Pn=function(e,t,n){return un(e).bind((function(r){return function(e,t,n,r){return En.findItem(e,t,Ne).bind((function(t){var o=n>0?t.row+t.rowspan-1:t.row,i=r>0?t.column+t.colspan-1:t.column;return En.getAt(e,o+n,i+r).map((function(e){return e.element}))}))}(Mn(r),e,t,n)}))},Ln=function(e,t,n){var r=Mn(e);return On(r,t,n)},In=function(e,t,n,r,o){var i=Mn(e),u=Ne(e,n)?k.some(t):Bn(i,t),a=Ne(e,o)?k.some(r):Bn(i,r);return u.bind((function(e){return a.bind((function(t){return On(i,e,t)}))}))},Mn=En.fromTable,Fn=function(e,t){ot(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},jn=function(e,t){at(e).fold((function(){ot(e).each((function(e){zn(e,t)}))}),(function(e){Fn(e,t)}))},Un=function(e,t){(function(e){return ft(e,0)})(e).fold((function(){zn(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))},zn=function(e,t){e.dom.appendChild(t.dom)},Hn=function(e,t){Fn(e,t),zn(t,e)},Vn=function(e,t){B(t,(function(n,r){var o=0===r?e:t[r-1];jn(o,n)}))},qn=function(e,t){B(t,(function(t){zn(e,t)}))},Wn=function(e){e.dom.textContent="",B(ct(e),(function(e){$n(e)}))},$n=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Kn=function(e){var t,n=ct(e);n.length>0&&(t=e,B(n,(function(e){Fn(t,e)}))),$n(e)},Xn=function(e,t){var n=function(t){return e(t)?k.from(t.dom.nodeValue):k.none()};return{get:function(r){if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r}}}(Je,"text"),Gn=function(e){return Xn.get(e)},Yn=function(e){return Xn.getOption(e)},Qn=function(e,t){return Xn.set(e,t)},Jn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Zn(){return{up:m({selector:Tt,closest:Et,predicate:St,all:it}),down:m({selector:wt,predicate:bt}),styles:m({get:Vt,getRaw:Wt,set:zt,remove:$t}),attrs:m({get:At,set:_t,remove:Bt,copyTo:function(e,t){var n=Pt(e);Dt(t,n)}}),insert:m({before:Fn,after:jn,afterAll:Vn,append:zn,appendAll:qn,prepend:Un,wrap:Hn}),remove:m({unwrap:Kn,remove:$n}),create:m({nu:xe.fromTag,clone:function(e){return xe.fromDom(e.dom.cloneNode(!1))},text:xe.fromText}),query:m({comparePosition:function(e,t){return e.dom.compareDocumentPosition(t.dom)},prevSibling:ut,nextSibling:at}),property:m({children:ct,name:Ke,parent:ot,document:function(e){return rt(e).dom},isText:Je,isComment:Ye,isElement:Qe,isSpecial:function(e){var t=Ke(e);return _(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:function(e){return Qe(e)?Ot(e,"lang"):k.none()},getText:Gn,setText:Qn,isBoundary:function(e){return!!Qe(e)&&("body"===Ke(e)||_(Jn,Ke(e)))},isEmptyTag:function(e){return!!Qe(e)&&_(["br","img","hr","input"],Ke(e))},isNonEditable:function(e){return Qe(e)&&"false"===At(e,"contenteditable")}}),eq:Ne,is:_e}}var er,tr,nr=function(e,t,n,r){var o=t(e,n);return I(r,(function(n,r){var o=t(e,r);return rr(e,n,o)}),o)},rr=function(e,t,n){return t.bind((function(t){return n.filter(h(e.eq,t))}))},or=function(e,t,n){return n.length>0?function(e,t,n,r){return r(e,t,n[0],n.slice(1))}(e,t,n,nr):k.none()},ir=function(e,t,n,r){void 0===r&&(r=C);var o=[t].concat(e.up().all(t)),i=[n].concat(e.up().all(n)),u=function(e){return j(e,r).fold((function(){return e}),(function(t){return e.slice(0,t+1)}))},a=u(o),c=u(i),f=F(a,(function(t){return D(c,function(e,t){return h(e.eq,t)}(e,t))}));return{firstpath:a,secondpath:c,shared:f}},ur=Zn(),ar=function(e,t){return or(ur,(function(t,n){return e(n)}),t)},cr=function(e){return Tt(e,"table")},fr=function(e,t,n){var r=function(e){return function(t){return void 0!==n&&n(t)||Ne(t,e)}};return Ne(e,t)?k.some({boxes:k.some([e]),start:e,finish:t}):cr(e).bind((function(o){return cr(t).bind((function(i){if(Ne(o,i))return k.some({boxes:Ln(o,e,t),start:e,finish:t});if(Re(o,i)){var u=(a=yt(t,"td,th",r(o))).length>0?a[a.length-1]:t;return k.some({boxes:In(o,e,o,t,i),start:e,finish:u})}if(Re(i,o)){var a,c=(a=yt(e,"td,th",r(i))).length>0?a[a.length-1]:e;return k.some({boxes:In(i,e,o,t,i),start:e,finish:c})}return function(e,t,n){return ir(ur,e,t,n)}(e,t).shared.bind((function(u){return Et(u,"table",n).bind((function(n){var u=yt(t,"td,th",r(n)),a=u.length>0?u[u.length-1]:t,c=yt(e,"td,th",r(n)),f=c.length>0?c[c.length-1]:e;return k.some({boxes:In(n,e,o,t,i),start:f,finish:a})}))}))}))}))},lr=function(e,t){var n=wt(e,t);return n.length>0?k.some(n):k.none()},sr=function(e,t,n){return Nt(e,t).bind((function(t){return Nt(e,n).bind((function(e){return ar(cr,[t,e]).map((function(n){return{first:t,last:e,table:n}}))}))}))},dr=function(e,t,n,r,o){return function(e,t){return F(e,(function(e){return Se(e,t)}))}(e,o).bind((function(e){return Pn(e,t,n).bind((function(e){return function(e,t){return Tt(e,"table").bind((function(n){return Nt(n,t).bind((function(t){return fr(t,e).bind((function(e){return e.boxes.map((function(t){return{boxes:t,start:e.start,finish:e.finish}}))}))}))}))}(e,r)}))}))},mr=function(e,t){return lr(e,t)},gr=function(e,t,n){return sr(e,t,n).bind((function(t){var n=function(t){return Ne(e,t)},r=Tt(t.first,"thead,tfoot,tbody,table",n),o=Tt(t.last,"thead,tfoot,tbody,table",n);return r.bind((function(e){return o.bind((function(n){return Ne(e,n)?function(e,t,n){var r=Mn(e);return An(r,t,n)}(t.table,t.first,t.last):k.none()}))}))}))},pr=function(e){if(!i(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return B(e,(function(r,o){var u=De(r);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!i(c))throw new Error("case arguments must be an array");t.push(a),n[a]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+i);var u=function(e){var r=De(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!H(t,(function(e){return _(r,e)})))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,n)};return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);var i=t[o];return i.apply(null,n)},match:u,log:function(e){console.log(e,{constructors:t,constructor:a,params:n})}}}})),n},hr=pr([{none:[]},{multiple:["elements"]},{single:["element"]}]),vr=function(e,t,n,r){return e.fold(t,n,r)},br=hr.none,yr=hr.multiple,Cr=hr.single,wr=tinymce.util.Tools.resolve("tinymce.PluginManager"),xr=function(e,t){return xe.fromDom(e.dom.cloneNode(t))},Sr=function(e){return xr(e,!1)},Tr=function(e){return xr(e,!0)},kr=function(e,t){var n=xe.fromTag(t),r=Pt(e);return Dt(n,r),n},Nr=function(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=Vt(n,e);return parseFloat(o)||0}return r},r=function(e,t){return M(t,(function(t,n){var r=Vt(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,n){if(!s(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;jt(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return t>o?t-o:0}}},Er=function(){var e=Ce().browser;return e.isIE()||e.isEdge()},Rr=function(e,t){return function(e){var t=parseFloat(e);return isNaN(t)?k.none():k.some(t)}(e).getOr(t)},_r=function(e,t,n){return Rr(Vt(e,t),n)},Dr=function(e){return Vt(e,"box-sizing")},Ar=function(e,t,n,r){return t-_r(e,"padding-"+n,0)-_r(e,"padding-"+r,0)-_r(e,"border-"+n+"-width",0)-_r(e,"border-"+r+"-width",0)},Or=function(e,t){var n=e.dom,r=n.getBoundingClientRect().width||n.offsetWidth;return"border-box"===t?r:Ar(e,r,"left","right")},Br=Nr("width",(function(e){return e.dom.offsetWidth})),Pr=function(e){return Br.get(e)},Lr=function(e){return Br.getOuter(e)},Ir=function(e){return Or(e,"content-box")},Mr=function(e){return Er()?Or(e,Dr(e)):_r(e,"width",e.dom.offsetWidth)},Fr=function(e,t){void 0===t&&(t=w);var n=e.grid,r=A(n.columns,g),o=A(n.rows,g);return O(r,(function(n){return jr((function(){return z(o,(function(t){return En.getAt(e,t,n).filter((function(e){return e.column===n})).toArray()}))}),(function(e){return 1===e.colspan&&t(e.element)}),(function(){return En.getAt(e,0,n)}))}))},jr=function(e,t,n){var r=e();return F(r,t).orThunk((function(){return k.from(r[0]).orThunk(n)})).map((function(e){return e.element}))},Ur=function(e){var t=e.grid,n=A(t.rows,g),r=A(t.columns,g);return O(n,(function(t){return jr((function(){return z(r,(function(n){return En.getAt(e,t,n).filter((function(e){return e.row===t})).fold(m([]),(function(e){return[e]}))}))}),(function(e){return 1===e.rowspan}),(function(){return En.getAt(e,t,0)}))}))},zr=function(e,t){if(t<0||t>=e.length-1)return k.none();var n=e[t].fold((function(){var n=function(e){var t=N.call(e,0);return t.reverse(),t}(e.slice(0,t));return X(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return k.some({value:e,delta:0})})),r=e[t+1].fold((function(){var n=e.slice(t+1);return X(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return k.some({value:e,delta:1})}));return n.bind((function(e){return r.map((function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n}))}))},Hr=function(e,t){return function(n){return"rtl"===Vr(n)?t:e}},Vr=function(e){return"rtl"===Vt(e,"direction")?"rtl":"ltr"},qr=Nr("height",(function(e){var t=e.dom;return ht(e)?t.getBoundingClientRect().height:t.offsetHeight})),Wr=function(e){return qr.get(e)},$r=function(e){return qr.getOuter(e)},Kr=function(e){return Er()?function(e,t){var n=e.dom,r=n.getBoundingClientRect().height||n.offsetHeight;return"border-box"===t?r:Ar(e,r,"top","bottom")}(e,Dr(e)):_r(e,"height",e.dom.offsetHeight)},Xr=function(e,t){return{left:e,top:t,translate:function(n,r){return Xr(e+n,t+r)}}},Gr=Xr,Yr=function(e,t){return void 0!==e?e:void 0!==t?t:0},Qr=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return Gr(n.offsetLeft,n.offsetTop);var i=Yr(null==r?void 0:r.pageYOffset,o.scrollTop),u=Yr(null==r?void 0:r.pageXOffset,o.scrollLeft),a=Yr(o.clientTop,n.clientTop),c=Yr(o.clientLeft,n.clientLeft);return Jr(e).translate(u-c,i-a)},Jr=function(e){var t=e.dom,n=t.ownerDocument.body;return n===t?Gr(n.offsetLeft,n.offsetTop):ht(e)?function(e){var t=e.getBoundingClientRect();return Gr(t.left,t.top)}(t):Gr(0,0)},Zr=function(e,t){return{row:e,y:t}},eo=function(e,t){return{col:e,x:t}},to=function(e){return Qr(e).left+Lr(e)},no=function(e){return Qr(e).left},ro=function(e,t){return eo(e,no(t))},oo=function(e,t){return eo(e,to(t))},io=function(e){return Qr(e).top},uo=function(e,t){return Zr(e,io(t))},ao=function(e,t){return Zr(e,io(t)+$r(t))},co=function(e,t,n){if(0===n.length)return[];var r=O(n.slice(1),(function(t,n){return t.map((function(t){return e(n,t)}))})),o=n[n.length-1].map((function(e){return t(n.length-1,e)}));return r.concat([o])},fo={delta:g,positions:function(e){return co(uo,ao,e)},edge:io},lo={delta:g,edge:no,positions:function(e){return co(ro,oo,e)}},so={delta:function(e){return-e},edge:to,positions:function(e){return co(oo,ro,e)}},mo=Hr(lo,so),go={delta:function(e,t){return mo(t).delta(e,t)},positions:function(e,t){return mo(t).positions(e,t)},edge:function(e){return mo(e).edge(e)}},po={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},ho=(er=function(e){return"(?:"+e+")?"},tr=["Infinity","[0-9]+\\."+er("[0-9]+")+er("[eE][+-]?[0-9]+"),"\\.[0-9]+"+er("[eE][+-]?[0-9]+"),"[0-9]+"+er("[eE][+-]?[0-9]+")].join("|"),new RegExp("^([+-]?(?:"+tr+"))(.*)$")),vo=function(e,t){return k.from(ho.exec(e)).bind((function(e){var n=Number(e[1]),r=e[2];return function(e,t){return D(t,(function(t){return D(po[t],(function(t){return e===t}))}))}(r,t)?k.some({value:n,unit:r}):k.none()}))},bo=/(\d+(\.\d+)?)%/,yo=/(\d+(\.\d+)?)px|em/,Co=tt("col"),wo=function(e,t,n){var r,o=(r=e,k.from(r.dom.parentElement).map(xe.fromDom)).getOrThunk((function(){return vt(nt(e))}));return t(e)/n(o)*100},xo=function(e,t){zt(e,"width",t+"px")},So=function(e,t){zt(e,"width",t+"%")},To=function(e,t){zt(e,"height",t+"px")},ko=function(e,t,n,r){var o=parseFloat(e);return ie(e,"%")&&"table"!==Ke(t)?function(e,t,n,r){var o=un(e).map((function(e){var r=n(e);return Math.floor(t/100*r)})).getOr(t);return r(e,o),o}(t,o,n,r):o},No=function(e){var t=function(e){return Kr(e)+"px"}(e);return t?ko(t,e,Wr,To):Wr(e)},Eo=function(e,t){return Wt(e,t).orThunk((function(){return Ot(e,t).map((function(e){return e+"px"}))}))},Ro=function(e){return Eo(e,"width")},_o=function(e){return wo(e,Pr,Ir)},Do=function(e){return Co(e)?Pr(e):Mr(e)},Ao=function(e){return function(e,t,n){return n(e)/Xt(e,t)}(e,"rowspan",No)},Oo=function(e,t,n){zt(e,"width",t+n)},Bo=function(e){return wo(e,Pr,Ir)+"%"},Po=m(bo),Lo=tt("col"),Io=function(e){return Ro(e).getOrThunk((function(){return Do(e)+"px"}))},Mo=function(e){return(t=e,Eo(t,"height")).getOrThunk((function(){return Ao(e)+"px"}));var t},Fo=function(e,t,n,r,o,i){return e.filter(r).fold((function(){return i(zr(n,t))}),(function(e){return o(e)}))},jo=function(e,t,n,r){var o=Fr(e),i=En.hasColumns(e)?function(e){return O(En.justColumns(e),(function(e){return k.from(e.element)}))}(e):o,u=[k.some(go.edge(t))].concat(O(go.positions(o,t),(function(e){return e.map((function(e){return e.x}))}))),a=y(Gt);return O(i,(function(e,t){return Fo(e,t,u,a,(function(e){if(function(e){var t=Ce().browser,n=t.isChrome()||t.isFirefox();return!Lo(e)||n}(e))return n(e);var i,c,f=(i=o[t],c=g,null!=i?c(i):k.none());return Fo(f,t,u,a,(function(e){return r(k.some(Pr(e)))}),r)}),r)}))},Uo=function(e){return e.map((function(e){return e+"px"})).getOr("")},zo=function(e,t,n){return jo(e,t,Do,(function(e){return e.getOrThunk(n.minCellWidth)}))},Ho=function(e,t,n,r,o){var i=Ur(e),u=[k.some(n.edge(t))].concat(O(n.positions(i,t),(function(e){return e.map((function(e){return e.y}))})));return O(i,(function(e,t){return Fo(e,t,u,y(Yt),r,o)}))},Vo=function(e,t){return function(){return ht(e)?t(e):parseFloat(Wt(e,"width").getOr("0"))}},qo=function(e){var t=Vo(e,Pr),n=m(0);return{width:t,pixelWidth:t,getWidths:function(t,n){return zo(t,e,n)},getCellDelta:n,singleColumnWidth:m([0]),minCellWidth:n,setElementWidth:d,adjustTableWidth:d,isRelative:!0,label:"none"}},Wo=function(e){var t=Vo(e,(function(e){return parseFloat(Bo(e))})),n=Vo(e,Pr);return{width:t,pixelWidth:n,getWidths:function(t,n){return function(e,t,n){return jo(e,t,_o,(function(e){return e.fold((function(){return n.minCellWidth()}),(function(e){return e/n.pixelWidth()*100}))}))}(t,e,n)},getCellDelta:function(e){return e/n()*100},singleColumnWidth:function(e,t){return[100-e]},minCellWidth:function(){return Jt()/n()*100},setElementWidth:So,adjustTableWidth:function(n){var r=t();So(e,r+n/100*r)},isRelative:!0,label:"percent"}},$o=function(e){var t=Vo(e,Pr);return{width:t,pixelWidth:t,getWidths:function(t,n){return zo(t,e,n)},getCellDelta:g,singleColumnWidth:function(e,t){return[Math.max(Jt(),e+t)-e]},minCellWidth:Jt,setElementWidth:xo,adjustTableWidth:function(n){var r=t()+n;xo(e,r)},isRelative:!1,label:"pixel"}},Ko=function(e){return Ro(e).fold((function(){return qo(e)}),(function(t){return function(e,t){return null!==Po().exec(t)?Wo(e):$o(e)}(e,t)}))},Xo=$o,Go=Wo,Yo=function(e,t,n){var r=e[n].element,o=xe.fromTag("td");zn(o,xe.fromTag("br")),(t?zn:Un)(r,o)},Qo=function(e,t){var n=function(e){return Se(e.element,t)},r=Tr(e),o=sn(r),i=Ko(e),u=En.generate(o),a=function(e,t){var n=e.grid.columns,r=e.grid.rows,o=n,i=0,u=0,a=[],c=[];return Oe(e.access,(function(e){if(a.push(e),t(e)){c.push(e);var n=e.row,f=n+e.rowspan-1,l=e.column,s=l+e.colspan-1;n<r?r=n:f>i&&(i=f),l<o?o=l:s>u&&(u=s)}})),function(e,t,n,r,o,i){return{minRow:e,minCol:t,maxRow:n,maxCol:r,allCells:o,selectedCells:i}}(r,o,i,u,a,c)}(u,n),c="th:not("+t+"),td:not("+t+")",f=tn(r,"th,td",(function(e){return Se(e,c)}));return B(f,$n),function(e,t,n,r){for(var o=t.grid.columns,i=t.grid.rows,u=0;u<i;u++)for(var a=!1,c=0;c<o;c++){if(!(u<n.minRow||u>n.maxRow||c<n.minCol||c>n.maxCol))En.getAt(t,u,c).filter(r).isNone()?Yo(e,a,u):a=!0}}(o,u,a,n),function(e,t,n,r){Oe(n.columns,(function(e){(e.column<t.minCol||e.column>t.maxCol)&&$n(e.element)}));var o=L(en(e,"tr"),(function(e){return 0===e.dom.childElementCount}));B(o,$n),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||B(en(e,"th,td"),(function(e){Bt(e,"rowspan"),Bt(e,"colspan")})),Bt(e,wn),Bt(e,"data-snooker-col-series"),Ko(e).adjustTableWidth(r)}(r,a,u,function(e,t,n,r){if(0===r.minCol&&t.grid.columns===r.maxCol+1)return 0;var o=zo(t,e,n),i=M(o,(function(e,t){return e+t}),0),u=M(o.slice(r.minCol,r.maxCol+1),(function(e,t){return e+t}),0)/i*n.pixelWidth()-n.pixelWidth();return n.getCellDelta(u)}(e,En.fromTable(e),i,a)),r},Jo=function(e){return"img"===Ke(e)?1:Yn(e).fold((function(){return ct(e).length}),(function(e){return e.length}))},Zo=["img","br"],ei=function(e){return Yn(e).filter((function(e){return 0!==e.trim().length||e.indexOf("")>-1})).isSome()||_(Zo,Ke(e))},ti=function(e){return t=ei,(n=function(e){for(var r=0;r<e.childNodes.length;r++){var o=xe.fromDom(e.childNodes[r]);if(t(o))return k.some(o);var i=n(e.childNodes[r]);if(i.isSome())return i}return k.none()})(e.dom);var t,n},ni=function(e){return ri(e,ei)},ri=function(e,t){var n=function(e){for(var r=ct(e),o=r.length-1;o>=0;o--){var i=r[o];if(t(i))return k.some(i);var u=n(i);if(u.isSome())return u}return k.none()};return n(e)},oi={scope:["row","col"]},ii=function(e){return function(){var t=xe.fromTag("td",e.dom);return zn(t,xe.fromTag("br",e.dom)),t}},ui=function(e){return function(){return xe.fromTag("col",e.dom)}},ai=function(e){return function(){return xe.fromTag("colgroup",e.dom)}},ci=function(e){return function(){return xe.fromTag("tr",e.dom)}},fi=function(e,t,n){var r=function(e,t){var n=kr(e,t),r=ct(Tr(e));return qn(n,r),n}(e,t);return Oe(n,(function(e,t){null===e?Bt(r,t):_t(r,t,e)})),r},li=function(e){return e},si=function(e,t,n){var r=function(e,t){var n,r,o,i;n=e.element,r=t,o=n.dom,i=r.dom,jt(o)&&jt(i)&&(i.style.cssText=o.style.cssText),$t(t,"height"),1!==e.colspan&&$t(t,"width")};return{col:function(n){var o=xe.fromTag(Ke(n.element),t.dom);return r(n,o),e(n.element,o),o},colgroup:ai(t),row:ci(t),cell:function(o){var i=xe.fromTag(Ke(o.element),t.dom),u=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),a=u.length>0?function(e,t,n){return ti(e).map((function(r){var o=n.join(","),i=yt(r,o,(function(t){return Ne(t,e)}));return I(i,(function(e,t){var n=Sr(t);return Bt(n,"contenteditable"),zn(e,n),n}),t)})).getOr(t)}(o.element,i,u):i;return zn(a,xe.fromTag("br")),r(o,i),function(e,t){Oe(oi,(function(n,r){return Ot(e,r).filter((function(e){return _(n,e)})).each((function(e){return _t(t,r,e)}))}))}(o.element,i),e(o.element,i),i},replace:fi,colGap:ui(t),gap:ii(t)}},di=function(e){return{col:ui(e),colgroup:ai(e),row:ci(e),cell:ii(e),replace:li,colGap:ui(e),gap:ii(e)}},mi=function(e){return O(e,xe.fromDom)},gi=function(e){return xe.fromDom(e.getBody())},pi=function(e){return e.getBoundingClientRect().width},hi=function(e){return e.getBoundingClientRect().height},vi=function(e){return function(t){return Ne(t,gi(e))}},bi=function(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e},yi=function(e){Bt(e,"data-mce-style");var t=function(e){return Bt(e,"data-mce-style")};B(rn(e),t),B(on(e),t),B(an(e),t)},Ci=function(e){return xe.fromDom(e.selection.getStart())},wi=function(e){return vr(e.get(),m([]),g,q)},xi=function(e){var t=function(e,t){return Ot(e,t).exists((function(e){return parseInt(e,10)>1}))},n=wi(e);return n.length>0&&H(n,(function(e){return t(e,"rowspan")||t(e,"colspan")}))?k.some(n):k.none()},Si=function(e,t,n){return vr(t.get(),k.none,(function(t){return t.length<=1?k.none():gr(e,n.firstSelectedSelector,n.lastSelectedSelector).map((function(e){return{bounds:e,cells:t}}))}),k.none)},Ti={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},ki=function(e,t,n){return{element:n,mergable:Si(t,e,Ti),unmergable:xi(e),selection:wi(e)}},Ni=function(e){return function(t,n){var r,o=Ke(t),i="col"===o||"colgroup"===o?un(r=t).bind((function(e){return mr(e,Ti.firstSelectedSelector)})).fold(m(r),(function(e){return e[0]})):t;return Et(i,e,n)}},Ei=Ni("th,td,caption"),Ri=Ni("th,td"),_i=function(e){return wi(e)},Di=function(e,t,n){e.on("BeforeGetContent",(function(n){!0===n.selection&&vr(t.get(),d,(function(t){n.preventDefault(),function(e){return un(e[0]).map((function(e){var t=Qo(e,"[data-mce-selected]");return yi(t),[t]}))}(t).each((function(t){n.content="text"===n.format?function(e){return O(e,(function(e){return e.dom.innerText})).join("")}(t):function(e,t){return O(t,(function(t){return e.selection.serializer.serialize(t.dom,{})})).join("")}(e,t)}))}),d)})),e.on("BeforeSetContent",(function(r){if(!0===r.selection&&!0===r.paste){var o=_i(t);$(o).each((function(t){un(t).each((function(o){var i,u,a,c=L((i=r.content,(a=(u||document).createElement("div")).innerHTML=i,ct(xe.fromDom(a))),(function(e){return"meta"!==Ke(e)})),f=tt("table");if(1===c.length&&f(c[0])){r.preventDefault();var l=xe.fromDom(e.getDoc()),s=di(l),d=function(e,t,n){return{element:e,clipboard:t,generators:n}}(t,c[0],s);n.pasteCells(o,d).each((function(){e.focus()}))}}))}))}}))},Ai=pr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Oi=G({},Ai),Bi=function(e,t,n,r,o){var i=e.slice(0),u=function(e,t){return 0===e.length?Oi.none():1===e.length?Oi.only(0):0===t?Oi.left(0,1):t===e.length-1?Oi.right(t-1,t):t>0&&t<e.length-1?Oi.middle(t-1,t,t+1):Oi.none()}(e,t),a=m(O(i,m(0)));return u.fold(a,(function(e){return r.singleColumnWidth(i[e],n)}),(function(e,t){return o.calcLeftEdgeDeltas(i,e,t,n,r.minCellWidth(),r.isRelative)}),(function(e,t,u){return o.calcMiddleDeltas(i,e,t,u,n,r.minCellWidth(),r.isRelative)}),(function(e,t){return o.calcRightEdgeDeltas(i,e,t,n,r.minCellWidth(),r.isRelative)}))},Pi=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=void 0!==n[o]?n[o]:0;return r},Li=function(e,t){var n=En.justCells(e);return O(n,(function(e){var n=Pi(e.row,e.row+e.rowspan,t);return{element:e.element,height:n,rowspan:e.rowspan}}))},Ii=function(e,t){return En.hasColumns(e)?function(e,t){var n=En.justColumns(e);return O(n,(function(e,n){return{element:e.element,width:t[n],colspan:e.colspan}}))}(e,t):function(e,t){var n=En.justCells(e);return O(n,(function(e){var n=Pi(e.column,e.column+e.colspan,t);return{element:e.element,width:n,colspan:e.colspan}}))}(e,t)},Mi=function(e,t,n){var r=Ii(e,t);B(r,(function(e){n.setElementWidth(e.element,e.width)}))},Fi=function(e,t,n,r,o){var i=En.fromTable(e),u=o.getCellDelta(t),a=o.getWidths(i,o),c=n===i.grid.columns-1,f=r.clampTableDelta(a,n,u,o.minCellWidth(),c),l=Bi(a,n,f,o,r),s=O(l,(function(e,t){return e+a[t]}));Mi(i,s,o),r.resizeTable(o.adjustTableWidth,f,c)},ji=function(e,t,n,r){var o=En.fromTable(e),i=function(e,t,n){return Ho(e,t,n,Ao,(function(e){return e.getOrThunk(Zt)}))}(o,e,r),u=O(i,(function(e,r){return n===r?Math.max(t+e,Zt()):e})),a=Li(o,u),c=function(e,t){return O(e.all,(function(e,n){return{element:e.element,height:t[n]}}))}(o,u);B(c,(function(e){To(e.element,e.height)})),B(a,(function(e){To(e.element,e.height)}));var f=I(u,(function(e,t){return e+t}),0);To(e,f)},Ui=function(e){return O(e,m(0))},zi=function(e,t,n,r,o){return o(e.slice(0,t)).concat(r).concat(o(e.slice(n)))},Hi=function(e){return function(t,n,r,o){if(e(r)){var i=Math.max(o,t[n]-Math.abs(r)),u=Math.abs(i-t[n]);return r>=0?u:-u}return r}},Vi=Hi((function(e){return e<0})),qi=Hi(w),Wi=function(){var e=function(e,t,n,r){var o=(100+n)/100,i=Math.max(r,(e[t]+n)/o);return O(e,(function(e,n){return(n===t?i:e/o)-e}))},t=function(t,n,r,o,i,u){return u?e(t,n,o,i):function(e,t,n,r,o){var i=Vi(e,t,r,o);return zi(e,t,n+1,[i,0],Ui)}(t,n,r,o,i)};return{resizeTable:function(e,t){return e(t)},clampTableDelta:Vi,calcLeftEdgeDeltas:t,calcMiddleDeltas:function(e,n,r,o,i,u,a){return t(e,r,o,i,u,a)},calcRightEdgeDeltas:function(t,n,r,o,i,u){if(u)return e(t,r,o,i);var a=Vi(t,r,o,i);return Ui(t.slice(0,r)).concat([a])},calcRedestributedWidths:function(e,t,n,r){if(r){var o=(t+n)/t,i=O(e,(function(e){return e/o}));return{delta:100*o-100,newSizes:i}}return{delta:n,newSizes:e}}}},$i=function(){var e=function(e,t,n,r,o){var i=qi(e,r>=0?n:t,r,o);return zi(e,t,n+1,[i,-i],Ui)};return{resizeTable:function(e,t,n){n&&e(t)},clampTableDelta:function(e,t,n,r,o){if(o){if(n>=0)return n;var i=M(e,(function(e,t){return e+t-r}),0);return Math.max(-i,n)}return Vi(e,t,n,r)},calcLeftEdgeDeltas:e,calcMiddleDeltas:function(t,n,r,o,i,u){return e(t,r,o,i,u)},calcRightEdgeDeltas:function(e,t,n,r,o,i){if(i)return Ui(e);var u=r/e.length;return O(e,m(u))},calcRedestributedWidths:function(e,t,n,r){return{delta:0,newSizes:e}}}},Ki=function(e,t){var n=k.from(e.dom.documentElement).map(xe.fromDom).getOr(e);return{parent:m(n),view:m(e),origin:m(Gr(0,0)),isResizable:t}},Xi=function(e,t,n){return{parent:m(t),view:m(e),origin:m(Gr(0,0)),isResizable:n}},Gi=pr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Yi=function(e,t,n){var r=n.substring(0,n.length-e.length),o=parseFloat(r);return r===o.toString()?t(o):Gi.invalid(n)},Qi=G(G({},Gi),{from:function(e){return ie(e,"%")?Yi("%",Gi.percent,e):ie(e,"px")?Yi("px",Gi.pixels,e):Gi.invalid(e)}}),Ji=function(e,t,n){return e.fold((function(){return t}),(function(e){return function(e,t,n){var r=n/t;return O(e,(function(e){return Qi.from(e).fold((function(){return e}),(function(e){return e*r+"px"}),(function(e){return e/100*n+"px"}))}))}(t,n,e)}),(function(e){return function(e,t){return O(e,(function(e){return Qi.from(e).fold((function(){return e}),(function(e){return e/t*100+"%"}),(function(e){return e+"%"}))}))}(t,n)}))},Zi=function(e,t,n){var r=Qi.from(n),o=H(e,(function(e){return"0px"===e}))?function(e,t){var n=e.fold((function(){return m("")}),(function(e){return m(e/t+"px")}),(function(){return m(100/t+"%")}));return A(t,n)}(r,e.length):Ji(r,e,t);return nu(o)},eu=function(e,t){return 0===e.length?t:I(e,(function(e,t){return Qi.from(t).fold(m(0),g,g)+e}),0)},tu=function(e,t){return Qi.from(e).fold(m(e),(function(e){return e+t+"px"}),(function(e){return e+t+"%"}))},nu=function(e){if(0===e.length)return e;var t=I(e,(function(e,t){var n=Qi.from(t).fold((function(){return{value:t,remainder:0}}),(function(e){return function(e,t){var n=Math.floor(e);return{value:n+t,remainder:e-n}}(e,"px")}),(function(e){return{value:e+"%",remainder:0}}));return{output:[n.value].concat(e.output),remainder:e.remainder+n.remainder}}),{output:[],remainder:0}),n=t.output;return n.slice(0,n.length-1).concat([tu(n[n.length-1],Math.round(t.remainder))])},ru=Qi.from,ou=function(e){return ru(e).fold(m("px"),m("px"),m("%"))},iu=function(e,t,n){var r=En.fromTable(e),o=r.all,i=En.justCells(r),u=En.justColumns(r);t.each((function(t){var n=ou(t),o=Pr(e),a=function(e,t){return jo(e,t,Io,Uo)}(r,e),c=Zi(a,o,t);En.hasColumns(r)?function(e,t,n){B(t,(function(t,r){var o=eu([e[r]],Jt());zt(t.element,"width",o+n)}))}(c,u,n):function(e,t,n){B(t,(function(t){var r=e.slice(t.column,t.colspan+t.column),o=eu(r,Jt());zt(t.element,"width",o+n)}))}(c,i,n),zt(e,"width",t)})),n.each((function(t){var n=ou(t),u=Wr(e),a=function(e,t,n){return Ho(e,t,n,Mo,Uo)}(r,e,fo);!function(e,t,n,r){B(n,(function(t){var n=e.slice(t.row,t.rowspan+t.row),o=eu(n,Zt());zt(t.element,"height",o+r)})),B(t,(function(t,n){zt(t.element,"height",e[n])}))}(Zi(a,u,t),o,i,n),zt(e,"height",t)}))},uu=function(e){return Ro(e).exists((function(e){return bo.test(e)}))},au=function(e){return Ro(e).exists((function(e){return yo.test(e)}))},cu=function(e){return Ro(e).isNone()},fu=function(e){return En.fromTable(e).grid},lu=function(e){var t=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},unbind:function(e){t=L(t,(function(t){return t!==e}))},trigger:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o={};B(e,(function(e,t){o[e]=n[t]})),B(t,(function(e){e(o)}))}}},su=function(e){return{registry:Be(e,(function(e){return{bind:e.bind,unbind:e.unbind}})),trigger:Be(e,(function(e){return e.trigger}))}},du=function(e){return e.slice(0).sort()},mu=function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");var o;return function(e,t){if(!i(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");B(t,(function(t){if(!r(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))}("required",t),o=du(t),F(o,(function(e,t){return t<o.length-1&&e===o[t+1]})).each((function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+o.join(", ")+"].")})),function(r){var o=De(r);H(t,(function(e){return _(o,e)}))||function(e,t){throw new Error("All required keys ("+du(e).join(", ")+") were not specified. Specified keys were: "+du(t).join(", ")+".")}(t,o),e(t,o);var i=L(t,(function(e){return!n.validate(r[e],e)}));return i.length>0&&function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+du(e).join(", ")+") were not.")}(i,n.label),r}},gu=function(e,t){var n=L(t,(function(t){return!_(e,t)}));n.length>0&&function(e){throw new Error("Unsupported keys for object: "+du(e).join(", "))}(n)},pu=function(e){return function(e,t){return mu(e,t,{validate:l,label:"function"})}(gu,e)},hu=pu(["compare","extract","mutate","sink"]),vu=pu(["element","start","stop","destroy"]),bu=pu(["forceDrop","drop","move","delayDrop"]),yu=function(){var e=k.none(),t=su({move:lu(["info"])});return{onEvent:function(n,r){r.extract(n).each((function(n){(function(t,n){var r=e.map((function(e){return t.compare(e,n)}));return e=k.some(n),r})(r,n).each((function(e){t.trigger.move(e)}))}))},reset:function(){e=k.none()},events:t.registry}},Cu=function(){var e,t=(e=su({move:lu(["info"])}),{onEvent:d,reset:d,events:e.registry}),n=yu(),r=t;return{on:function(){r.reset(),r=n},off:function(){r.reset(),r=t},isOn:function(){return r===n},onEvent:function(e,t){r.onEvent(e,t)},events:n.events}},wu=function(e,t,n){var r,o,i,a,c=!1,f=su({start:lu([]),stop:lu([])}),l=Cu(),s=function(){g.stop(),l.isOn()&&(l.off(),f.trigger.stop())},d=(r=s,o=200,i=null,{cancel:a=function(){u(i)||(clearTimeout(i),i=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a(),i=setTimeout((function(){i=null,r.apply(null,e)}),o)}});l.events.move.bind((function(n){t.mutate(e,n.info)}));var m=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];c&&e.apply(null,t)}},g=t.sink(bu({forceDrop:s,drop:m(s),move:m((function(e){d.cancel(),l.onEvent(e,t)})),delayDrop:m(d.throttle)}),n);return{element:g.element,go:function(e){g.start(e),l.on(),f.trigger.start()},on:function(){c=!0},off:function(){c=!1},destroy:function(){g.destroy()},events:f.registry}},xu=function(e){var t,n,r=xe.fromDom(function(e){if(st()&&f(e.target)){var t=xe.fromDom(e.target);if(Qe(t)&&pt(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return $(n)}}return k.from(e.target)}(e).getOr(e.target)),o=function(){return e.stopPropagation()},i=function(){return e.preventDefault()},u=(t=i,n=o,function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))});return function(e,t,n,r,o,i,u){return{target:e,x:t,y:n,stop:r,prevent:o,kill:i,raw:u}}(r,e.clientX,e.clientY,o,i,u,e)},Su=function(e,t,n,r,o){var i=function(e,t){return function(n){e(n)&&t(xu(n))}}(n,r);return e.dom.addEventListener(t,i,o),{unbind:h(Tu,e,t,i,o)}},Tu=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},ku=w,Nu=function(e,t,n){return function(e,t,n,r){return Su(e,t,n,r,!1)}(e,t,ku,n)},Eu=xu,Ru=function(e,t){var n=At(e,t);return void 0===n||""===n?[]:n.split(" ")},_u=function(e){return void 0!==e.dom.classList},Du=function(e,t){return function(e,t,n){var r=Ru(e,t).concat([n]);return _t(e,t,r.join(" ")),!0}(e,"class",t)},Au=function(e,t){_u(e)?e.dom.classList.add(t):Du(e,t)},Ou=function(e,t){return _u(e)&&e.dom.classList.contains(t)},Bu=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},Pu=Bu("ephox-dragster"),Lu=Pu.resolve,Iu=hu({compare:function(e,t){return Gr(t.left-e.left,t.top-e.top)},extract:function(e){return k.some(Gr(e.x,e.y))},sink:function(e,t){var n=function(e){var t=G({layerClass:Lu("blocker")},e),n=xe.fromTag("div");_t(n,"role","presentation"),Ht(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Au(n,Lu("blocker")),Au(n,t.layerClass);return{element:m(n),destroy:function(){$n(n)}}}(t),r=Nu(n.element(),"mousedown",e.forceDrop),o=Nu(n.element(),"mouseup",e.drop),i=Nu(n.element(),"mousemove",e.move),u=Nu(n.element(),"mouseout",e.delayDrop);return vu({element:n.element,start:function(e){zn(e,n.element())},stop:function(){$n(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(e,t){e.mutate(t.left,t.top)}}),Mu=function(e){return Et(e,"[contenteditable]")},Fu=function(e,t){return void 0===t&&(t=!1),!Ce().browser.isIE()&&ht(e)?e.dom.isContentEditable:Mu(e).fold(m(t),(function(e){return"true"===ju(e)}))},ju=function(e){return e.dom.contentEditable},Uu=Bu("ephox-snooker"),zu=Uu.resolve,Hu=function(){var e=su({drag:lu(["xDelta","yDelta","target"])}),t=k.none(),n=function(){var e=su({drag:lu(["xDelta","yDelta"])});return{mutate:function(t,n){e.trigger.drag(t,n)},events:e.registry}}();n.events.drag.bind((function(n){t.each((function(t){e.trigger.drag(n.xDelta,n.yDelta,t)}))}));return{assign:function(e){t=k.some(e)},get:function(){return t},mutate:n.mutate,events:e.registry}},Vu=zu("resizer-bar"),qu=zu("resizer-rows"),Wu=zu("resizer-cols"),$u=function(e){var t=wt(e.parent(),"."+Vu);B(t,$n)},Ku=function(e,t,n){var r=e.origin();B(t,(function(t){t.each((function(t){var o=n(r,t);Au(o,Vu),zn(e.parent(),o)}))}))},Xu=function(e,t,n,r){Ku(e,t,(function(e,t){var o,i,u,a,c,f,l=(o=t.col,i=t.x-e.left,u=n.top-e.top,a=7,c=r,f=xe.fromTag("div"),Ht(f,{position:"absolute",left:i-a/2+"px",top:u+"px",height:c+"px",width:a+"px"}),Dt(f,{"data-column":o,role:"presentation"}),f);return Au(l,Wu),l}))},Gu=function(e,t,n,r){Ku(e,t,(function(e,t){var o=function(e,t,n,r,o){var i=xe.fromTag("div");return Ht(i,{position:"absolute",left:t+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),Dt(i,{"data-row":e,role:"presentation"}),i}(t.row,n.left-e.left,t.y-e.top,r,7);return Au(o,qu),o}))},Yu=function(e,t,n,r,o){var i=Qr(n),u=t.isResizable,a=r.length>0?fo.positions(r,n):[],c=a.length>0?function(e,t){return z(e.all,(function(e,n){return t(e.element)?[n]:[]}))}(e,u):[],f=L(a,(function(e,t){return D(c,(function(e){return t===e}))}));Gu(t,f,i,Lr(n));var l=o.length>0?go.positions(o,n):[],s=l.length>0?function(e,t){var n=[];return A(e.grid.columns,(function(r){En.getColumnAt(e,r).map((function(e){return e.element})).forall(t)&&n.push(r)})),L(n,(function(n){var r=En.filterItems(e,(function(e){return e.column===n}));return H(r,(function(e){return t(e.element)}))}))}(e,u):[],d=L(l,(function(e,t){return D(s,(function(e){return t===e}))}));Xu(t,d,i,$r(n))},Qu=function(e,t){if($u(e),e.isResizable(t)){var n=En.fromTable(t),r=Ur(n),o=Fr(n);Yu(n,e,t,r,o)}},Ju=function(e,t){var n=wt(e.parent(),"."+Vu);B(n,t)},Zu=function(e){Ju(e,(function(e){zt(e,"display","none")}))},ea=function(e){Ju(e,(function(e){zt(e,"display","block")}))},ta=zu("resizer-bar-dragging"),na=function(e){var t=Hu(),n=function(e,t){void 0===t&&(t={});var n=void 0!==t.mode?t.mode:Iu;return wu(e,n,t)}(t,{}),r=k.none(),o=function(e,t){return k.from(At(e,t))};t.events.drag.bind((function(e){o(e.target,"data-row").each((function(t){var n=Qt(e.target,"top");zt(e.target,"top",n+e.yDelta+"px")})),o(e.target,"data-column").each((function(t){var n=Qt(e.target,"left");zt(e.target,"left",n+e.xDelta+"px")}))}));var i=function(e,t){return Qt(e,t)-Kt(e,"data-initial-"+t,0)};n.events.stop.bind((function(){t.get().each((function(t){r.each((function(n){o(t,"data-row").each((function(e){var r=i(t,"top");Bt(t,"data-initial-top"),l.trigger.adjustHeight(n,r,parseInt(e,10))})),o(t,"data-column").each((function(e){var r=i(t,"left");Bt(t,"data-initial-left"),l.trigger.adjustWidth(n,r,parseInt(e,10))})),Qu(e,n)}))}))}));var u=function(r,o){l.trigger.startAdjust(),t.assign(r),_t(r,"data-initial-"+o,Qt(r,o)),Au(r,ta),zt(r,"opacity","0.2"),n.go(e.parent())},a=Nu(e.parent(),"mousedown",(function(e){var t;t=e.target,Ou(t,qu)&&u(e.target,"top"),function(e){return Ou(e,Wu)}(e.target)&&u(e.target,"left")})),c=function(t){return Ne(t,e.view())},f=Nu(e.view(),"mouseover",(function(t){var n;(n=t.target,Et(n,"table",c).filter(Fu)).fold((function(){ht(t.target)&&$u(e)}),(function(t){r=k.some(t),Qu(e,t)}))})),l=su({adjustHeight:lu(["table","delta","row"]),adjustWidth:lu(["table","delta","column"]),startAdjust:lu([])});return{destroy:function(){a.unbind(),f.unbind(),n.destroy(),$u(e)},refresh:function(t){Qu(e,t)},on:n.on,off:n.off,hideBars:h(Zu,e),showBars:h(ea,e),events:l.registry}},ra=function(e,t,n){var r=fo,o=go,i=na(e),u=su({beforeResize:lu(["table","type"]),afterResize:lu(["table","type"]),startDrag:lu([])});return i.events.adjustHeight.bind((function(e){var t=e.table;u.trigger.beforeResize(t,"row");var n=r.delta(e.delta,t);ji(t,n,e.row,r),u.trigger.afterResize(t,"row")})),i.events.startAdjust.bind((function(e){u.trigger.startDrag()})),i.events.adjustWidth.bind((function(e){var r=e.table;u.trigger.beforeResize(r,"col");var i=o.delta(e.delta,r),a=n(r);Fi(r,i,e.column,t,a),u.trigger.afterResize(r,"col")})),{on:i.on,off:i.off,hideBars:i.hideBars,showBars:i.showBars,destroy:i.destroy,events:u.registry}},oa=function(e,t){return e.fire("newrow",{node:t})},ia=function(e,t){return e.fire("newcell",{node:t})},ua=function(e,t,n){e.fire("TableModified",G(G({},n),{table:t}))},aa={structure:!1,style:!0},ca={structure:!0,style:!1},fa={structure:!0,style:!0},la={"border-collapse":"collapse",width:"100%"},sa=A(5,(function(e){var t=e+1+"px";return{title:t,value:t}})),da=O(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],(function(e){return{title:e,value:e.toLowerCase()}})),ma={border:"1"},ga=function(e){return e.getParam("table_sizing_mode","auto")},pa=function(e){return e.getParam("table_responsive_width")},ha=function(e){return e.getParam("table_border_widths",sa,"array")},va=function(e){return e.getParam("table_border_styles",da,"array")},ba=function(e){return e.getParam("table_default_attributes",ma,"object")},ya=function(e){return e.getParam("table_default_styles",function(e){var t;if(Ea(e)){var n=e.dom,r=null!==(t=n.getParent(e.selection.getStart(),n.isBlock))&&void 0!==t?t:e.getBody(),o=Ir(xe.fromDom(r));return G(G({},la),{width:o+"px"})}return Ra(e)?Le(la,(function(e,t){return"width"!==t})):la}(e),"object")},Ca=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},wa=function(e){return e.getParam("table_row_advtab",!0,"boolean")},xa=function(e){return e.getParam("table_advtab",!0,"boolean")},Sa=function(e){return e.getParam("table_style_by_css",!1,"boolean")},Ta=function(e){return e.getParam("table_cell_class_list",[],"array")},ka=function(e){return e.getParam("table_class_list",[],"array")},Na=function(e){return"relative"===ga(e)||!0===pa(e)},Ea=function(e){return"fixed"===ga(e)||!1===pa(e)},Ra=function(e){return"responsive"===ga(e)},_a=function(e){return e.getParam("table_use_colgroups",!1,"boolean")},Da=function(e){var t=e.getParam("table_header_type","section","string");return _(["section","cells","sectionCells","auto"],t)?t:"section"},Aa=function(e){var t=e.getParam("table_column_resizing","preservetable","string");return F(["preservetable","resizetable"],(function(e){return e===t})).getOr("preservetable")},Oa=function(e){return"preservetable"===Aa(e)},Ba=function(e){return"resizetable"===Aa(e)},Pa=function(e){var t=e.getParam("table_clone_elements");return r(t)?k.some(t.split(/[ ,]/)):Array.isArray(t)?k.some(t):k.none()},La=function(e){return e.getParam("table_background_color_map",[],"array")},Ia=function(e){return e.getParam("table_border_color_map",[],"array")},Ma=function(e,t){return Na(e)?Go(t):Ea(e)?Xo(t):Ko(t)},Fa=function(e){Bt(e,"width")},ja=function(e){var t=Bo(e);iu(e,k.some(t),k.none()),Fa(e)},Ua=function(e){var t=function(e){return Pr(e)+"px"}(e);iu(e,k.some(t),k.none()),Fa(e)},za=function(e){$t(e,"width");var t=on(e),n=t.length>0?t:rn(e);B(n,(function(e){$t(e,"width"),Fa(e)})),Fa(e)},Ha=function(){var e=xe.fromTag("div");return Ht(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),zn(vt(xe.fromDom(document)),e),e},Va=function(e){return"false"!==At(e,"data-mce-resize")},qa=function(e){var t,n,o=k.none(),i=k.none(),u=k.none(),a=function(e){return"TABLE"===e.nodeName},c=function(){return i},f=function(t){return Ma(e,t)},l=function(){return Oa(e)?$i():Wi()},s=function(r,o,i){var u=ie(o,"e");if(""===n&&ja(r),i!==t&&""!==n){zt(r,"width",n);var a=l(),c=f(r),s=Oa(e)||u?function(e){return fu(e).columns}(r)-1:0;Fi(r,i-t,s,a,c)}else if(function(e){return/^(\d+(\.\d+)?)%$/.test(e)}(n)){var d=parseFloat(n.replace("%",""));zt(r,"width",i*d/t+"%")}(function(e){return/^(\d+(\.\d+)?)px$/.test(e)})(n)&&function(e){var t=En.fromTable(e);En.hasColumns(t)||B(rn(e),(function(e){var t=Vt(e,"width");zt(e,"width",t),Bt(e,"width")}))}(r)};return e.on("init",(function(){var t=function(e,t){return e.inline?Xi(gi(e),Ha(),t):Ki(xe.fromDom(e.getDoc()),t)}(e,Va);if(u=k.some(t),function(e){var t=e.getParam("object_resizing",!0);return r(t)?"table"===t:t}(e)&&function(e){return e.getParam("table_resize_bars",!0,"boolean")}(e)){var n=l(),a=ra(t,n,f);a.on(),a.events.startDrag.bind((function(t){o=k.some(e.selection.getRng())})),a.events.beforeResize.bind((function(t){var n=t.table.dom;!function(e,t,n,r,o){e.fire("ObjectResizeStart",{target:t,width:n,height:r,origin:o})}(e,n,pi(n),hi(n),"bar-"+t.type)})),a.events.afterResize.bind((function(t){var n=t.table,r=n.dom;yi(n),o.each((function(t){e.selection.setRng(t),e.focus()})),function(e,t,n,r,o){e.fire("ObjectResized",{target:t,width:n,height:r,origin:o})}(e,r,pi(r),hi(r),"bar-"+t.type),e.undoManager.add()})),i=k.some(a)}})),e.on("ObjectResizeStart",(function(r){var o=r.target;if(a(o)){var i=xe.fromDom(o);B(e.dom.select(".mce-clonedresizable"),(function(t){e.dom.addClass(t,"mce-"+Aa(e)+"-columns")})),!au(i)&&Ea(e)?Ua(i):!uu(i)&&Na(e)&&ja(i),cu(i)&&oe(r.origin,"bar-")&&ja(i),t=r.width,n=Ra(e)?"":function(e,t){var n=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return k.from(n).filter(ae)}(e,o).getOr("")}})),e.on("ObjectResized",(function(t){var n=t.target;if(a(n)){var r=xe.fromDom(n),o=t.origin;oe(o,"corner-")&&s(r,o,t.width),yi(r),ua(e,r.dom,aa)}})),e.on("SwitchMode",(function(){c().each((function(t){e.mode.isReadOnly()?t.hideBars():t.showBars()}))})),{lazyResize:c,lazyWire:function(){return u.getOr(Ki(xe.fromDom(e.getBody()),Va))},destroy:function(){i.each((function(e){e.destroy()})),u.each((function(t){!function(e,t){e.inline&&$n(t.parent())}(e,t)}))}}},Wa=function(e,t){return{element:e,offset:t}},$a=function(e,t,n){return e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?n(t).bind((function(t){return $a(e,t,n).orThunk((function(){return k.some(t)}))})):k.none()},Ka=function(e,t){return e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length},Xa=function(e,t){var n=$a(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(n))return Wa(n,Ka(e,n));var r=e.property().children(n);return r.length>0?Xa(e,r[r.length-1]):Wa(n,Ka(e,n))},Ga=Xa,Ya=Zn(),Qa=function(e,t){1===Xt(e,"colspan")&&function(e){return Ro(e).bind((function(e){return vo(e,["fixed","relative","empty"])}))}(e).each((function(n){var r=n.value/2;Oo(e,r,n.unit),Oo(t,r,n.unit)}))},Ja=tt("th"),Za=function(e){return H(e,(function(e){return Ja(e.element)}))},ec=function(e,t){return e&&t?"sectionCells":e?"section":"cells"},tc=function(e){var t="thead"===e.section,n=Lt(nc(e.cells),"th");return t||n?{type:"header",subType:ec(t,n)}:"tfoot"===e.section?{type:"footer"}:{type:"body"}},nc=function(e){var t=L(e,(function(e){return Ja(e.element)}));return 0===t.length?k.some("td"):t.length===e.length?k.some("th"):k.none()},rc=function(e,t,n){return We(n(e.element,t),!0,e.isLocked)},oc=function(e,t){return e.section!==t?$e(e.element,e.cells,t,e.isNew):e},ic=function(){return{transformRow:oc,transformCell:function(e,t,n){var r=n(e.element,t),o="td"!==Ke(r)?function(e,t){var n=kr(e,t);Fn(e,n);var r=ct(e);return qn(n,r),$n(e),n}(r,"td"):r;return We(o,e.isNew,e.isLocked)}}},uc=function(){return{transformRow:oc,transformCell:rc}},ac=function(){return{transformRow:function(e,t){return oc(e,"thead"===t?"tbody":t)},transformCell:rc}},cc=function(e,t){switch(function(e){return X(e.all,(function(e){var t=tc(e);return"header"===t.type?k.from(t.subType):k.none()}))}(En.fromTable(e)).getOr(t)){case"section":return ic();case"sectionCells":return uc();case"cells":return ac()}},fc=ic,lc=uc,sc=ac,dc=function(){return{transformRow:g,transformCell:rc}},mc=function(e,t,n,r){n===r?Bt(e,t):_t(e,t,n)},gc=function(e,t,n){K(Ct(e,t)).fold((function(){return Un(e,n)}),(function(e){return jn(e,n)}))},pc=function(e,t){var n=[],r=[],o=function(e){return O(e,(function(e){e.isNew&&n.push(e.element);var t=e.element;return Wn(t),B(e.cells,(function(e){e.isNew&&r.push(e.element),mc(e.element,"colspan",e.colspan,1),mc(e.element,"rowspan",e.rowspan,1),zn(t,e.element)})),t}))},i=function(e){return z(e,(function(e){return O(e.cells,(function(e){return mc(e.element,"span",e.colspan,1),e.element}))}))},u=function(t,n){var r=function(e,t){var n=kt(e,t).getOrThunk((function(){var n=xe.fromTag(t,nt(e).dom);return"thead"===t?gc(e,"caption,colgroup",n):"colgroup"===t?gc(e,"caption",n):zn(e,n),n}));return Wn(n),n}(e,n),u=("colgroup"===n?i:o)(t);qn(r,u)},a=function(t,n){t.length>0?u(t,n):function(t){kt(e,t).each($n)}(n)},c=[],f=[],l=[],s=[];return B(t,(function(e){switch(e.section){case"thead":c.push(e);break;case"tbody":f.push(e);break;case"tfoot":l.push(e);break;case"colgroup":s.push(e)}})),a(s,"colgroup"),a(c,"thead"),a(f,"tbody"),a(l,"tfoot"),{newRows:n,newCells:r}},hc=function(e,t){if(0===e.length)return 0;var n=e[0];return j(e,(function(e){return!t(n.element,e.element)})).getOr(e.length)},vc=function(e,t,n,r){var o=function(e,t){return e[t]}(e,t),i="colgroup"===o.section;return{colspan:hc(o.cells.slice(n),r),rowspan:i?1:hc(function(e,t){return O(e,(function(e){return hn(e,t)}))}(e.slice(t),n),r)}},bc=function(e,t){var n=O(e,(function(e){return O(e.cells,C)}));return O(e,(function(r,o){var i=z(r.cells,(function(r,i){if(!1===n[o][i]){var u=vc(e,o,i,t);return function(e,t,r,o){for(var i=e;i<e+r;i++)for(var u=t;u<t+o;u++)n[i][u]=!0}(o,i,u.rowspan,u.colspan),[(a=r.element,c=u.rowspan,f=u.colspan,l=r.isNew,{element:a,rowspan:c,colspan:f,isNew:l})]}return[];var a,c,f,l}));return function(e,t,n,r){return{element:e,cells:t,section:n,isNew:r}}(r.element,i,r.section,r.isNew)}))},yc=function(e,t,n){var r=[];B(e.colgroups,(function(o){for(var i=[],u=0;u<e.grid.columns;u++){var a=En.getColumnAt(e,u).map((function(e){return We(e.element,n,!1)})).getOrThunk((function(){return We(t.colGap(),!0,!1)}));i.push(a)}r.push($e(o.element,i,"colgroup",n))}));for(var o=0;o<e.grid.rows;o++){for(var i=[],u=0;u<e.grid.columns;u++){var a=En.getAt(e,o,u).map((function(e){return We(e.element,n,e.isLocked)})).getOrThunk((function(){return We(t.gap(),!0,!1)}));i.push(a)}var c=e.all[o],f=$e(c.element,i,c.section,n);r.push(f)}return r},Cc=function(e){return bc(e,Ne)},wc=function(e,t){return X(e.all,(function(e){return F(e.cells,(function(e){return Ne(t,e.element)}))}))},xc=function(e,t,n){var r=O(t.selection,(function(t){return nn(t).bind((function(t){return wc(e,t)})).filter(n)})),o=It(r);return Ft(o.length>0,o)},Sc=function(e,t,n,r,o){return function(i,u,a,c,f){var l=En.fromTable(u),s=k.from(null==f?void 0:f.section).getOrThunk(dc);return t(l,a).map((function(t){var n=function(e,t){return yc(e,t,!1)}(l,c),r=e(n,t,Ne,o(c),s),i=Sn(r.grid);return{info:t,grid:Cc(r.grid),cursor:r.cursor,lockedColumns:i}})).bind((function(e){var t=pc(u,e.grid),o=k.from(null==f?void 0:f.sizing).getOrThunk((function(){return Ko(u)})),a=k.from(null==f?void 0:f.resize).getOrThunk($i);return n(u,e.grid,e.info,{sizing:o,resize:a,section:s}),r(u),Qu(i,u),Bt(u,wn),e.lockedColumns.length>0&&_t(u,wn,e.lockedColumns.join(",")),k.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})}))}},Tc=function(e,t){return xc(e,t,w).map((function(e){return{cells:e,generators:t.generators,clipboard:t.clipboard}}))},kc=function(e,t){return xc(e,t,w)},Nc=function(e,t){return xc(e,t,(function(e){return!e.isLocked}))},Ec=function(e,t){return H(t,(function(t){return function(e,t){return wc(e,t).exists((function(e){return!e.isLocked}))}(e,t)}))},Rc=function(e,t){return function(e,t){return t.mergable}(0,t).filter((function(t){return Ec(e,t.cells)}))},_c=function(e,t){return function(e,t){return t.unmergable}(0,t).filter((function(t){return Ec(e,t)}))},Dc=function(e,t,n,r){for(var o=yn(e).rows,i=!0,u=0;u<o.length;u++)for(var a=0;a<bn(o[0]);a++){var c=o[u],f=hn(c,a),l=n(f.element,t);!0===l&&!1===i?gn(c,a,We(r(),!0,f.isLocked)):!0===l&&(i=!1)}return e},Ac=function(e,t,n,r){var o=yn(e).rows;if(t>0&&t<o.length){var i=function(e,t){return M(e,(function(e,n){return D(e,(function(e){return t(e.element,n.element)}))?e:e.concat([n])}),[])}(o[t-1].cells,n);B(i,(function(e){for(var i=k.none(),u=t;u<o.length;u++)for(var a=function(t){var a=o[u],c=hn(a,t);n(c.element,e.element)&&(i.isNone()&&(i=k.some(r())),i.each((function(e){gn(a,t,We(e,!0,c.isLocked))})))},c=0;c<bn(o[0]);c++)a(c)}))}return e},Oc=function(e){return{isValue:w,isError:C,getOr:m(e),getOrThunk:m(e),getOrDie:m(e),or:function(t){return Oc(e)},orThunk:function(t){return Oc(e)},fold:function(t,n){return n(e)},map:function(t){return Oc(t(e))},mapError:function(t){return Oc(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return k.some(e)}}},Bc=function(e){return{isValue:C,isError:w,getOr:g,getOrThunk:function(e){return e()},getOrDie:function(){return(t=String(e),function(){throw new Error(t)})();var t},or:g,orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return Bc(e)},mapError:function(t){return Bc(t(e))},each:d,bind:function(t){return Bc(e)},exists:C,forall:w,toOptional:k.none}},Pc={value:Oc,error:Bc,fromOption:function(e,t){return e.fold((function(){return Bc(t)}),Oc)}},Lc=function(e,t){return{rowDelta:0,colDelta:bn(e[0])-bn(t[0])}},Ic=function(e,t){return{rowDelta:e.length-t.length,colDelta:0}},Mc=function(e,t,n,r){var o="colgroup"===t.section?n.col:n.cell;return A(e,(function(e){return We(o(),!0,r(e))}))},Fc=function(e,t,n,r){var o=e[e.length-1];return e.concat(A(t,(function(){var e="colgroup"===o.section?n.colgroup:n.row,t=Cn(o,e,g),i=Mc(t.cells.length,t,n,(function(e){return Ue(r,e.toString())}));return pn(t,i)})))},jc=function(e,t,n,r){return O(e,(function(e){var o=Mc(t,e,n,C);return dn(e,r,o)}))},Uc=function(e,t,n){var r=t.colDelta<0?jc:g,o=t.rowDelta<0?Fc:g,i=Sn(e),u=bn(e[0]),a=D(i,(function(e){return e===u-1})),c=r(e,Math.abs(t.colDelta),n,a?u-1:u),f=Sn(c);return o(c,Math.abs(t.rowDelta),n,V(f,w))},zc=function(e,t,n,r){var o=h(r,hn(e[t],n).element),i=e[t];return e.length>1&&bn(i)>1&&(n>0&&o(vn(i,n-1))||n<i.cells.length-1&&o(vn(i,n+1))||t>0&&o(vn(e[t-1],n))||t<e.length-1&&o(vn(e[t+1],n)))},Hc=function(e,t,n){return L(n,(function(n){return n>=e.column&&n<=bn(t[0])+e.column}))},Vc=function(e,t,n,r,o){var i=Sn(t),u=function(e,t,n){var r=bn(t[0]),o=yn(t).cols.length+e.row,i=A(r-e.column,(function(t){return t+e.column}));return{row:o,column:F(i,(function(e){return H(n,(function(t){return t!==e}))})).getOr(r-1)}}(e,t,i),a=yn(n).rows,c=Hc(u,a,i);return function(e,t,n){if(e.row>=t.length||e.column>bn(t[0]))return Pc.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);var r=t.slice(e.row),o=r[0].cells.slice(e.column),i=bn(n[0]),u=n.length;return Pc.value({rowDelta:r.length-u,colDelta:o.length-i})}(u,t,a).map((function(e){var n=G(G({},e),{colDelta:e.colDelta-c.length}),i=Uc(t,n,r),f=Sn(i),l=Hc(u,a,f);return function(e,t,n,r,o,i){for(var u=e.row,a=e.column,c=u+n.length,f=a+bn(n[0])+i.length,l=V(i,w),s=u;s<c;s++)for(var d=0,m=a;m<f;m++)if(l[m])d++;else{zc(t,s,m,o)&&Dc(t,vn(t[s],m),o,r.cell);var g=m-a-d,p=hn(n[s-u],g),h=p.element,v=r.replace(h);gn(t[s],m,We(v,!0,p.isLocked))}return t}(u,i,a,r,o,l)}))},qc=function(e,t,n,r,o){!function(e,t,n,r){t>0&&t<e[0].cells.length&&B(e,(function(e){var o=e.cells[t-1],i=e.cells[t];n(i.element,o.element)&&gn(e,t,We(r(),!0,i.isLocked))}))}(t,e,o,r.cell);var i=Ic(n,t),u=Uc(n,i,r),a=Ic(t,u),c=Uc(t,a,r);return O(c,(function(t,n){return dn(t,e,u[n].cells)}))},Wc=function(e,t,n,r,o){Ac(t,e,o,r.cell);var i=Sn(t),u=Lc(t,n),a=G(G({},u),{colDelta:u.colDelta-i.length}),c=Uc(t,a,r),f=yn(c),l=f.cols,s=f.rows,d=Sn(c),m=Lc(n,t),g=G(G({},m),{colDelta:m.colDelta+d.length}),p=function(e,t,n){return O(e,(function(e){return M(n,(function(n,r){var o=Mc(1,e,t,w)[0];return mn(n,r,o)}),e)}))}(n,r,d),h=Uc(p,g,r);return l.concat(s.slice(0,e)).concat(h).concat(s.slice(e,s.length))},$c=function(e,t,n,r,o){var i=yn(e),u=i.rows,a=i.cols,c=u.slice(0,t),f=u.slice(t),l=function(e,t,n,r){return Cn(e,(function(e){return r(e,n)}),t)}(u[n],(function(e,n){return t>0&&t<u.length&&r(vn(u[t-1],n),vn(u[t],n))?hn(u[t],n):We(o(e.element,r),!0,e.isLocked)}),r,o);return a.concat(c).concat([l]).concat(f)},Kc=function(e,t,n,r,o){return O(e,(function(e){var i=t>0&&t<bn(e)&&r(vn(e,t-1),vn(e,t)),u=function(e,t,n,r,o,i,u){if("colgroup"!==n&&r)return hn(e,t);var a=hn(e,o);return We(u(a.element,i),!0,!1)}(e,t,e.section,i,n,r,o);return mn(e,t,u)}))},Xc=function(e,t,n,r){return function(e,t,n,r){return void 0!==vn(e[t],n)&&t>0&&r(vn(e[t-1],n),vn(e[t],n))}(e,t,n,r)||function(e,t,n){return t>0&&n(vn(e,t-1),vn(e,t))}(e[t],n,r)},Gc=function(e,t,n,r){var o=function(e){return function(e){return"row"===e?Yt(t):Gt(t)}(e)?e+"group":e};return e?Ja(t)?o(n):null:r&&Ja(t)?o("row"===n?"col":"row"):null},Yc=function(e,t,n){return We(n(e.element,t),!0,e.isLocked)},Qc=function(e,t,n,r,o,i,u){return O(e,(function(e,a){return function(e,t){var n=e.cells,r=O(n,t);return $e(e.element,r,e.section,e.isNew)}(e,(function(e,c){if(function(e){return D(t,(function(t){return n(e.element,t.element)}))}(e)){var f=u(e,a,c)?o(e,n,r):e;return i(f,a,c).each((function(e){var t,n;t=f.element,n={scope:k.from(e)},Oe(n,(function(e,n){e.fold((function(){Bt(t,n)}),(function(e){Rt(t.dom,n,e)}))}))})),f}return e}))}))},Jc=function(e,t,n){return z(e,(function(r,o){return Xc(e,o,t,n)?[]:[hn(r,t)]}))},Zc=function(e,t,n,r,o){var i=yn(e).rows,u=z(t,(function(e){return Jc(i,e,r)})),a=O(e,(function(e){return Za(e.cells)})),c=function(e,t){return H(t,g)&&Za(e)?w:function(e,n,r){return!("th"===Ke(e.element)&&t[n])}}(u,a),f=function(e,t){return function(n,r){return k.some(Gc(e,n.element,"row",t[r]))}}(n,a);return Qc(e,u,r,o,Yc,f,c)},ef=function(e,t,n,r,o,i,u){var a=yn(e),c=a.cols,f=a.rows,l=f[t[0]],s=z(t,(function(e){return function(e,t,n){var r=e[t];return z(r.cells,(function(r,o){return Xc(e,t,o,n)?[]:[r]}))}(f,e,o)})),d=O(l.cells,(function(e,t){return Za(Jc(f,t,o))})),m=Y([],f,!0);B(t,(function(e){m[e]=u.transformRow(f[e],n)}));var p=c.concat(m),h=function(e,t){return H(t,g)&&Za(e.cells)?w:function(e,n,r){return!("th"===Ke(e.element)&&t[r])}}(l,d),v=function(e,t){return function(n,r,o){return k.some(Gc(e,n.element,"col",t[o]))}}(r,d);return Qc(p,s,o,i,u.transformCell,v,h)},tf=function(e,t,n,r){var o=yn(e).rows,i=O(t,(function(e){return hn(o[e.row],e.column)}));return Qc(e,i,n,r,Yc,k.none,w)},nf=function(e){return M(e,(function(e,t){return D(e,(function(e){return e.column===t.column}))?e:e.concat([t])}),[]).sort((function(e,t){return e.column-t.column}))},rf=tt("col"),of=tt("colgroup"),uf=function(e){return"tr"===Ke(e)||of(e)},af=function(e){return{element:e,colspan:Kt(e,"colspan",1),rowspan:Kt(e,"rowspan",1)}},cf=function(e){return Ot(e,"scope").map((function(e){return e.substr(0,3)}))},ff=function(e,t){void 0===t&&(t=af);var n=function(n){if(uf(n))return of((o={element:n}).element)?e.colgroup(o):e.row(o);var o,i=function(t){return rf(t.element)?e.col(t):e.cell(t)}(t(n));return r=k.some({item:n,replacement:i}),i},r=k.none();return{getOrInit:function(e,t){return r.fold((function(){return n(e)}),(function(r){return t(e,r.item)?r.replacement:n(e)}))}}},lf=function(e){return function(t){var n=[],r=function(r){var o="td"===e?{scope:null}:{},i=t.replace(r,e,o);return n.push({item:r,sub:i}),i};return{replaceOrInit:function(e,t){return uf(e)||rf(e)?e:function(e,t){return F(n,(function(n){return t(n.item,e)}))}(e,t).fold((function(){return r(e)}),(function(n){return t(e,n.item)?n.sub:r(e)}))}}}},sf=function(e){return{unmerge:function(t){var n=cf(t);return n.each((function(e){return _t(t,"scope",e)})),function(){var r=e.cell({element:t,colspan:1,rowspan:1});return $t(r,"width"),$t(t,"width"),n.each((function(e){return _t(r,"scope",e)})),r}},merge:function(e){return $t(e[0],"width"),function(){var t=It(O(e,cf));if(0===t.length)return k.none();var n=t[0],r=["row","col"];return D(t,(function(e){return e!==n&&_(r,e)}))?k.none():k.from(n)}().fold((function(){return Bt(e[0],"scope")}),(function(t){return _t(e[0],"scope",t+"group")})),m(e[0])}}},df=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],mf=Zn(),gf=function(e){return function(e,t){var n=e.property().name(t);return _(df,n)}(mf,e)},pf=function(e){return function(e,t){var n=e.property().name(t);return _(["ol","ul"],n)}(mf,e)},hf=function(e){return function(e,t){return _(["br","img","hr","input"],e.property().name(t))}(mf,e)},vf=function(e){var t,n=function(e){return"br"===Ke(e)},r=function(e){return ni(e).bind((function(t){var r=at(t).map((function(e){return!!gf(e)||!!hf(e)&&"img"!==Ke(e)})).getOr(!1);return ot(t).map((function(o){return!0===r||function(e){return"li"===Ke(e)||St(e,pf).isSome()}(o)||n(t)||gf(o)&&!Ne(e,o)?[]:[xe.fromTag("br")]}))})).getOr([])},o=0===(t=z(e,(function(e){var t=ct(e);return function(e){return H(e,(function(e){return n(e)||Je(e)&&0===Gn(e).trim().length}))}(t)?[]:t.concat(r(e))}))).length?[xe.fromTag("br")]:t;Wn(e[0]),qn(e[0],o)},bf=function(e){return Fu(e,!0)},yf=function(e){0===rn(e).length&&$n(e)},Cf=function(e,t){return{grid:e,cursor:t}},wf=function(e,t,n){var r,o,i=yn(e).rows;return k.from(null===(o=null===(r=i[t])||void 0===r?void 0:r.cells[n])||void 0===o?void 0:o.element).filter(bf).orThunk((function(){return function(e){return X(e,(function(e){return X(e.cells,(function(e){var t=e.element;return Ft(bf(t),t)}))}))}(i)}))},xf=function(e,t,n){var r=wf(e,t,n);return Cf(e,r)},Sf=function(e){return M(e,(function(e,t){return D(e,(function(e){return e.row===t.row}))?e:e.concat([t])}),[]).sort((function(e,t){return e.row-t.row}))},Tf=function(e,t){return function(n,r,o,i,u){var a=Sf(r),c=O(a,(function(e){return e.row})),f=ef(n,c,e,t,o,i.replaceOrInit,u);return xf(f,r[0].row,r[0].column)}},kf=Tf("thead",!0),Nf=Tf("tbody",!1),Ef=Tf("tfoot",!1),Rf=function(e,t,n){var r=function(e,t){return fn(e,(function(){return t}))}(e,n.section),o=En.generate(r);return yc(o,t,!0)},_f=function(e,t,n,r){return function(e,t,n,r){var o=En.generate(t),i=r.getWidths(o,r);Mi(o,i,r)}(0,t,0,r.sizing)},Df=function(e,t,n,r){return function(e,t,n,r,o){var i=En.generate(t),u=r.getWidths(i,r),a=r.pixelWidth(),c=o.calcRedestributedWidths(u,a,n.pixelDelta,r.isRelative),f=c.newSizes,l=c.delta;Mi(i,f,r),r.adjustTableWidth(l)}(0,t,n,r.sizing,r.resize)},Af=function(e,t){return D(t,(function(e){return 0===e.column&&e.isLocked}))},Of=function(e,t){return D(t,(function(t){return t.column+t.colspan>=e.grid.columns&&t.isLocked}))},Bf=function(e,t){var n=Fr(e),r=nf(t);return M(r,(function(e,t){return e+n[t.column].map(Lr).getOr(0)}),0)},Pf=function(e){return function(t,n){return kc(t,n).filter((function(n){return!(e?Af:Of)(t,n)})).map((function(e){return{details:e,pixelDelta:Bf(t,e)}}))}},Lf=function(e){return function(t,n){return Tc(t,n).filter((function(n){return!(e?Af:Of)(t,n.cells)}))}},If=lf("th"),Mf=lf("td"),Ff=Sc((function(e,t,n,r){var o=t[0].row,i=Sf(t),u=I(i,(function(e,t){return{grid:$c(e.grid,o,t.row+e.delta,n,r.getOrInit),delta:e.delta+1}}),{grid:e,delta:0}).grid;return xf(u,o,t[0].column)}),kc,d,d,ff),jf=Sc((function(e,t,n,r){var o=Sf(t),i=o[o.length-1],u=i.row+i.rowspan,a=I(o,(function(e,t){return $c(e,u,t.row,n,r.getOrInit)}),e);return xf(a,u,t[0].column)}),kc,d,d,ff),Uf=Sc((function(e,t,n,r){var o=t.details,i=nf(o),u=i[0].column,a=I(i,(function(e,t){return{grid:Kc(e.grid,u,t.column+e.delta,n,r.getOrInit),delta:e.delta+1}}),{grid:e,delta:0}).grid;return xf(a,o[0].row,u)}),Pf(!0),Df,d,ff),zf=Sc((function(e,t,n,r){var o=t.details,i=o[o.length-1],u=i.column+i.colspan,a=nf(o),c=I(a,(function(e,t){return Kc(e,u,t.column,n,r.getOrInit)}),e);return xf(c,o[0].row,u)}),Pf(!1),Df,d,ff),Hf=Sc((function(e,t,n,r){var o=nf(t.details),i=function(e,t){return z(e,(function(e){var n=e.cells,r=I(t,(function(e,t){return t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e}),n);return r.length>0?[$e(e.element,r,e.section,e.isNew)]:[]}))}(e,O(o,(function(e){return e.column}))),u=i.length>0?i[0].cells.length-1:0;return xf(i,o[0].row,Math.min(o[0].column,u))}),(function(e,t){return Nc(e,t).map((function(t){return{details:t,pixelDelta:-Bf(e,t)}}))}),Df,yf,ff),Vf=Sc((function(e,t,n,r){var o=Sf(t),i=function(e,t,n){var r=yn(e),o=r.rows;return r.cols.concat(o.slice(0,t)).concat(o.slice(n+1))}(e,o[0].row,o[o.length-1].row),u=i.length>0?i.length-1:0;return xf(i,Math.min(t[0].row,u),t[0].column)}),kc,d,yf,ff),qf=Sc((function(e,t,n,r){var o=nf(t),i=O(o,(function(e){return e.column})),u=Zc(e,i,!0,n,r.replaceOrInit);return xf(u,t[0].row,t[0].column)}),Nc,d,d,If),Wf=Sc((function(e,t,n,r){var o=nf(t),i=O(o,(function(e){return e.column})),u=Zc(e,i,!1,n,r.replaceOrInit);return xf(u,t[0].row,t[0].column)}),Nc,d,d,Mf),$f=Sc(kf,Nc,d,d,If),Kf=Sc(Nf,Nc,d,d,Mf),Xf=Sc(Ef,Nc,d,d,Mf),Gf=Sc((function(e,t,n,r){var o=tf(e,t,n,r.replaceOrInit);return xf(o,t[0].row,t[0].column)}),Nc,d,d,If),Yf=Sc((function(e,t,n,r){var o=tf(e,t,n,r.replaceOrInit);return xf(o,t[0].row,t[0].column)}),Nc,d,d,Mf),Qf=Sc((function(e,t,n,r){var o=t.cells;vf(o);var i=function(e,t,n,r){var o=yn(e).rows;if(0===o.length)return e;for(var i=t.startRow;i<=t.finishRow;i++)for(var u=t.startCol;u<=t.finishCol;u++){var a=o[i],c=hn(a,u).isLocked;gn(a,u,We(r(),!1,c))}return e}(e,t.bounds,0,r.merge(o));return Cf(i,k.from(o[0]))}),Rc,_f,d,sf),Jf=Sc((function(e,t,n,r){var o=I(t,(function(e,t){return Dc(e,t,n,r.unmerge(t))}),e);return Cf(o,k.from(t[0]))}),_c,_f,d,sf),Zf=Sc((function(e,t,n,r){var o=function(e,t){var n=En.fromTable(e);return yc(n,t,!0)}(t.clipboard,t.generators),i=function(e,t){return{row:e,column:t}}(t.row,t.column);return Vc(i,e,o,t.generators,n).fold((function(){return Cf(e,k.some(t.element))}),(function(e){return xf(e,t.row,t.column)}))}),(function(e,t){return nn(t.element).bind((function(n){return wc(e,n).map((function(e){return G(G({},e),{generators:t.generators,clipboard:t.clipboard})}))}))}),_f,d,ff),el=Sc((function(e,t,n,r){var o=yn(e).rows,i=t.cells[0].column,u=o[t.cells[0].row],a=Rf(t.clipboard,t.generators,u),c=qc(i,e,a,t.generators,n);return xf(c,t.cells[0].row,t.cells[0].column)}),Lf(!0),d,d,ff),tl=Sc((function(e,t,n,r){var o=yn(e).rows,i=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,u=o[t.cells[0].row],a=Rf(t.clipboard,t.generators,u),c=qc(i,e,a,t.generators,n);return xf(c,t.cells[0].row,t.cells[0].column)}),Lf(!1),d,d,ff),nl=Sc((function(e,t,n,r){var o=yn(e).rows,i=t.cells[0].row,u=o[i],a=Rf(t.clipboard,t.generators,u),c=Wc(i,e,a,t.generators,n);return xf(c,t.cells[0].row,t.cells[0].column)}),Tc,d,d,ff),rl=Sc((function(e,t,n,r){var o=yn(e).rows,i=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,u=o[t.cells[0].row],a=Rf(t.clipboard,t.generators,u),c=Wc(i,e,a,t.generators,n);return xf(c,t.cells[0].row,t.cells[0].column)}),Tc,d,d,ff),ol=function(e,t){var n=En.fromTable(e);return kc(n,t).bind((function(e){var t=e[e.length-1],r=e[0].column,o=t.column+t.colspan,i=U(O(n.all,(function(e){return L(e.cells,(function(e){return e.column>=r&&e.column<o}))})));return nc(i)})).getOr("")},il=function(e,t){var n=En.fromTable(e);return kc(n,t).bind(nc).getOr("")},ul=function(e,t){var n=En.fromTable(e);return kc(n,t).bind((function(e){var t=e[e.length-1],r=e[0].row,o=t.row+t.rowspan;return function(e){var t=O(e,(function(e){return tc(e).type})),n=_(t,"header"),r=_(t,"footer");if(n||r){var o=_(t,"body");return!n||o||r?n||o||!r?k.none():k.some("footer"):k.some("header")}return k.some("body")}(n.all.slice(r,o))})).getOr("")},al=function(e,t,n){var r=function(e){return"table"===Ke(gi(e))},o=Pa(e),i=Ba(e)?d:Qa,u=function(t){switch(Da(e)){case"section":return fc();case"sectionCells":return lc();case"cells":return sc();default:return cc(t,"section")}},a=function(n,r){return r.cursor.fold((function(){var r=rn(n);return $(r).filter(ht).map((function(r){t.clear(n);var o=e.dom.createRng();return o.selectNode(r.dom),e.selection.setRng(o),_t(r,"data-mce-selected","1"),o}))}),(function(r){var o=Ga(Ya,r),i=e.dom.createRng();return i.setStart(o.element.dom,o.offset),i.setEnd(o.element.dom,o.offset),e.selection.setRng(i),t.clear(n),k.some(i)}))},c=function(t,n,r,i,c){return function(f,l,s){void 0===s&&(s=!1),yi(f);var d=i(),m=xe.fromDom(e.getDoc()),g=si(r,m,o),p={sizing:Ma(e,f),resize:Ba(e)?Wi():$i(),section:u(f)};return n(f)?t(d,f,l,g,p).bind((function(t){B(t.newRows,(function(t){oa(e,t.dom)})),B(t.newCells,(function(t){ia(e,t.dom)}));var n=a(f,t);return ht(f)&&(yi(f),s||ua(e,f.dom,c)),n.map((function(e){return{rng:e,effect:c}}))})):k.none()}};return{deleteRow:c(Vf,(function(t){return!1===r(e)||fu(t).rows>1}),d,n,ca),deleteColumn:c(Hf,(function(t){return!1===r(e)||fu(t).columns>1}),d,n,ca),insertRowsBefore:c(Ff,w,d,n,ca),insertRowsAfter:c(jf,w,d,n,ca),insertColumnsBefore:c(Uf,w,i,n,ca),insertColumnsAfter:c(zf,w,i,n,ca),mergeCells:c(Qf,w,d,n,ca),unmergeCells:c(Jf,w,d,n,ca),pasteColsBefore:c(el,w,d,n,ca),pasteColsAfter:c(tl,w,d,n,ca),pasteRowsBefore:c(nl,w,d,n,ca),pasteRowsAfter:c(rl,w,d,n,ca),pasteCells:c(Zf,w,d,n,fa),makeCellsHeader:c(Gf,w,d,n,ca),unmakeCellsHeader:c(Yf,w,d,n,ca),makeColumnsHeader:c(qf,w,d,n,ca),unmakeColumnsHeader:c(Wf,w,d,n,ca),makeRowsHeader:c($f,w,d,n,ca),makeRowsBody:c(Kf,w,d,n,ca),makeRowsFooter:c(Xf,w,d,n,ca),getTableRowType:ul,getTableCellType:il,getTableColType:ol}},cl={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},fl=function(e){var t=xe.fromTag("colgroup");return A(e,(function(){return zn(t,xe.fromTag("col"))})),t},ll=function(e,t,n,r){return A(e,(function(e){return function(e,t,n,r){for(var o=xe.fromTag("tr"),i=0;i<e;i++){var u=r<t||i<n?xe.fromTag("th"):xe.fromTag("td");i<n&&_t(u,"scope","row"),r<t&&_t(u,"scope","col"),zn(u,xe.fromTag("br")),zn(o,u)}return o}(t,n,r,e)}))},sl=function(e,t){e.selection.select(t.dom,!0),e.selection.collapse(!0)},dl=function(e,t,n,o,i){var u=ya(e),a={styles:u,attributes:ba(e),colGroups:_a(e)};return e.undoManager.ignore((function(){var r=function(e,t,n,r,o,i){void 0===i&&(i=cl);var u=xe.fromTag("table"),a="cells"!==o;Ht(u,i.styles),Dt(u,i.attributes),i.colGroups&&zn(u,fl(t));var c=Math.min(e,n);if(a&&n>0){var f=xe.fromTag("thead");zn(u,f);var l=ll(n,t,"sectionCells"===o?c:0,r);qn(f,l)}var s=xe.fromTag("tbody");zn(u,s);var d=ll(a?e-c:e,t,a?0:n,r);return qn(s,d),u}(n,t,i,o,Da(e),a);_t(r,"data-mce-id","__mce");var u=function(e){var t=xe.fromTag("div"),n=xe.fromDom(e.dom.cloneNode(!0));return zn(t,n),function(e){return e.dom.innerHTML}(t)}(r);e.insertContent(u),e.addVisual()})),Nt(gi(e),'table[data-mce-id="__mce"]').map((function(t){return Ea(e)?Ua(t):Ra(e)?za(t):(Na(e)||function(e){return r(e)&&-1!==e.indexOf("%")}(u.width))&&ja(t),yi(t),Bt(t,"data-mce-id"),function(e,t){B(wt(t,"tr"),(function(t){oa(e,t.dom),B(wt(t,"th,td"),(function(t){ia(e,t.dom)}))}))}(e,t),function(e,t){Nt(t,"td,th").each(h(sl,e))}(e,t),t.dom})).getOr(null)},ml=function(e,t,n,r,o){void 0===r&&(r={});var i=function(e){return s(e)&&e>0};if(i(t)&&i(n)){var u=r.headerRows||0,a=r.headerColumns||0;return dl(e,n,t,a,u)}return console.error(o),null},gl=function(e){return function(){return e().fold((function(){return[]}),(function(e){return O(e,(function(e){return e.dom}))}))}},pl=function(e){return function(t){var n=t.length>0?k.some(mi(t)):k.none();e(n)}},hl=function(e){return function(t,n,r){void 0===r&&(r={});var o=ml(e,n,t,r,"Invalid values for insertTable - rows and columns values are required to insert a table.");return e.undoManager.add(),o}},vl=function(e,t,n){var r=Kt(e,t,1);1===n||r<=1?Bt(e,t):_t(e,t,Math.min(n,r))},bl=function(e,t){var n=En.fromTable(e);return Nc(n,t).map((function(e){var t=e[e.length-1],r=e[0].column,o=t.column+t.colspan,i=function(e,t,n){if(En.hasColumns(e)){var r=L(En.justColumns(e),(function(e){return e.column>=t&&e.column<n})),o=O(r,(function(e){var r=Tr(e.element);return vl(r,"span",n-t),r})),i=xe.fromTag("colgroup");return qn(i,o),[i]}return[]}(n,r,o),u=function(e,t,n){return O(e.all,(function(e){var r=L(e.cells,(function(e){return e.column>=t&&e.column<n})),o=O(r,(function(e){var r=Tr(e.element);return vl(r,"colspan",n-t),r})),i=xe.fromTag("tr");return qn(i,o),i}))}(n,r,o);return Y(Y([],i,!0),u,!0)}))},yl=function(e,t,n){var r=En.fromTable(e);return kc(r,t).bind((function(e){var t=yc(r,n,!1),o=yn(t).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),i=z(o,(function(e){var t=L(e.cells,(function(e){return!e.isLocked}));return t.length>0?[G(G({},e),{cells:t})]:[]})),u=Cc(i);return Ft(u.length>0,u)})).map((function(e){return function(e){return O(e,(function(e){var t=Sr(e.element);return B(e.cells,(function(e){var n=Tr(e.element);mc(n,"colspan",e.colspan,1),mc(n,"rowspan",e.rowspan,1),zn(t,n)})),t}))}(e)}))},Cl=tinymce.util.Tools.resolve("tinymce.util.Tools"),wl=function(e,t,n){return function(t,r){for(var o=0;o<r.length;o++){var i=e.getStyle(r[o],n);if(void 0===t&&(t=i),t!==i)return""}return t}(void 0,e.select("td,th",t))},xl=function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},Sl=function(e,t){Cl.each("left center right".split(" "),(function(n){e.formatter.remove("align"+n,{},t)}))},Tl=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],kl=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Nl=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,El=function(e){return(t=e,n="#",oe(t,n)?function(e,t){return e.substring(t)}(t,n.length):t).toUpperCase();var t,n},Rl=function(e){return function(e){return kl.test(e)||Nl.test(e)}(e)?k.some({value:El(e)}):k.none()},_l=function(e){var t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},Dl=function(e){return function(e){return{value:e}}(_l(e.red)+_l(e.green)+_l(e.blue))},Al=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Ol=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Bl=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},Pl=function(e,t,n,r){var o=parseInt(e,10),i=parseInt(t,10),u=parseInt(n,10),a=parseFloat(r);return Bl(o,i,u,a)},Ll=function(e){return Rl(e).orThunk((function(){return function(e){if("transparent"===e)return k.some(Bl(0,0,0,0));var t=Al.exec(e);if(null!==t)return k.some(Pl(t[1],t[2],t[3],"1"));var n=Ol.exec(e);return null!==n?k.some(Pl(n[1],n[2],n[3],n[4])):k.none()}(e).map(Dl)})).getOrThunk((function(){var t=document.createElement("canvas");t.height=1,t.width=1;var n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.fillStyle=e,n.fillRect(0,0,1,1);var r=n.getImageData(0,0,1,1).data,o=r[0],i=r[1],u=r[2],a=r[3];return Dl(Bl(o,i,u,a))}))},Il=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},Ml=function(e){var t=Il(k.none()),n=function(){return t.get().each(e)};return{clear:function(){n(),t.set(k.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){n(),t.set(k.some(e))}}},Fl=function(){var e=Ml(d);return G(G({},e),{on:function(t){return e.get().each(t)}})},jl=function(e,t,n,r){return function(o){var i=Ml((function(e){return e.unbind()})),u=!ae(r),a=function(){var a=_i(t),c=function(t){return e.formatter.match(n,{value:r},t.dom,u)};u?(o.setActive(!D(a,c)),i.set(e.formatter.formatChanged(n,(function(e){return o.setActive(!e)}),!0))):(o.setActive(H(a,c)),i.set(e.formatter.formatChanged(n,o.setActive,!1,{value:r})))};return e.initialized?a():e.on("init",a),i.clear}},Ul=function(e){return ze(e,"menu")},zl=function(e){return O(e,(function(e){var t=e.text||e.title;return Ul(e)?{text:t,items:zl(e.menu)}:{text:t,value:e.value}}))},Hl=function(e,t,n,r,o){return O(n,(function(n){var i=n.text||n.title;return Ul(n)?{type:"nestedmenuitem",text:i,getSubmenuItems:function(){return Hl(e,t,n.menu,r,o)}}:{text:i,type:"togglemenuitem",onAction:function(){return o(n.value)},onSetup:jl(e,t,r,n.value)}}))},Vl=function(e,t){return function(n){var r;e.execCommand("mceTableApplyCellStyle",!1,((r={})[t]=n,r))}},ql=function(e){return z(e,(function(e){return Ul(e)?[G(G({},e),{menu:ql(e.menu)})]:ae(e.value)?[e]:[]}))},Wl=function(e,t,n,r,o){return function(i){return i(Hl(e,t,n,r,o))}},$l=function(e,t,n){var r=O(t,(function(e){return{text:e.title,value:"#"+Ll(e.value).value,type:"choiceitem"}}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:r.length>0?r:void 0,allowCustomColors:!1},onAction:function(t){var r,o="remove"===t.value?"":t.value;e.execCommand("mceTableApplyCellStyle",!1,((r={})[n]=o,r))}}]},Kl=function(e){return function(){var t="header"===e.queryCommandValue("mceTableRowType")?"body":"header";e.execCommand("mceTableRowType",!1,{type:t})}},Xl=function(e){return function(){var t="th"===e.queryCommandValue("mceTableColType")?"td":"th";e.execCommand("mceTableColType",!1,{type:t})}},Gl=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:Tl}],Yl=function(e){return Gl.concat(function(e){var t=zl(Ta(e));return t.length>0?k.some({name:"class",type:"listbox",label:"Class",items:t}):k.none()}(e).toArray())},Ql=function(e,t){var n=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(zl(va(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===t?[{name:"borderwidth",type:"input",label:"Border width"}].concat(n):n}},Jl=function(e){return function(t,n){var r=t.dom;return{setAttrib:function(t,o){e&&!o||r.setAttrib(n,t,o)},setStyle:function(t,o){e&&!o||r.setStyle(n,t,o)},setFormat:function(r,o){e&&!o||(""===o?t.formatter.remove(r,{value:null},n,!0):t.formatter.apply(r,{value:o},n))}}}},Zl={normal:Jl(!1),ifTruthy:Jl(!0)},es=function(e){return function(t){return oe(t,"rgb")?e.toHex(t):t}},ts=function(e,t){var n=xe.fromDom(t);return{borderwidth:Wt(n,"border-width").getOr(""),borderstyle:Wt(n,"border-style").getOr(""),bordercolor:Wt(n,"border-color").map(es(e)).getOr(""),backgroundcolor:Wt(n,"background-color").map(es(e)).getOr("")}},ns=function(e){var t=e[0],n=e.slice(1);return B(n,(function(e){B(De(t),(function(n){Oe(e,(function(e,r){var o=t[n];""!==o&&n===r&&o!==e&&(t[n]="")}))}))})),t},rs=function(e,t,n,r){return F(e,(function(e){return!c(n.formatter.matchNode(r,t+e))})).getOr("")},os=h(rs,["left","center","right"],"align"),is=h(rs,["top","middle","bottom"],"valign"),us=function(e){return un(xe.fromDom(e)).map((function(t){var n={selection:mi(e.cells)};return ul(t,n)})).getOr("")},as=function(e,t){var n=En.fromTable(e),r=En.justCells(n),o=L(r,(function(e){return D(t,(function(t){return Ne(e.element,t)}))}));return O(o,(function(e){return{element:e.element.dom,column:En.getColumnAt(n,e.column).map((function(e){return e.element.dom}))}}))},cs=function(e,t,n){var r=1===t.length;B(t,(function(t){var o=t.element,i=r?Zl.normal(e,o):Zl.ifTruthy(e,o);!function(e,t,n){e.setAttrib("scope",n.scope),e.setAttrib("class",n.class),e.setStyle("height",bi(n.height)),t.setStyle("width",bi(n.width))}(i,t.column.map((function(t){return r?Zl.normal(e,t):Zl.ifTruthy(e,t)})).getOr(i),n),Ca(e)&&function(e,t){e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),e.setFormat("tablecellbordercolor",t.bordercolor),e.setFormat("tablecellborderstyle",t.borderstyle),e.setFormat("tablecellborderwidth",bi(t.borderwidth))}(i,n),r&&(Sl(e,o),function(e,t){Cl.each("top middle bottom".split(" "),(function(n){e.formatter.remove("valign"+n,{},t)}))}(e,o)),n.halign&&xl(e,o,n.halign),n.valign&&function(e,t,n){n&&e.formatter.apply("valign"+n,{},t)}(e,o,n.valign)}))},fs=function(e,t,n,r){var o=r.getData();r.close(),e.undoManager.transact((function(){!function(e,t,n,r){var o=Le(r,(function(e,t){return n[t]!==e}));Fe(o)>0&&t.length>=1&&un(t[0]).each((function(n){var i=as(n,t),u=Fe(Le(o,(function(e,t){return"scope"!==t&&"celltype"!==t})))>0,a=Ue(o,"celltype");(u||Ue(o,"scope"))&&cs(e,i,r),a&&function(e,t){e.execCommand("mceTableCellType",!1,{type:t.celltype,no_events:!0})}(e,r),ua(e,n.dom,{structure:a,style:u})}))}(e,t,n,o),e.focus()}))},ls=function(e,t){var n=un(t[0]).map((function(n){return O(as(n,t),(function(t){return function(e,t,n,r){var o,i=e.dom,u=r.getOr(t),a=function(e,t){return i.getStyle(e,t)||i.getAttrib(e,t)};return G({width:a(u,"width"),height:a(t,"height"),scope:i.getAttrib(t,"scope"),celltype:(o=t,o.nodeName.toLowerCase()),class:i.getAttrib(t,"class",""),halign:os(e,t),valign:is(e,t)},n?ts(i,t):{})}(e,t.element,Ca(e),t.column)}))}));return ns(n.getOrDie())},ss=function(e,t){var n=_i(t);if(0!==n.length){var r=ls(e,n),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:Yl(e)},Ql(e,"cell")]},i={type:"panel",items:[{type:"grid",columns:2,items:Yl(e)}]};e.windowManager.open({title:"Cell Properties",size:"normal",body:Ca(e)?o:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:h(fs,e,n,r)})}},ds=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],ms=function(e){return ds.concat(function(e){var t=zl(function(e){return e.getParam("table_row_class_list",[],"array")}(e));return t.length>0?k.some({name:"class",type:"listbox",label:"Class",items:t}):k.none()}(e).toArray())},gs=function(e,t,n,r){var o=1===t.length;B(t,(function(t){var i=o?Zl.normal(e,t):Zl.ifTruthy(e,t);!function(e,t){e.setAttrib("class",t.class),e.setStyle("height",bi(t.height))}(i,n),wa(e)&&function(e,t){e.setStyle("background-color",t.backgroundcolor),e.setStyle("border-color",t.bordercolor),e.setStyle("border-style",t.borderstyle)}(i,n),n.align!==r.align&&(Sl(e,t),xl(e,t,n.align))}))},ps=function(e,t,n,r){var o=r.getData();r.close(),e.undoManager.transact((function(){!function(e,t,n,r){var o=Le(r,(function(e,t){return n[t]!==e}));if(Fe(o)>0){var i=Ue(o,"type"),u=!i||Fe(o)>1;u&&gs(e,t,r,n),i&&function(e,t){e.execCommand("mceTableRowType",!1,{type:t.type,no_events:!0})}(e,r),un(xe.fromDom(t[0])).each((function(t){return ua(e,t.dom,{structure:i,style:u})}))}}(e,t,n,o),e.focus()}))},hs=function(e){var t,n,r,o,i=(t=Ci(e),n=Ti.selected,r=Ri(t),o=r.bind((function(e){return un(e)})).map((function(e){return an(e)})),Mt(r,o,(function(e,t){return L(t,(function(t){return D(mi(t.dom.cells),(function(t){return"1"===At(t,n)||Ne(t,e)}))}))})).getOr([]));if(0!==i.length){var u=O(i,(function(t){return function(e,t,n){var r=e.dom;return G({height:r.getStyle(t,"height")||r.getAttrib(t,"height"),class:r.getAttrib(t,"class",""),type:us(t),align:os(e,t)},n?ts(r,t):{})}(e,t.dom,wa(e))})),a=ns(u),c={type:"tabpanel",tabs:[{title:"General",name:"general",items:ms(e)},Ql(e,"row")]},f={type:"panel",items:[{type:"grid",columns:2,items:ms(e)}]};e.windowManager.open({title:"Row Properties",size:"normal",body:wa(e)?c:f,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:a,onSubmit:h(ps,e,O(i,(function(e){return e.dom})),a)})}},vs=function(e,t,n){var r=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=function(e){return e.getParam("table_appearance_options",!0,"boolean")}(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],i=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(i)},bs=function(e,t,n,o){if("TD"===t.tagName||"TH"===t.tagName)r(n)?e.setStyle(t,n,o):e.setStyle(t,n);else if(t.children)for(var i=0;i<t.children.length;i++)bs(e,t.children[i],n,o)},ys=function(e,t,n,r){var o=e.dom,i=r.getData(),u=Le(i,(function(e,t){return n[t]!==e}));r.close(),""===i.class&&delete i.class,e.undoManager.transact((function(){if(!t){var n=parseInt(i.cols,10)||1,r=parseInt(i.rows,10)||1;t=dl(e,n,r,0,0)}if(Fe(u)>0){!function(e,t,n){var r=e.dom,o={},i={};if(o.class=n.class,i.height=bi(n.height),r.getAttrib(t,"width")&&!Sa(e)?o.width=function(e){return e?e.replace(/px$/,""):""}(n.width):i.width=bi(n.width),Sa(e)?(i["border-width"]=bi(n.border),i["border-spacing"]=bi(n.cellspacing)):(o.border=n.border,o.cellpadding=n.cellpadding,o.cellspacing=n.cellspacing),Sa(e)&&t.children)for(var u=0;u<t.children.length;u++)bs(r,t.children[u],{"border-width":bi(n.border),padding:bi(n.cellpadding)}),xa(e)&&bs(r,t.children[u],{"border-color":n.bordercolor});xa(e)&&(i["background-color"]=n.backgroundcolor,i["border-color"]=n.bordercolor,i["border-style"]=n.borderstyle),o.style=r.serializeStyle(G(G({},ya(e)),i)),r.setAttribs(t,G(G({},ba(e)),o))}(e,t,i);var a=o.select("caption",t)[0];(a&&!i.caption||!a&&i.caption)&&e.execCommand("mceTableToggleCaption"),""===i.align?Sl(e,t):xl(e,t,i.align)}if(e.focus(),e.addVisual(),Fe(u)>0){var c=Ue(u,"caption"),f=!c||Fe(u)>1;ua(e,t,{structure:c,style:f})}}))},Cs=function(e,t){var n,r=e.dom,o=function(e,t){var n,r,o,i,u=ya(e),a=ba(e),c=t?(n=e.dom,{borderstyle:je(u,"border-style").getOr(""),bordercolor:es(n)(je(u,"border-color").getOr("")),backgroundcolor:es(n)(je(u,"background-color").getOr(""))}):{};return G(G(G(G(G(G({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),u),a),c),(i=u["border-width"],Sa(e)&&i?{border:i}:je(a,"border").fold((function(){return{}}),(function(e){return{border:e}})))),(r=je(u,"border-spacing").or(je(a,"cellspacing")).fold((function(){return{}}),(function(e){return{cellspacing:e}})),o=je(u,"border-padding").or(je(a,"cellpadding")).fold((function(){return{}}),(function(e){return{cellpadding:e}})),G(G({},r),o)))}(e,xa(e));!1===t?(n=r.getParent(e.selection.getStart(),"table",e.getBody()))?o=function(e,t,n){var r=e.dom,o=Sa(e)?r.getStyle(t,"border-spacing")||r.getAttrib(t,"cellspacing"):r.getAttrib(t,"cellspacing")||r.getStyle(t,"border-spacing"),i=Sa(e)?wl(r,t,"padding")||r.getAttrib(t,"cellpadding"):r.getAttrib(t,"cellpadding")||wl(r,t,"padding");return G({width:r.getStyle(t,"width")||r.getAttrib(t,"width"),height:r.getStyle(t,"height")||r.getAttrib(t,"height"),cellspacing:o,cellpadding:i,border:function(t,n){var r=Wt(xe.fromDom(n),"border-width");return Sa(e)&&r.isSome()?r.getOr(""):t.getAttrib(n,"border")||wl(e.dom,n,"border-width")||wl(e.dom,n,"border")}(r,t),caption:!!r.select("caption",t)[0],class:r.getAttrib(t,"class",""),align:os(e,t)},n?ts(r,t):{})}(e,n,xa(e)):xa(e)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",xa(e)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var i=zl(ka(e));i.length>0&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var u={type:"grid",columns:2,items:vs(e,i,t)},a=xa(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[u]},Ql(e,"table")]}:{type:"panel",items:[u]};e.windowManager.open({title:"Table Properties",size:"normal",body:a,onSubmit:h(ys,e,n,o),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},ws=function(e){return Ei(Ci(e),vi(e))},xs=function(e,t,n,i,u){var a=vi(e),c=function(e){return un(e,a)},f=function(t){return function(e){return Ri(Ci(e),vi(e))}(e).bind((function(e){return c(e).map((function(n){return t(n,e)}))}))},l=function(t){e.focus()},s=function(e,t){return void 0===t&&(t=!1),f((function(n,r){var o=ki(i,n,r);e(n,o,t).each(l)}))},m=function(){return f((function(t,n){var r=ki(i,t,n),o=si(d,xe.fromDom(e.getDoc()),k.none());return yl(t,r,o)}))},g=function(){return f((function(e,t){var n=ki(i,e,t);return bl(e,n)}))},p=function(t,n){return n().each((function(n){var r=O(n,(function(e){return Tr(e)}));f((function(n,o){var u=di(xe.fromDom(e.getDoc())),a=function(e,t,n,r){return{selection:wi(e),clipboard:n,generators:r}}(i,0,r,u);t(n,a).each(l)}))}))},v=function(e){return function(t,n){return je(n,"type").each((function(t){s(e(t),n.no_events)}))}};Oe({mceTableSplitCells:function(){return s(t.unmergeCells)},mceTableMergeCells:function(){return s(t.mergeCells)},mceTableInsertRowBefore:function(){return s(t.insertRowsBefore)},mceTableInsertRowAfter:function(){return s(t.insertRowsAfter)},mceTableInsertColBefore:function(){return s(t.insertColumnsBefore)},mceTableInsertColAfter:function(){return s(t.insertColumnsAfter)},mceTableDeleteCol:function(){return s(t.deleteColumn)},mceTableDeleteRow:function(){return s(t.deleteRow)},mceTableCutCol:function(){return g().each((function(e){u.setColumns(e),s(t.deleteColumn)}))},mceTableCutRow:function(){return m().each((function(e){u.setRows(e),s(t.deleteRow)}))},mceTableCopyCol:function(){return g().each((function(e){return u.setColumns(e)}))},mceTableCopyRow:function(){return m().each((function(e){return u.setRows(e)}))},mceTablePasteColBefore:function(){return p(t.pasteColsBefore,u.getColumns)},mceTablePasteColAfter:function(){return p(t.pasteColsAfter,u.getColumns)},mceTablePasteRowBefore:function(){return p(t.pasteRowsBefore,u.getRows)},mceTablePasteRowAfter:function(){return p(t.pasteRowsAfter,u.getRows)},mceTableDelete:function(){return ws(e).each((function(t){un(t,a).filter(y(a)).each((function(t){var n=xe.fromText("");if(jn(t,n),$n(t),e.dom.isEmpty(e.getBody()))e.setContent(""),e.selection.setCursorLocation();else{var r=e.dom.createRng();r.setStart(n.dom,0),r.setEnd(n.dom,0),e.selection.setRng(r),e.nodeChanged()}}))}))},mceTableCellToggleClass:function(t,n){f((function(t){var r=_i(i),o=H(r,(function(t){return e.formatter.match("tablecellclass",{value:n},t.dom)}))?e.formatter.remove:e.formatter.apply;B(r,(function(e){return o("tablecellclass",{value:n},e.dom)})),ua(e,t.dom,aa)}))},mceTableToggleClass:function(t,n){f((function(t){e.formatter.toggle("tableclass",{value:n},t.dom),ua(e,t.dom,aa)}))},mceTableToggleCaption:function(){ws(e).each((function(t){un(t,a).each((function(n){kt(n,"caption").fold((function(){var t=xe.fromTag("caption");zn(t,xe.fromText("Caption")),function(e,t,n){ft(e,n).fold((function(){zn(e,t)}),(function(e){Fn(e,t)}))}(n,t,0),e.selection.setCursorLocation(t.dom,0)}),(function(r){tt("caption")(t)&&ke("td",n).each((function(t){return e.selection.setCursorLocation(t.dom,0)})),$n(r)})),ua(e,n.dom,ca)}))}))},mceTableSizingMode:function(t,n){return function(t){return ws(e).each((function(n){Ra(e)||Ea(e)||Na(e)||un(n,a).each((function(n){"relative"!==t||uu(n)?"fixed"!==t||au(n)?"responsive"!==t||cu(n)||za(n):Ua(n):ja(n),yi(n),ua(e,n.dom,ca)}))}))}(n)},mceTableCellType:v((function(e){return"th"===e?t.makeCellsHeader:t.unmakeCellsHeader})),mceTableColType:v((function(e){return"th"===e?t.makeColumnsHeader:t.unmakeColumnsHeader})),mceTableRowType:v((function(e){switch(e){case"header":return t.makeRowsHeader;case"footer":return t.makeRowsFooter;default:return t.makeRowsBody}}))},(function(t,n){return e.addCommand(n,t)})),Oe({mceTableProps:h(Cs,e,!1),mceTableRowProps:h(hs,e),mceTableCellProps:h(ss,e,i)},(function(t,n){return e.addCommand(n,(function(){return t()}))})),e.addCommand("mceInsertTable",(function(t,n){o(n)&&De(n).length>0?ml(e,n.rows,n.columns,n.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Cs(e,!0)})),e.addCommand("mceTableApplyCellStyle",(function(t,n){var u=function(e){return"tablecell"+e.toLowerCase().replace("-","")};if(o(n)){var a=_i(i);if(0!==a.length){var f=Le(n,(function(t,n){return e.formatter.has(u(n))&&r(t)}));(function(e){for(var t in e)if(Ae.call(e,t))return!1;return!0})(f)||(Oe(f,(function(t,n){B(a,(function(r){Zl.normal(e,r.dom).setFormat(u(n),t)}))})),c(a[0]).each((function(t){return ua(e,t.dom,aa)})))}}}))},Ss={remove_similar:!0,inherit:!1},Ts=G({selector:"td,th"},Ss),ks={tablecellbackgroundcolor:G({styles:{backgroundColor:"%value"}},Ts),tablecellverticalalign:G({styles:{"vertical-align":"%value"}},Ts),tablecellbordercolor:G({styles:{borderColor:"%value"}},Ts),tablecellclass:G({classes:["%value"]},Ts),tableclass:G({selector:"table",classes:["%value"]},Ss),tablecellborderstyle:G({styles:{borderStyle:"%value"}},Ts),tablecellborderwidth:G({styles:{borderWidth:"%value"}},Ts)},Ns=pr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Es=G(G({},Ns),{none:function(e){return void 0===e&&(e=void 0),Ns.none(e)}}),Rs=function(e,t,n,r,o){void 0===o&&(o=w);var i=1===r;if(!i&&n<=0)return Es.first(e[0]);if(i&&n>=e.length-1)return Es.last(e[e.length-1]);var u=n+r,a=e[u];return o(a)?Es.middle(t,a):Rs(e,t,u,r,o)},_s=function(e,t){return un(e,t).bind((function(t){var n=rn(t);return j(n,(function(t){return Ne(e,t)})).map((function(e){return{index:e,all:n}}))}))},Ds=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},As=pr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Os={before:As.before,on:As.on,after:As.after,cata:function(e,t,n,r){return e.fold(t,n,r)},getStart:function(e){return e.fold(g,g,g)}},Bs=pr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ps={domRange:Bs.domRange,relative:Bs.relative,exact:Bs.exact,exactFromRange:function(e){return Bs.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t,n=function(e){return e.match({domRange:function(e){return xe.fromDom(e.startContainer)},relative:function(e,t){return Os.getStart(e)},exact:function(e,t,n,r){return e}})}(e);return t=n,xe.fromDom(rt(t).dom.defaultView)},range:Ds},Ls=function(e,t){var n=e.document.createRange();return n.selectNode(t.dom),n},Is=function(e,t){var n=e.document.createRange();return Ms(n,t),n},Ms=function(e,t){return e.selectNodeContents(t.dom)},Fs=function(e,t,n){var r,o=e.document.createRange();return r=o,t.fold((function(e){r.setStartBefore(e.dom)}),(function(e,t){r.setStart(e.dom,t)}),(function(e){r.setStartAfter(e.dom)})),function(e,t){t.fold((function(t){e.setEndBefore(t.dom)}),(function(t,n){e.setEnd(t.dom,n)}),(function(t){e.setEndAfter(t.dom)}))}(o,n),o},js=function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(r.dom,o),i},Us=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},zs=pr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Hs=function(e,t,n){return t(xe.fromDom(n.startContainer),n.startOffset,xe.fromDom(n.endContainer),n.endOffset)},Vs=function(e,t){return function(e,t){var n=t.ltr();return n.collapsed?t.rtl().filter((function(e){return!1===e.collapsed})).map((function(e){return zs.rtl(xe.fromDom(e.endContainer),e.endOffset,xe.fromDom(e.startContainer),e.startOffset)})).getOrThunk((function(){return Hs(0,zs.ltr,n)})):Hs(0,zs.ltr,n)}(0,function(e,t){return t.match({domRange:function(e){return{ltr:m(e),rtl:k.none}},relative:function(t,n){return{ltr:Q((function(){return Fs(e,t,n)})),rtl:Q((function(){return k.some(Fs(e,n,t))}))}},exact:function(t,n,r,o){return{ltr:Q((function(){return js(e,t,n,r,o)})),rtl:Q((function(){return k.some(js(e,r,o,t,n))}))}}})}(e,t))},qs=function(e,t){return Vs(e,t).match({ltr:function(t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(r.dom,o),i},rtl:function(t,n,r,o){var i=e.document.createRange();return i.setStart(r.dom,o),i.setEnd(t.dom,n),i}})};zs.ltr,zs.rtl;var Ws=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},$s=function(e,t,n,r,o){var i=function(n){var r=e.dom.createRange();return r.setStart(t.dom,n),r.collapse(!0),r},u=Gn(t).length,a=function(e,t,n,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,u=1;u<o;u++){var a=e(u),c=Math.abs(t-a.left);if(n<=a.bottom){if(n<a.top||c>i)return u-1;i=c}}return 0}((function(e){return i(e).getBoundingClientRect()}),n,r,o.right,u);return i(a)},Ks=function(e,t,n,r){return Je(t)?function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getClientRects();return X(i,(function(e){return Ws(e,n,r)?k.some(e):k.none()})).map((function(o){return $s(e,t,n,r,o)}))}(e,t,n,r):function(e,t,n,r){var o=e.dom.createRange(),i=ct(t);return X(i,(function(t){return o.selectNode(t.dom),Ws(o.getBoundingClientRect(),n,r)?Ks(e,t,n,r):k.none()}))}(e,t,n,r)},Xs=function(e,t){return t-e.left<e.right-t},Gs=function(e,t,n){var r=e.dom.createRange();return r.selectNode(t.dom),r.collapse(n),r},Ys=function(e,t,n){var r=e.dom.createRange();r.selectNode(t.dom);var o=r.getBoundingClientRect(),i=Xs(o,n);return(!0===i?ti:ni)(t).map((function(t){return Gs(e,t,i)}))},Qs=function(e,t,n){var r=t.dom.getBoundingClientRect(),o=Xs(r,n);return k.some(Gs(e,t,o))},Js=function(e,t,n){var r,o;return k.from(null===(o=(r=e.dom).caretPositionFromPoint)||void 0===o?void 0:o.call(r,t,n)).bind((function(t){if(null===t.offsetNode)return k.none();var n=e.dom.createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),k.some(n)}))},Zs=function(e,t,n){var r,o;return k.from(null===(o=(r=e.dom).caretRangeFromPoint)||void 0===o?void 0:o.call(r,t,n))},ed=function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect();return function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Ks(e,t,u,a)}(e,t,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))},td=function(e,t,n){return xe.fromPoint(e,t,n).bind((function(r){var o=function(){return function(e,t,n){return(0===ct(t).length?Qs:Ys)(e,t,n)}(e,r,t)};return 0===ct(r).length?o():ed(e,r,t,n).orThunk(o)}))},nd=document.caretPositionFromPoint?Js:document.caretRangeFromPoint?Zs:td,rd=function(e,t){var n=Ke(e);return"input"===n?Os.after(e):_(["br","img"],n)?0===t?Os.before(e):Os.after(e):Os.on(e,t)},od=function(e,t){var n=e.fold(Os.before,rd,Os.after),r=t.fold(Os.before,rd,Os.after);return Ps.relative(n,r)},id=function(e,t,n,r){var o=rd(e,t),i=rd(n,r);return Ps.relative(o,i)},ud=function(e,t,n,r){var o=function(e,t,n,r){var o=nt(e).dom.createRange();return o.setStart(e.dom,t),o.setEnd(n.dom,r),o}(e,t,n,r),i=Ne(e,n)&&t===r;return o.collapsed&&!i},ad=function(e){return k.from(e.getSelection())},cd=function(e,t){ad(e).each((function(e){e.removeAllRanges(),e.addRange(t)}))},fd=function(e,t,n,r,o){var i=js(e,t,n,r,o);cd(e,i)},ld=function(e,t){return Vs(e,t).match({ltr:function(t,n,r,o){fd(e,t,n,r,o)},rtl:function(t,n,r,o){ad(e).each((function(i){if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom,n,r.dom,o);else if(i.extend)try{!function(e,t,n,r,o,i){t.collapse(n.dom,r),t.extend(o.dom,i)}(0,i,t,n,r,o)}catch(i){fd(e,r,o,t,n)}else fd(e,r,o,t,n)}))}})},sd=function(e,t,n,r,o){var i=id(t,n,r,o);ld(e,i)},dd=function(e,t,n){var r=od(t,n);ld(e,r)},md=function(e){var t=Ps.getWin(e).dom,n=function(e,n,r,o){return js(t,e,n,r,o)},r=function(e){return e.match({domRange:function(e){var t=xe.fromDom(e.startContainer),n=xe.fromDom(e.endContainer);return id(t,e.startOffset,n,e.endOffset)},relative:od,exact:id})}(e);return Vs(t,r).match({ltr:n,rtl:n})},gd=function(e){if(e.rangeCount>0){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return k.some(Ds(xe.fromDom(t.startContainer),t.startOffset,xe.fromDom(n.endContainer),n.endOffset))}return k.none()},pd=function(e){if(null===e.anchorNode||null===e.focusNode)return gd(e);var t=xe.fromDom(e.anchorNode),n=xe.fromDom(e.focusNode);return ud(t,e.anchorOffset,n,e.focusOffset)?k.some(Ds(t,e.anchorOffset,n,e.focusOffset)):gd(e)},hd=function(e,t,n){void 0===n&&(n=!0);var r=(n?Is:Ls)(e,t);cd(e,r)},vd=function(e){return function(e){return ad(e).filter((function(e){return e.rangeCount>0})).bind(pd)}(e).map((function(e){return Ps.exact(e.start,e.soffset,e.finish,e.foffset)}))},bd=function(e,t){return function(e){var t=e.getClientRects(),n=t.length>0?t[0]:e.getBoundingClientRect();return n.width>0||n.height>0?k.some(n).map(Us):k.none()}(qs(e,t))},yd=function(e,t,n){return function(e,t,n){var r=xe.fromDom(e.document);return nd(r,t,n).map((function(e){return Ds(xe.fromDom(e.startContainer),e.startOffset,xe.fromDom(e.endContainer),e.endOffset)}))}(e,t,n)},Cd=tinymce.util.Tools.resolve("tinymce.util.VK"),wd=function(e,t,n){return Sd(e,t,function(e,t,n){return _s(e,n).fold((function(){return Es.none(e)}),(function(n){return Rs(n.all,e,n.index,1,t)}))}(n,Fu))},xd=function(e,t,n){return Sd(e,t,function(e,t,n){return _s(e,n).fold((function(){return Es.none()}),(function(n){return Rs(n.all,e,n.index,-1,t)}))}(n,Fu))},Sd=function(e,t,n){return n.fold(k.none,k.none,(function(e,t){return ti(t).map((function(e){return function(e,t){var n=Ps.exact(t,0,t,0);return md(n)}(0,e)}))}),(function(n){return e.execCommand("mceTableInsertRowAfter"),wd(e,t,n)}))},Td=["table","li","dl"],kd=function(e,t){return{selection:e,kill:t}},Nd=function(e,t,n,r){return{start:Os.on(e,t),finish:Os.on(n,r)}},Ed=function(e,t){var n=qs(e,t);return Ds(xe.fromDom(n.startContainer),n.startOffset,xe.fromDom(n.endContainer),n.endOffset)},Rd=Nd,_d=function(e,t,n,r,o){return Ne(n,r)?k.none():fr(n,r,t).bind((function(t){var r=t.boxes.getOr([]);return r.length>1?(o(e,r,t.start,t.finish),k.some(kd(k.some(Rd(n,0,n,Jo(n))),!0))):k.none()}))},Dd=function(e,t){return{item:e,mode:t}},Ad=function(e,t,n,r){return void 0===r&&(r=Od),e.property().parent(t).map((function(e){return Dd(e,r)}))},Od=function(e,t,n,r){return void 0===r&&(r=Bd),n.sibling(e,t).map((function(e){return Dd(e,r)}))},Bd=function(e,t,n,r){void 0===r&&(r=Bd);var o=e.property().children(t);return n.first(o).map((function(e){return Dd(e,r)}))},Pd=[{current:Ad,next:Od,fallback:k.none()},{current:Od,next:Bd,fallback:k.some(Ad)},{current:Bd,next:Bd,fallback:k.some(Od)}],Ld=function(e,t,n,r,o){return void 0===o&&(o=Pd),F(o,(function(e){return e.current===n})).bind((function(n){return n.current(e,t,r,n.next).orThunk((function(){return n.fallback.bind((function(n){return Ld(e,t,n,r)}))}))}))},Id=function(){return{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return e.length>0?k.some(e[e.length-1]):k.none()}}},Md=function(){return{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return e.length>0?k.some(e[0]):k.none()}}},Fd=function(e,t,n,r,o,i){return Ld(e,t,r,o).bind((function(t){return i(t.item)?k.none():n(t.item)?k.some(t.item):Fd(e,t.item,n,t.mode,o,i)}))},jd=function(e){return function(t){return 0===e.property().children(t).length}},Ud=function(e,t,n,r){return Fd(e,t,n,Od,Id(),r)},zd=function(e,t,n,r){return Fd(e,t,n,Od,Md(),r)},Hd=Zn(),Vd=function(e,t){return function(e,t,n){return Ud(e,t,jd(e),n)}(Hd,e,t)},qd=function(e,t){return function(e,t,n){return zd(e,t,jd(e),n)}(Hd,e,t)},Wd=pr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),$d=function(e){return Et(e,"tr")},Kd=G(G({},Wd),{verify:function(e,t,n,r,o,i,u){return Et(r,"td,th",u).bind((function(n){return Et(t,"td,th",u).map((function(t){return Ne(n,t)?Ne(r,n)&&Jo(n)===o?i(t):Wd.none("in same cell"):ar($d,[n,t]).fold((function(){return function(e,t,n){var r=e.getRect(t),o=e.getRect(n);return o.right>r.left&&o.left<r.right}(e,t,n)?Wd.success():i(t)}),(function(e){return i(t)}))}))})).getOr(Wd.none("default"))},cata:function(e,t,n,r,o){return e.fold(t,n,r,o)}}),Xd=function(e,t){return j(e,h(Ne,t))},Gd=function(e){return"br"===Ke(e)},Yd=function(e,t,n){return t(e,n).bind((function(e){return Je(e)&&0===Gn(e).trim().length?Yd(e,t,n):k.some(e)}))},Qd=function(e,t,n,r){return function(e,t){return ft(e,t).filter(Gd).orThunk((function(){return ft(e,t-1).filter(Gd)}))}(t,n).bind((function(t){return r.traverse(t).fold((function(){return Yd(t,r.gather,e).map(r.relative)}),(function(e){return function(e){return ot(e).bind((function(t){var n=ct(t);return Xd(n,e).map((function(r){return function(e,t,n,r){return{parent:e,children:t,element:n,index:r}}(t,n,e,r)}))}))}(e).map((function(e){return Os.on(e.parent,e.index)}))}))}))},Jd=function(e,t,n,r){return(Gd(t)?function(e,t,n){return n.traverse(t).orThunk((function(){return Yd(t,n.gather,e)})).map(n.relative)}(e,t,r):Qd(e,t,n,r)).map((function(e){return{start:e,finish:e}}))},Zd=function(e,t){return{left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}},em=function(e,t){return{left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}},tm=function(e,t,n){return{left:e.left+t,top:e.top+n,right:e.right+t,bottom:e.bottom+n}},nm=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}},rm=function(e,t){return k.some(e.getRect(t))},om=function(e,t,n){return Qe(t)?rm(e,t).map(nm):Je(t)?function(e,t,n){return n>=0&&n<Jo(t)?e.getRangedRect(t,n,t,n+1):n>0?e.getRangedRect(t,n-1,t,n):k.none()}(e,t,n).map(nm):k.none()},im=function(e,t){return Qe(t)?rm(e,t).map(nm):Je(t)?e.getRangedRect(t,0,t,Jo(t)).map(nm):k.none()},um=pr([{none:[]},{retry:["caret"]}]),am=function(e,t,n){return(r=t,o=gf,xt((function(e,t){return t(e)}),St,r,o,i)).fold(C,(function(t){return im(e,t).exists((function(e){return function(e,t){return e.left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right}(n,e)}))}));var r,o,i},cm={point:function(e){return e.bottom},adjuster:function(e,t,n,r,o){var i=Zd(o,5);return Math.abs(n.bottom-r.bottom)<1||n.top>o.bottom?um.retry(i):n.top===o.bottom?um.retry(Zd(o,1)):am(e,t,o)?um.retry(tm(i,5,0)):um.none()},move:Zd,gather:qd},fm=function(e,t,n,r,o){return 0===o?k.some(r):function(e,t,n){return e.elementFromPoint(t,n).filter((function(e){return"table"===Ke(e)})).isSome()}(e,r.left,t.point(r))?function(e,t,n,r,o){return fm(e,t,n,t.move(r,5),o)}(e,t,n,r,o-1):e.situsFromPoint(r.left,t.point(r)).bind((function(i){return i.start.fold(k.none,(function(i){return im(e,i).bind((function(u){return t.adjuster(e,i,u,n,r).fold(k.none,(function(r){return fm(e,t,n,r,o-1)}))})).orThunk((function(){return k.some(r)}))}),k.none)}))},lm=function(e,t,n){var r=e.move(n,5),o=fm(t,e,n,r,100).getOr(r);return function(e,t,n){return e.point(t)>n.getInnerHeight()?k.some(e.point(t)-n.getInnerHeight()):e.point(t)<0?k.some(-e.point(t)):k.none()}(e,o,t).fold((function(){return t.situsFromPoint(o.left,e.point(o))}),(function(n){return t.scrollBy(0,n),t.situsFromPoint(o.left,e.point(o)-n)}))},sm={tryUp:h(lm,{point:function(e){return e.top},adjuster:function(e,t,n,r,o){var i=em(o,5);return Math.abs(n.top-r.top)<1||n.bottom<o.top?um.retry(i):n.bottom===o.top?um.retry(em(o,1)):am(e,t,o)?um.retry(tm(i,5,0)):um.none()},move:em,gather:Vd}),tryDown:h(lm,cm),ieTryUp:function(e,t){return e.situsFromPoint(t.left,t.top-5)},ieTryDown:function(e,t){return e.situsFromPoint(t.left,t.bottom+5)},getJumpSize:m(5)},dm=function(e,t,n){return e.getSelection().bind((function(r){return Jd(t,r.finish,r.foffset,n).fold((function(){return k.some(Wa(r.finish,r.foffset))}),(function(o){var i=e.fromSitus(o);return function(e){return Kd.cata(e,(function(e){return k.none()}),(function(){return k.none()}),(function(e){return k.some(Wa(e,0))}),(function(e){return k.some(Wa(e,Jo(e)))}))}(Kd.verify(e,r.finish,r.foffset,i.finish,i.foffset,n.failure,t))}))}))},mm=function(e,t,n,r,o,i){return 0===i?k.none():hm(e,t,n,r,o).bind((function(u){var a=e.fromSitus(u),c=Kd.verify(e,n,r,a.finish,a.foffset,o.failure,t);return Kd.cata(c,(function(){return k.none()}),(function(){return k.some(u)}),(function(u){return Ne(n,u)&&0===r?gm(e,n,r,em,o):mm(e,t,u,0,o,i-1)}),(function(u){return Ne(n,u)&&r===Jo(u)?gm(e,n,r,Zd,o):mm(e,t,u,Jo(u),o,i-1)}))}))},gm=function(e,t,n,r,o){return om(e,t,n).bind((function(t){return pm(e,o,r(t,sm.getJumpSize()))}))},pm=function(e,t,n){var r=Ce().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(e,n):r.isIE()?t.ieRetry(e,n):k.none()},hm=function(e,t,n,r,o){return om(e,n,r).bind((function(t){return pm(e,o,t)}))},vm=function(e,t){return St(e,(function(e){return ot(e).exists((function(e){return Ne(e,t)}))}),n).isSome();var n},bm=function(e,t,n,r,o){return Et(r,"td,th",t).bind((function(r){return Et(r,"table",t).bind((function(i){return vm(o,i)?function(e,t,n){return dm(e,t,n).bind((function(r){return mm(e,t,r.element,r.offset,n,20).map(e.fromSitus)}))}(e,t,n).bind((function(e){return Et(e.finish,"td,th",t).map((function(t){return{start:r,finish:t,range:e}}))})):k.none()}))}))},ym=function(e,t,n,r,o,i){return Ce().browser.isIE()?k.none():i(r,t).orThunk((function(){return bm(e,t,n,r,o).map((function(e){var t=e.range;return kd(k.some(Rd(t.start,t.soffset,t.finish,t.foffset)),!0)}))}))},Cm=function(e,t){return Et(e,"tr",t).bind((function(e){return Et(e,"table",t).bind((function(n){var r=wt(n,"tr");return Ne(e,r[0])?function(e,t,n){return Ud(Hd,e,t,n)}(n,(function(e){return ni(e).isSome()}),t).map((function(e){var t=Jo(e);return kd(k.some(Rd(e,t,e,t)),!0)})):k.none()}))}))},wm=function(e,t){return Et(e,"tr",t).bind((function(e){return Et(e,"table",t).bind((function(n){var r=wt(n,"tr");return Ne(e,r[r.length-1])?function(e,t,n){return zd(Hd,e,t,n)}(n,(function(e){return ti(e).isSome()}),t).map((function(e){return kd(k.some(Rd(e,0,e,0)),!0)})):k.none()}))}))},xm=function(e,t,n,r,o,i,u){return bm(e,n,r,o,i).bind((function(e){return _d(t,n,e.start,e.finish,u)}))},Sm=function(e,t){return Et(e,"td,th",t)},Tm={traverse:at,gather:qd,relative:Os.before,otherRetry:sm.tryDown,ieRetry:sm.ieTryDown,failure:Kd.failedDown},km={traverse:ut,gather:Vd,relative:Os.before,otherRetry:sm.tryUp,ieRetry:sm.ieTryUp,failure:Kd.failedUp},Nm=function(e){return function(t){return t===e}},Em=Nm(38),Rm=Nm(40),_m=function(e){return e>=37&&e<=40},Dm={isBackward:Nm(37),isForward:Nm(39)},Am={isBackward:Nm(39),isForward:Nm(37)},Om=function(e){return{elementFromPoint:function(t,n){return xe.fromPoint(xe.fromDom(e.document),t,n)},getRect:function(e){return e.dom.getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=Ps.exact(t,n,r,o);return bd(e,i)},getSelection:function(){return vd(e).map((function(t){return Ed(e,t)}))},fromSitus:function(t){var n=Ps.relative(t.start,t.finish);return Ed(e,n)},situsFromPoint:function(t,n){return yd(e,t,n).map((function(e){return Nd(e.start,e.soffset,e.finish,e.foffset)}))},clearSelection:function(){!function(e){ad(e).each((function(e){return e.removeAllRanges()}))}(e)},collapseSelection:function(t){void 0===t&&(t=!1),vd(e).each((function(n){return n.fold((function(e){return e.collapse(t)}),(function(n,r){var o=t?n:r;dd(e,o,o)}),(function(n,r,o,i){var u=t?n:o,a=t?r:i;sd(e,u,a,u,a)}))}))},setSelection:function(t){sd(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:function(t,n){dd(e,t,n)},selectNode:function(t){hd(e,t,!1)},selectContents:function(t){hd(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var t,n,r,o;return(t=xe.fromDom(e.document),n=void 0!==t?t.dom:document,r=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop,Gr(r,o)).top},scrollBy:function(t,n){!function(e,t,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollBy(e,t)}(t,n,xe.fromDom(e.document))}}},Bm=function(e,t){return{rows:e,cols:t}},Pm=function(e,t,n,r){var o=function(e,t,n,r){var o=Fl(),i=o.clear,u=function(i){o.on((function(o){r.clearBeforeUpdate(t),Sm(i.target,n).each((function(u){fr(o,u,n).each((function(n){var o=n.boxes.getOr([]);if(1===o.length){var a=o[0],c="false"===ju(a),f=Lt(Mu(i.target),a,Ne);c&&f&&(r.selectRange(t,o,a,a),e.selectContents(a))}else o.length>1&&(r.selectRange(t,o,n.start,n.finish),e.selectContents(u))}))}))}))};return{clearstate:i,mousedown:function(e){r.clear(t),Sm(e.target,n).each(o.set)},mouseover:function(e){u(e)},mouseup:function(e){u(e),i()}}}(Om(e),t,n,r);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},Lm=function(e,t,n,r){var o=Om(e),i=function(){return r.clear(t),k.none()};return{keydown:function(e,u,a,c,f,l){var s=e.raw,d=s.which,m=!0===s.shiftKey;return lr(t,r.selectedSelector).fold((function(){return _m(d)&&!m&&r.clearBeforeUpdate(t),Rm(d)&&m?h(xm,o,t,n,Tm,c,u,r.selectRange):Em(d)&&m?h(xm,o,t,n,km,c,u,r.selectRange):Rm(d)?h(ym,o,n,Tm,c,u,wm):Em(d)?h(ym,o,n,km,c,u,Cm):k.none}),(function(e){var n=function(n){return function(){return X(n,(function(n){return function(e,t,n,r,o){return dr(r,e,t,o.firstSelectedSelector,o.lastSelectedSelector).map((function(e){return o.clearBeforeUpdate(n),o.selectRange(n,e.boxes,e.start,e.finish),e.boxes}))}(n.rows,n.cols,t,e,r)})).fold((function(){return sr(t,r.firstSelectedSelector,r.lastSelectedSelector).map((function(e){var n=Rm(d)||l.isForward(d)?Os.after:Os.before;return o.setRelativeSelection(Os.on(e.first,0),n(e.table)),r.clear(t),kd(k.none(),!0)}))}),(function(e){return k.some(kd(k.none(),!0))}))}};return Rm(d)&&m?n([Bm(1,0)]):Em(d)&&m?n([Bm(-1,0)]):l.isBackward(d)&&m?n([Bm(0,-1),Bm(-1,0)]):l.isForward(d)&&m?n([Bm(0,1),Bm(1,0)]):_m(d)&&!m?i:k.none}))()},keyup:function(e,o,i,u,a){return lr(t,r.selectedSelector).fold((function(){var c=e.raw,f=c.which;return!0===c.shiftKey&&_m(f)?function(e,t,n,r,o,i,u){return Ne(n,o)&&r===i?k.none():Et(n,"td,th",t).bind((function(n){return Et(o,"td,th",t).bind((function(r){return _d(e,t,n,r,u)}))}))}(t,n,o,i,u,a,r.selectRange):k.none()}),k.none)}}},Im=function(e,t,n){var r=function(t){Bt(t,e.selected),Bt(t,e.firstSelected),Bt(t,e.lastSelected)},o=function(t){_t(t,e.selected,"1")},i=function(e){u(e),n()},u=function(t){var n=wt(t,e.selectedSelector+","+e.firstSelectedSelector+","+e.lastSelectedSelector);B(n,r)};return{clearBeforeUpdate:u,clear:i,selectRange:function(n,r,u,a){i(n),B(r,o),_t(u,e.firstSelected,"1"),_t(a,e.lastSelected,"1"),t(r,u,a)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},Mm=function(e,t,n){var r=En.fromTable(e);return kc(r,t).map((function(e){var t=yc(r,n,!1);return{upOrLeftCells:function(e,t){var n=e.slice(0,t[t.length-1].row+1),r=Cc(n);return z(r,(function(e){var n=e.cells.slice(0,t[t.length-1].column+1);return O(n,(function(e){return e.element}))}))}(t,e),downOrRightCells:function(e,t){var n=e.slice(t[0].row+t[0].rowspan-1,e.length),r=Cc(n);return z(r,(function(e){var n=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return O(n,(function(e){return e.element}))}))}(t,e)}}))},Fm=tinymce.util.Tools.resolve("tinymce.Env"),jm=function(e){return!1===Ou(xe.fromDom(e.target),"ephox-snooker-resizer-bar")};function Um(e,t,n){var r=Im(Ti,(function(t,r,o){n.targets().each((function(n){un(r).each((function(i){var u=Pa(e),a=si(d,xe.fromDom(e.getDoc()),u),c=Mm(i,n,a);!function(e,t,n,r,o){e.fire("TableSelectionChange",{cells:t,start:n,finish:r,otherCells:o})}(e,t,r,o,c)}))}))}),(function(){return function(e){e.fire("TableSelectionClear")}(e)}));return e.on("init",(function(n){var o=e.getWin(),i=gi(e),u=vi(e),a=Pm(o,i,u,r),c=Lm(o,i,u,r),f=function(e,t,n,r){var o=Om(e);return function(e,i){r.clearBeforeUpdate(t),fr(e,i,n).each((function(e){var n=e.boxes.getOr([]);r.selectRange(t,n,e.start,e.finish),o.selectContents(i),o.collapseSelection()}))}}(o,i,u,r);e.on("TableSelectorChange",(function(e){return f(e.start,e.finish)}));var l,s,m=function(t,n){(function(e){return!0===e.raw.shiftKey})(t)&&(n.kill&&t.kill(),n.selection.each((function(t){var n=Ps.relative(t.start,t.finish),r=qs(o,n);e.selection.setRng(r)})))},g=function(e){return 0===e.button},p=(l=Il(xe.fromDom(i)),s=Il(0),{touchEnd:function(e){var t=xe.fromDom(e.target);if("td"===Ke(t)||"th"===Ke(t)){var n=l.get(),r=s.get();Ne(n,t)&&e.timeStamp-r<300&&(e.preventDefault(),f(t,t))}l.set(t),s.set(e.timeStamp)}});e.on("dragstart",(function(e){a.clearstate()})),e.on("mousedown",(function(e){g(e)&&jm(e)&&a.mousedown(Eu(e))})),e.on("mouseover",(function(e){var t;(void 0===(t=e).buttons||Fm.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&jm(e)&&a.mouseover(Eu(e))})),e.on("mouseup",(function(e){g(e)&&jm(e)&&a.mouseup(Eu(e))})),e.on("touchend",p.touchEnd),e.on("keyup",(function(t){var n=Eu(t);if(n.raw.shiftKey&&_m(n.raw.which)){var r=e.selection.getRng(),o=xe.fromDom(r.startContainer),i=xe.fromDom(r.endContainer);c.keyup(n,o,r.startOffset,i,r.endOffset).each((function(e){m(n,e)}))}})),e.on("keydown",(function(n){var r=Eu(n);t().each((function(e){return e.hideBars()}));var o=e.selection.getRng(),i=xe.fromDom(o.startContainer),u=xe.fromDom(o.endContainer),a=Hr(Dm,Am)(xe.fromDom(e.selection.getStart()));c.keydown(r,i,o.startOffset,u,o.endOffset,a).each((function(e){m(r,e)})),t().each((function(e){return e.showBars()}))})),e.on("NodeChange",(function(){var t=e.selection,n=xe.fromDom(t.getStart()),o=xe.fromDom(t.getEnd());ar(un,[n,o]).fold((function(){return r.clear(i)}),d)}))})),{clear:r.clear}}var zm=function(e,t){var n=Il(k.none()),r=Il([]),o=k.none(),i=tt("caption"),u=function(e){return o.forall((function(t){return!t[e]}))},a=function(){return Ei(function(e){return xe.fromDom(e.selection.getEnd())}(e),vi(e))},c=function(){return Ei(Ci(e),vi(e)).bind((function(e){return Mt(un(e),a().bind(un),(function(n,r){return Ne(n,r)?i(e)?k.some(function(e){return{element:e,mergable:k.none(),unmergable:k.none(),selection:[e]}}(e)):k.some(ki(t,n,e)):k.none()})).bind(g)}))},f=function(e){return un(e.element).map((function(t){var n=En.fromTable(t),r=kc(n,e).getOr([]),o=M(r,(function(e,t){return t.isLocked&&(e.onAny=!0,0===t.column?e.onFirst=!0:t.column+t.colspan>=n.grid.columns&&(e.onLast=!0)),e}),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Rc(n,e).isSome(),unmergeable:_c(n,e).isSome(),locked:o}}))},l=function(){n.set(Q(c)()),o=n.get().bind(f),B(r.get(),(function(e){return e()}))},s=function(e){return e(),r.set(r.get().concat([e])),function(){r.set(L(r.get(),(function(t){return t!==e})))}},d=function(e,t){return s((function(){return n.get().fold((function(){e.setDisabled(!0)}),(function(n){e.setDisabled(t(n))}))}))},m=function(e,t,r){return s((function(){return n.get().fold((function(){e.setDisabled(!0),e.setActive(!1)}),(function(n){e.setDisabled(t(n)),e.setActive(r(n))}))}))},p=function(e){return o.exists((function(t){return t.locked[e]}))},h=function(t,n){return function(r){return m(r,(function(e){return i(e.element)}),(function(){return e.queryCommandValue(t)===n}))}},v=h("mceTableRowType","header"),b=h("mceTableColType","th");return e.on("NodeChange ExecCommand TableSelectorChange",l),{onSetupTable:function(e){return d(e,(function(e){return!1}))},onSetupCellOrRow:function(e){return d(e,(function(e){return i(e.element)}))},onSetupColumn:function(e){return function(t){return d(t,(function(t){return i(t.element)||p(e)}))}},onSetupPasteable:function(e){return function(t){return d(t,(function(t){return i(t.element)||e().isNone()}))}},onSetupPasteableColumn:function(e,t){return function(n){return d(n,(function(n){return i(n.element)||e().isNone()||p(t)}))}},onSetupMergeable:function(e){return d(e,(function(e){return u("mergeable")}))},onSetupUnmergeable:function(e){return d(e,(function(e){return u("unmergeable")}))},resetTargets:l,onSetupTableWithCaption:function(t){return m(t,C,(function(t){return un(t.element,vi(e)).exists((function(e){return kt(e,"caption").isSome()}))}))},onSetupTableRowHeaders:v,onSetupTableColumnHeaders:b,targets:n.get}},Hm=function(e){var t=function(e,t,n){return{get:function(){return mr(e(),n).fold((function(){return t().fold(br,Cr)}),(function(e){return yr(e)}))}}}((function(){return gi(e)}),(function(){return Ri(Ci(e),vi(e))}),Ti.selectedSelector),n=zm(e,t),r=qa(e),o=Um(e,r.lazyResize,n),i=al(e,o,r.lazyWire),u=function(){var e=Fl(),t=Fl();return{getRows:e.get,setRows:function(n){n.fold(e.clear,e.set),t.clear()},clearRows:e.clear,getColumns:t.get,setColumns:function(n){n.fold(t.clear,t.set),e.clear()},clearColumns:t.clear}}();return xs(e,i,0,t,u),function(e,t,n){var r=vi(e),o=function(t){return Ri(Ci(e)).bind((function(e){return un(e,r).map((function(r){var o=ki(n,r,e);return t(r,o)}))})).getOr("")};Oe({mceTableRowType:function(){return o(t.getTableRowType)},mceTableCellType:function(){return o(t.getTableCellType)},mceTableColType:function(){return o(t.getTableColType)}},(function(t,n){return e.addQueryValueHandler(n,t)}))}(e,i,t),Di(e,t,i),function(e,t,n,r){var o=function(t){return function(){return e.execCommand(t)}},i=function(t){e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},u={text:"Table properties",onSetup:n.onSetupTable,onAction:o("mceTableProps")},a={text:"Delete table",icon:"table-delete-table",onSetup:n.onSetupTable,onAction:o("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:o("mceTableInsertRowBefore"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:o("mceTableInsertRowAfter"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:o("mceTableDeleteRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:o("mceTableRowProps"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:n.onSetupPasteable(r.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:n.onSetupPasteable(r.getRows)});var c={type:"nestedmenuitem",text:"Row",getSubmenuItems:m("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")};e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:o("mceTableInsertColBefore"),onSetup:n.onSetupColumn("onFirst")}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:o("mceTableInsertColAfter"),onSetup:n.onSetupColumn("onLast")}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:o("mceTableDeleteCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onLast")});var f={type:"nestedmenuitem",text:"Column",getSubmenuItems:m("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")};e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:o("mceTableCellProps"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:o("mceTableMergeCells"),onSetup:n.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:o("mceTableSplitCells"),onSetup:n.onSetupUnmergeable});var l={type:"nestedmenuitem",text:"Cell",getSubmenuItems:m("tablecellprops tablemergecells tablesplitcells")};!1===function(e){return e.getParam("table_grid",!0,"boolean")}(e)?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:o("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:i}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:o("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",u),e.ui.registry.addMenuItem("deletetable",a),e.ui.registry.addNestedMenuItem("row",c),e.ui.registry.addNestedMenuItem("column",f),e.ui.registry.addNestedMenuItem("cell",l),e.ui.registry.addContextMenu("table",{update:function(){return n.resetTargets(),n.targets().fold(m(""),(function(e){return"caption"===Ke(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}});var s=ql(ka(e));0!==s.length&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:function(){return Hl(e,t,s,"tableclass",(function(t){return e.execCommand("mceTableToggleClass",!1,t)}))},onSetup:n.onSetupTable});var d=ql(Ta(e));0!==d.length&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:function(){return Hl(e,t,d,"tablecellclass",(function(t){return e.execCommand("mceTableCellToggleClass",!1,t)}))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:function(){return Hl(e,t,Tl,"tablecellverticalalign",Vl(e,"vertical-align"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:function(){return Hl(e,t,ha(e),"tablecellborderwidth",Vl(e,"border-width"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:function(){return Hl(e,t,va(e),"tablecellborderstyle",Vl(e,"border-style"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablecaption",{icon:"table-caption",text:"Table caption",onAction:o("mceTableToggleCaption"),onSetup:n.onSetupTableWithCaption}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:function(){return $l(e,La(e),"background-color")},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:function(){return $l(e,Ia(e),"border-color")},onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablerowheader",{text:"Row header",icon:"table-top-header",onAction:Kl(e),onSetup:n.onSetupTableRowHeaders}),e.ui.registry.addToggleMenuItem("tablecolheader",{text:"Column header",icon:"table-left-header",onAction:Xl(e),onSetup:n.onSetupTableColumnHeaders})}(e,t,n,u),function(e,t,n,r){e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}});var o=function(t){return function(){return e.execCommand(t)}};e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:o("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:o("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:o("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:o("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:o("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:o("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:o("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:o("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:o("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:o("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupColumn("onFirst")}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:o("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupColumn("onLast")}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:o("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:n.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:n.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onLast")}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:o("mceInsertTable"),icon:"table"});var i=ql(ka(e));0!==i.length&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:Wl(e,t,i,"tableclass",(function(t){return e.execCommand("mceTableToggleClass",!1,t)})),onSetup:n.onSetupTable});var u=ql(Ta(e));0!==u.length&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:Wl(e,t,u,"tablecellclass",(function(t){return e.execCommand("mceTableCellToggleClass",!1,t)})),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:Wl(e,t,Tl,"tablecellverticalalign",Vl(e,"vertical-align")),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:Wl(e,t,ha(e),"tablecellborderwidth",Vl(e,"border-width")),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:Wl(e,t,va(e),"tablecellborderstyle",Vl(e,"border-style")),onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablecaption",{tooltip:"Table caption",onAction:o("mceTableToggleCaption"),icon:"table-caption",onSetup:n.onSetupTableWithCaption}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:function(t){return t($l(e,La(e),"background-color"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:function(t){return t($l(e,Ia(e),"border-color"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablerowheader",{tooltip:"Row header",icon:"table-top-header",onAction:Kl(e),onSetup:n.onSetupTableRowHeaders}),e.ui.registry.addToggleButton("tablecolheader",{tooltip:"Column header",icon:"table-left-header",onAction:Xl(e),onSetup:n.onSetupTableColumnHeaders})}(e,t,n,u),function(e){var t=function(e){return e.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(e);t.length>0&&e.ui.registry.addContextToolbar("table",{predicate:function(t){return e.dom.is(t,"table")&&e.getBody().contains(t)},items:t,scope:"node",position:"node"})}(e),e.on("PreInit",(function(){e.serializer.addTempAttr(Ti.firstSelected),e.serializer.addTempAttr(Ti.lastSelected),function(e){e.formatter.register(ks)}(e)})),function(e){return e.getParam("table_tab_navigation",!0,"boolean")}(e)&&e.on("keydown",(function(t){!function(e,t,n){if(e.keyCode===Cd.TAB){var r=gi(t),o=function(e){var t=Ke(e);return Ne(e,r)||_(Td,t)},i=t.selection.getRng(),u=xe.fromDom(e.shiftKey?i.startContainer:i.endContainer);nn(u,o).each((function(r){e.preventDefault(),un(r,o).each(n.clear),t.selection.collapse(e.shiftKey),(e.shiftKey?xd:wd)(t,o,r).each((function(e){t.selection.setRng(e)}))}))}}(t,e,o)})),e.on("remove",(function(){r.destroy()})),function(e,t,n,r){return{insertTable:hl(e),setClipboardRows:pl(t.setRows),getClipboardRows:gl(t.getRows),setClipboardCols:pl(t.setColumns),getClipboardCols:gl(t.getColumns),resizeHandler:n,selectionTargets:r}}(e,u,r,n)};wr.add("table",Hm)}()},function(e,t,n){n(45)},function(e,t){!function(){"use strict";var e,t,n=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},o=function(e){return function(t){return typeof t===e}},i=r("string"),u=r("object"),a=r("array"),c=o("boolean"),f=o("function"),l=o("number"),s=function(){},d=function(e){return function(){return e}},m=function(e){return e},g=function(e,t){return e===t},p=function(e){return function(t){return!e(t)}},h=d(!1),v=d(!0),b=function(){return y},y={fold:function(e,t){return e()},isSome:h,isNone:v,getOr:t=m,getOrThunk:e=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:d(null),getOrUndefined:d(void 0),or:t,orThunk:e,map:b,each:s,bind:b,exists:h,forall:v,filter:function(){return b()},toArray:function(){return[]},toString:d("none()")},C=function(e){var t=d(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},isSome:v,isNone:h,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return C(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:y},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},w={some:C,none:b,from:function(e){return null==e?y:C(e)}},x=Array.prototype.slice,S=Array.prototype.push,T=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},k=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},N=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},E=function(e,t,n){return k(e,(function(e,r){n=t(n,e,r)})),n},R=function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return w.some(i);if(n(i,r))break}return w.none()},_=function(e,t){return R(e,t,h)},D=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!a(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);S.apply(t,e[n])}return t}(T(e,t))},A=function(e){var t=x.call(e,0);return t.reverse(),t},O=function(e,t){return t>=0&&t<e.length?w.some(e[t]):w.none()},B=function(e){return O(e,0)},P=function(e){return O(e,e.length-1)},L=function(){return(L=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var I,M=function(){return F(0,0)},F=function(e,t){return{major:e,minor:t}},j={nu:F,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?M():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return F(r(1),r(2))}(e,n)},unknown:M},U=function(e,t){return function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return w.none()}(t.brands,(function(t){var n=t.brand.toLowerCase();return _(e,(function(e){var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return{current:e.name,version:j.nu(parseInt(t.version,10),0)}}))}))},z=function(e,t){var n=String(t).toLowerCase();return _(e,(function(e){return e.search(n)}))},H=function(e,t){return-1!==e.indexOf(t)},V=(I=/^\s+|\s+$/g,function(e){return e.replace(I,"")}),q=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,W=function(e){return function(t){return H(t,e)}},$=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return H(e,"edge/")&&H(e,"chrome")&&H(e,"safari")&&H(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,q],search:function(e){return H(e,"chrome")&&!H(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return H(e,"msie")||H(e,"trident")}},{name:"Opera",versionRegexes:[q,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:W("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:W("firefox")},{name:"Safari",versionRegexes:[q,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(H(e,"safari")||H(e,"mobile/"))&&H(e,"applewebkit")}}],K=[{name:"Windows",search:W("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return H(e,"iphone")||H(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:W("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:W("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:W("linux"),versionRegexes:[]},{name:"Solaris",search:W("sunos"),versionRegexes:[]},{name:"FreeBSD",search:W("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:W("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],X={browsers:d($),oses:d(K)},G=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},Y={unknown:function(){return G({current:void 0,version:j.unknown()})},nu:G,edge:d("Edge"),chrome:d("Chrome"),ie:d("IE"),opera:d("Opera"),firefox:d("Firefox"),safari:d("Safari")},Q=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},J={unknown:function(){return Q({current:void 0,version:j.unknown()})},nu:Q,windows:d("Windows"),ios:d("iOS"),android:d("Android"),linux:d("Linux"),osx:d("OSX"),solaris:d("Solaris"),freebsd:d("FreeBSD"),chromeos:d("ChromeOS")},Z=function(e,t,n){var r=X.browsers(),o=X.oses(),i=t.bind((function(e){return U(r,e)})).orThunk((function(){return function(e,t){return z(e,t).map((function(e){var n=j.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(r,e)})).fold(Y.unknown,Y.nu),u=function(e,t){return z(e,t).map((function(e){var n=j.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(o,e).fold(J.unknown,J.nu),a=function(e,t,n,r){var o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,u=e.isiOS()||e.isAndroid(),a=u||r("(pointer:coarse)"),c=o||!i&&u&&r("(min-device-width:768px)"),f=i||u&&!c,l=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),s=!f&&!c&&!l;return{isiPad:d(o),isiPhone:d(i),isTablet:d(c),isPhone:d(f),isTouch:d(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:d(l),isDesktop:d(s)}}(u,i,e,n);return{browser:i,os:u,deviceType:a}},ee=function(e){return window.matchMedia(e).matches},te=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}}((function(){return Z(navigator.userAgent,w.from(navigator.userAgentData),ee)})),ne=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},re={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return ne(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return ne(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return ne(n)},fromDom:ne,fromPoint:function(e,t,n){return w.from(e.dom.elementFromPoint(t,n)).map(ne)}},oe=function(e,t){return e.dom===t.dom},ie=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},ue=function(e,t){return te().browser.isIE()?ie(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)},ae=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ce=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),fe=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),le=tinymce.util.Tools.resolve("tinymce.util.VK"),se=Object.keys,de=function(e,t){for(var n=se(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},me=function(e,t){var n={};return function(e,t,n,r){de(e,(function(e,o){(t(e,o)?n:r)(e,o)}))}(e,t,function(e){return function(t,n){e[n]=t}}(n),s),n};"undefined"!=typeof window?window:Function("return this;")();var ge,pe=function(e){return e.dom.nodeName.toLowerCase()},he=(ge=1,function(e){return function(e){return e.dom.nodeType}(e)===ge}),ve=function(e){return function(t){return he(t)&&pe(t)===e}},be=function(e,t){var n=e.dom;de(t,(function(e,t){!function(e,t,n){if(!(i(n)||c(n)||l(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}(n,t,e)}))},ye=function(e){return E(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})},Ce=function(e){return w.from(e.dom.parentNode).map(re.fromDom)},we=function(e){return T(e.dom.childNodes,re.fromDom)},xe=function(e,t){var n=e.dom.childNodes;return w.from(n[t]).map(re.fromDom)},Se=function(e){return xe(e,0)},Te=function(e){return xe(e,e.dom.childNodes.length-1)},ke=function(e,t){Ce(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},Ne=function(e,t){e.dom.appendChild(t.dom)},Ee=function(e,t){k(t,(function(t){Ne(e,t)}))},Re=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},_e=function(e){return function(e,t){return re.fromDom(e.dom.cloneNode(t))}(e,!0)},De=function(e,t){var n=function(e,t){var n=re.fromTag(t),r=ye(e);return be(n,r),n}(e,t);ke(e,n);var r=we(e);return Ee(n,r),Re(e),n},Ae=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Oe=tinymce.util.Tools.resolve("tinymce.util.Tools"),Be=function(e){return function(t){return t&&t.nodeName.toLowerCase()===e}},Pe=function(e){return function(t){return t&&e.test(t.nodeName)}},Le=function(e){return e&&3===e.nodeType},Ie=Pe(/^(OL|UL|DL)$/),Me=Pe(/^(OL|UL)$/),Fe=Be("ol"),je=Pe(/^(LI|DT|DD)$/),Ue=Pe(/^(DT|DD)$/),ze=Pe(/^(TH|TD)$/),He=Be("br"),Ve=function(e,t){return t&&!!e.schema.getTextBlockElements()[t.nodeName]},qe=function(e,t){return e&&e.nodeName in t},We=function(e,t,n){var r=e.isEmpty(t);return!(n&&e.select("span[data-mce-type=bookmark]",t).length>0)&&r},$e=function(e,t){return e.isChildOf(t,e.getRoot())},Ke=function(e,t){var n,r,o,i=e.dom,u=e.schema.getBlockElements(),a=i.createFragment(),c=function(e){var t=e.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t}(e);if(c&&((r=i.create(c)).tagName===c.toUpperCase()&&i.setAttribs(r,function(e){return e.getParam("forced_root_block_attrs",{})}(e)),qe(t.firstChild,u)||a.appendChild(r)),t)for(;n=t.firstChild;){var f=n.nodeName;o||"SPAN"===f&&"bookmark"===n.getAttribute("data-mce-type")||(o=!0),qe(n,u)?(a.appendChild(n),r=null):c?(r||(r=i.create(c),a.appendChild(r)),r.appendChild(n)):a.appendChild(n)}return c?o||r.appendChild(i.create("br",{"data-mce-bogus":"1"})):a.appendChild(i.create("br")),a},Xe=Ae.DOM,Ge=ve("dd"),Ye=ve("dt"),Qe=function(e,t){Ge(t)?De(t,"dt"):Ye(t)&&Ce(t).each((function(n){return function(e,t,n){var r=Xe.select('span[data-mce-type="bookmark"]',t),o=Ke(e,n),i=Xe.createRng();i.setStartAfter(n),i.setEndAfter(t);for(var u,a=i.extractContents(),c=a.firstChild;c;c=c.firstChild)if("LI"===c.nodeName&&e.dom.isEmpty(c)){Xe.remove(c);break}e.dom.isEmpty(a)||Xe.insertAfter(a,t),Xe.insertAfter(o,t),We(e.dom,n.parentNode)&&(u=n.parentNode,Oe.each(r,(function(e){u.parentNode.insertBefore(e,n.parentNode)})),Xe.remove(u)),Xe.remove(n),We(e.dom,t)&&Xe.remove(t)}(e,n.dom,t.dom)}))},Je=function(e){Ye(e)&&De(e,"dd")},Ze=function(e,t){if(Le(e))return{container:e,offset:t};var n=ce.getNode(e,t);return Le(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:n.previousSibling&&Le(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&Le(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:e,offset:t}},et=function(e){var t=e.cloneRange(),n=Ze(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);var r=Ze(e.endContainer,e.endOffset);return t.setEnd(r.container,r.offset),t},tt=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),nt=function(e,t){var n=t||e.selection.getStart(!0);return e.dom.getParent(n,"OL,UL,DL",it(e,n))},rt=function(e){var t=nt(e),n=e.selection.getSelectedBlocks();return function(e,t){return e&&1===t.length&&t[0]===e}(t,n)?function(e){return N(e.querySelectorAll("ol,ul,dl"),Ie)}(t):N(n,(function(e){return Ie(e)&&t!==e}))},ot=function(e){var t=e.selection.getSelectedBlocks();return N(function(e,t){var n=Oe.map(t,(function(t){var n=e.dom.getParent(t,"li,dd,dt",it(e,t));return n||t}));return tt.unique(n)}(e,t),je)},it=function(e,t){var n=e.dom.getParents(t,"TD,TH");return n.length>0?n[0]:e.getBody()},ut=function(e,t){var n=e.dom.getParents(t,"ol,ul",it(e,t));return P(n)},at=function(e){var t=function(e){var t=ut(e,e.selection.getStart()),n=N(e.selection.getSelectedBlocks(),Me);return t.toArray().concat(n)}(e);return ct(e,t)},ct=function(e,t){var n=T(t,(function(t){return ut(e,t).getOr(t)}));return tt.unique(n)},ft=function(e,t,n){return void 0===n&&(n=g),e.exists((function(e){return n(e,t)}))},lt=function(e,t,n){return e.isSome()&&t.isSome()?w.some(n(e.getOrDie(),t.getOrDie())):w.none()},st=function(e,t,n){return e.fire("ListMutation",{action:t,element:n})},dt=function(e,t,n){if(!i(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);(function(e){return void 0!==e.style&&f(e.style.getPropertyValue)})(e)&&e.style.setProperty(t,n)},mt=function(e,t){Ne(e.item,t.list)},gt=function(e,t){var n={list:re.fromTag(t,e),item:re.fromTag("li",e)};return Ne(n.list,n.item),n},pt=function(e,t,n){var r=t.slice(0,n.depth);return P(r).each((function(t){!function(e,t){Ne(e.list,t),e.item=t}(t,function(e,t,n){var r=re.fromTag("li",e);return be(r,t),Ee(r,n),r}(e,n.itemAttributes,n.content)),function(e,t){pe(e.list)!==t.listType&&(e.list=De(e.list,t.listType)),be(e.list,t.listAttributes)}(t,n)})),r},ht=function(e,t,n){var r,o=function(e,t,n){for(var r=[],o=0;o<n;o++)r.push(gt(e,t.listType));return r}(e,n,n.depth-t.length);return function(e){for(var t=1;t<e.length;t++)mt(e[t-1],e[t])}(o),function(e,t){for(var n=0;n<e.length-1;n++)r=e[n].item,o="list-style-type",i="none",u=void 0,u=r.dom,dt(u,o,i);var r,o,i,u;P(e).each((function(e){be(e.list,t.listAttributes),be(e.item,t.itemAttributes),Ee(e.item,t.content)}))}(o,n),r=o,lt(P(t),B(r),mt),t.concat(o)},vt=function(e){return ae(e,"OL,UL")},bt=function(e){return Se(e).exists(vt)},yt=function(e){return e.depth>0},Ct=function(e){return e.isSelected},wt=function(e){var t=we(e),n=Te(e).exists(vt)?t.slice(0,-1):t;return T(n,_e)},xt=function(e){return k(e,(function(t,n){(function(e,t){var n=e[t].depth,r=function(e){return e.depth===n&&!e.dirty},o=function(e){return e.depth<n};return R(A(e.slice(0,t)),r,o).orThunk((function(){return R(e.slice(t+1),r,o)}))})(e,n).fold((function(){t.dirty&&function(e){e.listAttributes=me(e.listAttributes,(function(e,t){return"start"!==t}))}(t)}),(function(e){return r=e,(n=t).listType=r.listType,void(n.listAttributes=L({},r.listAttributes));var n,r}))})),e},St=function(e,t,n,r){return Se(r).filter(vt).fold((function(){t.each((function(e){oe(e.start,r)&&n.set(!0)}));var o=function(e,t,n){return Ce(e).filter(he).map((function(r){return{depth:t,dirty:!1,isSelected:n,content:wt(e),itemAttributes:ye(e),listAttributes:ye(r),listType:pe(r)}}))}(r,e,n.get());t.each((function(e){oe(e.end,r)&&n.set(!1)}));var i=Te(r).filter(vt).map((function(r){return Tt(e,t,n,r)})).getOr([]);return o.toArray().concat(i)}),(function(r){return Tt(e,t,n,r)}))},Tt=function(e,t,n,r){return D(we(r),(function(r){return(vt(r)?Tt:St)(e+1,t,n,r)}))},kt=function(e,t){var n=xt(t);return T(n,(function(t){var n,r,o,i=(n=t.content,o=(r||document).createDocumentFragment(),k(n,(function(e){o.appendChild(e.dom)})),re.fromDom(o));return re.fromDom(Ke(e,i.dom))}))},Nt=function(e,t){var n=xt(t);return function(e,t){var n=E(t,(function(t,n){return n.depth>t.length?ht(e,t,n):pt(e,t,n)}),[]);return B(n).map((function(e){return e.list}))}(e.contentDocument,n).toArray()},Et=function(e,t,n){var r=function(e,t){var n,r=(n=!1,{get:function(){return n},set:function(e){n=e}});return T(e,(function(e){return{sourceList:e,entries:Tt(0,t,r,e)}}))}(t,function(e){var t=T(ot(e),re.fromDom);return lt(_(t,p(bt)),_(A(t),p(bt)),(function(e,t){return{start:e,end:t}}))}(e));k(r,(function(t){!function(e,t){k(N(e,Ct),(function(e){return function(e,t){switch(e){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}t.dirty=!0}(t,e)}))}(t.entries,n);var r,o=function(e,t){return D(function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,u=e.length;i<u;i++){var a=e[i],c=t(a);c!==n&&(r.push(o),o=[]),n=c,o.push(a)}return 0!==o.length&&r.push(o),r}(t,yt),(function(t){return B(t).exists(yt)?Nt(e,t):kt(e,t)}))}(e,t.entries);k(o,(function(t){st(e,"Indent"===n?"IndentList":"OutdentList",t.dom)})),r=t.sourceList,k(o,(function(e){ke(r,e)})),Re(t.sourceList)}))},Rt=function(e,t){var n=T(at(e),re.fromDom),r=T(function(e){return N(ot(e),Ue)}(e),re.fromDom),o=!1;if(n.length||r.length){var i=e.selection.getBookmark();Et(e,n,t),function(e,t,n){k(n,"Indent"===t?Je:function(t){return Qe(e,t)})}(e,t,r),e.selection.moveToBookmark(i),e.selection.setRng(et(e.selection.getRng())),e.nodeChanged(),o=!0}return o},_t=function(e){return Rt(e,"Indent")},Dt=function(e){return Rt(e,"Outdent")},At=function(e){return Rt(e,"Flatten")},Ot=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),Bt=Ae.DOM,Pt=function(e){var t={},n=function(n){var r=e[n?"startContainer":"endContainer"],o=e[n?"startOffset":"endOffset"];if(1===r.nodeType){var i=Bt.create("span",{"data-mce-type":"bookmark"});r.hasChildNodes()?(o=Math.min(o,r.childNodes.length-1),n?r.insertBefore(i,r.childNodes[o]):Bt.insertAfter(i,r.childNodes[o])):r.appendChild(i),r=i,o=0}t[n?"startContainer":"endContainer"]=r,t[n?"startOffset":"endOffset"]=o};return n(!0),e.collapsed||n(),t},Lt=function(e){var t=function(t){var n,r=n=e[t?"startContainer":"endContainer"],o=e[t?"startOffset":"endOffset"];r&&(1===r.nodeType&&(o=function(e){for(var t=e.parentNode.firstChild,n=0;t;){if(t===e)return n;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||n++,t=t.nextSibling}return-1}(r),r=r.parentNode,Bt.remove(n),!r.hasChildNodes()&&Bt.isBlock(r)&&r.appendChild(Bt.create("br"))),e[t?"startContainer":"endContainer"]=r,e[t?"startOffset":"endOffset"]=o)};t(!0),t();var n=Bt.createRng();return n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),et(n)},It=function(e){switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},Mt=function(e){return/\btox\-/.test(e.className)},Ft=function(e,t,n){var r=function(e){var r=R(e.parents,Ie,ze).filter((function(e){return e.nodeName===t&&!Mt(e)})).isSome();n(r)},o=e.dom.getParents(e.selection.getNode());return r({parents:o}),e.on("NodeChange",r),function(){return e.off("NodeChange",r)}},jt=function(e,t){Oe.each(t,(function(t,n){e.setAttribute(n,t)}))},Ut=function(e,t,n){!function(e,t,n){var r=n["list-style-type"]?n["list-style-type"]:null;e.setStyle(t,"list-style-type",r)}(e,t,n),function(e,t,n){jt(t,n["list-attributes"]),Oe.each(e.select("li",t),(function(e){jt(e,n["list-item-attributes"])}))}(e,t,n)},zt=function(e,t,n,r){var o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"];for(1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&He(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(Ve(e,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},Ht=function(e,t,n){var r=e.selection.getRng(),o="LI",i=it(e,e.selection.getStart(!0)),u=e.dom;if("false"!==u.getContentEditable(e.selection.getNode())){"DL"===(t=t.toUpperCase())&&(o="DT");var a=Pt(r),c=function(e,t,n){for(var r,o=[],i=e.dom,u=zt(e,t,!0,n),a=zt(e,t,!1,n),c=[],f=u;f&&(c.push(f),f!==a);f=f.nextSibling);return Oe.each(c,(function(t){if(Ve(e,t))return o.push(t),void(r=null);if(i.isBlock(t)||He(t))return He(t)&&i.remove(t),void(r=null);var u=t.nextSibling;Ot.isBookmarkNode(t)&&(Ie(u)||Ve(e,u)||!u&&t.parentNode===n)?r=null:(r||(r=i.create("p"),t.parentNode.insertBefore(r,t),o.push(r)),r.appendChild(t))})),o}(e,r,i);Oe.each(c,(function(r){var i,a=r.previousSibling,c=r.parentNode;je(c)||(a&&Ie(a)&&a.nodeName===t&&function(e,t,n){var r=e.getStyle(t,"list-style-type"),o=n?n["list-style-type"]:"";return r===(o=null===o?"":o)}(u,a,n)?(i=a,r=u.rename(r,o),a.appendChild(r)):(i=u.create(t),r.parentNode.insertBefore(i,r),i.appendChild(r),r=u.rename(r,o)),function(e,t,n){Oe.each(n,(function(n){var r;return e.setStyle(t,((r={})[n]="",r))}))}(u,r,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),Ut(u,i,n),qt(e.dom,i))})),e.selection.setRng(Lt(a))}},Vt=function(e,t,n){return function(e,t){return e&&t&&Ie(e)&&e.nodeName===t.nodeName}(t,n)&&function(e,t,n){return e.getStyle(t,"list-style-type",!0)===e.getStyle(n,"list-style-type",!0)}(e,t,n)&&(r=n,t.className===r.className);var r},qt=function(e,t){var n,r;if(n=t.nextSibling,Vt(e,t,n)){for(;r=n.firstChild;)t.appendChild(r);e.remove(n)}if(n=t.previousSibling,Vt(e,t,n)){for(;r=n.lastChild;)t.insertBefore(r,t.firstChild);e.remove(n)}},Wt=function(e,t,n,r,o){var i=Ie(t);if(i&&t.nodeName===r&&!$t(o))At(e);else{Ht(e,r,o);var u=Pt(e.selection.getRng()),a=i?function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([t],n,!0):n;Oe.each(a,(function(t){!function(e,t,n,r){if(t.nodeName!==n){var o=e.dom.rename(t,n);Ut(e.dom,o,r),st(e,It(n),o)}else Ut(e.dom,t,r),st(e,It(n),t)}(e,t,r,o)})),e.selection.setRng(Lt(u))}},$t=function(e){return"list-style-type"in e},Kt=function(e,t,n){var r=nt(e),o=rt(e),i=u(n)?n:{};o.length>0?Wt(e,r,o,t,i):function(e,t,n,r){if(t!==e.getBody())if(t)if(t.nodeName!==n||$t(r)||Mt(t)){var o=Pt(e.selection.getRng());Ut(e.dom,t,r);var i=e.dom.rename(t,n);qt(e.dom,i),e.selection.setRng(Lt(o)),Ht(e,n,r),st(e,It(n),i)}else At(e);else Ht(e,n,r),st(e,It(n),t)}(e,r,t,i)},Xt=Ae.DOM,Gt=function(e,t){var n=Oe.grep(e.select("ol,ul",t));Oe.each(n,(function(t){!function(e,t){var n,r=t.parentNode;"LI"===r.nodeName&&r.firstChild===t&&((n=r.previousSibling)&&"LI"===n.nodeName?(n.appendChild(t),We(e,r)&&Xt.remove(r)):Xt.setStyle(r,"listStyleType","none"));Ie(r)&&((n=r.previousSibling)&&"LI"===n.nodeName&&n.appendChild(t))}(e,t)}))},Yt=function(e,t,n,r){var o=t.startContainer,i=t.startOffset;if(Le(o)&&(n?i<o.data.length:i>0))return o;var u=e.schema.getNonEmptyElements();1===o.nodeType&&(o=ce.getNode(o,i));var a=new fe(o,r);for(n&&function(e,t){return!!He(t)&&(e.isBlock(t.nextSibling)&&!He(t.previousSibling))}(e.dom,o)&&a.next();o=a[n?"next":"prev2"]();){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(u[o.nodeName])return o;if(Le(o)&&o.data.length>0)return o}},Qt=function(e,t){var n=t.childNodes;return 1===n.length&&!Ie(n[0])&&e.isBlock(n[0])},Jt=function(e,t,n){var r,o=Qt(e,n)?n.firstChild:n;if(function(e,t){Qt(e,t)&&e.remove(t.firstChild,!0)}(e,t),!We(e,t,!0))for(;r=t.firstChild;)o.appendChild(r)},Zt=function(e,t,n){var r,o=t.parentNode;if($e(e,t)&&$e(e,n)){Ie(n.lastChild)&&(r=n.lastChild),o===n.lastChild&&He(o.previousSibling)&&e.remove(o.previousSibling);var i=n.lastChild;i&&He(i)&&t.hasChildNodes()&&e.remove(i),We(e,n,!0)&&e.$(n).empty(),Jt(e,t,n),r&&n.appendChild(r);var u=ue(re.fromDom(n),re.fromDom(t))?e.getParents(t,Ie,n):[];e.remove(t),k(u,(function(t){We(e,t)&&t!==e.getRoot()&&e.remove(t)}))}},en=function(e,t,n,r){var o=e.dom;if(o.isEmpty(r))!function(e,t,n){e.dom.$(n).empty(),Zt(e.dom,t,n),e.selection.setCursorLocation(n,0)}(e,n,r);else{var i=Pt(t);Zt(o,n,r),e.selection.setRng(Lt(i))}},tn=function(e,t){var n=e.dom,r=e.selection,o=r.getStart(),i=it(e,o),u=n.getParent(r.getStart(),"LI",i);if(u){var a=u.parentNode;if(a===e.getBody()&&We(n,a))return!0;var c=et(r.getRng()),f=n.getParent(Yt(e,c,t,i),"LI",i);if(f&&f!==u)return e.undoManager.transact((function(){var n;t?en(e,c,f,u):(n=u).parentNode.firstChild===n?Dt(e):function(e,t,n,r){var o=Pt(t);Zt(e.dom,n,r);var i=Lt(o);e.selection.setRng(i)}(e,c,u,f)})),!0;if(!f&&!t&&0===c.startOffset&&0===c.endOffset)return e.undoManager.transact((function(){At(e)})),!0}return!1},nn=function(e,t){return tn(e,t)||function(e,t){var n=e.dom,r=e.selection.getStart(),o=it(e,r),i=n.getParent(r,n.isBlock,o);if(i&&n.isEmpty(i)){var u=et(e.selection.getRng()),a=n.getParent(Yt(e,u,t,o),"LI",o);if(a)return e.undoManager.transact((function(){!function(e,t,n){var r=e.getParent(t.parentNode,e.isBlock,n);e.remove(t),r&&e.isEmpty(r)&&e.remove(r)}(n,i,o),qt(n,a.parentNode),e.selection.select(a,!0),e.selection.collapse(t)})),!0}return!1}(e,t)},rn=function(e,t){return e.selection.isCollapsed()?nn(e,t):function(e){var t=e.selection.getStart(),n=it(e,t);return!!(e.dom.getParent(t,"LI,DT,DD",n)||ot(e).length>0)&&(e.undoManager.transact((function(){e.execCommand("Delete"),Gt(e.dom,e.getBody())})),!0)}(e)},on=function(e){var t=A(V(e).split("")),n=T(t,(function(e,t){var n=e.toUpperCase().charCodeAt(0)-"A".charCodeAt(0)+1;return Math.pow(26,t)*n}));return E(n,(function(e,t){return e+t}),0)},un=function(e){if(--e<0)return"";var t=e%26,n=Math.floor(e/26);return un(n)+String.fromCharCode("A".charCodeAt(0)+t)},an=function(e){var t,n,r=nt(e);Fe(r)&&e.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:(t={start:e.dom.getAttrib(r,"start","1"),listStyleType:w.some(e.dom.getStyle(r,"list-style-type"))},n=parseInt(t.start,10),ft(t.listStyleType,"upper-alpha")?un(n):ft(t.listStyleType,"lower-alpha")?un(n).toLowerCase():t.start)},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:function(t){(function(e){switch(function(e){return/^[0-9]+$/.test(e)?2:function(e){return/^[A-Z]+$/.test(e)}(e)?0:function(e){return/^[a-z]+$/.test(e)}(e)?1:function(e){return e.length>0}(e)?4:3}(e)){case 2:return w.some({listStyleType:w.none(),start:e});case 0:return w.some({listStyleType:w.some("upper-alpha"),start:on(e).toString()});case 1:return w.some({listStyleType:w.some("lower-alpha"),start:on(e).toString()});case 3:return w.some({listStyleType:w.none(),start:""});case 4:return w.none()}})(t.getData().start).each((function(t){e.execCommand("mceListUpdate",!1,{attrs:{start:"1"===t.start?"":t.start},styles:{"list-style-type":t.listStyleType.getOr("")}})})),t.close()}})},cn=function(e,t){return function(){var n=nt(e);return n&&n.nodeName===t}},fn=function(e){e.addCommand("mceListProps",(function(){an(e)}))},ln=function(e){e.on("BeforeExecCommand",(function(t){var n=t.command.toLowerCase();"indent"===n?_t(e):"outdent"===n&&Dt(e)})),e.addCommand("InsertUnorderedList",(function(t,n){Kt(e,"UL",n)})),e.addCommand("InsertOrderedList",(function(t,n){Kt(e,"OL",n)})),e.addCommand("InsertDefinitionList",(function(t,n){Kt(e,"DL",n)})),e.addCommand("RemoveList",(function(){At(e)})),fn(e),e.addCommand("mceListUpdate",(function(t,n){u(n)&&function(e,t){var n=nt(e);e.undoManager.transact((function(){u(t.styles)&&e.dom.setStyles(n,t.styles),u(t.attrs)&&de(t.attrs,(function(t,r){return e.dom.setAttrib(n,r,t)}))}))}(e,n)})),e.addQueryStateHandler("InsertUnorderedList",cn(e,"UL")),e.addQueryStateHandler("InsertOrderedList",cn(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",cn(e,"DL"))},sn=function(e){(function(e){return e.getParam("lists_indent_on_tab",!0)})(e)&&function(e){e.on("keydown",(function(t){t.keyCode!==le.TAB||le.metaKeyPressed(t)||e.undoManager.transact((function(){(t.shiftKey?Dt(e):_t(e))&&t.preventDefault()}))}))}(e),function(e){e.on("keydown",(function(t){t.keyCode===le.BACKSPACE?rn(e,!1)&&t.preventDefault():t.keyCode===le.DELETE&&rn(e,!0)&&t.preventDefault()}))}(e)};n.add("lists",(function(e){return!1===e.hasPlugin("rtc",!0)?(sn(e),ln(e)):fn(e),function(e){var t=function(t){return function(){return e.execCommand(t)}};e.hasPlugin("advlist")||(e.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:function(t){return Ft(e,"OL",t.setActive)}}),e.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:function(t){return Ft(e,"UL",t.setActive)}}))}(e),function(e){var t={text:"List properties...",icon:"ordered-list",onAction:function(){return e.execCommand("mceListProps")},onSetup:function(t){return Ft(e,"OL",(function(e){return t.setDisabled(!e)}))}};e.ui.registry.addMenuItem("listprops",t),e.ui.registry.addContextMenu("lists",{update:function(t){var n=nt(e,t);return Fe(n)?["listprops"]:[]}})}(e),function(e){return{backspaceDelete:function(t){rn(e,t)}}}(e)}))}()},function(e,t,n){n(47)},function(e,t){!function(){"use strict";var e,t,n,r,o,i=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},u=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=(e="array",function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}),c=function(e){return!function(e){return null==e}(e)},f=function(e){return function(t){return typeof t===e}}("function"),l=function(){},s=function(e){return function(){return e}},d=function(e){return e},m=s(!1),g=s(!0),p=function(){return h},h={fold:function(e,t){return e()},isSome:m,isNone:g,getOr:n=d,getOrThunk:t=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:s(null),getOrUndefined:s(void 0),or:n,orThunk:t,map:p,each:l,bind:p,exists:m,forall:g,filter:function(){return p()},toArray:function(){return[]},toString:s("none()")},v=function(e){var t=s(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},isSome:g,isNone:m,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return v(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:h},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},b={some:v,none:p,from:function(e){return null==e?h:v(e)}},y=Array.prototype.slice,C=Array.prototype.push,w=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},x=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},S=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},T=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!a(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);C.apply(t,e[n])}return t}(x(e,t))},k=f(Array.from)?Array.from:function(e){return y.call(e)},N=function(){return(N=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},E=function(){var e=function(e){var t=i(b.none()),n=function(){return t.get().each(e)};return{clear:function(){n(),t.set(b.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){n(),t.set(b.some(e))}}}(l);return N(N({},e),{on:function(t){return e.get().each(t)}})},R=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},_=tinymce.util.Tools.resolve("tinymce.Env"),D=tinymce.util.Tools.resolve("tinymce.util.Delay"),A=tinymce.util.Tools.resolve("tinymce.util.Promise"),O=tinymce.util.Tools.resolve("tinymce.util.VK"),B=function(e,t){return e.fire("PastePlainTextToggle",{state:t})},P=tinymce.util.Tools.resolve("tinymce.util.Tools"),L=function(e){return e.getParam("paste_data_images",!1)},I=function(e){return e.getParam("paste_merge_formats",!0)},M=function(e){return e.getParam("paste_retain_style_properties")},F=function(e){return e.getParam("validate")},j=function(e){return e.getParam("allow_html_data_urls",!1,"boolean")},U=function(e){return e.getParam("paste_data_images",!1,"boolean")},z=function(e){return P.explode(e.getParam("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"))},H=function(e){return-1!==e.indexOf("\x3c!-- x-tinymce/html --\x3e")},V=s("x-tinymce/html"),q=Object.hasOwnProperty,W=function(e,t){return q.call(e,t)},$=tinymce.util.Tools.resolve("tinymce.html.Entities"),K=function(e,t,n){var r=e.split(/\n\n/),o=function(e,t){var n=[],r="<"+e;if("object"==typeof t){for(var o in t)W(t,o)&&n.push(o+'="'+$.encodeAllRaw(t[o])+'"');n.length&&(r+=" "+n.join(" "))}return r+">"}(t,n),i="</"+t+">",u=P.map(r,(function(e){return e.split(/\n/).join("<br />")}));return 1===u.length?u[0]:P.map(u,(function(e){return o+e+i})).join("")},X=tinymce.util.Tools.resolve("tinymce.html.DomParser"),G=tinymce.util.Tools.resolve("tinymce.html.Serializer"),Y=tinymce.util.Tools.resolve("tinymce.html.Node"),Q=tinymce.util.Tools.resolve("tinymce.html.Schema"),J=function(e,t){return P.each(t,(function(t){e=t.constructor===RegExp?e.replace(t,""):e.replace(t[0],t[1])})),e},Z=function(e){return e=J(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(e,t,n){return t||n?"":" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])},ee=function(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)},te=function(e){var t=!1;return e=e.replace(/^[\u00a0 ]+/,""),P.each([/^[IVXLMCD]+\.[ \u00a0]/,/^[ivxlmcd]+\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],(function(n){if(n.test(e))return t=!0,!1})),t},ne=function(e,t,n,r){var o={},i=e.dom.parseStyle(r);P.each(i,(function(i,u){switch(u){case"mso-list":var a=/\w+ \w+([0-9]+)/i.exec(r);a&&(n._listLevel=parseInt(a[1],10)),/Ignore/i.test(i)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":u="text-align";break;case"vert-align":u="vertical-align";break;case"font-color":case"mso-foreground":u="color";break;case"mso-background":case"mso-highlight":u="background";break;case"font-weight":case"font-style":return void("normal"!==i&&(o[u]=i));case"mso-element":if(/^(comment|comment-list)$/i.test(i))return void n.remove()}0!==u.indexOf("mso-comment")?0!==u.indexOf("mso-")&&("all"===M(e)||t&&t[u])&&(o[u]=i):n.remove()})),/(bold)/i.test(o["font-weight"])&&(delete o["font-weight"],n.wrap(new Y("b",1))),/(italic)/i.test(o["font-style"])&&(delete o["font-style"],n.wrap(new Y("i",1)));var u=e.dom.serializeStyle(o,n.name);return u||null},re=function(e,t){var n,r=M(e);r&&(n=P.makeMap(r.split(/[, ]/))),t=J(t,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,""],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(""):""}]]);var o=function(e){return e.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody")}(e),i=Q({valid_elements:o,valid_children:"-li[p]"});P.each(i.elements,(function(e){e.attributes.class||(e.attributes.class={},e.attributesOrder.push("class")),e.attributes.style||(e.attributes.style={},e.attributesOrder.push("style"))}));var u=X({},i);u.addAttributeFilter("style",(function(t){for(var r,o=t.length;o--;)(r=t[o]).attr("style",ne(e,n,r,r.attr("style"))),"span"===r.name&&r.parent&&!r.attributes.length&&r.unwrap()})),u.addAttributeFilter("class",(function(e){for(var t,n,r=e.length;r--;)n=(t=e[r]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&t.remove(),t.attr("class",null)})),u.addNodeFilter("del",(function(e){for(var t=e.length;t--;)e[t].remove()})),u.addNodeFilter("a",(function(e){for(var t,n,r,o=e.length;o--;)if(n=(t=e[o]).attr("href"),r=t.attr("name"),n&&-1!==n.indexOf("#_msocom_"))t.remove();else if(n&&0===n.indexOf("file://")&&(n=n.split("#")[1])&&(n="#"+n),n||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){t.unwrap();continue}t.attr({href:n,name:r})}else t.unwrap()}));var a=u.parse(t);return function(e){return e.getParam("paste_convert_word_fake_lists",!0)}(e)&&function(e){for(var t,n,r=1,o=function(e){var t="";if(3===e.type)return e.value;if(e=e.firstChild)do{t+=o(e)}while(e=e.next);return t},i=function(e,t){if(3===e.type&&t.test(e.value))return e.value=e.value.replace(t,""),!1;if(e=e.firstChild)do{if(!i(e,t))return!1}while(e=e.next);return!0},u=function(e){if(e._listIgnore)e.remove();else if(e=e.firstChild)do{u(e)}while(e=e.next)},a=function(e,o,a){var c=e._listLevel||r;c!==r&&(c<r?t&&(t=t.parent.parent):(n=t,t=null)),t&&t.name===o?t.append(e):(n=n||t,t=new Y(o,1),a>1&&t.attr("start",""+a),e.wrap(t)),e.name="li",c>r&&n&&n.lastChild.append(t),r=c,u(e),i(e,/^\u00a0+/),i(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),i(e,/^\u00a0+/)},c=[],f=e.firstChild;null!=f;)if(c.push(f),null!==(f=f.walk()))for(;void 0!==f&&f.parent!==e;)f=f.walk();for(var l=0;l<c.length;l++)if("p"===(e=c[l]).name&&e.firstChild){var s=o(e);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(s)){a(e,"ul");continue}if(te(s)){var d=/([0-9]+)\./.exec(s),m=1;d&&(m=parseInt(d[1],10)),a(e,"ol",m);continue}if(e._listLevel){a(e,"ul",1);continue}t=null}else n=t,t=null}(a),t=G({validate:F(e)},i).serialize(a)},oe=function(e,t){return{content:e,cancelled:t}},ie=function(e,t,n,r){var o=function(e,t,n,r){return e.fire("PastePreProcess",{content:t,internal:n,wordContent:r})}(e,t,n,r),i=function(e,t){var n=X({},e.schema);n.addNodeFilter("meta",(function(e){P.each(e,(function(e){e.remove()}))}));var r=n.parse(t,{forced_root_block:!1,isRootContent:!0});return G({validate:F(e)},e.schema).serialize(r)}(e,o.content);return e.hasEventListeners("PastePostProcess")&&!o.isDefaultPrevented()?function(e,t,n,r){var o=e.dom.create("div",{style:"display:none"},t),i=function(e,t,n,r){return e.fire("PastePostProcess",{node:t,internal:n,wordContent:r})}(e,o,n,r);return oe(i.node.innerHTML,i.isDefaultPrevented())}(e,i,n,r):oe(i,o.isDefaultPrevented())},ue=function(e,t,n){var r=ee(t),o=r?function(e,t){return function(e){return e.getParam("paste_enable_default_filters",!0)}(e)?re(e,t):t}(e,t):t;return ie(e,o,n,r)},ae=function(e,t){return e.insertContent(t,{merge:I(e),paste:!0}),!0},ce=function(e){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(e)},fe=function(e,t){return ce(t)&&w(z(e),(function(e){return n=t.toLowerCase(),r="."+e.toLowerCase(),R(n,r,n.length-r.length);var n,r}))},le=function(e,t,n){return!(!1!==e.selection.isCollapsed()||!ce(t))&&function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.execCommand("mceInsertLink",!1,t)})),!0}(e,t,n)},se=function(e,t,n){return!!fe(e,t)&&function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.insertContent('<img src="'+t+'">')})),!0}(e,t,n)},de=function(e,t,n){n||!1===function(e){return e.getParam("smart_paste",!0)}(e)?ae(e,t):function(e,t){P.each([le,se,ae],(function(n){return!0!==n(e,t,ae)}))}(e,t)},me=function(e){return"\n"===e||"\r"===e},ge=function(e,t){var n,r,o=(n=" ",(r=function(e){return e.getParam("paste_tab_spaces",4,"number")}(e))<=0?"":new Array(r+1).join(n)),i=t.replace(/\t/g,o);return function(e,t,n){return S(e,(function(e,r){n=t(n,e,r)})),n}(i,(function(e,t){return function(e){return-1!==" \f\t\v".indexOf(e)}(t)||""===t?e.pcIsSpace||""===e.str||e.str.length===i.length-1||function(e,t){return t<e.length&&t>=0&&me(e[t])}(i,e.str.length+1)?{pcIsSpace:!1,str:e.str+""}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:me(t),str:e.str+t}}),{pcIsSpace:!1,str:""}).str},pe=function(e,t,n,r){var o=ue(e,t,n);!1===o.cancelled&&de(e,o.content,r)},he=function(e,t,n){var r=n||H(t);pe(e,function(e){return e.replace("\x3c!-- x-tinymce/html --\x3e","")}(t),r,!1)},ve=function(e,t){var n=e.dom.encode(t).replace(/\r\n/g,"\n"),r=function(e,t,n){return t?K(e,!0===t?"p":t,n):function(e){return e.replace(/\r?\n/g,"<br>")}(e)}(ge(e,n),function(e){return e.getParam("forced_root_block")}(e),function(e){return e.getParam("forced_root_block_attrs")}(e));pe(e,r,!1,!0)},be=function(e){var t={};if(e){if(e.getData){var n=e.getData("Text");n&&n.length>0&&-1===n.indexOf("data:text/mce-internal,")&&(t["text/plain"]=n)}if(e.types)for(var r=0;r<e.types.length;r++){var o=e.types[r];try{t[o]=e.getData(o)}catch(e){t[o]=""}}}return t},ye=function(e,t){return t in e&&e[t].length>0},Ce=function(e){return ye(e,"text/html")||ye(e,"text/plain")},we=(r="mceclip",o=0,function(){return r+o++}),xe=function(e,t){var n,r,o=(n=t.uri,(r=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(n))?{type:r[1],data:decodeURIComponent(r[2])}:{type:null,data:null}),i=o.data,u=o.type,a=we(),f=t.blob,l=new Image;if(l.src=t.uri,function(e,t){var n=function(e){return e.getParam("images_dataimg_filter")}(e);return!n||n(t)}(e,l)){var s=e.editorUpload.blobCache,d=void 0,m=s.getByData(i,u);if(m)d=m;else{var g=function(e){return e.getParam("images_reuse_filename")}(e)&&c(f.name),p=g?function(e,t){var n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return c(n)?e.dom.encode(n[1]):null}(e,f.name):a,h=g?f.name:void 0;d=s.create(a,f,i,p,h),s.add(d)}he(e,'<img src="'+d.blobUri()+'">',!1)}else he(e,'<img src="'+t.uri+'">',!1)},Se=function(e){return A.all(x(e,(function(e){return new A((function(t){var n=function(e){return c(e.getAsFile)}(e)?e.getAsFile():e,r=new window.FileReader;r.onload=function(){t({blob:n,uri:r.result})},r.readAsDataURL(n)}))})))},Te=function(e){var t=z(e);return function(e){return function(e,t){return R(e,t,0)}(e.type,"image/")&&w(t,(function(t){return n=t.toLowerCase(),r={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"},(P.hasOwn(r,n)?"image/"+r[n]:"image/"+n)===e.type;var n,r}))}},ke=function(e,t,n){var r="paste"===t.type?t.clipboardData:t.dataTransfer;if(U(e)&&r){var o=function(e,t){var n=t.items?T(k(t.items),(function(e){return"file"===e.kind?[e.getAsFile()]:[]})):[],r=t.files?k(t.files):[];return function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n}(n.length>0?n:r,Te(e))}(e,r);if(o.length>0)return t.preventDefault(),Se(o).then((function(t){n&&e.selection.setRng(n),S(t,(function(t){xe(e,t)}))})),!0}return!1},Ne=function(e){return O.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode},Ee=function(e,t,n){var r,o=E(),i=E();e.on("keyup",i.clear),e.on("keydown",(function(n){var u=function(e){Ne(e)&&!e.isDefaultPrevented()&&t.remove()};if(Ne(n)&&!n.isDefaultPrevented()){if((r=n.shiftKey&&86===n.keyCode)&&_.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(n.stopImmediatePropagation(),o.set(n),i.set(!0),_.ie&&r)return n.preventDefault(),void function(e,t){e.fire("paste",{ieFake:t})}(e,!0);t.remove(),t.create(),e.once("keyup",u),e.once("paste",(function(){e.off("keyup",u)}))}}));var u=function(e,n,r,o,i){var u;ye(n,"text/html")?u=n["text/html"]:(u=t.getHtml(),i=i||H(u),t.isDefaultContent(u)&&(o=!0)),u=Z(u),t.remove();var a=!1===i&&!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(u),c=ce(u);(!u.length||a&&!c)&&(o=!0),(o||c)&&(u=ye(n,"text/plain")&&a?n["text/plain"]:function(e){var t=Q(),n=X({},t),r="",o=t.getShortEndedElements(),i=P.makeMap("script noscript style textarea video audio iframe object"," "),u=t.getBlockElements(),a=function(e){var t=e.name,n=e;if("br"!==t){if("wbr"!==t)if(o[t]&&(r+=" "),i[t])r+=" ";else{if(3===e.type&&(r+=e.value),!e.shortEnded&&(e=e.firstChild))do{a(e)}while(e=e.next);u[t]&&n.next&&(r+="\n","p"===t&&(r+="\n"))}}else r+="\n"};return e=J(e,[/<!\[[^\]]+\]>/g]),a(n.parse(e)),r}(u)),t.isDefaultContent(u)?r||e.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):o?ve(e,u):he(e,u,i)};e.on("paste",(function(a){var c=o.isSet()||i.isSet();c&&o.clear();var f=function(e,t){return be(t.clipboardData||e.getDoc().dataTransfer)}(e,a),l="text"===n.get()||r,s=ye(f,V());r=!1,a.isDefaultPrevented()||function(e){var t=e.clipboardData;return-1!==navigator.userAgent.indexOf("Android")&&t&&t.items&&0===t.items.length}(a)?t.remove():Ce(f)||!ke(e,a,t.getLastRng()||e.selection.getRng())?(c||a.preventDefault(),!_.ie||c&&!a.ieFake||ye(f,"text/html")||(t.create(),e.dom.bind(t.getEl(),"paste",(function(e){e.stopPropagation()})),e.getDoc().execCommand("Paste",!1,null),f["text/html"]=t.getHtml()),ye(f,"text/html")?(a.preventDefault(),s||(s=H(f["text/html"])),u(e,f,c,l,s)):D.setEditorTimeout(e,(function(){u(e,f,c,l,s)}),0)):t.remove()}))},Re=function(e){return _.ie&&e.inline?document.body:e.getBody()},_e=function(e,t,n){(function(e){return Re(e)!==e.getBody()})(e)&&e.dom.bind(t,"paste keyup",(function(t){Oe(e,n)||e.fire("paste")}))},De=function(e){return e.dom.get("mcepastebin")},Ae=function(e,t){return t===e},Oe=function(e,t){var n,r=De(e);return(n=r)&&"mcepastebin"===n.id&&Ae(t,r.innerHTML)},Be=function(e){var t=i(null);return{create:function(){return function(e,t,n){var r=e.dom,o=e.getBody();t.set(e.selection.getRng());var i=e.dom.add(Re(e),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},n);(_.ie||_.gecko)&&r.setStyle(i,"left","rtl"===r.getStyle(o,"direction",!0)?65535:-65535),r.bind(i,"beforedeactivate focusin focusout",(function(e){e.stopPropagation()})),_e(e,i,n),i.focus(),e.selection.select(i,!0)}(e,t,"%MCEPASTEBIN%")},remove:function(){return function(e,t){if(De(e)){for(var n=void 0,r=t.get();n=e.dom.get("mcepastebin");)e.dom.remove(n),e.dom.unbind(n);r&&e.selection.setRng(r)}t.set(null)}(e,t)},getEl:function(){return De(e)},getHtml:function(){return function(e){var t=function(t,n){t.appendChild(n),e.dom.remove(n,!0)},n=P.grep(Re(e).childNodes,(function(e){return"mcepastebin"===e.id})),r=n.shift();P.each(n,(function(e){t(r,e)}));for(var o=e.dom.select("div[id=mcepastebin]",r),i=o.length-1;i>=0;i--){var u=e.dom.create("div");r.insertBefore(u,o[i]),t(u,o[i])}return r?r.innerHTML:""}(e)},getLastRng:t.get,isDefault:function(){return Oe(e,"%MCEPASTEBIN%")},isDefaultContent:function(e){return Ae("%MCEPASTEBIN%",e)}}},Pe=function(e,t){var n=Be(e);return e.on("PreInit",(function(){return function(e,t,n){var r;Ee(e,t,n),e.parser.addNodeFilter("img",(function(t,n,o){var i=function(e){e.attr("data-mce-object")||r===_.transparentSrc||e.remove()},u=function(e){return 0===e.indexOf("webkit-fake-url")},a=function(e){return 0===e.indexOf("data:")};if(!U(e)&&function(e){return e.data&&!0===e.data.paste}(o))for(var c=t.length;c--;)(r=t[c].attr("src"))&&(u(r)||!j(e)&&a(r))&&i(t[c])}))}(e,n,t)})),{pasteFormat:t,pasteHtml:function(t,n){return he(e,t,n)},pasteText:function(t){return ve(e,t)},pasteImageData:function(t,n){return ke(e,t,n)},getDataTransferItems:be,hasHtmlOrText:Ce,hasContentType:ye}},Le=function(e,t){e.addCommand("mceTogglePlainTextPaste",(function(){!function(e,t){"text"===t.pasteFormat.get()?(t.pasteFormat.set("html"),B(e,!1)):(t.pasteFormat.set("text"),B(e,!0)),e.focus()}(e,t)})),e.addCommand("mceInsertClipboardContent",(function(e,n){n.content&&t.pasteHtml(n.content,n.internal),n.text&&t.pasteText(n.text)}))},Ie=function(e,t,n){if(!function(e){return!1===_.iOS&&"function"==typeof(null==e?void 0:e.setData)}(e))return!1;try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(V(),t),!0}catch(e){return!1}},Me=function(e,t,n,r){Ie(e.clipboardData,t.html,t.text)?(e.preventDefault(),r()):n(t.html,r)},Fe=function(e){return function(t,n){var r=function(e){return"\x3c!-- x-tinymce/html --\x3e"+e}(t),o=e.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),i=e.dom.create("div",{contenteditable:"true"},r);e.dom.setStyles(o,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),o.appendChild(i),e.dom.add(e.getBody(),o);var u=e.selection.getRng();i.focus();var a=e.dom.createRng();a.selectNodeContents(i),e.selection.setRng(a),D.setTimeout((function(){e.selection.setRng(u),o.parentNode.removeChild(o),n()}),0)}},je=function(e){return{html:e.selection.getContent({contextual:!0}),text:e.selection.getContent({format:"text"})}},Ue=function(e){return!e.selection.isCollapsed()||function(e){return!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody())}(e)},ze=function(e){e.on("cut",function(e){return function(t){Ue(e)&&Me(t,je(e),Fe(e),(function(){if(_.browser.isChrome()||_.browser.isFirefox()){var t=e.selection.getRng();D.setEditorTimeout(e,(function(){e.selection.setRng(t),e.execCommand("Delete")}),0)}else e.execCommand("Delete")}))}}(e)),e.on("copy",function(e){return function(t){Ue(e)&&Me(t,je(e),Fe(e),l)}}(e))},He=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),Ve=function(e,t){return He.getCaretRangeFromPoint(t.clientX,t.clientY,e.getDoc())},qe=function(e,t){e.focus(),e.selection.setRng(t)},We=function(e,t){e.on("PastePreProcess",(function(n){n.content=t(e,n.content,n.internal,n.wordContent)}))},$e=function(e,t){if(!ee(t))return t;var n=[];P.each(e.schema.getBlockElements(),(function(e,t){n.push(t)}));var r=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return t=J(t,[[r,"$1"]]),t=J(t,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])},Ke=function(e,t,n,r){if(r||n)return t;var o,i=function(e){return e.getParam("paste_webkit_styles")}(e);if(!1===function(e){return e.getParam("paste_remove_styles_if_webkit",!0)}(e)||"all"===i)return t;if(i&&(o=i.split(/[, ]/)),o){var u=e.dom,a=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(function(e,t,n,r){var i=u.parseStyle(u.decode(n)),c={};if("none"===o)return t+r;for(var f=0;f<o.length;f++){var l=i[o[f]],s=u.getStyle(a,o[f],!0);/color/.test(o[f])&&(l=u.toHex(l),s=u.toHex(s)),s!==l&&(c[o[f]]=l)}var d=u.serializeStyle(c,"span");return d?t+' style="'+d+'"'+r:t+r}))}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(function(e,t,n,r){return t+' style="'+n+'"'+r}))},Xe=function(e,t){e.$("a",t).find("font,u").each((function(t,n){e.dom.remove(n,!0)}))},Ge=function(e,t){return function(n){n.setActive("text"===t.pasteFormat.get());var r=function(e){return n.setActive(e.state)};return e.on("PastePlainTextToggle",r),function(){return e.off("PastePlainTextToggle",r)}}};u.add("paste",(function(e){if(!1===function(e){return!!e.hasPlugin("powerpaste",!0)&&(void 0!==window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)}(e)){var t=i(!1),n=i(function(e){return e.getParam("paste_as_text",!1)}(e)?"text":"html"),r=Pe(e,n);return function(e){_.webkit&&We(e,Ke),_.ie&&(We(e,$e),function(e,t){e.on("PastePostProcess",(function(n){t(e,n.node)}))}(e,Xe))}(e),function(e,t){var n=function(){return e.execCommand("mceTogglePlainTextPaste")};e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:n,onSetup:Ge(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:n,onSetup:Ge(e,t)})}(e,r),Le(e,r),function(e){var t=e.plugins.paste,n=function(e){return e.getParam("paste_preprocess")}(e);n&&e.on("PastePreProcess",(function(e){n.call(t,t,e)}));var r=function(e){return e.getParam("paste_postprocess")}(e);r&&e.on("PastePostProcess",(function(e){r.call(t,t,e)}))}(e),ze(e),function(e,t,n){(function(e){return e.getParam("paste_block_drop",!1)})(e)&&e.on("dragend dragover draggesture dragdrop drop drag",(function(e){e.preventDefault(),e.stopPropagation()})),L(e)||e.on("drop",(function(e){var t=e.dataTransfer;t&&t.files&&t.files.length>0&&e.preventDefault()})),e.on("drop",(function(r){var o=Ve(e,r);if(!r.isDefaultPrevented()&&!n.get()){var i,u=t.getDataTransferItems(r.dataTransfer),a=t.hasContentType(u,V());if((t.hasHtmlOrText(u)&&(!(i=u["text/plain"])||0!==i.indexOf("file://"))||!t.pasteImageData(r,o))&&o&&function(e){return e.getParam("paste_filter_drop",!0)}(e)){var c=u["mce-internal"]||u["text/html"]||u["text/plain"];c&&(r.preventDefault(),D.setEditorTimeout(e,(function(){e.undoManager.transact((function(){u["mce-internal"]&&e.execCommand("Delete"),qe(e,o),c=Z(c),u["text/html"]?t.pasteHtml(c,a):t.pasteText(c)}))})))}}})),e.on("dragstart",(function(e){n.set(!0)})),e.on("dragover dragend",(function(t){L(e)&&!1===n.get()&&(t.preventDefault(),qe(e,Ve(e,t))),"dragend"===t.type&&n.set(!1)}))}(e,r,t),function(e){return{clipboard:e}}(r)}}))}()},,,,,,function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var u={};if("string"!=typeof e||0===e.length)return u;var a=/\+/g;e=e.split(t);var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var f=e.length;c>0&&f>c&&(f=c);for(var l=0;l<f;++l){var s,d,m,g,p=e[l].replace(a,"%20"),h=p.indexOf(n);h>=0?(s=p.substr(0,h),d=p.substr(h+1)):(s=p,d=""),m=decodeURIComponent(s),g=decodeURIComponent(d),r(u,m)?o(u[m])?u[m].push(g):u[m]=[u[m],g]:u[m]=g}return u};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(u(e),(function(u){var a=encodeURIComponent(r(u))+n;return o(e[u])?i(e[u],(function(e){return a+encodeURIComponent(r(e))})).join(t):a+encodeURIComponent(r(e[u]))})).join(t):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var u=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}}]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-editor-plugin:split_core~page-editor-quit-dialog', location = 'core~page-editor-quit-dialog.js' */
(window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff=window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff||[]).push([["core~page-editor-quit-dialog"],{12:function(e,t,a){"use strict";a.r(t),a.d(t,"cancelButton",(function(){return i})),a.d(t,"previewButton",(function(){return n})),a.d(t,"quitDialogHeader",(function(){return d})),a.d(t,"quitDialogContent",(function(){return s})),a.d(t,"saveButtonText",(function(){return c})),a.d(t,"saveButtonTitle",(function(){return u})),a.d(t,"saveButton",(function(){return g})),a.d(t,"contributorList",(function(){return r})),a.d(t,"hiddenInputCancel",(function(){return l}));var o=a(4),i=e=>{var t=e.contentType;return e.sharedDraftsEnabled&&t&&["page","blogpost"].includes(t)?'<ul class="aui-buttons rte-toolbar-group-done close"><button class="aui-button shared-drafts" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="icon aui-icon aui-icon-small aui-iconfont-close-dialog"></span></button></ul>':`<div class="aui-buttons cancel-button-container-shared-draft cancel-button-container-quick-edit">\n      <button class="aui-button toolbar-item" type="submit" id="rte-button-cancel" name="cancel" value="cancel">\n          <span class="trigger-text">${t&&["page","blogpost"].includes(t)?Object(o.a)("close.name"):Object(o.a)("cancel.name")}</span>\n      </button>\n  </div>`},n=()=>`<button class="aui-button toolbar-item" id="rte-button-preview" title="${Object(o.a)("tinymce.confluence.preview")}" type="button"><span class="trigger-text">${Object(o.a)("show.preview")}</span></button>`,r=e=>`<ul class="contributor-list">${null==e?void 0:e.map(e=>`<li><div class="contributor-avatar"><span class="aui-avatar aui-avatar-large"><span class="aui-avatar-inner"><img src="${e.avatarURL}"/></span></span></div><div class="contributor-name"><span>${e.fullname}</span></div></li>`).join("")}</ul>`,l=()=>'<input type="hidden" name="cancel" value="cancel">',d=e=>{var t=e.dialogType,a=e.contentType,i=e.newPage;return`${(()=>{switch(t){case"revert":case"delete":return i?"blogpost"===a?`<h2 class="aui-dialog2-header-main">${Object(o.a)("editor.quit-dialog.title.blogpost.delete")}</h2>`:`<h2 class="aui-dialog2-header-main">${Object(o.a)("editor.quit-dialog.title.page.delete")}</h2>`:`<h2 class="aui-dialog2-header-main">${Object(o.a)("editor.quit-dialog.title.discard")}</h2>`;case"publish":case"update":return`<h2 class="aui-dialog2-header-main">${Object(o.a)("editor.quit-dialog.title.publish")}</h2>`;case"diff":default:return`<h2 class="aui-dialog2-header-main">${Object(o.a)("editor.quit-dialog.title.diff")}</h2>`}})()}<button class="aui-close-button" type="button" aria-label=${Object(o.a)("close.name")}></button>`},s=e=>{var t=e.dialogType,a=e.contentType,i=e.contributors,n=e.newDialog;switch(t){case"revert":return i&&0!==(null==i?void 0:i.length)?`${Object(o.a)("editor.quit-dialog.revert.changes.by.many")}<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">${Object(o.a)("editor.quit-dialog.link.show.diff")}</a></div>${r(i)}`:`${"blogpost"===a?Object(o.a)("editor.quit-dialog.revert.blogpost.changes.by.one"):Object(o.a)("editor.quit-dialog.revert.page.changes.by.one")}<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">${Object(o.a)("editor.quit-dialog.link.show.diff")}</a></div>`;case"delete":return i&&0!==(null==i?void 0:i.length)?`${"blogpost"===a?Object(o.a)("editor.quit-dialog.delete.blogpost.changes.by.many"):Object(o.a)("editor.quit-dialog.delete.page.changes.by.many")}${r(i)}`:"blogpost"===a?Object(o.a)("editor.quit-dialog.delete.blogpost.changes.by.one"):Object(o.a)("editor.quit-dialog.delete.page.changes.by.one");case"publish":case"update":return`${Object(o.a)("editor.quit-dialog.publish.changes")}${r(i)}`;case"diff":return`<div><div class="legend"><span class="legend-title">${Object(o.a)("heading.key")}: </span><span class="diff-html-added">${Object(o.a)("these.lines.were.added")}</span><span class="diff-html-removed">${Object(o.a)("these.lines.were.removed")}</span><span class="diff-html-changed">${Object(o.a)("this.content.was.modified")}</span></div>${n?"":`<a class="aui-button aui-button-link" id="qed-hide-diff-button">${Object(o.a)("editor.quit-dialog.link.hide.diff")}</a>`}<hr/><div class="wiki-content"></div></div>`}},c=e=>{var t=e.contentType,a=e.sharedDraftsEnabled,i=e.isNewPage;return a&&t&&["page","blogpost"].includes(t)?i?Object(o.a)("publish.name"):Object(o.a)("update.word"):"blogpost"===t?Object(o.a)("editor.publish.blog"):Object(o.a)("editor.save.page")},u=e=>{var t=e.contentType,a=e.sharedDraftsEnabled,i=e.isNewPage;switch(t){case"blogpost":return Object(o.a)("editor.publish.blog.desc");case"page":return a?i?Object(o.a)("editor.shared.draft.publish.desc"):Object(o.a)("editor.shared.draft.update.desc"):Object(o.a)("editor.save.page.desc");default:return Object(o.a)("editor.save.page")}},g=e=>{var t=e.contentType,a=e.sharedDraftsEnabled,o=e.isNewPage;return`<button id="rte-button-publish" class="aui-button aui-button-primary default-submit" type="submit" name="confirm" value="Save" title="${u({contentType:t,sharedDraftsEnabled:a,isNewPage:o})}" tabindex="101">${c({contentType:t,sharedDraftsEnabled:a,isNewPage:o})}</button>`}},17:function(e,t,a){"use strict";var o,i=a(5),n=a.n(i),r=a(1),l=a.n(r),d=a(0),s=a(7),c=a(4),u=a(3),g=a(2),p=a(9),f=a(12);!function(e){e.DELETE="delete",e.REVERT="revert",e.PUBLISH="publish",e.UPDATE="update",e.SHOW_DIFF="diff"}(o||(o={}));var b,h,m,v={},y={},x=[],T=!1,I=0,S=!1,A=!1,J=e=>{var t;e.stopPropagation(),e.preventDefault(),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.show-diff-clicked"}),null===(t=v.showDiffButton)||void 0===t||t.hide(),F((function(){var e;B(),null===(e=v.hideDiffButton)||void 0===e||e.show()}))},w=e=>{var t,a,o;e.stopPropagation(),e.preventDefault(),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.hide-diff-clicked"}),null===(t=v.hideDiffButton)||void 0===t||t.hide(),null===(a=v.showDiffButton)||void 0===a||a.show(),null===(o=v.dialogEl)||void 0===o||o.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium"),P(m)},q=e=>{S||(m=b?o.REVERT:o.DELETE,H(),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard"}),e.stopPropagation(),e.preventDefault(),d.Confluence.Editor.UI.setButtonsState(!1,v.buttonsAll),function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=b?s.a+"/rest/synchrony/1.0/content/"+t+"/changes/unpublished":s.a+"/rest/api/content/"+t+"?status=draft";b&&p.a.suppressMessage("editor.synchrony.revert-page");l.a.ajax({url:o,type:"DELETE",data:{draftId:t},contentType:"application/json",dataType:"json"}).done(()=>{b&&p.a.handleMessage("collaborative-editor-discard-error",{type:"success",close:"auto",message:Object(c.a)("editor.discard-to-published.success.message")}),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-success",data:{contentId:t}}),k()}).fail(o=>{if(409===o.status&&a<5)Object(g.b)("disable-draft-save"),e(t,a+1);else{var i,n,r,l,s,u=JSON.parse(o.responseText),f=Object(c.a)("draft.saving.error.could.not.delete"),h=o.errors||Object(c.a)("discard.draft.unknown.error");"content.delete.published"===(null==u||null===(i=u.data)||void 0===i||null===(n=i.errors)||void 0===n||null===(r=n[0])||void 0===r||null===(l=r.message)||void 0===l?void 0:l.key)&&(f=Object(c.a)("discard.draft.page-published.error.title"),h=Object(c.a)("discard.draft.page-published.error")),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-error",data:{contentId:t}}),Object(g.b)("enable-draft-save"),p.a.handleMessage("collaborative-editor-discard-error",{type:"error",title:b?Object(c.a)("editor.discard-to-published.error.title"):f,message:b?Object(c.a)("editor.discard-to-published.error.message"):h}),null==v||null===(s=v.dialog)||void 0===s||s.hide(),d.Confluence.Editor.UI.setButtonsState(!0,v.buttonsAll)}})}(u.a.get("content-id")))},k=()=>{var e;d.Confluence.Editor.Drafts.unBindUnloadMessage(),null===(e=v.editorForm)||void 0===e||e.append(Object(f.hiddenInputCancel)()).submit()},E=e=>{null!=e&&e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.keep-draft-clicked",data:{contributorCount:x.length+1}}),k()},j=e=>{var t;d.Confluence.Editor.UI.setButtonsState(!1,v.buttonsAll),null==y||null===(t=y.save)||void 0===t||t.call(y,e),H()},O=e=>{e.stopPropagation(),e.preventDefault(),m=null,Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.draft-status-indicator.click"}),F((function(){var e;null===(e=v.closeButton)||void 0===e||e.show(),B()}))},D=e=>{var t;e.stopPropagation(),e.preventDefault(),S||(null===(t=v.closeButton)||void 0===t||t.show(),u.a.get("new-page")?P(o.DELETE):P(o.REVERT))},_=e=>{var t;e.stopPropagation(),e.preventDefault(),null==v||null===(t=v.dialog)||void 0===t||t.hide()},B=()=>{var e;null===(e=v.dialogEl)||void 0===e||e.removeClass("aui-dialog2-medium").addClass("aui-dialog2-xlarge"),P(o.SHOW_DIFF),l.a.ajax({url:s.a+"/rest/tinymce/1/content/"+u.a.get("page-id")+"/draft/diff",type:"GET"}).done(e=>{var t,a,o=null===(t=v.dialogContent)||void 0===t?void 0:t.find(".wiki-content").html(e);null!=o&&o.children().first().hasClass("diff-context-placeholder")&&(null===(a=v.dialogContent)||void 0===a||a.find("hr").hide())})},C=()=>{if(d.Confluence.Editor.UI.toggleSavebarBusy(!0),0===x.length)y.save&&y.save();else{F();var e=b?o.UPDATE:o.PUBLISH;P(e)}},$=e=>{d.Confluence.Editor.Drafts.save({forceSave:!0,skipErrorHandler:!1,onSuccessHandler:E,ignoreRelations:!(d.Confluence.Editor.hasContentChanged()&&A)});var t=d.Confluence.Editor.Drafts.getDraftSavingPromise();t&&t.fail(e=>{var t;null==y||null===(t=y.cancelErrorHandler)||void 0===t||t.call(y,e)}),e.namespace&&"heartbeat-error"===e.namespace||d.Confluence.Editor.UI.toggleSavebarBusy(!0)},P=e=>{var t,a,i,n,r,d=()=>e===o.SHOW_DIFF&&(m===o.REVERT||m===o.DELETE);e!==o.UPDATE&&e!==o.PUBLISH||(I=(new Date).getTime()/1e3);var s,c,g,p,b=e;(d()&&(b=m),null===(t=v.dialogHeader)||void 0===t||t.html(Object(f.quitDialogHeader)({dialogType:b,contentType:u.a.get("content-type"),newPage:u.a.get("new-page")})),null===(a=v.dialogContent)||void 0===a||a.html(Object(f.quitDialogContent)({dialogType:e,contributors:x,contentType:u.a.get("content-type"),newDialog:null==m})),v.hideDiffButton=l()("#qed-hide-diff-button").click(w),u.a.get("new-page"))||(e!==o.SHOW_DIFF&&(m=e),v.showDiffButton=l()("#qed-show-diff-button").click(J),v.showDiffButton.show(),null===(s=v.buttonsAll)||void 0===s||s.push(v.showDiffButton));e===o.DELETE||e===o.REVERT||d()?(null===(c=v.discardButton)||void 0===c||c.show(),null===(p=v.dialogEl)||void 0===p||p.addClass("aui-dialog2-warning")):null===(g=v.dialogEl)||void 0===g||g.removeClass("aui-dialog2-warning");null===(i=v.closeButton)||void 0===i||i.show(),null===(n=v.dialogFooter)||void 0===n||n.find("."+e).show(),null===(r=v.dialog)||void 0===r||r.show()},L=()=>{var e,t,a;H(),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.dialog-closed"}),null===(e=v.dialogEl)||void 0===e||e.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium"),d.Confluence.Editor.UI.toggleSavebarBusy(!1),null===(t=v.dialogFooter)||void 0===t||t.find(".aui-button").hide(),null===(a=v.dialogContent)||void 0===a||a.empty()},H=()=>{var e=(new Date).getTime()/1e3-I;Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog."+m+".displayed",data:{displayTimeInSeconds:e,contentId:u.a.get("content-id")}}),I=0};var U=(e,t)=>{if(null!=t&&t.contributors){a=t.contributors,o=e=>e.name===u.a.get("remote-user"),x=a.filter((i=o,e=>!i(e)))}var a,o,i},F=e=>{d.Confluence.Editor.Drafts.save({forceSave:b,skipErrorHandler:!0,onSuccessHandler:e||l.a.noop})};t.a={init:e=>{if(h=u.a.getBoolean("shared-drafts")&&["page","blogpost"].includes(u.a.get("content-type")))if(T){var t;y.save=null==e?void 0:e.saveHandler,y.cancelErrorHandler=null==e?void 0:e.cancelErrorHandler,null===(t=v.publishButton)||void 0===t||t.click(j)}else{var a,o,i,r,s,c,p;if(b=!u.a.get("new-page"),v.discardButton=l()("#qed-discard-button").tooltip({gravity:"s",className:"quit-editor-dialog"}),d.Confluence.Editor.isLimitedModeEnabled()&&b)d.Confluence.Editor.UI.setButtonState(!1,v.discardButton),null===(c=v.discardButton)||void 0===c||c.removeAttr("disabled");else null===(p=v.discardButton)||void 0===p||p.click(q);v.saveExitButton=l()("#qed-save-exit-button").click(E),v.hideDiffButton=l()("#qed-hide-diff-button").click(w),v.publishButton=l()("#qed-publish-button"),v.closeButton=l()("#qed-close-button").click(_),v.buttonsAll=[v.discardButton,v.saveExitButton,v.showDiffButton,v.hideDiffButton,v.publishButton],v.dialog=n.a.dialog2("#quit-editor-dialog"),v.dialogEl=null===(a=v.dialog)||void 0===a?void 0:a.$el,v.dialogHeader=null===(o=v.dialogEl)||void 0===o?void 0:o.find(".aui-dialog2-header"),v.dialogContent=null===(i=v.dialogEl)||void 0===i?void 0:i.find(".aui-dialog2-content"),v.dialogFooter=null===(r=v.dialogEl)||void 0===r?void 0:r.find(".aui-dialog2-footer"),v.editorForm=l()("#wysiwyg").closest("form"),l()("#rte-show-changes").on("click",O),l()("#rte-show-revert").on("click",D),u.a.get("new-page")||l()("#pluggable-status").on("click","a",O),null===(s=v.dialog)||void 0===s||s.on("hide",L),Object(g.a)("editor-heartbeat",U),Object(g.a)("synchrony.history.evicted",()=>{S=!0,l()("#qed-discard-button").attr("disabled","disabled")}),Object(g.a)("synchrony.connected",()=>{A=!0}),T=!0}return v},process:e=>{h&&(e.stopPropagation(),e.preventDefault(),l()(window).one("editor-heartbeat rte.heartbeat-error",(function(t){switch(l()(this).off("editor-heartbeat rte.heartbeat-error"),e.target.id){case d.Confluence.Editor.UI.saveButton.attr("id"):case d.Confluence.Editor.UI.versionCommentInput.attr("id"):return C();case d.Confluence.Editor.UI.cancelButton.attr("id"):return $(t)}})),d.Confluence.Editor.heartbeat())},_destroy:()=>{T=!1,S=!1}}},2:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return s}));var o=a(1),i=a.n(o),n=a(0),r=a.n(n);function l(e,t,a){return"function"==typeof a?i()(r.a).bind(e,t,a):i()(r.a).bind(e,t)}function d(e,t){return i()(r.a).unbind(e,t)}function s(e,t){return i()(r.a).trigger(e,t)}},3:function(e,t,a){"use strict";var o=a(35),i=a.n(o);t.a=i.a},35:function(e,t){e.exports=require("confluence/meta")},4:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var o=a(5),i=a.n(o),n={"editor.autocomplete.macros.header.text":"\u5b8f\u5efa\u8bae","editor.autocomplete.macros.dialog.browse":"\u6253\u5f00\u5b8f\u6d4f\u89c8\u5668","editor.autocomplete.macros.error.load.header":"\u83b7\u53d6\u5b8f\u8be6\u60c5\u5931\u8d25","editor.autocomplete.macros.error.load.retrylink":"\u91cd\u8bd5","editor.autocomplete.links.header.text":"\u94fe\u63a5\u5efa\u8bae","editor.autocomplete.links.dialog.search":"\u641c\u7d22&lsquo;{0}&rsquo;","editor.autocomplete.links.dialog.search.no.text":"\u641c\u7d22","editor.autocomplete.links.web.link":"\u63d2\u5165\u7f51\u7ad9\u94fe\u63a5","editor.autocomplete.links.create.link":"\u63d2\u5165\u94fe\u63a5\u4ee5\u521b\u5efa\u9875\u9762","editor.autocomplete.file.header.text":"\u6587\u4ef6\u5efa\u8bae","editor.autocomplete.media.header.text":"\u5a92\u4f53\u5efa\u8bae","editor.autocomplete.media.files.dialog.browse":"\u6253\u5f00\u6587\u4ef6\u5e93","editor.autocomplete.media.macros.dialog.browse":"\u63d2\u5165\u5176\u5b83\u5a92\u4f53","editor.autoformat.sampletext.firstcell":"\u9996\u4e2a\u5355\u5143\u683c","editor.autoformat.sampletext.heading":"\u6807\u9898","tinymce.advanced.charmap_desc":"\u7b26\u53f7","tinymce.charmap_dlg.success.text":"\u5df2\u63d2\u5165\u7b26\u53f7","tinymce.charmap_dlg.title":"\u63d2\u5165\u7b26\u53f7","tinymce.charmap_dlg.search.label":"\u67e5\u627e\u7b26\u53f7","calendar3.helptip.learn.more":"\u4e86\u89e3\u66f4\u591a","tinymce.confluence.placeholder.inline.tasks":"\u5728\u6b64\u8f93\u5165\u4efb\u52a1\uff0c\u7528\u0022@+\u4eba\u540d\u0022\u5c06\u4efb\u52a1\u5206\u6d3e\u5e76\u7528\u0022//\u0022\u9009\u62e9\u5230\u671f\u65e5","tinymce.confluence.files":"\u6587\u4ef6","tinymce.confluence.conf_file_desc":"\u63d2\u5165\u6587\u4ef6\u548c\u56fe\u7247","tinymce.confluence.conf_file_shortcut":"Ctrl+M","tinymce.charmap_dlg.nothing.text":"\u672a\u627e\u5230\u4efb\u4f55\u7b26\u53f7","tinymce.confluence.conf_wikimarkup_conversion_errors":"Wiki\u6807\u8bb0\u8f6c\u6362\u9519\u8bef","tinymce.confluence.conf_wikimarkup_timeout":"\u670d\u52a1\u5668\u5904\u7406wiki\u6807\u8bb0\u65f6\u95f4\u8fc7\u957f\uff0c\u4e5f\u8bb8\u662f\u5076\u53d1\u95ee\u9898\uff0c\u53ef\u4ee5\u7a0d\u540e\u518d\u8bd5\u3002","tinymce.confluence.conf_wikimarkup_info_title":"\u5728\u4e0b\u9762\u8f93\u5165wiki\u6807\u8bb0\u8bed\u8a00\uff0cConfluence\u5c06\u8f6c\u6362\u5185\u5bb9\u6210\u4e3a\u7f16\u8f91\u5668\u683c\u5f0f\u5e76\u63d2\u5165\u5230\u9875\u9762\u4e2d\u3002","tinymce.confluence.conf_wikimarkup.insert.label":"\u63d2\u5165","tinymce.confluence.conf_wikimarkup_preview_label":"\u9884\u89c8","editor.minor.edit":"\u901a\u77e5\u5173\u6ce8\u4eba","property.panel.textplaceholder.display.default":"\u6587\u672c","property.panel.textplaceholder.display.default.tooltip":"\u5f53\u7528\u6237\u8f93\u5165\u65f6\uff0c\u5f15\u5bfc\u6027\u6587\u5b57\u5c06\u88ab\u7a7a\u5185\u5bb9\u66ff\u6362\u3002","property.panel.textplaceholder.remove":"\u5220\u9664","editor.shared.draft.done.desc":"\u4fdd\u5b58\u8349\u7a3f\u5e76\u9009\u62e9\u7f16\u8f91\u5668\u3002","editor.change.comment":"\u53d8\u66f4\u4e86\u4ec0\u4e48?","tinymce.tablepicker.insert_table_title":"\u63d2\u5165\u8868\u683c","com.atlassian.confluence.extra.team-calendars.calendar.helptip.close":"\u6536\u5230, \u4e07\u5206\u611f\u8c22!","comment.notification.enable":"\u5173\u6ce8\u6b64\u9875\u9762","page-layout-2.layout.group":"\u5e94\u7528\u5e03\u5c40","page-layout-2.layout.single":"\u5355\u5217\u8282","page-layout-2.layout.two-equal":"\u4e24\u5217\u8282","page-layout-2.layout.two-left-sidebar":"\u542b\u5de6\u4fa7\u8fb9\u680f\u7684\u4e24\u5217\u8282","page-layout-2.layout.two-right-sidebar":"\u542b\u53f3\u4fa7\u8fb9\u680f\u7684\u4e24\u5217\u8282","page-layout-2.layout.three-equal":"\u4e09\u5217\u8282","page-layout-2.layout.three-with-sidebars":"\u5305\u542b\u8fb9\u680f\u7684\u4e09\u5217\u8282","page-layout-2.add-section":"\u6dfb\u52a0\u8282","page-layout-2.add-section.tooltip":"\u5728\u4e0b\u65b9\u6dfb\u52a0\u4e00\u4e2a\u65b0\u8282","page-layout-2.remove-section":"\u5220\u9664\u8282","page-layout-2.remove-section.tooltip":"\u5220\u9664\u5f53\u524d\u8282","page-layout-2.move-section-up":"\u4e0a\u79fb","page-layout-2.move-section-up.tooltip":"\u8282\u4e0a\u79fb","page-layout-2.move-section-down":"\u4e0b\u79fb","page-layout-2.move-section-down.tooltip":"\u8282\u4e0b\u79fb","page-layout-2.close":"\u5173\u95ed\u5de5\u5177\u680f","cancel.name":"\u53d6\u6d88","close.name":"\u53d6\u6d88","content.empty":"\u8bc4\u8bba\u6587\u5b57\u4e3a\u7a7a\uff0c\u4e0d\u80fd\u6dfb\u52a0\u7a7a\u7684\u8bc4\u8bba\u3002","edit.name":"\u7f16\u8f91","heading.key":"\u6807\u8bc6","heartbeat.page.edited.info":"\u6b64\u9875\u9762\u6b63\u5728\u7531{0}\u7f16\u8f91\uff0c\u5f53\u4fdd\u5b58\u65f6\u5c06\u4f1a\u548c\u5176\u4ed6\u4eba\u7f16\u8f91\u7684\u5185\u5bb9\u8fdb\u884c\u5408\u5e76\u3002","mysql.utf8.content.validation.failed.message":"\u6211\u4eec\u65e0\u6cd5\u4fdd\u5b58\u60a8\u7684\u9875\u9762\uff0c\u56e0\u4e3a\u6570\u636e\u5e93\u4e0d\u652f\u6301 {0} \u5b57\u7b26\u3002\u003cbr\u003e\u003cbr\u003e\u8bf7\u5220\u9664\u6b64\u5b57\u7b26\u6216\u6539\u7528 Confluence \u7b26\u53f7\u6216\u8868\u60c5\u7b26\u53f7\u3002\u003ca href = \u0022https://confluence.atlassian.com/x/BYfsNg\u0022 target=\u0022_blank\u0022\u003e\u4e86\u89e3\u66f4\u591a\u003c/a\u003e","mysql.utf8.content.validation.failed.title":"\u4e0d\u652f\u6301\u7684\u5b57\u7b26","page.restrictions.apply":"\u6743\u9650\u9650\u5236","page.restrictions.none":"\u672a\u9650\u5236","publish.name":"\u53d1\u5e03","show.preview":"\u9884\u89c8","these.lines.were.added":"\u8be5\u884c\u88ab\u6dfb\u52a0\u3002","these.lines.were.removed":"\u8be5\u884c\u88ab\u5220\u9664\u3002","this.content.was.modified":"\u683c\u5f0f\u5df2\u7ecf\u6539\u53d8\u3002","tinymce.confluence.preview":"\u9884\u89c8","unsaved.comment.lost":"\u8bc4\u8bba\u5c06\u4e22\u5931\u3002","unsaved.template.lost":"\u4f60\u672a\u4fdd\u5b58\u7684\u6a21\u7248\u66f4\u6539\u5c06\u4e22\u5931\u3002","update.word":"\u66f4\u65b0","editor.collaborative.mode.disabled":"\u590d\u5236\u60a8\u60f3\u4fdd\u7559\u7684\u4efb\u4f55\u6539\u52a8\uff0c\u7136\u540e\u5237\u65b0\u9875\u9762\u4ee5\u7ee7\u7eed\u7f16\u8f91\u3002","editor.collaborative.mode.enabled":"\u534f\u540c\u7f16\u8f91\u66fe\u88ab\u5173\u95ed\uff0c\u4f46\u662f\u5b83\u5df2\u7ecf\u6062\u590d\u6b63\u5e38\u4e86\u3002\u590d\u5236\u60a8\u7684\u4fee\u6539\u5e76\u5237\u65b0\u9875\u9762\u4ee5\u7ee7\u7eed\u7f16\u8f91\u3002","editor.discard-to-published.error.message":"\u6b64\u523b\u6211\u4eec\u4e0d\u80fd\u83b7\u5f97\u8fd9\u4e2a\u9875\u9762\u6700\u540e\u53d1\u5e03\u7684\u7248\u672c\u3002\u51e0\u5206\u949f\u540e\u518d\u5c1d\u8bd5\u4e22\u5f03\u8349\u7a3f\u3002","editor.discard-to-published.error.title":"\u4e0d\u80fd\u6062\u590d\u5230\u4e0a\u6b21\u53d1\u5e03\u7684\u7248\u672c","editor.discard-to-published.success.message":"\u6210\u529f\u6062\u590d\u5230\u4e0a\u6b21\u53d1\u5e03\u7684\u7248\u672c","editor.generic.refresh":"\u7f16\u8f91\u5668\u51fa\u9519\u4e86\u3002\u590d\u5236\u60a8\u672a\u4fdd\u5b58\u7684\u66f4\u6539\uff0c\u5e76\u5237\u65b0\u9875\u9762\u7ee7\u7eed\u7f16\u8f91\u3002","editor.labels.plural":"{0} \u6807\u7b7e","editor.labels.singular":"{0} \u6807\u7b7e","editor.labels.zero":"\u6807\u7b7e","editor.offline.before.save.error":"\u65e0\u6cd5\u4fdd\u5b58\u9875\u9762\u3002\u8bf7\u68c0\u67e5\u4e0e\u670d\u52a1\u5668\u901a\u4fe1\uff0c\u6216\u68c0\u67e5\u5185\u5bb9\u662f\u5426\u6709\u7279\u6b8a\u5b57\u7b26/emoji\u8868\u60c5\u3002","editor.offline.preview.error":"\u65e0\u6cd5\u4e0e\u670d\u52a1\u5668\u53d6\u5f97\u8054\u7cfb\u3002\u68c0\u67e5\u60a8\u7684\u7f51\u7edc\u94fe\u63a5\uff0c\u5408\u6d41\u5df2\u5f00\u5927\u5e76\u6b63\u5728\u8fd0\u884c\u3002","editor.page.legacy.draft.deprecated":"\u534f\u540c\u7f16\u8f91\u5c31\u5728\u8fd9\u91cc\uff01\u8fd9\u610f\u5473\u7740\u6211\u4eec\u9700\u8981\u60a8\u7684\u4e00\u70b9\u5e2e\u52a9\u4ee5\u91cd\u542f\u60a8\u7684\u7f16\u8f91\u4f1a\u8bdd\u3002\u60a8\u9700\u8981\u505a\u7684\u4e00\u5207\u5c31\u662f\u590d\u5236\u5185\u5bb9\uff0c\u91cd\u65b0\u7f16\u8f91\u8be5\u9875\u9762\uff0c\u7136\u540e\u5c06\u5176\u9ecf\u8d34\u5e76\u4fdd\u5b58\u3002","editor.publish.blog.desc":"\u53d1\u5e03\u60a8\u7684\u535a\u6587","editor.publish.blog":"\u53d1\u5e03","editor.restrictions.icon.editor-restricted":"\u7f16\u8f91\u9875\u9762\u9650\u5236\u3002\u5f53\u524d\u72b6\u6001\uff1a\u5b58\u5728\u9650\u5236","editor.restrictions.icon.editor-unrestricted":"\u7f16\u8f91\u9875\u9762\u9650\u5236\u3002\u5f53\u524d\u72b6\u6001\uff1a\u65e0\u9650\u5236","editor.save.page.desc":"\u4fdd\u5b58\u4f60\u7684\u9875\u9762","editor.save.page":"\u4fdd\u5b58","editor.shared.draft.publish.desc":"\u53d1\u5e03\u53d8\u66f4","editor.shared.draft.update.desc":"\u66f4\u65b0\u5df2\u53d1\u5e03\u9875\u9762\u3002","discard.draft.page-published.error.title":"\u6b64\u9875\u9762\u5df2\u53d1\u5e03\u3002","discard.draft.page-published.error":"\u7531\u4e8e\u8fd9\u5df2\u4e0d\u518d\u662f\u8349\u7a3f\uff0c\u6240\u4ee5\u60a8\u65e0\u6cd5\u820d\u5f03\u3002","discard.draft.unknown.error":"\u53d1\u751f\u672a\u77e5\u9519\u8bef. \u8bf7\u68c0\u67e5\u65e5\u5fd7.","draft.autosaved.at.new":"\u8349\u7a3f\u81ea\u52a8\u4fdd\u5b58\u5728 {0}","draft.saved.at.new":"\u8349\u7a3f\u4fdd\u5b58\u4e8e{0}","draft.saving.error.could.not.delete":"\u5220\u9664\u8349\u7a3f\u65f6\u53d1\u751f\u9519\u8bef\u3002","draft.saving.error.previous.draft":"\u4fdd\u5b58\u8349\u7a3f\u5931\u8d25\uff0c\u6700\u65b0\u7684\u8349\u7a3f\u4fdd\u5b58\u5728 {0}","draft.saving.error":"\u4fdd\u5b58\u8349\u7a3f\u5931\u8d25\uff0c\u8349\u7a3f\u672a\u4fdd\u5b58\u3002","saved.draft":"\u8349\u7a3f\u5c06\u88ab\u4fdd\u5b58\u3002\u4f60\u53ef\u4ee5\u5728\u4f60\u4e0b\u6b21\u6253\u5f00\u7f16\u8f91\u5668\u7684\u65f6\u5019\u6062\u590d\u8fd9\u4e2a\u8349\u7a3f\u6216\u8005\u5728\u4f60\u7684\u4e2a\u4eba\u8d44\u6599\u4e2d\u67e5\u770b\u3002","saved.shared.draft.leave.page":"\u6211\u4eec\u8fd8\u6ca1\u6709\u5b8c\u6210\u4fdd\u5b58\u60a8\u7684\u66f4\u6539\u3002\u5982\u679c\u60a8\u5728\u770b\u5230\u201c\u8349\u7a3f\u5df2\u4fdd\u5b58\u201d\u7684\u6d88\u606f\u524d\u79bb\u5f00\uff0c\u60a8\u53ef\u80fd\u4f1a\u5931\u53bb\u60a8\u7684\u66f4\u6539\u3002","editor.quit-dialog.delete.blogpost.changes.by.many":"\u8fd9\u5c06\u4f1a\u6c38\u4e45\u5220\u9664\u60a8\u548c\u5176\u4ed6\u4eba\u6240\u7f16\u8f91\u7684\u8fd9\u4e2a\u535a\u5ba2\u5e16\u3002","editor.quit-dialog.delete.blogpost.changes.by.one":"\u5982\u679c\u60a8\u5220\u9664\u672a\u53d1\u5e03\u7684\u535a\u5ba2\u5e16\uff0c\u5e16\u5b50\u5c06\u6c38\u8fdc\u6d88\u5931\u3002","editor.quit-dialog.delete.page.changes.by.many":"\u8fd9\u5c06\u4f1a\u6c38\u4e45\u5220\u9664\u60a8\u548c\u5176\u4ed6\u4eba\u6240\u7f16\u8f91\u7684\u8fd9\u4e2a\u9875\u9762\u3002","editor.quit-dialog.delete.page.changes.by.one":"\u5982\u679c\u60a8\u5220\u9664\u672a\u53d1\u5e03\u7684\u9875\u9762\uff0c\u9875\u9762\u5c06\u6c38\u8fdc\u6d88\u5931\u3002","editor.quit-dialog.link.hide.diff":"\u663e\u793a\u64b0\u7a3f\u4eba","editor.quit-dialog.link.show.diff":"\u663e\u793a\u53d8\u66f4","editor.quit-dialog.publish.changes":"\u003cp\u003e\u8fd9\u91cc\u6709\u60a8\u548c\u5176\u4ed6\u4eba\u6240\u505a\u7684\u66f4\u6539\uff0c\u5b83\u4eec\u8fd8\u672a\u53d1\u5e03\u3002\u003c/p\u003e\u003cp\u003e\u8fd9\u4e9b\u4eba\u505a\u51fa\u4e86\u66f4\u6539\uff1a\u003c/p\u003e","editor.quit-dialog.revert.blogpost.changes.by.one":"\u8fd9\u5c06\u6c38\u4e45\u5220\u9664\u6b64\u535a\u5ba2\u5e16\u6700\u65b0\u53d1\u5e03\u540e\u60a8\u6240\u505a\u7684\u5168\u90e8\u66f4\u6539\u3002","editor.quit-dialog.revert.changes.by.many":"\u8fd9\u5c06\u6c38\u4e45\u5220\u9664\u6b64\u9875\u9762\u6700\u65b0\u53d1\u5e03\u540e\u4ee5\u4e0b\u4eba\u5458\u6240\u505a\u7684\u5168\u90e8\u66f4\u6539\u3002","editor.quit-dialog.revert.page.changes.by.one":"\u8fd9\u5c06\u6c38\u4e45\u5220\u9664\u6b64\u9875\u9762\u6700\u65b0\u53d1\u5e03\u540e\u60a8\u6240\u505a\u7684\u5168\u90e8\u66f4\u6539\u3002","editor.quit-dialog.title.blogpost.delete":"\u5220\u9664\u672a\u53d1\u5e03\u7684\u535a\u5ba2\u5e16\uff1f","editor.quit-dialog.title.diff":"\u672a\u53d1\u5e03\u7684\u53d8\u66f4","editor.quit-dialog.title.discard":"\u6062\u590d\u5230\u6700\u65b0\u5df2\u53d1\u5e03\u7248\u672c\uff1f","editor.quit-dialog.title.page.delete":"\u5220\u9664\u672a\u53d1\u5e03\u7684\u9875\u9762\uff1f","editor.quit-dialog.title.publish":"\u53d1\u5e03\u6240\u6709\u53d8\u66f4\uff1f","template.content.ariaLabel":"\u6a21\u677f\u5185\u5bb9","page.content.ariaLabel":"\u9875\u9762\u5185\u5bb9","blogpost.content.ariaLabel":"\u535a\u5ba2\u6587\u7ae0\u5185\u5bb9","content.ariaLabel":"\u5185\u5bb9","quick.comment.label.message":"\u7f16\u5199\u8bc4\u8bba"},r=function(e){var t=n[e];if(void 0!==t){for(var a=arguments.length,o=new Array(a>1?a-1:0),i=1;i<a;i++)o[i-1]=arguments[i];return o.length?l(t,...o):t}return e},l=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),o=1;o<t;o++)a[o-1]=arguments[o];return e&&1===(null==a?void 0:a.length)&&Array.isArray(a[0])?i.a.format(e,...a[0]):i.a.format(e,...a)}},5:function(e,t){e.exports=require("ajs")},7:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var o=a(3).a.get("context-path")}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_table-styles-editor', location = 'table-styles-editor.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[27],{395:function(e,l,t){},396:function(e,l,t){},405:function(e,l,t){"use strict";t.r(l);var c=t(11),f=t(1);const a={"000000":"100% \u9ed1\u8272","172b4d":"100% \u6df1\u7070\u8272","42526e":"100% \u4e2d\u7070\u8272","7a869a":"85% \u4e2d\u7070\u8272",c1c7d0:"45% \u4e2d\u7070\u8272",f4f5f7:"100% \u6d45\u7070\u8272",clear:"\u6e05\u9664\u586b\u5145",bf2600:"100% \u6df1\u7ea2\u8272",de350b:"85% \u6df1\u7ea2\u8272",ff5630:"100% \u4e2d\u7ea2\u8272",ff7452:"85% \u4e2d\u7ea2\u8272",ff8f73:"65% \u4e2d\u7ea2\u8272",ffbdad:"100% \u6d45\u7ea2\u8272",ffebe6:"35% \u6d45\u7ea2\u8272",ff8b00:"100% \u6df1\u6a59\u8272",ff991f:"85% \u6df1\u6a59\u8272",ffab00:"100% \u4e2d\u6a59\u8272",ffc400:"100% \u4e2d\u9ec4\u8272",ffe380:"45% \u4e2d\u9ec4\u8272",fff0b3:"100% \u6d45\u9ec4\u8272",fffae6:"35% \u6d45\u9ec4\u8272","006644":"100% \u6df1\u7eff\u8272","00875a":"85% \u6df1\u7eff\u8272","36b37e":"100% \u4e2d\u7eff\u8272","57d9a3":"65% \u4e2d\u7eff\u8272","79f2c0":"45% \u4e2d\u7eff\u8272",abf5d1:"100% \u6d45\u7eff\u8272",e3fcef:"35% \u6d45\u7eff\u8272","008da6":"100% \u6df1\u9752\u8272","00a3bf":"85% \u6df1\u9752\u8272","00b8d9":"100% \u4e2d\u9752\u8272","00c7e6":"85% \u4e2d\u9752\u8272","79e2f2":"45% \u4e2d\u9752\u8272",b3f5ff:"100% \u6d45\u9752\u8272",e6fcff:"35% \u6d45\u9752\u8272","0747a6":"100% \u6df1\u84dd\u8272","0052cc":"85% \u6df1\u84dd\u8272","0065ff":"100% \u4e2d\u84dd\u8272","2684ff":"85% \u4e2d\u84dd\u8272","4c9aff":"65% \u4e2d\u84dd\u8272",b3d4ff:"100% \u6d45\u84dd\u8272",deebff:"35% \u6d45\u84dd\u8272",403294:"100% \u6df1\u7d2b\u8272","5243aa":"85% \u6df1\u7d2b\u8272","6554c0":"100% \u4e2d\u7d2b\u8272","8777d9":"85% \u4e2d\u7d2b\u8272","998dd9":"65% \u4e2d\u7d2b\u8272",c0b6f2:"100% \u6d45\u7d2b\u8272",eae6ff:"35% \u6d45\u7d2b\u8272"},n=["bf2600","ff8b00","006644","008da6","0747a6","403294","000000","de350b","ff991f","00875a","00a3bf","0052cc","5243aa","172b4d","ff5630","ffab00","36b37e","00b8d9","0065ff","6554c0","42526e","ff7452","ffc400","57d9a3","00c7e6","2684ff","8777d9","7a869a","ff8f73","ffe380","79f2c0","79e2f2","4c9aff","998dd9","c1c7d0","ffbdad","fff0b3","abf5d1","b3f5ff","b3d4ff","c0b6f2","f4f5f7","ffebe6","fffae6","e3fcef","e6fcff","deebff","eae6ff","clear"];t(395),t(396);Object(c.a)("confluence/table-color-names",()=>({colorNames:a,colorValues:n}))}},[[405,0,3,5,7,2,6]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-internationalisation', location = 'i18n/translations.i18n.js' */
define("confluence-editor/i18n/translations.i18n",["ajs"],function(a){return{popup_blocked:"\u6d4f\u89c8\u5668\u963b\u6b62\u4e86\u7f16\u8f91\u5668\u6253\u5f00\u7684\u5f39\u51fa\u6846\u3002",ctrl_key:"Ctrl",shift_key:"Shift",Close:"\u5173\u95ed",searchreplace:{search_desc:"\u67e5\u627e",replace_desc:"\u67e5\u627e/\u66ff\u6362"},searchreplace_dlg:{allreplacedplural:"{0} \u88ab\u66ff\u6362",
allreplacedsingular:"1 \u4e2a\u88ab\u66ff\u6362",notfound:"\u6ca1\u6709\u4efb\u4f55\u66ff\u6362\u3002",findlabel:"\u67e5\u627e",replacelabel:"\u66ff\u6362",findnext:"\u4e0b\u4e00\u4e2a",findprevious:"\u4e0a\u4e00\u4e2a",replace:"\u66ff\u6362",replaceall:"\u5168\u90e8\u66ff\u6362",
close:"\u5173\u95ed"},advhr:{advhr_desc:"tinymce.advhr.advhr_desc"},emotions:{emotions_desc:"tinymce.emotions.emotions_desc"},emotions_dlg:{title:"tinymce.emotions_dlg.title",desc:"tinymce.emotions_dlg.desc",smile:"tinymce.emotions_dlg.smile",sad:"tinymce.emotions_dlg.sad",tongue:"tinymce.emotions_dlg.tongue",biggrin:"tinymce.emotions_dlg.biggrin",
wink:"tinymce.emotions_dlg.wink",thumbs_up:"tinymce.emotions_dlg.thumbs_up",thumbs_down:"tinymce.emotions_dlg.thumbs_down",information:"tinymce.emotions_dlg.information",check:"tinymce.emotions_dlg.check",error:"tinymce.emotions_dlg.error",warning:"tinymce.emotions_dlg.warning",add:"tinymce.emotions_dlg.add",forbidden:"tinymce.emotions_dlg.forbidden",help_16:"tinymce.emotions_dlg.help_16",
lightbulb_on:"tinymce.emotions_dlg.lightbulb_on",lightbulb:"tinymce.emotions_dlg.lightbulb",star_yellow:"tinymce.emotions_dlg.star_yellow",star_red:"tinymce.emotions_dlg.star_red",star_green:"tinymce.emotions_dlg.star_green",star_blue:"tinymce.emotions_dlg.star_blue",heart:"tinymce.emotions_dlg.heart",broken_heart:"tinymce.emotions_dlg.broken_heart"},confluence:{conf_macro_browser:"\u5b8f",
conf_macro_browser_desc:"\u63d2\u5165\u5b8f",conf_image:"\u56fe\u7247",confimage_desc:"\u63d2\u5165\u56fe\u50cf",conf_file:"\u6587\u4ef6\u548c\u56fe\u7247",confifile_desc:"\u63d2\u5165\u6587\u4ef6\u548c\u56fe\u7247",conf_link:"\u94fe\u63a5",conflink_desc:"\u63d2\u5165\u94fe\u63a5",conf_table:"\u8868\u683c",
conf_wikimarkup:"Wiki\u6807\u8bb0",conf_wikimarkup_desc:"\u63d2\u5165Wiki\u6807\u8bb0",conf_wikimarkup_errors:"Wiki\u6807\u8bb0\u8f6c\u6362\u9519\u8bef",conf_wikimarkup_timeout:"\u670d\u52a1\u5668\u5904\u7406wiki\u6807\u8bb0\u65f6\u95f4\u8fc7\u957f\uff0c\u4e5f\u8bb8\u662f\u5076\u53d1\u95ee\u9898\uff0c\u53ef\u4ee5\u7a0d\u540e\u518d\u8bd5\u3002",conf_wikimarkup_hint:"\u63d0\u793a: \u53ef\u4ee5\u5728\u7f16\u8f91\u5668\u4e2d\u76f4\u63a5\u8f93\u5165wiki\u6807\u8bb0\uff0c\u7cfb\u7edf\u4f1a\u8fdb\u884c\u683c\u5f0f\u5904\u7406\u3002",conf_wikimarkup_markdown_label:"\u8fdb\u884c\u6807\u8bb0",
conf_wikimarkup_confluence_label:"\u4f01\u4e1a\u7ef4\u57fa",conf_shortcuts_help_desc:"\u952e\u76d8\u5feb\u6377\u65b9\u5f0f\u5e2e\u52a9",conf_insert_button_title:"\u63d2\u5165"},table:{desc:"\u63d2\u5165\u8868\u683c",row_before_desc:"\u6b64\u524d\u63d2\u5165\u884c",row_after_desc:"\u6b64\u540e\u63d2\u5165\u884c",delete_row_desc:"\u5220\u9664\u884c",
numbering_column_desc:"\u63d2\u5165\u884c\u53f7\u5217",responsive:"\u53cd\u5e94\u7075\u654f\u7684",responsive_tooltip:"\u968f\u7740\u60a8\u6dfb\u52a0\u5185\u5bb9\u8868\u683c\u7684\u5217\u53d8\u5bbd\u3002\u62d6\u52a8\u5217\u7684\u8fb9\u754c\uff0c\u76f8\u5bf9\u5f7c\u6b64\u548c\u9875\u9762\u8bbe\u7f6e\u5bbd\u5ea6\u3002",fixed_width:"\u56fa\u5b9a\u5bbd\u5ea6",fixed_width_tooltip:"\u62d6\u52a8\u5217\u8fb9\u6846\u8bbe\u7f6e\u5bbd\u5ea6\u3002\u8be5\u8868\u603b\u662f\u4ee5\u60a8\u8bbe\u7f6e\u7684\u5bbd\u5ea6\u51fa\u73b0\u3002",col_before_desc:"\u6b64\u524d\u63d2\u5165\u5217",col_after_desc:"\u6b64\u540e\u63d2\u5165\u5217",col_copy_desc:"\u590d\u5236\u5217",
col_paste_desc:"\u7c98\u8d34\u5217",col_cut_desc:"\u526a\u5207\u5217",delete_col_desc:"\u5220\u9664\u5217",split_cells_desc:"\u5206\u5272\u5408\u5e76\u7684\u5355\u5143\u683c",merge_cells_desc:"\u5408\u5e76\u5355\u5143\u683c",row_desc:"tinymce.table.row_desc",cell_desc:"tinymce.table.cell_desc",props_desc:"tinymce.table.props_desc",paste_row_before_desc:"\u7c98\u8d34\u884c",
paste_row_after_desc:"\u6b64\u540e\u7c98\u8d34\u884c",cut_row_desc:"\u526a\u5207\u884c",copy_row_desc:"\u590d\u5236\u884c",del:"\u5220\u9664\u8868\u683c",row:"\u884c",col:"\u5217",cell:"\u5355\u5143\u683c",row_highlight:"\u8868\u5934\u884c",col_highlight:"\u8868\u5934\u5217",selection_highlight:"\u66f4\u6539\u5355\u5143\u683c\u989c\u8272",
invalid_table_field:"\u884c\u6570\u3001\u5217\u6570\u5fc5\u987b\u5927\u4e8e0\u3002",table_more_heading:"\u8868\u683c\u8bbe\u7f6e",cell_background_color:"\u80cc\u666f\u989c\u8272\uff1a{0}",cut_row_desc_shortcut:"Ctrl+Shift+X",copy_row_desc_shortcut:"Ctrl+Shift+C",paste_row_before_desc_shortcut:"Ctrl+Shift+V",row_before_desc_shortcut:"Alt+\u2191",
row_after_desc_shortcut:"Alt+\u2193"},advanced:{style_select:"tinymce.advanced.style_select",font_size:"tinymce.advanced.font_size",fontdefault:"tinymce.advanced.fontdefault",block:"\u683c\u5f0f",paragraph:"\u6b63\u6587",pre:"\u9884\u683c\u5f0f\u5316",h1:"\u6807\u9898 1",h2:"\u6807\u9898 2",h3:"\u6807\u9898 3",
h4:"\u6807\u9898 4",h5:"\u6807\u9898 5",h6:"\u6807\u9898 6",blockquote:"\u5f15\u7528",code:"tinymce.advanced.code",samp:"tinymce.advanced.samp",dt:"tinymce.advanced.dt",dd:"tinymce.advanced.dd",bold_desc:"\u7c97\u4f53",italic_desc:"\u659c\u4f53",underline_desc:"\u4e0b\u5212\u7ebf",
striketrough_desc:"\u5220\u9664\u7ebf",justifyleft_desc:"\u5de6\u5bf9\u9f50",justifycenter_desc:"\u5c45\u4e2d",justifyright_desc:"\u53f3\u5bf9\u9f50",justifyfull_desc:"\u5145\u6ee1",bullist_desc:"\u65e0\u5e8f\u5217\u8868",numlist_desc:"\u6709\u5e8f\u5217\u8868",tasklist_desc:"\u4efb\u52a1\u5217\u8868",
outdent_desc:"\u51cf\u5c0f\u7f29\u8fdb",indent_desc:"\u589e\u5927\u7f29\u8fdb",undo_desc:"\u56de\u9000",redo_desc:"\u91cd\u505a",link_desc:"tinymce.advanced.link_desc",unlink_desc:"\u53d6\u6d88\u94fe\u63a5",image_desc:"tinymce.advanced.image_desc",cleanup_desc:"tinymce.advanced.cleanup_desc",code_desc:"tinymce.advanced.code_desc",
sub_desc:"\u4e0b\u6807",sup_desc:"\u4e0a\u6807",hr_desc:"\u6c34\u5e73\u7ebf",removeformat_desc:"tinymce.advanced.removeformat_desc",custom1_desc:"tinymce.advanced.custom1_desc",forecolor_desc:"\u9009\u62e9\u6587\u672c\u989c\u8272",backcolor_desc:"tinymce.advanced.backcolor_desc",visualaid_desc:"tinymce.advanced.visualaid_desc",anchor_desc:"tinymce.advanced.anchor_desc",
cut_desc:"tinymce.advanced.cut_desc",copy_desc:"tinymce.advanced.copy_desc",paste_desc:"tinymce.advanced.paste_desc",image_props_desc:"tinymce.advanced.image_props_desc",newdocument_desc:"tinymce.advanced.newdocument_desc",help_desc:"\u5e2e\u52a9",blockquote_desc:"tinymce.advanced.blockquote_desc",path:"tinymce.advanced.path",newdocument:"tinymce.advanced.newdocument",
toolbar_focus:"tinymce.advanced.toolbar_focus",more_colors:"tinymce.advanced.more_colors",paragraph_shortcut:"Ctrl+0",pre_shortcut:"Ctrl+7",h1_shortcut:"Ctrl+1",h2_shortcut:"Ctrl+2",h3_shortcut:"Ctrl+3",h4_shortcut:"Ctrl+4",h5_shortcut:"Ctrl+5",
h6_shortcut:"Ctrl+6",blockquote_shortcut:"Ctrl+8",bullist_shortcut:"Ctrl+Shift+B",numlist_shortcut:"Ctrl+Shift+N",tasklist_shortcut:"[ then ]",undo_shortcut:"Ctrl+Z",redo_shortcut:"Ctrl+Y"},colorpicker:{more_colors:"\u66f4\u591a\u989c\u8272",
title:"\u9009\u62e9\u989c\u8272",picker_tab:"\u9009\u62e9\u5668",picker_title:"\u989c\u8272\u9009\u62e9\u5668",palette_title:"tinymce.colorpicker.palette_title",named_tab:"tinymce.colorpicker.named_tab",named_title:"tinymce.colorpicker.named_title",color:"\u989c\u8272",name:"tinymce.colorpicker.name",apply:"tinymce.colorpicker.apply"},
hints:{drafts:"\u63d0\u793a: Confluence\u4f1a\u81ea\u52a8\u4fdd\u5b58\u8349\u7a3f\uff0c\u5982\u679c\u9000\u51fa\u4e86\u7a97\u4f53\uff0c\u53ef\u4ee5\u9009\u62e9\u0022\u7528\u6237\u540d -\u003e \u8349\u7a3f\u0022 \u83dc\u5355\u6062\u590d\u5de5\u4f5c\u3002",dnd:"\u63d0\u793a: \u53ef\u4ee5\u5c06\u56fe\u7247\u548cOffice\u6587\u4ef6\u76f4\u63a5\u62d6\u653e\u5230\u7f16\u8f91\u5668\u4e2d\u3002",insert_link_recently_viewed:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 \u67e5\u770b\u5efa\u8bae\u9875\u9762\u5217\u8868\u5e76\u63d2\u5165\u94fe\u63a5\u3002",insert_link_search:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 \u53ca\u90e8\u5206\u9875\u9762\u6807\u9898\u8fdb\u884c\u67e5\u627e\u5e76\u94fe\u63a5\u5230\u9875\u9762\u3002",insert_link_end:"\u63d0\u793a: \u5728\u4e00\u4e2a\u8bcd\u540e\u6309\u4e0b \u003cstrong\u003eCtrl+Shift+K\u003c/strong\u003e \u67e5\u627e\u5e76\u94fe\u63a5\u5230\u76f8\u5173\u9875\u9762\uff0c\u518d\u6b21\u6309\u4e0b\u7ec4\u5408\u952e\u4f1a\u83b7\u5f97\u66f4\u591a\u5efa\u8bae\u3002",insert_link_newpage:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 \u548c\u5e0c\u671b\u521b\u5efa\u7684\u9875\u9762\u6807\u9898\uff0c\u5c06\u4f1a\u770b\u5230\u63d2\u5165\u94fe\u63a5\u7684\u5efa\u8bae\u3002",insert_link_user_mention:"\u63d0\u793a: \u5728Confluence\u4e2d\u63d0\u53ca\u67d0\u4eba\u65f6\uff0c\u8f93\u5165 \u0022\u003cstrong\u003e@\u003c/strong\u003e\u0022\u7136\u540e\u662f\u540d\u5b57\u5373\u53ef\u3002",insert_image_on_page:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 \u67e5\u770b\u9875\u9762\u9644\u4ef6\u5e76\u9009\u62e9\u4e00\u4e2a\u63d2\u5165\u3002",
insert_image_search:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 \u53ca\u90e8\u5206\u56fe\u7247\u540d\u79f0\u8fdb\u884c\u67e5\u627e\u5e76\u63d2\u5165\u56fe\u7247\u3002",insert_image_end:"\u63d0\u793a: \u5728\u4e00\u4e2a\u8bcd\u540e\u6309\u4e0b \u003cstrong\u003eCtrl+Shift+M\u003c/strong\u003e \u67e5\u627e\u5e76\u63d2\u5165\u76f8\u5173\u56fe\u7247\u3002",insert_wikimarkup:"\u63d0\u793a: \u7f16\u8f91\u5668\u5c06\u6839\u636e\u8f93\u5165\u81ea\u52a8\u8f6c\u6362wiki\u6807\u8bb0\u3002",insert_wikimarkup_dialog:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+D\u003c/strong\u003e\u6253\u5f00Wiki\u6807\u8bb0\u5bf9\u8bdd\u6846\u3002",insert_link:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+K\u003c/strong\u003e \u6253\u5f00\u94fe\u63a5\u6d4f\u89c8\u5668\u3002",insert_image:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+M\u003c/strong\u003e \u6253\u5f00\u56fe\u7247\u6d4f\u89c8\u5668\u3002",insert_macro:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+A\u003c/strong\u003e \u6253\u5f00\u5b8f\u6d4f\u89c8\u5668\u3002",insert_macro_toc:"\u63d0\u793a: \u8ba9Confluence\u4e3a\u672c\u9875\u4ea7\u751f\u8868\u683c\u5185\u5bb9\uff0c \u4f7f\u7528\u0022\u63d2\u5165 -\u003e \u8868\u683c\u5185\u5bb9\u0022",
insert_bullet_list:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+B\u003c/strong\u003e \u5f15\u5165\u9879\u76ee\u7b26\u53f7\u5217\u8868\u3002",insert_numbered_list:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+N\u003c/strong\u003e \u5f15\u5165\u6570\u5b57\u5217\u8868\u3002",insert_heading:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+1\u003c/strong\u003e \u5f15\u5165\u4e00\u7ea7\u6807\u9898, \u6309\u4e0b\u003cstrong\u003eCtrl+2\u003c/strong\u003e \u5f15\u5165\u4e8c\u7ea7\u6807\u9898\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002",insert_table:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+I\u003c/strong\u003e \u63d2\u5165\u5230\u8868\u4e2d\u3002",table_rows_copy:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+C\u003c/strong\u003e \u590d\u5236\u4e00\u884c\uff0c\u518d\u6309 \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e \u5c06\u590d\u5236\u5185\u5bb9\u7c98\u8d34\u5230\u8868\u4e2d\u3002",table_rows_cut:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+X\u003c/strong\u003e \u526a\u5207\u4e00\u884c\uff0c\u518d\u6309 \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e \u5c06\u526a\u5207\u5185\u5bb9\u7c98\u8d34\u5230\u8868\u4e2d\u3002",insert_newline:"\u63d0\u793a: \u8f93\u5165 \u003cstrong\u003eShift+Enter\u003c/strong\u003e \u63d2\u5165\u65e0\u7f29\u8fdb\u7684\u65b0\u6bb5\u843d\u3002",autoformat_heading1:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003eh1. \u6807\u9898\u003c/strong\u003e\u0022 \u5feb\u901f\u63d2\u5165\u6807\u98981\u7c7b\u578b\u7684\u6587\u672c\u3002",
autoformat_heading3:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003eh3. \u6807\u9898\u003c/strong\u003e\u0022 \u5feb\u901f\u63d2\u5165\u6807\u98981\u7c7b\u578b\u7684\u6587\u672c\u3002",autoformat_code:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e{{code}}\u003c/strong\u003e\u0022 \u5feb\u901f\u63d2\u5165\u7b49\u5bbd\u6587\u672c\u3002"},auiwindowmanager:{cancel:"\u53d6\u6d88",ok:"\u786e\u8ba4"},propertypanel:{links_goto:"\u8bbf\u95ee\u94fe\u63a5",links_edit:"\u7f16\u8f91",links_unlink:"\u53d6\u6d88\u94fe\u63a5",links_goto_disabled_tooltip:"\u8be5\u94fe\u63a5\u6307\u5411\u9875\u9762\u4e0a\u60a8\u6b63\u5728\u7f16\u8f91\u7684\u5185\u5bb9",
links_edit_tooltip:"\u5728\u5bf9\u8bdd\u6846\u4e2d\u7f16\u8f91\u94fe\u63a5",links_unlink_tooltip:"\u7528\u94fe\u63a5\u5185\u5bb9\u66ff\u6362\u94fe\u63a5",images_small:"\u5c0f",images_medium:"\u4e2d",images_large:"\u5927",images_original:"\u539f\u59cb\u5927\u5c0f",images_border:"\u8fb9\u6846",images_link_create:"\u94fe\u63a5",
images_link_edit:"\u7f16\u8f91\u94fe\u63a5",images_link_remove:"\u53d6\u6d88\u94fe\u63a5",images_link_create_tooltip:"\u56fe\u7247\u94fe\u63a5\u81f3\u5176\u4ed6\u5185\u5bb9\u3002",images_link_edit_tooltip:"\u7f16\u8f91\u56fe\u7247\u94fe\u63a5",images_link_remove_tooltip:"\u5220\u9664\u6b64\u56fe\u7247\u7684\u94fe\u63a5",images_sizing_tooltip:"\u8c03\u6574\u56fe\u7247\u81f3\u7279\u5b9a\u5bbd\u5ea6",
images_small_tooltip:"\u7f29\u5c0f\u56fe\u7247\u5e76\u94fe\u63a5\u5230\u539f\u59cb\u56fe\u7247",images_medium_tooltip:"\u8c03\u6574\u56fe\u7247\u5927\u5c0f\u5e76\u94fe\u63a5\u5230\u539f\u59cb\u56fe\u7247",images_large_tooltip:"\u8c03\u6574\u56fe\u7247\u81f3\u5927\u56fe\u5e76\u94fe\u63a5\u5230\u6e90\u6587\u4ef6",images_original_tooltip:"\u6062\u590d\u56fe\u7247\u539f\u59cb\u5927\u5c0f",images_thumbnail_tooltip:"tinymce.propertypanel.images.thumbnail.tooltip",images_border_tooltip:"\u5728\u56fe\u7247\u5468\u56f4\u52a0\u8fb9\u6846"},
toolbar:{insert_files_shortcut_tooltip:"Ctrl+M"},a11ychecker:{btn_tooltip:"\u68c0\u67e5\u53ef\u8bbf\u95ee\u6027"},base64image:{warning:"\u65e0\u6cd5\u7c98\u8d34\u60a8\u7684\u56fe\u7247\u3002\u8bf7\u5148\u5c1d\u8bd5\u4e0b\u8f7d\u6587\u4ef6\u3002"}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/i18n/translations.i18n","TinyMCELang");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dictionary', location = '/includes/js/api/dictionary.js' */
define("confluence/api/dictionary",[],function(){return function(){var a={};return{get:function(b){return a[b]},put:function(b,c){return a[b]=c},reset:function(){a={}},elements:function(){return a}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:macro-js-overrides', location = '/includes/js/macro-js-overrides.js' */
define("confluence/macro-js-overrides",["confluence/api/dictionary","underscore"],function(f,e){var a=new f;return e.extend(a,{getFunction:function(b,c){var d=a.get(b);if(d&&"function"===typeof d[c])return d[c]},assignFunction:function(b,c){a.put(b,e.extend({},a.get(b),c))}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-resolver.js' */
define("confluence-ui-components/js/internal/space-resolver",["underscore","jquery","ajs"],function(g,m,e){function p(a){return g.map(a,function(c){return"spaceKey\x3d"+encodeURI(c)}).join("\x26")}function k(a,c){var f="undefined"===typeof c;c=g.escape(f?a:c);return{id:a,text:c,idOnly:f}}var n={conf_all:"\u5168\u90e8\u7a7a\u95f4",conf_current:"\u5f53\u524d\u7a7a\u95f4",conf_favorites:"\u6536\u85cf\u7684\u7a7a\u95f4",
conf_global:"\u7ad9\u70b9\u7a7a\u95f4",conf_personal:"\u4e2a\u4eba\u7a7a\u95f4"},q=["conf_favorites","conf_global","conf_personal"];return{getSpaceDisplayItems:function(a,c){var f={},l=[];g.each(a,function(d){var b=n[d];b?f[d]=k(d,b):l.push(d)});if(l.length){var h=e.contextPath()+"/rest/api/space?"+p(l);h=m.getJSON(h)}else h=new m.Deferred,h.resolve({results:[]});h.done(function(d){g.each(d.results,
function(b){f[b.key]=k(b.key,b.name)});d=g.map(a,function(b){return f[b]||k(b)});c(d)})},getSpaceCategoryDisplayName:function(a){return n[a]},getSpaceTypeKeys:function(){return q}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/space-picker.js' */
define("confluence-ui-components/js/space-picker",["underscore","ajs","jquery","confluence-ui-components/js/internal/space-resolver"],function(g,h,k,l){function r(a){var b=t(),d=u(a);return function(c,e,f){if(2>c.term.length)return d(c);"function"===typeof e&&(c.term=e(c.term));m=v(f);return b(c)}}function n(a,b,d){var c=[];a.forEach(function(e){if(e.children){var f=n(e.children,b,d);f.length&&c.push(k.extend({},e,{children:f}))}else if(f="undefined"!==typeof e.id&&g.contains(l.getSpaceTypeKeys(),
e.id),b&&f||!b&&!f)g.contains(d,e.id)||c.push(e)});return c}function p(a,b){if(!a.length||!b.length)return a;var d=0<g.intersection(b,l.getSpaceTypeKeys()).length;a=n(a,d,b);a.length||a.push({text:"\u4e0d\u80fd\u901a\u8fc7\u7a7a\u95f4\u7c7b\u578b\u548c\u7a7a\u95f4\u8fc7\u6ee4",disabled:!0});return a}function w(a){var b=k(".select2-container-active").next("input").val().trim();b=""!==b?b.split(","):[];return p(a,b)}var x={data:null,suggestCategories:null},v=function(a){return function(b){b={id:b.spaceKey,
text:b.spaceName};return"function"===typeof a?a(b):b}},m,y=function(a){return function(b,d){b=k(b).val();""!==b&&(b=b.split(","),l.getSpaceDisplayItems(b,function(c){a.multiple||(c=c[0]);d(c)}))}},u=function(a){var b;if(a.suggestCategories)var d={text:"\u9009\u62e9\u4e00\u4e2a\u5efa\u8bae\u6216\u76f4\u63a5\u8f93\u5165\u4ee5\u8fdb\u884c\u641c\u7d22",children:g.map(a.suggestCategories,function(c){return{id:c,text:l.getSpaceCategoryDisplayName(c)}})};return function(c){b?c.callback(b):k.getJSON(h.contextPath()+"/rest/recentlyviewed/1.0/recent/spaces").done(function(e){var f=
{results:[]};d&&f.results.push(d);0<e.length&&f.results.push({text:"\u63a8\u8350\u7684\u7a7a\u95f4",children:g.map(e,function(q){return{id:q.key,text:g.escape(q.name)}})});b=f;c.callback(b)}).fail(function(){h.log("Couldn't fetch recent spaces");var e={results:[]};d&&e.results.push(d);c.callback(e)})}},t=function(){return window.Select2.query.ajax({url:h.contextPath()+"/rest/quicknav/1/search?type\x3dspacedesc\x26type\x3dpersonalspacedesc",data:function(a){return{query:a,
maxPerCategory:25}},quietMillis:250,results:function(a){a=a.contentNameMatches;if(1>=a.length)return{results:[]};a=g.map(a[0],m);return{results:[{text:"\u641c\u7d22\u7ed3\u679c",children:a}]}}})};return{build:function(a){a=g.extend({},x,a);var b={placeholder:"\u9009\u62e9\u7a7a\u95f4",formatResult:function(d,c,e){c.attr("title",k("\x3cdiv/\x3e").html(d.text).text());return k.fn.select2.defaults.formatResult.apply(this,
arguments)},escapeMarkup:function(d){return d},multiple:!0===a.multiple,containerCssClass:"space-picker-container"};a.disableMixedSpaceTypes&&(b.sortResults=w);return a.data?g.extend(b,{data:a.data}):g.extend(b,{initSelection:y(a),query:r(a)})},filterMixedTypesForValues:p}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-picker-legacy.js' */
window.Confluence.UI.Components.SpacePicker=require("confluence-ui-components/js/space-picker");require("ajs").deprecate.prop(window.Confluence.UI.Components.SpacePicker,"build",{sinceVersion:"1.4.22",extraInfo:"Use require('confluence-ui-components/js/space-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--ec56cc9135', location = 'aui.chunk.3558a450eac06ea0dae0--3d3ce11b6e088eab4bf9.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--ec56cc9135"],{"O/HO":function(e,t,a){var i,s,r;
/*!
 * jQuery UI Datepicker 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */s=[a("oDIA"),a("O+lX"),a("M4tZ")],void 0===(r="function"==typeof(i=function(e){var t;function a(e){for(var t,a;e.length&&e[0]!==document;){if(("absolute"===(t=e.css("position"))||"relative"===t||"fixed"===t)&&(a=parseInt(e.css("zIndex"),10),!isNaN(a)&&0!==a))return a;e=e.parent()}return 0}function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=s(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function s(t){var a="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.on("mouseout",a,(function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")})).on("mouseover",a,r)}function r(){e.datepicker._isDisabledDatepicker(t.inline?t.dpDiv.parent()[0]:t.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function n(t,a){for(var i in e.extend(t,a),a)null==a[i]&&(t[i]=a[i]);return t}return e.extend(e.ui,{datepicker:{version:"1.12.1"}}),e.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return n(this._defaults,e||{}),this},_attachDatepicker:function(t,a){var i,s,r;s="div"===(i=t.nodeName.toLowerCase())||"span"===i,t.id||(this.uuid+=1,t.id="dp"+this.uuid),(r=this._newInst(e(t),s)).settings=e.extend({},a||{}),"input"===i?this._connectDatepicker(t,r):s&&this._inlineDatepicker(t,r)},_newInst:function(t,a){return{id:t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:a,dpDiv:a?s(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,a){var i=e(t);a.append=e([]),a.trigger=e([]),i.hasClass(this.markerClassName)||(this._attachments(i,a),i.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(a),e.data(t,"datepicker",a),a.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,a){var i,s,r,n=this._get(a,"appendText"),d=this._get(a,"isRTL");a.append&&a.append.remove(),n&&(a.append=e("<span class='"+this._appendClass+"'>"+n+"</span>"),t[d?"before":"after"](a.append)),t.off("focus",this._showDatepicker),a.trigger&&a.trigger.remove(),"focus"!==(i=this._get(a,"showOn"))&&"both"!==i||t.on("focus",this._showDatepicker),"button"!==i&&"both"!==i||(s=this._get(a,"buttonText"),r=this._get(a,"buttonImage"),a.trigger=e(this._get(a,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:r,alt:s,title:s}):e("<button type='button'></button>").addClass(this._triggerClass).html(r?e("<img/>").attr({src:r,alt:s,title:s}):s)),t[d?"before":"after"](a.trigger),a.trigger.on("click",(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1})))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,a,i,s,r=new Date(2009,11,20),n=this._get(e,"dateFormat");n.match(/[DM]/)&&(t=function(e){for(a=0,i=0,s=0;s<e.length;s++)e[s].length>a&&(a=e[s].length,i=s);return i},r.setMonth(t(this._get(e,n.match(/MM/)?"monthNames":"monthNamesShort"))),r.setDate(t(this._get(e,n.match(/DD/)?"dayNames":"dayNamesShort"))+20-r.getDay())),e.input.attr("size",this._formatDate(e,r).length)}},_inlineDatepicker:function(t,a){var i=e(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(a.dpDiv),e.data(t,"datepicker",a),this._setDate(a,this._getDefaultDate(a),!0),this._updateDatepicker(a),this._updateAlternate(a),a.settings.disabled&&this._disableDatepicker(t),a.dpDiv.css("display","block"))},_dialogDatepicker:function(t,a,i,s,r){var d,c,o,l,h,u=this._dialogInst;return u||(this.uuid+=1,d="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+d+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),e("body").append(this._dialogInput),(u=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},e.data(this._dialogInput[0],"datepicker",u)),n(u.settings,s||{}),a=a&&a.constructor===Date?this._formatDate(u,a):a,this._dialogInput.val(a),this._pos=r?r.length?r:[r.pageX,r.pageY]:null,this._pos||(c=document.documentElement.clientWidth,o=document.documentElement.clientHeight,l=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[c/2-100+l,o/2-150+h]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),u.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",u),this},_destroyDatepicker:function(a){var i,s=e(a),r=e.data(a,"datepicker");s.hasClass(this.markerClassName)&&(i=a.nodeName.toLowerCase(),e.removeData(a,"datepicker"),"input"===i?(r.append.remove(),r.trigger.remove(),s.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):"div"!==i&&"span"!==i||s.removeClass(this.markerClassName).empty(),t===r&&(t=null))},_enableDatepicker:function(t){var a,i,s=e(t),r=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&("input"===(a=t.nodeName.toLowerCase())?(t.disabled=!1,r.trigger.filter("button").each((function(){this.disabled=!1})).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==a&&"span"!==a||((i=s.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,(function(e){return e===t?null:e})))},_disableDatepicker:function(t){var a,i,s=e(t),r=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&("input"===(a=t.nodeName.toLowerCase())?(t.disabled=!0,r.trigger.filter("button").each((function(){this.disabled=!0})).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==a&&"span"!==a||((i=s.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,(function(e){return e===t?null:e})),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,a,i){var s,r,d,c,o=this._getInst(t);if(2===arguments.length&&"string"==typeof a)return"defaults"===a?e.extend({},e.datepicker._defaults):o?"all"===a?e.extend({},o.settings):this._get(o,a):null;s=a||{},"string"==typeof a&&((s={})[a]=i),o&&(this._curInst===o&&this._hideDatepicker(),r=this._getDateDatepicker(t,!0),d=this._getMinMaxDate(o,"min"),c=this._getMinMaxDate(o,"max"),n(o.settings,s),null!==d&&void 0!==s.dateFormat&&void 0===s.minDate&&(o.settings.minDate=this._formatDate(o,d)),null!==c&&void 0!==s.dateFormat&&void 0===s.maxDate&&(o.settings.maxDate=this._formatDate(o,c)),"disabled"in s&&(s.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),o),this._autoSize(o),this._setDate(o,r),this._updateAlternate(o),this._updateDatepicker(o))},_changeDatepicker:function(e,t,a){this._optionDatepicker(e,t,a)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var a=this._getInst(e);a&&(this._setDate(a,t),this._updateDatepicker(a),this._updateAlternate(a))},_getDateDatepicker:function(e,t){var a=this._getInst(e);return a&&!a.inline&&this._setDateFromField(a,t),a?this._getDate(a):null},_doKeyDown:function(t){var a,i,s,r=e.datepicker._getInst(t.target),n=!0,d=r.dpDiv.is(".ui-datepicker-rtl");if(r._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),n=!1;break;case 13:return(s=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",r.dpDiv))[0]&&e.datepicker._selectDay(t.target,r.selectedMonth,r.selectedYear,s[0]),(a=e.datepicker._get(r,"onSelect"))?(i=e.datepicker._formatDate(r),a.apply(r.input?r.input[0]:null,[i,r])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(r,"stepBigMonths"):-e.datepicker._get(r,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(r,"stepBigMonths"):+e.datepicker._get(r,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),n=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),n=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,d?1:-1,"D"),n=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(r,"stepBigMonths"):-e.datepicker._get(r,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),n=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,d?-1:1,"D"),n=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(r,"stepBigMonths"):+e.datepicker._get(r,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),n=t.ctrlKey||t.metaKey;break;default:n=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):n=!1;n&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var a,i,s=e.datepicker._getInst(t.target);if(e.datepicker._get(s,"constrainInput"))return a=e.datepicker._possibleChars(e.datepicker._get(s,"dateFormat")),i=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||i<" "||!a||a.indexOf(i)>-1},_doKeyUp:function(t){var a=e.datepicker._getInst(t.target);if(a.input.val()!==a.lastVal)try{e.datepicker.parseDate(e.datepicker._get(a,"dateFormat"),a.input?a.input.val():null,e.datepicker._getFormatConfig(a))&&(e.datepicker._setDateFromField(a),e.datepicker._updateAlternate(a),e.datepicker._updateDatepicker(a))}catch(e){}return!0},_showDatepicker:function(t){var i,s,r,d,c,o,l;"input"!==(t=t.target||t).nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t||(i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),!1!==(r=(s=e.datepicker._get(i,"beforeShow"))?s.apply(t,[t,i]):{})&&(n(i.settings,r),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),d=!1,e(t).parents().each((function(){return!(d|="fixed"===e(this).css("position"))})),c={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),c=e.datepicker._checkOffset(i,c,d),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":d?"fixed":"absolute",display:"none",left:c.left+"px",top:c.top+"px"}),i.inline||(o=e.datepicker._get(i,"showAnim"),l=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",a(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[o]?i.dpDiv.show(o,e.datepicker._get(i,"showOptions"),l):i.dpDiv[o||"show"](o?l:null),e.datepicker._shouldFocusInput(i)&&i.input.trigger("focus"),e.datepicker._curInst=i)))},_updateDatepicker:function(a){this.maxRows=4,t=a,a.dpDiv.empty().append(this._generateHTML(a)),this._attachHandlers(a);var i,s=this._getNumberOfMonths(a),n=s[1],d=17,c=a.dpDiv.find("."+this._dayOverClass+" a");c.length>0&&r.apply(c.get(0)),a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&a.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",d*n+"em"),a.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),a===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(a)&&a.input.trigger("focus"),a.yearshtml&&(i=a.yearshtml,setTimeout((function(){i===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml),i=a.yearshtml=null}),0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,a,i){var s=t.dpDiv.outerWidth(),r=t.dpDiv.outerHeight(),n=t.input?t.input.outerWidth():0,d=t.input?t.input.outerHeight():0,c=document.documentElement.clientWidth+(i?0:e(document).scrollLeft()),o=document.documentElement.clientHeight+(i?0:e(document).scrollTop());return a.left-=this._get(t,"isRTL")?s-n:0,a.left-=i&&a.left===t.input.offset().left?e(document).scrollLeft():0,a.top-=i&&a.top===t.input.offset().top+d?e(document).scrollTop():0,a.left-=Math.min(a.left,a.left+s>c&&c>s?Math.abs(a.left+s-c):0),a.top-=Math.min(a.top,a.top+r>o&&o>r?Math.abs(r+d):0),a},_findPos:function(t){for(var a,i=this._getInst(t),s=this._get(i,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[s?"previousSibling":"nextSibling"];return[(a=e(t).offset()).left,a.top]},_hideDatepicker:function(t){var a,i,s,r,n=this._curInst;!n||t&&n!==e.data(t,"datepicker")||this._datepickerShowing&&(a=this._get(n,"showAnim"),i=this._get(n,"duration"),s=function(){e.datepicker._tidyDialog(n)},e.effects&&(e.effects.effect[a]||e.effects[a])?n.dpDiv.hide(a,e.datepicker._get(n,"showOptions"),i,s):n.dpDiv["slideDown"===a?"slideUp":"fadeIn"===a?"fadeOut":"hide"](a?i:null,s),a||s(),this._datepickerShowing=!1,(r=this._get(n,"onClose"))&&r.apply(n.input?n.input[0]:null,[n.input?n.input.val():"",n]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var a=e(t.target),i=e.datepicker._getInst(a[0]);(a[0].id===e.datepicker._mainDivId||0!==a.parents("#"+e.datepicker._mainDivId).length||a.hasClass(e.datepicker.markerClassName)||a.closest("."+e.datepicker._triggerClass).length||!e.datepicker._datepickerShowing||e.datepicker._inDialog&&e.blockUI)&&(!a.hasClass(e.datepicker.markerClassName)||e.datepicker._curInst===i)||e.datepicker._hideDatepicker()}},_adjustDate:function(t,a,i){var s=e(t),r=this._getInst(s[0]);this._isDisabledDatepicker(s[0])||(this._adjustInstDate(r,a+("M"===i?this._get(r,"showCurrentAtPos"):0),i),this._updateDatepicker(r))},_gotoToday:function(t){var a,i=e(t),s=this._getInst(i[0]);this._get(s,"gotoCurrent")&&s.currentDay?(s.selectedDay=s.currentDay,s.drawMonth=s.selectedMonth=s.currentMonth,s.drawYear=s.selectedYear=s.currentYear):(a=new Date,s.selectedDay=a.getDate(),s.drawMonth=s.selectedMonth=a.getMonth(),s.drawYear=s.selectedYear=a.getFullYear()),this._notifyChange(s),this._adjustDate(i)},_selectMonthYear:function(t,a,i){var s=e(t),r=this._getInst(s[0]);r["selected"+("M"===i?"Month":"Year")]=r["draw"+("M"===i?"Month":"Year")]=parseInt(a.options[a.selectedIndex].value,10),this._notifyChange(r),this._adjustDate(s)},_selectDay:function(t,a,i,s){var r,n=e(t);e(s).hasClass(this._unselectableClass)||this._isDisabledDatepicker(n[0])||((r=this._getInst(n[0])).selectedDay=r.currentDay=e("a",s).html(),r.selectedMonth=r.currentMonth=a,r.selectedYear=r.currentYear=i,this._selectDate(t,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear)))},_clearDate:function(t){var a=e(t);this._selectDate(a,"")},_selectDate:function(t,a){var i,s=e(t),r=this._getInst(s[0]);a=null!=a?a:this._formatDate(r),r.input&&r.input.val(a),this._updateAlternate(r),(i=this._get(r,"onSelect"))?i.apply(r.input?r.input[0]:null,[a,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],"object"!=typeof r.input[0]&&r.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(t){var a,i,s,r=this._get(t,"altField");r&&(a=this._get(t,"altFormat")||this._get(t,"dateFormat"),i=this._getDate(t),s=this.formatDate(a,i,this._getFormatConfig(t)),e(r).val(s))},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,a=new Date(e.getTime());return a.setDate(a.getDate()+4-(a.getDay()||7)),t=a.getTime(),a.setMonth(0),a.setDate(1),Math.floor(Math.round((t-a)/864e5)/7)+1},parseDate:function(t,a,i){if(null==t||null==a)throw"Invalid arguments";if(""===(a="object"==typeof a?a.toString():a+""))return null;var s,r,n,d,c=0,o=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff,l="string"!=typeof o?o:(new Date).getFullYear()%100+parseInt(o,10),h=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,u=(i?i.dayNames:null)||this._defaults.dayNames,p=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,g=(i?i.monthNames:null)||this._defaults.monthNames,_=-1,f=-1,k=-1,D=-1,m=!1,y=function(e){var a=s+1<t.length&&t.charAt(s+1)===e;return a&&s++,a},v=function(e){var t=y(e),i="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,s=new RegExp("^\\d{"+("y"===e?i:1)+","+i+"}"),r=a.substring(c).match(s);if(!r)throw"Missing number at position "+c;return c+=r[0].length,parseInt(r[0],10)},M=function(t,i,s){var r=-1,n=e.map(y(t)?s:i,(function(e,t){return[[t,e]]})).sort((function(e,t){return-(e[1].length-t[1].length)}));if(e.each(n,(function(e,t){var i=t[1];if(a.substr(c,i.length).toLowerCase()===i.toLowerCase())return r=t[0],c+=i.length,!1})),-1!==r)return r+1;throw"Unknown name at position "+c},w=function(){if(a.charAt(c)!==t.charAt(s))throw"Unexpected literal at position "+c;c++};for(s=0;s<t.length;s++)if(m)"'"!==t.charAt(s)||y("'")?w():m=!1;else switch(t.charAt(s)){case"d":k=v("d");break;case"D":M("D",h,u);break;case"o":D=v("o");break;case"m":f=v("m");break;case"M":f=M("M",p,g);break;case"y":_=v("y");break;case"@":_=(d=new Date(v("@"))).getFullYear(),f=d.getMonth()+1,k=d.getDate();break;case"!":_=(d=new Date((v("!")-this._ticksTo1970)/1e4)).getFullYear(),f=d.getMonth()+1,k=d.getDate();break;case"'":y("'")?w():m=!0;break;default:w()}if(c<a.length&&(n=a.substr(c),!/^\s+/.test(n)))throw"Extra/unparsed characters found in date: "+n;if(-1===_?_=(new Date).getFullYear():_<100&&(_+=(new Date).getFullYear()-(new Date).getFullYear()%100+(_<=l?0:-100)),D>-1)for(f=1,k=D;!(k<=(r=this._getDaysInMonth(_,f-1)));)f++,k-=r;if((d=this._daylightSavingAdjust(new Date(_,f-1,k))).getFullYear()!==_||d.getMonth()+1!==f||d.getDate()!==k)throw"Invalid date";return d},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,a){if(!t)return"";var i,s=(a?a.dayNamesShort:null)||this._defaults.dayNamesShort,r=(a?a.dayNames:null)||this._defaults.dayNames,n=(a?a.monthNamesShort:null)||this._defaults.monthNamesShort,d=(a?a.monthNames:null)||this._defaults.monthNames,c=function(t){var a=i+1<e.length&&e.charAt(i+1)===t;return a&&i++,a},o=function(e,t,a){var i=""+t;if(c(e))for(;i.length<a;)i="0"+i;return i},l=function(e,t,a,i){return c(e)?i[t]:a[t]},h="",u=!1;if(t)for(i=0;i<e.length;i++)if(u)"'"!==e.charAt(i)||c("'")?h+=e.charAt(i):u=!1;else switch(e.charAt(i)){case"d":h+=o("d",t.getDate(),2);break;case"D":h+=l("D",t.getDay(),s,r);break;case"o":h+=o("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":h+=o("m",t.getMonth()+1,2);break;case"M":h+=l("M",t.getMonth(),n,d);break;case"y":h+=c("y")?t.getFullYear():(t.getFullYear()%100<10?"0":"")+t.getFullYear()%100;break;case"@":h+=t.getTime();break;case"!":h+=1e4*t.getTime()+this._ticksTo1970;break;case"'":c("'")?h+="'":u=!0;break;default:h+=e.charAt(i)}return h},_possibleChars:function(e){var t,a="",i=!1,s=function(a){var i=t+1<e.length&&e.charAt(t+1)===a;return i&&t++,i};for(t=0;t<e.length;t++)if(i)"'"!==e.charAt(t)||s("'")?a+=e.charAt(t):i=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":a+="0123456789";break;case"D":case"M":return null;case"'":s("'")?a+="'":i=!0;break;default:a+=e.charAt(t)}return a},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var a=this._get(e,"dateFormat"),i=e.lastVal=e.input?e.input.val():null,s=this._getDefaultDate(e),r=s,n=this._getFormatConfig(e);try{r=this.parseDate(a,i,n)||s}catch(e){i=t?"":i}e.selectedDay=r.getDate(),e.drawMonth=e.selectedMonth=r.getMonth(),e.drawYear=e.selectedYear=r.getFullYear(),e.currentDay=i?r.getDate():0,e.currentMonth=i?r.getMonth():0,e.currentYear=i?r.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,a,i){var s=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},r=function(a){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),a,e.datepicker._getFormatConfig(t))}catch(e){}for(var i=(a.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),r=i.getMonth(),n=i.getDate(),d=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,c=d.exec(a);c;){switch(c[2]||"d"){case"d":case"D":n+=parseInt(c[1],10);break;case"w":case"W":n+=7*parseInt(c[1],10);break;case"m":case"M":r+=parseInt(c[1],10),n=Math.min(n,e.datepicker._getDaysInMonth(s,r));break;case"y":case"Y":s+=parseInt(c[1],10),n=Math.min(n,e.datepicker._getDaysInMonth(s,r))}c=d.exec(a)}return new Date(s,r,n)},n=null==a||""===a?i:"string"==typeof a?r(a):"number"==typeof a?isNaN(a)?i:s(a):new Date(a.getTime());return(n=n&&"Invalid Date"===n.toString()?i:n)&&(n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0)),this._daylightSavingAdjust(n)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,a){var i=!t,s=e.selectedMonth,r=e.selectedYear,n=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=n.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=n.getMonth(),e.drawYear=e.selectedYear=e.currentYear=n.getFullYear(),s===e.selectedMonth&&r===e.selectedYear||a||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(i?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_attachHandlers:function(t){var a=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map((function(){var t={prev:function(){e.datepicker._adjustDate(i,-a,"M")},next:function(){e.datepicker._adjustDate(i,+a,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(i)},selectDay:function(){return e.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(i,this,"Y"),!1}};e(this).on(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])}))},_generateHTML:function(e){var t,a,i,s,r,n,d,c,o,l,h,u,p,g,_,f,k,D,m,y,v,M,w,b,C,I,x,Y,S,F,N,T,A,K,j,O,R,L,W,E=new Date,H=this._daylightSavingAdjust(new Date(E.getFullYear(),E.getMonth(),E.getDate())),P=this._get(e,"isRTL"),U=this._get(e,"showButtonPanel"),z=this._get(e,"hideIfNoPrevNext"),J=this._get(e,"navigationAsDateFormat"),B=this._getNumberOfMonths(e),V=this._get(e,"showCurrentAtPos"),X=this._get(e,"stepMonths"),Z=1!==B[0]||1!==B[1],$=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),q=this._getMinMaxDate(e,"min"),G=this._getMinMaxDate(e,"max"),Q=e.drawMonth-V,ee=e.drawYear;if(Q<0&&(Q+=12,ee--),G)for(t=this._daylightSavingAdjust(new Date(G.getFullYear(),G.getMonth()-B[0]*B[1]+1,G.getDate())),t=q&&t<q?q:t;this._daylightSavingAdjust(new Date(ee,Q,1))>t;)--Q<0&&(Q=11,ee--);for(e.drawMonth=Q,e.drawYear=ee,a=this._get(e,"prevText"),a=J?this.formatDate(a,this._daylightSavingAdjust(new Date(ee,Q-X,1)),this._getFormatConfig(e)):a,i=this._canAdjustMonth(e,-1,ee,Q)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+a+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"e":"w")+"'>"+a+"</span></a>":z?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+a+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"e":"w")+"'>"+a+"</span></a>",s=this._get(e,"nextText"),s=J?this.formatDate(s,this._daylightSavingAdjust(new Date(ee,Q+X,1)),this._getFormatConfig(e)):s,r=this._canAdjustMonth(e,1,ee,Q)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+s+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"w":"e")+"'>"+s+"</span></a>":z?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+s+"'><span class='ui-icon ui-icon-circle-triangle-"+(P?"w":"e")+"'>"+s+"</span></a>",n=this._get(e,"currentText"),d=this._get(e,"gotoCurrent")&&e.currentDay?$:H,n=J?this.formatDate(n,d,this._getFormatConfig(e)):n,c=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",o=U?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(P?c:"")+(this._isInRange(e,d)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+n+"</button>":"")+(P?"":c)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,h=this._get(e,"showWeek"),u=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),g=this._get(e,"monthNames"),_=this._get(e,"monthNamesShort"),f=this._get(e,"beforeShowDay"),k=this._get(e,"showOtherMonths"),D=this._get(e,"selectOtherMonths"),m=this._getDefaultDate(e),y="",M=0;M<B[0];M++){for(w="",this.maxRows=4,b=0;b<B[1];b++){if(C=this._daylightSavingAdjust(new Date(ee,Q,e.selectedDay)),I=" ui-corner-all",x="",Z){if(x+="<div class='ui-datepicker-group",B[1]>1)switch(b){case 0:x+=" ui-datepicker-group-first",I=" ui-corner-"+(P?"right":"left");break;case B[1]-1:x+=" ui-datepicker-group-last",I=" ui-corner-"+(P?"left":"right");break;default:x+=" ui-datepicker-group-middle",I=""}x+="'>"}for(x+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+I+"'>"+(/all|left/.test(I)&&0===M?P?r:i:"")+(/all|right/.test(I)&&0===M?P?i:r:"")+this._generateMonthYearHeader(e,Q,ee,q,G,M>0||b>0,g,_)+"</div><table class='ui-datepicker-calendar'><thead><tr>",Y=h?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",v=0;v<7;v++)Y+="<th scope='col'"+((v+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+u[S=(v+l)%7]+"'>"+p[S]+"</span></th>";for(x+=Y+"</tr></thead><tbody>",F=this._getDaysInMonth(ee,Q),ee===e.selectedYear&&Q===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,F)),N=(this._getFirstDayOfMonth(ee,Q)-l+7)%7,T=Math.ceil((N+F)/7),A=Z&&this.maxRows>T?this.maxRows:T,this.maxRows=A,K=this._daylightSavingAdjust(new Date(ee,Q,1-N)),j=0;j<A;j++){for(x+="<tr>",O=h?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(K)+"</td>":"",v=0;v<7;v++)R=f?f.apply(e.input?e.input[0]:null,[K]):[!0,""],W=(L=K.getMonth()!==Q)&&!D||!R[0]||q&&K<q||G&&K>G,O+="<td class='"+((v+l+6)%7>=5?" ui-datepicker-week-end":"")+(L?" ui-datepicker-other-month":"")+(K.getTime()===C.getTime()&&Q===e.selectedMonth&&e._keyEvent||m.getTime()===K.getTime()&&m.getTime()===C.getTime()?" "+this._dayOverClass:"")+(W?" "+this._unselectableClass+" ui-state-disabled":"")+(L&&!k?"":" "+R[1]+(K.getTime()===$.getTime()?" "+this._currentClass:"")+(K.getTime()===H.getTime()?" ui-datepicker-today":""))+"'"+(L&&!k||!R[2]?"":" title='"+R[2].replace(/'/g,"&#39;")+"'")+(W?"":" data-handler='selectDay' data-event='click' data-month='"+K.getMonth()+"' data-year='"+K.getFullYear()+"'")+">"+(L&&!k?"&#xa0;":W?"<span class='ui-state-default'>"+K.getDate()+"</span>":"<a class='ui-state-default"+(K.getTime()===H.getTime()?" ui-state-highlight":"")+(K.getTime()===$.getTime()?" ui-state-active":"")+(L?" ui-priority-secondary":"")+"' href='#'>"+K.getDate()+"</a>")+"</td>",K.setDate(K.getDate()+1),K=this._daylightSavingAdjust(K);x+=O+"</tr>"}++Q>11&&(Q=0,ee++),w+=x+="</tbody></table>"+(Z?"</div>"+(B[0]>0&&b===B[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}y+=w}return y+=o,e._keyEvent=!1,y},_generateMonthYearHeader:function(e,t,a,i,s,r,n,d){var c,o,l,h,u,p,g,_,f=this._get(e,"changeMonth"),k=this._get(e,"changeYear"),D=this._get(e,"showMonthAfterYear"),m="<div class='ui-datepicker-title'>",y="";if(r||!f)y+="<span class='ui-datepicker-month'>"+n[t]+"</span>";else{for(c=i&&i.getFullYear()===a,o=s&&s.getFullYear()===a,y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",l=0;l<12;l++)(!c||l>=i.getMonth())&&(!o||l<=s.getMonth())&&(y+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+d[l]+"</option>");y+="</select>"}if(D||(m+=y+(!r&&f&&k?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",r||!k)m+="<span class='ui-datepicker-year'>"+a+"</span>";else{for(h=this._get(e,"yearRange").split(":"),u=(new Date).getFullYear(),g=(p=function(e){var t=e.match(/c[+\-].*/)?a+parseInt(e.substring(1),10):e.match(/[+\-].*/)?u+parseInt(e,10):parseInt(e,10);return isNaN(t)?u:t})(h[0]),_=Math.max(g,p(h[1]||"")),g=i?Math.max(g,i.getFullYear()):g,_=s?Math.min(_,s.getFullYear()):_,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g<=_;g++)e.yearshtml+="<option value='"+g+"'"+(g===a?" selected='selected'":"")+">"+g+"</option>";e.yearshtml+="</select>",m+=e.yearshtml,e.yearshtml=null}return m+=this._get(e,"yearSuffix"),D&&(m+=(!r&&f&&k?"":"&#xa0;")+y),m+="</div>"},_adjustInstDate:function(e,t,a){var i=e.selectedYear+("Y"===a?t:0),s=e.selectedMonth+("M"===a?t:0),r=Math.min(e.selectedDay,this._getDaysInMonth(i,s))+("D"===a?t:0),n=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(i,s,r)));e.selectedDay=n.getDate(),e.drawMonth=e.selectedMonth=n.getMonth(),e.drawYear=e.selectedYear=n.getFullYear(),"M"!==a&&"Y"!==a||this._notifyChange(e)},_restrictMinMax:function(e,t){var a=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max"),s=a&&t<a?a:t;return i&&s>i?i:s},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,a,i){var s=this._getNumberOfMonths(e),r=this._daylightSavingAdjust(new Date(a,i+(t<0?t:s[0]*s[1]),1));return t<0&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(e,r)},_isInRange:function(e,t){var a,i,s=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),n=null,d=null,c=this._get(e,"yearRange");return c&&(a=c.split(":"),i=(new Date).getFullYear(),n=parseInt(a[0],10),d=parseInt(a[1],10),a[0].match(/[+\-].*/)&&(n+=i),a[1].match(/[+\-].*/)&&(d+=i)),(!s||t.getTime()>=s.getTime())&&(!r||t.getTime()<=r.getTime())&&(!n||t.getFullYear()>=n)&&(!d||t.getFullYear()<=d)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,a,i){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var s=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(i,a,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),s,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).on("mousedown",e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var a=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(a)):this.each((function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(a)):e.datepicker._attachDatepicker(this,t)})):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(a))},e.datepicker=new i,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.12.1",e.datepicker})?i.apply(t,s):i)||(e.exports=r)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form.date-select', location = 'aui.chunk.449b4552696409f32ac4--946e836f3a4b598edb97.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form.date-select"],{cQgS:function(e,t,a){"use strict";a.r(t),a.d(t,"DatePicker",(function(){return x}));a("6fSn"),a("Rvtc");var i=a("+x/D"),n=a("O/HO"),o=a.n(n),s=a("JFi+"),d=a("cWqH"),c=a("KloK"),l=a("+ay7"),r=a("HH5i"),u=a("P3bb"),p=a("OEua");const f=e=>{let{dateFormat:t,$field:a,onSelect:i,hide:n,onChangeMonthYear:o}=e;return{dateFormat:t,defaultDate:a.val(),maxDate:a.attr("max"),minDate:a.attr("min"),nextText:">",onSelect:function(e){a.val(e),a.trigger("change"),n(),i&&i.call(this,e)},onChangeMonthYear:o,prevText:"<"}},h=(e,t)=>{let a,n,o,s=!1;const d=Object(i.default)("body"),c=t=>{let a=Object(i.default)(t.target),o=a.closest(n).length||a.is(e),d=a.closest(".ui-datepicker-header").length;if(!o&&!d||t.keyCode===l.default.ESCAPE)return h(),void(s=!1);a.get(0)!==e.get(0)&&t.preventDefault()},r=()=>{s||(d.on("focus blur click mousedown","*",c),s=!0)},p=()=>{a.get(0).open||f()},f=()=>{a.get(0).open=!0},h=()=>{a.get(0).open=!1};return{calendarContainerSelector:null,getPopupContents:e=>{let{$field:l}=e;return a=(e=>{let{horizontalAlignment:t,datePickerUUID:a}=e;const n=new u.default;n.id=a;const o=Object(i.default)(n);return o.attr("persistent",""),o.attr("data-aui-focus","false"),o.attr("alignment","bottom ".concat(t)),o.addClass("aui-datepicker-dialog"),o})({horizontalAlignment:(e=>e.offset().left<window.innerWidth/2?"left":"right")(l),datePickerUUID:t}),o=l.closest("aui-inline-dialog").get(0),o&&(o._datePickerPopup=a,Object(i.default)(o).on("aui-hide",(e=>{s&&e.preventDefault(),d.off("focus blur","*",c),o&&o._datePickerPopup&&delete o._datePickerPopup}))),d.append(a),n=a,a},handleFieldFocus:p,showDatePicker:f,hideDatePicker:h,handleChangeMonthYear:()=>{setTimeout(a.refresh,0)},getCalendarNode:()=>a.get(0).childNodes[0],destroyPolyfill:()=>{h(),e.off("focus click",p),e.off("focusout keydown",r),d.off("keydown",r),d.off("focus blur click mousedown keydown",c)},createPolyfill:function(){d.on("keydown",c),e.on("focusout keydown",r)}}},k=function(e){const t=e.getField(),a=e.getOptions(),n=e.getUUID();let o;const{getPopupContents:d,handleFieldFocus:c,showDatePicker:l,hideDatePicker:r,handleChangeMonthYear:u,getCalendarNode:p,destroyPolyfill:k,createPolyfill:y}=h(t,n),m=e=>{Object(i.default)(e.currentTarget).val()&&o.datepicker("setDate",t.val())},b=t.attr("placeholder"),x=t.prop("type");let j;{const a=e=>t=>{if(void 0!==o)return e(t)},i=a((()=>{o.datepicker("destroy")}));e.show=l,e.hide=r,e.destroyPolyfill=()=>{k(),t.off("propertychange keyup input paste",m),j&&(j.disconnect(),j=null),b&&t.attr("placeholder",b),x&&t.prop("type",x),t.removeAttr("data-aui-dp-uuid"),i(),delete e.destroyPolyfill,delete e.show,delete e.hide},e.setDate=a((e=>{o.datepicker("setDate",e)})),e.getDate=a((()=>o.datepicker("getDate"))),e.setMin=a((e=>o.datepicker("option","minDate",e))),e.setMax=a((e=>o.datepicker("option","maxDate",e)))}a.languageCode in g.prototype.localisations||(a.languageCode="");const T=g.prototype.localisations;if(t.attr("aria-controls",n),void 0===o){void 0!==t.attr("step")&&s.log("WARNING: The date picker polyfill currently does not support the step attribute!");const n=f({dateFormat:a.dateFormat,$field:t,onSelect:a.onSelect,hide:e.hide,onChangeMonthYear:u}),c=i.default.extend(void 0,n,T);a.firstDay>-1&&(c.firstDay=a.firstDay),o=(e=>{let{config:t,popupContents:a,getCalendarNode:n,hint:o}=e;const s=Object(i.default)(n());let d;return s.datepicker(t),o&&(d=Object(i.default)("<div/>").addClass("aui-datepicker-hint"),d.append("<span/>").text(o),a.append(d)),s})({config:c,popupContents:d({$field:t}),getCalendarNode:p,hint:a.hint}),y(),t.on("propertychange keyup input paste",m),j=new MutationObserver((function(t){t.forEach((function(t){"min"===t.attributeName?e.setMin(t.target.getAttribute("min")):"max"===t.attributeName&&e.setMax(t.target.getAttribute("max"))}))})),j.observe(t.get(0),{attributes:!0})}t.on("focus click",c),t.attr("placeholder",a.placeholder),t.prop("type","text"),t.attr("data-aui-dp-uuid",n)};function g(e,t){let a={};const n=Object(p.default)("date-picker"),o=Object(i.default)(e),s={getUUID:()=>n,getField:()=>o,getOptions:()=>a,destroy:()=>{"function"==typeof s.destroyPolyfill&&s.destroyPolyfill()},reset:()=>{s.destroy();const e=!g.prototype.browserSupportsDateField,t=!1!==a.overrideBrowserDefault;(e||t)&&k(s)},reconfigure:e=>{a=i.default.extend(void 0,g.prototype.defaultOptions,e),s.reset()}};return s.reconfigure(t),s}function y(e,t){const a=i.default.extend({nextText:">",prevText:"<"},t),n=Object(i.default)(e).addClass("aui-datepicker-dialog").addClass("aui-calendar-widget").datepicker(a);if(a.hint){const e=Object(i.default)("<div/>").addClass("aui-datepicker-hint");e.append("<span/>").text(a.hint),n.append(e)}return n.reconfigure=e=>{n.datepicker("destroy"),n.datepicker(e)},n.destroy=()=>{n.datepicker("destroy")},n}g.prototype.browserSupportsDateField=Object(d.supportsDateField)(),g.prototype.defaultOptions={overrideBrowserDefault:!1,firstDay:-1,languageCode:Object(i.default)("html").attr("lang")||"en-AU",dateFormat:o.a.W3C},g.prototype.localisations={dayNames:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],dayNamesMin:["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],firstDay:"0",isRTL:"true"==="False",monthNames:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],showMonthAfterYear:"true"==="False",yearSuffix:""};const m="aui-datepicker",b=e=>function(t){let a=this.data(m);return a?"object"==typeof t?a.reconfigure(t):"destroy"===t&&a.destroy():(a=new e(this,t),this.data(m,a)),a};i.default.fn.datePicker=b(g),Object(c.default)("DatePicker",g),i.default.fn.calendarWidget=b(y),Object(c.default)("CalendarWidget",y);var x=g}},[["cQgS","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--084821f40b","aui.splitchunk.vendors--02a4084a95","aui.splitchunk.vendors--ec56cc9135","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.dd803a46b4","aui.splitchunk.994e478d48","aui.splitchunk.d7c46c2734","aui.splitchunk.e54c7c7304","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.f1e06f97a4","aui.splitchunk.479fe6ee76","aui.splitchunk.f673ef53ac","aui.splitchunk.8659b532c1","aui.splitchunk.908fe798b4","aui.splitchunk.5f851f97df","aui.splitchunk.462ee5f9ef","aui.splitchunk.d0110a864f","aui.splitchunk.afa5039e04","aui.splitchunk.bff3715233","aui.splitchunk.26116b3cbd","aui.splitchunk.c750721820","aui.splitchunk.6d6f245ed3","aui.splitchunk.50dca3e042","aui.splitchunk.084821f40b","aui.splitchunk.5b8c290363","aui.splitchunk.baa83dbaf9","aui.splitchunk.e5af17b48e","aui.splitchunk.f154095da3","aui.splitchunk.36cd9d521c","aui.splitchunk.d925afe2c0","aui.splitchunk.5b7fdbd666","aui.splitchunk.8a641c03a4","aui.splitchunk.d727dd207f","aui.splitchunk.543254b237"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:date-picker', location = '/includes/js/amd/shim/aui-datepicker-amd.js' */
define("aui/datepicker",function(){return AJS.DatePicker});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:date-picker', location = '/includes/js/date-picker-localisation.js' */
require(["aui/datepicker"],function(a){var b="";a&&(a.prototype.localisations.dayNames=["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94",
"\u661f\u671f\u516d"],a.prototype.localisations.dayNamesMin=["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94",
"\u5468\u516d"],a.prototype.localisations.firstDay="0",a.prototype.localisations.isRTL="true"==="False",a.prototype.localisations.monthNames=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708",
"\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708",
"\u5341\u4e8c\u6708"],a.prototype.localisations.showMonthAfterYear="true"==="False",a.prototype.localisations.yearSuffix=b&&"null"!==b?b:"")});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:confluence-select', location = '/js/confluence-select.js' */
define("confluence-ui-components/js/confluence-select",["jquery","ajs"],function(b,k){b.fn.confluenceSelect=function(m,n=[]){var f=this.attr("id");if(!f)throw"please set an id attribute to your confluenceSelect input for correct working";var g="#s2id_"+f,p="confluence-select-listbox-"+f,l="confluence-select-description-"+f;this.on("select2-focus",function(){var a=b(g+" input"+(m.multiple?".select2-input":".select2-focusser")),c=a.attr("id"),d="confluence-select-label-"+c,e="confluence-select-option-chosen-"+
c,q=n.concat([d,e]).join(" "),h=b("label[for\x3d"+f+"]");c=b("label[for\x3d"+c+"]");h=h.length?h:c;c=b(g+" span.select2-chosen");a.attr("role","combobox");a.attr("aria-haspopup","listbox");a.attr("aria-controls",p);n.includes("type-picker-custom")?a.attr("aria-label","Custom content type"):a.attr("aria-labeledby",q);c.attr("id",e);h.attr("id",d)});this.on("select2-loaded",function(){var a=b("#select2-drop .select2-results"),c=b("#select2-drop .select2-result:not(.select2-result-unselectable)");
a.attr("role","listbox");a.attr("id",p);c.each(function(d,e){e=b(e);e.attr("role","option");e.attr("id","confluence-select-option-"+d)})});this.on("change",function(){var a=b(g+" .select2-search-choice-close");a.attr("tabindex",0);a.attr("role","button");a.attr("aria-label","\u53d6\u6d88\u9009\u62e9\u9879\u76ee")});this.on("select2-highlight",function(){var a=b("#select2-drop input.select2-input"),c=b(g+" input.select2-input");a=a.length?a:c;c=b("#select2-drop .select2-highlighted");
a.attr("aria-activedescendant",c.attr("id"))});this.on("select2-open",function(){var a=b("#select2-drop input.select2-input"),c=b(g+" input.select2-input");c=a.length?a:c;var d=b("#"+l),e=b(".select2-no-results");d.length||(d=b("\x3cspan\x3e\x3c/span\x3e"),d.attr("id",l),d.text("Type to filter, use up/down arrow keys to navigate & enter to select"),d.addClass("assistive"),a.after(d),a.attr("aria-labeledby",l));e.attr("aria-live","polite");c.attr("aria-activedescendant","")});return b.fn.auiSelect2.call(this,
m)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/js/space-page-picker.js' */
define("confluence-ui-components/js/space-page-picker",["underscore","ajs","confluence-ui-components/js/internal/soy-templates","jquery"],function(f,k,M,l){function N(a,b,c){a=f.map(a,function(d){return b[d]});return c?a:0<a.length?a[0]:null}function H(a){return 0===a.indexOf("page:")?"data-item-id":"data-item-key"}function z(a,b,c,d){c=c?c:0===a.indexOf("~")?"content-type-personalspacedesc":"content-type-spacedesc";return A("space",a,b,"",c,d)}function I(a){var b=O[a];return A("space-cat",a,b,"",
"content-type-space-category",b)}function J(a){var b=P[a];return A("content-function",a,b,"","content-type-page",b)}function B(a,b,c,d,g){return A("page",a,b,c,d,g)}function A(a,b,c,d,g,p){return{id:Q(a,b),text:c?c:b,subText:d,className:p?g:g+" content-not-found",disabled:p?!1:!0}}function Q(){return Array.prototype.slice.apply(arguments).join(":")}function R(a){return(!a.contentType||0===a.contentType.length||0<=a.contentType.indexOf("space"))&&!1!==a.showRecentlyViewedSpaces}function S(a){return(!a.contentType||
0===a.contentType.length||0<=a.contentType.indexOf("page"))&&!1!==a.showRecentlyViewedPages}function T(a,b){b=C("SpaceCat",a,b.inputSpaceCatId,b.inputSpaceCatName?b.inputSpaceCatName:b.inputSpaceCatId);return D(a,b.id,b.name)}function U(a,b){var c=b.inputContentFunctionId||"legacy-macro-param-content-funcs";b=C("ContentFunction",a,c,b.inputContentFunctionName||c);return D(a,b.id,b.name)}function V(a,b){b=C("Space",a,b.inputSpaceId,b.inputSpaceName?b.inputSpaceName:b.inputSpaceId);return D(a,b.id,
b.name)}function W(a,b){b=C("Page",a,b.inputPageId,b.inputPageName?b.inputPageName:b.inputPageId);return D(a,b.id,b.name)}function C(a,b,c,d){if(!c){var g=b.attr("id");if(!g)return null;c=g+a}d||(d=(b.attr("name")||g)+a);return{id:c,name:d}}function D(a,b,c){var d=l("#"+b);0===d.length&&(d=l(M.Components().hiddenField({id:b,name:c})),a.after(d));return d}function v(a,b,c){a&&(b=f.filter(b,function(d){return 0===d.indexOf(c)}),b=f.map(b,function(d){return d.substring(c.length,d.length)}),a.val(b.join(",")))}
function E(a,b,c,d){c=c?f.isArray(c)?c:c.split(","):[];d=d?d.split(","):[];c=f.union(c,d);c=f.map(c,function(g){return b+g});d=(d=a.val())?d.split(","):[];c=f.union(d,c);0<c.length&&a.val(c.join(","))}function K(a,b,c){var d=b.data("select2").opts,g=d.placeholder||b.data("placeholder"),p=T(b,d),r=U(b,d),h=V(b,d),m=W(b,d);b.on("change",function(e){v(p,e.val,"space-cat:");v(r,e.val,"content-function:");v(h,e.val,"space:");v(m,e.val,"page:")});b.val("");var t="SELECT"===b["0"].tagName?b.context.multiple:
d.multiple,F=[],w=[],x=[],L=[],y={},u=a?a.split(","):[];u=f.filter(u,function(e){e=e.split(":");if(2===e.length)return!0;(0>e.length||3<=e.length||1===e.length&&"SPACE-PAGE-TRIGGER-VALUE"!==e[0]&&e[0]!==g)&&k.debug("Error value: "+e)});a=u.join(",");b.val(a);E(b,"space-cat:",d.spaceCatKeys,p?p.val():"");E(b,"content-function:",d.pageCatKeys,r?r.val():"");E(b,"space:",d.spaceKeys,h?h.val():"");E(b,"page:",d.pageIds,m?m.val():"");u=(a=b.val())?a.split(","):[];v(p,u,"space-cat:");v(r,u,"content-function:");
v(h,u,"space:");v(m,u,"page:");if(0!==u.length){f.each(u,function(e,n){n=e.split(":");2===n.length&&(e=n[0],n=n[1],"space-cat"===e?F.push(n):"content-function"===e?x.push(n):"space"===e?w.push(n):"page"===e&&L.push(n))});f.each(F,function(e){y["space-cat:"+e]=I(e)});f.each(x,function(e){y["content-function:"+e]=J(e)});var G=[];0<w.length&&(a=l.getJSON(k.contextPath()+"/rest/prototype/1/space",{spaceKey:w}).done(function(e){var n=[];f.each(e.space,function(q){y["space:"+q.key]=z(q.key,f.escape(q.name),
null,!0);n.push(q.key)});e=f.difference(w,n);f.each(e,function(q){y["space:"+q]=z(q,q,null,!1)})}).fail(function(){k.debug("Couldn't resolve spaceKeys:",w);f.each(w,function(e){y["space:"+e]=z(e,e,null,!1)})}),G.push(a));f.each(L,function(e){var n=l.getJSON(k.contextPath()+"/rest/api/content/"+e,{expand:"space"}).done(function(q){y["page:"+q.id]=B(q.id,f.escape(q.title),f.escape(q.space.name),"content-type-page",!0)}).fail(function(){k.debug("Couldn't resolve pageId:",e);y["page:"+e]=B(e,e,"",
"content-type-page",!1)});G.push(n)});l.when.apply(l,f.map(G,function(e){var n=new l.Deferred;e.always(function(){n.resolve()});return n.promise()})).done(function(){c(N(u,y,t))})}}var O={conf_all:"\u5168\u90e8\u7a7a\u95f4",conf_favorites:"\u6536\u85cf\u7684\u7a7a\u95f4",conf_global:"\u7ad9\u70b9\u7a7a\u95f4",conf_personal:"\u4e2a\u4eba\u7a7a\u95f4",
conf_current:"\u5f53\u524d\u7a7a\u95f4"},P={"currentContent()":"\u5f53\u524d\u9875\u9762"},X={data:null,suggestCategories:null},Y={placeholder:"\u9009\u62e9\u4e00\u4e2a\u7a7a\u95f4\u6216\u9875\u9762",multiple:!0,formatInputTooShort:function(){return "\u5f00\u59cb\u8f93\u5165\u4ee5\u641c\u7d22"},formatResult:function(a,b,c){if(a.children)return b.addClass("space-page-picker-result-category"),
l.fn.select2.defaults.formatResult.apply(this,arguments);if(a.id){b.attr("title",a.text);b.addClass("space-page-picker-result-label-with-icon");var d=l("\x3cspan/\x3e").addClass(a.className+" item-text").html(l.fn.select2.defaults.formatResult.apply(this,arguments)),g=a.subText?l("\x3cspan/\x3e").addClass("space-name").html(a.subText):l("");d=l("\x3cspan/\x3e").attr(H(a.id),a.id).append(d).append(g);return l("\x3cspan/\x3e").append(d)}b.addClass(a.className);return l.fn.select2.defaults.formatResult.apply(this,
arguments)},formatSelection:function(a,b){b.addClass("space-page-picker-selected-item");b.attr("title",a.text);var c=l("\x3cspan/\x3e").attr(H(a.id),a.id).addClass(a.className+" item-text").text(l.fn.select2.defaults.formatSelection.apply(this,arguments));b.append(c)},escapeMarkup:function(a){return a},formatResultCssClass:function(a){return a.children||a.id?"":"select2-result-space-page-separator"},containerCssClass:"space-page-picker-container",dropdownCssClass:"space-page-picker-drop"},Z=function(a,
b){!0!==a.data("select2").opts.manualInit&&K(a.val(),a,b)},aa=function(a){var b;if(a.suggestCategories)var c={text:"\u5efa\u8bae\u7684\u5206\u7c7b",children:f.map(a.suggestCategories,function(g){return I(g)})};if(a.suggestedContentFunctions)var d=f.map(a.suggestedContentFunctions,function(g){return J(g)});return function(g){if(b)g.callback(b);else{var p=[];b={results:[]};if(R(a)){var r=l.getJSON(k.contextPath()+"/rest/recentlyviewed/1.0/recent/spaces").done(function(h){var m=
c?[c]:[];0<h.length&&m.push({text:"\u63a8\u8350\u7684\u7a7a\u95f4",children:f.map(h,function(t){return z(t.key,f.escape(t.name),null,!0)})});0<m.length&&(b.results=b.results.concat(m))}).fail(function(){k.debug("Couldn't fetch recent spaces");var h=c?[c]:[];0<h.length&&(b.results=b.results.concat(h))});p.push(r)}S(a)&&(r=l.getJSON(k.contextPath()+"/rest/recentlyviewed/1.0/recent/pages",{noTrashedContent:!0}).done(function(h){if(0<h.length||d){var m=[];
d&&(m=m.concat(d));0<h.length&&(m=m.concat(f.map(h,function(t){return B(t.id,f.escape(t.title),f.escape(t.space),"content-type-page",!0)})));b.results.push({text:"\u5efa\u8bae\u7684\u9875\u9762",children:m})}}).fail(function(){k.debug("Couldn't fetch recent pages")}),p.push(r));l.when.apply(l,f.map(p,function(h){var m=l.Deferred();h.always(function(){m.resolve()});return m})).done(function(){0===b.results.length&&(b.results=[{text:"",children:[]}]);g.callback(b)})}}},
ba=function(a){var b="";if(!a||2===a.length&&0<=a.indexOf("space")&&0<=a.indexOf("page"))b="type\x3dspacedesc\x26type\x3dpersonalspacedesc\x26type\x3dpage";else if(1===a.length&&"space"===a[0])b="type\x3dspacedesc\x26type\x3dpersonalspacedesc";else if(1===a.length&&"page"===a[0])b="type\x3dpage";else return;return window.Select2.query.ajax({url:k.contextPath()+"/rest/quicknav/1/search?"+b,data:function(c,d){return{query:c,maxPerCategory:25}},quietMillis:250,results:function(c,d){c=c.contentNameMatches;
if(1>=c.length)return{results:[]};d=[];for(var g=0;g<c.length-1;g++){for(var p=[],r=0;r<c[g].length;r++){var h=c[g][r];var m=void 0,t=h.spaceName,F=h.id,w=h.name,x=h.className;"content-type-spacedesc"===x||"content-type-personalspacedesc"===x?m=z(h.spaceKey,t,x,!0):"content-type-page"===x&&(m=B(F,w,t,x,!0));(h=m)&&p.push(h)}0<p.length&&(d=d.concat(p),d.push({id:"",text:"",subText:"",className:"",disabled:!0}))}return{results:[{text:"\u641c\u7d22\u7ed3\u679c",
children:d}]}}})},ca=function(a){var b=ba(a.contentType),c=aa(a);return function(d){2>d.term.length?c(d):b(d)}};return{build:function(a){var b=f.extend({},X,Y,a);a.data||(b=f.extend({},{initSelection:Z,query:ca(b)},b));a=l(b.orgElement);if(!a||1!==a.length)return b;a.val()||b.manualInit||a.val("SPACE-PAGE-TRIGGER-VALUE");a.addClass("select2-input");return b},setValue:function(a,b){K(a,b,function(c){b.auiSelect2("data",c)})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/js/internal/space-page-picker-legacy.js' */
window.Confluence.UI.Components.SpacePagePicker=require("confluence-ui-components/js/space-page-picker");AJS.deprecate.prop(window.Confluence.UI.Components.SpacePagePicker,"build",{sinceVersion:"1.4.34",extraInfo:"Use require('confluence-ui-components/js/space-page-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/soy/space-page-picker.soy' */
// This file was automatically generated from space-page-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.templates == 'undefined') { Confluence.UI.Components.templates = {}; }


Confluence.UI.Components.templates.hiddenField = function(opt_data, opt_ignored) {
  return '<input type="hidden" id="' + soy.$$escapeHtml(opt_data.id) + '" name="' + soy.$$escapeHtml(opt_data.name) + '" />';
};
if (goog.DEBUG) {
  Confluence.UI.Components.templates.hiddenField.soyTemplateName = 'Confluence.UI.Components.templates.hiddenField';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/page-picker.js' */
define("confluence-ui-components/js/page-picker",["ajs","confluence-ui-components/js/space-page-picker"],function(b,c){return{build:function(a){a.placeholder="\u9009\u62e9\u4e00\u4e2a\u9875\u9762";a.contentType=["page"];a.showRecentlyViewedSpaces=!1;a.spaceCatKeys=[];a.spaceKeys=[];return c.build(a)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/internal/page-picker-legacy.js' */
window.Confluence.UI.Components.PagePicker=require("confluence-ui-components/js/page-picker");AJS.deprecate.prop(window.Confluence.UI.Components.PagePicker,"build",{sinceVersion:"1.4.34",extraInfo:"Use require('confluence-ui-components/js/page-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/label-picker.js' */
define("confluence-ui-components/js/label-picker",["ajs","confluence-ui-components/js/internal/soy-templates","jquery","underscore"],function(c,e,f,d){function m(a){return{id:a.name,text:a.name}}function g(a){if(!a||!a.length)return null;a=d.map(a,m);return d.sortBy(a,function(b){return b.text.toLowerCase()})}function h(a){return function(b){return f.extend({query:b,ignoreRelated:!0,maxResults:10},a)}}var k=/[;,\.\?&\[\(\)#\^\*@!<>\]]/g,n={placeholder:"\u6dfb\u52a0\u6807\u7b7e",
multiple:!0,minimumInputLength:1,maximumSelectionSize:20,tokenSeparators:[" ",","],formatInputTooShort:function(a,b){return "\u8f93\u5165\u5173\u952e\u5b57\u6765\u641c\u7d22\u6807\u7b7e"},formatSelectionTooBig:function(a){return c.format("\u60a8\u53ea\u80fd\u8f93\u5165{0}\u4e2a\u6807\u7b7e",a)},formatResult:function(a){return e.LabelPicker().labelResult({label:{labelName:a.text,isNew:a.isNew}})},formatNoMatches:function(a){var b=d.uniq(a.match(k)).join(" ");return b?e.LabelPicker().labelInvalid({inputValue:a,
invalidCharacters:b}):this.noMatches},createSearchChoice:function(a){return!a||d.uniq(a.match(k)).join(" ")?null:{id:a,text:a,isNew:!0}},ajax:{data:h(),dataType:"json",url:c.contextPath()+"/labels/autocompletelabel.action",results:function(a){var b=a.contentNameMatches;a=g(b[0]);b=g(b[1]);a=a&&b?[{text:"Suggested",children:a},{text:"\u5176\u4ed6",children:b}]:a||b||[];return{results:a}},quietMillis:300},
dropdownCssClass:"labels-dropdown",containerCssClass:"labels-autocomplete",initSelection:function(a,b){a=a.val().split(",");a=d.map(a,function(l){return{id:l,text:l}});b(a)}};return{build:function(a){var b=f.extend({},n,a);a&&a.queryOpts&&(b.ajax.data=h(a.queryOpts),delete b.queryOpts);a&&a.noMatches||(b.noMatches=b.placeholder);return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/internal/label-picker-legacy.js' */
window.Confluence.UI.Components.LabelPicker=require("confluence-ui-components/js/label-picker");AJS.deprecate.prop(window.Confluence.UI.Components.LabelPicker,"build",{sinceVersion:"1.4.18",extraInfo:"Use require('confluence-ui-components/js/label-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/soy/label-picker.soy' */
// This file was automatically generated from label-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.LabelPicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.LabelPicker == 'undefined') { Confluence.UI.Components.LabelPicker = {}; }
if (typeof Confluence.UI.Components.LabelPicker.templates == 'undefined') { Confluence.UI.Components.LabelPicker.templates = {}; }


Confluence.UI.Components.LabelPicker.templates.labelResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format('\x22{0}\x22 - \u589e\u52a0\u4e00\u4e2a\u65b0\u6807\u7b7e',opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelResult.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelResult';
}


Confluence.UI.Components.LabelPicker.templates.labelInvalid = function(opt_data, opt_ignored) {
  var output = '';
  var inputValueHtml__soy9 = '<b>' + soy.$$escapeHtml(opt_data.inputValue) + '</b>';
  var invalidCharactersHtml__soy13 = '<b>' + soy.$$escapeHtml(opt_data.invalidCharacters) + '</b>';
  output += soy.$$filterNoAutoescape(AJS.format('{0} \u5305\u542b\u65e0\u6548\u5b57\u7b26 {1}',inputValueHtml__soy9,invalidCharactersHtml__soy13));
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelInvalid.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelInvalid';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:include-exclude-picker', location = '/js/include-exclude-picker.js' */
define("confluence-ui-components/js/include-exclude-picker",["jquery","underscore"],function(d,e){function g(a){var b=a.charAt(0);e.contains(["-"],b)?(c=b,a=a.substring(1)):c="";return a}function f(a){a=d.extend({},a);a.children?a.children=e.map(a.children,f):(a.id=c+a.id,a.text=c+a.text);return a}function h(a){return function(b){b=g(b);return a(b)}}function k(a){return function(b){b=a?a(b):b;c&&(b.results=e.map(b.results,f));return b}}function l(a){return function(b){return a(b,g,f)}}function m(a){if("-"===
a.text.charAt(0))return"select2-search-choice-subtle"}var c="";return{build:function(a){a=d.extend({formatSelectionCssClass:m},a);a.query?a.query=l(a.query):(a.ajax=d.extend({},a.ajax),a.ajax.data=h(a.ajax.data),a.ajax.results=k(a.ajax.results));return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:user-group-select2', location = '/js/user-group-select2.js' */
define("confluence-ui-components/js/user-group-select2",["ajs","confluence-ui-components/js/internal/soy-templates","jquery","confluence-ui-components/js/confluence-select"],function(b,g,d){return{bind:function(f){f=f||document.body;var n=function(){var c=d(".select2-drop-active \x3e .select2-results");0===c.children(".select2-result-selectable").length&&c.children(".select2-disabled").length&&c.append('\x3cli class\x3d"select2-no-results"\x3e'+b.escapeHtml("\u6ca1\u6709\u627e\u5230\u641c\u7d22\u7ed3\u679c")+
"\x3c/li\x3e")};d("input.autocomplete-multiusergroup[data-autocomplete-bound !\x3d 'true']",f).each(function(){var c=d(this);c.attr("data-autocomplete-bound","true");var h=c.attr("data-include-groups");c.confluenceSelect({multiple:!0,minimumInputLength:2,formatInputTooShort:function(){return h?"\u8bf7\u8f93\u5165\u4f60\u8981\u68c0\u7d22\u7684\u7528\u6237\u6216\u7ec4":"\u952e\u5165\u6587\u5b57\u4ee5\u641c\u7d22\u7528\u6237"},ajax:{transport:function(a){var e=a.success;delete a.success;
return d.ajax.apply(d.ajax,arguments).done(e).done(n)},data:function(a){return{"max-results":6,query:a}},dataType:"json",url:b.contextPath()+"/rest/prototype/1/search/user"+(h?"-or-group":"")+".json",results:function(a){var e=[];d.each(a.result,function(){"user"===this.type?e.push({id:this.username,text:`${this.title} (${this.username})`,imgSrc:this.thumbnailLink.href,entity:this}):e.push({id:this.name,text:this.name,imgSrc:b.contextPath()+"/images/icons/avatar_group_48.png",entity:this})});return{results:e}},
quietMillis:300},formatResult:function(a){return g.UserGroupSelect2().avatarWithName({size:"small",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},escapeMarkup:function(a){return a},formatSelection:function(a){return g.UserGroupSelect2().avatarWithName({size:"xsmall",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},dropdownCssClass:"users-dropdown",containerCssClass:"users-autocomplete",hasAvatar:!0});if(c.data("autofill-user")){var k=b.Meta.get("remote-user"),l=b.Meta.get("current-user-fullname"),
m=b.Meta.get("current-user-avatar-uri-reference");k&&l&&m&&c.confluenceSelect("data",[{id:k,text:l,imgSrc:m}])}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:user-group-select2', location = '/soy/user-group-select2.soy' */
// This file was automatically generated from user-group-select2.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.UserGroupSelect2.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.UserGroupSelect2 == 'undefined') { Confluence.UI.Components.UserGroupSelect2 = {}; }


Confluence.UI.Components.UserGroupSelect2.avatarWithName = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-username': opt_data.userId}}) + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  Confluence.UI.Components.UserGroupSelect2.avatarWithName.soyTemplateName = 'Confluence.UI.Components.UserGroupSelect2.avatarWithName';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-component.soy' */
// This file was automatically generated from cql-component.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.Templates == 'undefined') { Confluence.UI.Components.CQL.Templates = {}; }


Confluence.UI.Components.CQL.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-container"><div class="cql-error-container"></div><div class="cql-fields"></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-field.soy' */
// This file was automatically generated from cql-filter-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQLFilters.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQLFilters == 'undefined') { Confluence.UI.Components.CQLFilters = {}; }
if (typeof Confluence.UI.Components.CQLFilters.Templates == 'undefined') { Confluence.UI.Components.CQLFilters.Templates = {}; }


Confluence.UI.Components.CQLFilters.Templates.baseFilterField = function(opt_data, opt_ignored) {
  var output = '<div class="cql-filter cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + ' cql-type-' + soy.$$escapeHtml(opt_data.field.uiSupport.valueType) + '">';
  var id__soy8 = 'cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + '-' + soy.$$escapeHtml(opt_data.counter);
  output += '<div class=\'cql-field-heading\'><label for="' + soy.$$escapeHtml(id__soy8) + '">' + soy.$$escapeHtml(opt_data.label) + ((! opt_data.field.fixed) ? '<button class="aui-icon aui-icon-small aui-iconfont-remove" title="' + soy.$$escapeHtml('\u6e05\u9664\u8fc7\u6ee4\u5668') + '"></button>' : '') + '</label></div><div class=\'cql-filter-field-input-container\'><input type="text" class="cql-field-input text" id="' + soy.$$escapeHtml(id__soy8) + '"></div></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQLFilters.Templates.baseFilterField.soyTemplateName = 'Confluence.UI.Components.CQLFilters.Templates.baseFilterField';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-select.soy' */
// This file was automatically generated from cql-filter-select.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.FilterSelect.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect == 'undefined') { Confluence.UI.Components.CQL.FilterSelect = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect.Templates == 'undefined') { Confluence.UI.Components.CQL.FilterSelect.Templates = {}; }


Confluence.UI.Components.CQL.FilterSelect.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-add-filter-container"><button type="button" class="aui-button aui-button-link">' + soy.$$escapeHtml('\u6dfb\u52a0\u8fc7\u6ee4\u5668') + '</button><div class="input-wrapper hidden"><input class="select2-input" type="text" /></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.FilterSelect.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.FilterSelect.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/date-picker.soy' */
// This file was automatically generated from date-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.DatePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.DatePicker == 'undefined') { Confluence.UI.Components.DatePicker = {}; }
if (typeof Confluence.UI.Components.DatePicker.templates == 'undefined') { Confluence.UI.Components.DatePicker.templates = {}; }


Confluence.UI.Components.DatePicker.templates.input = function(opt_data, opt_ignored) {
  return '<div class="aui-navgroup-vertical"><ul class="aui-nav"><li class="aui-nav-selected"><a href="#" role="button" data-value="">' + soy.$$escapeHtml('\u4efb\u610f\u65e5\u671f') + '</a></li role="button"><li><a href="#" role="button" data-value="now(\'-1d\')">' + soy.$$escapeHtml('\u4eca\u5929') + '</a></li><li><a href="#" role="button" data-value="now(\'-1w\')">' + soy.$$escapeHtml('\u4e0a\u5468') + '</a></li><li><a href="#" role="button" data-value="now(\'-1M\')">' + soy.$$escapeHtml('\u4e0a\u6708') + '</a></li><li><a href="#" role="button" data-value="now(\'-1y\')">' + soy.$$escapeHtml('\u53bb\u5e74') + '</a></li><li><a href="#" role="button" data-value="custom">' + soy.$$escapeHtml('\u81ea\u5b9a\u4e49') + '</a><span class="absolute-date-pickers"><input class="from-date-picker text" type="date" /><span>&ndash;</span><input class="to-date-picker text" type="date" /></span></li></ul></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.DatePicker.templates.input.soyTemplateName = 'Confluence.UI.Components.DatePicker.templates.input';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-type-picker.soy' */
// This file was automatically generated from cql-type-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.TypePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker == 'undefined') { Confluence.UI.Components.CQL.TypePicker = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker.templates == 'undefined') { Confluence.UI.Components.CQL.TypePicker.templates = {}; }


Confluence.UI.Components.CQL.TypePicker.templates.suggestions = function(opt_data, opt_ignored) {
  var output = '<div class="aui-navgroup-vertical"><ul class="aui-nav">';
  var typeList4 = opt_data.types;
  var typeListLen4 = typeList4.length;
  for (var typeIndex4 = 0; typeIndex4 < typeListLen4; typeIndex4++) {
    var typeData4 = typeList4[typeIndex4];
    output += '<li ' + ((typeIndex4 == 0) ? ' class="aui-nav-selected"' : '') + '><a href="#" role="button" data-value="' + soy.$$escapeHtml(typeData4.type) + '">' + soy.$$escapeHtml(typeData4.label) + '</a></li>';
  }
  output += '<li><a href="#" role="button" data-value="custom">' + soy.$$escapeHtml('\u81ea\u5b9a\u4e49') + '</a></li></ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.TypePicker.templates.suggestions.soyTemplateName = 'Confluence.UI.Components.CQL.TypePicker.templates.suggestions';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-space-field.soy' */
// This file was automatically generated from cql-space-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.SpaceField.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField == 'undefined') { Confluence.UI.Components.CQL.SpaceField = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField.templates == 'undefined') { Confluence.UI.Components.CQL.SpaceField.templates = {}; }


Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption = function(opt_data, opt_ignored) {
  return '<span><input type="checkbox" value="true" id="search-filter-include-archived" name="includeArchivedSpaces"><label for="search-filter-include-archived">' + soy.$$escapeHtml('\u641c\u7d22\u5df2\u5f52\u6863\u7684\u7a7a\u95f4') + '</label></span>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption.soyTemplateName = 'Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-soy-templates.js' */
define("confluence-ui-components/js/cql/internal/cql-soy-templates",[],function(){return{CQL:function(){return Confluence.UI.Components.CQL.Templates},Filters:function(){return Confluence.UI.Components.CQLFilters.Templates},FilterSelect:function(){return Confluence.UI.Components.CQL.FilterSelect.Templates},SpaceField:function(){return Confluence.UI.Components.CQL.SpaceField.templates},TypePicker:function(){return Confluence.UI.Components.CQL.TypePicker.templates}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-special-spaces.js' */
define("confluence-ui-components/js/cql/internal/cql-special-spaces",["underscore"],function(b){function d(a){return"search-screen"===a?b.omit(c,"conf_current"):c}var c={conf_current:"currentSpace()",conf_favorites:"favourite",conf_global:"global",conf_personal:"personal"},e=b.invert(c);return{getMap:d,getKeys:function(a){return b.keys(d(a))},getUIValue:function(a){return e[a]}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ajax.js' */
define("confluence-ui-components/js/cql/internal/cql-ajax",["jquery","underscore","ajs"],function(b,d,e){var c;return{getFields:function(){c||(c=b.Deferred(),b.getJSON(e.contextPath()+"/rest/cql/fields?filter\x3dwithUiSupport").done(function(a){a=d.values(a);if(!a.length)throw Error("Unknown CQL field data returned from server - cannot initialise CQL fields.");a=d.union.apply(d,a);a=d.sortBy(a,"fieldName");c.resolve(a)}).fail(function(){c.reject()}));return c.promise()},parseClauses:function(a){return b.getJSON(e.contextPath()+
"/rest/cql/expressions?cql\x3d"+encodeURIComponent(a))},getTypes:function(){return b.getJSON(e.contextPath()+"/rest/cql/contenttypes?category\x3dall")},getContentTypes:function(){return b.getJSON(e.contextPath()+"/rest/cql/contenttypes?category\x3dcontent")}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-date-picker",["ajs","jquery","confluence-ui-components/js/internal/soy-templates"],function(b,g,n){return{build:function(p){var c=g(n.DatePicker().input()),d=c.find(".aui-nav li"),k=c.find(".absolute-date-pickers").hide(),e=c.find(".from-date-picker"),f=c.find(".to-date-picker"),l=function(){};this.onChange=function(a){l=a;e.change(a);f.change(a)};c.on("click",".aui-nav a",function(a){a.preventDefault();a=d.filter("li.aui-nav-selected");var h=g(this).closest("li");
a[0]!==h[0]&&(d.not(h).removeClass("aui-nav-selected"),h.addClass("aui-nav-selected"),l());"custom"===g(this).data("value")?k.slideDown("fast"):k.slideUp("fast")});var m={overrideBrowserDefault:!0};b.DatePicker(e,m);b.DatePicker(f,m);e.attr("placeholder","\u5f00\u59cb\u65f6\u95f4");e.attr("aria-label","\u5f00\u59cb\u65f6\u95f4");f.attr("placeholder","\u5230");f.attr("aria-label",
"\u5230");p.replaceWith(c);return{getSelectedOption:function(){return d.filter(".aui-nav-selected").find("a").data("value")},selectOption:function(a){d.find('a[data-value\x3d"'+a+'"]').click()},getFromDate:function(){return e.val()},getToDate:function(){return f.val()},setFromDate:function(a){e.val(a);d.find("a[data-value\x3d'custom']").click()},setToDate:function(a){f.val(a);d.find("a[data-value\x3d'custom']").click()}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-type-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-type-picker","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/cql/internal/cql-soy-templates confluence-ui-components/js/include-exclude-picker confluence-ui-components/js/confluence-select".split(" "),function(k,e,u,v,x,y,z){function A(c){l=e.map(c,function(h){return{id:h.type,text:h.label}})}function w(c,h){return 0===c.length?"":
1===c.length&&e.contains(e.pluck(h,"type"),c[0])?c[0]:"custom"}var f,l=[];return{build:function(c,h){var g,m,n,p=[];f||(f=h?v.getContentTypes():v.getTypes(),f.done(A));f.done(function(){if(c.length){var b=e.pluck(l,"id");p=[].concat(l);c.forEach(function(a){""===a.type||e.contains(b,a.type)||p.push({id:a.type,text:a.label})})}else p=l});var B={query:function(b,a,d){f.done(function(){a(b.term);window.Select2.query.local({results:e.map(p,d)})(b)})},initSelection:function(b,a){b=b.val().split(",");var d=
"",r=e.map(b,function(q){return"-"===q.charAt(0)?(d="-",q.substring(1)):q});f.done(function(){var q=e.filter(p,function(t){return e.contains(r,t.id)});a(e.map(q,function(t){return{id:d+t.id,text:d+t.text}}))})},multiple:!0,placeholder:"\u6240\u6709\u5185\u5bb9\u7c7b\u578b"};return{setupInput:function(b){g=b;if(u.trace)g.on("change",function(){u.trace("type.field.changed")});c.length&&(b=k(y.TypePicker().suggestions({types:c})),m=b.find(".aui-nav li"),g.before(b),b.on("click",
".aui-nav a",function(a){a.preventDefault();a=k(this).closest("li");var d=m.filter(".aui-nav-selected");a[0]!==d[0]&&(d.removeClass("aui-nav-selected"),a.addClass("aui-nav-selected"),a=k(this).attr("data-value"),"custom"===a?(n.slideDown("fast"),k(this).attr("id","type-picker-custom")):n.hide(),g.select2("val",[a],!0))}));g.confluenceSelect(z.build(B),["type-picker-custom"]);c.length&&(n=g.closest(".cql-filter").find(".select2-container"),n.hide())},setValues:function(b){if(m){var a=w(b,c),d=m.find('[data-value\x3d"'+
a+'"]').parent();m.not(d).removeClass("aui-nav-selected");d.addClass("aui-nav-selected");"custom"===a&&n.show()}var r=k.Deferred();f.done(function(){x.setValues(g,b).done(function(){r.resolve()})});return r}}},_clearCache:function(){f=null;l=[]},_getPicklistKey:w}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-field-model.js' */
define("confluence-ui-components/js/cql/internal/cql-field-model",[],function(){return{getLabel:function(a){return a.uiSupport.label.translation}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-adjuster.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-adjuster",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(e,f){return{convertFunctionValues:function(a){var b=a.functionValues;if(!b||!b.length)return a;var c=[];e.each(b,function(d){if("currentSpace"===d.functionName)c.push(f.getUIValue("currentSpace()"));else throw Error(d.functionName+" is not a known function");});a.values=c.concat(a.values);return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-autocomplete-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field",["jquery","ajs","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(f,d,l,m){function g(a){return{query:a,searchContext:JSON.stringify({spaceKey:d.Meta.get("space-key"),contentId:d.Meta.get("content-id")})}}function h(a){return 0===a.indexOf("http://")||0===a.indexOf("https://")?a:d.contextPath()+a}var k={placeholder:"\u8f93\u5165\u4fe1\u606f\u5f00\u59cb\u641c\u7d22",
multiple:!0,tokenSeparators:[" ",","],createSearchChoice:function(a){return a?{id:a,text:"New result: "+a,isNew:!0}:null},createSearchChoicePosition:"bottom",ajax:{data:g,results:function(a){var b=a.suggestedResults;a=a.searchResults;b=b.length?a.length?[{text:"\u5efa\u8bae",children:b},{text:"\u641c\u7d22\u7ed3\u679c",children:a}]:b:a;return{results:b}},quietMillis:300},initSelection:function(a,
b){a=a.val().split(",").map(function(c){return{id:c,text:c}});b(a)}};return{build:function(a){var b;return{setupInput:function(c){b=c;var e=f.extend({},k.ajax,{url:h(a.uiSupport.dataUri)});e=f.extend({},k,{ajax:e});c.auiSelect2(e)},asCqlFunc:function(){var c=this.input.val().trim();if(c)return l.buildEqualityExpressionFromValuesString(this.fieldName,c)},setValues:function(c){return m.setValues(b,c.values)}}},_getUrl:h,_ajaxData:g}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-content-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field",["jquery","confluence-ui-components/js/page-picker","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper","confluence-ui-components/js/confluence-select"],function(k,d,e,f){function g(b){return"page:"+b}function h(b){return"content-function:"+b.functionName+"()"}function c(b){return b.values.map(g).concat(b.functionValues.map(h))}return{build:function(){var b;
return{setupInput:function(a){b=a;a.confluenceSelect(d.build({multiple:"parent"!==this.fieldName,suggestedContentFunctions:["currentContent()"]}))},asCqlFunc:function(){var a=this.input.val().trim();if(a)return a=a.replace(/[a-z\-]+:/g,""),e.buildEqualityExpressionFromValuesString(this.fieldName,a)},_addValuePrefixes:c,setValues:function(a){a=c(a);return f.setValues(b,a)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-suggestions.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions",["ajs"],function(a){var b=[{type:"",label:"\u5168\u90e8\u5185\u5bb9"},{type:"page",label:"\u9875\u9762\uff1a"},{type:"blogpost",label:"\u535a\u6587"},{type:"attachment",label:"\u9644\u4ef6"},{type:"space",
label:"\u7a7a\u95f4"}];return{getList:function(){return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field",["confluence/dark-features","confluence-ui-components/js/cql/internal/cql-type-picker","confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions"],function(f,g,h){return{build:function(k){var a;return{setupInput:function(b,c){var d=[],e=!0;if("search-screen"===c.environment&&"all"===c.searchType||f.isEnabled("cql.force.full.search.mode"))d=h.getList(),e=!1;a=g.build(d,e);a.setupInput(b)},setValues:function(b){return a.setValues(b.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-date-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field",["ajs","underscore","confluence-ui-components/js/cql/internal/cql-date-picker"],function(e,h,k){return{build:function(l){var g=l.fieldName,b;return{setupInput:function(a){b=k.build.call(this,a)},setValues:function(a){b?(a=a.expressions,1>a.length||2<a.length?e.warn("Can't set date value with expressions.length: "+a.length):1===a.length&&1===a[0].functionValues.length&&"now"===a[0].functionValues[0].functionName?"\x3e\x3d"!==
a[0].operator?e.warn("Unsupported date picker relative date operator: "+a[0].operator):b.selectOption("now('"+a[0].functionValues[0].parameters[0]+"')"):h.each(a,function(c){if(1===c.values.length){var d=c.values[0];"\x3e\x3d"===c.operator?b.setFromDate(d):"\x3c\x3d"===c.operator&&b.setToDate(d)}})):e.warn("DatePicker not set yet, can't set values")},asCqlFunc:function(){if(b){var a=b.getSelectedOption();if(!a)return"";if("custom"===a){a=b.getFromDate();var c=b.getToDate(),d,f;a&&(d=g+' \x3e\x3d "'+
a+'"');c&&(f=g+' \x3c\x3d "'+c+'"');return d&&f?d+" and "+f:d||f||""}return g+" \x3e\x3d "+a}e.warn("DatePicker not set yet, can't get CQL")}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-label-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field","jquery ajs confluence-ui-components/js/label-picker confluence-ui-components/js/include-exclude-picker confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/confluence-select".split(" "),function(d,e,f,g,h){return{build:function(){var c;return{setupInput:function(a,b){c=a;b=d.extend({},b.select2CustomOptions,{noMatches:"\u627e\u4e0d\u5230\u5339\u914d\u7684\u6807\u7b7e\u3002"});
a.confluenceSelect(g.build(f.build(b)))},setValues:function(a){return h.setValues(c,a.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-space-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field","jquery confluence-ui-components/js/space-picker confluence-ui-components/js/include-exclude-picker confluence-ui-components/js/cql/internal/cql-special-spaces confluence-ui-components/js/cql/internal/cql-space-expression-adjuster confluence-ui-components/js/cql/internal/cql-space-expression-builder confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/cql/internal/cql-soy-templates confluence-ui-components/js/confluence-select".split(" "),
function(f,g,h,k,l,m,n,p){return{build:function(){var b;return{setupInput:function(a,c){b=a;a.confluenceSelect(h.build(g.build({multiple:!0,suggestCategories:k.getKeys(c.environment),disableMixedSpaceTypes:!0})));if("search-screen"===c.environment){var d=f(p.SpaceField().archivedSpacesOption());b.after(d);this.onChange=function(e){d.find("#search-filter-include-archived").change(e);b.change(e)}}},asCqlFunc:function(){return m.buildExpressionFromValuesString(this.input.val())},setValues:function(a){l.convertFunctionValues(a);
return n.setValues(b,a.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-user-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field",["jquery","ajs","confluence-ui-components/js/user-group-select2"],function(b,f,g){return{build:function(){function h(a){a=a[0].result[0];return{id:a.username,text:a.title,imgSrc:a.thumbnailLink.href}}var d;return{setupInput:function(a){d=a;a.addClass("select2-input autocomplete-multiusergroup");g.bind(a.parent())},setValues:function(a){if((a=a.values)&&a[0]){var e=a.map(function(c){return b.getJSON(f.contextPath()+
"/rest/prototype/1/search/user.json?query\x3d"+encodeURI(c))});return b.when.apply(b,e).done(function(){var c=(1<e.length?arguments:[arguments]).map(h);d.auiSelect2("data",c)})}}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-filter-field-configs.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs","confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field".split(" "),
function(d,e,f,g,h,k,l){var c={contentId:e,contentType:f,date:g,label:h,space:k,user:l};return{getConfig:function(a){var b=a.uiSupport;return b.dataUri?d.build(a):c[b.valueType]?c[b.valueType].build(a):{}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-field.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-field","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-field-model confluence-ui-components/js/cql/internal/cql-expression-builder confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),function(e,g,t,h,k,l,m){function n(b){var d=h.getLabel(b);d=e(p().baseFilterField({label:d,field:b,counter:q++}));var c=d.find("input");d.data("fieldName",
b.fieldName);return e.extend({input:c,element:d,onChange:function(a){c.change(a)}},b)}var p=m.Filters,q=0;return{build:function(b,d){var c=b.fieldName;if(!b.uiSupport.valueType)throw Error("Can't create filter without valueType.");if(!c)throw Error("Can't create filter without fieldName.");c=l.getConfig(b);var a=n(b);a.asCql=g.bind(c.asCqlFunc||function(){return k.buildExpression(a,this.input.val())},a);var f=a.element.find("input");"function"===typeof c.setupInput&&(a.setupInput=c.setupInput,a.setupInput(f,
d.context));a.setValues=c.setValues||function(r){f.val(r.values.join(","))};a.element.find(".aui-iconfont-remove").click(function(){a.element.remove();d.removeField(a)});return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-select.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-select","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-field-model confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),function(k,c,b,t,l,u){var v=u.FilterSelect;return{build:function(g){function w(a){a.added&&(h.auiSelect2("val",""),n(a.added),b.debug("CQL Field selection made"),m.addClass("hidden"),d.show())}var p=g.cqlContainer,q=p.find(".cql-fields"),
n=g.onSelection;if(!n)throw Error("An onSelection callback must be provided to the FilterSelect.");var e=k(v().container()),d=e.children("button"),m=e.find(".input-wrapper"),h=e.find("input");d.click(function(a){a.preventDefault();m.removeClass("hidden");d.hide();e.find(".select2-choice").mousedown()});h.bind("select2-close",function(){b.debug("CQL Field selector closed");m.addClass("hidden");d.show();setTimeout(function(){b.log("Checking CQL Field selector focus");k(document.activeElement).closest(".cql-filter").length||
(b.debug("Setting CQL Field selector focus"),d.focus())},1)});p.append(e);t.getFields().done(function(a){"search-screen"===g.context.environment||b.DarkFeatures.isEnabled("cql.search.screen")||(a=c.reject(a,function(f){return"date"===f.type}));a=c.reject(a,function(f){return c.contains(g.ignoredFields,f.fieldName)});h.auiSelect2({id:"fieldName",data:function(){if(!q[0])throw Error("Why no cql-container?");var f=q.find(".cql-filter").map(function(){return k(this).data("fieldName")});return{results:c.reject(a,
function(r){return c.contains(f,r.fieldName)&&!c.contains(["label"],r.fieldName)}),text:l.getLabel}},formatResult:l.getLabel,formatSelection:l.getLabel,placeholder:"\u6dfb\u52a0\u8fc7\u6ee4\u5668"}).change(w)}).fail(function(){b.log("Couldn't fetch CQL fields - unable to initialise CQL field picker")});return h}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-builder",["jquery","underscore","confluence-ui-components/js/cql/internal/cql-special-spaces","confluence-ui-components/js/cql/internal/cql-expression-builder"],function(l,e,f,g){return{buildExpressionFromValuesString:function(a){if(a=a.trim()){a=a.split(",");var h=f.getKeys(),d=[],c=[];e.each(a,function(b){"conf_current"===b?d.push("currentSpace()"):e.contains(h,b)?c.push(b):d.push(b)});a=[];if(c.length){var k=f.getMap();c=e.map(c,
function(b){return k[b]});a.push(g.buildEqualityExpressionFromValuesArray("space.type",c))}d.length&&a.push(g.buildEqualityExpressionFromValuesArray("space",d));return 1===a.length?a[0]:"("+a.join(" or ")+")"}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-expression-builder",["jquery","underscore"],function(q,e){function f(b){return e.contains(["currentContent()","currentSpace()"],b)?b:'"'+b.replace(/"/g,'\\"')+'"'}function g(b){var a={"+":[],"-":[],"":[]};e.each(b,function(c){var d=c.charAt(0);"+"===d?a["+"].push(c.substring(1)):"-"===d?a["-"].push(c.substring(1)):a[""].push(c)});return a}function h(b,a){return e.map(a,function(c){return b+" \x3d "+f(c)}).join(" AND ")}function k(b,a,c){if(0===
a.length)return"";a=e.map(a,f);if(1===a.length)return b+(c?" \x3d ":" !\x3d ")+a[0];a=a.join(",");return b+(c?" in ":" not in ")+"("+a+")"}function l(b,a){return k(b,a,!1)}function m(b,a){return k(b,a,!0)}function n(b,a){var c=g(a);a=[];var d=h(b,c["+"]);d&&a.push(d);(d=m(b,c[""]))&&a.push(d);(b=l(b,c["-"]))&&a.push(b);return a.join(" AND ")}function p(b,a){if(a=a.trim())return a=a.split(","),a=e.map(a,function(c){return c.trim()}),n(b,a)}return{buildExpression:function(b,a){if("equality"===b.type)return p(b.fieldName,
a);if("text"===b.type)return b=b.fieldName,a=(a=a.trim())?b+" ~ "+f(a):void 0,a;throw Error("buildExpression does not yet support type: "+b.type);},buildEqualityExpressionFromValuesString:p,buildEqualityExpressionFromValuesArray:n,makeValueMap:g,makePlusCql:h,makeMinusCql:l,makeRegularCql:m}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-type-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-space-type-expression-converter",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(b,d){return{convert:function(c,a){a=b.clone(a);var e=b.map(c.values,d.getUIValue);return{field:a,values:e,negate:c.negate}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(d,h){function g(a,b){a.values=a.values.concat(b.values);return a}return{aggregate:function(a,b){var c=d.filter(a,function(e){return"space.type"===e.field.fieldName});if(0===c.length)return a;if(1<c.length)throw Error("Only a single space.type expression is supported.");b=h.convert(c[0],b);var f=d.filter(a,function(e){return"space"===
e.field.fieldName});a=d.difference(a,c);f.length?f[0]=g(f[0],b):a.push(b);return a},combineSpaceExpressions:g}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-set-value-helper.js' */
define("confluence-ui-components/js/cql/internal/cql-set-value-helper",["jquery"],function(c){return{setValues:function(a,d){var b=c.Deferred();a.on("change",function(){b.resolve()});a.select2("val",d,!0);return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-date-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(f){return{aggregate:function(e){var b=[],c={};e.forEach(function(a){var d=a.field.fieldName;"date"!==a.field.type?b.push(a):c[d]?c[d].expressions.push(a):(a={field:a.field,expressions:[a]},c[d]=a,b.push(a))});return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-converter",["jquery","underscore"],function(c,d){function b(a){a.values=d.map(a.values,function(e){return"-"+e})}return{convert:function(a){a=c.extend({},a);"equality"===a.field.type&&("!\x3d"===a.operator?(a.operator="\x3d",b(a)):"notin"===a.operator&&(a.operator="in",b(a)));return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-negation-converter"],function(g,l){function m(e,b){if(!b.length)return e;var a=e[0];a||(a=b[0],b=g.rest(b));b.forEach(function(f){a.values=a.values.concat(f.values)});"\x3d"===a.operator&&1<a.values.length&&(a.operator="in");return[a].concat(g.rest(e))}return{aggregate:function(e){var b=[],a={},f={};e.forEach(function(c){var d=c.field.fieldName;g.contains(b,d)||(b.push(d),
a[d]=[],f[d]=[]);var h=l.convert(c);h.operator!==c.operator?f[d].push(h):a[d].push(h)});var k=[];b.forEach(function(c){c=m(a[c],f[c]);k=k.concat(c)});return k}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ignored-field-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter",[],function(){function c(a,b,d){b&&(a=a.filter(function(e){return-1<b.indexOf(e.field.fieldName)?d:!d}));return a}return{removeFieldsByName:function(a,b){return c(a,b,!1)},getFieldsByName:function(a,b){return c(a,b,!0)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/cql-component.js' */
define("confluence-ui-components/js/cql/cql-component","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-filter-field confluence-ui-components/js/cql/internal/cql-filter-select confluence-ui-components/js/cql/internal/cql-space-expression-aggregator confluence-ui-components/js/cql/internal/cql-date-expression-aggregator confluence-ui-components/js/cql/internal/cql-negation-aggregator confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),
function(e,k,g,x,I,J,K,L,M,y,N){function O(c){var f=[];k.each(c,function(n){n.forEach(function(h){h&&(h=h.asCql())&&f.push(h)})});return f.join(" and ")}function z(c,f){return k.find(c,function(n){return n.fieldName===f})}var P=N.CQL;return{build:function(c){function f(a){var b=I.build(a,A);b.onChange(B);a=a.fieldName;d[a]=d[a]||[];d[a].push(b);p.trigger("cql-field-adding",b);a=C.find(".cql-field-"+a+":last");a.length?a.after(b.element):C.append(b.element);return b}function n(a){var b=e.Deferred();
if(!a)return b.resolve(),b;var l={},Q=k.findWhere(r,{fieldName:"space"});a=K.aggregate(a,Q);a=L.aggregate(a);a=M.aggregate(a);D=y.getFieldsByName(a,c.ignoredFields);a=y.removeFieldsByName(a,c.ignoredFields);var E=[];k.each(a,function(t){var m=t.field.fieldName,F=z(r,m),q=l[m];l[m]="number"===typeof q?q+1:0;m=l[m];q=F.fieldName;(t=(d[q]&&d[q][m||0]||f(F)).setValues(t))&&E.push(t)});e.when.apply(e,E).then(function(){b.resolve()});return b}function h(a){if(a){var b=k.escape(a);a="\u65e0\u6cd5\u52a0\u8f7d\u8fd9\u4e2a\u8fc7\u6ee4\u5668";
b=g.format("\u7cdf\u7cd5\uff01\u6211\u4eec\u5728 \u0022{0}\u0022 \u4e0a\u6709\u56f0\u96be\u3002\u8bf7\u5c1d\u8bd5\u5237\u65b0\u9875\u9762\uff0c\u4f46\u662f\u60a8\u53ef\u80fd\u9700\u8981\u91cd\u65b0\u8f93\u5165\u60a8\u7684\u5b8f\u53c2\u6570\u3002",b)}else a="\u65e0\u6cd5\u52a0\u8f7d\u8fd9\u4e2a\u5b8f",b="\u5982\u679c\u60a8\u5237\u65b0\u9875\u9762\uff0c\u6211\u4eec\u4f1a\u518d\u8bd5\u4e00\u6b21\u3002";g.messages.error(".cql-error-container",{title:a,body:b,closeable:!0})}function R(a){a=e.extend({},a,{fixed:!1});a=f(a);if(0===a.element.find(".aui-nav-selected").length)if(0!==a.element.find(".select2-container-multi").length){var b=a.element.find("input.select2-input");
b.focus().click()}else b=a.element.find("a.select2-choice.select2-default"),b.length||(b=e(":input:visible",a.element).first()),b.length||g.log("Unable to focus CQL field: "+a.fieldName),b.focus().mousedown()}var G=c.context||{environment:"macro-browser"},u=c.defaultFieldNames;u||(u=c.defaultFields?c.defaultFields.split(","):[]);var p=e(P().container());c.container&&e(c.container).append(p);var C=p.find(".cql-fields"),H=c.value||c.defaultValue;if(H)var v=x.parseClauses(H);else v=new e.Deferred,v.resolve();
var d={},D={},w=new e.Deferred,B=c.onChange||function(){},A={element:p,loading:w,context:c.context||{environment:"macro-browser",searchType:"content",select2CustomOptions:c.select2CustomOptions||{}},getValue:function(){return O(d)},getIgnoredFields:function(){return D},removeField:function(a){var b=a.fieldName;d[b]=k.without(d[b],a);0===d[b].length&&(delete d[b],B())},fieldArrays:d,fieldRegistry:d},r;x.getFields().done(function(a){r=a;u.forEach(function(b){var l=z(r,b);if(!l)throw Error("Unknown fieldname: "+
b);b=e.extend({fixed:!0},l);f(b)});J.build({onSelection:R,cqlContainer:p,context:G,ignoredFields:c.ignoredFields});v.done(function(b){n(b).done(function(){w.resolve()})}).fail(function(){"search-screen"===G.environment?g.log("Error parsing CQL param from search screen URL: "+c.value):h(c.value);w.resolve()})}).fail(function(){h()});return A}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:user-select2', location = 'user-select2/avatar.soy' */
// This file was automatically generated from avatar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace CreateContent.avatar.
 */

if (typeof CreateContent == 'undefined') { var CreateContent = {}; }
if (typeof CreateContent.avatar == 'undefined') { CreateContent.avatar = {}; }


CreateContent.avatar.avatarWithName = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-username': opt_data.userId}}) + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  CreateContent.avatar.avatarWithName.soyTemplateName = 'CreateContent.avatar.avatarWithName';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:user-select2', location = 'user-select2/user-multiselect.js' */
Confluence.Binder.autocompleteMultiUser=function(e){e=e||document.body;var c=AJS.$,k=function(){var b=c(".select2-drop-active \x3e .select2-results");0===b.children(".select2-result-selectable").length&&b.children(".select2-disabled").length&&b.append('\x3cli class\x3d"select2-no-results"\x3e'+AJS.escapeHtml("\u6ca1\u6709\u627e\u5230\u641c\u7d22\u7ed3\u679c")+"\x3c/li\x3e")};c("input.autocomplete-multiuser[data-autocomplete-bound !\x3d 'true']",e).each(function(){var b=c(this);b.auiSelect2({multiple:!0,minimumInputLength:2,
formatInputTooShort:function(){return "\u952e\u5165\u6587\u5b57\u4ee5\u641c\u7d22\u7528\u6237"},ajax:{transport:function(a){var d=a.success;delete a.success;return c.ajax.apply(c.ajax,arguments).done(d).done(k)},data:function(a){return{"max-results":6,query:a}},dataType:"json",url:Confluence.getContextPath()+"/rest/prototype/1/search/user.json",results:function(a){var d=[];c.each(a.result,function(){d.push({id:this.username,userKey:this.userKey,text:this.title,imgSrc:this.thumbnailLink.href})});
return{results:d}},quietMillis:300},formatResult:function(a){return CreateContent.avatar.avatarWithName({size:"small",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},escapeMarkup:function(a){return a},formatSelection:function(a){return CreateContent.avatar.avatarWithName({size:"xsmall",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},dropdownCssClass:"users-dropdown",containerCssClass:"users-autocomplete",hasAvatar:!0});if(b.data("autofill-user")){var f=AJS.Meta.get("remote-user"),
l=AJS.Meta.get("remote-user-key"),g=AJS.Meta.get("current-user-fullname"),h=AJS.Meta.get("current-user-avatar-url");f&&g&&h&&b.auiSelect2("data",[{id:f,userKey:l,text:g,imgSrc:AJS.contextPath()+h}])}})};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-parameter-serializer.js' */
define("confluence-macro-browser/macro-parameter-serializer",["jquery"],function(h){function e(d){return d.replace(/\\/g,"\\\\").replace(/=/g,"\\=").replace(/[|]/g,"\\|")}return{serialize:function(d){var a=[],b;for(b in d)a.push(e(b)+"="+e(d[b]));return a.join("|")},deserialize:function(d){function a(f,d){for(var c=[],b=[],a,f=f||"",g=0,e=f.length;g<e;g++)a=f[g],"\\"==a?c.push(a+(g+1!=f.length?f[++g]:"")):a==d?(b.push(c.join("")),c=[]):c.push(a);b.push(c.join(""));return b}var b={};h.each(a(d||"",
"|"),function(d,e){var c=a(e,"=");2===c.length&&c[0]&&(b[c[0].replace(/\\(.)/g,"$1")]=c[1].replace(/\\(.)/g,"$1"))});return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-parameter-serializer","Confluence.MacroParameterSerializer");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-fields.js' */
define("confluence-macro-browser/macro-browser-fields",["ajs","jquery","underscore","confluence/legacy"],function(g,e,o,i){function n(j,h,l){return function(k,b){if(k.multiple)return j.string(k,b);var a=e(i.Templates.MacroBrowser.macroParameterSelect()),c=e("select",a),b=b||{};b.setValue=b.setValue||function(a){var b=!1;c.find("option").each(function(){if(this.value==a)return b=!0,!1});b?delete c.tempValue:(c.append(e("<option></option>").attr("value",a).text(a+" ("+"\u672a\u627e\u5230"+
")")),c.tempValue=a);try{c.val(a)}catch(m){g.logError(m)}c.change()};a=h(a,c,b);a.updateDependencies=l;a.getData=function(a){if(a.title&&a.spaceKey||a.pageId||a.draftId){var f=c.tempValue||c.val();b.fileTypes&&(a.fileTypes=b.fileTypes);var m=g.contextPath()+(a.draftId?"/json/draftattachmentsearch.action":"/json/attachmentsearch.action");e.getJSON(m,a,function(a){if(!a.error){e("option",c).remove();a=a.attachments;if(!a||!a.length){c.append(e("<option></option>").attr("value","").html("\u65e0\u5408\u9002\u9644\u4ef6"));
c.tempValue&&b.setValue(c.tempValue)}else{for(var d=0,m=a.length;d<m;d++)c.append(e("<option></option>").attr("value",a[d].name).text(a[d].name));f=f||c.tempValue;b.setValue(f||a[0].name)}c.attr("style","")}})}else g.log("Not enough parameters to send attachmentsearch request")};return a}}return function(j){var h=function(b,a,c){var c=c||{},d=c.setValue||function(b){a.val(b)},e=c.getValue||function(){return a.val()};a.change(c.onchange||j.paramChanged);return{paramDiv:b,input:a,setValue:d,getValue:e}},
l=function(b,a,c){if(a&&a.length)for(var d=0,e=a.length;d<e;d++)j.fields[a[d]]&&j.fields[a[d]].dependencyUpdated(b,c)},k={updateDependencies:l,username:function(b,a){var a=a||{},c=b.multiple?"autocomplete-multiuser":"autocomplete-user",d=e(i.Templates.MacroBrowser.macroParameter()),f=e("input[type='text']",d);f.addClass(c).attr("data-none-message","\u672a\u627e\u5230");b.required&&f.keyup(j.processRequiredParameters);b.multiple?(i.Binder.autocompleteMultiUser(d),a.setValue=
function(a){f.val(a);for(var a=a.split(","),b=[],c=[],d=0,h=a.length;d<h;d++)b.push(function(a){return e.getJSON(g.contextPath()+"/rest/prototype/1/user/non-system/"+a).done(function(a){a&&a.name&&c.push({id:a.name,text:a.displayName,imgSrc:a.avatarUrl})}).fail(function(b){g.logError("Cannot parse user data for macro browser field with: "+b);c.push({id:a,text:g.format("\u672a\u77e5\u7528\u6237 ({0})",a),imgSrc:g.contextPath()+"/images/icons/profilepics/default.png"})})}(a[d]));e.when.apply(e,o.map(b,function(a){var b=
e.Deferred();a.always(function(){b.resolve()});return b.promise()})).done(function(){c.length&&f.auiSelect2("data",c)})}):(f.bind("selected.autocomplete-content",function(c,d){if(a.onselect)a.onselect(d.selection);else a.setValue?a.setValue(d.content.username):(l(b.name,a.dependencies,f.val()),"function"===typeof a.onchange&&a.onchange.apply(f))}),g.Confluence.Binder.autocompleteUserOrGroup(d));return h(d,f,a)},spacekey:function(b,a){if(b.multiple)return k.string(b,a);var a=a||{},c=e(i.Templates.MacroBrowser.macroParameter()),
d=e("input[type='text']",c);d.addClass("autocomplete-space").attr("data-template","{key}").attr("data-none-message","\u672a\u627e\u5230");b.required&&d.keyup(j.processRequiredParameters);d.bind("selected.autocomplete-content",function(c,e){if(a.onselect)a.onselect(e.selection);else a.setValue?a.setValue(e.content.key):(l(b.name,a.dependencies,d.val()),"function"===typeof a.onchange&&a.onchange.apply(d))});g.Confluence.Binder.autocompleteSpace(c);return h(c,d)},attachment:n(k,
h,l),full_attachment:n(k,h,l),"confluence-content":function(b,a){if(b.multiple)return k.string(b,a);a=a||{};b.options=b.options||{};var c=e(i.Templates.MacroBrowser.macroParameter()),d=e("input[type='text']",c).attr("data-none-message","\u672a\u627e\u5230").attr("data-template","");b.required&&d.keyup(j.processRequiredParameters);a.onchange=a.onchange||function(){var c=d.val();l(b.name,a.dependencies,c)};a.setValue=a.setValue||function(b){d.val(b);"function"===typeof a.onchange&&
a.onchange.apply(d)};d.bind("selected.autocomplete-content",function(c,e){var f="";"true"==b.options.includeDatePath&&"blogpost"===e.content.type&&(f=e.content.createdDate.date.split("-"),f="/"+f[0]+"/"+f[1]+"/"+f[2].substring(0,2)+"/");var h=e.content.space&&e.content.space.key,i=h&&h!=g.Meta.get("space-key");-1!==e.content.title.indexOf(":")&&(i=!0);f=(i?h+":":"")+f+e.content.title;d.val(f);if(a.onselect)a.onselect(e.selection);else a.setValue(f,d)});b.options.spaceKey&&("@self"===b.options.spaceKey.toLowerCase()&&
(b.options.spaceKey=g.Meta.get("space-key")),d.attr("data-spacekey",b.options.spaceKey));var f=b.options.type;if("string"===typeof f)if("page"==f)d.addClass("autocomplete-page"),g.Confluence.Binder.autocompletePage(c);else if("blogpost"==f)d.addClass("autocomplete-blogpost"),g.Confluence.Binder.autocompleteBlogpost(c);else{if("attachment"===f||"full_attachment"===f)d.addClass("autocomplete-attachment"),g.Confluence.Binder.autocompleteAttachment(c)}else d.addClass("autocomplete-confluence-content"),
g.Confluence.Binder.autocompleteConfluenceContent(c);return h(c,d,a)},string:function(b,a){var c=e(i.Templates.MacroBrowser.macroParameter()),d=e("input",c);b.required&&d.keyup(j.processRequiredParameters);return h(c,d,a)},"boolean":function(b,a){var c=e(i.Templates.MacroBrowser.macroParameterBoolean()),d=e("input",c),a=a||{};a.setValue=a.setValue||function(a){(/true/i.test(a)||/true/i.test(b.defaultValue)&&!/false/i.test(a))&&d.prop("checked",!0)};return h(c,d,a)},"enum":function(b,a){if(b.multiple)return k.string(b,
a);var c=e(i.Templates.MacroBrowser.macroParameterSelect()),d=e("select",c);!b.required&&!b.defaultValue&&d.append(e("<option></option>").attr("value",""));e(b.enumValues).each(function(a,c){var g=c;if(b.enumToI18nKeyMapping){var h=[b.pluginKey,b.macroName,"param",b.name,this,"desc"].join(".");b.enumToI18nKeyMapping[c]!==h&&(g=b.enumToI18nKeyMapping[c])}d.append(e("<option></option>").attr("value",this).html(""+g))});return h(c,d,a)},_hidden:function(b,a){var c=e(i.Templates.MacroBrowser.macroParameterHidden()).hide(),
d=e("input",c);return h(c,d,a)}};return{Field:h,ParameterFields:k}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-fields");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-smartfields.js' */
define("confluence-macro-browser/macro-browser-smartfields",["ajs","confluence/macro-js-overrides"],function(c,f){return function(h,d){var e=function(a){this.fileTypes=a};e.prototype.beforeParamsSet=function(a){!a.page&&(!a.date&&!a.space)&&("page"==c.params.contentType||"blogpost"==c.params.contentType?a.page=c.Editor.getCurrentTitle():"comment"==c.params.contentType&&(a.page=c.params.pageTitle));if(a.date){var b=a.date.split("/");a.page=["",b[2],b[0],b[1],a.page].join("/")}a.space&&(a.page=a.space+
":"+a.page);return a};e.prototype.beforeParamsRetrieved=function(a){if(a.page){var b=a.page.split(":");1<b.length&&(a.space=b[0],a.page=b[1]);b=a.page.split("/");1<b.length&&(a.date=[b[2],b[3],b[1]].join("/"),a.page=b[4]);(("page"==c.params.contentType||"blogpost"==c.params.contentType)&&a.page==c.Editor.getCurrentTitle()||"comment"==c.params.contentType&&a.page==c.params.pageTitle)&&delete a.page}return a};e.prototype.fields={attachment:function(a){a=d.attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=
function(a,g){c.debug("attachment:dependencyUpdated called: "+a+", "+g);var d=e.prototype.fields._parsePageLink(g);this.getData(d)};return a},full_attachment:function(a){a=d.full_attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=function(a,d){c.debug("attachment:dependencyUpdated called: "+a+", "+d);var f=e.prototype.fields._parsePageLink(d);this.getData(f)};return a},"confluence-content":function(a){return d["confluence-content"](a,{dependencies:["name"]})},_parsePageLink:function(a){var b=
{},a=a.split(":",2);b.spaceKey=2===a.length&&a[0]||c.Meta.get("space-key");b.title=a[a.length-1];0===b.title.indexOf("/")&&(b.postingDay=b.title.substr(1,10),b.title=b.title.substr(12));b.title===c.Editor.getCurrentTitle()&&(b.title="");b.title||(c.params.newPage?b.draftId=c.Meta.get("content-id"):b.pageId=c.params.pageId);return b}};h.activateSmartFieldsAttachmentsOnPage=function(a,b){f.put(a,new e(b))}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-smartfields");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-utils.js' */
define("confluence-macro-browser/macro-browser-utils",["jquery"],function(a){return{makeDefaultKey:function(){return a.makeArray(arguments).join(".")}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-utils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-cql.js' */
define("confluence-macro-browser/macro-browser-cql",["ajs","underscore","confluence/templates","confluence-ui-components/js/cql/cql-component","jquery"],function(i,g,m,n,d){function j(b){var a=b.param;return d.extend({},b,a.options,{defaultValue:a.defaultValue||a.options.defaultValue,select2CustomOptions:b.cqlSelect2CustomOptions})}function k(b){return d(m.MacroBrowser.CQL.sections({hasRenderParameters:0<b.renderParams.length}))}return{build:function(b){var a=k(b),e=b.container;e.append(a);e.bind("cql-field-adding",
function(b,c){c.element.addClass("macro-param-div");c.element.find(".cql-field-input").addClass("macro-param-input")});e.addClass("loading");a.filter(".cql-render-heading").find("button").click(function(){var b=d(this),c=b.closest(".cql-render-heading").next(),a=c.is(":visible");a?c.slideUp(300):(c.removeClass("hidden").show(),c=d(".cql-render-heading").position().top,d(".macro-input-fields").animate({scrollTop:c},300));a=a?"\u663e\u793a":"\u9690\u85cf";
b.text(a)});var f,h={param:b.cqlParam,value:b.cqlValue,container:a.filter(".cql-filter-fields"),cqlSelect2CustomOptions:b.cqlSelect2CustomOptions},h=j(h);f=n.build(h);e.data("cqlComponent",f);var l=d.Deferred();f.loading.done(function(){var a=b.cqlParam.options.requiredFields;if(a){var c=a.split(",");g.each(f.fieldRegistry||f.fieldArrays,function(a){var d=!1;g.each(a,function(a){!d&&g.contains(c,a.fieldName)&&(b.flagRequiredParam(a.element),d=!0,a.onChange(b.paramChanged))})})}e.removeClass("loading");
l.resolve()});return{elements:a,loading:l}},_makeCqlComponentOptions:j,_renderCqlSections:k}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser-cql.soy' */
// This file was automatically generated from macro-browser-cql.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.CQL.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }
if (typeof Confluence.Templates.MacroBrowser.CQL == 'undefined') { Confluence.Templates.MacroBrowser.CQL = {}; }


Confluence.Templates.MacroBrowser.CQL.sections = function(opt_data, opt_ignored) {
  return '<div class="cql-filter-fields"></div>' + ((opt_data.hasRenderParameters) ? '<h4 class="cql-render-heading"><span>' + soy.$$escapeHtml('\u9009\u9879') + '</span>' + aui.buttons.button({type: 'link', text: '\u663e\u793a', extraAttributes: {type: 'button'}}) + '</h4><div class="cql-render-fields hidden"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.CQL.sections.soyTemplateName = 'Confluence.Templates.MacroBrowser.CQL.sections';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-editor.js' */
define("confluence-macro-browser/macro-browser-editor","ajs jquery confluence/legacy confluence-macro-browser/macro-browser-cql confluence/macro-js-overrides underscore".split(" "),function(r,e,q,v,s,t){return function(k){function o(d){var a=e("#macro-insert-container").find(".macro-name").val(),b,c=k,f={},g;g={};for(var h=0,l=d.formDetails.parameters.length;h<l;h++){var j=d.formDetails.parameters[h],i;if(j.type&&j.type.name==="cql")i=e(".macro-input-fields form").data("cqlComponent").getValue();
else{i=e("#macro-param-"+j.name);var n=i.val();i.attr("type")=="checkbox"&&(n=""+i.prop("checked"));i=n}if(i){j.shared&&(f[j.name]=i);if(j.hidden||!j.defaultValue||j.defaultValue!=i)g[j.name]=i}}g[""]&&(b=g[""]);e.extend(g,c.unknownParams);(h=s.getFunction(a,"beforeParamsRetrieved"))&&(g=h(g,d,f));return{name:a,bodyHtml:c.getMacroBody(),params:g,defaultParameterValue:b}}function w(d,a,b){a.pluginKey=d.pluginKey;a.macroName=d.macroName;var c=k,f,g=a.type.name;if(b){var h=b.fields&&b.fields[g];h&&typeof h!==
"function"&&(h=h[a.name]);typeof h==="function"&&(f=h.call(b,a))}if(!f){g in c.ParameterFields&&typeof c.ParameterFields[g]==="function"||(g="string");f=c.ParameterFields[g](a)}c.fields[a.name]=f;b=f.paramDiv;c=f.input;f="macro-param-"+a.name;b.attr("id","macro-param-div-"+a.name);c.addClass("macro-param-input").attr("id",f);a.hidden&&b.hide();c=d.pluginKey;if(a.displayName==k.Utils.makeDefaultKey(c,d.macroName,"param",a.name,"label"))a.displayName=a.name;if(a.description==k.Utils.makeDefaultKey(c,
d.macroName,"param",a.name,"desc"))a.description="";e("label",b).attr("for",f).text(a.displayName);a.required&&u(b);a.description&&b.append(q.Templates.MacroBrowser.macroParameterDesc({description:a.description}));return b}function u(d){var a=d.find("label"),b=a.text()+" *";a.text(b);d.addClass("required")}return{loadMacroInBrowser:function(d){if(!d||!d.formDetails){r.trigger("analytics",{name:"macro-browser.unknown-macro-error"});alert("\u4e0d\u80fd\u5728\u5b8f\u6d4f\u89c8\u5668\u4e2d\u52a0\u8f7d\u672a\u77e5\u5b8f\u3002")}else{var a=
require("tinymce"),b=k,c=d.formDetails,f=c.macroName,g=s.get(f),h=b.settings.selectedMacro,l=a.confluence.macrobrowser.editedMacroDiv;if(g&&typeof g.opener==="function"){b.close();g.opener({name:f})}else{var a=c.parameters,j=t.find(a,function(a){return a.type.name==="cql"});e("#save-warning-span").addClass("hidden");e("#macro-insert-container .macro-name").val(f);var i=e("#macro-insert-container .macro-input-fields form");i.empty();var n=d.extendedDescription||d.description;if(j)c.documentationLink&&
b.UI.setHelpLink(b.dialog,{href:c.documentationLink});else if(n||c.documentationLink){n=e(q.Templates.MacroBrowser.macroDescription({descriptionHtml:n,documentationLink:c.documentationLink}));i.append(n)}if(c.body&&c.body.bodyType!="NONE"&&l&&e(l).hasClass("editor-inline-macro")){l=d.pluginKey;if(c.body.label==k.Utils.makeDefaultKey(l,f,"body","label"))c.body.label="";if(c.body.description==k.Utils.makeDefaultKey(l,f,"body","desc"))c.body.description="";c=c.body;l=b.selectedMacroDefinition;n=k;f=
e(q.Templates.MacroBrowser.macroBody());l=l?l.body:n.settings.selectedText;e("textarea",f).val(l||"");c.label&&e("label",f).text(c.label);c.description&&f.append(q.Templates.MacroBrowser.macroParameterDesc({description:c.description}));c.hidden&&f.hide();f&&i.append(f)}var m=h?e.extend({},h.params):{},o=i;if(j){var p;g&&g.fields&&(p=e.extend({},g.fields.cqlSelect2CustomOptions));a=t.without(a,j);p=v.build({cqlParam:j,renderParams:a,cqlValue:m.cql,container:i,flagRequiredParam:u,paramChanged:k.paramChanged,
cqlSelect2CustomOptions:p});delete m.cql;o=p.elements.filter(".cql-render-fields");p.loading.done(function(){k.paramChanged();k.Preview.previewMacro(d,h);k.UI.focusOnMacroDetailsFirstInput()})}e(a).each(function(){o.append(w(d,this,g))});g&&typeof g.beforeParamsSet==="function"&&(m=g.beforeParamsSet(m,!h));e(a).each(function(){var a;a=this.name==""?b.selectedMacroDefinition?b.selectedMacroDefinition.defaultParameterValue:this.defaultValue:m[this.name];a!=null?delete m[this.name]:e(this.aliases).each(function(){if(m[this]){a=
m[this];delete m[this]}});if(a==null)a=this.defaultValue;a!=null&&b.fields[this.name].setValue(a)});b.unknownParams=m;e("a",i).click(function(){var a=window.open(this.href,"_blank");a.focus();a.opener=null;return false});e("#macro-browser-dialog:visible").length||b.showBrowserDialog();a={};e.extend(true,a,d);if(!a.formDetails)a.formDetails={};if(!a.formDetails.body)a.formDetails.body={};b.dialog.activeMetadata=a;a.formDetails.body.content=b.settings.selectedMacro?b.settings.selectedMacro.body:a.formDetails.body.bodyType&&
a.formDetails.body.bodyType.toLowerCase()==="plain_text"?b.settings.selectedText:b.settings.selectedHtml}}},getMacroParametersFromForm:function(d){return o(d).params},getMacroDefinitionFromForm:o,processRequiredParameters:function(){if(e(".macro-input-fields form").is(".loading")){r.log("Form still loading - cannot processRequiredParameters");return false}var d=e("#macro-insert-container .macro-param-div.required .macro-param-input").not(".select2-container").filter(function(){var a=e(this).val();
return a===null||a===""}).length===0,a=d?"":"disabled",b=a?"addClass":"removeClass";e("#macro-browser-dialog button.ok").prop("disabled",a);e("#macro-browser-dialog .macro-preview-header .refresh-link").prop("disabled",a)[b]("disabled");return d}}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-editor");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preview.js' */
define("confluence-macro-browser/macro-browser-preview",["jquery","ajs","confluence/legacy","confluence/macro-js-overrides"],function(e,b,m,n){return function(d){function h(){return e("#macro-insert-container .macro-preview")}function l(){h().html("")}function i(b){b?(d.UI.showPreviewSpinner(!0),f.disable()):(d.UI.showPreviewSpinner(!1),f.enable())}var f={disable:function(){e("#macro-browser-preview-link").attr("disabled",!0).addClass("disabled")},enable:function(){e("#macro-browser-preview-link").removeAttr("disabled").removeClass("disabled")}};
return{previewMacro:function(j,g){var k=d;l();if(!d.Editor.processRequiredParameters())return b.trigger("analytics",{name:"macro-browser.missing-params-error"}),b.log("previewMacro: missing required params"),!1;"object"!==typeof g&&(g=d.Editor.getMacroDefinitionFromForm(j));var a=g.params,f=n.getFunction(j.macroName,"updateMacroParametersForPreview");f&&(a=f(a));a[""]&&delete a[""];k={contentId:m.getContentId(),macroName:j.macroName,params:a,body:k.getMacroBody(),defaultParameterValue:g.defaultParameterValue,
successCallback:function(a){var c=h().find("iframe")[0],c=c.contentDocument||c.contentWindow.document;c.write(a);c.close();e(c).ready(function(){b.trigger("macro-browser.preview-ready")});e("div.error span.error",c).length&&b.logError("Error rendering macro definition : ");setTimeout(function(){i(!1)},1E3)},errorCallback:function(a){b.logError(a);i(!1)}};a=b.params.staticResourceUrlPrefix+"/blank.html";h().html('<iframe src="'+a+'" frameborder="0" name="macro-browser-preview-frame" id="macro-preview-iframe"></iframe>');
i(!0);d.Rest.fetchMacroPreviewData(k)},removePreviewContainer:l}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preview");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-model.js' */
define("confluence-macro-browser/macro-browser-model",["ajs"],function(h){return function(f){function g(a){a.title==f.Utils.makeDefaultKey(a.pluginKey,a.macroName,"label")&&(a.title=a.macroName.charAt(0).toUpperCase()+a.macroName.substring(1).replace(/-/g," "));a.description==f.Utils.makeDefaultKey(a.pluginKey,a.macroName,"desc")&&(a.description="");a.id="macro-"+(a.alternateId||a.macroName);var b=[a.macroName,a.title].concat(a.aliases||[]);a.keywordsNoDesc=b.join(",");var d=a.description&&a.description.replace(/,/g,
" ")||"";b.push(d);a.keywords=b.join(",");return a}return{loadMacros:function(a){if(a){var b=f;b.metadataList=[];b.aliasMap={};for(var d=0,i=a.length;d<i;d++){var c=a[d],c=g(c);if(c.aliases)for(var e=0,j=c.aliases.length;e<j;e++)c.aliases[e]=c.aliases[e].toLowerCase(),b.aliasMap[c.aliases[e]]=c.macroName.toLowerCase();b.metadataList.push(c)}b.metadataList.sort(function(a,b){return a.title.toLowerCase()>b.title.toLowerCase()?1:-1})}else h.log("AJS.MacroBrowser.loadModel - no macro data, aborting")},
transformMetaDataDefault:g}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-model");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-rest.js' */
define("confluence-macro-browser/macro-browser-rest",["jquery","ajs","wrm","confluence/api/constants"],function(b,f,g,d){function c(a){f.logError(a)}var h=g.data.claim("confluence.macro.metadata.provider:macro-browser-metadata-resources.macro-meta-client-cache-key");return{loadMacroMetadata:function(a){a.data=a.data||{};a.data.macroMetadataClientCacheKey=h;return b.ajax({type:"GET",cache:!0,timeout:a.timeout||3E4,dataType:"json",url:(a.context||d.CONTEXT_PATH)+"/plugins/macrobrowser/browse-macros.action",
data:a.data,success:a.successCallback,error:a.errorCallback||c}).promise()},fetchMacroMetadataDetails:function(a){var e={id:a.id};a.alternateId&&(e.alternateId=a.alternateId);b.ajax({type:"GET",dataType:"json",url:(a.context||d.CONTEXT_PATH)+"/plugins/macrobrowser/browse-macros-details.action",data:e,success:a.successCallback,error:a.errorCallback||c})},fetchMacroPreviewData:function(a){if(!a.contentId||!a.macroName)return(a.errorCallback||c)("invalid parameters");b.ajax({type:"POST",contentType:"application/json; charset=utf-8",
url:(a.context||d.CONTEXT_PATH)+"/rest/tinymce/1/macro/preview",data:b.toJSON({contentId:a.contentId,macro:{name:a.macroName,body:a.body,params:a.params,defaultParameterValue:a.defaultParameterValue}}),dataType:"html",success:a.successCallback,error:a.errorCallback||c})}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-rest");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-UI.js' */
define("confluence-macro-browser/macro-browser-UI",["jquery","ajs","confluence/legacy","confluence/api/constants"],function(d,e,j,o){return function(k){function m(a){return d(j.Templates.MacroBrowser.macroSummaryList({category:a}))}function p(a,b){var g=d(j.Templates.MacroBrowser.macroSummaryItem());a.icon?g.prepend("<img src='"+((a.icon.relative?e.params.staticResourceUrlPrefix:"")+a.icon.location)+"' alt='icon' width='"+a.icon.width+"' height='"+a.icon.height+"' title='"+a.title+"'/>"):g.prepend("<span class='macro-icon-holder icon-"+
a.macroName+"'></span>");d(".macro-title",g).text(a.title);d(".macro-desc",g).prepend(a.description);if("gadget"==a.macroName){var f=a.gadgetUrl;f&&(f.match("^https?://.*")||(f=o.CONTEXT_PATH+"/"+f),d(".macro-title",g).after(j.Templates.MacroBrowser.gadgetLink({url:f})))}g.click(function(d){b(d,a)});return g}function q(a,b){var d;d=b?j.Templates.Dialog.helpLink(b):j.Templates.MacroBrowser.helpLink();a.getPage(a.curpage).element.find(".dialog-title").prepend(d)}return{createDialog:function(a){for(var b=
a.macros,g=a.onClickMacroSummary,f={all:m("all")},h=0,r=b.length;h<r;h++){var i=b[h];if(i.hidden)if(k.isHiddenMacroShown(i))i.categories.push("hidden-macros");else continue;f.all.append(p(i,g).attr("id",i.id));for(var n=0,s=i.categories.length;n<s;n++){var l=i.categories[n];f[l]=f[l]||m(l);f[l].append(p(i,g).attr("id",l+"-"+i.id))}}var c=e.ConfluenceDialog({width:a.width||865,height:a.height||530,id:"macro-browser-dialog",onSubmit:a.onSubmit,onCancel:a.onCancel});c.popup.element.on("keydown",".aui-button",
function(a){a.stopPropagation()});c.getPage(0).element.attr("id","select-macro-page");c.addHeader(a.title);c.addPanel("\u5168\u90e8",f.all,"all","category-button-all").getPanel(0).setPadding(0);b=0;for(g=a.categories.length;b<g;b++)h=a.categories[b],c.addPanel(h.displayName,f[h.name]||m(h.name),h.name,"category-button-"+h.name).getPanel(b+1).setPadding(0);c.addCancel("\u53d6\u6d88",a.onCancel);q(c);"VANILLA"==e.Meta.get("confluence-flavour")?c.addHelpText("<a href='{0}' id='marketplace-link'><span class='icon icon-marketplace'></span>{1}</a>",
[o.CONTEXT_PATH+"/plugins/servlet/upm/marketplace/featured?category=Macros&source=macro_browser","\u67e5\u627e\u66f4\u591a\u7684\u5b8f..."]):c.addHelpText("\u63d0\u793a\uff1a\u5728\u7f16\u8f91\u5668\u4e2d\u8f93\u5165 \u0022\u003cstrong\u003e{\u003c/strong\u003e\u0022 \u4ee5\u5728\u9875\u9762\u63d2\u5165\u5b8f\u89c2\u6307\u4ee4\u3002");f=d(j.Templates.MacroBrowser.insertMacroPanel());f.find("form").submit(function(a){k.complete();a.stopPropagation();return!1});d("#macro-browser-preview-link",f).click(function(a){d(this).prop("disabled")||k.previewMacro(c.activeMetadata);a.stopPropagation();return!1});c.addPage().addPanel("X",
f,"macro-input-panel").addLink("\u9009\u62e9\u5b8f",function(a){a.prevPage();a.searcher.focus()},"dialog-back-link").addButton("insert.name",function(){k.complete()},"ok").addCancel("\u53d6\u6d88",function(){return a.onCancel()}).getPanel(0).setPadding(0);c.getPage(1).element.attr("id","macro-details-page");d("#macro-browser-dialog .dialog-button-panel .ok").before("<span id='save-warning-span' class='hidden'></span>");c.searcher=j.DomFilterField({items:"#macro-browser-dialog .dialog-panel-body #category-all .macro-list-item",
formId:"macro-browser-search-form",inputId:"macro-browser-search",searcher:function(a,b){var e=null;if(""!=b){c.getCurrentPanel()!=c.getPanel(0)&&c.gotoPanel(0);var f=k.searchSummaries(b),e={};d.each(f,function(){e[this.id]=this})}a.each(function(){!e||this.id in e?d(this).show():d(this).hide()})},submitCallback:function(a,b){""!=b&&1===a.length&&a.click()}});c.page[0].header.append(c.searcher.form);c.page[0].ontabchange=function(a){a!=c.getPanel(0,0)&&c.searcher.reset()};f=d(j.Templates.MacroBrowser.missingUserMacroMetadataPanel({showAdminMessage:e.Meta.getBoolean("is-admin")}));
c.addPage().addPanel("\u672a\u627e\u5230\u5b8f\u7684\u5143\u6570\u636e",f,"missing-metadata-panel").addLink("\u540e\u9000",function(a){a.gotoPage(0);a.searcher.focus()},"dialog-back-link").addCancel("\u53d6\u6d88",function(){return a.onCancel()});c.gotoPage(2);c.addHeader("\u672a\u627e\u5230\u5b8f\u7684\u5143\u6570\u636e");c.gotoPanel(0,0);c.ready=!0;return c},showBrowserSpinner:function(a){var b=d("#macro-browser-dialog");a?b.spin("large"):b.spinStop()},
showPreviewSpinner:function(a){var b=d("#macro-browser-preview");a?b.spin("large"):b.spinStop()},updateButtonText:function(a){var b=d("#macro-browser-dialog .dialog-button-panel .ok");"edit"==a?b.text("\u4fdd\u5b58"):b.text("\u63d2\u5165")},enableSaveButton:function(a){d("#macro-browser-dialog .dialog-button-panel .ok").prop("disabled",!a)},focusOnMacroDetailsFirstInput:function(){var a=d("#macro-insert-container").find(".macro-input-fields :input:visible:not(button,.select2-offscreen)").first();
if(a.length){if(a.hasClass("select2-input")){var b=a.closest(".select2-container").parent().find(".select2-offscreen");if("function"!==typeof b.select2){e.log("select2Hidden is not a select2 hidden input, skipping focus attempt.");return}b.select2("open");b.select2("close")}else a.focus();!k.selectedMacroDefinition&&""!==a.val()&&a.select()}else e.log("No input to focus")},setHelpLink:q}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-UI");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser.js' */
define("confluence-macro-browser/macro-browser","window jquery ajs confluence-macro-browser/macro-browser-utils confluence-macro-browser/macro-browser-editor confluence-macro-browser/macro-browser-fields confluence-macro-browser/macro-browser-model confluence-macro-browser/macro-browser-preview confluence-macro-browser/macro-browser-rest confluence-macro-browser/macro-browser-UI confluence-macro-browser/macro-browser-smartfields confluence-macro-browser/macro-parameter-serializer confluence/macro-js-overrides underscore".split(" "),
function(k,h,e,r,s,l,t,u,v,w,x,y,i){var a={},l=l(a);a.ParameterFields=l.ParameterFields;a.Field=l.Field;x(a,a.ParameterFields);a.Utils=r;a.Editor=s(a);a.Preview=u(a);a.Model=t(a);a.Rest=v;a.UI=w(a);var f,g=function(b,c){var d={id:b.macroName,successCallback:function(b){if(b&&b.details)b.details=a.Model.transformMetaDataDefault(b.details);a.Editor.loadMacroInBrowser(b.details,c);g.displayDetails();a.Preview.previewMacro(b.details)},errorCallback:function(){e.trigger("analytics",{name:"macro-browser.fetch-metadata-error"});
k.alert("\u52a0\u8f7d\u5b8f\u6d4f\u89c8\u5668\u65f6\u53d1\u751f\u9519\u8bef\u3002\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7cfb\u7edf\u7ba1\u7406\u5458\u3002");g.displayDetails()}};if(b.alternateId)d.alternateId=b.alternateId;g.setUI(c,b.title);a.Rest.fetchMacroMetadataDetails(d)};g.setUI=function(b,c){var d=b=="edit"?a.editTitle:a.insertTitle;h("#macro-insert-container").hide();a.UI.updateButtonText(b);a.UI.enableSaveButton(false);a.dialog.gotoPage(1).addHeader(d.replace(/\{0\}/,c));a.dialog.show();a.UI.showBrowserSpinner(true)};g.displayDetails=function(){a.UI.showBrowserSpinner(false);a.UI.enableSaveButton(false);
h("#macro-insert-container").show();a.UI.focusOnMacroDetailsFirstInput()};a.reset=function(){f&&f.resolve&&f.resolve();f=null;a.initMacroBrowserAfterRequest=null;a.initData=null;a.hasInit=false;a.metadataList=[];a.aliasMap={};a.fields={};i.reset();a.Macros=i.elements()};a.getMacroJsOverride=i.get;a.setMacroJsOverride=i.put;a.Macros=i.elements();a.hasInit=false;a.metadataList=[];a.aliasMap={};a.fields={};a.processRequiredParameters=function(){return a.Editor.processRequiredParameters()};a.paramChanged=
function(){a.Editor.processRequiredParameters()};a.loadMacroInBrowser=function(b,c){a.Editor.loadMacroInBrowser(b,c)};a.getMacroDefinitionFromForm=function(b){a.Editor.getMacroDefinitionFromForm(b)};a.getMacroParametersFromForm=function(b){a.Editor.getMacroParametersFromForm(b)};a.previewMacro=function(b){a.Preview.previewMacro(b)};a.previewOnload=function(b){var c=i.getFunction(a.dialog.activeMetadata.macroName,"postPreview");c&&c(h("#macro-preview-iframe")[0],a.dialog.activeMetadata);e.Editor.disableFrame(b);
h(b).click(function(a){if(a.target.tagName.toLowerCase()==="a"){if((a=h(a.target).attr("href"))&&a.indexOf("#")!=0&&a.indexOf(k.location)==-1){a=k.open(a,"_blank");a.focus();a.opener=null}return false}})};a.getMacroMetadata=function(b){for(var c=0,d=a.metadataList.length;c<d;c++){var j=a.metadataList[c];if(j.macroName==b)return j}return null};a.getMetadataPromise=function(){return f};a.open=function(b){if(!b){b={};e.log("No settings to open the macro browser.")}var c=b.selectedMacro;!c&&b.presetMacroMetadata&&
(c={name:b.presetMacroMetadata.macroName});if(c&&c.name){var d=i.getFunction(c.name,"opener");if(d){d(c);return}}if(!a.hasInit){e.debug("init macro browser");a.UI.showBrowserSpinner(true);if(a.initData!==null&&h.isEmptyObject(a.initData)){e.trigger("analytics",{name:"macro-browser.init-reattempt"});e.logError("Macro browser preload failed. Trying again...");a.initMacroBrowserAfterRequest=b;a.preLoadMacro();return}if(a.initData)a.initBrowser();else{e.trigger("analytics",{name:"macro-browser.init-overlap"});
e.debug("Waiting for macro browser preloading...");a.initMacroBrowserAfterRequest=b;return}}a.openMacroBrowser(b)};a.openMacroBrowser=function(b){a.settings=b;a.selectedMacroDefinition=b.selectedMacro;var c=a.selectedMacroDefinition&&a.selectedMacroDefinition.name||b.presetMacroName;if(b.presetMacroName)b.presetMacroMetadata=a.getMacroMetadata(b.presetMacroName);var d=b.presetMacroMetadata;if(!d){var j=b.selectedMacro;if(j){var c=j.name.toLowerCase(),c=a.aliasMap[c]||c,f=i.getFunction(c,"updateSelectedMacro"),
g=i.getFunction(c,"getMacroDetailsFromSelectedMacro");f&&f(j);g&&(d=g(a.metadataList,j));d||(d=a.getMacroMetadata(c))}}j=h("#macro-browser-dialog").find("button.back");if(d){e.debug("Open macro browser to edit macro: "+d.macroName);j.hide();a.replicateSelectMacro(d,b.mode||"edit")}else if(c){j.show();a.dialog.overrideLastTab();a.dialog.gotoPage(2);a.showBrowserDialog()}else{j.show();if(b.selectedCategory){c=h("#select-macro-page .dialog-page-menu button").index(h("#category-button-"+b.selectedCategory));
c<0&&(c=0);a.dialog.overrideLastTab();a.dialog.gotoPanel(0,c)}else a.dialog.gotoPage(0);a.showBrowserDialog();a.dialog.searcher.focusAndSearch(b.searchText)}};a.showBrowserDialog=function(){a.dialog.show();a.UI.showBrowserSpinner(false)};a.complete=function(){if(h("#macro-browser-dialog .dialog-button-panel .ok").is(":visible:not(:disabled)")){var b=a.dialog.activeMetadata,c=i.getFunction(b.macroName,"manipulateMarkup");c&&c(b);b=a.Editor.getMacroDefinitionFromForm(b);a.close();if(a.settings.onComplete)a.settings.onComplete(b)}};
a.cancel=function(){a.close();if(typeof a.settings.onCancel==="function")a.settings.onCancel();return false};a.close=function(){this.unknownParams={};this.fields={};a.Preview.removePreviewContainer();this.dialog.hide()};a.replicateSelectMacro=function(a,c){g(a,c)};a.initBrowser=function(){var b=a.initData;if(!b.categories||!a.metadataList.length){e.trigger("analytics",{name:"macro-browser.init-browser-error"});k.alert("\u52a0\u8f7d\u5b8f\u6d4f\u89c8\u5668\u65f6\u53d1\u751f\u9519\u8bef\u3002\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7cfb\u7edf\u7ba1\u7406\u5458\u3002");a.UI.showBrowserSpinner(false);
return false}a.editTitle=b.editTitle;a.insertTitle=b.insertTitle;var c;b.categories=h.map(b.categories,function(a){if(a.name=="hidden-macros"){c=a;return null}return a});b.categories.sort(function(a,b){return a.displayName.toLowerCase()>b.displayName.toLowerCase()?1:-1});c&&e.params.showHiddenUserMacros&&b.categories.push(c);a.dialog=a.UI.createDialog({title:b.title,categories:b.categories,macros:a.metadataList,onClickMacroSummary:function(a,b){a.preventDefault();g(b,"insert")},onSubmit:a.complete,
onCancel:a.cancel});return a.hasInit=true};a.searchSummaries=function(b,c){var c=h.extend({splitRegex:/[\s-]+/},c),d;d=a.metadataList;var e,f,i,g,m,k,l,p,n,o,q;if(b){e=c&&c.keywordsField||"keywords";f=c&&c.ignoreForCamelCase?"i":"";i=c&&c.matchBoundary?"\\b":"";g=c&&c.splitRegex||/\s+/;g=b.split(g);m=[];g.forEach(function(a){k=[RegExp(i+a,"i")];if(/^([A-Z][a-z]*) {2,}$/.test(this)){l=this.replace(/([A-Z][a-z]*)/g,"\\b$1[^,]*");k.push(RegExp(l,f))}m.push(k)});p=[];d.forEach(function(a){for(n=0;n<m.length;n++){q=
false;for(o=0;o<m[n].length;o++)if(m[n][o].test(a[e])){q=true;break}if(!q)return}p.push(a)});d=p}else d=[];return d};a.getMacroBody=function(){var b="";if(h("#macro-insert-container .macro-body-div textarea").length)b=h("#macro-insert-container .macro-body-div textarea").val();else if(a.selectedMacroDefinition){if(a.selectedMacroDefinition.body)b=a.selectedMacroDefinition.body}else if(a.dialog.activeMetadata)b=a.dialog.activeMetadata.formDetails.body.content;return b};a.getMacroParams=function(a){return y.deserialize(a.getAttribute("data-macro-parameters"))};
a.getMacroName=function(a){return!a.hasAttribute("data-macro-name")?void 0:a.getAttribute("data-macro-name")};a.isHiddenMacroShown=function(a){return e.params.showHiddenUserMacros&&a.pluginKey=="_-user-macro-_"};a.hasRequiredParameters=function(a){return a.anyParameterRequired};a.setWhitelist=function(b){a.whitelist=b};a.preLoadMacro=function(){a.initData=null;if(f&&f.state()==="pending")return f;f=a.Rest.loadMacroMetadata({data:a.whitelist?{whitelist:a.whitelist}:{detailed:false},successCallback:function(b){a.initData=
b;a.Model.loadMacros(b.macros);if(a.initMacroBrowserAfterRequest){a.initBrowser();a.openMacroBrowser(a.initMacroBrowserAfterRequest)}},errorCallback:function(b){e.trigger("analytics",{name:"macro-browser.preload-error"});e.logError("Error requesting macro browser metadata:");e.logError(b);a.initData={}}})};return a});require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-browser","AJS.MacroBrowser");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser.soy' */
// This file was automatically generated from macro-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }


Confluence.Templates.MacroBrowser.macroSummaryList = function(opt_data, opt_ignored) {
  return '<ol id="category-' + soy.$$escapeHtml(opt_data.category) + '" class="macro-list"></ol>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryList.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryList';
}


Confluence.Templates.MacroBrowser.macroSummaryItem = function(opt_data, opt_ignored) {
  return '<li class="macro-list-item"><h4 class="macro-title"></h4>' + Confluence.Templates.MacroBrowser.macroDescription({description: ''}) + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryItem.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryItem';
}


Confluence.Templates.MacroBrowser.macroDescription = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="macro-desc">' + ((opt_data.descriptionHtml) ? soy.$$filterNoAutoescape(opt_data.descriptionHtml) : '') + ((opt_data.documentationLink) ? ' <a href="' + soy.$$escapeHtml(opt_data.documentationLink) + '" class="macro-doco-link">' + soy.$$escapeHtml('\u6587\u6863') + '</a>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroDescription.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroDescription';
}


Confluence.Templates.MacroBrowser.insertMacroPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-insert-container"><input class="macro-name" type="hidden"/><div class="macro-input-fields dialog-panel"><form action="#" class="aui"></form></div><div class="macro-preview-container dialog-panel"><div class="macro-preview-header"><ul class="macro-preview-links"><li><a id="macro-browser-preview-link" class="refresh-link icon icon-refresh" href="#">' + soy.$$escapeHtml('\u5237\u65b0') + '</a></li></ul><span>' + soy.$$escapeHtml('\u9884\u89c8') + '</span></div><div id="macro-browser-preview" class="macro-preview"></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.insertMacroPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.insertMacroPanel';
}


Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-missing-metadata-container"><p>' + '\u6b64\u5b8f\u672a\u914d\u7f6e\u5143\u6570\u636e\uff0c\u6545\u914d\u7f6e\u754c\u9762\u65e0\u6cd5\u663e\u793a\u3002' + '</p>' + ((opt_data.showAdminMessage) ? '<p>' + AJS.format('\u5982\u679c\u4f7f\u7528\u7528\u6237\u5b8f\uff0c\u8bf7\u4f7f\u7528 \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3e\u7528\u6237\u5b8f\u7ba1\u7406\x3c/a\x3e \u63a7\u5236\u53f0\u6dfb\u52a0\u5143\u6570\u636e\u5230\u6a21\u677f\u4e2d\u3002',"/confluence" + '/admin/usermacros.action') + '</p>' : '<p>' + '\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u4e3a\u6b64\u5b8f\u914d\u7f6e\u5143\u6570\u636e\u3002' + '</p>') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel';
}


Confluence.Templates.MacroBrowser.macroParameter = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><input type="text" class="text"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameter.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameter';
}


Confluence.Templates.MacroBrowser.macroParameterBoolean = function(opt_data, opt_ignored) {
  return '<div class="checkbox macro-param-div boolean-param"><input class="checkbox" type="checkbox" value="true"/><label></label></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterBoolean.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterBoolean';
}


Confluence.Templates.MacroBrowser.macroParameterSelect = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><select class="select"></select></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterSelect.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterSelect';
}


Confluence.Templates.MacroBrowser.macroParameterHidden = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><input type="hidden"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterHidden.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterHidden';
}


Confluence.Templates.MacroBrowser.macroParameterDesc = function(opt_data, opt_ignored) {
  return '<div class="macro-param-desc">' + soy.$$filterNoAutoescape(opt_data.description) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterDesc.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterDesc';
}


Confluence.Templates.MacroBrowser.macroBody = function(opt_data, opt_ignored) {
  return '<div class="macro-body-div"><label>' + soy.$$escapeHtml('\u6b63\u6587') + '</label><textarea class="monospaceInput textarea" type="text" rows="10"></textarea></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroBody.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroBody';
}


Confluence.Templates.MacroBrowser.helpLink = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-80/Macros"});
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.helpLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.helpLink';
}


Confluence.Templates.MacroBrowser.gadgetLink = function(opt_data, opt_ignored) {
  return '<a class=\'macro-uri\' href="' + soy.$$escapeHtml(opt_data.url) + '" title="' + soy.$$escapeHtml(opt_data.url) + '" target=\'_blank\'>' + soy.$$escapeHtml('\u5c0f\u5de5\u5177 URL') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.gadgetLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.gadgetLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preload.js' */
define("confluence-macro-browser/macro-browser-preload",["jquery","ajs","window"],function(a,b,c){return{macroBrowserPreload:function(){a(c).bind("render-content-loaded",function(c,d){a("#macro-preview-iframe").contents().find("body")[0]==d&&b.MacroBrowser.previewOnload(d)});b.MacroBrowser.preLoadMacro()}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preload",function(a){require("ajs").toInit(a.macroBrowserPreload)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item.soy' */
// This file was automatically generated from file-item.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.fileDialogListItem = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-owner-id="' + soy.$$escapeHtml(opt_data.file.ownerId) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.tooltip) + '">' + ((opt_data.file.isImage) ? '<img class="thumbnail hidden" src="' + soy.$$escapeHtml(opt_data.file.nonceUrl) + '" ><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : (opt_data.file.isPreviewable) ? '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<i class="abs-icon select">Select</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedImageNameContent) + '</span>' + ((opt_data.highlightedParentTitleContent) ? '<span class="caption owner-title" title="' + soy.$$escapeHtml(opt_data.file.parentTitle) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedParentTitleContent) + '</span>' : '') + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItem.soyTemplateName = 'Confluence.Templates.File.fileDialogListItem';
}


Confluence.Templates.File.fileDialogListItemPlaceHolder = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + ((opt_data.file.isImage && opt_data.file.url) ? '<img class="thumbnail" src="' + soy.$$escapeHtml(opt_data.file.url) + '">' : '<span class="thumbnail"><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<div id="docs-progress-bar-' + soy.$$escapeHtml(opt_data.file.fileId) + '" class="aui-progress-indicator"><span class="aui-progress-indicator-value"></span></div><div class="overlay"></div><i class="aui-icon aui-icon-small aui-iconfont-close-dialog abs-icon cancel">Cancel</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$escapeHtml(opt_data.file.fileName) + '</span><span class="caption owner-title hidden" title=""></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItemPlaceHolder.soyTemplateName = 'Confluence.Templates.File.fileDialogListItemPlaceHolder';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-model.js' */
define("confluence-editor/files/file-item/file-item-model",["backbone","confluence/legacy","confluence/api/constants","ajs"],function(e,c,f,d){return e.Model.extend({defaults:{id:-1,ownerId:-1,fileName:"",nonceUrl:"",isImage:!1,isFilePlaceHolder:!1,isSelect:!1,thumbnailUrl:"",downloadUrl:""},initialize:function(){var a=this;this._findDownloadUrl();this._findThumbnailUrl();this.findMetadata();this.findVersion();this.findContainer();this.set("fileName",this.getFileName());this.set("nonceUrl",this.getNonceUrl());
this.set("isImage",this.isImage());this.set("isPreviewable",this.isPreviewable());this.get("isFilePlaceHolder")&&this.set("id",this.get("fileId"));this.listenTo(this,"change:link",function(){a.set("nonceUrl",a.getNonceUrl());a._findDownloadUrl()});this.set("iconAUIClass",this._parseFileNameToAuiIconClass(this.get("fileName")))},isImage:function(){return this.get("isImage")?!0:!!this.get("thumbnailUrl")},isPreviewable:function(){return"application/pdf"===(this.get("niceType")||"").toLocaleLowerCase()||
this.isImage()},getFileName:function(){return this.get("fileName")||this.get("title")||""},getDestinationUrl:function(){return d.REST.wikiLink(this.attributes).destination},getNonceUrl:function(){var a=this.get("thumbnailUrl");if(0<=a.indexOf("modificationDate"))return a;var b=this.get("lastModifiedDate"),b=b?b.date:+new Date,b=encodeURIComponent(b);a&&(a+=(a.indexOf("?")+1?"&":"?")+"nonce="+b);return a},getRelativeUrl:function(a){var b=a;if(!a)return a;0===a.indexOf(c.getBaseUrl())&&(b=a.replace(c.getBaseUrl(),
""));return f.CONTEXT_PATH+b},_findThumbnailUrl:function(){var a=this.get("_links");!this.get("thumbnailUrl")&&(a&&a.thumbnail)&&this.set("thumbnailUrl",this.getRelativeUrl(a.thumbnail))},_findDownloadUrl:function(){var a=this.get("_links");!this.get("downloadUrl")&&a&&this.set("downloadUrl",this.getRelativeUrl(a.download))},findMetadata:function(){var a=this.get("metadata");!this.get("contentType")&&a&&(this.set("niceType",a.mediaType),this.set("contentType",a.mediaType))},findVersion:function(){var a=
this.get("version");!this.get("versionNumber")&&a&&this.set("versionNumber",a.number)},findContainer:function(){var a=this.get("container");a&&(-1===this.get("ownerId")&&this.set("ownerId",a.id),this.get("parentTitle")||this.set("parentTitle",a.title))},_getFileExtension:function(a){return a.substr(a.lastIndexOf(".")+1)},_parseFileNameToAuiIconClass:function(a){return d.Confluence.FileTypesUtils.getAUIIconFromExt(this._getFileExtension(a))}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-model","Confluence.Editor.FileDialog.FileItemModel");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-view.js' */
define("confluence-editor/files/file-item/file-item-view","backbone confluence/templates confluence/highlighter raphael underscore wrm jquery".split(" "),function(f,g,h,i,d,j,c){return f.View.extend({template:g.File.fileDialogListItem,model:null,initialize:function(a){var b=this;this.eventListener=a.eventListener;this.model=a.model;this.showContainerInfo=a.showContainerInfo;this.highlighter=a.highlighter;this.listenTo(this.model,"change:isSelect",function(){b.$el.toggleClass("selected",b.model.get("isSelect"))})},
render:function(){var a=this.highlighter||new h,b=this.model.get("space"),e=this.model.getFileName(),a={file:this.model.attributes,tooltip:this.showContainerInfo&&b?e+" ("+b.name+")":e,highlightedImageNameContent:a.highlight(e),highlightedParentTitleContent:this.showContainerInfo?a.highlight(this.model.get("container").title):null};this.$el=c(this.template(a));this.el=this.$el[0];this.delegateEvents();this.$el.find(".file-container").tooltip({aria:true});this.$el.attr("data-destination",this.model.getDestinationUrl());
this.model.get("isImage")?this._renderLoadingSpinner():this.$el.removeClass("loading");this.model.get("isPreviewable")&&this._renderPreviewButton();return this},_renderPreviewButton:function(){this.$(".zoom").on("click",d.bind(function(a){a.preventDefault();a={src:this.model.get("downloadUrl"),thumbnail:this.model.get("nonceUrl")||this.model.get("downloadUrl"),type:this.model.get("contentType"),rank:0,title:this.model.getFileName(),id:this.model.get("id"),ownerId:this.model.get("ownerId"),version:this.model.get("versionNumber")};
this._setupAndShowPreviewer(a)},this))},_setupAndShowPreviewer:function(a){var b=d.bind(function(a,b){this.loader=require("cp/confluence/file-preview-loader");var c=this.loader.setupPreviewForSingleFile([a],b);c.on("fv.open",b.openPreviewCallback);c.on("fv.close",b.closePreviewCallback);c.open();c.showFileWhere()},this);if(!this.dfd)this.dfd=j.require("wr!com.atlassian.confluence.plugins.confluence-previews:confluence-previews-resources");this.dfd.then(d.partial(b,a,{viewMode:"simple",openPreviewCallback:function(){c("#insert-image-dialog").hide();
c(".aui-blanket").hide()},closePreviewCallback:function(){c("#insert-image-dialog").show();c(".aui-blanket").show()}}))},_renderLoadingSpinner:function(){var a=this,b=this.$el.find(".image-preview-throbber").removeClass("hidden"),c=i.spinner(b[0],8,"#666"),d=this.$el.find("img").load(function(){c();b.remove();d.removeClass("hidden");a.$el.removeClass("loading")})}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-view","Confluence.Editor.FileDialog.FileItemView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-placeholder-view.js' */
define("confluence-editor/files/file-item/file-placeholder-view",["backbone","confluence/templates","underscore","ajs","jquery"],function(b,d,e,f,g){return b.View.extend({model:null,template:d.File.fileDialogListItemPlaceHolder,initialize:function(a){this.model=a.model;this.eventListener=a.eventListener;this.eventListener.on("file.placeholder.process",e.bind(this._setUploadInProgress,this))},events:{"click .cancel":"_cancelUpload"},render:function(){this.$el=g(this.template({file:this.model.attributes}));
this.el=this.$el[0];this.delegateEvents();return this},_setUploadInProgress:function(a,b){var c=this.$el.find("#docs-progress-bar-"+b||"");c.length&&(1===a&&this.$(".cancel").hide(),c.show(),f.progressBars.update(c,a))},_cancelUpload:function(){this.eventListener.trigger("uploadingfile.cancelled",this.model.get("fileId"))}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-placeholder-view","Confluence.Editor.FileDialog.FilePlaceHolderView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-collection.js' */
define("confluence-editor/files/file-list/file-list-collection",["backbone","confluence-editor/files/file-item/file-item-model","underscore"],function(c,d,e){return c.Collection.extend({model:d,clearSelection:function(){this.each(function(a){a.get("isSelect")&&a.set("isSelect",!1)});this.trigger("clear.selection")},getAllSelectItems:function(){return this.filter(function(a){return a.get("isSelect")})},setSelection:function(a){e.each(a,function(a){return a.set("isSelect",!0)})},resetFiles:function(a){this.reset();
for(var b=0;b<a.length;b++)this.addFile(a[b])},addFile:function(a){a=this.add(a);this.trigger("add-file",a.at(a.length-1))},removeFile:function(a){this.remove(a);this.trigger("remove-file",a)},replaceFile:function(a,b){this.remove(a);this.add(b);this.trigger("replace-file",a,b)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-collection","Confluence.Editor.FileDialog.FileListCollection");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-view.js' */
define("confluence-editor/files/file-list/file-list-view","backbone confluence-editor/files/file-item/file-item-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-item/file-placeholder-view confluence/api/constants jquery".split(" "),function(f,g,h,i,j,c){return f.View.extend({eventListener:null,events:{click:"_clearSelection","click li.attached-file":"_clickItem","dblclick li.attached-file":"_doubleClickItem"},initialize:function(a){var b=this;this.collection=a.collection;
if(a.eventListener){this.eventListener=a.eventListener;this.listenTo(this.eventListener,"uploadingfile.completed",this._addUploadedFile);this.listenTo(this.eventListener,"uploadingfile.cancelled",this._cancelUploadingFile)}this.listenTo(this.collection,"reset",this._clearFileList);this.listenTo(this.collection,"add-file",this._renderNewItem);this.listenTo(this.collection,"remove-file",this._removeItem);this.listenTo(this.collection,"replace-file",this._replaceItem);this.listenTo(this.collection,"change:isSelect",
function(){this.context.setSelectItems(this.collection.getAllSelectItems())});this.listenTo(this.collection,"change:link",function(a){b.collection.removeFile(a);b.collection.addFile(a)});this.updateDialogContext(a.context);this.updatePanelContext(a.panelContext)},_addUploadedFile:function(a,b){var d=this;c.get(j.CONTEXT_PATH+"/rest/api/content/"+b+"?expand=version,container,space").done(function(b){var b=new h(b),c=d.collection.get(a);c||(c=d.collection.findWhere({fileName:b.get("fileName")}));c?
d.collection.replaceFile(c,b):d.collection.addFile(b)})},_cancelUploadingFile:function(a){(a=this.collection.get(a))&&(a.get("previousUploadedFile")?this.collection.replaceFile(a,a.get("previousUploadedFile")):this.collection.removeFile(a))},render:function(){return this},resetFileList:function(a,b){b=b||{};this.$el.find(".loading-message").addClass("hidden");this.$el.find(".no-files").remove();this.collection.resetFiles(a);this.collection.length===0&&this.$fileList.before(c("<p></p>").addClass("no-files").text(this.noFileMessage));
b.shouldClearSelection&&this.collection.clearSelection();this._checkError(b.errors);this.$el.sizeToFit()},_getViewFromModel:function(a){return a.get("isFilePlaceHolder")?(new i({model:a,eventListener:this.eventListener})).render():(new g({model:a,showContainerInfo:this.showContainerInfo,highlighter:this.highlighter,eventListener:this.eventListener})).render()},_renderNewItem:function(a){if(this.$fileList&&this.$fileList.length){var b=this._getViewFromModel(a);this.$fileList.prepend(b.el);a.get("isFilePlaceHolder")||
a.set("isSelect",true)}},_removeItem:function(a){if(this.$fileList&&this.$fileList.length)(a=this._getDomElementByFileName(a.get("fileName")))&&a.remove()},_replaceItem:function(a,b){if(this.$fileList&&this.$fileList.length){var c=this._getViewFromModel(b),e=this._getDomElementByFileName(a.get("fileName"));e&&e.length?e.replaceWith(c.el):this.$fileList.prepend(c.el);b.set("isSelect",true)}},_getDomElementByFileName:function(a){var b=null;this.$fileList.find("li").each(function(){var d=c(this);d.attr("data-file-name")===
a&&(b=d)});return b},updatePanelContext:function(a){if(a){this.panelContext=a;this.errors=this.panelContext.errors||[];this.$el=this.fileContainer=this.panelContext.fileContainer;this.el=this.$el[0];this.$fileList=this.$el.find(".file-list");this.delegateEvents();this.noFileMessage=this.panelContext.noFileMessage;this.showContainerInfo=this.panelContext.showContainerInfo;this.highlighter=this.panelContext.highlighter;this.displayErrors=this.panelContext.displayErrors}},updateDialogContext:function(a){if(a){this.context=
a;this.contextOptions=this.context.options}},_checkError:function(a){(a=a||[])&&a.length&&this.displayErrors(a)},_clearSelection:function(a){a=a&&c(a.target);if(!a||!a.hasClass("close-tip")){this.collection.clearSelection();this.$el.find(".current").removeClass("current")}},_clearFileList:function(){this.$fileList&&this.$fileList.empty()},_clickItem:function(a){a.stopPropagation();a.preventDefault();var b=c(a.target);if(!b.closest(".zoom").length){a.isTrigger||this.$fileList.find(".current").removeClass("current");
a=b.closest("li").attr("data-attachment-id");(a=this.collection.get(a))&&!a.get("isFilePlaceHolder")&&a.set("isSelect",!a.get("isSelect"))}},_doubleClickItem:function(a){var a=c(a.target).closest("li"),b=a.attr("data-attachment-id");if((b=this.collection.get(b))&&!b.get("isFilePlaceHolder")){a.click();this.context.insert()}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-view","Confluence.Editor.FileDialog.FileListView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/base-panel/base-panel-view.js' */
define("confluence-editor/files/base-panel/base-panel-view",["backbone","ajs","jquery"],function(b,a,c){return b.View.extend({context:null,cssContainer:"",cssPanel:"",textErrorSearch:"\u641c\u7d22\u9644\u4ef6\u51fa\u9519\uff0c\u670d\u52a1\u5668\u53ef\u80fd\u80fd\u5df2\u5931\u6548\u3002",textErrorRetrieving:"\u65e0\u6cd5\u4eceConfluence\u83b7\u53d6\u9644\u4ef6\u4fe1\u606f\u3002\u670d\u52a1\u5668\u4e0d\u53ef\u7528\u3002",textDefaultErrorMessage:"\u65e0\u6cd5\u4e0a\u4f20\u6587\u4ef6\u3002\u670d\u52a1\u5668\u4e0d\u53ef\u7528\u3002",textUploading:"\u56fe\u50cf\u4e0a\u4f20\u4e2d......",initialize:function(){},createPanel:function(d){this.context=
d;this.render();var a=this;if(d=this.context.getPanel(this.panelId))d.onselect=function(){a.context.clearSelection();a.focus&&a.focus()}},render:function(){return this},getPanelElement:function(){return c(this.cssPanel,this.context.baseElement)},getContainer:function(){return c(this.cssContainer)},getForm:function(){return c("form",this.getPanelElement())},clearContainer:function(){var a=this.getContainer();a.find(".loading-message").removeClass("hidden");a.find(".warning").addClass("hidden")},clearErrors:function(){this.messenger.clearMessages()},
displayErrors:function(a){this.uploader.displayErrors(a);this.getContainer().sizeToFit()},getNoFileContainer:function(){return this.getPanelElement().find(".no-files")},getFileListContainer:function(){return this.getPanelElement().find("ul.file-list")}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/base-panel/base-panel-view","Confluence.Editor.FileDialog.BasePanel",function(){var b=require("underscore"),a=require("backbone");require("confluence/legacy").Editor.FileDialog.eventListener=b.extend({},a.Events)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel.soy' */
// This file was automatically generated from attachments-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.uploadFileForm = function(opt_data, opt_ignored) {
  return '' + ((opt_data.hasAttachPermission) ? '<div id="upload-attachment">' + ((opt_data.isNonSupportDragDrop) ? '<form action="' + soy.$$escapeHtml("/confluence") + '/pages/attachfile.action" method="post" enctype="multipart/form-data">' : '<form>') + '<button id="upload-files-button" class="aui-button upload-files"><span class="file-upload-icon aui-icon aui-icon-small aui-iconfont-upload"></span>&nbsp;&nbsp;' + soy.$$escapeHtml('\u4e0a\u4f20\u6587\u4ef6') + ((opt_data.isNonSupportDragDrop) ? '<input name="file_0" type="file" class="upfile invisible">' : '') + '</button>' + ((opt_data.isNonSupportDragDrop) ? '<input type="hidden" name="minorEdit_0" value="true" /><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" />' : '') + '</form>' + ((opt_data.isNonSupportDragDrop) ? '<div class="upload-in-progress hidden">' + soy.$$escapeHtml('\u56fe\u50cf\u4e0a\u4f20\u4e2d......') + '</div>' : '') + '</div>' : '') + ((opt_data.hasAttachPermission) ? '<div class="divider"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.File.uploadFileForm.soyTemplateName = 'Confluence.Templates.File.uploadFileForm';
}


Confluence.Templates.File.attachedFilesPanel = function(opt_data, opt_ignored) {
  return '<div id="attached-files" class="scroll-wrapper">' + aui.message.warning({title: '', closeable: 'true', content: ''}) + '<div class="loading-message hidden">' + soy.$$escapeHtml('\u6b63\u5728\u52a0\u8f7d...') + '</div><ul class="file-list"></ul></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.attachedFilesPanel.soyTemplateName = 'Confluence.Templates.File.attachedFilesPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel-view.js' */
define("confluence-editor/files/attachments-panel/attachments-panel-view","confluence-editor/files/file-list/file-list-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates confluence/legacy confluence/api/constants ajs confluence/meta underscore window jquery".split(" "),function(n,i,o,j,k,p,l,e,h,m,f,g){return j.extend({id:"attachments",panelId:"",cssPanel:".attachments-panel",
cssContainer:"#attached-files",textNoFileMessage:"\u672c\u9875\u9762\u6ca1\u6709\u9644\u4ef6",textPanelTitle:"\u6dfb\u52a0\u5230\u6b64\u9875\u9762",initialize:function(a){j.prototype.initialize.call(this);this.eventListener=a.eventListener;this.context=null;this.collection=new o;this.fileListView=new n({collection:this.collection,eventListener:this.eventListener});this.xhrCount=0},render:function(){var a=this;this.eventListener.trigger("AttachmentsPanelView.render",this);this.fileListView.updateDialogContext(this.context);
this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"attachments-panel");this.el=this.getPanelElement();this.$el=g(this.el);this.delegateEvents();this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:this.textNoFileMessage,showContainerInfo:false,errors:[],displayErrors:function(b){a.uploader.clearErrors();a.uploader.displayErrors(b)}});this.uploader=this.getUploaderController(this.context);this.messenger=this.uploader.getMessageHandler();this.collection.reset();
this._canAttachFiles()?this.refresh({shouldClearSelection:true}):this.refresh({errors:["\u6ca1\u6709\u6743\u9650\u9644\u52a0\u6587\u4ef6\u5230\u5185\u5bb9\u4e2d\uff0c\u9700\u8981\u8054\u7cfb\u7a7a\u95f4\u7ba1\u7406\u5458\u83b7\u5f97\u8be5\u6743\u9650\u3002"],shouldClearSelection:true});return this},getPanel:function(){return k.File.uploadFileForm({isNonSupportDragDrop:!this._hasXhrSupport(),atlToken:h.get("atl-token"),hasAttachPermission:this._canAttachFiles()})+k.File.attachedFilesPanel()},_overideUploaderClientForNonDragDropSupport:function(){var a=this;return{onUploadSuccess:function(b){for(var c=0;c<b.length;c++){var d=
b[c].id,e=a.collection.get(d);e&&a.collection.removeFile(e);g.get(l.CONTEXT_PATH+"/rest/api/content/"+d+"?expand=version,container,space").done(function(b){b=new i(b);a.collection.addFile(b)})}},pack:function(){a.getContainer().sizeToFit()},getDefaultErrorMessage:function(){return a.textDefaultErrorMessage},getDefaultUploadingMessage:function(){return a.textUploading},displayErrors:function(b){this.getMessageHandler().displayMessages(b);a._showErrorIconInMessageBox();this.pack()}}},getUploaderController:function(){return p.AttachmentUploader({baseElement:this.getPanelElement()},
m.bind(this._overideUploaderClientForNonDragDropSupport,this))},refresh:function(a){var b=this,c=a.shouldClearSelection?this.getPanelElement().find(".loading-message"):false,d=this.xhrCount=this.xhrCount+1;e.getJSONWrap({url:this._getUrlREST(),messageHandler:this.messenger,loadingElement:c,errorMessage:this.textErrorRetrieving,successCallback:function(c){if(d===b.xhrCount){a.data=c;b._onSuccessLoadFiles(a)}},errorCallback:m.bind(this._onErrorLoadFiles,this)})},_onSuccessLoadFiles:function(a){this.fileListView.resetFileList(a.data.results,
a)},_onErrorLoadFiles:function(){this._showErrorIconInMessageBox()},_showErrorIconInMessageBox:function(){var a=this.messenger.getMessageContainer().find("ul");a.toggleClass("one-message",a.find("li").length===1)},setUploadInProgress:function(a,b){this.eventListener.trigger("file.placeholder.process",a,b)},attachmentUploaded:function(a,b){this.eventListener.trigger("uploadingfile.completed",a,b)},attachmentUploadingCancelled:function(a){this.eventListener.trigger("uploadingfile.cancelled",a)},_hasXhrSupport:function(){var a,
b;try{a=new XMLHttpRequest;b=!(!a.sendAsBinary&&!a.upload)&&!(g.browser.mozilla&&g.browser.version.indexOf("1.9.1")>-1)}catch(c){b=false}return b},addPreviewImage:function(a){var b=require("tinymce");if(f.File&&f.FileReader&&f.FileList&&f.Blob){var c=this,b=b.isIE?1048576:5242880;a.isImage=a.nativeFile&&a.nativeFile.type&&this._isImageType(a.nativeFile.type);if(a.isImage&&a.nativeFile.size<b){var d=new FileReader;d.onload=function(){c._addFilePlaceHolderToCollection(a,d.result)};d.readAsDataURL(a.nativeFile)}else this._addFilePlaceHolderToCollection(a,
null)}},_addFilePlaceHolderToCollection:function(a,b){var c=null,d=this.collection.findWhere({fileName:a.name});if(d){this.collection.removeFile(d);d.get("isFilePlaceHolder")?d.get("previousUploadedFile")&&(c=d.get("previousUploadedFile")):c=d}c=new i({isFilePlaceHolder:true,fileName:a.name,fileId:a.id,fileNative:a.nativeFile,url:b||"",isImage:a.isImage,niceType:a.isImage?"Image":"",fileType:a.nativeFile.type,thumbnailUrl:b||"",previousUploadedFile:c});this.collection.addFile(c)},_isImageType:function(a){return e.Confluence.FileTypesUtils.isImage(a)},
_canAttachFiles:function(){return h.getBoolean("can-attach-files")},_getUrlREST:function(){var a=parseInt(h.get("attachment-source-content-id"),10);return l.CONTEXT_PATH+"/rest/api/content/"+a+"/child/attachment?expand=version,container,space"},focus:function(){this.collection.clearSelection()}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/attachments-panel/attachments-panel-view","Confluence.Editor.FileDialog.AttachmentsPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel.soy' */
// This file was automatically generated from external-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.webPanel = function(opt_data, opt_ignored) {
  return '<div class="insert-web-image"><form id="insert-web-image-form" action="#" class="aui"><fieldset class="inline"><div class="web-image-input"><label for="insert-web-image-image-url" id="insert-web-image-image-url-label">' + soy.$$escapeHtml('\u56fe\u50cfURL:') + '</label><input type="text" class="text image-url" id="insert-web-image-image-url" name="insert-web-image-image-url"></div><input type="submit" class="image-preview aui-button" value="' + soy.$$escapeHtml('\u9884\u89c8') + '"></fieldset></form><p class="faraway image-preview-area"></p><p class="hidden image-preview-error">' + soy.$$escapeHtml('\u56fe\u7247\u4e0d\u80fd\u4e0a\u4f20\u9884\u89c8\uff0c\u8bf7\u68c0\u67e5URL\u3002') + '</p><p class="hidden image-preview-throbber">&nbsp;</p></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.webPanel.soyTemplateName = 'Confluence.Templates.File.webPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel-view.js' */
define("confluence-editor/files/external-panel/external-panel-view",["confluence-editor/files/base-panel/base-panel-view","confluence/templates","jquery","raphael","ajs"],function(c,e,d,f,g){return c.extend({id:"external",panelId:"",cssPanel:".web-image-panel",cssContainer:".insert-web-image",textPanelTitle:"\u56fe\u7247\u6765\u81ea\u7f51\u7edc",template:e.File.searchPanel,events:{"submit form":"_submit","keyup input.image-url":"_checkAllowInsert","click input.image-url":"_checkAllowInsert",
"blur input.image-url":"_checkAllowInsert"},initialize:function(){c.prototype.initialize.call(this);this.context=null;this.token=0},render:function(){this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"web-image-panel");this.container=this.getContainer();this.preview=this.container.find(".image-preview-area");this.throbber=this.container.find(".image-preview-throbber");this.killSpinner=null;this.error=this.container.find(".image-preview-error")},focus:function(){this._getImageInput().focus();
this._checkAllowInsert()},getPanel:function(){this.$el=d(e.File.webPanel());this.el=this.$el[0];this.delegateEvents();return this.el},_getImageInput:function(){return d("input.image-url",this.context.baseElement)},_submit:function(b){b.preventDefault();b.stopPropagation();var a=this,b=this._getImageInput().val();if("http://"===b)return!1;this.token++;var c=this.token;this.preview.addClass("faraway").html("");this.throbber.removeClass("hidden");this.killSpinner||(this.killSpinner=f.spinner(this.throbber[0],
60,"#666"));this.error.addClass("hidden");d("<img>").load(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.preview.removeClass("faraway");a._checkAllowInsert()}}).error(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.error.removeClass("hidden");a._checkAllowInsert()}}).appendTo(this.preview).attr("src",b)},_checkAllowInsert:function(){var b=this.$el.find("input.image-url").val();this.context.setSelectItems(""!==
b&&"http://"!==b?b:[])}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/external-panel/external-panel-view","Confluence.Editor.FileDialog.ExternalPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel.soy' */
// This file was automatically generated from search-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.searchPanel = function(opt_data, opt_ignored) {
  return '<div class="search-panel-wrapper"><div id="search-image"><form class="aui search-form" id="search-image-form" action="#"><fieldset class="inline"><div class="search-input"><label for="search-image" class="assistive">' + soy.$$escapeHtml('\u641c\u7d22') + '</label><input autofocus type="text" class="text search-image-text" size="50" autocomplete="off"></div><select class="search-space select" id="search-image-space-select"><option value="">' + soy.$$escapeHtml('\u5168\u90e8\u7a7a\u95f4') + '</option><option value="' + soy.$$escapeHtml(opt_data.spaceKey) + '">' + soy.$$escapeHtml(opt_data.spaceName) + '</option></select><button type="submit" class="aui-button search-button">' + soy.$$escapeHtml('\u641c\u7d22') + '</button></fieldset></form></div><div id="searched-images" class="scroll-wrapper"><div class="loading-message hidden">' + soy.$$escapeHtml('\u6b63\u5728\u641c\u7d22...') + '</div><ul class="file-list"></ul></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.searchPanel.soyTemplateName = 'Confluence.Templates.File.searchPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel-view.js' */
define("confluence-editor/files/search-panel/search-panel-view","confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-view confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates confluence/meta confluence/defaults confluence/highlighter confluence/api/constants underscore ajs jquery".split(" "),function(n,h,i,d,j,e,k,l,m,f,g,c){return d.extend({id:"search",panelId:"",cssPanel:".search-panel",
cssContainer:"#searched-images",template:j.File.searchPanel,events:{"submit form":"_submit"},initialize:function(){d.prototype.initialize.call(this);this.context=null;this.collection=new i;this.fileListView=new h({collection:this.collection})},getPanel:function(){this.$el=c(this.template({spaceKey:e.get("space-key"),spaceName:e.get("space-name")}));this.el=this.$el[0];this.delegateEvents();return this.el},render:function(){this.fileListView.updateDialogContext(this.context);this.panelId=this.context.addPanel("\u5728\u5176\u4ed6\u9875\u9762\u68c0\u7d22",
this.getPanel(),"search-panel");this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:"\u65e0\u641c\u7d22\u7ed3\u679c\u3002",showContainerInfo:true})},_submit:function(a){a.preventDefault();a.stopPropagation();if(this._getQuery()){this.clearContainer();this.collection.reset();this._loadImages().then(f.bind(this._onSuccessLoadFiles,this),f.bind(this._onErrorLoadFiles,this))}},_loadImages:function(){var a=this.getForm().find(".search-space").val(),b=this._getQuery(),
b='(title ~ "'+b+'*" OR parent.title ~ "'+b+'*") AND type = attachment';a&&a!==""&&(b=b+(" AND space.key = "+a));return c.ajax({type:"GET",dataType:"json",url:m.CONTEXT_PATH+"/rest/api/search",data:{cql:b,expand:"content.version,content.container,content.space",limit:k.maxResults}})},_onSuccessLoadFiles:function(a){a=a.results.map(function(a){return a.content});this.fileListView.highlighter=new l(this._getQuery().split(" "));this.fileListView.resetFileList(a,{shouldClearSelection:true})},_onErrorLoadFiles:function(){var a=
this.getContainer();a.find(".loading-message").addClass("hidden");a.append(c("<p class='warning'>"+c(this.textErrorSearch).text()+"</p>"))},_getSearchText:function(){return c("input.search-image-text",this.getForm())},_getQuery:function(){return this._getSearchText().val()||""},focus:function(){this.collection.clearSelection();this._getSearchText().focus()}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/search-panel/search-panel-view","Confluence.Editor.FileDialog.SearchPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog.soy' */
// This file was automatically generated from file-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.helpLink = function(opt_data, opt_ignored) {
  return '<div class="dialog-help-link"><a href="' + soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-80/Display+Files+and+Images") + '" target="_blank">' + soy.$$escapeHtml('\u5e2e\u52a9') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.helpLink.soyTemplateName = 'Confluence.Templates.File.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog-view.js' */
define("confluence-editor/files/file-dialog/file-dialog-view","backbone ajs confluence/templates underscore jquery document window".split(" "),function(l,f,m,h,e,j,n){function k(a,d){d.forEach(function(b){a.forEach(function(a){a(b)})})}return l.View.extend({dialogId:"insert-image-dialog",ESC_KEY_CODE:27,width:840,height:530,initialize:function(a){this.urlExternalImg="";this.selectItems=[];this.submitCallback=a.submitCallback;this.cancelCallback=a.cancelCallback;var d=a.beforeShowListeners||[],b,c;
if(d&&(!d.subscribe||!d.unsubscribe)){b=d.push;c=[];Object.assign(d,{push:function(){var a=Array.prototype.slice.apply(arguments);b.apply(d,a);k(c,a)},subscribe:function(a){c.push(a);k([a],d)},unsubscribe:function(){c.length=0}})}this.beforeShowListeners=d;this.panelComponents=a.panelComponents},render:function(){this._createDialog();this.clearSelection();e(j).on("keydown.insert-image",h.bind(this._onNavigationByKey,this));return this},_createDialog:function(){var a=new f.Dialog(this.width,this.height,
this.dialogId),d="\u63d2\u5165\u6587\u4ef6\u548c\u56fe\u7247",b="\u63d2\u5165";this.dialog=a;a.addHeader(d);a.addButton(b,h.bind(this._submitDialog,this),"insert");a.addCancel("\u53d6\u6d88",h.bind(this._killDialog,this));this.el=a.popup.element;this.$el=e(this.el);this.baseElement=this.el;this.$el.attr("data-tab-default","0");this.$insertButton=this.$el.find(".dialog-button-panel .insert");e("#"+this.dialogId+" .dialog-components .dialog-title").prepend(m.File.helpLink());
this.$el.find(".dialog-button-panel").append(e("<div></div>").addClass("dialog-tip").html("\u63d0\u793a: \u5728\u7f16\u8f91\u5668\u4e2d\u8f93\u5165 \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 \u5728\u9875\u9762\u4e2d\u63d2\u5165\u56fe\u7247\u3002"));this._createPanels();this.beforeShowListeners.subscribe(function(a){typeof a==="function"&&a()});f.debug(this.beforeShowListeners.length+" beforeShow listeners registered.");e(j).on("hideLayer",h.bind(function(c,b,d){if(!(b!=="popup"||d!==a.popup)){d.remove();this.teardown();typeof this.cancelCallback==="function"&&this.cancelCallback()}},this));f.bind("remove.dialog",
h.bind(function(a,b){b.dialog.id===this.dialog.id&&this.teardown()},this));a.show();return a},_createPanels:function(){var a=this;e.each(this.panelComponents,function(){this&&typeof this.createPanel==="function"&&this.createPanel(a)})},teardown:function(){e(j).unbind(".insert-image");e(".tipsy").remove();this.undelegateEvents();this.beforeShowListeners.unsubscribe()},_killDialog:function(){this.dialog.remove();this.clearSelection();typeof this.cancelCallback==="function"&&this.cancelCallback()},_submitDialog:function(){var a=
{url:this.urlExternalImg,contentId:f.Meta.get("attachment-source-content-id"),selectItems:this.selectItems};this.dialog.remove();typeof this.submitCallback==="function"&&this.submitCallback(a)},setSelectItems:function(a){if(typeof a==="string"){this.urlExternalImg=a;this.selectItems=[]}else{this.urlExternalImg="";this.selectItems=a}a=this.selectItems.length>0||this.urlExternalImg;if(this.$insertButton){this.$insertButton.prop("disabled",!a);this.$insertButton.attr("aria-disabled",!a)}},clearSelection:function(){this.setSelectItems([])},
insert:function(){this.$insertButton&&(!this.$insertButton.is(":disabled")||!this.$insertButton.attr("aria-disabled"))&&this.$insertButton.click()},addPanel:function(a,d,b,c){var e=this.dialog.getPage(0).panel.length;this.dialog.addPanel(a,d,b,c);return e},getPanel:function(a){return this.dialog.getPanel(a)},_onNavigationByKey:function(a){if(!e("#"+this.dialog.id).is(":hidden")){var d=this.dialog.getCurrentPanel().body,b=d.find(".attached-file");if(!(b.length===0||e(j.activeElement).is("input[type=text], select, button"))){var c=
n.tinymce.VK;switch(a.which){case c.LEFT:case c.UP:case c.RIGHT:case c.DOWN:var f=a.which,g;g=b.filter(".current");g.length||(g=b.filter(".selected"));if(g.length){g=b.index(g);var h=b.length,i={};i[c.LEFT]=-1;i[c.RIGHT]=1;i[c.UP]=-4;i[c.DOWN]=4;c=g+(i[f]?i[f]:0);b=b.eq(c<0||c>=h?g:c)}else b=b.first();b.parent().find("li.attached-file.current").removeClass("current");b.addClass("current");b.length&&d.find(".scroll-wrapper").simpleScrollTo(b);a.stopPropagation();return false;case c.SPACEBAR:d.find("li.attached-file.current").click();
a.stopPropagation();return false;case c.ENTER:this.insert();a.stopPropagation();return false}}}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-dialog/file-dialog-view","Confluence.Editor.FileDialog.FileDialogView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:files-upload-analytics', location = 'js/analytics/files-upload-analytics.js' */
define("confluence-drag-and-drop/analytics/files-upload-analytics",["ajs","underscore"],function(d,e){return{triggerEvent:function(b,a,c){a&&a.length&&(a={multiple:1<a.length,number:a.length,isAllImage:void 0===c?this._isAllImages(a):c},d.trigger("analyticsEvent",{name:b,data:a}))},_isAllImages:function(b){return e.every(b,function(a){return a.nativeFile&&a.nativeFile.type&&0===a.nativeFile.type.indexOf("image/")})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:collaborative-helper', location = 'loader/collaborative-helper.js' */
define("confluence-editor/loader/collaborative-helper",["jquery","ajs","confluence/meta","confluence/legacy"],function(g,h,d,i){function b(a){var c=a||{},a=c.id||i.getContentId(),b=c.type||d.get("content-type"),c=c.editMode||d.get("edit-mode");return"collaborative"===c&&("page"===b||"blogpost"===b)&&a&&"0"!==a}var e,f=g.Deferred();return{registerPlugin:function(a){e=a;f.resolve()},isCollaborativeEditingAvailable:b,getEditorContent:function(){return f.pipe(function(){return b()&&"fake"!==d.get("collaborative-editor-status")?
e.getSynchronisedEditorContent():{content:h.Rte.getEditor().getContent()}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_date-time~locale', location = 'date-time~locale.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[8],{149:function(e,a){e.exports=require("confluence/meta")},51:function(e,a,c){"use strict";c.r(a),c.d(a,"getUserLocale",(function(){return s}));var n=c(149),t=c.n(n);const s=()=>t.a.get("user-locale").replace("_","-").match(/^([a-zA-Z]{2,5}(-[a-zA-Z]+)?)/)[0]}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_locale', location = 'locale.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[22],{384:function(e,r,t){"use strict";t.r(r);var n=t(11),o=t(51);function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function c(e,r,t){return(r=function(e){var r=function(e,r){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==typeof r?r:String(r)}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}Object(n.a)("confluence/locale",()=>function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?i(Object(t),!0).forEach((function(r){c(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},o))}},[[384,0,3,2,8]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-editor-plugin:split_core', location = 'core.js' */
(window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff=window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff||[]).push([["core"],[,,,,,,,,,,,,,,function(e,t,n){var o,r=0,a=n(66),i={hmr:!0};i.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(t.locals=a.locals),t.use=t.ref=function(){return r++||(o=n(11)(a,i)),t},t.unuse=t.unref=function(){r>0&&!--r&&(o(),o=null)}},function(e,t){e.exports=require("confluence-macro-browser/macro-browser")},function(e,t){e.exports=require("confluence-editor/i18n/translations.i18n")},,,function(e,t){e.exports=require("confluence/table-color-names")},,function(e,t){e.exports=require("confluence-editor/utils/attachments-insert-utils")},,function(e,t){e.exports=require("confluence-rest/confluence-rest")},function(e,t){e.exports=require("confluence/aui-overrides")},function(e,t){e.exports=require("confluence-drag-and-drop/analytics/files-upload-analytics")},function(e,t){e.exports=require("confluence/form-state-control")},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));class o{constructor(t){var n,o,r;r=void 0,(o="userAgent")in(n=this)?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,this.userAgent=t||e.window.navigator.userAgent}isFirefox(){return-1!==this.userAgent.indexOf("Firefox/")}notFirefox(){return!this.isFirefox()}isMSEdge(){return-1!==this.userAgent.indexOf("Edge/")}notMSEdge(){return!this.isMSEdge()}isIE(){return-1!==this.userAgent.indexOf("MSIE")||-1!==this.userAgent.indexOf("Trident/")||this.isMSEdge()}notIE(){return!this.isIE()}isChrome(){return-1!==this.userAgent.indexOf("Chrome/")}notChrome(){return!this.isChrome()}isSafari(){return-1!==this.userAgent.indexOf("Safari/")&&-1===this.userAgent.indexOf("Chrome/")}notSafari(){return!this.isSafari()}isPhantom(){return-1!==this.userAgent.indexOf("PhantomJS")}notPhantom(){return!this.isPhantom()}version(){if(this.isIE()){var e=this.userAgent.match(/MSIE\s([\d.]+)/)||this.userAgent.match(/rv:([\d.]+)/)||this.userAgent.match(/Edge\/([\d.]+)/);return parseInt(e[1])}return this.isChrome()?parseInt(this.userAgent.match(/Chrome\/([\d.]+)/)[1]):this.isSafari()?parseInt(this.userAgent.match(/Version\/([\d.]+)/)[1]):this.isFirefox()?parseInt(this.userAgent.match(/Firefox\/([\d.]+)/)[1]):0}friendlyName(){return this.isMSEdge()?"MSEdge":this.isIE()?"IE":this.isChrome()?"Chrome":this.isSafari()?"Safari":this.isFirefox()?"Firefox":void 0}}}).call(this,n(18))},function(e,t){e.exports=require("confluence/root")},,function(e,t,n){var o,r=0,a=n(74),i={hmr:!0};i.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(t.locals=a.locals),t.use=t.ref=function(){return r++||(o=n(11)(a,i)),t},t.unuse=t.unref=function(){r>0&&!--r&&(o(),o=null)}},function(e,t,n){var o,r=0,a=n(79),i={hmr:!0};i.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(t.locals=a.locals),t.use=t.ref=function(){return r++||(o=n(11)(a,i)),t},t.unuse=t.unref=function(){r>0&&!--r&&(o(),o=null)}},function(e,t,n){var o,r=0,a=n(82),i={hmr:!0};i.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(t.locals=a.locals),t.use=t.ref=function(){return r++||(o=n(11)(a,i)),t},t.unuse=t.unref=function(){r>0&&!--r&&(o(),o=null)}},function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e.DIALOG_CONTROL="editor.charmap.dialog"}(o||(o={}))},,,function(e,t){e.exports=require("confluence/macro-js-overrides")},function(e,t){e.exports=require("confluence-editor/loader/collaborative-helper")},function(e,t,n){e.exports=n(95)},,,,,,,,,,function(e,t){
/*!
 * Tiny Advanced Tables plugin
 *
 * Copyright 2010-2021 Tiny Technologies, Inc. All rights reserved.
 *
 * Version: 1.1.0-rc
 */
!function(){"use strict";function e(){}function t(e){return function(){return e}}function n(e){return e}function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r=t.concat(n);return e.apply(null,r)}}var r=t(!1),a=t(!0),i=function(){return l},l={fold:function(e,t){return e()},is:r,isSome:r,isNone:a,getOr:d,getOrThunk:s,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:t(null),getOrUndefined:t(void 0),or:d,orThunk:s,map:i,each:e,bind:i,exists:r,forall:a,filter:i,equals:c,equals_:c,toArray:function(){return[]},toString:t("none()")};function c(e){return e.isNone()}function s(e){return e()}function d(e){return e}function u(e){return!(null==e)}function g(e,t){return e=e,t=t,-1<U.call(e,t)}function f(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return!0;return!1}function m(e,t){for(var n=[],o=0;o<e;o++)n.push(t(o));return n}function p(e,t){for(var n=e.length,o=new Array(n),r=0;r<n;r++){var a=e[r];o[r]=t(a,r)}return o}function h(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n],n)}function b(e,t){for(var n=[],o=0,r=e.length;o<r;o++){var a=e[o];t(a,o)&&n.push(a)}return n}function v(e,t){if(0===e.length)return[];for(var n=t(e[0]),o=[],r=[],a=0,i=e.length;a<i;a++){var l=e[a],c=t(l);c!==n&&(o.push(r),r=[]),n=c,r.push(l)}return 0!==r.length&&o.push(r),o}function y(e,t,n){return function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n])}(e,(function(e){n=t(n,e)})),n}function w(e,t,n){return h(e,(function(e){n=t(n,e)})),n}function C(e,t){return function(e,t,n){for(var o=0,r=e.length;o<r;o++){var a=e[o];if(t(a,o))return I.some(a);if(n(a,o))break}return I.none()}(e,t,r)}function A(e,t){return function(e){for(var t=[],n=0,o=e.length;n<o;++n){if(!L(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);_.apply(t,e[n])}return t}(p(e,t))}function x(e,t){for(var n=0,o=e.length;n<o;++n)if(!0!==t(e[n],n))return!1;return!0}function M(e){return[e]}function k(e,t){return(e=F.call(e,0)).sort(t),e}function E(e,t){return 0<=t&&t<e.length?I.some(e[t]):I.none()}function T(e,t){for(var n=0;n<e.length;n++){var o=t(e[n],n);if(o.isSome())return o}return I.none()}var D=function e(n){function o(){return s}function i(e){return e(n)}var c=t(n),s={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:a,isNone:r,getOr:c,getOrThunk:c,getOrDie:c,getOrNull:c,getOrUndefined:c,or:o,orThunk:o,map:function(t){return e(t(n))},each:function(e){e(n)},bind:i,exists:i,forall:i,filter:function(e){return e(n)?s:l},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(r,(function(e){return t(n,e)}))}};return s},I={some:D,none:i,from:function(e){return null==e?l:D(e)}},S=function(e){return function(t){return typeof t===e}},O=function(e){return function(t){return e===t}},j=(Ur=function(e){return function(t){return t=typeof(n=t),(null===n?"null":"object"==t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t)===e;var n}})("string"),N=Ur("object"),L=Ur("array"),B=O(null),P=S("boolean"),R=O(void 0),H=S("function"),z=S("number"),F=Array.prototype.slice,U=Array.prototype.indexOf,_=Array.prototype.push,W=function(){return(W=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function Q(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var a=arguments[t],i=0,l=a.length;i<l;i++,r++)o[r]=a[i];return o}function V(e,t){var n=String(t).toLowerCase();return C(e,(function(e){return e.search(n)}))}function $(e,t){return-1!==e.indexOf(t)}function K(e){return window.matchMedia(e).matches}function G(e,t){if(1!==(e=e.dom).nodeType)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}function Y(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount}function J(e,t){return e.dom===t.dom}function q(e,t){for(var n=_e(e),o=0,r=n.length;o<r;o++){var a=n[o];t(e[a],a)}}function Z(e,t){var n=[];return q(e,(function(e,o){n.push(t(e,o))})),n}function X(e,t){return Qe(e,t)?I.from(e[t]):I.none()}function ee(e,t,n){return{element:e,rowspan:t,colspan:n}}function te(e,t,n){return{element:e,cells:t,section:n}}function ne(e,t,n){return{element:e,isNew:t,isLocked:n}}function oe(e,t){return{cells:e,section:t}}function re(e){return e.dom.nodeName.toLowerCase()}function ae(e){return e.dom.nodeType}function ie(e){return Fe.fromDom(e.dom.ownerDocument)}function le(e){return Ge(e)?e:ie(e)}function ce(e){return I.from(e.dom.parentNode).map(Fe.fromDom)}function se(e,t){for(var n=H(t)?t:r,o=e.dom,a=[];null!==o.parentNode&&void 0!==o.parentNode;){var i=o.parentNode,l=Fe.fromDom(i);if(a.push(l),!0===n(l))break;o=i}return a}function de(e){return I.from(e.dom.nextSibling).map(Fe.fromDom)}function ue(e){return p(e.dom.childNodes,Fe.fromDom)}function ge(e){return Fe.fromDom(e.dom.host)}function fe(e,t){return n=function(e){return G(e,t)},b(ue(e),n);var n}function me(e,t){return function(e,t){return Y(t=void 0===t?document:t.dom)?[]:p(t.querySelectorAll(e),Fe.fromDom)}(t,e)}var pe,he,be,ve,ye=function(){return we(0,0)},we=function(e,t){return{major:e,minor:t}},Ce=function(e,t){return t=String(t).toLowerCase(),0===e.length?ye():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(o.test(t))return o}}(e,t);return n?we((e=function(e){return Number(t.replace(n,"$"+e))})(1),e(2)):{major:0,minor:0}}(e,t)},Ae=ye,xe=(pe=/^\s+|\s+$/g,function(e){return e.replace(pe,"")}),Me=(O=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return $(e,"edge/")&&$(e,"chrome")&&$(e,"safari")&&$(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,i=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/],search:function(e){return $(e,"chrome")&&!$(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return $(e,"msie")||$(e,"trident")}},{name:"Opera",versionRegexes:[i,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:(Ur=function(e){return function(t){return $(t,e)}})("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ur("firefox")},{name:"Safari",versionRegexes:[i,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return($(e,"safari")||$(e,"mobile/"))&&$(e,"applewebkit")}}],S=[{name:"Windows",search:Ur("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return $(e,"iphone")||$(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ur("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ur("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ur("linux"),versionRegexes:[]},{name:"Solaris",search:Ur("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ur("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Ur("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],{browsers:t(O),oses:t(S)}),ke="Firefox",Ee=function(e){var t=e.current,n=e.version;return{current:t,version:n,isEdge:(e=function(e){return function(){return t===e}})("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(ke),isSafari:e("Safari")}},Te=function(){return Ee({current:void 0,version:Ae()})},De=Ee,Ie=(t("Edge"),t("Chrome"),t("IE"),t("Opera"),t(ke),t("Safari"),"Windows"),Se="Android",Oe="Solaris",je="FreeBSD",Ne="ChromeOS",Le=function(e){var t=e.current,n=e.version;return{current:t,version:n,isWindows:(e=function(e){return function(){return t===e}})(Ie),isiOS:e("iOS"),isAndroid:e(Se),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(Oe),isFreeBSD:e(je),isChromeOS:e(Ne)}},Be=function(){return Le({current:void 0,version:Ae()})},Pe=Le,Re=(t(Ie),t("iOS"),t(Se),t("Linux"),t("OSX"),t(Oe),t(je),t(Ne),function(e,n){var o,r,a=Me.browsers(),i=Me.oses(),l=function(e,t){return V(e,t).map((function(e){var n=Ce(e.versionRegexes,t);return{current:e.name,version:n}}))}(a,e).fold(Te,De),c=function(e,t){return V(e,t).map((function(e){var n=Ce(e.versionRegexes,t);return{current:e.name,version:n}}))}(i,e).fold(Be,Pe);return{browser:l,os:c,deviceType:(o=l,r=e,a=n,l=(i=c).isiOS()&&!0===/ipad/i.test(r),e=i.isiOS()&&!l,n=i.isiOS()||i.isAndroid(),c=n||a("(pointer:coarse)"),a=l||!e&&n&&a("(min-device-width:768px)"),n=e||n&&!a,r=o.isSafari()&&i.isiOS()&&!1===/safari/i.test(r),{isiPad:t(l),isiPhone:t(e),isTablet:t(a),isPhone:t(n),isTouch:t(c),isAndroid:i.isAndroid,isiOS:i.isiOS,isWebView:t(r),isDesktop:t(!n&&!a&&!r)})}}),He=(ve=!(he=function(){return Re(navigator.userAgent,K)}),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ve||(ve=!0,be=he.apply(null,e)),be}),ze=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},Fe={fromHtml:function(e,t){if((t=(t||document).createElement("div")).innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return ze(t.childNodes[0])},fromTag:function(e,t){return e=(t||document).createElement(e),ze(e)},fromText:function(e,t){return e=(t||document).createTextNode(e),ze(e)},fromDom:ze,fromPoint:function(e,t,n){return I.from(e.dom.elementFromPoint(t,n)).map(ze)}},Ue=G,_e=Object.keys,We=Object.hasOwnProperty,Qe=function(e,t){return We.call(e,t)},Ve=["tfoot","thead","tbody","colgroup"],$e=(i=("undefined"!=typeof window||Function("return this;")(),function(e){return function(t){return ae(t)===e}}))(1),Ke=i(3),Ge=i(9),Ye=i(11),Je=H(Element.prototype.attachShadow)&&H(Node.prototype.getRootNode)?function(e){return Fe.fromDom(e.dom.getRootNode())}:le,qe=function e(t){var n=Ke(t)?t.dom.parentNode:t.dom;if(null==n||null===n.ownerDocument)return!1;var o,r,a=n.ownerDocument;return function(e){var t=Je(e);return Ye(e=t)&&u(e.dom.host)?I.some(t):I.none()}(Fe.fromDom(n)).fold((function(){return a.body.contains(n)}),(o=e,r=ge,function(e){return o(r(e))}))};function Ze(e,t,n){for(var o=e.dom,a=H(n)?n:r;o.parentNode;){o=o.parentNode;var i=Fe.fromDom(o);if(t(i))return I.some(i);if(a(i))break}return I.none()}function Xe(e,t,n){return Ze(e,(function(e){return G(e,t)}),n)}function et(e,t){return n=function(e){return G(e,t)},C(e.dom.childNodes,(function(e){return n(Fe.fromDom(e))})).map(Fe.fromDom);var n}function tt(e,t){return function(e,t){return Y(t=void 0===t?document:t.dom)?I.none():I.from(t.querySelector(e)).map(Fe.fromDom)}(t,e)}function nt(e,t,n){var o;return o=Xe,n=n,G(e=e,t=t)?I.some(e):H(n)&&n(e)?I.none():o(e,t,n)}function ot(e,t,n){if(!(j(n)||P(n)||z(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}function rt(e,t,n){ot(e.dom,t,n)}function at(e,t){var n=e.dom;q(t,(function(e,t){ot(n,t,e)}))}function it(e,t){return null===(t=e.dom.getAttribute(t))?void 0:t}function lt(e,t){return I.from(it(e,t))}function ct(e,t){e.dom.removeAttribute(t)}function st(e){return w(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})}function dt(e){return void 0!==e.style&&H(e.style.getPropertyValue)}function ut(e,t,n){if(!j(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);dt(e)&&e.style.setProperty(t,n)}function gt(e,t,n){ut(e=e.dom,t,n)}function ft(e,t){var n=e.dom;q(t,(function(e,t){ut(n,t,e)}))}function mt(e,t){var n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return""!==o||qe(e)?o:Ut(n,t)}function pt(e,t){return e=e.dom,t=Ut(e,t),I.from(t).filter((function(e){return 0<e.length}))}function ht(e,t){var n=e.dom;t=t,dt(n=n)&&n.style.removeProperty(t),lt(e,"style").map(xe).is("")&&ct(e,"style")}function bt(e,t,n){return void 0===n&&(n=0),lt(e,t).map((function(e){return parseInt(e,10)})).getOr(n)}function vt(e,t){return bt(e,t,1)}function yt(e){return 1<vt(e,"colspan")}function wt(e,t){return Wt(e,t,a)}function Ct(e,t){return function(e,t,n){return(n=void 0===n?r:n)(t)?I.none():g(e,re(t))?I.some(t):Xe(t,e.join(","),(function(e){return G(e,"table")||n(e)}))}(["td","th"],e,t)}function At(e){return wt(e,"th,td")}function xt(e){return G(e,"colgroup")?fe(e,"col"):A(Qt(e),(function(e){return fe(e,"col")}))}function Mt(e,t){return nt(e,"table",t)}function kt(e){return ce(e).map((function(e){return e=re(e),g(Ve,e)?e:"tbody"})).getOr("tbody")}function Et(e,t){return e.cells[t]}function Tt(e,t){return Et(e,t).element}function Dt(e){return{rows:(e=function(e,t){for(var n=[],o=[],r=0,a=e.length;r<a;r++){var i=e[r];(t(i)?n:o).push(i)}return{pass:n,fail:o}}(e,(function(e){return"colgroup"===e.section}))).fail,cols:e.pass}}function It(e){return lt(e,$t).bind((function(e){return I.from(e.match(/\d+/g))})).map((function(e){return function(e,t){for(var n={},o=0,r=e.length;o<r;o++){var a=e[o];n[String(a)]=t(a,o)}return n}(e,a)}))}function St(e){var t={},n=[],o={},r=E(e,0).map((function(e){return e.element})).bind(Mt).bind(It).getOr({}),a=0,i=0,l=0;return h(e,(function(e){var c,s,d;"colgroup"===e.section?(s={},d=0,h(e.cells,(function(e){var t=e.colspan;m(t,(function(n){s[n=d+n]={element:e.element,colspan:t,column:n}})),d+=t})),o=s):(c=[],h(e.cells,(function(e){for(var n=0;void 0!==t[l+","+n];)n++;for(var o,a=(o=r,a=n.toString(),Qe(o,a)&&void 0!==o[a]&&null!==o[a]),s={element:e.element,rowspan:e.rowspan,colspan:e.colspan,row:l,column:n,isLocked:a},d=0;d<e.colspan;d++)for(var u=0;u<e.rowspan;u++){var g=n+d;t[l+u+","+g]=s,i=Math.max(i,g+1)}c.push(s)})),a++,n.push(te(e.element,c,e.section)),l++)})),{grid:{rows:a,columns:i},access:t,all:n,columns:o}}function Ot(e,t){return t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow}function jt(e,t,n){return function(e,t,n){t=Gt.findItem(e,t,J);var o=Gt.findItem(e,n,J);return t.bind((function(e){return o.map((function(t){return n=e,t=t,{startRow:Math.min(n.row,t.row),startCol:Math.min(n.column,t.column),finishRow:Math.max(n.row+n.rowspan-1,t.row+t.rowspan-1),finishCol:Math.max(n.column+n.colspan-1,t.column+t.colspan-1)};var n}))}))}(e,t,n).bind((function(t){return function(e,t){for(var n=!0,r=o(Ot,t),a=t.startRow;a<=t.finishRow;a++)for(var i=t.startCol;i<=t.finishCol;i++)n=n&&Gt.getAt(e,a,i).exists(r);return n?I.some(t):I.none()}(e,t)}))}function Nt(e,t,n){return jt(e=Yt(e),t,n)}function Lt(e,t){ce(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))}function Bt(e,t){de(e).fold((function(){ce(e).each((function(e){Jt(e,t)}))}),(function(e){Lt(e,t)}))}function Pt(e,t){(function(e){return function(e,t){return e=e.dom.childNodes,I.from(e[0]).map(Fe.fromDom)}(e)})(e).fold((function(){Jt(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))}function Rt(e,t){h(t,(function(t){Jt(e,t)}))}function Ht(e){e.dom.textContent="",h(ue(e),(function(e){qt(e)}))}var zt,Ft,Ut=function(e,t){return dt(e)?e.style.getPropertyValue(t):""},_t=t(10),Wt=function e(t,n,o){return A(ue(t),(function(t){return G(t,n)?o(t)?[t]:[]:e(t,n,o)}))},Qt=function(e){return Mt(e).fold(t([]),(function(e){return fe(e,"colgroup")}))},Vt=function(e,t){return oe(t,e.section)},$t="data-snooker-locked-cols",Kt=function(e,t){return b(e=A(e.all,(function(e){return e.cells})),t)},Gt={fromTable:function(e){return St(e=function(e){var t,n=wt(e,"tr");return n=Q(Qt(e),n),t=kt,p(n,(function(e){if("colgroup"===re(e)){var n=p(xt(e),(function(e){return ee(e,1,bt(e,"span",1))}));return te(e,n,"colgroup")}return te(e,n=p(At(e),(function(e){return ee(e,bt(e,"rowspan",1),bt(e,"colspan",1))})),t(e))}))}(e))},generate:St,getAt:function(e,t,n){return void 0!==(n=e.access[t+","+n])?I.some(n):I.none()},findItem:function(e,t,n){return 0<(e=Kt(e,(function(e){return n(t,e.element)}))).length?I.some(e[0]):I.none()},filterItems:Kt,justCells:function(e){return A(e.all,(function(e){return e.cells}))},justColumns:function(e){return Z(e=e.columns,(function(e){return e}))},hasColumns:function(e){return 0<_e(e.columns).length},getColumnAt:function(e,t){return I.from(e.columns[t])}},Yt=Gt.fromTable,Jt=function(e,t){e.dom.appendChild(t.dom)},qt=function(e){null!==(e=e.dom).parentNode&&e.parentNode.removeChild(e)},Zt=(zt=Ke,"text",{get:function(e){if(!zt(e))throw new Error("Can only get text value of a text node");return Ft(e).getOr("")},getOption:Ft=function(e){return zt(e)?I.from(e.dom.nodeValue):I.none()},set:function(e,t){if(!zt(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=t}}),Xt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function en(e){return Xe(e,"table")}function tn(e,t){return 0<(t=me(e,t)).length?I.some(t):I.none()}function nn(e,t,n){return function(e,t,n){return tt(e,t).bind((function(t){return tt(e,n).bind((function(e){return n=en,Mn(kn,(function(e,t){return n(t)}),[t,e]).map((function(n){return{first:t,last:e,table:n}}));var n}))}))}(e,t,n).bind((function(t){function n(t){return J(e,t)}var o="thead,tfoot,tbody,table",r=Xe(t.first,o,n),a=Xe(t.last,o,n);return r.bind((function(e){return a.bind((function(n){return J(e,n)?Nt(t.table,t.first,t.last):I.none()}))}))}))}function on(e,t,n,o){return e.fold(t,n,o)}function rn(e){return parseInt(e,10)}function an(e,t){return 0==(t=e-t)?0:0<t?1:-1}function ln(e,t,n){return{major:e,minor:t,patch:n}}function cn(e){return(e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(e))?ln(rn(e[1]),rn(e[2]),rn(e[3])):ln(0,0,0)}function sn(e,t){return!!e&&-1===function(e,t){var n=an(e.major,t.major);return 0!==n||0!==(n=an(e.minor,t.minor))?n:0!==(t=an(e.patch,t.patch))?t:0}(cn([(e=e=e).majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join(".")),cn(t))}function dn(e,t){return void 0===(t=it(e,t))||""===t?[]:t.split(" ")}function un(e){return void 0!==e.dom.classList}function gn(e){return dn(e,"class")}function fn(e,t){un(e)?e.dom.classList.add(t):function(e,t){(function(e,t,n){rt(e,t,(n=dn(e,t).concat([n])).join(" "))})(e,"class",t)}(e,t)}function mn(e){return(un(e)?function(e){for(var t=e.dom.classList,n=new Array(t.length),o=0;o<t.length;o++){var r=t.item(o);null!==r&&(n[o]=r)}return n}:gn)(e)}function pn(e,t,n){return e.isSome()&&t.isSome()?I.some(n(e.getOrDie(),t.getOrDie())):I.none()}function hn(e){return Fe.fromDom(e.getBody())}function bn(e){function t(e){return ct(e,"data-mce-style")}ct(e,"data-mce-style"),h(At(e),t),h(xt(e),t)}function vn(e){return on(e.get(),t([]),n,M)}function yn(e){function t(e,t){return lt(e,t).exists((function(e){return 1<parseInt(e,10)}))}return 0<(e=vn(e)).length&&x(e,(function(e){return t(e,"rowspan")||t(e,"colspan")}))?I.some(e):I.none()}function wn(e,t,n){return{element:n,mergable:(o=t,r=jn,on(e.get(),I.none,(function(e){return e.length<=1?I.none():nn(o,r.firstSelectedSelector,r.lastSelectedSelector).map((function(t){return{bounds:t,cells:e}}))}),I.none)),unmergable:yn(e),selection:vn(e)};var o,r}function Cn(e){return{element:e,mergable:I.none(),unmergable:I.none(),selection:[e]}}function An(e,t){var n;return Mt(e,t=(n=t,function(e){return J(e,hn(n))}))}var xn=function(e,t,n){return t.bind((function(t){return n.filter(o(e.eq,t))}))},Mn=function(e,t,n){return 0<n.length?function(e,t,n,o){return y(o,(function(n,o){return o=t(e,o),xn(e,n,o)}),n=t(e,n))}(e,t,(n=n)[0],n.slice(1)):I.none()},kn={up:t({selector:Xe,closest:nt,predicate:Ze,all:se}),down:t({selector:me,predicate:function e(t,n){var o=[];return h(ue(t),(function(t){o=(o=n(t)?o.concat([t]):o).concat(e(t,n))})),o}}),styles:t({get:mt,getRaw:pt,set:gt,remove:ht}),attrs:t({get:it,set:rt,remove:ct,copyTo:function(e,t){at(t,e=st(e))}}),insert:t({before:Lt,after:Bt,afterAll:function(e,t){h(t,(function(n,o){Bt(o=0===o?e:t[o-1],n)}))},append:Jt,appendAll:Rt,prepend:Pt,wrap:function(e,t){Lt(e,t),Jt(t,e)}}),remove:t({unwrap:function(e){var t,n=ue(e);0<n.length&&(t=e,h(n,(function(e){Lt(t,e)}))),qt(e)},remove:qt}),create:t({nu:Fe.fromTag,clone:function(e){return Fe.fromDom(e.dom.cloneNode(!1))},text:Fe.fromText}),query:t({comparePosition:function(e,t){return e.dom.compareDocumentPosition(t.dom)},prevSibling:function(e){return I.from(e.dom.previousSibling).map(Fe.fromDom)},nextSibling:de}),property:t({children:ue,name:re,parent:ce,document:function(e){return le(e).dom},isText:Ke,isComment:function(e){return 8===ae(e)||"#comment"===re(e)},isElement:$e,isSpecial:function(e){return g(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],e=re(e))},getText:function(e){return Zt.get(e)},setText:function(e,t){return Zt.set(e,t)},isBoundary:function(e){return!!$e(e)&&("body"===re(e)||g(Xt,re(e)))},isEmptyTag:function(e){return!!$e(e)&&g(["br","img","hr","input"],re(e))},isNonEditable:function(e){return $e(e)&&"false"===it(e,"contenteditable")}}),eq:J,is:Ue},En=(O=(Ur=function(e){if(!L(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return h(e,(function(o,r){var a=_e(o);if(1!==a.length)throw new Error("one and only one name per case");var i=a[0],l=o[i];if(void 0!==n[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!L(l))throw new Error("case arguments must be an array");t.push(i),n[i]=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var a=n.length;if(a!==l.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+l.length+" ("+l+"), got "+a);return{fold:function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[r].apply(null,n)},match:function(e){var o=_e(e);if(t.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+o.join(","));if(!x(t,(function(e){return g(o,e)})))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+t.join(", "));return e[i].apply(null,n)},log:function(e){console.log(e,{constructors:t,constructor:i,params:n})}}}})),n})([{none:[]},{multiple:["elements"]},{single:["element"]}])).none,Tn=O.multiple,Dn=O.single,In=function(e,t,n){function o(t){ct(t,e.selected),ct(t,e.firstSelected),ct(t,e.lastSelected)}function r(t){rt(t,e.selected,"1")}function a(e){i(e),n()}var i=function(t){h(t=me(t,e.selectedSelector),o)};return{clearBeforeUpdate:i,clear:a,selectRange:function(n,o,i,l){a(n),h(o,r),rt(i,e.firstSelected,"1"),rt(l,e.lastSelected,"1"),t(o,i,l)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},Sn={structure:!1,style:!0},On={structure:!0,style:!1},jn={selected:S="data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:i="data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:O="data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Nn=(i=function(e){return function(t){var n,o=Fe.fromDom(t.selection.getStart());return nt(o="col"===(t=re(o))||"colgroup"===t?Mt(n=o).bind((function(e){return tn(e,jn.firstSelectedSelector)})).fold((function(){return n}),(function(e){return e[0]})):o,e)}})("th,td"),Ln=i("th,td,caption"),Bn={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},Pn=(i=["Infinity",(O="[0-9]+")+"\\."+Rn(O)+Rn(i="[eE][+-]?[0-9]+"),"\\."+O+Rn(i),O+Rn(i)].join("|"),new RegExp("^([+-]?(?:"+i+"))(.*)$"));function Rn(e){return"(?:"+e+")?"}function Hn(e,t){return I.from(Pn.exec(e)).bind((function(e){var n,o=Number(e[1]);e=e[2];return n=e,f(t,(function(e){return f(Bn[e],(function(e){return n===e}))}))?I.some({value:o,unit:e}):I.none()}))}function zn(e){return vr.getOuter(e)}function Fn(e){return yr.get(e)}function Un(e){return yr.getOuter(e)}function _n(e,t,n){return function(e,t){return e=parseFloat(e),isNaN(e)?t:e}(mt(e,t),n)}function Wn(e){return function(){var e=He().browser;return e.isIE()||e.isEdge()}()?(n=(t=e).dom.getBoundingClientRect().width,"border-box"===mt(t,"box-sizing")?n:n-_n(t,"padding-left",0)-_n(t,"padding-right",0)-(_n(t,"border-left-width",0)+_n(t,"border-right-width",0))):_n(e,"width",Fn(e));var t,n}function Qn(e,t){gt(e,"width",t+"px")}function Vn(e,t){gt(e,"width",t+"%")}function $n(e){return pt(e,"width").fold((function(){return I.from(it(e,"width"))}),(function(e){return I.some(e)}))}function Kn(e,t){return e/t.pixelWidth()*100}function Gn(e,t){return $n(e).fold((function(){return Kn(Fn(e),t)}),(function(n){return function(e,t,n){return null!==(t=wr.exec(t))?parseFloat(t[1]):Kn(e=Wn(e),n)}(e,n,t)}))}function Yn(e,t){return $n(e).fold((function(){return Wn(e)}),(function(n){return function(e,t,n){var o=Cr.exec(t);return null!==o?parseInt(o[1],10):null===(t=wr.exec(t))?Wn(e):parseFloat(t[1])/100*n.pixelWidth()}(e,n,t)}))}function Jn(e,t,n){gt(e,"width",t+n)}function qn(e,t){1===vt(e,"colspan")&&$n(e).bind((function(e){return Hn(e,["fixed","relative","empty"])})).each((function(n){var o=n.value/2;Jn(e,o,n.unit),Jn(t,o,n.unit)}))}function Zn(e){var t=e;return{get:function(){return t},set:function(e){t=e}}}function Xn(e){return{element:e,colspan:bt(e,"colspan",1),rowspan:bt(e,"rowspan",1)}}function eo(e){return p(e,t(0))}function to(){function e(e,t,n,o,r){return o=Er(e,0<=o?n:t,o,r),r=t,t=n+1,n=[o,-o],(o=eo)((e=e).slice(0,r)).concat(n).concat(o(e.slice(t)))}return{resizeTable:function(e,t,n){n&&e(t)},clampTableDelta:function(e,t,n,o,r){return r?0<=n?n:(r=w(e,(function(e,t){return e+t-o}),0),Math.max(-r,n)):kr(e,t,n,o)},calcLeftEdgeDeltas:e,calcMiddleDeltas:function(t,n,o,r,a,i){return e(t,o,r,a,i)},calcRightEdgeDeltas:function(e,n,o,r,a,i){return i?eo(e):p(e,t(r/=e.length))},calcRedestributedWidths:function(e,t,n,o){return{delta:0,newSizes:e}}}}function no(e,t){void 0===t&&(t=a);var o=e.grid,r=m(o.columns,n),i=m(o.rows,n);return p(r,(function(n){return Tr((function(){return A(i,(function(t){return Gt.getAt(e,t,n).filter((function(e){return e.column===n})).toArray()}))}),(function(e){return 1===e.colspan&&t(e.element)}),(function(){return Gt.getAt(e,0,n)}))}))}function oo(e,t){return void 0!==e?e:void 0!==t?t:0}function ro(e){var t=(a=e.dom.ownerDocument).body,n=a.defaultView,o=a.documentElement;if(t===e.dom)return Dr(t.offsetLeft,t.offsetTop);var r=oo(null==n?void 0:n.pageYOffset,o.scrollTop),a=oo(null==n?void 0:n.pageXOffset,o.scrollLeft);n=oo(o.clientTop,t.clientTop),t=oo(o.clientLeft,t.clientLeft);return Ir(e).translate(a-t,r-n)}function ao(e,t){return{row:e,y:t}}function io(e,t){return{col:e,x:t}}function lo(e){return ro(e).left+Un(e)}function co(e){return ro(e).left}function so(e,t){return io(e,co(t))}function uo(e,t){return io(e,lo(t))}function go(e){return ro(e).top}function fo(e,t){return ao(e,go(t))}function mo(e,t){return ao(e,go(t)+zn(t))}function po(e,t,n){if(0===n.length)return[];var o=p(n.slice(1),(function(t,n){return t.map((function(t){return e(n,t)}))})),r=n[n.length-1].map((function(e){return t(n.length-1,e)}));return o.concat([r])}function ho(e,t){return pt(e,t).isSome()}function bo(e,t,n,o,r,a){return e.filter(o).fold((function(){return a(function(e,t){if(t<0||t>=e.length-1)return I.none();var n=e[t].fold((function(){return T(function(e){return(e=F.call(e,0)).reverse(),e}(e.slice(0,t)),(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return I.some({value:e,delta:0})})),o=e[t+1].fold((function(){return T(e.slice(t+1),(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return I.some({value:e,delta:1})}));return n.bind((function(e){return o.map((function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n}))}))}(n,t))}),(function(e){return r(e)}))}function vo(e,t,o,r,a){var i,l=no(e,(function(e){return ho(e,"width")})),c=Gt.hasColumns(e)?(c=e,p(Gt.justColumns(c),(function(e){return I.from(e.element)}))):l,s=[I.some(Nr(t))].concat(p(jr(l,t),(function(e){return e.map((function(e){return e.x}))}))),d=(i=yt,function(e){return!i(e)});return p(c,(function(e,t){return bo(e,t,s,d,(function(e){return!Lr(i=e)||ho(i,"width")?o(e,a):bo(i=(e=n,null!=(i=l[t])?e(i):I.none()),t,s,d,(function(e){return r(I.some(Fn(e)))}),r);var i}),r)}))}function yo(e,t,n){return vo(e,t,Yn,(function(e){return e.getOrThunk(n.minCellWidth)}),n)}function wo(e,t){var o=Zn(e),r=o.get;return{width:r,pixelWidth:r,getWidths:function(e,n){return yo(e,t,n)},getCellDelta:n,singleColumnWidth:function(e,t){return[Math.max(_t(),e+t)-e]},minCellWidth:_t,setElementWidth:Qn,adjustTableWidth:function(e){e=r()+e,Qn(t,e),o.set(e)},isRelative:!1,label:"pixel"}}function Co(e,t){return Fe.fromDom(e.dom.cloneNode(t))}function Ao(e,t,n,o){n===o?ct(e,t):rt(e,t,n)}function xo(e,t,n){E(t=fe(e,t),t.length-1).fold((function(){return Pt(e,n)}),(function(e){return Bt(e,n)}))}function Mo(e,t){function n(e){return p(e,(function(e){e.isNew&&i.push(e.element);var t=e.element;return Ht(t),h(e.cells,(function(e){e.isNew&&l.push(e.element),Ao(e.element,"colspan",e.colspan,1),Ao(e.element,"rowspan",e.rowspan,1),Jt(t,e.element)})),t}))}function o(e){return A(e,(function(e){return p(e.cells,(function(e){return Ao(e.element,"span",e.colspan,1),e.element}))}))}function r(t,r){var a,i,l=(Ht(l=et(a=e,i=r).getOrThunk((function(){var e=Fe.fromTag(i,ie(a).dom);return"thead"===i?xo(a,"caption,colgroup",e):"colgroup"===i?xo(a,"caption",e):Jt(a,e),e}))),l);Rt(l,t=("colgroup"===r?o:n)(t))}function a(t,n){0<t.length?r(t,n):et(e,n).each(qt)}var i=[],l=[],c=[],s=[],d=[],u=[];return h(t,(function(e){switch(e.section){case"thead":c.push(e);break;case"tbody":s.push(e);break;case"tfoot":d.push(e);break;case"colgroup":u.push(e)}})),a(u,"colgroup"),a(c,"thead"),a(s,"tbody"),a(d,"tfoot"),{newRows:i,newCells:l}}function ko(e,t,n){var o=e.origin();h(t,(function(t){t.each((function(t){fn(t=n(o,t),Pr),Jt(e.parent(),t)}))}))}function Eo(e,t,n,o,r){var a,i=ro(n),l=t.isResizable,c=0<(o=0<o.length?Sr(o,n):[]).length?(a=l,A(e.all,(function(e,t){return a(e.element)?[t]:[]}))):[];!function(e,t,n,o){ko(e,t,(function(e,t){var r,a,i,l;return fn(e=(r=t.row,a=n.left-e.left,i=t.y-e.top,l=o,t=7,ft(e=Fe.fromTag("div"),{position:"absolute",left:a+"px",top:i-t/2+"px",height:t+"px",width:l+"px"}),at(e,{"data-row":r,role:"presentation"}),e),Rr),e}))}(t,o=b(o,(function(e,t){return f(c,(function(e){return t===e}))})),i,Un(n));var s,d,u,g=0<(r=0<r.length?jr(r,n):[]).length?(d=l,u=[],m((s=e).grid.columns,(function(e){Gt.getColumnAt(s,e).map((function(e){return e.element})).forall(d)&&u.push(e)})),b(u,(function(e){return x(Gt.filterItems(s,(function(t){return t.column===e})),(function(e){return d(e.element)}))}))):[];!function(e,t,n,o){ko(e,t,(function(e,t){var r,a,i;return fn(e=(r=t.col,a=t.x-e.left,i=n.top-e.top,7,t=o,ft(e=Fe.fromTag("div"),{position:"absolute",left:a-3.5+"px",top:i+"px",height:t+"px",width:"7px"}),at(e,{"data-column":r,role:"presentation"}),e),Hr),e}))}(t,r=b(r,(function(e,t){return f(g,(function(e){return t===e}))})),i,zn(n))}function To(e,t){if(0===e.length)return 0;var n=e[0];return function(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n]))return I.some(n);return I.none()}(e,(function(e){return!t(n.element,e.element)})).fold((function(){return e.length}),(function(e){return e}))}function Do(e,t){var n=p(e,(function(e){return p(e.cells,r)}));return p(e,(function(o,r){return{details:A(o.cells,(function(o,a){if(!1!==n[r][a])return[];var i=function(e,t,n,o){var r;return{colspan:To(e[t].cells.slice(n),o),rowspan:To(t=(r=n,p(e,(function(e){return Et(e,r)})).slice(t)),o)}}(e,r,a,t);return function(e,t,o,r){for(var a=e;a<e+o;a++)for(var i=t;i<t+r;i++)n[a][i]=!0}(r,a,i.rowspan,i.colspan),[{element:o.element,rowspan:i.rowspan,colspan:i.colspan,isNew:o.isNew}]})),section:o.section}}))}function Io(e,t){return p(e,(function(e){var n;return{element:(n=T(n=e.details,(function(e){return ce(e.element).map((function(e){return ne(e,ce(e).isNone(),!1)}))})).getOrThunk((function(){return ne(t.row(),!0,!1)}))).element,cells:e.details,section:e.section,isNew:n.isNew}}))}function So(e,t){return T(e.all,(function(e){return C(e.cells,(function(e){return J(t,e.element)}))}))}function Oo(e,t,n){var o=p(t.selection,(function(t){return Ct(t).bind((function(t){return So(e,t)})).filter(n)}));t=function(e){for(var t=[],n=function(e){t.push(e)},o=0;o<e.length;o++)e[o].each(n);return t}(o);return o=0<t.length,t=t,o?I.some(t):I.none()}function jo(e,o,r,a,i){return function(l,c,s,d,u,g){var f=Gt.fromTable(c);return o(f,s).map((function(t){var n=function(e,t){return function(e,t,n){var o,r=[];Gt.hasColumns(e)&&(o=p(Gt.justColumns(e),(function(e){return ne(e.element,!1,!1)})),r.push(oe(o,"colgroup")));for(var a=0;a<e.grid.rows;a++){for(var i=[],l=0;l<e.grid.columns;l++){var c=Gt.getAt(e,a,l).map((function(e){return ne(e.element,!1,e.isLocked)})).getOrThunk((function(){return ne(t.gap(),!0,!1)}));i.push(c)}var s=oe(i,e.all[a].section);r.push(s)}return r}(e,t)}(f,d),o=e(n,t,J,i(d));n=function(e){return k(e=Z(e=w(Dt(e).rows,(function(e,t){return h(t.cells,(function(t,n){t.isLocked&&(e[n]=!0)})),e}),{}),(function(e,t){return parseInt(t,10)})))}(o.grid);return{info:t,grid:function(e,t){return Io(e=Do(e,J),t)}(o.grid,d),cursor:o.cursor,lockedColumns:n}})).bind((function(e){var o=Mo(c,e.grid),i=I.from(u).getOrThunk((function(){return Br(c)})),s=I.from(g).getOrThunk(to);return r(c,e.grid,e.info,i,s),a(c),function(e,o){var r,a,i,l,c;!function(e){h(e=me(e.parent(),"."+Pr),qt)}(e),e.isResizable(o)&&(r=Gt.fromTable(o),l=m((i=(a=r).grid).rows,n),c=m(i.columns,n),Eo(r,e,o,i=p(l,(function(e){return Tr((function(){return A(c,(function(n){return Gt.getAt(a,e,n).filter((function(t){return t.row===e})).fold(t([]),(function(e){return[e]}))}))}),(function(e){return 1===e.rowspan}),(function(){return Gt.getAt(a,e,0)}))})),l=no(r)))}(l,c),ct(c,$t),0<e.lockedColumns.length&&rt(c,$t,e.lockedColumns.join(",")),I.some({cursor:e.cursor,newRows:o.newRows,newCells:o.newCells})}))}}function No(e,t){return Ct(t.element).bind((function(t){return So(e,t)}))}function Lo(e,t){return Oo(e,t,a)}function Bo(e,t){return Oo(e,t,(function(e){return!e.isLocked}))}function Po(e){return function(e){return e=e,Zt.getOption(e).filter((function(e){return 0!==e.trim().length||-1<e.indexOf("")})).isSome()}(e)||g(zr,re(e))}function Ro(){var e=Fe.fromTag("td");return Jt(e,Fe.fromTag("br")),e}function Ho(){return Fe.fromTag("colgroup")}function zo(e,t,n){var o=function(e,t){return Rt(t=function(e,t){return at(t=Fe.fromTag(t),e=st(e)),t}(e,t),e=ue(Co(e,!0))),t}(e,t);return q(n,(function(e,t){null===e?ct(o,t):rt(o,t,e)})),o}function Fo(e,t,n){return function(e){return t=Po,(n=function(e){for(var o=0;o<e.childNodes.length;o++){var r=Fe.fromDom(e.childNodes[o]);if(t(r))return I.some(r);if((r=n(e.childNodes[o])).isSome())return r}return I.none()})(e.dom);var t,n}(e).map((function(o){return y(function(e,t,n){return o=function(e){return G(e,t)},b(se(e,n),o);var o}(o,n.join(","),(function(t){return J(t,e)})),(function(e,t){return ct(t=Co(t,!1),"contenteditable"),Jt(e,t),t}),t)})).getOr(t)}function Uo(e,t,n){function o(e,t){!function(e,t){e=e.dom,t=t.dom,dt(e)&&dt(t)&&(t.style.cssText=e.style.cssText)}(e.element,t),ht(t,"height"),1!==e.colspan&&ht(t,"width")}var r;return{col:function(t){var n=ie(t.element);return o(t,n=Fe.fromTag(re(t.element),n.dom)),e(t.element,n),n},colgroup:Ho,row:(r=t,function(){return Fe.fromTag("tr",r.dom)}),cell:function(t){var r,a,i=ie(t.element),l=Fe.fromTag(re(t.element),i.dom);i=0<(i=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"])).length?Fo(t.element,l,i):l;return Jt(i,Fe.fromTag("br")),o(t,l),r=t.element,a=l,q(Fr,(function(e,t){return lt(r,t).filter((function(t){return g(e,t)})).each((function(e){return rt(a,t,e)}))})),e(t.element,l),l},replace:zo,gap:Ro}}function _o(e){return Gt.fromTable(e).grid}function Wo(e,t,n,o,r){return p(e,(function(e){var a=0<t&&t<e.cells.length&&o(Tt(e,t-1),Tt(e,t));a=function(e,t,n,o,r,a,i){return"colgroup"!==n&&o?Et(e,t):ne(i((r=Et(e,r)).element,a),!0,!1)}(e,t,e.section,a,n,o,r);return function(e,t,n){return o=t,r=[n],e=(n=(t=e).cells).slice(0,o),o=n.slice(o),o=e.concat(r).concat(o),Vt(t,o);var o,r}(e,t,a)}))}function Qo(e,t,n,o){return p(e,(function(e){return a=function(e){return r=e,f(t,(function(e){return n(r.element,e.element)}))?ne(o(e.element,n),!0,e.isLocked):e;var r},oe(a=p(e=(r=e).cells,a),r.section);var r,a}))}function Vo(e,t,n,o){return void 0!==Tt(e[t],n)&&0<t&&o(Tt(e[t-1],n),Tt(e[t],n))}function $o(e,t,n){return 0<t&&n(Tt(e,t-1),Tt(e,t))}function Ko(e,t,n,o){var r=A(r=Dt(e).rows,(function(o,r){return Vo(e,r,t,n)||$o(o,t,n)?[]:[Et(o,t)]}));return Qo(e,r,n,o)}function Go(e,t,n,o){var r=Dt(e).rows,a=r[t];return Qo(e,A(a.cells,(function(e,o){return Vo(r,t,o,n)||$o(a,o,n)?[]:[e]})),n,o)}function Yo(e,t,n){h(t=function(e,t){return(Gt.hasColumns(e)?function(e,t){return p(e=Gt.justColumns(e),(function(e,n){return{element:e.element,width:t[n],colspan:e.colspan}}))}:function(e,t){return p(e=Gt.justCells(e),(function(e){var n=function(e,t,n){for(var o=0,r=e;r<t;r++)o+=void 0!==n[r]?n[r]:0;return o}(e.column,e.column+e.colspan,t);return{element:e.element,width:n,colspan:e.colspan}}))})(e,t)}(e,t),(function(e){n.setElementWidth(e.element,e.width)}))}function Jo(e){return w(e,(function(e,t){return f(e,(function(e){return e.column===t.column}))?e:e.concat([t])}),[]).sort((function(e,t){return e.column-t.column}))}function qo(e,t){return{grid:e,cursor:t}}function Zo(e,t,n){var o=Dt(e).rows;return qo(e,Wr(o,t,n))}function Xo(e){return w(e,(function(e,t){return f(e,(function(e){return e.row===t.row}))?e:e.concat([t])}),[]).sort((function(e,t){return e.row-t.row}))}function er(e,t){return f(t,(function(e){return 0===e.column&&e.isLocked}))}function tr(e,t){var n=no(e);return w(t=Jo(t),(function(e,t){return e+n[t.column].map(Un).getOr(0)}),0)}function nr(e){return e.dom.textContent}function or(e,t,n){return{value:t+1}}function rr(e,t,n){for(var o="A".charCodeAt(0),r=[],a=t;0<=a;)r.push(String.fromCharCode(o+a%26)),a=Math.floor(a/26)-1;return{value:r.reverse().join("")}}function ar(e){return e=parseFloat(e),isNaN(e)?I.none():I.some(e)}function ir(e,t){return e<t?-1:t<e?1:0}function lr(e,t){return pn(ar(e),ar(t),ir).getOrThunk((function(){return n=t,e.localeCompare(n);var n}))}function cr(o,r){function i(e,n,i,l){return function(c,s){bn(c);var d,u,g=(d=(f=r().resizeHandler.lazyWire()).parent(),g=f.view(),u=f.origin(),H(d.dom)?{origin:t(W(W({},u),{left:u.left(),top:u.top()})),parent:t(W(W({},d),{dom:d.dom()})),view:t(W(W({},g),{dom:g.dom()})),isResizable:a}:f),f=Fe.fromDom(o.getDoc());f=Uo(i,f,V);return n(c)?e(g,c,s,f).bind((function(e){return h(e.newRows,(function(e){var t;t=o,e=e.dom,t.fire("newrow",{node:e})})),h(e.newCells,(function(e){var t;t=o,e=e.dom,t.fire("newcell",{node:e})})),e.cursor.map((function(e){var t=o.dom.createRng();return t.setStart(e.dom,0),t.setEnd(e.dom,0),{rng:t,effect:l}}))})):I.none()}}function l(e,t,n){return{grid:e,cursor:(e=e,t=t,o=n,I.from(e[t]).bind((function(e){return I.from(e.cells[o]).bind((function(e){return I.from(e.element)}))})))};var o}function c(e,t,n,o){return A(e=p(e=v(e,(function(e){return e.section})),(function(e){return v(e,(function(e){return re(Et(e,t).element)}))})),(function(e){return A(e,(function(e){return"th"===re(Et(e[0],t).element)?e:function(e){return e=p(e,(function(e){var n=Et(e,t);return{row:e,text:I.from(nr(n.element)).getOr("")}})),p(e=k(e,(function(e,t){return t=n(e.text,t.text),o?t:-1*t})),(function(e){return e.row}))}(e)}))}))}function s(e,t,n,o){var r=e[t].cells,a=p(r,(function(e){return I.from(nr(e.element)).getOr("")}));e=p(e,(function(e){return{zippedCells:p(e.cells,(function(e,t){return{cell:e,reference:r[t],referenceText:a[t]}})),section:e.section}}));return p(e,(function(e){return oe(p(A(v(e.zippedCells,(function(e){return re(e.reference.element)})),(function(e){return"th"===re(e[0].reference.element)?e:k(e,(function(e,t){return t=n(e.referenceText,t.referenceText),o?t:-1*t}))})),(function(e){return e.cell})),e.section)}))}function d(e,t,n,o,r){var a=e.slice(0,t);t=e.slice(t,n+1);return{beforeRows:a,afterRows:e.slice(n+1,e.length),selectionGridBefore:t.map((function(e){return{cells:e.cells.slice(0,o),section:e.section}})),selectionGrid:t.map((function(e){return{cells:e.cells.slice(o,r+1),section:e.section}})),selectionGridAfter:t.map((function(e){return{cells:e.cells.slice(r+1,e.cells.length),section:e.section}}))}}function u(e,t){return t=p(t,(function(t,n){var o=e.selectionGridBefore[n].cells;n=e.selectionGridAfter[n].cells;return{cells:o.concat(t.cells).concat(n),section:t.section}})),e.beforeRows.concat(t).concat(e.afterRows)}function g(e,t,n,o,r,a,i,l){return u(a=d(e,n,o,r,a),l=c(a.selectionGrid,t-r,i,l))}function m(e,t,n,o,r,a,i,l){return u(a=d(e,n,o,r,a),l=s(a.selectionGrid,t-n,i,l))}function b(e){return w(e,(function(e,t){return f(e,(function(e){return e.row===t.row}))?e:e.concat([t])}),[]).sort((function(e,t){return e.row-t.row}))}function y(e){return w(e,(function(e,t){return f(e,(function(e){return e.column===t.column}))?e:e.concat([t])}),[]).sort((function(e,t){return e.column-t.column}))}function C(e){return w(e,(function(e,t){return f(e,(function(e){return J(e.element,t.element)}))?e:e.concat([t])}),[])}function x(e){return Q(N(e.attributes)?Z(e.attributes,(function(e,t){return B(e)?function(e){return ct(e,t)}:function(n){return rt(n,t,e)}})):[],function(e,t){if(L(e)){for(var n=0,o=e.length;n<o;++n)if(!t(e[n]))return!1;return!0}return!1}(e.classes,j)?p(e.classes,(function(e){return function(t){return fn(t,e)}})):[],[function(t){var n=nr(t)||"",o=(o=e.value,z(o)?String(o):j(o)?o:void 0);0<(n=j(o)?o:n).length?(n=n,t.dom.textContent=n):function(e,t){var n=ie(e).dom,o=Fe.fromDom(n.createDocumentFragment());Rt(o,n=function(e,t){return(t=(t||document).createElement("div")).innerHTML=e,ue(Fe.fromDom(t))}(t,n)),Ht(e),Jt(e,o)}(t,"<br>")}])}function M(e,t,n,o,r,a){var i;h(t,(function(t,l){var c=t.element;t={rowType:a(l).section,cellType:re(c),classes:mn(c),prev:null==i?void 0:i.raw,direction:n};h(l=x(t=e(t,o(l),r(l))),(function(e){return e(c)})),i=t}))}function E(e,t,n,o,r){return l(o=g(e,r,0,e.length,r,r,n,o),t[0].row,t[0].column)}function T(e,t,n,o,r){var a=b(t),i=y(t);return l(o=g(e,r,a[0].row,a[a.length-1].row,i[0].column,i[i.length-1].column,n,o),t[0].row,t[0].column)}function D(e,t,n,o,r){return l(o=$(e,r,n,o),t.row,t.column)}function S(e,t,n,o,r){return l(o=m(e,r,r,r,0,e[t[0].row].cells.length,n,o),t[0].row,t[0].column)}function O(e,t,n,o,r){var a=b(t),i=y(t);return l(o=m(e,r,a[0].row,a[a.length-1].row,i[0].column,i[i.length-1].column,n,o),t[0].row,t[0].column)}function P(e,t,n,o,r){return l(o=K(e,r,n,o),t.row,t.column)}function R(e,o,r,a){var i=Dt(e).rows;return M(r,C(p(i,(function(e){return Et(e,a)}))),"column",n,t(a),(function(e){return i[e]})),l(e,o.row,o.column)}function F(e,o,r,a){var i=Dt(e).rows[a];return M(r,C(i.cells),"row",t(a),n,t(i)),l(e,o.row,o.column)}function U(t,n,o,r,a){return function(i,l,c,s){return jo((function(e,a){return t(e,a,n,o,r)}),a,e,e,Mr)(i,l,c,s)}}function _(t,n,o,r){return function(a,i,l,c){return jo((function(e,r){return t(e,r,n,o)}),r,e,e,Mr)(a,i,l,c)}}var V=function(e){return e=e.getParam("table_clone_elements"),j(e)?I.some(e.split(/[ ,]/)):Array.isArray(e)?I.some(e):I.none()}(o),$=c,K=s;return{sortColumnRowsAsc:function(t){return i(U(E,lr,!0,t,Lo),a,e,On)},sortColumnRowsDesc:function(t){return i(U(E,lr,!1,t,Lo),a,e,On)},sortSelectionRowsAsc:function(t){return i(U(T,lr,!0,t,Lo),a,e,On)},sortSelectionRowsDesc:function(t){return i(U(T,lr,!1,t,Lo),a,e,On)},sortTableRowsAsc:function(t){return i(U(D,lr,!0,t,No),a,e,On)},sortTableRowsDesc:function(t){return i(U(D,lr,!1,t,No),a,e,On)},sortRowColumnsAsc:function(t){return i(U(S,lr,!0,t,Lo),a,e,On)},sortRowColumnsDesc:function(t){return i(U(S,lr,!1,t,Lo),a,e,On)},sortSelectionColumnsAsc:function(t){return i(U(O,lr,!0,t,Lo),a,e,On)},sortSelectionColumnsDesc:function(t){return i(U(O,lr,!1,t,Lo),a,e,On)},sortTableColumnsAsc:function(t){return i(U(P,lr,!0,t,No),a,e,On)},sortTableColumnsDesc:function(t){return i(U(P,lr,!1,t,No),a,e,On)},insertColumnBefore:i(Qr,a,qn,On),deleteColumn:i(Vr,(function(e){return 0==("table"===re(hn(o)))||1<_o(e).columns}),e,On),populateColumn:function(t,n){return i(_(R,n,t,No),a,e,Sn)},populateRow:function(t,n){return i(_(F,n,t,No),a,e,Sn)}}}function sr(e){return lt(e,$r)}function dr(e){var n,o,r,a=Br(e),i=Gt.fromTable(e),l=Gt.getAt(i,0,0).bind((function(e){return Hn(mt(e.element,"width"),["fixed"])})).map((function(e){return 28-e.value})).getOr(0);n=e,o=l,i=0,e=to(),l=a,a=Gt.fromTable(n),n=l.getCellDelta(o),r=l.getWidths(a,l),o=i===a.grid.columns-1,n=e.clampTableDelta(r,i,n,l.minCellWidth(),o),i=function(e,n,o,r,a){var i=e.slice(0);return n=n,e=0===(e=e).length?_r.none():1===e.length?_r.only(0):0===n?_r.left(0,1):n===e.length-1?_r.right(n-1,n):0<n&&n<e.length-1?_r.middle(n-1,n,n+1):_r.none(),n=t(p(i,t(0))),e.fold(n,(function(e){return r.singleColumnWidth(i[e],o)}),(function(e,t){return a.calcLeftEdgeDeltas(i,e,t,o,r.minCellWidth(),r.isRelative)}),(function(e,t,n){return a.calcMiddleDeltas(i,e,t,n,o,r.minCellWidth(),r.isRelative)}),(function(e,t){return a.calcRightEdgeDeltas(i,e,t,o,r.minCellWidth(),r.isRelative)}))}(r,i,n,l,e),Yo(a,i=p(i,(function(e,t){return e+r[t]})),l),e.resizeTable(l.adjustTableWidth,n,o)}function ur(e,t){var n=function e(t){var n,o=[];return R(t)?o:("thead"===(n=t).name||"tbody"===n.name||"tfoot"===n.name?o.push.apply(o,e(t.firstChild)):"tr"===t.name&&o.push(t),o.concat(e(t.next)))};e.parser.addAttributeFilter($r,(function(e){for(var o=0,r=e;o<r.length;o++){var a=r[o];if("table"===a.name){var i=a.attr($r);if(!1===(null===(i=t[i])||void 0===i?void 0:i.resizable))for(var l=0,c=n(a.firstChild);l<c.length;l++){var s=c[l];u(s.firstChild)&&s.firstChild.attr("data-mce-resize","false")}}}}))}function gr(e){return function(t){var n=t.getData();t.close(),e.undoManager.transact((function(){e.execCommand("mceSortTableAdvanced",!1,n),e.focus(),e.addVisual()}))}}function fr(e,t){function n(t){var n;return{type:"selectbox",name:"roworcol",label:"column"===t?"Column":"Row",items:"column"===t?function(){var t=i.get().getOrDie("state must be present");return m(t.limit?t.finishCol+1-t.startCol:t.columns,(function(n){var o=t.limit?t.startCol:0,r=function(e){for(var t=e,n="";0<Math.floor(t);)--t,n+=String.fromCharCode("A".charCodeAt(0)+t%26),t/=26;return n.split("").reverse().join("")}(n+o+1);return{text:e.translate(["Column {0}",r]),value:""+(n+o)}}))}():(n=i.get().getOrDie("state must be present"),t=n.limit?n.finishRow+1-n.startRow:n.rows,m(t,(function(t){var o=n.limit?n.startRow:0,r=(t+o+1).toString();return{text:e.translate(["Row {0}",r]),value:""+(t+o)}})))}}function o(e){return{title:"Advanced Sort",size:"normal",body:{type:"panel",items:[{type:"grid",columns:2,items:[a,n(e=e),{type:"selectbox",name:"sort",label:"Sort",items:["column"===e?{text:"Column",value:"column"}:{text:"Row",value:"row"},{text:"Selection",value:"selection"},{text:"Table",value:"table"}]},l]}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"sort",text:"Sort",primary:!0}]}}function r(){i.set(I.none())}var a={type:"selectbox",name:"sortby",label:"Sort by",items:[{text:"Column",value:"column"},{text:"Row",value:"row"}]},i=Zn(I.none()),l={type:"selectbox",name:"order",label:"Order",items:[{text:"Ascending",value:"ascending"},{text:"Descending",value:"descending"}]},c=function t(n,a){var l;"sortby"===a.name&&(l=n.getData(),a=i.get().getOrDie("state must be present"),a={roworcol:"column"===l.sortby?""+a.startCol:""+a.startRow},a=W(W({},l),a),a=W(W({},o(l.sortby)),{onChange:t,onClose:r,onSubmit:gr(e),initialData:a}),n.redial(a),n.focus("sortby"))};Nn(e).each((function(n){An(n,e).each((function(a){function l(t){i.set(I.some(t)),t={sortby:"column",roworcol:""+t.startCol,sort:"column",order:"ascending"},t=W(W({},o("column")),{onChange:c,onClose:r,onSubmit:gr(e),initialData:t}),e.windowManager.open(t)}var s=wn(t,a,n),d=_o(a);s.mergable.fold((function(){Nt(a,n,n).each((function(e){l(e=W(W(W({},e),d),{limit:!1}))}))}),(function(e){l(e=W(W(W({},e.bounds),d),{limit:!0}))}))}))}))}function mr(e,t,n,o,r){function a(e){return"selection"===e}function i(e){return"ascending"===e}function l(){return Nn(e).bind((function(t){return An(t,e).bind((function(e){return Nt(e,t,t).map((function(e){return e.startCol}))}))}))}function c(){return Nn(e).bind((function(t){return An(t,e).bind((function(e){return Nt(e,t,t).map((function(e){return e.startRow}))}))}))}e.addCommand("mceSortTableByColumnAsc",(function(){l().each((function(e){o.selection(t.sortTableRowsAsc(e))}))})),e.addCommand("mceSortTableByColumnDesc",(function(){l().each((function(e){o.selection(t.sortTableRowsDesc(e))}))})),e.addCommand("mceSortTableByRowAsc",(function(){c().each((function(e){o.selection(t.sortTableColumnsAsc(e))}))})),e.addCommand("mceSortTableByRowDesc",(function(){c().each((function(e){o.selection(t.sortTableColumnsDesc(e))}))})),e.addCommand("mceSortTableAdvanced",(function(e,n){return function(e){var n,r,l=parseInt(e.roworcol,10);"column"===e.sortby?(r=l,"column"===(n=e).sort?i(n.order)?o.selection(t.sortColumnRowsAsc(r)):o.selection(t.sortColumnRowsDesc(r)):a(n.sort)?i(n.order)?o.selection(t.sortSelectionRowsAsc(r)):o.selection(t.sortSelectionRowsDesc(r)):i(n.order)?o.selection(t.sortTableRowsAsc(r)):o.selection(t.sortTableRowsDesc(r))):(l=l,"row"===(e=e).sort?i(e.order)?o.selection(t.sortRowColumnsAsc(l)):o.selection(t.sortRowColumnsDesc(l)):a(e.sort)?i(e.order)?o.selection(t.sortSelectionColumnsAsc(l)):o.selection(t.sortSelectionColumnsDesc(l)):i(e.order)?o.selection(t.sortTableColumnsAsc(l)):o.selection(t.sortTableColumnsDesc(l)))}(n)})),e.addCommand("mceAdvancedTableSort",(function(){return fr(e,n)})),sn(tinymce,"5.7.0")||e.addCommand("mceTableToggleSeries",(function(n,a){var i,l,c=(i=I.from(a.name).filter(j)).bind((function(e){return X(r,e)})),s=(l=Nn(e).bind((function(t){return An(t,e)}))).bind(sr);a=c,c=l,l=function(e,n,r){s.fold((function(){var a,i,l,c,s;a=r,i=t,c=e,s=n,(l=o).column(0,i.insertColumnBefore,!0,!1),dr(a),Gr(a,i,l,c,s)}),(function(a){a.toLowerCase()===e.toLowerCase()?function(e,t,n){ct(e,Kr),ct(e,$r),n.column(0,t.deleteColumn,!0,!1)}(r,t,o):Gr(r,t,o,e,n)}))},(i=i).isSome()&&a.isSome()&&c.isSome()?I.some(l(i.getOrDie(),a.getOrDie(),c.getOrDie())):I.none()}))}var pr,hr,br,vr=(O=function(e,t){function n(n){var o=t(n);return o<=0||null===o?(n=mt(n,e),parseFloat(n)||0):o}function o(e,t){return w(t,(function(t,n){return n=void 0===(n=mt(e,n))?0:parseInt(n,10),isNaN(n)?t:t+n}),0)}return{set:function(t,n){if(!z(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);dt(t=t.dom)&&(t.style[e]=n+"px")},get:n,getOuter:n,aggregate:o,max:function(e,t,n){return(n=o(e,n))<t?t-n:0}}})("height",(function(e){var t=e.dom;return qe(e)?t.getBoundingClientRect().height:t.offsetHeight})),yr=O("width",(function(e){return e.dom.offsetWidth})),wr=/(\d+(\.\d+)?)%/,Cr=/(\d+(\.\d+)?)px|em/,Ar=t(wr),xr=t(Cr),Mr=function(e,t){function n(n){return"col"!==re((n=n=t(n)).element)?e.cell(n):e.col(n)}function o(e){var t=n(e);return r.get().isNone()&&r.set(I.some(t)),a=I.some({item:e,replacement:t}),t}void 0===t&&(t=Xn);var r=Zn(I.none()),a=I.none();return{getOrInit:function(e,t){return a.fold((function(){return o(e)}),(function(n){return t(e,n.item)?n.replacement:o(e)}))},cursor:r.get}},kr=(i=function(e,t){return function(n){function o(o){var i=n.replace(o,t,{scope:e});return a.push({item:o,sub:i}),r.get().isNone()&&r.set(I.some(i)),i}var r=Zn(I.none()),a=[];return{replaceOrInit:function(e,t){return"col"===re(e)?e:(n=e,r=t,C(a,(function(e){return r(e.item,n)})).fold((function(){return o(e)}),(function(n){return t(e,n.item)?n.sub:o(e)})));var n,r},cursor:r.get}}},(O=function(e){return function(t,n,o,r){return e(o)?(r=Math.max(r,t[n]-Math.abs(o)),n=Math.abs(r-t[n]),0<=o?n:-n):o}})((function(e){return e<0}))),Er=O(a),Tr=function(e,t,n){var o=e();return C(o,t).orThunk((function(){return I.from(o[0]).orThunk(n)})).map((function(e){return e.element}))},Dr=function e(t,n){return{left:t,top:n,translate:function(o,r){return e(t+o,n+r)}}},Ir=function(e){var t=e.dom,n=t.ownerDocument.body;return n===t?Dr(n.offsetLeft,n.offsetTop):qe(e)?function(e){return e=e.getBoundingClientRect(),Dr(e.left,e.top)}(t):Dr(0,0)},Sr=function(e){return po(fo,mo,e)},Or=(pr={delta:n,edge:co,positions:function(e){return po(so,uo,e)}},hr={delta:function(e){return-e},edge:lo,positions:function(e){return po(uo,so,e)}},function(e){return"rtl"===function(e){return"rtl"===mt(e,"direction")?"rtl":"ltr"}(e)?hr:pr}),jr=function(e,t){return Or(t).positions(e,t)},Nr=function(e){return Or(e).edge(e)},Lr=("col",function(e){return $e(e)&&"col"===re(e)}),Br=function(n){return $n(n).fold((function(){return function(n){function o(){return Fn(n)}var r=t(0);return{width:o,pixelWidth:o,getWidths:function(e,t){return yo(e,n,t)},getCellDelta:r,singleColumnWidth:t([0]),minCellWidth:r,setElementWidth:e,adjustTableWidth:e,isRelative:!0,label:"none"}}(n)}),(function(e){return function(e,t){var n=Ar().exec(t);if(null!==n)return function(e,t){var n=Zn(parseFloat(e)),o=Zn(Fn(t));return{width:n.get,pixelWidth:o.get,getWidths:function(e,n){return vo(e,t,Gn,(function(e){return e.fold((function(){return o.minCellWidth()}),(function(e){return e/o.pixelWidth()*100}))}),o=n);var o},getCellDelta:function(e){return e/o.get()*100},singleColumnWidth:function(e,t){return[100-e]},minCellWidth:function(){return _t()/o.get()*100},setElementWidth:Vn,adjustTableWidth:function(e){var r=n.get();Vn(t,r=r+e/100*r),n.set(r),o.set(Fn(t))},isRelative:!0,label:"percent"}}(n[1],e);if(null!==(t=xr().exec(t))){var o=parseInt(t[1],10);return wo(o,e)}return wo(o=Fn(e),e)}(n,e)}))},Pr=(O=(br="ephox-snooker".replace(/\./g,"-"),{resolve:function(e){return br+"-"+e}}).resolve)("resizer-bar"),Rr=O("resizer-rows"),Hr=O("resizer-cols"),zr=(O=function(e,t){return No(e,t).filter((function(e){return!e.isLocked}))},["img","br"]),Fr={scope:["row","col"]},Ur=Ur([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),_r=W({},Ur),Wr=function(e,t,n){return I.from(e[t]).bind((function(e){return I.from(e.cells[n]).bind((function(e){return I.from(e.element)}))}))},Qr=jo((function(e,t,n,o){var r=t.detail,a=r.column;return Zo(o=Wo(e,t=r.column,a,n,o.getOrInit),r.row,t)}),(!0,function(e,t){return No(e,t).filter((function(e){return!er(0,[e])})).map((function(t){return{detail:t,pixelDelta:tr(e,[t])}}))}),Ur=function(e,t,n,o,r){var a=Gt.generate(t),i=o.getWidths(a,o);t=o.pixelWidth(),n=(t=r.calcRedestributedWidths(i,t,n.pixelDelta,o.isRelative)).newSizes,t=t.delta;Yo(a,n,o),o.adjustTableWidth(t)},e,Mr),Vr=jo((function(e,t,n,o){var r,a,i,l=Jo(t.details);return qo(t=(a=e,r=p(l,(function(e){return e.column})),A(a,(function(e){var t=e.cells;return 0<(t=y(r,(function(e,t){return 0<=t&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e}),t)).length?[oe(t,e.section)]:[]}))),l=(e=t,a=l[0].row,l=l[0].column,i=Dt(e).rows,Wr(i,a,l).orThunk((function(){return Wr(i,0,0)}))))}),(function(e,t){return Bo(e,t).map((function(t){return{details:t,pixelDelta:-tr(e,t)}}))}),Ur,(function(e){0===At(e).length&&qt(e)}),Mr),$r=(jo((function(e,t,n,o){return Zo(o=Ko(e,t.column,n,o.replaceOrInit),t.row,t.column)}),O,e,e,i("row","th")),jo((function(e,t,n,o){return Zo(e=w(Jo(t),(function(e,t){return Ko(e,t.column,n,o.replaceOrInit)}),e),t[0].row,t[0].column)}),Bo,e,e,i("row","th")),jo((function(e,t,n,o){return Zo(o=Ko(e,t.column,n,o.replaceOrInit),t.row,t.column)}),O,e,e,i(null,"td")),jo((function(e,t,n,o){return Zo(e=w(Jo(t),(function(e,t){return Ko(e,t.column,n,o.replaceOrInit)}),e),t[0].row,t[0].column)}),Bo,e,e,i(null,"td")),jo((function(e,t,n,o){return Zo(o=Go(e,t.row,n,o.replaceOrInit),t.row,t.column)}),No,e,e,i("col","th")),jo((function(e,t,n,o){return Zo(e=w(Xo(t),(function(e,t){return Go(e,t.row,n,o.replaceOrInit)}),e),t[0].row,t[0].column)}),Lo,e,e,i("col","th")),jo((function(e,t,n,o){return Zo(o=Go(e,t.row,n,o.replaceOrInit),t.row,t.column)}),No,e,e,i(null,"td")),jo((function(e,t,n,o){return Zo(e=w(Xo(t),(function(e,t){return Go(e,t.row,n,o.replaceOrInit)}),e),t[0].row,t[0].column)}),Lo,e,e,i(null,"td")),"data-snooker-col-series"),Kr="data-snooker-locked-cols",Gr=function(e,t,n,o,r){n.table(e,0,0,t.populateColumn(0,(function(e,t,n){return{raw:n=r.generator(e,t,n),value:n.value,classes:n.classes,attributes:W(W({contenteditable:"false"},n.attributes),{"data-mce-resize":!1===r.resizable?"false":null})}})),!0,!1),rt(e,$r,o),rt(e,Kr,0)};tinymce.PluginManager.add("advtable",(function(t){var o,r,a,i,l,c,s,d,u,f,m,p;return sn(tinymce,"5.1.2")?console.error("Please use Advanced Tables with TinyMCE 5.1.2 or later."):("table",g(t.getParam("plugins","","string").split(/[ ,]/),"table")?(r=cr(t,o=function(){return t.plugins.table}),f=function(){return hn(t)},m=function(){return Ln(t)},p=jn.selectedSelector,i=function(t,o){function r(e,n){return void 0===n&&(n=!0),function(o){var r,a;t.selection.setRng(o.rng),t.focus(),l.clear(e),bn(e),n&&(r=t,a=e.dom,o=o.effect,r.fire("TableModified",W(W({},o),{table:a})))}}function a(e){var n=t.dom.createRng();return n.setStart(e,0),n.setEnd(e,0),n}function i(e,o,i,l,c){Nn(t).each((function(s){An(s,t).each((function(t){function d(e,t){return Gt.findItem(u,e,J).map((function(e){return e[t]}))}var u=Gt.fromTable(t),g=pn(e.orThunk((function(){return d(s,"row")})),g=o.orThunk((function(){return d(s,"column")})),(function(e,t){return Gt.getAt(u,e,t).map((function(e){return e.element}))})).bind(n).bind((function(e){return e=Cn(e),i(t,e)}));(l?g.map((function(e){return W(W({},e),{rng:a(s.dom)})})):g).each(r(t,c))}))}))}var l=In(jn,e,e);return{selection:function(e,n){Nn(t).each((function(a){An(a,t).each((function(t){var i=wn(o,t,a);e(t,i).each(r(t,n))}))}))},row:function(e,t,n,o){return i(I.some(e),I.none(),t,n,o)},column:function(e,t,n,o){return i(I.none(),I.some(e),t,n,o)},table:function(e,n,o,i,l,c){var s=Gt.fromTable(e),d=(o=Gt.getAt(s,n,o).map((function(e){return e.element})),t.selection.getRng()),u=Nn(t),g=u.bind((function(e){return Gt.findItem(s,e,J)})).isSome(),f=o.bind((function(t){return t=Cn(t),i(e,t)}));pn(f,g&&l?u.map((function(e){return a(e.dom)})):g?f.map((function(e){return e.rng})):I.some(d),(function(e,t){return W(W({},e),{rng:t})})).each(r(e,c))}}}(t,a={get:function(){return tn(f(),p).fold((function(){return m().map(Dn).getOrThunk(En)}),(function(e){return Tn(e)}))}}),l=t.getParam("advtable_value_series",{numbers:{update:!0,resizable:!1,generator:or},alpha:{update:!0,resizable:!1,generator:rr}}),mr(t,r,a,i,l),function(e,t,n){function o(t,n){return function(){return e.execCommand(t,!1,n)}}e.on("init",(function(){var r=t().selectionTargets.onSetupCellOrRow,a=[{type:"menuitem",text:"Sort table by column ascending",onAction:o("mceSortTableByColumnAsc"),onSetup:r},{type:"menuitem",text:"Sort table by column descending",onAction:o("mceSortTableByColumnDesc"),onSetup:r},{type:"separator"},{type:"menuitem",text:"Advanced sort...",onAction:function(){return fr(e,n)},onSetup:r}];e.ui.registry.addNestedMenuItem("advtablesort",{type:"nestedmenuitem",text:"Sort",getSubmenuItems:function(){return a}})}))}(t,o,a),sn(tinymce,"5.7.0")||(s=r,d=i,u=l,(c=t).on("TableModified",(function(e){var t=Fe.fromDom(e.table),n=sr(t),o=n.bind((function(e){return X(u,e)}));pn(n,o,(function(n,o){1===Gt.fromTable(t).grid.columns?Nn(c).bind(Mt).exists((function(e){return J(t,e)}))?c.execCommand("mceTableDelete"):c.undoManager.transact((function(){qt(t)})):!0===o.update&&!1!==e.structure&&Gr(t,s,d,n,o)}))})),c.on("PreInit",(function(){ur(c,u)})))):console.log("Please use the Advanced Tables Plugin together with the Tables plugin.")),{}}))}()},,function(e,t,n){var o=n(51);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(11)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,'#autocomplete-dropdown span.editor-icon{padding:0}#autocomplete-dropdown span.icon{height:20px;width:20px;background-position:50%;background-repeat:no-repeat}#autocomplete-dropdown .dropdown-insert-link span.icon{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAMFBMVEX///9wcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHAnFTKsAAAAD3RSTlMAESIzRFVmd4iZqrvM3e5GKvWZAAAAWUlEQVQIW2NgQAZWJyA0+++5l8AM3gSG6zDJUyCCeaYCyxUQI/bMY74FQJrxJoPhWQEgQ/bADKmHIJl1AnlvDUCMqwwMAmCdjxnkAsCMvSV3ICKc7zcwYAUAjz0WbHRhn40AAAAASUVORK5CYII=")}#autocomplete-dropdown .dropdown-insert-image span.icon{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3gcLBBgu2AWxpAAAAUdJREFUOMuVUzFOw0AQnLlzHhCKVNBQwBPgC8ALEAUKRQQozp1p6JEoaPDZipAgzwAp4ilRygQ+QBGa3KaxE8ckFp7uRrPj2bkzUYK19gTAK4A9VGPive8EZVZE3rz312maflRN93q9G6XUABsSyH9hrZVg2xeiKFo7x3G8xsVxDAAIUAP5UBFBHfGmBKzbepIkw6JhUKd1rfUwT7FMWNW6MeYxDMOLYuu5YRiGZ8aYydYOut3uYaPRGCmlvsvXnK8EYPWQrLVPAFrOuTYA9Pv9kbX2DsAYwHuuc86xaKiy4ReS9yTbxpjzgvhZa/1V1Y0CAJK3S0KpZDabpZnx5Xw+f4iiyG0zYLGYwv8wIPlD8iDnvPdjklF5hUBEpiR3Sx5XIvIpIjskWyLSBHAkItM/K5DsZI2uYpGa5CnJYwD7JJskfzPtGhZ44Nh/W3weYAAAAABJRU5ErkJggg==")}#autocomplete-dropdown .dropdown-insert-macro span.icon{background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGQ9Ik0xMyA2LjVhMS41IDEuNSAwIDEwLjAwMSAzLjAwMUExLjUgMS41IDAgMDAxMyA2LjVtLTUgMGExLjUgMS41IDAgMTAuMDAxIDMuMDAxQTEuNSAxLjUgMCAwMDggNi41TTQuNSA4YTEuNSAxLjUgMCAxMS0zLjAwMS0uMDAxQTEuNSAxLjUgMCAwMTQuNSA4IiBpZD0iYSIvPjwvZGVmcz48dXNlIGZpbGw9IiM5N0EwQUYiIHhsaW5rOmhyZWY9IiNhIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=");background-size:20px 20px}#autocomplete-dropdown .insert-create-page-link span.icon{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAADFBMVEX///9wcHBwcHBwcHD6E60rAAAAA3RSTlMAmaps9r97AAAAJ0lEQVQIW2NgQADGC0CC+QMywfj//wUG5v//P4BYD9BlGRiBQqgAAJ+HEATHbgMnAAAAAElFTkSuQmCC")}#autocomplete-dropdown .aui-dropdown ol.top-menu-item{display:none}#autocomplete-dropdown .aui-dropdown h2.top-menu-title{background:#f5f5f5;font-size:14px;font-weight:400;line-height:24px;margin:0;padding:2px 5px;border-bottom:1px solid #ccc;cursor:pointer}#autocomplete-dropdown .aui-dropdown.fabric h2.top-menu-title{display:none}#autocomplete-dropdown .aui-dropdown .hidden-div{position:absolute;top:-10000px}',""])},,,,function(e,t,n){var o=n(56);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(11)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,"table.draggable{margin-left:-10px;margin-top:-10px}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{background-color:#777;border-top:1px solid #777;border-left:1px solid #777}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-table{border-right:1px solid #aaa}table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{border-bottom:1px solid #aaa}td.draggable-column,td.draggable-row,td.draggable-table{background-color:initial;border-top:1px solid transparent;border-left:1px solid transparent;cursor:move}td.draggable-column,td.draggable-table{border-right:1px solid transparent}td.draggable-row,td.draggable-table{border-bottom:1px solid transparent}td.draggable-column{height:10px}td.draggable-row{width:10px}.wiki-content img.confluence-embedded-image,.wiki-content img.editor-inline-macro,.wiki-content table.wysiwyg-macro{cursor:move}.wiki-content table.wysiwyg-macro>tbody>tr>td.wysiwyg-macro-body{cursor:text}#move-indicator{font-weight:400!important}",""])},function(e,t,n){var o=n(58);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(11)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,".quick-comment-form #rte-toolbar .insert-files.toolbar-item{padding:0 6px}.quick-comment-form #rte-toolbar .insert-files .toolbar-trigger{margin:0 -6px}#rte-toolbar .insert-files.toolbar-item{padding:0}#rte-toolbar .insert-files .trigger-text{display:none}#rte-toolbar .insert-files .aui-button{padding:0 6px}",""])},function(e,t,n){var o=n(60);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(11)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,'.aui-dialog .wiki-parser-selector{font-size:14px;margin-right:5px}.insert-wiki-markup-panel div,.insert-wiki-markup-panel div form{height:100%;text-align:center}.insert-wiki-markup-panel .spinner{position:absolute;top:50%;left:50%;margin-top:-73px;margin-left:-60px}#insert-wiki-info-title{text-align:left;margin-left:10px}#insert-wiki-markup-form{height:95%}#insert-wiki-markup-form .wiki-title span{box-sizing:border-box;display:-moz-inline-stack;display:inline-block;margin-bottom:10px;max-width:48%;text-align:left;vertical-align:middle;width:48%}#insert-wiki-markup-form .wiki-title span:first-child{margin-right:20px}#insert-wiki-textarea,#insert-wiki-textarea-preview{box-sizing:border-box;display:-moz-inline-stack;display:inline-block;font-size:14px;height:84%;max-width:48%;vertical-align:middle;width:48%;resize:none}#insert-wiki-textarea.originalDefault{height:100%;min-width:100%;width:100%}#insert-wiki-textarea{font-family:Monaco,Consolas,Courier New,"monospace";margin-right:20px}#insert-wiki-textarea-preview{border:1px solid #ccc;border-radius:3px;position:relative}#insert-wiki-textarea-preview iframe{border:0;height:100%;left:0;min-height:100%;overflow:hidden;position:absolute;top:0;width:100%}',""])},function(e,t,n){var o=n(62);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(11)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,"body.ios{min-height:150px}",""])},function(e,t,n){e.exports=void 0},function(e,t,n){e.exports=void 0},function(e,t,n){e.exports=void 0},function(e,t,n){t=e.exports=n(10)(!1);var o=n(34),r=o(n(67)),a=o(n(68));t.push([e.i,'html{height:100%}html.insert-wiki-markup-dialog{box-sizing:border-box;height:96%;overflow:auto}html .assistive{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}body.wiki-content{height:100%;min-height:100%}body.previewWiki{box-sizing:border-box;background:#fff;height:100%;overflow:auto;padding:10px}body.resizable{height:auto;margin:0;padding:0}body.fullsize{box-sizing:border-box;border:0;margin:0 10px;padding:10px 0}body.mceContentBody{background:#fff;border:none;text-align:left}.mceContentBody .wysiwyg-macro-body-preformat{border:1px solid #ccc;margin:5px 20px}.mceContentBody .wysiwyg-macro-inline{display:inline}.mceContentBody .user-new-line,.mceContentBody .wysiwyg-macro-body-newline{display:none;line-height:0}img.emoticon{vertical-align:text-bottom;width:16px;height:16px}#autocomplete{background-color:#ebecf0;border-radius:3px;padding:1px 0}#autocomplete.fabric{color:#0052cc}#autocomplete.fabric,#autocomplete.fabric #autocomplete-trigger{background-color:initial;border:transparent}#autocomplete-trigger{background-color:#ebecf0;padding:0 2px;border-radius:3px 0 0 3px}#autocomplete-search-text{padding:1px 6px 1px 3px}.macro span.macro-name{border-radius:3px;background-clip:padding-box;background-color:#f0f0f0;padding:4px}.wysiwyg-macro{background-color:#f0f0f0;background-position:0 2px;background-repeat:no-repeat;border:1px solid #ddd}.wiki-content .wysiwyg-macro{padding:24px 2px 2px;width:100%}.wiki-content .wysiwyg-macro-body{background-color:#fff;border:1px solid #ddd;margin:0;padding:10px}.wiki-content .wysiwyg-macro-body>p:first-child{margin-top:0}.wiki-content .wysiwyg-macro-body>p:last-child{margin-bottom:0}.wiki-content .wysiwyg-macro-body>pre{-moz-tab-size:4;tab-size:4;margin:0;white-space:pre-wrap}.wiki-content td .wysiwyg-macro-body{min-width:200px}.wiki-content .confluence-embedded-image{cursor:default;max-width:calc(100% - 4px);margin-left:2px;margin-right:2px;vertical-align:text-bottom}.wiki-content .confluence-embedded-image[height],.wiki-content .confluence-embedded-image[width]{max-width:none}.wiki-content .image-left{float:left;margin:0 10px 10px 0}.wiki-content .image-center{margin-left:auto;margin-right:auto;display:block}.wiki-content .image-right{float:right;margin:0 0 10px 10px}.wiki-content table.wysiwyg-macro{border-collapse:initial}.wiki-content .highlight-marker{background-color:#feeecd}.wiki-content table tbody td.mceSelected,.wiki-content table tbody th.mceSelected.nohighlight{background-color:#edf5ff!important}.wiki-content table tbody td.mceSelected.highlight,.wiki-content table tbody th.mceSelected{background-color:#e0e0e0!important}.wiki-content table tbody td.mceSelected.highlight-blue,.wiki-content table tbody td.mceSelected.info,.wiki-content table tbody th.mceSelected.highlight-blue,.wiki-content table tbody th.mceSelected.info{background-color:#d3e3f7!important}.wiki-content table tbody td.mceSelected.highlight-green,.wiki-content table tbody td.mceSelected.success,.wiki-content table tbody th.mceSelected.highlight-green,.wiki-content table tbody th.mceSelected.success{background-color:#d3f4cc!important}.wiki-content table tbody td.mceSelected.highlight-red,.wiki-content table tbody td.mceSelected.warning,.wiki-content table tbody th.mceSelected.highlight-red,.wiki-content table tbody th.mceSelected.warning{background-color:#f3dada!important}.wiki-content table tbody td.mceSelected.highlight-yellow,.wiki-content table tbody td.mceSelected.note,.wiki-content table tbody th.mceSelected.highlight-yellow,.wiki-content table tbody th.mceSelected.note{background-color:#f6f7ca!important}.wiki-content.show-eol-markup h1:after,.wiki-content.show-eol-markup h2:after,.wiki-content.show-eol-markup h3:after,.wiki-content.show-eol-markup h4:after,.wiki-content.show-eol-markup h5:after,.wiki-content.show-eol-markup h6:after,.wiki-content.show-eol-markup li:after,.wiki-content.show-eol-markup p:after{color:#777;content:" \\00B6"}.wysiwyg-unknown-macro{vertical-align:text-bottom}p+table.wysiwyg-macro,table.wysiwyg-macro+p{margin-top:10px}.editor-inline-macro{background-color:#f0f0f0;border:1px solid #ddd;margin:0 2px;min-height:24px;vertical-align:text-bottom}.editor-inline-macro.with-chrome{background-position:0 0;background-repeat:no-repeat;height:auto;padding:24px 2px 2px}.confluenceTd>.editor-inline-macro,.confluenceTd>.wysiwyg-unknown-macro,.confluenceTh>.editor-inline-macro,.confluenceTh>.wysiwyg-unknown-macro{vertical-align:inherit}.macro-placeholder-icon{background-image:url('+r+");background-position:0 3px;background-repeat:no-repeat}.image-hotswap{background-image:url("+a+");background-position:4px 50%;background-repeat:no-repeat}table.layout,table.layout td.layout-cell{border:1px dotted #ccc}table.confluenceTable{margin-bottom:0}.find-current{background-color:inherit;color:inherit}.find-current[data-searching]{border-radius:5px;background-clip:padding-box;box-shadow:0 2px 2px #ccc;background-color:#ffde00;margin:-2px;padding:2px;position:relative}",""])},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAONJREFUeNpi/P//PwM1ARMDlQHVDWRB5mzbtg3D/9+/f0fhf/v2Dc6OjY1lRFfPCAtDkGHa2toMV69eZTAxMSHKNRs2bGBIS0tjxOlCcXFxsIF8fHzU8fK+ffvANCsrK+UGenl5gZ2+du1acBh8+fKF4cOHD1g1CQgIMPDw8BB2ITIAacClCQY+ffpEvIED4kKiDISls8HrQpjrqJIOYVkN5tWdO3fijE0Q+Pr1K0NjYyM4mdXX1zPidOHjx4/hbHd3d7wuAqndu3cvZl5GBiBbubm5cboKHcBch9PA4V3AAgQYAMuAZaztNwK5AAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/gif;base64,R0lGODlhEAAQAMQAAP///+7u7t3d3bu7u6qqqpmZmYiIiHd3d2ZmZlVVVURERDMzMyIiIhEREQARAAAAAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFBwAQACwAAAAAEAAQAAAFdyAkQgGJJOWoQgIjBM8jkKsoPEzgyMGsCjPDw7ADpkQBxRDmSCRetpRA6Rj4kFBkgLC4IlUGhbNQIwXOYYWCXDufzYPDMaoKGBoKb886OjAKdgZAAgQkfCwzAgsDBAUCgl8jAQkHEAVkAoA1AgczlyIDczUDA2UhACH5BAUHABAALAAAAAAPABAAAAVjICSO0IGIATkqIiMKDaGKC8Q49jPMYsE0hQdrlABCGgvT45FKiRKQhWA0mPKGPAgBcTjsspBCAoH4gl+FmXNEUEBVAYHToJAVZK/XWoQQDAgBZioHaX8igigFKYYQVlkCjiMhACH5BAUHABAALAAAAAAQAA8AAAVgICSOUGGQqIiIChMESyo6CdQGdRqUENESI8FAdFgAFwqDISYwPB4CVSMnEhSej+FogNhtHyfRQFmIol5owmEta/fcKITB6y4choMBmk7yGgSAEAJ8JAVDgQFmKUCCZnwhACH5BAUHABAALAAAAAAQABAAAAViICSOYkGe4hFAiSImAwotB+si6Co2QxvjAYHIgBAqDoWCK2Bq6A40iA4yYMggNZKwGFgVCAQZotFwwJIF4QnxaC9IsZNgLtAJDKbraJCGzPVSIgEDXVNXA0JdgH6ChoCKKCEAIfkEBQcAEAAsAAAAABAADgAABUkgJI7QcZComIjPw6bs2kINLB5uW9Bo0gyQx8LkKgVHiccKVdyRlqjFSAApOKOtR810StVeU9RAmLqOxi0qRG3LptikAVQEh4UAACH5BAUHABAALAAAAAAQABAAAAVxICSO0DCQKBQQonGIh5AGB2sYkMHIqYAIN0EDRxoQZIaC6bAoMRSiwMAwCIwCggRkwRMJWKSAomBVCc5lUiGRUBjO6FSBwWggwijBooDCdiFfIlBRAlYBZQ0PWRANaSkED1oQYHgjDA8nM3kPfCmejiEAIfkEBQcAEAAsAAAAABAAEAAABWAgJI6QIJCoOIhFwabsSbiFAotGMEMKgZoB3cBUQIgURpFgmEI0EqjACYXwiYJBGAGBgGIDWsVicbiNEgSsGbKCIMCwA4IBCRgXt8bDACkvYQF6U1OADg8mDlaACQtwJCEAIfkEBQcAEAAsAAABABAADwAABV4gJEKCOAwiMa4Q2qIDwq4wiriBmItCCREHUsIwCgh2q8MiyEKODK7ZbHCoqqSjWGKI1d2kRp+RAWGyHg+DQUEmKliGx4HBKECIMwG61AgssAQPKA19EAxRKz4QCVIhACH5BAUHABAALAAAAAAQABAAAAVjICSOUBCQqHhCgiAOKyqcLVvEZOC2geGiK5NpQBAZCilgAYFMogo/J0lgqEpHgoO2+GIMUL6p4vFojhQNg8rxWLgYBQJCASkwEKLC17hYFJtRIwwBfRAJDk4ObwsidEkrWkkhACH5BAUHABAALAAAAQAQAA8AAAVcICSOUGAGAqmKpjis6vmuqSrUxQyPhDEEtpUOgmgYETCCcrB4OBWwQsGHEhQatVFhB/mNAojFVsQgBhgKpSHRTRxEhGwhoRg0CCXYAkKHHPZCZRAKUERZMAYGMCEAIfkEBQcAEAAsAAABABAADwAABV0gJI4kFJToGAilwKLCST6PUcrB8A70844CXenwILRkIoYyBRk4BQlHo3FIOQmvAEGBMpYSop/IgPBCFpCqIuEsIESHgkgoJxwQAjSzwb1DClwwgQhgAVVMIgVyKCEAIfkECQcAEAAsAAAAABAAEAAABWQgJI5kSQ6NYK7Dw6xr8hCw+ELC85hCIAq3Am0U6JUKjkHJNzIsFAqDqShQHRhY6bKqgvgGCZOSFDhAUiWCYQwJSxGHKqGAE/5EqIHBjOgyRQELCBB7EAQHfySDhGYQdDWGQyUhADs="},function(e,t,n){var o=n(70);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(11)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){t=e.exports=n(10)(!1);var o=n(34)(n(71));t.push([e.i,"#insert-image-dialog.aui-dialog .dialog-panel-body{overflow:hidden;position:relative;padding:10px 10px 0}#insert-image-dialog.aui-dialog .dialog-panel-body .aui-message p{margin-top:0}#insert-image-dialog.aui-dialog .dialog-panel-body .aui-message ul{padding-left:15px;margin:0}#insert-image-dialog.aui-dialog .dialog-panel-body .aui-message ul.one-message{padding-left:0}#insert-image-dialog.aui-dialog .dialog-panel-body .aui-message ul.one-message li{list-style:none}#insert-image-dialog.aui-dialog .dialog-panel-body.web-image-panel{overflow:auto}#insert-image-dialog.aui-dialog .dialog-panel-body .no-files{margin-top:0}#insert-image-dialog.aui-dialog .dialog-panel-body .message-handler{margin-right:10px;margin-bottom:10px}#insert-image-dialog.aui-dialog .aui-progress-indicator,#insert-image-dialog.aui-dialog .aui-progress-indicator .aui-progress-indicator-value{height:4px;border-radius:0}#insert-image-dialog.aui-dialog .scroll-wrapper{position:relative}#insert-image-dialog.aui-dialog .divider{border-top:1px solid #ccc;width:110%;height:1px;margin-left:-10px}#insert-image-dialog.aui-dialog .search-panel-wrapper{height:100%}#upload-attachment form{padding:0}#upload-attachment form .invisible{height:1px;width:1px;opacity:0;z-index:1}#upload-attachment .file-upload-icon{vertical-align:text-bottom}.attach-tip-discovery{position:relative;border-top:1px solid #ccc;padding-top:20px;margin-right:10px;margin-top:10px;margin-bottom:20px;overflow:hidden;color:#707070}.attach-tip-discovery .img{display:block;width:50px;height:50px;float:left;margin-right:15px;background-image:url("+o+');background-repeat:no-repeat;background-size:50px 50px}.attach-tip-discovery .text p{display:inline}.attach-tip-discovery a{text-decoration:none}#attached-files{padding:10px 0}.file-list,.image-list{padding:0;list-style:none;overflow:hidden;margin-top:0}.file-list li,.image-list li{width:23%;cursor:default;float:left;margin:0 10px 8px 0;padding:0;text-align:center}.file-list li .caption,.image-list li .caption{text-overflow:ellipsis;display:block;overflow:hidden;white-space:nowrap;margin:0 auto;font-size:12px}.file-list li .owner-title,.image-list li .owner-title{font-size:10px}.file-list li .image-preview-throbber,.image-list li .image-preview-throbber{text-align:center;padding:0;position:absolute;top:50%;left:50%;margin-top:-10px;margin-left:-10px}.file-list li .file-container,.file-list li .image-container,.image-list li .file-container,.image-list li .image-container{border-radius:3px;background-color:#f5f5f5;border:1px solid #f5f5f5;padding:5px;margin-bottom:5px;position:relative;vertical-align:top;box-sizing:border-box;height:90px}.file-list li .file-container img,.file-list li .image-container img,.image-list li .file-container img,.image-list li .image-container img{width:auto;height:auto;position:relative;top:50%;transform:translateY(-50%);box-shadow:0 1px 3px rgba(0,0,0,.2);max-width:100%;max-height:100%}.file-list li .file-container .thumbnail,.file-list li .image-container .thumbnail,.image-list li .file-container .thumbnail,.image-list li .image-container .thumbnail{position:relative;top:50%;transform:translateY(-50%);background-image:none;display:inline-block}.file-list li .aui-progress-indicator,.image-list li .aui-progress-indicator{position:absolute;top:50%;left:10%;width:80%;z-index:2;transform:translateY(-50%)}.file-list li .overlay,.image-list li .overlay{width:100%;height:100%;display:none;position:absolute;z-index:1;background-color:rgba(0,0,0,.8);top:0;left:0}.file-list li .abs-icon,.image-list li .abs-icon{width:20px;height:20px;line-height:20px;border:1px solid #ccc;box-sizing:border-box;border-radius:3px;position:absolute;outline:none;display:none;cursor:pointer;color:#707070;background-color:#fff;background-repeat:no-repeat;background-position:50%;vertical-align:text-bottom;text-indent:-999em}.file-list li .abs-icon.zoom,.image-list li .abs-icon.zoom{top:5px;right:27px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAeElEQVQoz62Ovw1AYBTEz0pKWqUZPhNI7p4V6CzBPGIBo0g8xReJwuvctb/7A/wuHfTH30CniT2XEAAASzq1hYAGXlqtiiYaumYvrA0bWAMAS+2v5+pyOso4R0ADPae/gN4SL81xw6JTqxcx4NqsspZlCGS/nv+mG6d9RJUXBH/5AAAAAElFTkSuQmCC")}.file-list li .abs-icon.select,.image-list li .abs-icon.select{top:5px;right:5px}.file-list li .abs-icon.cancel,.image-list li .abs-icon.cancel{width:16px;height:16px;line-height:16px;top:5px;right:5px;border:0;color:#fff}.file-list li .abs-icon.select,.image-list li .abs-icon.select{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAW0lEQVQYlWP4jwYYSBPYewFV4FhBL4rA+aLaV8gC14srnyKbca+s/AHU0HdT3v3//6Sy5BbMlukFTe9e1RRfhlv7ZUJBU2PhGSR3/JpXUHAUxWH/1u8h1y8gAADgQu+TLTiA3gAAAABJRU5ErkJggg==")}.file-list li .abs-icon.cancel,.image-list li .abs-icon.cancel{display:block;background-color:initial}.file-list li.loading,.image-list li.loading{color:#707070}.file-list li.loading .overlay,.image-list li.loading .overlay{display:block}.file-list li.loading .cancel,.image-list li.loading .cancel{z-index:2}.file-list li.hover,.file-list li:hover,.image-list li.hover,.image-list li:hover{cursor:pointer}.file-list li.hover .select,.file-list li.hover .zoom,.file-list li:hover .select,.file-list li:hover .zoom,.image-list li.hover .select,.image-list li.hover .zoom,.image-list li:hover .select,.image-list li:hover .zoom{display:block}.file-list li.selected .select,.image-list li.selected .select{display:block;background-color:#3572b0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAgUlEQVR4AcXKrw5BcRzG4e803QWcRDRN0CRJMkU3V8BluBFXoEiSizDJFIKZMR7bUfw5v2jeT3nDE3+csZ4QobghVmnQd7NVTYGOi726KAYtJ0dN8QoyC1n+Gg7O2uIdzLGWqdm56opPULHMycbdQHyDUDYDI1EMQsnURCTBs1+ABxXN3umBGxghAAAAAElFTkSuQmCC");border:0}.file-list li.selected.hover .select,.file-list li.selected:hover .select,.image-list li.selected.hover .select,.image-list li.selected:hover .select{background-color:#3572b0}.file-list li.current .file-container,.file-list li.hover .file-container,.file-list li.selected .file-container,.file-list li:hover .file-container,.image-list li.current .file-container,.image-list li.hover .file-container,.image-list li.selected .file-container,.image-list li:hover .file-container{background-color:#ebf2f9;border-color:#ebf2f9}.file-list li.current .caption,.file-list li.hover .caption,.file-list li.selected .caption,.file-list li:hover .caption,.image-list li.current .caption,.image-list li.hover .caption,.image-list li.selected .caption,.image-list li:hover .caption{color:#000}.file-list li.current .file-container,.image-list li.current .file-container{border:1px solid #ccc}.file-list li.last,.file-list li:nth-child(4n),.image-list li.last,.image-list li:nth-child(4n){margin-right:0}ul.image-list li{width:175px}ul.image-list li.image-effect-preview.hover{background-color:#e9e9e9;border:0}ul.image-list li.image-effect-preview .caption{font-size:14px}ul.image-list li.image-effect-preview.selected{background-color:#3572b0;border:0}ul.image-list li.image-effect-preview.selected .caption{color:#fff;font-weight:700;font-size:14px;width:145px}ul.image-list li.image-effect-preview .image-container{margin:0 15px 5px;padding:0;width:145px;height:auto}ul.image-list li.image-effect-preview .image-container img{box-shadow:none;position:static;transform:translate(0)}#image-properties-dialog .image-effects-panel ul.image-list .image-container{height:auto}.svg-icon:before{display:none;content:""}.svg-icon.size-48{width:48px;height:48px}.svg-icon.aui-iconfont-file-image.size-48{background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTAgNC4wMXYzOS45OEE0LjAxIDQuMDEgMCAwMDQuMDEgNDhoMzkuOThBNC4wMSA0LjAxIDAgMDA0OCA0My45OVY0LjAxQTQuMDEgNC4wMSAwIDAwNDMuOTkgMEg0LjAxQTQuMDEgNC4wMSAwIDAwMCA0LjAxek00My45OSAxQTMuMDEgMy4wMSAwIDAxNDcgNC4wMXYzOS45OEEzLjAxIDMuMDEgMCAwMTQzLjk5IDQ3SDQuMDFBMy4wMSAzLjAxIDAgMDExIDQzLjk5VjQuMDFBMy4wMSAzLjAxIDAgMDE0LjAxIDFoMzkuOTh6TTI5LjkgMTkuNTZsLTEuNjgxIDMgLjQwMi0zLjQxNWE1LjY4MyA1LjY4MyAwIDAxLTEuNzc3LTEuMjkzbC0zLjEyNSAxLjQzOCAyLjMzMy0yLjUyNmE1LjYzIDUuNjMgMCAwMS0uNjgtMi4wOTFMMjIgMTRsMy4zNzMtLjY3M2E1LjYzIDUuNjMgMCAwMS42NzktMi4wOUwyMy43MTkgOC43MWwzLjEyNSAxLjQzOGMuNS0uNTM5IDEuMTAyLS45OCAxLjc3Ny0xLjI5M0wyOC4yMiA1LjQ0bDEuNjgyIDNhNS42OTUgNS42OTUgMCAwMTIuMTk4IDBsMS42ODItMy0uNDAyIDMuNDE1YTUuNjgzIDUuNjgzIDAgMDExLjc3NyAxLjI5M2wzLjEyNS0xLjQzOC0yLjMzMyAyLjUyNmE1LjYzIDUuNjMgMCAwMS42OCAyLjA5MUw0MCAxNGwtMy4zNzMuNjczYTUuNjMgNS42MyAwIDAxLS42NzkgMi4wOWwyLjMzMyAyLjUyNy0zLjEyNS0xLjQzOGMtLjUuNTM5LTEuMTAyLjk4LTEuNzc3IDEuMjkzbC40MDIgMy40MTUtMS42ODItM2E1LjY5NSA1LjY5NSAwIDAxLTIuMTk4IDB6TTI2LjMzNCAxNGE0LjY2NyA0LjY2NyAwIDExOS4zMzQgMCA0LjY2NyA0LjY2NyAwIDAxLTkuMzM0IDB6bTEuNDg0IDIwLjY4M0wzMyA0MmwtLjUgMUwxNiAxOS41IDUuNSAzMiA1IDMxbDExLTEzIDExLjE5NSAxNS44MDVMMzUgMjZsOCAxMC0uNSAxLTcuNS05LjUtNy4xODMgNy4xODN6IiBmaWxsPSIjNzE3MTcxIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=")}.svg-icon.aui-iconfont-file-pdf.size-48{background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTQzLjk5IDBINC4wMUE0LjAwOSA0LjAwOSAwIDAwMCA0LjAxdjM5Ljk4QTQuMDA5IDQuMDA5IDAgMDA0LjAxIDQ4aDM5Ljk4QTQuMDA5IDQuMDA5IDAgMDA0OCA0My45OVY0LjAxQTQuMDA5IDQuMDA5IDAgMDA0My45OSAwek00LjAxIDQ3QTMuMDEgMy4wMSAwIDAxMSA0My45OVYxNC45ODVjOS4zODQtLjA3NyAxOS4xMzItMi4zMjUgMjktNi43MTJWNDdINC4wMXpNNDAgNDdoLTRWMTZoMy41MDJjLjI3NCAwIC40OTguMjIxLjQ5OC40OTNWNDd6bS01IDBoLTRWMTJoMy41MDJhLjUuNSAwIDAxLjQ5OC41VjQ3em04Ljk5IDBINDFWMTYuNDkzQzQxIDE1LjY3IDQwLjMyOCAxNSAzOS41MDIgMTVIMzZ2LTIuNWExLjUgMS41IDAgMDAtMS40OTgtMS41SDMxVjYuNzI0bC0uNzA3LjMyMUMyMC4zMTUgMTEuNTgxIDEwLjQ2NCAxMy45MDYgMSAxMy45ODVWNC4wMUEzLjAxIDMuMDEgMCAwMTQuMDEgMWgzOS45OEEzLjAxIDMuMDEgMCAwMTQ3IDQuMDF2MzkuOThBMy4wMSAzLjAxIDAgMDE0My45OSA0N3pNNSAyNGM4LjUtLjUgMTItMSAyMC00di0xYy04IDMtMTIgMy41LTIwIDR2MXptMCA2YzguNS0uNSAxMi0xIDIwLTR2LTFjLTggMy0xMiAzLjUtMjAgNHYxem0wIDZjOC41LS41IDEyLTEgMjAtNHYtMWMtOCAzLTEyIDMuNS0yMCA0djF6bTAgNmM4LjUtLjUgMTItMSAyMC00di0xYy04IDMtMTIgMy41LTIwIDR2MXoiIGZpbGw9IiM3MzZGNkUiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==")}.svg-icon.aui-iconfont-file-txt.size-48{background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTAgNC4wMXYzOS45OEE0LjAxIDQuMDEgMCAwMDQuMDEgNDhoMzkuOThBNC4wMSA0LjAxIDAgMDA0OCA0My45OVY0LjAxQTQuMDEgNC4wMSAwIDAwNDMuOTkgMEg0LjAxQTQuMDEgNC4wMSAwIDAwMCA0LjAxek00My45OSAxQTMuMDEgMy4wMSAwIDAxNDcgNC4wMXYzOS45OEEzLjAxIDMuMDEgMCAwMTQzLjk5IDQ3SDQuMDFBMy4wMSAzLjAxIDAgMDExIDQzLjk5VjQuMDFBMy4wMSAzLjAxIDAgMDE0LjAxIDFoMzkuOTh6TTUgMzF2MWgzOHYtMUg1em0wLTE0djFoMzN2LTFINXptMC03djFoMjh2LTFINXptMCAxNHYxaDI0di0xSDV6bTAgMTR2MWgyOHYtMUg1eiIgZmlsbD0iIzcwNzA3MCIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+")}.svg-icon.aui-iconfont-file-doc.size-48{background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTAgNC4wMXYzOS45OEE0LjAwOSA0LjAwOSAwIDAwNC4wMSA0OGgzOS45OEE0LjAwOSA0LjAwOSAwIDAwNDggNDMuOTlWNC4wMUE0LjAwOSA0LjAwOSAwIDAwNDMuOTkgMEg0LjAxQTQuMDA5IDQuMDA5IDAgMDAwIDQuMDF6TTQzLjk5IDFBMy4wMSAzLjAxIDAgMDE0NyA0LjAxdjM5Ljk4QTMuMDEgMy4wMSAwIDAxNDMuOTkgNDdINC4wMUEzLjAwOSAzLjAwOSAwIDAxMSA0My45OVY0LjAxQTMuMDEgMy4wMSAwIDAxNC4wMSAxaDM5Ljk4ek01IDM5aDI4di0xSDV2MXptMC03aDMydi0xSDV2MXptMC0yMWgxN3YtMUg1djF6bTAgN2gxNHYtMUg1djF6bTAgN2gxOXYtMUg1djF6bTM2LjAwOC0xNUgyOS45OTJjLTEuMSAwLTEuOTkyLjg5NC0xLjk5MiAxLjk5MnYxMS4wMTZjMCAxLjEwMS44OTQgMS45OTIgMS45OTIgMS45OTJoMTEuMDE2YzEuMSAwIDEuOTkyLS44OTMgMS45OTItMS45OTJWMTEuOTkyYzAtMS4xLS44OTQtMS45OTItMS45OTItMS45OTJ6TTI5Ljk5MiAyNGEuOTkyLjk5MiAwIDAxLS45OTItLjk5MlYyMWwzLTMuNSA1IDYuNWgtNy4wMDh6bTExLjAxNiAwaC0yLjg5MWwtMS4wOTgtMS40MzUgMi40NjUtMi4wNjUgMi40MzMgMi45MDFhLjk5Mi45OTIgMCAwMS0uOTA5LjU5OXpNNDIgMjEuOTJMMzkuNDg0IDE5bC0zLjEzIDIuNjk1TDMyIDE2bC0zIDMuNXYtNy41MDhjMC0uNTQ3LjQ0NS0uOTkyLjk5Mi0uOTkyaDExLjAxNmMuNTQ3IDAgLjk5Mi40NDUuOTkyLjk5MnY5LjkyOHptLTEuNzY0LTkuMTAzbC0xLjk3Ni42MDYtLjc2LTEuOTIzLS43NiAxLjkyMy0xLjk3Ni0uNjA2IDEuMDMgMS43OTQtMS43MDYgMS4xNjggMi4wNDQuMzEyLS4xNTEgMi4wNjNMMzcuNSAxNi43NWwxLjUxOSAxLjQwNC0uMTUxLTIuMDYzIDIuMDQ0LS4zMTItMS43MDYtMS4xNjggMS4wMy0xLjc5NHpNMzcuNSAxNi4zYTEuMyAxLjMgMCAxMTAtMi42IDEuMyAxLjMgMCAwMTAgMi42eiIgZmlsbD0iIzcwNzA3MCIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+")}.svg-icon.aui-iconfont-file-xls.size-48{background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTAgNC4wMXYzOS45OEE0LjAwOSA0LjAwOSAwIDAwNC4wMSA0OGgzOS45OEE0LjAwOSA0LjAwOSAwIDAwNDggNDMuOTlWNC4wMUE0LjAwOSA0LjAwOSAwIDAwNDMuOTkgMEg0LjAxQTQuMDA5IDQuMDA5IDAgMDAwIDQuMDF6TTQ3IDE2VjQuMDFBMy4wMSAzLjAxIDAgMDA0My45OSAxSDE2djE1aDMxem0wIDF2MTBIMzJWMTdoMTV6bTAgMTF2MTBIMzJWMjhoMTV6bTAgMTF2NC45OUEzLjAxIDMuMDEgMCAwMTQzLjk5IDQ3SDMydi04aDE1em0tMTYgOEgxNnYtOGgxNXY4em0tMTYgMEg0LjAxQTMuMDEgMy4wMSAwIDAxMSA0My45OVYxN2gxNHYzMHpNMSAxNlY0LjAxQTMuMDEgMy4wMSAwIDAxNC4wMSAxSDE1djE1SDF6bTE1IDEyaDE1djEwSDE2VjI4em0wLTExaDE1djEwSDE2VjE3eiIgZmlsbD0iIzcwNzA3MCIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+")}.svg-icon.aui-iconfont-file-ppt.size-48{background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTAgNC4wMXYzOS45OEE0LjAxIDQuMDEgMCAwMDQuMDEgNDhoMzkuOThBNC4wMSA0LjAxIDAgMDA0OCA0My45OVY0LjAxQTQuMDEgNC4wMSAwIDAwNDMuOTkgMEg0LjAxQTQuMDEgNC4wMSAwIDAwMCA0LjAxek00My45OSAxQTMuMDEgMy4wMSAwIDAxNDcgNC4wMXYzOS45OEEzLjAxIDMuMDEgMCAwMTQzLjk5IDQ3SDQuMDFBMy4wMSAzLjAxIDAgMDExIDQzLjk5VjQuMDFBMy4wMSAzLjAxIDAgMDE0LjAxIDFoMzkuOTh6TTI4IDEydjFoMTV2LTFIMjh6bTAgNnYxaDE1di0xSDI4em0tMiA2djFoMTd2LTFIMjZ6TTUgMzh2MWgzOHYtMUg1em0wLTd2MWgzOHYtMUg1em0wLTE0LjVhOS41IDkuNSAwIDAwOS41IDkuNSA5LjUgOS41IDAgMDA5LjUtOS41QTkuNSA5LjUgMCAwMDE0LjUgNyA5LjUgOS41IDAgMDA1IDE2LjV6bTEgMGE4LjUgOC41IDAgMDE4LTguNDg1djguMTM4bC03LjYyMyAyLjg1OUE4LjUwOSA4LjUwOSAwIDAxNiAxNi41em04LjUgOC41YTguNTAyIDguNTAyIDAgMDEtNy43NzItNS4wNTJsNy42NDYtMi44NjcgNS43NzMgNS43NzNBOC40NyA4LjQ3IDAgMDExNC41IDI1em02LjM1My0yLjg1M0wxNSAxNi4yOTNWOC4wMTVhOC41IDguNSAwIDAxNS44NTMgMTQuMTMyeiIgZmlsbD0iIzcwNzA3MCIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+")}.svg-icon.aui-iconfont-file-code.size-48{background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTAgNC4wMXYzOS45OEE0LjAxIDQuMDEgMCAwMDQuMDEgNDhoMzkuOThBNC4wMSA0LjAxIDAgMDA0OCA0My45OVY0LjAxQTQuMDEgNC4wMSAwIDAwNDMuOTkgMEg0LjAxQTQuMDEgNC4wMSAwIDAwMCA0LjAxek00My45OSAxQTMuMDEgMy4wMSAwIDAxNDcgNC4wMXYzOS45OEEzLjAxIDMuMDEgMCAwMTQzLjk5IDQ3SDQuMDFBMy4wMSAzLjAxIDAgMDExIDQzLjk5VjQuMDFBMy4wMSAzLjAxIDAgMDE0LjAxIDFoMzkuOTh6TTYgMTcuNWwxMC0xMCAuNSAxLTkgOSA5IDktLjUgMS0xMC0xMHptMzcgMTJsLTEwLTEwLS41IDEgOSA5LTkgOSAuNSAxIDEwLTEwek0xOCA0Mi45NjJoMUwzMCA2aC0xTDE4IDQyLjk2MnoiIGZpbGw9IiM3MDcwNzAiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==")}.svg-icon.aui-iconfont-file-video.size-48{background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTQzLjk5IDBINC4wMUE0LjAwOSA0LjAwOSAwIDAwMCA0LjAxdjM5Ljk4QTQuMDA5IDQuMDA5IDAgMDA0LjAxIDQ4aDM5Ljk4QTQuMDA5IDQuMDA5IDAgMDA0OCA0My45OVY0LjAxQTQuMDA5IDQuMDA5IDAgMDA0My45OSAwek00NyAxMXYzMi45OUEzLjAxIDMuMDEgMCAwMTQzLjk5IDQ3SDQuMDFBMy4wMSAzLjAxIDAgMDExIDQzLjk5TDEuMDMxIDExSDQ3em0tMTIuNzkyLTFoLTUuMzMxbDguODU2LTloNS4zMzFsLTguODU2IDl6bS03IDBoLTUuMzMxbDguODU2LTloNS4zMzFsLTguODU2IDl6bS03IDBoLTUuMzMxbDguODU2LTloNS4zMzFsLTguODU2IDl6bS03IDBINy44NzdsOC44NTYtOWg1LjMzMWwtOC44NTYgOXptLTcgMEgxLjAzMnYtLjI1MUw5LjcyNiAxaDUuMzM4bC04Ljg1NiA5ek0xIDQuMDFBMy4wMSAzLjAxIDAgMDE0LjAxIDFoMy45OTNMMSA4LjA0OFY0LjAxek00Mi45NzQgMTBMNDcgNS45MzNWMTBoLTQuMDI2em0tNy4wOTcgMGw4Ljc4My04LjkyNUM0NiAxLjM3OSA0NyAyLjU3NyA0NyA0LjEyNkw0MS4xODYgMTBoLTUuMzA5ek0xOSAzOWwxMi0xMC41TDE5IDE5djIwem0xLTE4bDkuNSA3LjVMMjAgMzdWMjF6IiBmaWxsPSIjNzA3MDcwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=")}.svg-icon.aui-iconfont-file-zip.size-48{background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTAgNC4wMXYzOS45OEE0LjAxIDQuMDEgMCAwMDQuMDEgNDhoMzkuOThBNC4wMSA0LjAxIDAgMDA0OCA0My45OVY0LjAxQTQuMDEgNC4wMSAwIDAwNDMuOTkgMEg0LjAxQTQuMDEgNC4wMSAwIDAwMCA0LjAxek00My45OSAxQTMuMDEgMy4wMSAwIDAxNDcgNC4wMXYzOS45OEEzLjAxIDMuMDEgMCAwMTQzLjk5IDQ3SDQuMDFBMy4wMSAzLjAxIDAgMDExIDQzLjk5VjQuMDFBMy4wMSAzLjAxIDAgMDE0LjAxIDFoMzkuOTh6TTIwIDMxLjAwMnY4Ljk5QzIwIDQxLjEgMjAuODg3IDQyIDIxLjk5OCA0Mmg0LjAwNEEyLjAwNSAyLjAwNSAwIDAwMjggMzkuOTkxdi04Ljk4OWMwLS41NTMtLjQ1My0xLjAwMi0uOTk3LTEuMDAyaC02LjAwNmMtLjU1IDAtLjk5Ny40NTYtLjk5NyAxLjAwMnpNMjcuMDAzIDMxYy0uMDA2IDAtLjAwMyA4Ljk5MS0uMDAzIDguOTkxIDAgLjU1Ny0uNDUgMS4wMDktLjk5OCAxLjAwOWgtNC4wMDRBLjk5OC45OTggMCAwMTIxIDM5Ljk5MXYtOC45ODlMMjcuMDAzIDMxek0yMiAzNy45OTl2MS4wMDJjMCAuNTUyLjQ0My45OTkgMS4wMS45OTloMS45OGMuNTU4IDAgMS4wMS0uNDQzIDEuMDEtLjk5OXYtMS4wMDJBLjk5OS45OTkgMCAwMDI0Ljk5IDM3aC0xLjk4Yy0uNTU4IDAtMS4wMS40NDMtMS4wMS45OTl6bTIuOTkuMDAxYy4wMTIgMCAuMDEtLjAwMi4wMS0uMDAxdjEuMDAyTDI0Ljk5IDM5aC0xLjk4Yy0uMDEyIDAtLjAxLjAwMi0uMDEuMDAxdi0xLjAwMmwuMDEuMDAxaDEuOTh6TTIwIDZ2MWg1VjZoLTV6bTAtNHYxaDVWMmgtNXptMyA2djFoNVY4aC01em0wLTR2MWg1VjRoLTV6bS0zIDZ2MWg1di0xaC01em0zIDJ2MWg1di0xaC01em0tMyAydjFoNXYtMWgtNXptMyAydjFoNXYtMWgtNXptLTMgMnYxaDV2LTFoLTV6bTAgNHYxaDV2LTFoLTV6bTAgNHYxaDV2LTFoLTV6bTMtNnYxaDV2LTFoLTV6bTAgNHYxaDV2LTFoLTV6bTAgNHYxaDV2LTFoLTV6IiBmaWxsPSIjNzA3MDcwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=")}.svg-icon.aui-iconfont-file-generic.size-48{background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTAgNC4wMXYzOS45OEE0LjAxIDQuMDEgMCAwMDQuMDEgNDhoMzkuOThBNC4wMSA0LjAxIDAgMDA0OCA0My45OVY0LjAxQTQuMDEgNC4wMSAwIDAwNDMuOTkgMEg0LjAxQTQuMDEgNC4wMSAwIDAwMCA0LjAxek00My45OS45OEEzLjAxIDMuMDEgMCAwMTQ3IDMuOTkxdjQwLjAxNmEzLjAxIDMuMDEgMCAwMS0zLjAxIDMuMDEzSDQuMDFBMy4wMSAzLjAxIDAgMDExIDQ0LjAwOFYzLjk5MkEzLjAxIDMuMDEgMCAwMTQuMDEuOTc5aDM5Ljk4ek0xOSAzMC45OTVDMTkgMzQgMjEgMzYgMjQgMzZzNS0yIDUtNVYxMy45ODZjMC0zLjk4Ni0zLTYuOTk3LTcuMDA0LTYuOTk3UzE0Ljk5MiAxMCAxNC45OTIgMTMuOTl2MTguMDA1YzAgNS4wMDUgNCA5IDkuMDA0IDlBOC45NjMgOC45NjMgMCAwMDMzIDMxLjk4MlYxMi45OTRoLTF2MTguOTg4YzAgNC41MTgtMy41IDguMDEzLTguMDA0IDguMDEzcy04LjAwNC0zLjQ5NS04LjAwNC04VjEzLjk5YzAtMy40OSAyLjUtNiA2LjAwNC02QzI1LjUgNy45OSAyOCAxMC41IDI4IDEzLjk4NVYzMWMwIDIuNS0yIDQtNCA0cy00LTEuNS00LTQuMDA0VjIwaC0xdjEwLjk5NnoiIGZpbGw9IiM3MDcwNzAiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==")}',""])},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGEAAABgCAIAAACCOItRAAALGElEQVR4Ae2ai1cTxx7H+7/ee0572qprtUW9gq+T+giicPWktnhFqpeigDwOPkLL44KNiJqLqIiCFPISMOGVTWJIMvfL/s6u2x2g2cck2Xv4HM3ZnVlmdz77m9mdmf2MGVgJjXY2X6iukjapAvi18O/wPgkcrPFcbu+fWs4wN6N3lJm645PE4GkPrLreUS52/6QklC+Ptbz56GJH8qPTkp49VZ6fu/1DgcCwVQb8/t86Wxq+lfR8/n3XkksdZUebJR11v07IzClyoaEWSceJhzE3Ooq1fi1pNI4nmNNkX/bqLNU/L7jO0bz/UxO7McbEEGn1SCpNU7LbHE11qRdfM7jORJGcqN0rEb6pVZc5Wu7TnvfeZ1lWBJnFxcVEYnWDmSJ256BEfNMx6TJH7zs82kOniPube32tho4/MjjLTCCPnHCto4UOr6Tw1TE4MhEOe6ua53Ydbd+t1A8P44le9fv6riOeXOyXzTjyTiy/bTra/C6/62jbqnqerCUedw5vefyuo8yTuioc/FN384mGfnnX0ZZox+/recu2ZNdR6mEzHb+3Z9KOo6ScisZioU3mI5EIfi38w38Qi0XlJB4fhUpxxGb8dHz1r1bfj1rHQ2KQk2uV4SgX+nmPBDyDIYuOmv4TEkYsFkZAldtRcvLSXkww4S98r/O2HEUi4ZSc3NjYyFolnU6jzYbRVHUsLUTL7CjeXS+pHDERSvLA8T85yqZl5hzp7EZIRz6bLuM75GzjZkOrudJMpjxFTxXIXdWfHLFcljlNNs90lubK5YiCCKNf/waT/UckGgkXM7GYL8jdqqMDLWNMDMvJVEiF5TfK4Sg5SXNADS+VA6PDtED0t9q2v5zMz5Ijwe9HBcbmy+so1OFRhvttMd0k7KlNTaDm5kBwLrYJfudfBQOBwGhwIqyurMmZFdGOiDm1/04nV0ruaCVIOq7OULVzmcRieHYyUCftzNGOIG7oqhw35Sixtk5VzWVSzAyhhcWyOaKpNayRjU+Odf9UT61MXWiq8XoRYhpVl9v9CKIXwbHffsRu45J5R1o4RCLzLnEU7ScpGscbGtv7hv87HVqSM4xIxoKdzRRrxP7vvReqpf1Sm2zOkdatzGU3n+jzSKhwRzk5OqE874Gnoy/wOryYzrHtySTeTf7+oOtfvnoE1ymvr2sGpVqJI3p+h2Phio6jjfmx5nOSSk2f9ZOadURVnVeGvsmKdZSb7/FJOr67h5mQ0jmKxROoZ0pOxeMLlelIDl6poc748D7Koud9yRzh+DRVNSOvVaKj1EgjfTr0z3MwBTxDtk+3sPC+u6O9vr7+FDjtrauru3TpUldXFyqzdbddKOQUsFF5jnQDdAqif9teVn3//r3X6z21Dd3d3Yxjo8Coqtl0JfZHmefnJZWa9qkEK5o/FBhHa2vrqR0ZGhraorTQJhuV+g6Zi4feTk7OxvOsGDCJg1ZzUgd2kchUtHTNIAUX3FH6uXPnGhoaaJt2UcLy8nKE3gAqxhG/ll2soCtXrpzkOHv2LCwYHDEOLWvLEuCUhiNldkRfvVAcLTHTDA4OnlD5QUHb1TRpKYyD0jWamprQrxtKwG2ALGyUzVHy00ds3sdpZpaLFy8eV3j06JHWK505c4YSsYG60TZgHFrWwMAAI7gSaIO2cVgZHBU+fX9U1fUhx0yyZf3hRaubz+crxpEhnczyUIGIrJI6oqky4u+1fpmZ45gCrtuQjomkYxyMo5gscO3atdOnT+t3cUA+X8B6Ad6jGCsIdsQSNOtKHL83yXbATCXRLhxxNDs7yxcYDAbJhWpkVaQjMNUr6TjwQ+90qthGhzfmGgUEzg65BOMwm9XR0UGJKBlrs4UcyMdX1kKhP8Q6AtM3MOwwzBD5mosAF12tcPfuXcbx7Nmzah2Mw2wWeiKPx0PpuCtwgVGOsiY+K9oRyLy85ZXM8+rVK7piXDrflVKVHHQE2tvbKb2/vz+eSCxtssgKOeGOiLVxP1Y+zFJbW3tUobe3l3HcvHmTcgHjsJCF2KT0q1evluq5ZiQTeh64c72xfhNfMSCUtPpgAGEo7uHDh846ikajlI57U3pH1mlsbPyHQltbmyHr3bt3SCcYh+NZkYXFcDgMR6n1lbwCza6U3xFEHFHhQ0nLYkBkFl6XVlZW8Pl4TAXvoolE4uPHj+V3BDBwp+tG4yqLIwiCkdg2wF2pHc3MzNy+fftHhZGREdyrp0+fHlaALMPBGJoiHb8MFJ2FdKLILFxDbEfW19dL56inp+cwhz4Rl8t0kEF9Ip9lzZG+r4mqUMvSgguFUzqiDM2QtmkXwYV3UOcd3bp1q+qvQGQx22il7ZCFesKCwRHjiG4PSoBTJx29ePGiSgVTRWhxT548wRDf4Oj69evMNlQsfndwRJWEJlOOPnz4sLCwoO1SCQhJyMKGXUcYfH+nYLDQ19dH6RrMNmgjKBa//Ls7nQIjW30li3Gk75JgBH+olaBXhsOsO6KLw5ASF8r34kjXHGGXiQEl0ykQyFrdMB4pxpEhnczyUIGILCuOvlXgZ4sITNFjGEXH+P1+JgaUTKfAkgFfSVOOgKEN4vGn37Xi6KAChqlsG7CeQcdgZpqJAbMidIqxsTHsol044oh6bkOBqVTKtCOMkuj60HmzrZient7Zo/1O6qCK1t7RAdt3xHRgqECJKNm0o5aWlgMK/EyI3iMdwATw4MEDugCariVwtyM6GIfZLPREaHSUjuZszhG8YCRJV9nZ2bndrUZN8MsEoJ398ePHfJWcckShROlra2vmHAGsO3+jMjExwUoIvNB5sfxtyIrH48460mITPbdpR+Dy5cv7FTCqpNJLA9TQee/fv2/ISiaTzjrKZrOUjtcLK47Q4jBWosvFByHYLU0Q0Rlxav6MeCo55YjPsuKI/l5SKYEmuit0OgQRzs6PRSvOERgdHZVUMGnNRHLv3j060aFDh+AL143G5QJHtNq1T0WcJnSfUENnwScYdN2Y5eCXv6n7YKDYLPGOwI0bN/aqYBv1YU6DlTsqH4v9mPGJEFxzw64sy/pEPqsMjnhNmFF0VhNKwxwIFY5PU8I6qLnZRCtthywHHJGmPSoYkaNcB4OIisVMSPjP4J2I2QYNEEXhV6AjvjIE7rkjQQTjWoF45TVoYrZBA0Sx+OU/7KVTYNTmmCMwPj6OKYuvVexrQglUFGamtPcgXLTmCLtMDCiZToGJJCcdASz+Ya7yKxXsMhtoRWFp3/AGTBVACDAxaDGLgednIh7VmGmjul24cMGObs214TmApxtVgKbBRIBZEToFHojOO6Lqfany5s0bZgl8YUElYE7WkJXJZKgCGO4zAaB7CqugYxLiCGBRgGpoeY0EMUglBAKBLV9ecCcEOVpdXQ0pUJyKcjQ1NfWFguXJti9UqKHxtxo1wS8TAN0AgIYmxBFfSWYe3ED6W0y/0IC5ZMALCaIgFevocxVrYUh/e/78edxVPMtYqYAacoQ4dYcjfIiFy8V7MPrOUgYRbgzOKNxRUoWZB99W4Q8xqYwVxxAoiSaUDzX6IBLpSMCNBfwATdDjjB75rnFESxQl0EQDNDoLv97vAqBmXgXbqI+IIKLyaT2Sc+Q2TdQ3OR5EVDj6QVc64jWhSnghEBRErnTEV0a75wKCyOWOaF4BVXJQE0rggsjljmgKCW/DmiabjU4rCnNGrnfEv+9R3TDXY0e35hpluseR+ephRslmB4c5WfPf1brqSYcNy/ONO/Zr7neE8JlTsDzZNqeChuY2R+YraW1Olv6WW6fddcSFIVrc/7OjsIrNRTS2Pf8DLXWvw5qCl2YAAAAASUVORK5CYII="},function(e,t,n){var o=n(73);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(11)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,'#insert-image-dialog .loading-message,#insert-image-dialog .upload-in-progress,#insert-image-dialog ul.image-list li .loading,#searched-images .loading-message{background-image:url("data:image/gif;base64,R0lGODlhEAAQAPMPALu7u5mZmTMzM93d3REREQAAAHd3d1VVVWZmZqqqqoiIiO7u7kRERCIiIgARAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFBwAPACwAAAAAEAAQAEAEcPDJtyg6dUrFetDTIopMoSyFcxxD1krD8AwCkASDIlPaUDQLR6G1Cy0SgqIkE1IQGMrFAKCcGWSBzwPAnAwarcKQ15MpTMJYd1ZyUDXSDGelBY0qIoBh/ZoYGgELCjoxCRRvIQcGD1kzgSAgAACQDxEAIfkEBQcADwAsAAAAAA8AEAAABF3wyfkMkotOJpscRKJJwtM4ZgGMUtAQQcFNB/wQglUUWSYdD8FgAhiyZqxHAmEwrJKPwAGBeEI/gZFvkmAANYuBT8EQBRKDtFGsQQwAiYVVY8jCJXNMIHN/GJNpIxEAIfkEBQcADwAsAAAAABAADwAABFrwyfmColgiydpaQiY5x9MtZbZUT9Il0wBIhgALjKKEg1IUAw0hJRkEfoXZBIBYLQsXCUAXCGKckoRhK+q2vBiEAtsNGGYAwOcjcioG8MeATAnM4gtrBia3kiMAIfkEBQcADwAsAAAAABAAEAAABFzwySkDvdKsd5g8APYIBuch2CYRQBeiyyApiMwYQeAtFqEapIfqAWiIHiWKrLbYBBIJEYJAcIByAdkFUegKKKHLYDxQDRSW4wSQfYzVQskC0BweAbIm3C23w/UYEQAh+QQFBwAIACwAAAAAEAAOAAAERRDJiYyhWB5ZCs/c1iEEKBleF5DYQQBIIVheNWrFhtUrpWOCySBABAk6hZLlkiEga5IBBiDL9CjUjhSxNSEzXewvappEAAAh+QQFBwAOACwAAAAAEAAQAAAEa9DJ6QCg2K0klZHGkC0GpyiO0ojZgAznQKAUkIhKYBlC1TCSBUABWEwWg4NDwJIMOJQFI7CoIgcDIyZwODAUWKyWEmg0CIgoZiAIYK6UpwQYzFolhELSQRhnEgVKDlBqEw0FFyNrBW4Zjn4RACH5BAUHAA8ALAAAAAAQABAAAARc8Mn5xqBYAhkCz9yVeAEDSsoyPkyCWcuTAFaASMwtDXSGEAfM4oJBJBbIZCyTQCCCSlCCIRAYTpPDcYndPBBcjAHReCxughOhoHhceaDFmkiMOwoXh+u0OAjCEhEAIfkEBQcADgAsAQABAA8ADwAABFnQySEBkEnqWi9A2+ZdyOUspzZQTmI4w6Es9ICGhvBu96aYoSDAQMwENZ+D7ChZlIKLVXPQcOw2hYJCwagqHAxfwdBoBBzf0CA7IBAWgmOicHGjGkCV5nCMAAAh+QQFBwAPACwAAAAAEAAQAAAEXfDJ+daiWN43hgQbNlwdF4TU4nWL4mFWbAGJpAQZHCB4jgUvH2WgKAonA4Oy9mkAMK4ho1DoTRgEhcZREHgagQSC8Qg0EJLA0yYQ1HrBSWPRfhwcPsdXICHnNko5EQAh+QQFBwAOACwAAAEAEAAPAAAEWtDJ6daSg2ppJdha922ZNpTBCE6JAlxUSakOQtwImOyAUPwMUCDgWpwCBJkksHK8JguEgClp1BYNRsKhODgPBklCFjgwAIQtTCNwmB2G9gZgdTCCNeVGoQBFAAAh+QQFBwAPACwAAAEAEAAPAAAEWvDJSd+qeK5RB8fDRRWFspyotAAfQBbfNLCVUSSdKDV89gDAwcFBIBgywMRnkWBgcJWDJCZRIKAPwePIOAADCIkhIAFIyAkDYqD1EZzqR8AJoiMOp6PvTMZEAAAh+QQFBwAPACwAAAEADwAPAAAEWvBJQIa8+ILSspdHkXxS9wxF4Q3LaQbjtbBY4ABZKykCwyie2WBgaBiBuSGrBTh4cDLDg+BJKKBOIMIwTAROsNOEAFBIEZaHTi1APMyPhGF9cb+ljy8pHsNEAAA7");background-repeat:no-repeat}#insert-image-dialog .loading-message,#insert-image-dialog .upload-in-progress,#searched-images .loading-message{background-position:left 50%;height:20px;line-height:20px;padding-left:24px}#insert-image-dialog h2.dialog-title{white-space:normal}#insert-web-image-form fieldset.inline,#search-image-form fieldset.inline{padding:0;margin-right:-10px}#insert-web-image-form,#search-image-form,#upload-attachment{padding:0 0 10px}#attached-files,#attached-images,#searched-images{overflow:auto;margin-right:-10px}#upload-attachment .upfile{margin-left:8px;padding:0}#insert-web-image-form .web-image-input{display:inline}.insert-web-image .image-preview-area{margin-top:0}#insert-web-image-image-url{max-width:420px}.insert-web-image .image-preview-error{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABA0lEQVR42p2QP0tCURiH7zdQRA3u4OJUiyDY4CDtTuEXuXs0JEQ4uDk5C0EuKoEu+SWcg5baLCS7tNTx98IzyMWjXoeHe95/z3vODdzi2kdTvIo30fL1+YbLIhYOfsV5GsFAOL59zsNjBRfij60lEXKbf1E5RvDExl4URYGwXJfc6JCgwqZYhBp2hs5n4odadZ9gzKYu2x1YrUPt2SeosWEtijsEBfGN5HKXYErxweKkAMk9PbOkoE5hJXI+AbUVvfVtwZzkHTECAGptel8cgisSnyJDk+8GRlZ8MdOwxITghoa9ArhlZmzB+/abDjwh+c8+LBgRnMLEBHnxKJYpBpfMFDbGjWcGPFD11gAAAABJRU5ErkJggg==") 60px no-repeat;text-align:center}#insert-image-dialog .image-preview,#insert-web-image-image-url{margin-left:8px}.insert-web-image .image-preview-throbber{text-align:center;padding-top:50px}.insert-web-image .faraway{position:absolute;left:-9999em;top:-9999em}#search-image-form .search-input{display:inline}#search-image-form .search-input .search-image-text{max-width:250px}#search-image-form .aui-button,#search-image-space-select{margin-left:8px}',""])},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,".wiki-content .columnLayout{border-spacing:8px}.wiki-content .cell,.wiki-content .footer,.wiki-content .header{border:2px dashed #ccc;margin:8px;padding:4px 8px}.wiki-content .header,.wiki-content .header .innerCell{margin-bottom:0}.wiki-content .footer,.wiki-content .footer .innerCell{margin-top:0}.wiki-content .innerCell{outline:0;overflow:auto;overflow-y:hidden;height:100%}.section-decorator{display:table-cell;width:14px;overflow:visible}.section-decorator button{border:0;background:transparent;box-shadow:none;padding:7px 0;text-align:center;width:14px;height:20px;color:#aaa}.show-property-panel .icon{width:0;height:0;border-left:4px solid transparent;border-right:4px solid transparent;border-top:4px solid #333}.section-decorator .move-section{cursor:move}body.mceContentBody.pl2-contextual{margin:0;padding:0}.wiki-content .contentLayout2 .columnLayout{border-spacing:4px 2px;margin-top:0;margin-bottom:0}.wiki-content .contentLayout2 .cell{border:1px dashed #999;border-radius:5px;padding:0}.wiki-content .contentLayout2 .innerCell{padding:5px;min-height:20px}.wiki-content .contentLayout2>:first-child{margin-top:5px}",""])},function(e,t,n){var o=n(76);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(11)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,"#property-panel.page-layout-2-panel .icon-fat .icon,#rte-toolbar-row-pl2-toolbar .icon-fat{width:20px;height:20px}#property-panel.page-layout-2-panel .icon-fat,#rte-toolbar-row-pl2-toolbar .layouts button{padding-left:6px;padding-right:6px}#property-panel.page-layout-2-panel a.icon-fat span.icon,#property-panel.page-layout-2-panel a span.icon{display:inline}",""])},function(e,t,n){var o=n(78);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(11)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,"#property-panel a.macro-placeholder-property-panel-display-newline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvklEQVR42rVTPQuFIBT1p1t7e2EFDrXnVmNb4Ca4BS5BW9AfOA+F+wjfAwfpwuHcDzn3olcGIAv5An3fo+u6L55x27bE5P+cZdkWqVJH6pDMsWxTSsFjmqbAMZIC4zjivm9c14XjOLDvO4wx2LYNwzCkBZqmwXmecM7BWgutNdZ1xTzP8LWkQFVVWJYFUspwQUII1HUd2NeSApxzeJRlCfKLovBxYPa6xe9KsedHLc7TXryzidQpnurvZNm/8QMbqb4yyqv4rAAAAABJRU5ErkJggg==);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAw0lEQVR42q1TMQqAMBDr0/UBroJiBUEf0E51dRMcxUlwFBcHPxA5IUuLONSDcDmupO01VQCiEC+gtYagrusH5FVVCfdz0FfRQVVR5CmoLtzfnWBf/R7WWhhjIFnAmvlToOs6XNeF8zyx7zvWdcU8zxjHEW3bhgK8NydaFAWO48C2bViWBdM0YRgGOOcgPc7t9RWyLEPf92ia5hEuyxJ5nj+Lpae+IkkSpGkKZnLW6u/gDHzX+c6kP4j/nfjmNJ8HiP6NN81gzxU6QYojAAAAAElFTkSuQmCC);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button,#property-panel a.macro-placeholder-property-panel-display-newline-button{padding:0 6px}",""])},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,".editor-inline-macro[data-macro-name=status]{background:transparent;border:0;min-height:16px;margin:0;vertical-align:-4px}",""])},function(e,t,n){var o=n(81);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(11)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,"#property-panel a.macro-property-panel-Grey span.icon{background-color:#42526e}#property-panel a.macro-property-panel-Green span.icon{background-color:#00875a}#property-panel a.macro-property-panel-Red span.icon{background-color:#bf2600}#property-panel a.macro-property-panel-Yellow span.icon{background-color:#ff991f}#property-panel a.macro-property-panel-Blue span.icon{background-color:#0052cc}#property-panel a.macro-property-panel-Blue,#property-panel a.macro-property-panel-Brown,#property-panel a.macro-property-panel-Green,#property-panel a.macro-property-panel-Grey,#property-panel a.macro-property-panel-Red,#property-panel a.macro-property-panel-Yellow{padding:6px;display:inline-block}#property-panel a.macro-property-panel-Blue span.icon,#property-panel a.macro-property-panel-Brown span.icon,#property-panel a.macro-property-panel-Green span.icon,#property-panel a.macro-property-panel-Grey span.icon,#property-panel a.macro-property-panel-Red span.icon,#property-panel a.macro-property-panel-Yellow span.icon{display:inline-block;background-image:none;margin:0;border:0;min-width:auto;border-radius:3px;width:16px;height:16px}#property-panel .editable.status-macro-title{margin-right:10px;float:none;text-transform:uppercase;text-decoration:none;width:88px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:11px;padding:0 5px}#property-panel input.editable.status-macro-title{outline:none;height:30px;line-height:20px;vertical-align:bottom;padding-top:2px}",""])},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,".mce-content-body .mce-visual-caret{background-color:#000;background-color:currentColor;position:absolute;display:none}.mce-content-body .mce-visual-caret-hidden{display:none}.mce-content-body [data-mce-caret]{left:-1000px;margin:0;padding:0;position:absolute;right:auto;top:0}.mce-content-body .mce-offscreen-selection{left:-2000000px;max-width:1000000px;position:absolute}.ephox-snooker-resizer-bar{background-color:#22b5fe;opacity:0;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ephox-snooker-resizer-bar:hover{opacity:1}.ephox-snooker-resizer-cols{cursor:col-resize;width:3px!important}.ephox-snooker-resizer-rows{cursor:default;height:0!important}.ephox-snooker-resizer-bar.ephox-snooker-resizer-bar-dragging{opacity:1}table[data-mce-selected]{outline:1px solid #fff}",""])},function(e,t,n){e.exports=void 0},function(e,t,n){e.exports=void 0},function(e,t,n){e.exports=void 0},function(e,t,n){e.exports=void 0},function(e,t,n){e.exports=void 0},,,,,,,,function(e,t,n){"use strict";n.r(t);var o=n(5),r=n.n(o),a=n(6),i=n.n(a),l=(n(42),n(44),n(46),n(1)),c=n.n(l),s=n(0),d=n.n(s);function u(){return s.AJS.Rte}var g=n(3);function f(e){return(e=e&&e.jquery?e[0]:e)?("BR"!==e.tagName&&3!==e.nodeType||(e=e.parentNode),e&&9===e.nodeType&&(e=null),e):null}var m={};m.Rte={HIDDEN_CHAR:"\ufeff",ZERO_WIDTH_WHITESPACE:"&#x200b;",editorId:"wysiwygTextArea",isQuickEdit:!1,getEditor:()=>s.tinymce.activeEditor,getCurrentBaseUrl(){if(!this.currentBaseUrl){var e=s.document.location;this.currentBaseUrl=`${e.protocol}//${e.hostname}${e.port?":"+e.port:""}`}return this.currentBaseUrl},showSelection:e=>{u().showElement(s.tinymce.activeEditor.selection.getStart(),e)},isAnyPartShown:e=>{var t=f(e);if(!t)return!1;var n=c()(t),o=n.offset().top,r=o+n.outerHeight(),a=c()(u().getEditor().getDoc()).scrollTop(),i=a+c()(u().getEditorFrame()).height();return r>a&&o<i},showElement:(e,t)=>{var n=f(e);if(n){var o=c()(n),r=u().getEditor(),a=c()(r.getDoc()),i=o.offset().top,l=i+o.outerHeight(),s=a.scrollTop(),d=s+c()(u().getEditorFrame()).height(),g=()=>{u().bindScroll("AJS.Rte.showElement",()=>{u().unbindScroll("AJS.Rte.showElement"),setTimeout(t,1)})};i<s?(u().scrollTo(i),t&&g()):l>d?(u().scrollTo(Math.min(i,s+l-d)),t&&g()):t&&t()}},scrollTo:e=>{var t=u().getEditor();e=Math.ceil(e),c()(t.getDoc()).scrollTop(e)},bindScroll:(e,t)=>{var n=u().getEditor();c()(s.document).add(n.getDoc()).add(n.getWin()).bind("scroll."+e,t)},unbindScroll:e=>{var t=u().getEditor();c()(s.document).add(t.getDoc()).add(t.getWin()).unbind("scroll."+e)},getMainEditor:()=>{var e=s.tinymce.EditorManager.editors[u().editorId];if(!e)throw new Error("Main editor has not been initialised yet and is therefore not accessible via tinymce.EditorManager.editors");return e},getEditorContainer:()=>s.document.getElementById("wysiwyg"),getEditorFrame:()=>s.document.getElementById(u().getEditor().id+"_ifr"),getEditorTable:()=>s.document.getElementById(u().getEditor().id+"_tbl"),webResourcePath:"/download/resources/com.atlassian.confluence.tinymceplugin%3Atinymceeditor/",getResourceUrlPrefix(){return this.resourceUrlPrefix||(this.resourceUrlPrefix=this.getCurrentBaseUrl()+g.a.get("editor-plugin-resource-prefix")),this.resourceUrlPrefix},getTinyMceBaseUrl(){return this.absoluteUrl||(this.absoluteUrl=this.getResourceUrlPrefix()+this.webResourcePath+"tinymcesource/"),this.absoluteUrl},getMinEditorHeight:()=>+g.a.get("min-editor-height"),getTinyMceEditorMinHeight:e=>{e=e||0;var t=u().getMinEditorHeight(),n=0;return t||(Array.prototype.forEach.call(s.document.querySelectorAll("#editor-precursor,#header-precursor,#header"),e=>{n+=c()(e).outerHeight(!0)}),c()(d.a).height()-n-e)},fixEditorFocus:()=>{0},editorFocus:e=>{if(e&&!e.destroyed){var t,n=(t=e.dom.getRoot(),s.tinymce.isWebKit&&!c()(t).parents("body").length&&(t=c()(e.getBody()).find("p:first-child")[0]),t);n&&(e.selection.select(n,!0),e.selection.collapse(!0),n.focus()),e.getBody().focus(),e.getWin().focus()}}},m.KEYS={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91};var p=m,h={offset(e){var t=c()(e).offset(),n=s.tinymce.activeEditor.iframeElement,o=c()(n).offset(),r=n.contentWindow.document,a=c()(s.tinymce.activeEditor.getBody()),i=c.a.support.boxModel&&r.documentElement.scrollTop||a.scrollTop(),l=c.a.support.boxModel&&r.documentElement.scrollLeft||a.scrollLeft();return{top:t.top-i+o.top,left:t.left-l+o.left}},getSelectedText(){var e=s.tinymce.activeEditor.selection;return e.getRng().text||e.getSel()&&e.getSel().toString&&e.getSel().toString()||""},setHtml(e){e&&s.tinymce.activeEditor.setContent(e)},getHtml:()=>""+s.tinymce.activeEditor.getContent(),isEmpty(){var e=s.tinymce.activeEditor.getContent().replace("&nbsp;","").replace("<br />","");return"<p></p>"===e.trim()||0===e.length},editorHasContentChanged:()=>s.tinymce.activeEditor.isDirty(),editorResetContentChanged(){s.tinymce.activeEditor.setDirty(!1)},getChildIndex(e,t){for(var n=e.childNodes,o=0,r=n.length;o<r;o++)if(n[o]==t)return o;return-1}},b=()=>!!g.a.get("collaborative-content")&&v(),v=()=>{var e=g.a.get("content-type");return"page"===e||"blogpost"===e},y=n(2),w=n(7),C=(n(48),n(19)),A=n.n(C);function x(){return c()("#table-highlight-group").attr("data-highlight-colour")||""}var M={areCellsHeadings(e){var t=e.filter("th").length;return e.length===t},areCellsHighlighted(e){var t=e.filter("td[data-highlight-colour],th[data-highlight-colour]"),n=t.length;return e.length===n&&function(e){var t,n,o=x();for(t=0,n=e.length;t<n;t++)if((e.eq(t).attr("data-highlight-colour")||"")!==o)return!1;return!0}(t)},getSelectedHighlightColour:x},k=e=>{function t(t){var o,r,a=function(t){return e.translate(t)};n(t),M.getSelectedHighlightColour()&&(o=M.getSelectedHighlightColour(),r=a([a("table.cell_background_color"),A.a.colorNames[o.substring(1,o.length)]]),t.attr("data-highlight-colour",o),t.attr("title",r),t.children().attr("title",""),t.addClass("highlight-"+o))}function n(e){var t,n,o;for(t=0,n=e.length;t<n;t++)(o=e.eq(t)).attr("data-highlight-colour")&&o.removeAttr("data-highlight-colour"),o.attr("title")&&o.removeAttr("title"),o[0].className=o[0].className.replace(/( |^)highlight-[#\w]+/g,"")}e.on("init",(function(){var o=function(e){return c()(e.selection.getNode()).closest("th.confluenceTh,td.confluenceTd")},r=function(e){var t=c()(e.getBody()).find("th.confluenceTh[data-mce-selected],td.confluenceTd[data-mce-selected]");return t.length?t:o(e)};e.addCommand("confTableRowToggleHeading",(function(){var t=function(e){var t=c()(e.getBody()).find("td[data-mce-selected],th[data-mce-selected]");t.length||(t=c()(e.selection.getNode()));for(var n=t.closest("tr"),o=n.parent(),r=o.is("tbody")?n.parent().parent():o;0!==n.length&&!r.is(".confluenceTable");)n=r.closest("tr"),r=(o=n.parent()).is("tbody")?n.parent().parent():o;return n}(this).children("td,th");return M.areCellsHeadings(t)?e.execCommand("mceTableRowType",!1,{type:"body"}):e.execCommand("mceTableRowType",!1,{type:"header"}),!1})),e.addCommand("confTableColumnToggleHeading",(function(){var t=function(e){var t=c()([]);return e.each((function(){var e=c()(this),n=e.index()+1,o=e.closest("table.confluenceTable").children("tbody").children("tr");t=t.add(o.children().nthCol(n))})),t}(r(this));return M.areCellsHeadings(t)?e.execCommand("mceTableColType",!1,{type:"td"}):e.execCommand("mceTableColType",!1,{type:"th"}),!1})),e.addCommand("confTableSelectionToggleHighlight",(function(e,o){var a=o&&o.alwaysHighlight,i=r(this);return M.areCellsHighlighted(i)&&!a||c()("#table-highlight-group").attr("data-remove-highlight")?n(i):t(i),!1})),e.on("KeyDown",t=>{!function(t){if(t.altKey&&(38===t.keyCode||40===t.keyCode)){var n=e.selection.getRng(),o=c()(n.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0!==o.length){e.execCommand(38===t.keyCode?"mceTableInsertRowBefore":"mceTableInsertRowAfter");var r=o.parent()[38===t.keyCode?"prev":"next"]().find("td:first-child")[0],a=c()(r);a.hasClass("numberingColumn")&&(r=a.next()[0]),n&&(n.setStart(r,0),n.setEnd(r,0),e.selection.setRng(n)),t.preventDefault()}}}(t)}),e.on("Click",(function(){var t=o(this);t.hasClass("numberingColumn")&&!t.hasClass("confluenceTh")&&e.execCommand("mceTableMoveCaretToNextCell")})),e.on("KeyDown",(function(t){if((38===t.keyCode||40===t.keyCode)&&(n=e.selection.getNode(),c()(n).parents("table").is(".confluenceTable"))&&o(this).hasClass("numberingColumn"))return e.execCommand("mceTableMoveCaretToNextCell"),t.preventDefault(),!1;var n}),!0)})),e.on("init",(function(){c()(e.getBody()).find(".confluenceTd.numberingColumn").attr("contenteditable","false")}))},E=e=>{e.on("BeforeExecCommand",t=>{if("mceInsertTable"===t.command&&!t.value){e.execCommand("mceInsertTable",!1,{columns:3,rows:4,options:{headerRows:1}}),t.preventDefault()}})},T=e=>{var t,n,o=/([+-]?\d*)[nN]([+-]?\d*)/;e.fn.nthCol=function(r){var a,i,l,c,s,d,u,g,f;return l={multiplier:0,offset:0},"even"===(a=r)?a="2n":"odd"===a?a="2n+1":/^\d*$/.test(a)&&(a="0n+"+a),null!==(i=o.exec(a))&&(l.multiplier=i[1]-0,l.offset=i[2]-0),n=l,c=this,u=[],g=0,f=[],e.each(c,(e,t)=>{var n=0,o=0,r=t.rowSpan||1,a=t.colSpan||1;for(t.parentNode!==s&&((s=t.parentNode).parentNode!==d&&(d=s.parentNode,u=[]),g=0,void 0===u[s.rowIndex]&&(u[s.rowIndex]=[])),n=0;n<u[s.rowIndex].length+1;n+=1)if(void 0===u[s.rowIndex][n]){g=n;break}for(f[e]=g,n=s.rowIndex;n<s.rowIndex+r;n+=1)for(void 0===u[n]&&(u[n]=[]),o=g;o<g+a;o+=1)u[n][o]=!0}),t=f,e(this).filter((function(e){return o=t[e]-(n.offset-1),0===n.multiplier?0===o:o%n.multiplier==0&&o/n.multiplier>=0;var o}))}};var D=function(){var e,t=s.tinymce.activeEditor;if(this.parent().closest("table.confluenceTable").length)return c()("#table-mode-picker .dropdown-text").text(t.translate("table.responsive")),void c()("#table-mode-picker .aui-dd-parent").addClass("disabled");c()("#table-mode-picker .aui-dd-parent").removeClass("disabled"),(e=this).hasClass("fixed-table")||e.hasClass("fixed-width")?c()("#table-mode-picker .dropdown-text").text(t.translate("table.fixed_width")):c()("#table-mode-picker .dropdown-text").text(t.translate("table.responsive"))},I=function(e,t,n){if(n||n.content){var o=c()("<div/>").append(n.content);o.find("table.confluenceTable.relative-table, table.confluenceTable.relative-table > colgroup > col").each((function(){var e;(e=c()(this)).data("resize-percent")?e.css({width:e.data("resize-percent")+"%"}):e.attr("style",e.data("mce-style"))})),n.content=o.html()}},S=e=>{e.on("ObjectResizeStart",t=>{var n=t.target;if("bar-col"===t.origin&&e.dom.is(n,"table")){if(n.style.width||(n.classList.contains("fixed-table")?(n.classList.remove("fixed-table"),n.classList.add("fixed-width")):n.classList.contains("fixed-width")||n.classList.add("relative-table")),function(e){var t=0;e.find(">tbody >tr").each((function(){var e=0;c()(this).find(">th,>td").each((function(){var t=c()(this);t.attr("colspan")?e+=parseInt(t.attr("colspan")):e++})),e>t&&(t=e)}));var n=e.find(">colgroup"),o=n.find("col"),r=o.length;if(r!==t){var a=n.length>0;if(a||(n=c()("<colgroup>")),t>r)for(var i=0;i<t-r;i++){var l=c()("<col>");n.append(l)}else for(var s=0;s<r-t;s++)o.last().remove();a||e.prepend(n)}}(c()(n)),""===e.dom.getStyle(n,"width")){var o=n.offsetParent;if(null!==o){var r=n.offsetWidth/o.offsetWidth*100;e.dom.setStyle(n,"width",r+"%")}}var a=s.tinymce.grep(n.children,t=>e.dom.is(t,"colgroup"))[0].children,i=s.tinymce.map(a,e=>({value:parseFloat(e.style.width),changed:!1,raw:e.style.width})),l=-1!==n.style.width.indexOf("%");s.tinymce.each(n.rows,t=>{var n=0;s.tinymce.each(t.cells,(t,o)=>{var r=e.dom.getAttrib(t,"colspan",1);if(1===r){var a=i[o+n],c=l?t.offsetWidth/t.offsetParent.offsetWidth*100:t.offsetWidth;a&&!a.changed&&a.value!==c&&(a.value=c,a.changed=!0)}else n+=r-1})});var d=c()(n).closest(".wysiwyg-macro-body, body#tinymce")[0].offsetWidth/parseInt(getComputedStyle(n.parentElement).getPropertyValue("width")),u=l?"%":"px",g=l?n.offsetWidth/n.offsetParent.offsetWidth*100*d:n.offsetWidth;e.dom.setStyle(n,"width",g+u),s.tinymce.each(i,(t,n)=>{t.changed&&e.dom.setStyle(a[n],"width",t.value+u)})}},!0),e.on("ObjectResized",(function(t){var n=t.target;"bar-col"===t.origin&&e.dom.is(n,"table")&&n.classList.contains("relative-table")&&n.setAttribute("data-resize-percent",parseFloat(e.dom.getStyle(n,"width")).toString())}))};function O(e){S(e),c.a.fn.updateTableModeInToolbar=D,(e=>{var t=(t,n)=>{var o=e.dom.getParent(e.selection.getNode(),"table.confluenceTable");e.undoManager.transact(()=>{o&&o.classList.contains("fixed-table")&&""===e.dom.getStyle(o,"width")&&e.dom.setStyle(o,"width",o.offsetWidth+"px"),e.execCommand("mceTableSizingMode",!1,t),o&&(o.classList[n]("fixed-width"),o.classList.remove("relative-table"),o.classList.remove("fixed-table"))}),c()("#table-mode-picker .dropdown-text").text(e.translate("table."+("responsive"===t?"responsive":"fixed_width")))};e.addCommand("mceAutoWidth",()=>{t("responsive","remove")}),e.addCommand("mceFixedWidth",()=>{t("fixed","add")})})(e),s.tinymce.isWebKit&&c()(s.document).bind("prePaste",I)}function j(e){Array.from(e.getBody().querySelectorAll(".confluenceTable.fixed-table >tbody >tr >td, .confluenceTable.fixed-table >tbody >tr >th")).forEach(e=>{e.style.width=""})}var N,L="data-snooker-col-series",B="data-snooker-locked-cols";function P(e){return function e(t){var n=[];return t?(!function(e){return"thead"===e.name||"tbody"===e.name||"tfoot"===e.name}(t)?"tr"===t.name&&n.push(t):n.push.apply(n,e(t.firstChild)),n.concat(e(t.next))):n}(e.firstChild)}function R(e){for(var t=[],n=e.firstChild;n;)"td"!==n.name&&"th"!==n.name||t.push(n),n=n.next;return t}function H(e,t,n){return n.indexOf(e)===t}function z(e,t,n){(e.attr("class")||"").split(" ").some((function(e){return e.toLowerCase()==="numberingColumn".toLowerCase()}))&&(t.isSeriesTable=!0,e.attr("contenteditable","false"),t.isResizable||e.attr("data-mce-resize","false"),t.lockedColumns.push(n))}function F(e){for(var t=N.getParam("advtable_value_series"),n=t?t.numbers:void 0,o=!n||!1!==n.resizable,r=0;r<e.length;r++){var a=e[r];if("wysiwyg-macro"===a.attr("class"))void 0===a.attr("data-mce-resize")&&a.attr("data-mce-resize","false");else if(!a.attr(L)){for(var i={isResizable:o,isSeriesTable:!1,lockedColumns:[]},l=P(a),c=0;c<l.length;c++)for(var s=0,d=R(l[c]),u=0;u<d.length;u++){var g=d[u];z(g,i,s),s+=parseInt(g.attr("colspan"),10)||1}if(i.isSeriesTable&&a.attr(L,"numbers"),i.lockedColumns.length>0){var f=(a.attr(B)||"").split(",").map((function(e){return parseInt(e,10)})).concat(i.lockedColumns).filter(H).sort();a.attr(B,f.join(","))}}}}function U(e){return()=>{var t=N.getDoc().querySelectorAll(e);t.length>0&&Array.prototype.forEach.call(t,e=>{e.setAttribute("data-mce-resize","false")})}}function _(e){var t,n;N=e,e.parser.addNodeFilter("table",F),t="data-mce-resize",(n=N.serializer.getAttributeFilters().find(e=>e.name===t))&&(n.callbacks=[]),e.on("SetContent",U("table.confluenceTable table.confluenceTable:not([data-mce-resize])")),b()&&(Object(y.a)("rte-collab-ready editor-shared-drafts-published editor-shared-drafts-discarded",U("table.wysiwyg-macro:not([data-mce-resize])")),Object(y.a)("rte-collab-ready",U("table.confluenceTable table.confluenceTable:not([data-mce-resize])")),Object(y.a)("rte-collab-ready",()=>{Array.prototype.forEach.call(N.getDoc().querySelectorAll("table.confluenceTable:not([data-snooker-col-series])"),e=>{var t=e.querySelectorAll(".numberingColumn");t.length&&(e.setAttribute(B,"0"),e.setAttribute(L,"numbers"),Array.prototype.forEach.call(t,e=>{e.setAttribute("contenteditable","false"),e.setAttribute("data-mce-resize","false")}))})}))}var W=n(27);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G=`${d.a.location.protocol}//${d.a.location.host}`,Y=["compat3x","atlassiantheme","auiwindowmanager","table","emotions","confluence","macroplaceholder","customtoolbar","insertwikimarkup","propertypanel","keyboardshortcuts","confmonospace","confcharmap","lists","conflist","tasklist","paste","aePaste","aeTable","tablePasteFilter","pagelayoutplugin","iosediting","autoconvert","deletecommand","draggable","confluencesortabletablesplugin","textplaceholders","linkbrowser","insertfiles","tableAnalytics","aetextpattern","persit_scroll_position","confindentation","preserve-paragraph-formatting-on-delete","tableContentWrapper","statusmacro","macroNavigation","advtable"];function J(){var e=new W.a;return e.isChrome()&&96==e.version()}var q=()=>{var e,t={theme:"default"};return((e=new W.a).isChrome()&&e.version()<80||e.isFirefox()&&e.version()<80)&&!d.a.QUnit&&0===g.a.get("remote-user").indexOf("testuser")&&(t=V(V({},t),{},{object_resizing:!1})),t=V(V(V({},t),{table_default_attributes:{class:"confluenceTable"},table_default_styles:{},table_header_type:"cells",table_resize_bars:!0,table_use_colgroups:!0,table_column_resizing:"resizetable",advtable_value_series:{numbers:{update:!0,resizable:!1,generator:function(e){var t=e.prev?e.prev.count:0;if("tbody"===e.rowType&&"td"===e.cellType){var n=t+1;return{value:n,count:n,classes:["numberingColumn"]}}return{count:t,classes:["numberingColumn"]}}}}}),{},{autoresize_min_height:"100%",width:"100%",height:"100%",document_base_url:`${G}${w.a}/`,plugins:Y.join(","),theme_advanced_buttons1:"formatselect,confimage,conf_macro_browser,code,customtoolbar,monospace,searchreplace,linkbrowserbutton",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_resizing:!1,theme_advanced_resize_horizontal:!1,theme_advanced_statusbar_location:"none",theme_advanced_path:!1,theme_advanced_blockformats:"p,h1,h2,h3,h4,h5,h6,pre,blockquote",toolbar:!1,menubar:!1,skin:!1,statusbar:!1,table_toolbar:"",contextmenu:!1,mode:"specific_textareas",editor_selector:"tinymce-editor",body_class:"aui-theme-default mceContentBody wiki-content",popup_css:!1,content_css:!1,editor_css:!1,custom_undo_redo:!0,custom_undo_redo_levels:20,context_path:w.a,plugin_action_base_path:w.a+"/plugins/tinymce",editor_plugin_action_base_path:w.a+"/plugins/editor/tinymce",page_id:g.a.get("page-id"),draft_type:null,form_name:g.a.get("form-name"),space_key:encodeURI(g.a.get("space-key")),confluence_popup_width:620,confluence_popup_height:550,editor_id:"wysiwygTextarea",indent:!1,table_tab_navigation:!0,inline_boundaries:!1,indent_use_margin:!0,end_container_on_empty_block:!0,atlassian:!0,keep_values:!0,convert_urls:!0,relative_urls:!1,remove_script_host:!1,button_tile_map:!0,apply_source_formatting:!1,list_outdent_on_enter:!0,visual:!1,confluence_table_style:"confluenceTable",confluence_table_cell_style:"confluenceTd",confluence_table_heading_style:"confluenceTh",confluence_table_default_rows:4,confluence_table_default_cols:3,confluence_table_default_heading:!0,cleanup:!0,cleanup_on_startup:!0,fix_list_elements:!1,fix_table_elements:!0,valid_elements:"@[id|class|style|title|wysiwyg|dir<ltr?rtl|lang|xml::lang|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup],a[*],strong/b,em/i,s,u,#p[align|user],-ol[type|compact],-ul[type|compact],li,br,img[imagetext|longdesc|usemap|src|border|alt=|title|hspace|vspace|width|height|align],-sub,-sup,-blockquote[cite|markup],-table[*],-tr[rowspan|width|height|align|valign|bgcolor|background|bordercolor],tbody,thead,tfoot,#td[colspan|rowspan|width|height|align|valign|bgcolor|background|bordercolor|scope|contenteditable],#th[colspan|rowspan|width|height|align|valign|scope|contenteditable],caption,#div[*],span[*],-code,#pre[*],address,-h1,-h2,-h3,-h4,-h5,-h6,hr[size|noshade],-font[face|size|color],dd,dl,dt,cite,abbr,acronym,del[datetime|cite],ins[datetime|cite],object[classid|width|height|codebase|*],param[name|value],embed[type|width|height|src|*],map[name],area[shape|coords|href|alt|target],bdo,button,col[align|char|charoff|span|valign|width],colgroup[align|char|charoff|span|valign|width],dfn,fieldset,form[action|accept|accept-charset|enctype|method],input[accept|alt|checked|disabled|maxlength|name|readonly|size|src|type|value],kbd,label[for],legend,noscript,optgroup[label|disabled],option[disabled|label|selected|value],q[cite],samp,select[disabled|multiple|name|size],small,textarea[cols|rows|disabled|name|readonly],tt,var,big",extended_valid_elements:"img[*],time[class|datetime|contenteditable|onselectstart|unselectable|oncontrolselect]",formats:{alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img.confluence-embedded-image",classes:"image-left"},{selector:"img,table",collapsed:!1,styles:{float:"left"}}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img.confluence-embedded-image",classes:"image-center"},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img.confluence-embedded-image",classes:"image-right"},{selector:"img,table",collapsed:!1,styles:{float:"right"}}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class"]},{inline:"span",styles:{fontWeight:"bold"}}],italic:[{inline:"em",remove:"all",preserve_attributes:["class"]},{inline:"span",styles:{fontStyle:"italic"}}],underline:[{inline:"u",remove:"all"},{inline:"span",styles:{textDecoration:"underline"},exact:!0}],strikethrough:[{inline:"s",remove:"all"}],removeformat:[{selector:"h1,h2,h3,h4,h5,h6,pre",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0,block:"*"},{selector:"address,article,b,big,blockquote,center,cite,code,date,dd,del,dfn,dl,dt,em,embed,font,footer,header,hgroup,i,ins,kbd,link,menu,nav,object,param,q,s,samp,script,section,small,strike,strong,style,sub,sup,time,tt,u,var",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"table",attributes:["cellpadding","cellspacing","border"],split:!1,expand:!1,deep:!0},{selector:":not(li)",attributes:["style","color","bgcolor","title","lang"],split:!1,expand:!1,deep:!0}]},forced_root_block:"p",force_p_newlines:!0,force_br_newlines:!1,padd_empty_with_br:!0,allow_unsafe_link_target:!0,paste_remove_styles_if_webkit:!1,automatic_uploads:!1,allow_html_data_urls:!0,images_dataimg_filter:()=>!1,browser_spellcheck:!J()})},Z=!1,X="",ee={},te={},ne=()=>{if(Z){var e=(()=>{for(var e={},t={name:X,data:e},n=oe.getEntriesByType("measure"),o=0;o<n.length;o++){var r=n[o],a=r.name;ee[a]&&(e[a+".startTime"]=r.startTime,e[a+".duration"]=r.duration)}return t})();Object(y.b)("analytics",e),Z=!1}};var oe=d.a.performance,re=e=>e+".start";function ae(e){(e=>{if(oe&&oe.mark&&ee[e]){Z||(Z=!0);var t=re(e);oe.mark(t)}})(e)}function ie(e){(e=>{if(oe&&oe.mark&&ee[e]){var t=re(e);if(0!==oe.getEntriesByName(t,"mark").length){var n=(e=>e+".end")(e);oe.mark(n),oe.measure(e,t,n),te[e]&&ne()}else d.a.console.warn(`Calling debugTimeEnd for ${e} before debugTime`)}})(e)}var le={createProfileForCommentEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavecomment","confluencewatch","autoresize"]}},createProfileForPageEditor:function(e){var t=["searchreplace","confluencedrafts","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","flextofullsize","referrer"];return e&&e.versionComment&&t.push("confluenceversioncomment"),e&&e.notifyWatchers&&t.push("confluencenotifywatchers"),{plugins:t}},createProfileForTemplateEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavetemplate","flextofullsize","templateeditor"]}}},ce=function(){return{renderUI:()=>({iframeContainer:s.tinymce.DOM.get("rte"),editorContainer:"wysiwyg"})}},se=n(16),de=n.n(se);function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var me=()=>{void 0===s.AJS.Rte&&(s.AJS.Rte=ge({},p.Rte)),void 0===s.AJS.Rte.getEditor&&(s.AJS.Rte=ge(ge({},s.AJS.Rte),p.Rte))},pe={Formatting:".rte-toolbar-group-formatting",Style:".rte-toolbar-group-style",Indentation:".rte-toolbar-group-indentation",Lists:".rte-toolbar-group-lists",Tasks:".rte-toolbar-group-task-lists",Justification:".rte-toolbar-group-justification",Links:".rte-toolbar-group-link",Table:".rte-toolbar-group-table",Insert:".rte-toolbar-group-insert",Undo:".rte-toolbar-group-undo",PageLayouts:"#page-layout-2-group",SearchReplace:".rte-toolbar-group-searchreplace",Help:".rte-toolbar-group-help"},he=(e,t,n)=>{!1===t&&((e,t)=>{Array.prototype.forEach.call(s.document.getElementById(e).querySelectorAll(t),e=>{e.style.display="none"})})(e,n)};function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){ye(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var we,Ce=!1,Ae={_tinyMceHasInit:!1,_beforeInitCallbacks:[],_tinymcePluginInits:[],_settings:null,isInitComplete:()=>Ae._tinyMceHasInit,isEditorActive:()=>!!(Ae.isInitComplete()&&i.a&&i.a.activeEditor),onInit:()=>{Ae._tinyMceHasInit=!0;var e=r.a.Rte.getEditor();if(e.getBody().classList.add("notranslate"),Object(y.b)("init.rte",{editor:e}),!1!==g.a.get("editor-auto-focus")){var t=document.getElementById("content-title");t&&""===t.value?t.focus():r.a.Rte.editorFocus(e)}else 0},addOnInitCallback:e=>{if("function"!=typeof e)throw new Error("Attempt made to register an oninit callback that is not a function. Received: "+e);Ae._tinyMceHasInit?e():Object(y.a)("init.rte",e)},addBeforeInitCallback:e=>{Ae._beforeInitCallbacks.push(e)},addTinyMcePluginInit:e=>{Ae._tinymcePluginInits.push(e)},preInitialise:e=>{Ae._settings=e,Ce&&(Ce=!1,Ae.initialise(we))},initialise:e=>{if(ae("confluence.editor.tinymce"),!Ae._settings)return Ce=!0,void(we=e);e=ve({},e);var t,n,o,a,l=ve({},Ae._settings);r.a.Rte.isQuickEdit=e.isQuickEdit||!1,Ae._beforeInitCallbacks.forEach(e=>{e(l)}),Object(y.b)("rte-pre-resolveplugins");for(var c=0,d=Ae._tinymcePluginInits.length;c<d;c++)"function"==typeof Ae._tinymcePluginInits[c]&&Ae._tinymcePluginInits[c](l);!function(e){de.a;var t=new RegExp(de.a.ctrl_key+"\\+","g"),n=new RegExp(de.a.shift_key+"\\+","g"),o=e=>e.replace(t,"").replace(n,"");for(var r in de.a){var a=de.a[r];if("object"==typeof a)for(var l in a)i.a.Env.mac&&(a[l]=o(a[l]));i.a.EditorManager.addI18n(`${e}.${r}`,de.a[r])}i.a.ScriptLoader.markDone(`${i.a.baseURL}/langs/${e}.js`),i.a.Env.mac&&Array.prototype.forEach.call(document.querySelectorAll("#rte-toolbar .toolbar-item, #rte-toolbar .dropdown-item, #rte-savebar .aui-button"),e=>{var t=e.getAttribute("title"),n=e.dataset.tooltip;t&&e.setAttribute("title",o(t)),n&&(e.dataset.tooltip=o(n))})}(l.locale),((e,t)=>{var n;if(!1!==t)for(n in t=t||{})t.hasOwnProperty(n)&&pe[n]&&he(e,t[n],pe[n]);else s.document.getElementById(e).style.display="none"})("toolbar",e.toolbar),l.plugins=(t=l.plugins,n="string"==typeof e.plugins?e.plugins.split(","):e.plugins||[],o=e.excludePlugins||[],a=t.split(","),n.forEach(e=>{a.indexOf(e)<0&&a.push(e)}),(a=a.filter(e=>o.indexOf(e)<0)).join(",")),l.setup=function(t){t.on("PreInit",()=>{t.dom.loadCSS=function(){},_(t)}),e&&"function"==typeof e.onInitialise&&e.onInitialise(t)},l.init_instance_callback=function(e){var t=b();me(),i.a.FocusManager.isEditorUIElement=function(e){for(var t=e,n=!1;t;){if("rte-toolbar"===t.id){n=!0;break}t=t.parentElement}return n};try{var n=l.contentCssTags,o=e.getDoc().querySelectorAll("head");if(void 0===o[0])throw"No editor <head>";o[0].innerHTML=n+o[0].innerHTML}catch(e){}r.a.Rte.BootstrapManager.onInit(e),h.editorResetContentChanged(),r.a.Rte.getEditorFrame().setAttribute("tabindex",100),t&&e.on("AddUndo",t=>{var n={level:null,lastLevel:null,originalEvent:t};return e.fire("change",n)}),ie("confluence.editor.tinymce"),Object(y.b)("rte-ready"),t&&Object(y.b)("rte-begin-collab-editing"),v()&&e.getBody().classList.add("page-edit")},i.a.IconManager.add("default",{icons:{}}),i.a.init(l)}},xe=Ae;var Me=()=>{void 0!==s.AJS.Rte&&void 0===s.AJS.Rte.Content&&(s.AJS.Rte.Content=h)};function ke(e){for(var t=e.split("."),n=window[t.shift()];void 0!==n&&t.length;)n=n[t.shift()];return n}function Ee(e,t,n,o){return"function"==typeof o?c()(e).bind(t,n,o):c()(e).bind(t,n)}function Te(e,t,n){return c()(e).unbind(t,n)}function De(e,t,n){return c()(e).trigger(t,n)}var Ie=function(e,t){return"<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?c()(e,t||s.document):c()(`<div>${e}</div>`,t||s.document).contents()},Se=function(e,t){e.is("ul.inline-task-list")?t.each((function(){var e=c()(this);e.attr("data-inline-task-id")||e.attr("data-inline-task-id","")})):t.removeAttr("data-inline-task-id").removeAttr("data-pasted-task")},Oe=function(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return"LI"===t.nodeName&&1===t.childNodes.length&&"BR"===t.firstChild.nodeName},je=function(e,t){if(!t.collapsed||0!=t.startOffset)return!1;var n=c()(t.startContainer).closest("ol, ul",e.getBody());if(0===n.length)return!1;var o=new s.tinymce.dom.TreeWalker(t.startContainer,n[0]).prev(!0);return void 0===o||c()(o).is("li")},Ne=function(e){var t=e.filter("ol,ul").length;return e.length===t},Le=function(e,t,n){var o=null;return Be.forEach(r=>{if(r.shouldInsert(e,t,n))return o=r,!1}),o},Be=[{shouldInsert(e,t,n){var o=Oe(t);return(o=o&&Ne(n))&&n.children("li").length>0},insert(e,t,n){var o=c()(3===t.startContainer.nodeType?t.startContainer.parentNode:t.startContainer),r=n.children();e.undoManager.beforeChange(),e.undoManager.add(),Se(o.parent(),r),o.replaceWith(r),e.selection.select(r.last()[0],!0),e.selection.collapse(),e.undoManager.add()}},{shouldInsert(e,t,n){var o=je(e,t);return(o=o&&Ne(n))&&n.children("li").length>0},insert(e,t,n){var o=c()(t.startContainer).closest("li",e.getBody()),r=n.children();e.undoManager.beforeChange(),e.undoManager.add(),Se(o.parent(),r),o.before(r),e.selection.select(o[0],!0),e.selection.collapse(!0),e.undoManager.add()}},{shouldInsert:(e,t,n)=>function(e,t){if(!t.collapsed)return!1;if(3===t.startContainer.nodeType&&t.startOffset!=t.startContainer.nodeValue.length)return!1;if(1===t.startContainer.nodeType&&t.startOffset!=t.startContainer.childNodes.length)return!1;var n=c()(t.startContainer).closest("ol, ul",e.getBody());if(0===n.length)return!1;var o=new s.tinymce.dom.TreeWalker(t.startContainer,n[0]).next(!0);return void 0===o||c()(o).is("li")}(e,t)&&n.length===n.filter("ol,ul").length&&n.children("li").length>0,insert(e,t,n){var o=c()(t.startContainer).closest("li",e.getBody()),r=n.children();e.undoManager.beforeChange(),e.undoManager.add(),Se(o.parent(),r),o.after(r),e.selection.select(r.last()[0],!0),e.selection.collapse(!1),e.undoManager.add()}},{shouldInsert(e,t,n){var o=n.length>1;return o=(o=(o=o&&!Oe(t))&&je(e,t))&&function(e){var t=e.filter("ol,ul"),n=e[e.length-1];return 1===t.length&&t[0]===n}(n)},insert(e,t,n){var o=c()(t.startContainer).closest("li",e.getBody());e.undoManager.beforeChange(),e.undoManager.add(),Se(o.parent(),n.children("li"));var r=c()("<li></li>").append(n);o.before(r),e.undoManager.add()}},{shouldInsert:(e,t,n)=>!t.collapsed&&(!!c()(t.commonAncestorContainer).is("table.confluenceTable > tbody, table.confluenceTable > tbody > tr")&&n.is("table:not(.wysiwyg-macro)")),insert(e,t,n){var o=n.children("tbody").length>0?n.children("tbody").children("tr"):n.children("tr"),r=o.children("td, th"),a=c()(".mceSelected",e.getDoc()),i=a.parent();function l(e,t){for(var n=e.shift(),o=t.shift();n&&o;n=e.shift(),o=t.shift())c()(o).html(c()(n).html())}if(e.undoManager.beforeChange(),e.undoManager.add(),1===i.length)l(c.a.makeArray(r),c.a.makeArray(a));else for(var s=c.a.makeArray(o),d=c.a.makeArray(i),u=s.shift(),g=d.shift();u&&g;u=s.shift(),g=d.shift())l(c.a.makeArray(c()(u).children()),c.a.makeArray(c()(g).children()));e.selection.setRng(t),e.undoManager.add()}},{shouldInsert:(e,t)=>c()(t.startContainer).closest("[data-macro-body-type='PLAIN_TEXT']").length>0,insert(e,t,n){n.raw&&e.selection.setContent(n.raw())}},{shouldInsert(e,t,n){var o=c()(t.startContainer).closest("table").length>0,r=1===n.length&&n.is("table.wysiwyg-macro");return o&&r},insert(e,t,n){e.execCommand("mceInsertContent",!1,n[0].outerHTML)}},{shouldInsert(e,t,n){var o=c()(t.startContainer).closest("table").is("table.wysiwyg-macro"),r=1===n.length&&n.is("table.confluenceTable");return o&&r},insert(e,t,n){e.execCommand("mceInsertContent",!1,n[0].outerHTML)}}],Pe={insert:function(e,t,n,o){var r=e.selection.getRng();if(r){var a,i,l,c=(a=e,i=t.content,l={content:i,format:"html",selection:!0},a.fire("BeforeSetContent",l),l.content),s=Ie(c,e.getDoc());s.raw=!!n&&function(){return n};var d=Le(e,r,s);d?(d.insert(e,r,s),e.fire("SetContent",{content:c,format:"html",selection:!0}),e.addVisual()):(e.selection.isCollapsed()||e.undoManager.ignore(()=>{e.execCommand("mceDelete",!1,null,{skip_undo:!0})}),t.wasProcessed=!0,e.execCommand("mceInsertContent",!1,t,{skip_undo:o}))}},parse:Ie},Re=function(e){e.parentNode.removeChild(e)},He=function(e){return function(t){var n=t.classList;n.remove.apply(n,e),""===t.className&&t.removeAttribute("class")}},ze=function(e,t,n){s.tinymce.util.Tools.each(e.querySelectorAll(t),n)};var Fe={apply:function(e,t){!function(e){var t;ze(e,"img:not([data-emoticon-name]):not([data-emoji-id]):not([data-hipchat-emoticon]):not(.editor-inline-macro):not(.confluence-embedded-image):not(.template-constiable)",(t=["confluence-embedded-image","confluence-external-resource"],function(e){var n=e.classList;n.add.apply(n,t)}))}(e),function(e){ze(e,"span.Apple-style-span",He(["Apple-style-span"]))}(e),function(e){ze(e,"br.Apple-interchange-newline",Re)}(e),function(e){ze(e,"meta",Re)}(e),function(e,t){ze(e,"ul.inline-task-list > li[data-inline-task-id]",n=>{var o,r,a=n.getAttribute("data-inline-task-id");s.tinymce.util.Tools.grep(t.querySelectorAll(`li[data-inline-task-id="${a}"]`),(r=e,o=function(e){return function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1}(e,r)},function(e){return!o(e)})).length>0&&n.setAttribute("data-inline-task-id","")})}(e,t),function(e){var t;ze(e,".mceSelected",He(["mceSelected"])),ze(e,"[data-mce-selected]",(t="data-mce-selected",function(e){e.removeAttribute(t)}))}(e),function(e){var t=g.a.get("base-url");ze(e,`a:not([data-base-url='${t}'])[data-base-url]`,e=>{for(var n=e.attributes.href?e.attributes.href.value:t;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);e.setAttribute("href",n)})}(e)}},Ue=function(e){return c()("<br>").add(e.contents())},_e=function(e){return(e.nodeType===Node.ELEMENT_NODE||e.nodeType===Node.TEXT_NODE)&&c.a.trim(e.textContent)},We=function(e){var t=!1;return e.parent().contents().each((function(){if(_e(this))return this===e[0]&&(t=!0,!1)})),t},Qe=function(e){var t=e.attr("style"),n=c()("<p></p>").append(e.contents());t&&n.attr("style",t),e.replaceWith(n)},Ve=function(e){var t=e.prev("p");t.length?(t.append(Ue(e)),e.remove()):We(e)?Qe(e):e.replaceWith(Ue(e))},$e=function(e,t){var n=c()(`<table class="wysiwyg-macro" data-macro-name="${e}" data-macro-body-type="RICH_TEXT"><tbody><tr><td class="wysiwyg-macro-body"></td></tr></tbody></table>`);return n.find(".wysiwyg-macro-body").append(t),n},Ke=function(e){return!e.text()&&!e.find("img").length},Ge=Qe,Ye=[function(e){e.find(".expand-container").replaceWith((function(){var e=c()(this).find(".expand-content").first().contents();return e.length?$e("expand",e):c()("")}))},function(e){e.find("span:empty").remove()},function(e){e.find("p + br").remove()},function(e){var t=!1;e.find("div:not(.content-wrapper)").each((function(){var e=c()(this);Ke(e)?(e.remove(),t=!0):e.find("div, p, pre").length?e.replaceWith(e.contents()):(t?Ge(e):Ve(e),t=!1)}))}];var Je={repair:function(e){var t=c()("<div></div>").html(e);return Ye.forEach(e=>{e(t)}),t.html()}},qe=[{repair(e){var t=/(<td.*<\/td>)<br class="Apple-interchange-newline">/.exec(e);return t?`<table class="confluenceTable"><tbody><tr>${t[1]}</tr></tbody></table>`:e}},{repair(e){var t=/(<tr.*<\/tr>)<br class="Apple-interchange-newline">/.exec(e);return t?`<table class="confluenceTable"><tbody>${t[1]}</tbody></table>`:e}}],Ze=function(e){return e?(qe.forEach(t=>{e=t.repair(e)}),e):e},Xe={apply:function(e){return e=function(e){return Je.repair(e)}(e=Ze(e))},repair:Ze};function et(e){var t={repair:Xe.repair,parse:Pe.parse},n=null;e.on("PastePreProcess",e=>{e.content=Xe.apply(e.content),De(s.document,"prePaste",[t,e])}),e.on("PastePostProcess",n=>{Fe.apply(n.node,e.getBody()),De(s.document,"postPaste",[t,n])}),e.on("BeforeExecCommand",t=>{var o=t.command,r=t.value;"mceInsertContent"===o&&r&&!0===r.paste&&!r.wasProcessed&&(t.preventDefault(),Pe.insert(e,r,n,!1))}),e.on("paste",e=>{n=null;var t=function(e){return(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(?:\r\n|\r|\n)/g,"<br />")}(e.clipboardData.getData("text/plain"));n=t},!0)}var tt,nt=()=>{var e,t=s.tinymce.activeEditor,n=rt();t.focus(!1);var o=t.selection.getRng();e=o&&o.cloneRange&&"function"==typeof o.cloneRange?o.cloneRange():o.duplicate&&o.duplicate()||o,tt={scrollX:n.scrollX,scrollY:n.scrollY,range:e}},ot=()=>{var e=s.tinymce.activeEditor.selection,t=s.tinymce.activeEditor.getWin();tt&&(at(tt),t.focus(),e.setRng(tt.range)),tt=null},rt=()=>{var e=s.tinymce.DOM.getViewPort(s.tinymce.activeEditor.getWin());return{scrollX:e.x,scrollY:e.y}},at=e=>{e&&s.tinymce.activeEditor.getWin().scrollTo(e.scrollX,e.scrollY)},it={storeBookmark:nt,restoreBookmark:ot,getScroll:rt,restoreScroll:at},lt=n(20),ct=n.n(lt);function st(){return{component:function(e){var t=e=>{0},n=new r.a.Dialog(e);return e=e||{},e=c.a.extend({},{keypressListener:o=>{if(27===o.keyCode)t(),c()(".aui-dropdown",n.popup.element).is(":visible")||("function"==typeof e.onCancel?e.onCancel():n.hide());else if(13===o.keyCode){if(t(),!c()(".aui-dropdown",n.popup.element).is(":visible"))"textarea"!=(o.target.nodeName&&o.target.nodeName.toLowerCase())&&"function"==typeof e.onSubmit&&setTimeout(e.onSubmit)}},width:865,height:530},e),s.document.addEventListener("hideLayer",(t,o,r)=>{"popup"==o&&r==n&&"function"==typeof e.onCancel&&e.onCancel()}),n},initialiser:function(e){Object(y.a)("show.dialog",(e,t)=>{var n,o=g.a.get("page-id"),a=g.a.get("space-key"),i=g.a.get("editor-mode"),l=g.a.get("new-page");r.a.EventQueue=r.a.EventQueue||[],r.a.EventQueue.push({name:t.dialog.id,properties:(n={},o&&(n.pageid=o),a&&(n.spacekey=a),i&&(n.editormode=i),l&&(n.newpage=l),n)})}),s.document.addEventListener("showLayer",(t,n,o)=>{s.Confluence.runBinderComponents(),"popup"==n&&o&&(t=>{var n,o=e(t);if(!o.attr("data-lasttab-override")){o.attr("data-tab-default")&&(n=o.attr("data-tab-default"));var r=s.Confluence.storageManager(o.attr("id")),a=r.getItem("last-tab"),i=null!=a?a:n;i&&e(`.page-menu-item:visible:eq(${i}) button`,o).click(),o.attr("data-lasttab-bound")||(e(".page-menu-item",o).each((t,n)=>{e(n).click(()=>{r.setItem("last-tab",t)})}),o.attr("data-lasttab-bound","true"))}})(o.element)}),r.a.Dialog.prototype.overrideLastTab=()=>{e(this.popup.element).attr("data-lasttab-override","true")},r.a.Dialog.prototype.addHelpText=(t,n)=>{if(t){var o=t;n&&(o=ct()(t).fill(n).toString());var r=this.page[this.curpage];r.buttonpanel||r.addButtonPanel();var a=e("<div class='dialog-tip'></div>").html(o);r.buttonpanel.append(a),e("a",a).click(()=>{var e=window.open(this.href,"_blank");return e&&e.focus(),e&&e.opener&&(e.opener=null),!1})}},r.a.Dialog.prototype.getTitle=()=>e(`#${this.id}.dialog-components:visible h2`).text(),r.a.Dialog.prototype.isVisible=()=>e("#"+this.id).is(":visible")}}}var dt=n(8),ut={},gt=e=>(t,n,o)=>{var r=null!=o&&"object"!=typeof o,a=null!=o?r?" = "+o:" >":"";console.log(`${e} - ${t} : ${n||null}${a}`),o&&!r&&console.log(o)},ft=function e(t,n){var o=gt("Autocompleter.Control"),r={},a=t.selection,i=a.getRng();if(!i)return null;var l=i.startOffset,d=i.startContainer,u=d.nodeValue,g=n.leadingChar,f=t.getDoc(),m=n.backWords||0,p=n.insertedFromMenu||!1,h=ut[g||"["],b=h&&void 0!==h.preventStartNodes?h.preventStartNodes:"div.code, a[href], img, pre";if(c()("#autocomplete",f).length)return o("init","Autocomplete already exists, returning null."),null;r.backWords=m,r.maxResults=n.maxResults||10,null==u&&i.collapsed&&l&&d.childNodes[l-1]&&(l=(u=(d=d.childNodes[l-1]).nodeValue)&&u.length||0);var v="";if(null!=u){v=(""+u).substring(0,l);for(var y=d.previousSibling;y&&3===y.nodeType;)v=y.nodeValue+v,y=y.previousSibling}var w;if(!m&&v&&!function(e,t){for(var n=0,o=t.length;n<o;n++)if(t[n].test(e))return!0;return!1}(v+g,[/([("'<(\u201c\u2018]\[|[\ufeff\u200b\u2014\s\xa0].)$/,/(\([^!])$/,/(\/\/)$/]))return o("init","Cursor is in wrong word location to start autocomplete, returning null."),null;if(c()(d).closest(b).length)return o("init","Cursor is in wrong node to start autocomplete, returning null."),null;if(s.Confluence.PropertyPanel&&s.Confluence.PropertyPanel.current&&(s.Confluence.PropertyPanel.shouldCreate=!1,s.Confluence.PropertyPanel.destroy()),g||null!=u||(o("init","No text available for suggestion, range is",i),u=""),r.getContainer=function(){return c()("#autocomplete",f)},i.collapsed&&m&&u){var C=function(e,t,n){var o,r;function a(e,t,n){!t.global&&(t=new RegExp(t.source,`g${t.ignoreCase?"i":""}${t.multiline?"m":""}`)),null==n?n=e.length:n<0&&(n=0);for(var o,r=e.substring(0,n+1),a=-1,i=0;null!=(o=t.exec(r));)a=o.index,t.lastIndex=++i;return a}for(var i=0;i<n;i++)for(t=a(o=e.nodeValue.substring(0,t),/\s+/,t);-1==t;){if(!(r=e.previousSibling)||3!==r.nodeType){i=n;break}e=r,(o=r.nodeValue)&&(t=a(o,/\s+/,o.length))}return{node:e,offset:t+1}}(d,l,m),A=a.getRng();A&&(A.setStart(C.node,C.offset),A.setEnd(d,l),a.setRng(A))}w=a&&a.getNode()&&a.getNode().classList.contains("placeholder-inline-tasks")?"":a.getContent({format:"text"}).replace("\n",""),o("init","suggestionHtml",w);var x=(e,t,n)=>{var o=s.document.createElement(e);return t&&o.setAttribute("id",t),n&&o.appendChild(s.document.createTextNode(n)),o},M=x("span","autocomplete");n.classNames&&("string"==typeof n.classNames?M.classList.add(...n.classNames.split(" ")):Array.isArray(n.classNames)&&M.classList.add(...n.classNames)),g&&M.appendChild(x("span","autocomplete-trigger",g));var k=x("span","autocomplete-search-text",s.AJS.Rte.HIDDEN_CHAR);M.appendChild(k),a.setNode(c()(M)[0]);var E=r.getContainer();r.previousSearchText="",r.settings=h,!1===h.cache||h.cacheManager?!1!==h.cache||h.cacheManager||(h.cacheManager={get:c.a.noop,put:c.a.noop}):h.cacheManager=new s.AJS.Confluence.localStorageCacheManager(h.ch);var T=c()("#autocomplete-search-text",r.getContainer()),D=c()(f.createElement("span")).text(w||s.AJS.Rte.HIDDEN_CHAR);T.empty().append(D),a.select(D[0],!0),a.collapse();var I,S,O=function(e){if(r.onBeforeKey&&!r.onBeforeKey(e,r.text()))return s.tinymce.dom.Event.cancel(e),o("before","blocked by onBeforeKey: "+e.keyCode),!1},j=function(e){var t=a.getRng();if(t){var n=r.getContainer(),i=t.startContainer,l=i.parentNode;3===i.nodeType&&l&&(l=l.parentNode);var c=l?l.parentNode:null,d=c?c.parentNode:null,u=l!==n[0]&&c!==n[0]&&d!==n[0];if(27===e.keyCode||u)o("after","dying because of: "+(u?"outside search span":"escape pressed")),r.die();else if(r.onAfterKey&&!r.onAfterKey(e,r.text()))return s.tinymce.dom.Event.cancel(e),o("after","blocked by onAfterKey: "+e.keyCode),!1}},N=function(e){if(r.onKeyPress&&!r.onKeyPress(e,r.text()))return s.tinymce.dom.Event.cancel(e),o("press","blocked by onKeyPress: "+e.keyCode),!1},L=function(e){r.getContainer()[0]!=e.target.parentNode&&(o("click","Clicked outside of autocomplete, closing."),r.die())};t.on("KeyDown",O,!0),t.on("KeyUp",j,!0),t.on("KeyPress",N,!0),t.on("Click",L,!0),r.word="",n.keepAlias?o("init","No suggestion based on previous or selected text"):r.word=w,s.AJS.Rte.showElement(E[0]),I=s.tinymce.DOM.getPos(E[0]),S=E.height(),r.left=I.x,r.top=I.y+S,r.text=function(e){var t=c()("#autocomplete-search-text",r.getContainer());return null!=e?(t.text(e),this):(e=s.AJS.escapeEntities(t.text())).replace(s.AJS.Rte.HIDDEN_CHAR,"")},r.plainText=function(e){var t=c()("#autocomplete-search-text",r.getContainer());return null!=e?(t.text(e),this):(e=t.text()).replace(s.AJS.Rte.HIDDEN_CHAR,"")};var B=function(t,n){var o=r.getContainer();return e.replaceWithTextAndGetRange(o,t,n)};return r.replaceWithSelectedSearchText=function(){var e=r.text();return o("replaceWithSelectedSearchText",e),B(e,!1),e},r.die=function(e){if(r.dying)o("die","Already dying, returning.");else{if(r.dying=!0,s.Confluence.PropertyPanel&&(s.Confluence.PropertyPanel.shouldCreate=!0),r.getContainer().length){o("die","Tearing down autocomplete, cleaning up autocompleter");var a=(e||n.backWords||p?"":r.settings.ch)+r.text();i=B(a,!0)}setTimeout(()=>{o("die","Removing autocomplete-control keyboard listeners."),t.off("KeyDown",O),t.off("KeyUp",j),t.off("Click",L),t.off("KeyPress",N)},1),s.AJS.Rte.unbindScroll("autocomplete"),c()(s.document).unbind("click.autocomplete-outside"),this.onDeath&&this.onDeath()}},s.AJS.Rte.bindScroll("autocomplete",()=>{o("scrolling:"),s.AJS.Rte.isAnyPartShown(E)?r.onScroll():r.die()}),c()(s.document).bind("click.autocomplete-outside",e=>{var t=e.srcElement&&"rte-insert-date"===e.srcElement.id;c()(e.target).closest("#autocomplete-dropdown, .aui-datepicker-dialog, .ui-datepicker-header").length||t||r.die()}),s.AJS.Rte.getEditor().on("BeforeExecCommand",e=>{"mceConfSavePage"==e.command&&r.die()}),r.update=function(e){nt(),B("",!0),this.settings.update(this,e)},r.removeSpan=function(){r.getContainer().remove()},r};ft.removeOrphanedControl=function(){var e=c()(s.AJS.Rte.getEditor().getDoc()),t=e.find("#autocomplete");if(!t.length)return null;var n=e.find("#autocomplete-trigger").text(),o=e.find("#autocomplete-search-text").text();return ft.replaceWithTextAndGetRange(t,o,!1),{leadingChar:n,content:o}},ft.replaceWithTextAndGetRange=function(e,t,n){if(e.length){t=t||"",n=n||!t;var o=s.AJS.Rte.getEditor(),r=e[0].parentNode,a=s.AJS.Rte.Content.getChildIndex(r,e[0]),i=n?1:0,l=o.selection.getRng();return l.setStart(r,a+i),l.setEnd(r,a+1),e.before(t||s.AJS.Rte.HIDDEN_CHAR).remove(),o.selection.setRng(l),l}console.log("replaceWithTextAndGetRange Error: attempting to replace a non-existent element")};var mt=function(e){return e.replace(/[&"'<>`]/g,e=>{var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return"string"==typeof t[e]?t[e]:"&quot;"})},pt=(e,t)=>{var n,o;if(e&&e.length&&e[0]){for(var r=[],a=0,i=e.length;a<i;a++){var l=e[a];l&&r.push(l.replace(/[.*+?|()[\]{}\\]/g,"\\$"))}n=new RegExp(`(${r.join("|")})`,"gi"),o=ct()(t||"<strong>{highlight}</strong>").fill({highlight:"$1"}).toString()}return{highlight:(e,t)=>e?(t||(e=ct.a.escape(e)),n?e.replace(n,o):e):e,safeHighlight(e){if(!e)return e;var t,r;if(n&&o){var a=o.split("$1");t=a[0],r=a[1],e=e.replace(n,"@@@hl@@@$1@@@endhl@@@")}return mt(e).replace(/@@@hl@@@/gi,t).replace(/@@@endhl@@@/gi,r)}}},ht=function e(t){if(!(this instanceof e))return new e(t);this.cache={},this.cacheStack=[],this.cacheSize=t||30};ht.prototype.get=function(e){var t=this.cache[e];if(t){var n=this.cacheStack[this.cacheStack.length-1][0]+1;return t.weight=n,this.cacheStack.push([n,e]),t.value}},ht.prototype.put=function(e,t){var n,o,r,a=this.cacheStack.length?this.cacheStack[this.cacheStack.length-1][0]+1:0;for(this.cache[e]={weight:a,value:t},this.cacheStack.push([a,e]);this.cacheStack.length>this.cacheSize;)o=(n=this.cacheStack.shift())[0],r=n[1],o===this.cache[r].weight&&delete this.cache[r]},ht.prototype.clear=function(){this.cache={},this.cacheStack=[]};var bt=ht,vt=function(e,t){var n=e.options;n.ajsDropDownOptions=n.ajsDropDownOptions||{};var o,r=(n.ajsDropDownOptions.Highlighter||pt)(t.queryTokens||[t.query]);n.ajsDropDownOptions.alignment||(n.ajsDropDownOptions.alignment="left"),n.ajsDropDownOptions.selectionHandler=n.ajsDropDownOptions.selectionHandler||yt,(o=e.dd)&&(o.hide(),o.$.remove());var a=e.dd=s.AJS.dropDown(t.matrix,n.ajsDropDownOptions)[0];if(n.ajsDropDownOptions.className&&a.$.addClass(n.ajsDropDownOptions.className),a.$.find("li a:not(.dropdown-prevent-highlight) span").each((function(){var e=c()(this);e.html(r.safeHighlight(e.text()))})),a.$.hasClass("fabric")){var i=a.$.find(".insert-mentions-dropdown-option");i.length===t.matrix[1].length&&t.matrix[1].forEach((e,t)=>{var n=r.safeHighlight(e.username);if(n){e.lozenge&&(n+=" &middot; "+e.lozenge);var o=c()("<span>").addClass("dropdown-lozenge").html(n);i.eq(t).append(o)}})}return n.dropdownPlacement?n.dropdownPlacement(a.$):(console.log("No dropdownPlacement function specified. Appending dropdown to the body."),c()("body").append(a.$)),function(e){var t=e.$.closest(".aui-dd-parent").width();t||(e.$.width("25em"),t=e.$.width()),c()("a span:not(.icon)",e.$).each((function(){var e=c()(this),n=s.document.createElement("var");n.innerHTML="&#8230;";var o=c()(n),r=o.width(),a=!1;e.wrapInner(c()("<em>")),c()("em",e).each((function(){var e=c()(this);if(e.show(),this.offsetLeft+this.offsetWidth+r>t-20){for(var n=this.childNodes,o=!1,i=n.length-1;i>=0;i--){var l=n[i],s=1,d=3===l.nodeType?"nodeValue":"innerHTML",u=l[d];do{if(!(s<=u.length))break;l[d]=u.substr(0,u.length-s++)}while(this.offsetLeft+this.offsetWidth+r>t-20);if(s<=u.length){o=!0;break}}o?a=!0:e.hide()}})),a&&(e.append(o),this.elpss=o)}))}(a),function(e){c()("a span:not(.icon)",e.$).each((function(){var e,t=c()(this);try{var n=t.data("properties");e=n?n.spaceName:null}catch(e){console.error("Problem getting space name: ",e.message)}var o=t.text();e&&(o+=` (${c()("<i></i>").html(e).text()})`),t.attr("title",o)}))}(a),n.dropdownPostprocess&&n.dropdownPostprocess(a.$),a.show(e._effect),"function"==typeof n.onShow&&n.onShow.call(a,a.$),a},yt=function(e,t){if("click"!=e.type){var n=c()("a",t).first(),o=n.attr("href");if("keydown"===e.type&&(e.metaKey||e.ctrlKey)&&13===e.which){var r=d.a.open(o,"_blank");r&&r.opener&&(r.opener=null)}else n.click(),s.document.location=o;e.preventDefault()}};function wt(e,t){this._effect="appear",this._timer=null,this.id=e,this.options=t,this.inactive=!1,this.busy=!1,this.cacheManager=bt()}wt.prototype.clearCache=function(){this.cacheManager.clear()},wt.prototype.change=function(e,t,n){var o=this;if(e!=o._value){o._value=e,o.busy=!1,d.a.clearTimeout(o._timer);var r=o.options.minLengthForGetData||2,a=new RegExp(`\\S{${r},}`);if(t||a.test(e)){var i=o.cacheManager.get(e);if(i)vt(o,i);else{o.busy=!0;var l=function(){o.options.getDataAndRunCallback.call(o,e,(function(){o.show.apply(this,arguments),n&&n(e)}))};0===o.options.dropDownDelay?l():o._timer=d.a.setTimeout(()=>{l()},o.options.dropDownDelay||200)}}else o.dd&&o.dd.hide(),n&&n(e)}},wt.prototype.hide=function(){this.dd&&this.dd.hide()},wt.prototype.remove=function(){var e=this.dd;e&&(this.hide(),e.$.remove()),this.inactive=!0,this.options.onDeath&&this.options.onDeath()},wt.prototype.show=function(e,t,n){if(this.inactive)console.log("Quick search abandoned before server response received, ignoring. ",this);else{var o={matrix:e,query:t,queryTokens:n};this.cacheManager.put(t,o),vt(this,o),this.busy=!1}};var Ct,At;gt("Autocompleter.Manager");var xt=function(e){var t=ut[e.leadingChar];if(e=c.a.extend({minLengthForGetData:t.minLengthForGetData,displayHandler:t.displayHandler,Highlighter:t.Highlighter,classNames:t.autocompleteClassNames},e),!(Ct=ft(s.AJS.Rte.getEditor(),e)))return!1;function n(e){return c.a.data(e,"properties")}Object(y.b)("synchrony.stop",{id:"confluence.autocomplete-plugin"});var o,r=c()(s.window).width(),a=function(e){var t,n,a=c()("#autocomplete-dropdown"),i=Ct.getContainer();a.length||(a=c()("<div></div>").addClass("aui-dd-parent quick-nav-drop-down").attr("id","autocomplete-dropdown").appendTo("body"));var l=s.AJS.Position.spaceAboveBelow(s.AJS.Rte.getEditorFrame(),i);e.find("ol:has(a.menu-header)").addClass("top-menu-item"),e.find("ol:empty").hide(),a.append(e);var d=c()("#autocomplete-dropdown .autocomplete").find("ol:has(a.menu-header)"),u=d.find("a").text();d.before(`<h2 id='titleForSR' class='top-menu-title'>${u}</h2>`),d.attr("tabindex","-1"),c()("#autocomplete-dropdown .autocomplete ol:not(.top-menu-item)").attr("role","listbox").attr("aria-controls","forSR").attr("tabindex","0");var g=c()("#autocomplete-dropdown .autocomplete ol:not(.top-menu-item) li");g.attr("role","presentation"),g.find("img").attr("role","none"),g.find("a").attr("role","option");var f=g.length;c()("<div></div>").addClass("hidden-div").attr("aria-atomic","true").attr("role","region").attr("aria-live","polite").attr("id","forSR").text(s.AJS.format("{0,choice,0#{0} results|1#{0} result|1\u003c{0} results} available for {1}",f,u)).appendTo(".autocomplete");var m=s.AJS.Rte.Content.offset(i),p=Math.max(a.width()+m.left-r+10,0),h=m.left-p-0,b=e.outerHeight(!0),v=b+10;o&&(function(e,t){return 1==o?e.above>=t:e.below>=t}(l,v)||(o=null)),o||(o=function(e,t){return e.below>=t?2:e.above>=t?1:e.below>e.above?2:1}(l,v)),(n=a.find(".autocomplete-dropdown-arrow")).length||(n=c()("<div>").addClass("autocomplete-dropdown-arrow").addClass(Ct.settings.autocompleteClassNames)),1===o?(n.addClass("autocomplete-dropdown-bottom-arrow").css({top:b-1}),t=m.top-b-10):(n.removeClass("autocomplete-dropdown-bottom-arrow").css("top",""),t=m.top+i.height()+10),n.css({left:p}).appendTo(a),a.css({position:"absolute",top:t,left:h})};At=(e=>new wt("inputdriven-dropdown",e))({onShow(e){Object(y.b)("rte-autocomplete-on-show",{triggerChar:Ct.settings.ch});var t=s.AJS.Rte.getEditorFrame();t&&t.shim&&t.shim.hide(),e.find("a.menu-header").unbind().click(e=>{e.preventDefault(),Ct.die()}),this.reset(),Ct.settings.selectFirstItem&&e.find("a:not('.menu-header')").length&&s.AJS.dropDown.current.moveDown()},dropdownPlacement:a,onDeath(){c()("#autocomplete-dropdown").remove()},ajsDropDownOptions:{selectionHandler:function(e,t){e.preventDefault();var o=n(t[0]);o&&"function"==typeof o.callback?o.callback(Ct):"menu-header"!==o.className&&Ct.update(o),Ct.die()},moveHandler:function(e,t){var n=s.AJS.dropDown.current;e&&e.find("a").is(".menu-header")&&("up"==t?n.moveUp():n.moveDown())},className:"autocomplete "+Ct.settings.dropDownClassName,displayHandler:e.displayHandler,Highlighter:e.Highlighter},getDataAndRunCallback(e){Ct&&Ct.settings.getDataAndRunCallback&&Ct.settings.getDataAndRunCallback(Ct,e,(t,n,o,r)=>{t.unshift([{className:"menu-header dropdown-prevent-highlight",href:"#",name:Ct.settings.getHeaderText(Ct,e)}]),t.push(Ct.settings.getAdditionalLinks(Ct,e,o)),At&&At.show(t,n,r||[n])})},dropDownDelay:Ct.settings.dropDownDelay,minLengthForGetData:Ct.settings.minLengthForGetData}),Ct.onBeforeKey=function(e,t){return 40===e.keyCode||38===e.keyCode||13===e.keyCode?(s.tinymce.dom.Event.cancel(e),!1):!(27===e.keyCode||9===e.keyCode||8===e.keyCode&&!t)||(this.die(8===e.keyCode),!1)},Ct.onKeyPress=function(e){var t=String.fromCharCode(e.which);return 13===e.keyCode?(s.tinymce.dom.Event.cancel(e),!1):(this.settings.endChars.includes(t)&&Ct.die(),!0)};var i=e.minLengthForGetData||2,l=new RegExp(`\\S{${i},}`);Ct.onAfterKey=function(e,t){if(40===e.keyCode||38===e.keyCode||13===e.keyCode){var n=s.AJS.dropDown.current;return!!n&&(-1==n.getFocusIndex()&&13===e.keyCode?(Mt(),!0):(e.which||(e.which=e.keyCode),n.moveFocus(e),c()("#forSR").text(""+n.links.closest("li.active")[0].outerText),!1))}var o=8===e.keyCode&&!t||d(t);return(o||l.test(t))&&At&&At.change(t,o),!0};var d=function(e){return/[\u4E00-\u9FFF]/gi.test(e)};return Ct.onDeath=function(){At&&(At.remove(),At.closing=!0),Object(y.b)("synchrony.start",{id:"confluence.autocomplete-plugin"})},Ct.onScroll=function(){At&&At.dd&&a(At.dd.$)},Ct.getCurrentItem=function(){if(!At||!At.dd)return null;var e=At.dd,t=e.getFocusIndex();return t<0?null:n(e.links[t])},At&&At.change(Ct.text(),!0),!0},Mt=function(){Ct.die(),Ct=null},kt={getInputDrivenDropdown:()=>At,triggerListener(e){if(!e.metaKey){At&&At.closing&&(At=null);var t=String.fromCharCode(e.which);!At&&t in ut&&xt({leadingChar:t})&&s.tinymce.dom.Event.cancel(e)}},shortcutFired(e,t){var n=t?0:1;return At&&At.closing&&(At=null),At&&(n=t?0:Ct.backWords+1,Mt()),xt({leadingChar:e,backWords:n})},reattach:function(){var e=ft.removeOrphanedControl();e&&kt.shortcutFired(e.leadingChar)}},Et=n(23),Tt=n.n(Et),Dt=(e,t)=>{ut[e]=t},It=(e,t,n)=>`<a href="#" class="${t||""}"><span class="icon ${n||""}"></span><span>${e}</span></a>`,St=function(e,t,n,o,r){var a;if(e.statusMessage)a=[[{html:e.statusMessage,className:"error"}]];else{var i=t?Tt.a.REST.makeRestMatrixFromSearchData(e):Tt.a.REST.makeRestMatrixFromData(e,o);a=Tt.a.REST.convertFromRest(i)}n(a,t,(function(e,t){r&&"function"==typeof r&&r(a,e,t)}))},Ot=(e,t,n,o,r,a,i)=>{var l,s=t(o),d=e.settings.cacheManager,u=d.get(o);s?((l=c.a.ajax({type:"GET",url:s,data:n(e,o),dataType:"json",global:!1,timeout:5e3})).done(e=>{d.put(o,e)}),u?St(u,o,r,a,i):(l.done(e=>{St(e,o,r,a,i)}),l.fail((e,t)=>{"timeout"==t&&St({statusMessage:"Timeout",query:o},o,r,a)}))):r([],o)};n(50);function jt(e){e.on("PostRender",()=>{console.log("Autocomplete enabled, adding keyPress listener"),e.on("keypress",kt.triggerListener,!0),Object(y.b)("ready-editor-autocomplete")}),e.on("Undo",kt.reattach),e.on("Redo",kt.reattach)}"object"!=typeof d.a.Confluence&&(d.a.Confluence={}),void 0===d.a.Confluence.Editor&&(d.a.Confluence.Editor={}),d.a.Confluence.Editor.Autocompleter={Settings:ut,log:gt,Util:{dropdownLink:It,getRestData:Ot},Control:ft,Manager:kt},Object(dt.a)("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager",()=>kt),Object(dt.a)("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings",()=>({Settings:ut,log:gt}));var Nt=n(28),Lt=n(4),Bt=e=>e?w.a+"/rest/prototype/1/search.json":g.a.get("remote-user")?w.a+"/rest/prototype/1/session/history.json":null,Pt=(e,t)=>{var n={"max-results":e.maxResults};return t&&(n.query=Object(Nt.unescapeEntities)(t),n.search="name",n.preferredSpaceKey=g.a.get("space-key")),n},Rt=()=>Dt("[",{ch:"[",cache:!1,endChars:["]"],dropDownClassName:"autocomplete-links",selectFirstItem:!0,getHeaderText:()=>Object(Lt.a)("editor.autocomplete.links.header.text"),getAdditionalLinks(e,t,n){var o;if(t){var r=Object(Lt.a)("editor.autocomplete.links.dialog.search");o=s.AJS.format(r,t)}else o=Object(Lt.a)("editor.autocomplete.links.dialog.search.no.text");var a=s.Confluence.Editor.LinkBrowser,i=[{className:"search-for",name:o,href:"#",callback(e){e.replaceWithSelectedSearchText();var t=a.open({panelKey:a.SEARCH_PANEL});t.doSearch(t.getLocationPresenter().getRawLinkText())}},{className:"dropdown-insert-link",html:It(Object(Lt.a)("editor.autocomplete.links.web.link"),"dropdown-prevent-highlight","editor-icon"),callback(e){e.replaceWithSelectedSearchText(),a.open({panelKey:a.WEBLINK_PANEL})}}];return n&&n(t,i),i},getDataAndRunCallback(e,t,n){Ot(e,Bt,Pt,t,n,"content",(function(e,t,n){var o;t&&(e.length<2||("page"!==(o=e[1][0].restObj).type||o.space.key!=g.a.get("space-key")||o.title.toLowerCase()!==t.toLowerCase()))&&n.push({className:"insert-create-page-link",html:It(Object(Lt.a)("editor.autocomplete.links.create.link"),"dropdown-prevent-highlight","editor-icon"),callback(e){var n=Object(Nt.unescapeEntities)(t),o=s.Confluence.Link.createLinkToNewPage(n,g.a.get("space-key"));e.update(o)}})}))},update(e,t){t.restObj&&(t=s.Confluence.Link.fromREST(t.restObj)),t&&t.insert()}});function Ht(e){e.addCommand("mceConfAutocompleteLink",()=>(kt.shortcutFired("["),!1)),e.addShortcut("meta+shift+k",e.translate("AutoCompleteLink"),"mceConfAutocompleteLink"),Rt()}var zt=n(15),Ft=n.n(zt);function Ut(){var e=g.a.get("content-id");return+e||(e=g.a.get("page-id")),+e||(e="0"),e}var _t=0,Wt={updateNode(e,t){var n=s.tinymce.activeEditor,o=c()(e,n.getDoc()),r="confluence.update-node-"+_t++;Object(y.b)("synchrony.stop",{id:r});var a=Wt.prepareNodeForUpdate(o);return Wt.replaceNode(o,t).fail(a).always(()=>{Object(y.b)("synchrony.start",{id:r})}).promise()},storeNodeState(e,t){for(var n,o={},r=0,a=t.length;r<a;r++)n=t[r],o[n]=e.attr(n);return()=>{for(var t in o)e.attr(t,o[t])}},prepareNodeForUpdate(e){var t;return e.is("img")&&(t=Wt.storeNodeState(e,["width","height","src","class"]),e.addClass("image-hotswap").attr({src:w.a+"/images/border/spacer.gif",width:e.attr("width"),height:e.attr("height")})),t},replaceNode(e,t){var n=Wt.getDoc(),o=c()(t,n),r=c()(e,n),a="confluence.replace-node-"+_t++;return Object(y.b)("synchrony.stop",{id:a}),c.a.Deferred((function(){var e=this;o.is("img")?(o[0].onload=function(){this.onload=null,e.resolve(this)},s.tinymce.Env.opera&&(o[0].src=o.attr("src")),n.createDocumentFragment().appendChild(o[0])):(o.is("table.wysiwyg-macro")&&o.attr("data-mce-resize","false"),e.resolve(o[0]))})).always(()=>{Object(y.b)("synchrony.start",{id:a})}).done(e=>{r.replaceWith(e)}).promise()},replaceSelection(e){var t=s.tinymce.activeEditor,n=t.selection.getRng(),o=t.getDoc().createRange(),r=c()(e).clone(!0,!1)[0];n.deleteContents(),3===n.startContainer.nodeType&&""===n.startContainer.nodeValue&&(n.startContainer.nodeValue=u().HIDDEN_CHAR),n.insertNode(r);var a=t.getDoc().createTextNode(u().HIDDEN_CHAR);t.dom.insertAfter(a,r);var i=a;return o.setStartBefore(i),o.setEndAfter(i),o.collapse(!1),t.selection.setRng(o),r},normalize(e){var t,n,o=s.tinymce.activeEditor,r=o.selection.getRng(),a=null,i=[];if(e&&e.childNodes){if(s.tinymce.Env.webkit?a=r:s.tinymce.Env.gecko&&r&&(a=r.cloneRange(),((t={startIndex:Array.from(e.childNodes).indexOf(r.startContainer),startOffset:a.startOffset,endIndex:Array.from(e.childNodes).indexOf(r.endContainer),endOffset:a.endOffset}).startIndex>-1||t.endIndex>-1)&&(i=function(e){var t=[],n=0;return Array.prototype.forEach.call(e.childNodes,(e,o)=>{var r={},a=t[o-1]||{};r.isTextNode=3===e.nodeType,r.textNodesBefore=(r.isTextNode&&a.isTextNode?1:0)+~~a.textNodesBefore,r.precedingTextLength=n,n=r.isTextNode&&e.nodeValue?n+e.nodeValue.length:0,t.push(r)}),t}(e))),e.normalize(),s.tinymce.Env.gecko&&a){if(n=i[t.startIndex]){var l=t.startIndex-n.textNodesBefore,c=t.startOffset+n.precedingTextLength;a.setStart(e.childNodes[l],c)}if(n=i[t.endIndex]){var d=t.endIndex-n.textNodesBefore,u=t.endOffset+n.precedingTextLength;a.setEnd(e.childNodes[d],u)}}a&&o.selection.setRng(a)}},getDoc:()=>s.tinymce.Env.gecko||s.tinymce.Env.opera?document:s.tinymce.activeEditor.getDoc(),isolateSelectedRange(){var e=s.tinymce.activeEditor,t=Wt.getDoc(),n=e.selection,o=n.getRng();if(o){var r,a=o.startContainer,i=o.startOffset,l=o.endContainer,d=o.endOffset;if(o.collapsed)return o;a===l&&(r=d-i);var u=f(a,i);u&&o.setStartBefore(u),a!==o.startContainer&&(d=r||d);var g=f(l,d,!0);return g&&o.setEndAfter(g),n.setRng(o),o}function f(n,o,r){var a=e.dom.getParent(n,e.dom.isBlock);a||(a=e.getBody());var i=function(e,n,o,r){var a,i,l=null,s=null,d=r?"nextSibling":"previousSibling";if(!(a=0===n)&&r&&(a=3===e.nodeType?n===e.length:n===e.childNodes.length),a)for(l=e[d],s=e;null===l;){if(s===o)return;if(s.parentNode===o)break;l=(s=s.parentNode)[d]}else 3===e.nodeType?(i=e.data,e.data=i.slice(n),l=t.createTextNode(i.slice(0,n)),s=e,c()(l).insertBefore(s),r&&(i=s,s=l,l=i)):l=(s=e.childNodes[n-(r?1:0)])[d];return[s,l]}(n,o,a,r);return i?i[1]?function(e,t,n,o){for(var r,a,i,l;t!==n&&t.parentNode!==n;){if(r=(a=t.parentNode).cloneNode(!1),o)for(c()(r).insertAfter(a),i=e;i;)l=i.nextSibling,r.appendChild(i),i=l;else for(c()(r).insertBefore(a),i=a.firstChild;i!==t;)l=i.nextSibling,r.appendChild(i),i=l;e=r,t=a}return t}(i[1],i[0],a,r):i[0]:void 0}}},Qt=Wt;function Vt(e){return c()(e).hasClass("wysiwyg-macro")}function $t(e,t){var n;if(e.macro&&e.contentId)n={type:"POST",url:w.a+"/rest/tinymce/1/macro/placeholder",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"text"};else{if(!e.url||!e.type)throw new Error("illegal argument received: "+e);n=e}var o,a=c.a.Deferred(),i=s.tinymce.activeEditor;if(!t){var l="macro-"+(new Date).getTime();o=i.dom.create("span",{id:l}),i.selection.setNode(o),t=o=i.dom.select("#"+l)[0],a.fail(()=>{c()(o).remove()})}return c.a.extend(n,{timeout:this.DEFAULT_INSERT_MACRO_TIMEOUT}),r.a.Editor.UI.setButtonsState(!1),c.a.ajax(n).done((function(e){var n=e;function o(e){return e&&e.parentNode}"<"!==n[0]&&(n=document.createTextNode(n)),o(t)?Qt.updateNode(t,n).done(e=>{a.resolve(e,n)}).fail(a.reject):a.rejectWith(this,Array.from(arguments))})).fail((function(e,t,n){a.rejectWith(this,Array.from(arguments))})),a.done((e,t)=>{r.a.Editor.UI.setButtonsState(!0),Vt(e)&&/P|H\d/.test(e.parentNode.nodeName)&&i.dom.split(e.parentNode,e),function(e){var t=s.tinymce.activeEditor,n=t.getDoc(),o=t.selection.getRng();if(Vt(e)){c()("p, pre",e).each((e,t)=>{0===t.childNodes.length&&t.appendChild(n.createElement("br"))});var r=t.dom.select(".wysiwyg-macro-body",e)[0].firstChild;r&&(o.setStart(r,0),o.setEnd(r,0))}else o.setStartAfter(e),o.setEndAfter(e);t.selection.setRng(o)}(e),i.nodeChanged(),u().showElement(e),i.fire("SetContent",{content:t,format:"html",selection:!0}),s.tinymce.activeEditor.undoManager.add(),Object(y.b)("macro-browser.macro-inserted")}).fail(()=>{r.a.Editor.UI.setButtonsState(!0)}),a.promise()}var Kt={DEFAULT_INSERT_MACRO_TIMEOUT:5e3,insertMacro:$t,isInMacro:e=>c()(e).closest(".wysiwyg-macro").length>0,updateMacro:(e,t,n,o)=>$t({contentId:Ut(),macro:{name:n,params:e,body:t||""}},o)},Gt=Kt;var Yt={storedRange:null,bookmark:null,editedMacroDiv:null,editedMacro:null,getCurrentNode:()=>c()(s.tinymce.activeEditor.selection.getNode()),isMacroDiv:e=>c()(e).hasClass("wysiwyg-macro"),isMacroTag(e){var t=c()(e);return t.hasClass("wysiwyg-macro")||t.hasClass("editor-inline-macro")},isBodylessMacro:e=>c()(e).hasClass("editor-inline-macro"),isMacroWithBody:e=>c()(e).hasClass("wysiwyg-macro"),isMacroStartTag:e=>c()(e).hasClass("wysiwyg-macro-starttag"),isMacroEndTag:e=>c()(e).hasClass("wysiwyg-macro-endtag"),isMacroBody:e=>c()(e).hasClass("wysiwyg-macro-body"),hasMacroBody:e=>"true"==c()(e).attr("macrohasbody"),getNestingMacros(e){var t=c()(e||Yt.getCurrentNode()),n=[];return t.parents(".wysiwyg-macro").each((e,t)=>{n.push(c()(t).attr("data-macro-name"))}),n},logMCESelection(e){s.tinymce.activeEditor.selection},getSelectedMacro(){var e=Yt.getCurrentNode();return Yt.isMacroDiv(e)?e:Gt.isInMacro(e)},openMacro(e){r.a.MacroBrowser.open({selectedMacro:e,onComplete:Yt.macroBrowserComplete,onCancel:Yt.macroBrowserCancel})},editMacro(e){var t=c()(e);Yt.editedMacroDiv=t[0];var n=s.tinymce.activeEditor.serializer.serialize(t.clone()[0],{forced_root_block:!1});s.tinymce.activeEditor.selection.select(t[0]),nt(),c.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:w.a+"/rest/tinymce/1/macro/definition",data:JSON.stringify({contentId:Ut(),macroHtml:n}),dataType:"text",success(e){Yt.openMacro(JSON.parse(e))}})},macroBrowserToolbarButtonClicked(e){var t=s.tinymce.activeEditor,n=Yt.getCurrentNode();nt();var o=c.a.extend({presetMacroName:null,nestingMacros:Yt.getNestingMacros(n),onComplete:Yt.macroBrowserComplete,onCancel:Yt.macroBrowserCancel,mode:"insert",selectedHtml:"",selectedText:""},e);if((!e||e&&!e.ignoreEditorSelection)&&(o.selectedHtml=t.selection.getContent(),o.selectedText=t.selection.getContent({format:"text"})),"function"!=typeof r.a.MacroBrowser.Model.addMacro)return r.a.MacroBrowser.open(o);var a=o.presetMacroMetadata&&o.presetMacroMetadata.macroName||o.presetMacroName,i=r.a.MacroBrowser.getMacroMetadata(a);i?(o.presetMacroMetadata=o.presetMacroMetadata||i,r.a.MacroBrowser.open(o)):r.a.MacroBrowser.Rest.fetchMacroMetadataDetails({id:o.presetMacroName,successCallback:e=>{e&&e.details?(r.a.MacroBrowser.Model.addMacro(e.details),o.presetMacroMetadata=r.a.MacroBrowser.getMacroMetadata(o.presetMacroName),Object(y.a)("reset.complete",(function e(){r.a.MacroBrowser.open(o),Object(y.c)("reset.complete",e)})),Object(y.b)("reset.rte")):r.a.MacroBrowser.open(o)},errorCallback:e=>{console.log("AJS.MacroBrowser.Rest.fetchMacroMetadataDetails ERROR",e)}})},macroBrowserComplete(e){var t={contentId:g.a.get("content-id")||"0",macro:{name:e.name,params:e.params,defaultParameterValue:e.defaultParameterValue,body:e.bodyHtml}};ot(),Yt.editedMacroDiv?(Gt.insertMacro(t,Yt.editedMacroDiv),delete Yt.editedMacroDiv):Gt.insertMacro(t)},macroBrowserCancel(){ot(),Yt.editedMacroDiv=null,Yt.editedMacro=null}},Jt=Yt;function qt(){function e(e){c()("#autocomplete-dropdown .top-menu-item").spin(e)}function t(e,t){var n=t.presetMacroMetadata;e.replaceWithSelectedSearchText(),n?Ft.a.hasRequiredParameters(n)||n.alwaysShowConfig?Jt.macroBrowserToolbarButtonClicked(t):(nt(),Gt.insertMacro({contentId:g.a.get("content-id")||"0",macro:{name:n.macroName,body:""}})):Jt.macroBrowserToolbarButtonClicked(t)}function n(e){if(e.hidden&&!Ft.a.isHiddenMacroShown(e))return null;var n={className:"autocomplete-macro-"+e.macroName,callback(n){t(n,{ignoreEditorSelection:!0,presetMacroMetadata:e})}};return e.icon?(n.name=e.title,n.href="#",n.icon=(e.icon.relative?g.a.get("static-resource-url-prefix"):"")+e.icon.location):n.html=It(e.title),n}Dt("{",{ch:"{",cache:!1,endChars:["}",":","{"],dropDownClassName:"autocomplete-macros",dropDownDelay:0,selectFirstItem:!0,getHeaderText:()=>Object(Lt.a)("editor.autocomplete.macros.header.text"),getAdditionalLinks:()=>[{className:"dropdown-insert-macro",html:It(Object(Lt.a)("editor.autocomplete.macros.dialog.browse"),"dropdown-prevent-highlight","editor-icon"),callback(e){var n=e.text();t(e,{searchText:n})}}],getDataAndRunCallback(t,o,a){var i=Ft.a.getMetadataPromise(),l=this,s=arguments;function d(){var r;r=o?function(e){for(var o=[],r=Ft.a.searchSummaries(e,{keywordsField:"keywordsNoDesc"}),a=0,i=r.length;a<i;a++){var l=n(r[a]);if(l&&o.push(l)==t.maxResults)break}return o}(o):function(e){var t=[];return c()("#macro-insert-list li").each((o,r)=>{var a=c()(r),i=e.find(e=>e.macroName===a.attr("data-macro-name"));if(i){var l=n(i);l&&t.push(l)}}),t}(Ft.a.metadataList),e(!1),a([r],o)}function u(e){e.preventDefault(),e.stopPropagation(),Object(y.b)("analytics",{name:"autocomplete-macrobrowser.load-retry"}),Ft.a.reset(),Ft.a.preLoadMacro(),l.getDataAndRunCallback.apply(l,s)}l.alreadyBinded||(l.alreadyBinded=!0,i.always(()=>{d(),l.alreadyBinded=!1}),i.fail(()=>{Object(y.b)("analytics",{name:"autocomplete-macrobrowser.fail-to-load"}),r.a.messages.warning("#autocomplete-dropdown ol:nth(1)",{title:Object(Lt.a)("editor.autocomplete.macros.error.load.header"),body:`<p><a id="macro-retry-link" href="#">${Object(Lt.a)("editor.autocomplete.macros.error.load.retrylink")}</a></p>`}),c()("#macro-retry-link").click(u),c()("#autocomplete-dropdown ol").eq(1).show()})),"pending"===i.state()&&(a([],o),e(!0))},update(){throw new Error("All items in the Macro Autocomplete dropdown must have a callback function")}})}var Zt=()=>{Object(y.a)("init.rte",()=>{Object(y.a)("rte-autocomplete-on-show",(e,t)=>{"!"===t.triggerChar&&Object(y.b)("analytics",{name:"confluence.editor.autocomplete.trigger",data:{type:"media"}})}),Object(y.a)("rte-autocomplete-on-insert",(e,t)=>{"!"===t.triggerChar&&(e=>{if(e&&e.name){var t={extension:e.name.split(".").pop(),type:"media"};Object(y.b)("analytics",{name:"confluence.editor.autocomplete.insert",data:t})}})(t.selectedFile)})}),Object(y.a)("rte-destroyed",()=>{Object(y.c)("rte-autocomplete-on-insert"),Object(y.c)("rte-autocomplete-on-show")})},Xt=n(21),en=n.n(Xt),tn=n(36),nn=n.n(tn);function on(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function rn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var an=e=>{var t=g.a.get("content-id");return e?w.a+"/rest/prototype/1/search.json":+t?`${w.a}/rest/prototype/1/content/${t}/attachments.json`:null},ln=(e,t)=>{var n=s.AJS.MacroBrowser.getMacroMetadata("view-file")?[]:["image","word","excel","pdf","powerpoint","multimedia"];return t?{type:"attachment",attachmentType:n,search:"name","max-results":e.maxResults,query:t}:{attachmentType:n,"max-results":e.maxResults}},cn=()=>Dt("!",{ch:"!",cache:!1,endChars:["!"],dropDownClassName:"autocomplete-media",selectFirstItem:!0,getHeaderText:()=>s.AJS.MacroBrowser.getMacroMetadata("view-file")?Object(Lt.a)("editor.autocomplete.file.header.text"):Object(Lt.a)("editor.autocomplete.media.header.text"),getAdditionalLinks(){var e=Object(Lt.a)("editor.autocomplete.media.files.dialog.browse");return[{className:"dropdown-insert-image",html:It(e,"dropdown-prevent-highlight","editor-icon"),callback(e){e.replaceWithSelectedSearchText(),s.Confluence.Editor.defaultInsertImageDialog()}},{className:"dropdown-insert-macro",html:It(Object(Lt.a)("editor.autocomplete.media.macros.dialog.browse"),"dropdown-prevent-highlight","editor-icon"),callback(e){e.replaceWithSelectedSearchText(),s.tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked({selectedCategory:"media"})}}]},getDataAndRunCallback(e,t,n){Ot(e,an,ln,t,n,"attachment")},update(e,t){Object(y.b)("rte-autocomplete-on-insert",{triggerChar:"!",selectedFile:t});var n=t.restObj,o=s.AJS.REST.wikiLink(n),r=n&&n.title||t.name;if("Image"==n.niceType){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?on(Object(n),!0).forEach((function(t){rn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):on(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({filename:r,contentId:t.ownerId||n.ownerId},o.params);s.tinymce.confluence.ImageUtils.insertFromProperties(a)}else{var i=!!s.AJS.MacroBrowser.getMacroMetadata("view-file"),l=n.contentType,c="VANILLA"!==g.a.get("confluence-flavour");if(i&&(c&&!(l&&"application/x-shockwave-flash"===l)||l&&("audio/mp3"===l||"video/mp4"===l)||"Multimedia"!==n.niceType)){var d={name:r,page:n.parentTitle,space:n.space?n.space.key:"",date:n.datePath,ownerId:n.ownerId};en.a.insertFilePlaceholder(d)}else this._insertFile(r,t,o)}},_insertFile(e,t,n){var o;switch(t.restObj.niceType){case"PDF Document":o="viewpdf";break;case"Word Document":o="viewdoc";break;case"Excel Spreadsheet":o="viewxls";break;case"PowerPoint Presentation":o="viewppt";break;case"Multimedia":o="multimedia"}var r={page:n.destination.substring(0,n.destination.indexOf("^")),name:e};nn.a.get("viewdoc").beforeParamsRetrieved(r),r.page||delete r.page;var a={contentId:g.a.get("content-id")||"0",macro:{name:o,params:r,body:""}};s.tinymce.confluence.MacroUtils.insertMacro(a)}});function sn(e){e.addCommand("mceConfAutocompleteImage",()=>(kt.shortcutFired("!"),!1)),e.addShortcut("meta+shift+m",e.translate("AutoCompleteImage"),"mceConfAutocompleteImage"),cn(),Zt()}function dn(e,t,n){"cl.ly"==e.host?c.a.get(`${w.a}/rest/autoconvert/1.0/cloudappembed?resource=${e.path.substr(1)}`,e=>{var o;if(e)switch(e.item_type){case"image":o=mt(e.content_url),n(c()(`<img class="confluence-embedded-image confluence-external-resource" src="${o}" data-image-src="${o}"/>`)[0]);break;case"bookmark":t.text(e.name),t.attr("href",mt(e.redirect_url)),n(t)}else n()}):n()}function un(){var e=this,t=function(e,t){return t.anchor&&0!==t.anchor.indexOf("comment-")?`${e}#${t.anchor.substring(t.anchor.indexOf("-")+1)}`:e},n=function(n,r,a){if(o(n)){var i=function(e){return w.a?e.path.substring(w.a.length+1):e.path.substring(1)}(n),l=decodeURIComponent(i).split("/"),d="";n.queryKey=n.queryKey||{},n.queryKey.focusedCommentId?(d="$"+n.queryKey.focusedCommentId,d=t(d,n)):n.queryKey.pageId?(d="$"+n.queryKey.pageId,d=t(d,n)):"display"===l[0]?d=function(e,n,o){return 2===o.length&&0===o[1].indexOf("~")?n=o[1]:3===o.length?(n=`${o[1]}:${o[2].replace(/\+/g," ")}`,n=t(n,e)):4===o.length&&"status"===o[1]?n="$"+o[3]:6===o.length&&(n=o[1]+":"+`/${o[2]}/${o[3]}/${o[4]}/${o[5].replace(/\+/g," ")}`,n=t(n,e)),n}(n,d,l):"spaces"===l[0]?d=(d=(d=e.spaViewPageLinkHandler(l))||e.spaBlogPostLinkHandler(l))?t(d,n):function(e,n,o){return 2!==o.length&&3!==o.length||-1!==o[1].indexOf(".action")||(n=o[1]+":",n=t(n,e)),n}(n,d,l):"users"===l[0]?d=function(e,t,n){return 2===n.length&&"viewuserprofile.action"==n[1]?t="~"+e.queryKey.username:2===n.length&&"viewmyprofile.action"==n[1]&&(t="~"+g.a.get("remote-user")),t}(n,d,l):"pages"===l[0]&&"viewpage.action"===l[1]&&n.queryKey&&n.queryKey.spaceKey&&n.queryKey.title&&(d=`${n.queryKey.spaceKey}:${n.queryKey.title.replace(/\+/g," ")}`),d?(d=`[${d}]`,s.tinymce.plugins.Autoconvert.getHtmlFromWikiMarkup(d,e=>{a(c()(e).children()[0])},()=>{a()})):a()}else a()},o=function(e){var t=!0;return t=t&&e.authority===s.document.location.host,t=t&&(!w.a||0===e.path.indexOf(w.a)),t};this.init=function(){s.tinymce.plugins.Autoconvert.autoConvert.addHandler(n)}}un.prototype.spaViewPageLinkHandler=function(e){var t="spaces"===e[0]&&"pages"===e[2],n="edit"===e[3]?e[4]:e[3];if(t&&n)return"$"+n},un.prototype.spaBlogPostLinkHandler=function(e){var t="spaces"===e[0]&&"blog"===e[2],n=e[1],o=e[3],r=e[4],a=e[5],i=e[6],l=e[7];if(t&&n&&o&&r&&a&&i&&l)return`${n}:/${o}/${r}/${a}/${l.replace(/\+/g," ")}`};function gn(){s.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(e,t,n){if(e.host.match(/google.*/)&&"/url"===e.path&&e.queryKey&&e.queryKey.url){var o=decodeURIComponent(e.queryKey.url);(t=c()(t)).attr("href",o),t.attr("data-mce-href",o),t.text(o),n(t)}else n()}))}var fn={issueKeyOnlyRegEx:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/,singleTicketXMLEx:/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,issueKeyWithinRegex:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)(?:\?|#)/,jqlRegEx:/jqlQuery=([^&]+)/,jqlRegExAlternateFormat:/jql=([^&]+)/,_getMatchedServerFromLink(e,t){var n=null;for(var o in t)if(t.hasOwnProperty(o)){var r=t[o],a=r.url;if("/"!==r.url[r.url.length-1]&&(a+="/"),0===e.indexOf(a)){n=r;break}}return n},pasteHandler(e,t,n){var o=r.a.Editor.JiraConnector.servers;if(!o)return n(),null;var a=r.a.Editor.JiraAnalytics,i={},l=fn._getMatchedServerFromLink(e.source,o),c=null;if(l){var d="",u=fn.jqlRegEx.exec(e.source)||fn.jqlRegExAlternateFormat.exec(e.source),g=r.a.JQLHelper.isFilterUrl(e.source),f=fn.issueKeyOnlyRegEx.exec(e.source)||fn.issueKeyWithinRegex.exec(e.source);if(f?(d=f[2],a&&(i.type=a.linkTypes.jql)):(f=fn.singleTicketXMLEx.exec(e.source))&&(d=f[1],a&&(i.type=a.linkTypes.xml)),u)i.is_single_issue=!1,i.type=r.a.JQLHelper.checkQueryType(e.source),c={name:"jira",params:{server:l.name,serverId:l.id,jqlQuery:decodeURIComponent(u[1].replace(/\+/g,"%20"))}};else if(g){var m=e.source;i.is_single_issue=!1,i.type=r.a.JQLHelper.checkQueryType(m),c={name:"jira",params:{server:l.name,serverId:l.id,jqlQuery:r.a.JQLHelper.getFilterFromFilterUrl(m)}}}else d&&(i.is_single_issue=!0,c={name:"jira",params:{server:l.name,serverId:l.id,key:d}})}c?(s.tinymce.plugins.Autoconvert.convertMacroToDom(c,n,n),a&&a.triggerPasteEvent(i)):n()}};var mn=function(){var e=[],t=function(e){return e.indexOf("%s")>=0?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace("%s","(.*)"):e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+"(.*)"};s.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(t,n,o){if(t.source===n.text()){for(var r=0;r<e.length;r++){var a=e[r],i=t.source.match(a.regex);if(i){var l=i[1];if(a.defaultAlias){var s=a.defaultAlias.replace(/%s/,l);return void o(c()(n).text(s))}return void o(c()(n).text(l))}}o()}else o()})),setTimeout(()=>{c.a.ajax({url:w.a+"/rest/autoconvert/latest/shortcutlinkconfigurations",type:"GET",dataType:"json",success(n){e=n.configurations;for(var o=0;o<e.length;o++){var r=e[o];try{r.regex=new RegExp(t(r.expandedValue))}catch(e){console.log("Failed to generated regex for "+r)}}},error(e){console.log("Failed to load shortcut link configurations "+e.statusText)}})},0)},pn={pasteHandler(e,t,n){"www.skitch.com"===e.host||"skitch.com"===e.host?c.a.get(`${w.a}/rest/autoconvert/1.0/skitchembed?url=${e.source}`,e=>{e&&e.url?n(c()(`<img class="confluence-embedded-image confluence-external-resource" src="${e.url}" data-image-src="${e.url}"/>`)[0]):n()}):n()}},hn=/^\/(.*?)\/status\/([^/]+\/?$)/,bn=/^\/(.*?)\/statuses\/([^/]+\/?$)/,vn=(e,t,n)=>{var o,r,a;e.host.match(/^twitter.com/)?((o=decodeURI(e.path).match(hn))?r=`${e.protocol}://twitter.com/${o[1]}/status/${o[2]}`:(o=decodeURI(e.path).match(bn))&&(r=`${e.protocol}://twitter.com/${o[1]}/statuses/${o[2]}`),r?(a={name:"widget",params:{url:r}},s.tinymce.plugins.Autoconvert.convertMacroToDom(a,n,n)):n()):n()};function yn(){var e=[/youtube-nocookie.com\/embed\/?/,/youtube.com\/watch\?/,/vimeo.com\/[0-9]+/,/[^.]\.wufoo\.com\/(?:forms|reports)/];s.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(t,n,o){for(var r=decodeURI(t.source),a=0;a<e.length;a++)if(r.match(e[a])){var i={name:"widget",params:{url:r}};return void s.tinymce.plugins.Autoconvert.convertMacroToDom(i,o,o)}o()}))}function wn(){s.tinymce.plugins.Autoconvert.autoConvert.addHandler((e,t,n)=>{if(e.host.match(".*youtu.be.*")){var o="http://youtube.com/watch?v="+e.path.substr(1);n(c()(t).attr("href",o).text(o))}else n()})}function Cn(){var e;Object(y.a)("init.rte",()=>{s.tinymce.plugins.Autoconvert.autoConvert.addHandler(dn)}),e=new un,Object(y.a)("init.rte",e.init),Object(y.a)("init.rte",gn),Object(y.a)("init.rte",mn),Object(y.a)("init.rte",()=>{s.tinymce.plugins.Autoconvert.autoConvert.addHandler(pn.pasteHandler)}),Object(y.a)("init.rte",yn),Object(y.a)("init.rte",wn),Object(y.a)("init.rte",()=>{s.tinymce.plugins.Autoconvert.autoConvert.addHandler(fn.pasteHandler)}),Object(y.a)("init.rte",()=>s.tinymce.plugins.Autoconvert.autoConvert.addHandler(vn))}var An,xn,Mn,kn='img[src^="data:image"]:not(.editor-inline-macro)',En=!1,Tn=()=>{s.AJS&&s.AJS.Rte&&s.AJS.Rte.BootstrapManager&&s.AJS.Rte.BootstrapManager.addOnInitCallback(()=>{var e=s.tinymce.activeEditor;e&&e.on("Paste",e=>{Dn(e),s.tinymce.dom.Event.cancel(e)})})},Dn=e=>{if(e.clipboardData&&e.clipboardData.items.length){En||(s.Confluence.Uploader.bind("FileUploaded",jn),s.Confluence.Uploader.bind("UploadComplete",Nn),En=!0),An=[],xn=0;var t=Array.from(e.clipboardData.types);console.debug("clipboardData types: ",t),console.debug("clipboardData files: ",e.clipboardData.files),console.debug("clipboardData text/plain: ",e.clipboardData.getData("text/plain")),console.debug("clipboardData text/html: ",e.clipboardData.getData("text/html")),console.debug("clipboardData text/rtf: ",e.clipboardData.getData("text/rtf")),console.debug("clipboardData image/svg+xml: ",e.clipboardData.getData("image/svg+xml"));var n="Files"===t.toString()||t.sort().toString()===["image/svg+xml","Files"].sort().toString(),o=t.sort().toString()===["text/plain","Files"].sort().toString()||t.sort().toString()===["text/html","text/plain","Files"].sort().toString();Array.from(e.clipboardData.items).forEach((t,o)=>{if(console.debug("clipboardData.items item.kind",t.kind),console.debug("clipboardData.items item.type",t.type),console.debug("clipboardData.items item",t),n&&"file"===t.kind){var r=t.getAsFile();r&&In(r,o)}else if(!n&&"string"===t.kind&&"text/html"===t.type){var a=e.clipboardData.getData("text/html");(new DOMParser).parseFromString(a,"text/html").querySelectorAll(kn).forEach((e,t)=>{Sn(e,t)})}}),o&&setTimeout(()=>{e.currentTarget&&e.currentTarget.querySelectorAll(kn).forEach((e,t)=>{Sn(e,t)})})}},In=(e,t)=>{var n=On(e,e.size,t);s.Confluence.Uploader.upload([n])},Sn=(e,t)=>{try{var n=e.getAttribute("src"),o=decodeURI(n).split(",")[1].split(" ").join("").replace(/\r?\n|\r/g,""),r=atob(o).length;s.Confluence.Uploader.upload([On(o,r,t,"base64")])}catch(t){s.Confluence.EditorNotification.notify("warning",s.tinymce.activeEditor.translate("base64image.warning")),e.remove(),console.error("Fail to decode: ",e.getAttribute("src")),console.error(t)}},On=(e,t,n,o)=>{var r=new Date,a=r.getMonth()+1,i=n?"-"+n:"";return{fileName:`image-${r.getFullYear()}-${a}-${r.getDate()}_${r.getHours()}-${r.getMinutes()}-${r.getSeconds()}${i}.png`,fileSize:t,slice:(t,n)=>e.slice(t,t+n),getAsBinary:()=>e,getData:()=>e,encoding:o}},jn=(e,t,n)=>{An.length||(An=s.tinymce.activeEditor.getDoc().querySelectorAll(kn)),An.length&&(An[xn].outerHTML=JSON.parse(n.response).htmlForEditor,xn++)},Nn=()=>{s.tinymce.activeEditor.getDoc().querySelectorAll(kn).forEach(e=>e.remove())};function Ln(e){return c()("<div>").append(e.cloneNode(!0)).html()}function Bn(e){var t,n;if(!e||!e.collapsed)throw new Error("range is null or not collapsed");if(t=e.startContainer,n=e.startOffset,1===t.nodeType&&n>0){if(3!==(t=t.childNodes[e.startOffset-1]).nodeType)return"";n=t.nodeValue.length}else if(3!==t.nodeType)return"";for(var o=t.nodeValue.substring(0,n),r=t.previousSibling;r&&3===r.nodeType;r=r.previousSibling)o=r.nodeValue+o;return o}function Pn(e,t,n,o,r){return{handles(t){var n=t.selection.getRng();if(!n||!n.collapsed)return!1;var r=n.commonAncestorContainer||{};return!c()(r).closest("pre,.text-placeholder").length&&((!o||!c()(r).closest(o).length)&&e.test(Bn(n)))},execute(o,a,i){var l,d=1,g=Rn(a);if(32===g?o.execCommand("mceInsertContent",!1,"&nbsp;"):o.execCommand("mceInsertContent",!1,String.fromCharCode(g)),o.undoManager.transact(()=>{var n=o.selection.getRng();if(n){"|"==(l=Bn(n))[l.length-1]&&(l+=" ",d=0);var a=e.exec(l.substring(0,l.length-1));if(!r||r(a)){var i=function(e,t,n){var o,r;if(t){3!==t.nodeType&&(n=(t=t.childNodes[n-1]).length);for(var a=t,i=n;a&&3===a.nodeType;a=a.previousSibling){if(-1==i&&(i=a.nodeValue.length),i>e)return{container:a,offset:i-e};if(i==e){for(r=0,o=a.parentNode;a=a.previousSibling;)r++;return{container:o,offset:r}}e-=i,i=-1}return null}}(a[1].length+d,n.commonAncestorContainer,n.startOffset);n.setStart(i.container,i.offset);var s=c()(n.commonAncestorContainer);o.selection.setRng(n),s.closest(".wysiwyg-macro-body").length&&n.toString()==s.text()?(s[0].innerHTML="<br>",o.selection.select(s[0].childNodes[0]),o.selection.collapse(!0)):o.execCommand("delete",!1,{},{skip_undo:!0}),t(a,o.selection.getRng()),Mn=o.selection.getRng()}}}),n)return i.preventDefault(),i.stopPropagation(),s.tinymce.dom.Event.cancel(a),Mn&&u().showElement(Mn.startContainer),!1}}}function Rn(e){return e.which}function Hn(){this.handlers={}}Hn.prototype={registerHandler(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},executeHandlers(e,t,n,o){var r=!0;return c.a.each(this.handlers[e]||[],(e,a)=>{if(a.handles(t))return r=a.execute(t,n,o),!1}),r}};var zn=new Hn,Fn=function e(t,n){if(!g.a.get("remote-user")||!g.a.get("confluence.prefs.editor.disable.autoformat")){var o=n.editor;c.a.each({"*":"bold",_:"italic","~":"subscript","^":"superscript","+":"underline","-":"strikethrough","`":"monospace"},(e,t)=>{var n=new RegExp(`(?:[\\s\\xA0\\u200b\\uFEFF]+|^)(\\${e}(?=[^\\s${e}])([^${e}]*?[^\\s]))$`);zn.registerHandler(e.charCodeAt(0),Pn(n,e=>{v(t,e[2])},!0))}),o.formatter.register("code",{inline:"code"}),zn.registerHandler("}".charCodeAt(0),Pn(/(?:[\s\xA0\u200b]+|^)({{(?=[^\s])([^}]*?[^\s])})$/,e=>{v("code",e[2])},!0));for(var r=1;r<=6;r++)(e=>{zn.registerHandler(" ".charCodeAt(0),Pn(new RegExp(`^\\u200b?(h${e}\\.)$`),()=>{o.execCommand("formatBlock",!1,"h"+e,{skip_undo:!0})},!0))})(r);zn.registerHandler(" ".charCodeAt(0),Pn(/^\u200b?(bq\.)$/,()=>{o.execCommand("formatBlock",!1,"blockquote",{skip_undo:!0})},!0));var a=Pn(/^\u200b?(----)$/,()=>{o.execCommand("mceInsertContent",!1,"<hr />",{skip_undo:!0})},!0);zn.registerHandler(" ".charCodeAt(0),a),zn.registerHandler(13,a),zn.registerHandler(" ".charCodeAt(0),Pn(/^\u200b?(#)$/,()=>{o.execCommand("InsertOrderedList")},!0)),zn.registerHandler(" ".charCodeAt(0),Pn(/^\u200b?(\*)$/,()=>{o.execCommand("InsertUnorderedList")},!0)),zn.registerHandler(" ".charCodeAt(0),Pn(/^\u200b?(1\.)$/,()=>{o.execCommand("InsertOrderedList")},!0)),zn.registerHandler(" ".charCodeAt(0),Pn(/^\u200b?(-)$/,()=>{var e=o.dom;o.execCommand("InsertUnorderedList");var t=e.getParent(o.selection.getNode(),"OL,UL");t&&(e.setStyles(t,{listStyleType:"square"}),t.removeAttribute("data-mce-style"))},!0)),Object(y.b)("confluence.editor.registerHandlers",{handlerManager:zn,createHandler:Pn,ed:o});var i=Pn(/((<--?>)([^\s-]*))$/,e=>{o.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})},!1);zn.registerHandler(" ".charCodeAt(0),i),zn.registerHandler(13,i);var l=Pn(/((--?>)([^\s-]*))$/,e=>{o.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})},!1);zn.registerHandler(" ".charCodeAt(0),l),zn.registerHandler(13,l);var d=Pn(/((<--?)([^\s-]*))$/,e=>{o.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})},!1);zn.registerHandler(" ".charCodeAt(0),d),zn.registerHandler(13,d),zn.registerHandler(" ".charCodeAt(0),Pn(/[^-]*[\s](---?)$/,e=>{var t=2===e[1].length?"":"";o.execCommand("mceInsertContent",!1,t,{skip_undo:!0})},!1));var f=Pn(/(([^\s-]+)(---?)([^\s-]+))$/,e=>{var t=2===e[3].length?"":"";o.execCommand("mceInsertContent",!1,e[2]+t+e[4],{skip_undo:!0})},!1);zn.registerHandler(" ".charCodeAt(0),f),zn.registerHandler(13,f),zn.registerHandler(13,Pn(/(^\u200b?\|\|\s*(?:[^|]*\s?\|\|\s?)+$)/,e=>{var t='<table class="confluenceTable"><tr>',n="",r=!0,a=c()(e[1].slice(2,-2).split("||")).map((function(e){return e=c.a.trim(this),r=r&&""===e,e}));r&&(a[0]=Object(Lt.a)("editor.autoformat.sampletext.firstcell"));for(var i=0,l=a.length;i<l;i++)t+=`<th class="confluenceTh">${a[i]}</th>`,n+=`<td class="confluenceTd">${u().ZERO_WIDTH_WHITESPACE}</td>`;t+=`</tr><tr>${n}</tr></table>`,o.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),o.selection.select(c()(o.selection.getRng().commonAncestorContainer).parents("table").find(r?"th":"td")[0].childNodes[0]),c()(o.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()},!0)),zn.registerHandler(13,Pn(/(^\u200b?\|\s?(?:[^|]*\s?\|\s?)+$)/,e=>{var t='<table class="confluenceTable"><tr>',n=!0,r=c()(e[1].slice(1,-1).split("|")).map((function(e){return e=c.a.trim(this),n=n&&""==e,e}));n&&(r[0]=Object(Lt.a)("editor.autoformat.sampletext.firstcell"));for(var a=0,i=r.length;a<i;a++)t+=`<td class="confluenceTd">${r[a]}</td>`;t+="</tr></table>",o.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),n&&o.selection.select(c()(o.selection.getRng().commonAncestorContainer).parents("table").find("td")[0].childNodes[0]),c()(o.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()},!0));var m=Pn(/\b(((https?|ftp):\/\/|(www\.))[\w.$\-_+!*'(),/?:@=&%#~;[\]]+)$/,e=>{var t=e[3]?e[1]:"http://"+e[1],n=o.dom.create("a",{href:t});n.appendChild(s.document.createTextNode(e[1])),o.execCommand("mceInsertContent",!1,Ln(n),{skip_undo:!0}),o.getDoc().execCommand("unlink",!1,{})},!1,"a");zn.registerHandler(" ".charCodeAt(0),m),zn.registerHandler(13,m);var p=Pn(/\b((([a-z]|\d|[!#$%&'*+\-/=?^_`{|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#$%&'*+\-/=?^_`{|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)$/i,e=>{var t=o.dom.create("a",{href:"mailto:"+e[1]});t.appendChild(s.document.createTextNode(e[1])),o.execCommand("mceInsertContent",!1,Ln(t),{skip_undo:!0}),o.getDoc().execCommand("unlink",!1,{})},!1,"a");zn.registerHandler(" ".charCodeAt(0),p),zn.registerHandler(13,p);var h=function(e,t){var n=Pn(e,()=>{o.execCommand("mceInsertContent",!1,t,{skip_undo:!0})},!1);zn.registerHandler(" ".charCodeAt(0),n),zn.registerHandler(13,n)};h(/(?:\b|^)(jira|JIRA)$/,"Jira"),h(/(?:\b|^)(bitbucket)$/,"Bitbucket"),h(/(?:\b|^)(atlassian)$/,"Atlassian"),h(/(?:\b|^)(hipchat)$/,"Hipchat"),h(/(?:\b|^)(statuspage)$/,"Statuspage"),h(/(?:\b|^)(sourcetree)$/,"Sourcetree"),h(/(?:\b|^)(trello)$/,"Trello");var b={"]":e.regularExpressions._REGEXES.WIKI_LINK,"}":e.regularExpressions._REGEXES.WIKI_MACRO,"!":e.regularExpressions._REGEXES.WIKI_EMBED};c.a.each(b,(e,t)=>{zn.registerHandler(e.charCodeAt(0),Pn(t,t=>{var n=t[1]+e,r={type:"POST",contentType:"application/json; charset=utf-8",url:g.a.get("context-path")+"/rest/tinymce/1/wikixhtmlconverter",data:JSON.stringify({wiki:n,entityId:g.a.get("content-id"),spaceKey:g.a.get("space-key"),contextType:g.a.get("content-type"),suppressFirstParagraph:!0}),dataType:"text",timeout:5e3};"}"==e?s.tinymce.confluence.MacroUtils.insertMacro(r):"!"==e?c.a.ajax(r).done(e=>{!n===e?s.tinymce.confluence.ImageUtils.insertImagePlaceholder(e):o.execCommand("mceInsertContent",!1,e,{skip_undo:!0})}):c.a.ajax(r).done(e=>{o.execCommand("mceInsertContent",!1,e,{skip_undo:!0})})},!0))}),zn.registerHandler("`".charCodeAt(0),Pn(/(``)$/,()=>{var e={contentId:g.a.get("content-id"),macro:{name:"code",body:""}};s.tinymce.confluence.MacroUtils.insertMacro(e)},!0)),o.on("KeyPress",e=>zn.executeHandlers(Rn(e),o,e,t)),o.on("KeyDown",e=>{if(13===Rn(e))return zn.executeHandlers(13,o,e,t)},!0),o.on("Remove",()=>{zn.handlers={}});return{getHandlerCount:()=>Object.keys(zn.handlers).length}}function v(e,t){var n=o.formatter.get(e)[0],r=o.dom.create(n.inline,{style:n.styles,class:n.classes});r.appendChild(s.document.createTextNode(t)),o.execCommand("mceInsertContent",!1,Ln(r)+"&nbsp;",{skip_undo:!0})}};Fn.regularExpressions={_REGEXES:{WIKI_MACRO:/(?:\s|^)(\{[^{^}]+)$/,WIKI_LINK:/(?:\s|^)(\[[^[^\]]+)$/,WIKI_EMBED:/(?:\s|^)(![^!]{5,})$/}};var Un={init(e){e.on("Init",()=>{e.getBody().classList.add("resizable")});var t=0;if(!e.getParam("fullscreen_is_enabled")){var n=parseInt(e.getParam("autoresize_min_height",""+e.getElement().offsetHeight)),o=parseInt(e.getParam("autoresize_max_height","0"));e.on("Change SetContent Paste KeyUp Init",r),e.addCommand("mceAutoResize",r)}function r(a){var i=e.getDoc(),l=i.body,d=i.documentElement,u=s.tinymce.DOM,g=n,f=a===Object(a)&&a.forceExec||!1,m=c()(i).height();if(m>n&&(g=m),o&&m>o?(g=o,l.style.overflowY="auto",d.style.overflowY="auto"):(l.style.overflowY="hidden",d.style.overflowY="hidden",l.scrollTop=0),f||g!==t){var p=g-t;u.setStyle(document.querySelectorAll("div.tox-tinymce")[0],"height",g+"px"),u.setStyle(u.get(e.id+"_ifr"),"height",g+"px"),t=g,s.tinymce.Env.webkit&&p<0&&r()}return!0}},getInfo:()=>({longname:"Auto Resize",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/autoresize",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})};function _n(){var e;function t(){var t=c()("#breadcrumbs");t.detach(),!t.find(".edited-page-title").length&&e.length&&t.append(e),c()("#editor-precursor .cell").prepend(t)}if("comment"!==g.a.get("content-type")){var n=c()("#quickedit-breadcrumbs");n.length>0&&(c()("#breadcrumbs").detach(),n.attr("id","breadcrumbs"),c()("#breadcrumb-section").append(n)),e=c()(".edited-page-title").parent().detach(),t(),Ee(s.document,"mode-changed",(n,o)=>{var r;"preview"===o?(r=c()("#breadcrumbs").detach(),e.detach(),c()("#breadcrumb-section").append(r)):"richtext"===o&&t()})}}function Wn(){s.tinymce.activeEditor.getBody().style.height="auto"}function Qn(){window.location.href=`${w.a}/login.action?os_destination=${window.location.pathname.replace(w.a,"")}`}var Vn=n(29),$n=n.n(Vn);function Kn(e){return this.message=e.message,this.statusCode=e["status-code"],this.stack=(new Error).stack,this}Kn.prototype=new Error;var Gn=Kn;function Yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yn(Object(n),!0).forEach((function(t){qn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zn=(e,t)=>e.replace(/:([a-zA-Z]+)\?*/g,(e,n)=>{var o=t[n];return"string"==typeof o&&-1===o.indexOf("=")?encodeURIComponent(decodeURIComponent(o)):o.toString()});function Xn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o=>{if(o instanceof Gn){if(401===o.statusCode)return e.onUnauthorized&&e.onUnauthorized(),t(o);var r=n[o.statusCode];return r?r(o,t):t(o)}if(o instanceof TypeError)return t(o);throw o}}function eo(e,t,n){var o=t.body,r=t.callback,a=t.headers,i=t.method,l=t.extraConfig,c=t.responseTransformer,s=o,d=a["Content-Type"];return d||delete a["Content-Type"],d&&-1!==d.indexOf("application/x-www-form-urlencoded")?s=$n.a.stringify(o):"application/json"===d&&(s=JSON.stringify(o)),fetch(e,{headers:a,credentials:"include",method:i,body:s}).then(e=>{if(!e.ok){var t=e.status;return e.text().then(e=>{throw new Gn({message:e,"status-code":t})})}return l&&l.ignoreResponseJson?null:204!==e.status?e.json():e}).then(t=>{if(t&&t["status-code"])throw new Gn(t);return r(null,c?c(t,e,n.contextPath,o):t)}).catch(Xn(n,r))}var to,no=(to={endpoint:null,contextPath:null,onUnauthorized:null,extraHeaders:{}},{configure(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};to=Jn(Jn({},to),e)},getConfig:()=>to,getFullPath(e,t){var n=to.contextPath+e;return t?Zn(n,t):n},getExternalServicePath(e,t){if("function"!=typeof e)throw"getExternalServicePath expects path to be a function so it can be lazy evaluated";var n=e();return Zn(n,t)},get(e,t){var n=t.callback,o=t.headers,r=t.responseTransformer;return eo(e,{callback:n,headers:Jn(Jn({Accept:"application/json","Content-Type":"application/json"},to.extraHeaders),o),method:"GET",responseTransformer:r},to)},post(e,t){var n=t.body,o=t.callback,r=t.headers,a=t.extraConfig,i=t.responseTransformer;return eo(e,{body:n,callback:o,headers:Jn(Jn({"Content-Type":"application/x-www-form-urlencoded"},to.extraHeaders),r),method:"POST",extraConfig:a,responseTransformer:i},to)},put(e,t){var n=t.body,o=t.callback,r=t.headers,a=t.responseTransformer;return eo(e,{body:n,callback:o,headers:Jn(Jn({Accept:"application/json","Content-Type":"application/json"},to.extraHeaders),r),method:"PUT",responseTransformer:a},to)},delete(e,t){var n=t.callback,o=t.headers,r=t.extraConfig,a=t.responseTransformer;return eo(e,{callback:n,headers:Jn(Jn({Accept:"application/json","Content-Type":"application/json"},to.extraHeaders),o),method:"DELETE",extraConfig:r,responseTransformer:a},to)},postLegacyResource(e,t){var n=t.body,o=t.callback,r=t.headers,a=t.responseTransformer;return fetch(e,{headers:Jn(Jn({"Content-Type":"application/x-www-form-urlencoded"},to.extraHeaders),r),credentials:"include",method:"POST",body:"string"==typeof n?n:$n.a.stringify(n)}).then(e=>{if(!e.ok)return new Error("Request failed with "+e.status);var t=e.headers.get("content-type");return t&&-1===t.indexOf("text/html")&&-1===t.indexOf("text/plain")?e.json():e.text()}).then(t=>t instanceof Error?o(t):o(null,a?a(t,e,to.contextPath,n):t)).catch(Xn(to,o))},fetch:(e,t)=>fetch(e,t)}),oo={configure(e){no.configure(e)},getPluginCodeLanguages(e){var t=no.getFullPath("/plugins/newcode/getlanguages.action");no.get(t,{callback:e})},getWikiConfluenceToXhtml(e,t){var n=no.getFullPath("/rest/tinymce/1/wikixhtmlconverter");no.postLegacyResource(n,{body:e,callback:t,headers:{Accept:"text/plain, */*","Content-Type":"application/json; charset=utf-8"}})},getWikiMarkdownToXhtml(e,t){var n=no.getFullPath("/rest/tinymce/1/markdownxhtmlconverter");no.postLegacyResource(n,{body:e,callback:t,headers:{Accept:"text/plain, */*","Content-Type":"application/json; charset=utf-8"}})}};oo.configure({endpoint:`${window.location.protocol}//${window.location.host}`+w.a,contextPath:w.a,onUnauthorized:Qn});var ro=oo,ao={fields:{string:{language:(e,t)=>{var n,o=c()(s.Confluence.Templates.MacroBrowser.macroParameterSelect()),r=c()("select",o);return null==t&&(t={}),t.setValue=e=>{if(0==r.find(`option[value='${e}']`).length){var t=c()("<option/>");t.val(e),t.text(e),r.append(t)}},n=r,ro.getPluginCodeLanguages((e,t)=>{if(!e&&t.length){var o=n.val();n.empty(),n.append(c()("<option/>").attr("value","")),t.forEach(e=>{var t=c()("<option />");t.val(e.aliases[0]),t.text(e.friendlyName),n.append(t)}),n.val(o)}}),new s.AJS.MacroBrowser.Field(o,r,t)}}}};var io={init(e){e.on("beforeExecCommand",t=>{if("Indent"===t.command||"Outdent"===t.command){var n=e.selection.getNode(),o=n.nodeName.toLowerCase();if("li"!==o&&"body"!==o){var r=parseInt(e.dom.getStyle(n,"margin-left",!1)||"0",10)+parseInt(e.dom.getStyle(n,"padding-left",!1)||"0",10);if(0!==r){var a=e.settings.indentation,i=/[a-z%]+/i.exec(a);e.dom.setStyle(n,"padding-left",""),e.dom.setStyle(n,"margin-left",r+i[0])}}}})},getInfo:()=>({longname:"Confluence Indentation",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})};function lo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function co(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function so(e){return()=>({getMetadata:()=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lo(Object(n),!0).forEach((function(t){co(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:"Confluence Editor Plugin",url:"http://www.atlassian.com"},e)})}var uo=n(33);function go(e){return e.addCommand("confCharmap",()=>(Promise.all([n.e("vendors~charmap-open-dialog"),n.e("charmap-open-dialog")]).then(n.bind(null,179)).then(t=>{(0,t.default)(e);var n;n=new CustomEvent(uo.a.DIALOG_CONTROL,{detail:{isOpen:!0}}),window.dispatchEvent(n)}),!1)),so({name:"Confluence Charmap Plugin"})}var fo=()=>({init:e=>{var t,n=s.Confluence.Editor.Drafts,o=s.Confluence.Editor;function r(){var e,t,n;e=g.a.get("draft-id"),t=g.a.get("draft-share-id"),0!==parseInt(e)&&d.a.history&&d.a.history.replaceState&&d.a.history.replaceState(null,"",`${w.a}/pages/resumedraft.action?draftId=${e}&draftShareId=${t}&${n=d.a.location.search,void 0===n?"":("?"===n.charAt(0)&&(n=n.substr(1)),n.split("&").filter(e=>0===e.indexOf("username=")||0===e.indexOf("userFullName=")||0===e.indexOf("accessType=")||0===e.indexOf("grantAccess=")||0===e.indexOf("src.")).join("&"))}`),o.UI.cancelButton.attr("data-tooltip",Object(Lt.a)("editor.shared.draft.done.desc")),o.UI.cancelButton.on("click",()=>{Object(y.b)("analytics",{name:"confluence.editor.done.button.clicked"}),Object(y.b)("analytics",{name:"confluence.editor.close",data:{source:"closeButton",contentId:g.a.get("content-id"),currentVersion:g.a.get("page-version")||"null"}})})}function a(){if(!g.a.get("has-collaborated")&&s.AJS.Rte.Content.editorHasContentChanged()){g.a.set("has-collaborated",!0);var e=g.a.get("remote-user-key"),t=g.a.get("content-id");c.a.ajax({type:"PUT",url:`${w.a}/rest/experimental/relation/user/${e}/collaborator/toContent/${t}?targetStatus=draft`,error(){g.a.set("has-collaborated",!1)}}),c.a.ajax({type:"DELETE",url:`${w.a}/rest/experimental/relation/touched/from/user/current/to/content/${t}?targetStatus=current`}),c.a.ajax({type:"PUT",url:`${w.a}/rest/experimental/relation/user/${e}/touched/toContent/${t}?targetStatus=draft`,error(){g.a.set("has-collaborated",!1)}})}}e.on("Init",()=>{Object(y.a)("editor.local.change",a)}),e.on("Remove",()=>{Object(y.c)("editor.local.change",a)}),Object(y.a)("rte-ready",()=>{c()("#draft-status").show(),n.bindUnloadMessage(),o.UI.cancelButton.click(()=>{g.a.getBoolean("shared-drafts")||n.save({skipErrorHandler:!0})}),g.a.getBoolean("shared-drafts")&&r(),t=d.a.setInterval(n.save,+g.a.get("draft-save-interval")||3e4)}),Object(y.a)("rte-destroyed",()=>{clearInterval(t)})},getInfo:()=>({longname:"Confluence Drafts",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})});function mo(e){return e&&3===e.nodeType&&0===e.nodeValue.length}var po={isCursorAtStartOf(e,t){return t.collapsed&&this.isRangeAtStartOf(e,t)},isRangeAtStartOf(e,t){if(!t||!t.startContainer)throw new Error("range is invalid. received: "+t);if(!e||!e.nodeType)throw new Error("context is invalid. received: "+e);var n,o=t.startContainer;if(3===o.nodeType){if(0!==t.startOffset)return!1;n=o}else if(void 0===(n=o.childNodes[t.startOffset])&&o.childNodes.length>0)return!1;var r,a=new s.tinymce.dom.TreeWalker(n,e);do{r=a.prev(!0)}while(mo(r));return void 0===r},isCursorAtEndOf(e,t){return t.collapsed&&this.isRangeAtEndOf(e,t)},isRangeAtEndOf(e,t){if(!t||!t.endContainer)throw new Error("range is invalid. received: "+t);if(!e||!e.nodeType)throw new Error("container is invalid. received: "+e);var n,o=t.endContainer;if(3===o.nodeType){if(t.endOffset!=o.nodeValue.length)return!1;n=o}else n=o.childNodes[0===t.endOffset?t.endOffset:t.endOffset-1];var r,a=new s.tinymce.dom.TreeWalker(n,e);do{r=a.next(!0)}while(mo(r));return void 0===r||"BR"===r.nodeName&&void 0===a.next(!0)},setCursorAtStartOfContents(e){if(!e)throw new Error("element is required.");if(1!==e.nodeType&&3!==e.nodeType)throw new Error("invalid argument: expected a DOM element or text node, got: "+e);var t=s.tinymce.activeEditor,n=t.dom.createRng();["br","img"].includes(e.nodeName.toLowerCase())?(n.setStartBefore(e),n.setEndBefore(e),t.selection.setRng(n)):(t.selection.select(e,!0),t.selection.collapse(!0))},isCursorAtEnd(e,t){var n=e.selection.getSel();if(!n||!n.isCollapsed)return!1;var o=t.endContainer;if(3==o.nodeType)return o.wholeText.length==t.endOffset;var r=o.childNodes[t.endOffset];return c()(r).is(":last-child")}},ho=po;function bo(e,t){var n=e.selection.getSel();if(!n||!n.isCollapsed)return!1;var o,r=t.startContainer;return 3==r.nodeType?!r.previousSibling&&0===t.startOffset&&function(e){if(0==c()(e).closest("td").length)return!0;for(var t=e.parentNode;t&&"td"!=t.nodeName.toLowerCase();){if(c()(t).prevAll().contents().filter((function(){return 3==this.nodeType})).length)return!1;t=t.parentNode}return!0}(r):c()(r).is("p:first-child")?0===t.startOffset:c()(r).is(".wysiwyg-macro-body")?1==t.startOffset&&(3==(o=t.startContainer.childNodes[0]).nodeType&&"\n"==o.nodeValue):void 0}function vo(e,t,n){var o=e.dom.create("p",{},'<br data-mce-bogus="1" />');n?t.after(o):t.before(o),e.selection.select(o,!0),e.selection.collapse()}function yo(){var e=s.tinymce.activeEditor;s.tinymce.Env.gecko&&e.on("KeyPress",t=>{if(t.charCode==s.tinymce.util.VK.SPACE){var n=e.selection.getNode(),o=c()(n).closest("a"),r=e.selection.getRng();o.length&&ho.isCursorAtEnd(e,e.selection.getRng())&&(r.setStartAfter(o[0]),r.setEndAfter(o[0]),e.selection.setRng(r),e.selection.collapse())}}),e.on("KeyPress",t=>{if(13==t.keyCode&&!t.shiftKey){var n=e.selection.getNode(),o=c()(n).closest("pre");if(o.length&&!s.tinymce.confluence.MacroUtils.isInMacro(o)&&ho.isCursorAtEnd(e,e.selection.getRng()))return vo(e,o,!0),s.tinymce.dom.Event.cancel(t);var a=c()(n).closest("blockquote");if(a.length){var i=c()(n).closest("p");if(i.is(":first-child")&&bo(e,e.selection.getRng()))return vo(e,a,!1),s.tinymce.dom.Event.cancel(t);if(i.is(":last-child")&&function(e){var t=e.contents();if(!t.length)return!0;if(1==t.length){if(t.is("br"))return!0;if("&nbsp;"==t.html()||160==t.text().charCodeAt(0))return!0;if(3==t[0].nodeType&&t[0].nodeValue==r.a.Rte.HIDDEN_CHAR)return!0}return!1}(i))return e.dom.remove(i[0],!1),vo(e,a,!0),s.tinymce.dom.Event.cancel(t)}}return!0},!0)}var wo,Co,Ao,xo,Mo,ko,Eo,To,Do,Io,So,Oo;function jo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var No,Lo,Bo,Po,Ro,Ho=!1;function zo(){wo=c()(s.document),Ao=c()("#insert-table-dropdown"),xo=c()("#rte-button-insert-table"),Mo=Ao.find(".aui-dd-parent"),ko=c()("#table-picker-container"),(Eo=ko.find(".table-picker-box").attr("tabindex",0).attr("role","application")).focusin(Jo),Eo.focusout(qo),To=ko.find(".picker-cell"),Do=ko.find(".picker-heading"),Io=ko.find(".picker-selected-cell"),So=ko.find(".picker-selected-heading"),Oo=Eo.find(".desc"),Co=c()("<div></div>").attr("id","table-picker-backdrop").addClass("hidden").appendTo(Ao),xo.click(e=>{var t;e.preventDefault(),Ho||(nt(),Fo(),Ro=!0,_o(1,1),t=c()(s.tinymce.activeEditor.getDoc()),wo.bind("mousemove.atlassian-table-picker",Vo),wo.bind("keydown.atlassian-table-picker",Go),wo.bind("keyup.atlassian-table-picker",Go),t.bind("keydown.atlassian-table-picker",Go),t.bind("keyup.atlassian-table-picker",Go),Co.removeClass("hidden"),ko.removeClass("hidden"),Mo.addClass("active"),xo.focus())}),Co.click(Zo),Io.click($o),So.click($o)}var Fo=function(){ko.css({top:c()("#insert-table-dropdown").outerHeight(!0)}),Fo=function(){}};function Uo(){var e;ko.hasClass("hidden")||(e=c()(s.tinymce.activeEditor.getDoc()),wo.unbind(".atlassian-table-picker"),e.unbind(".atlassian-table-picker"),ko.addClass("hidden"),Co.addClass("hidden"),Mo.removeClass("active"))}function _o(e,t){e==Bo&&t==Po||(e=Math.max(1,Math.min(15,e)),t=Math.max(1,Math.min(20,t)),No=Math.max(4,e),Lo=Math.max(4,t),Bo=e,Po=t,Eo.width(25*No+1),Eo.height(17*Lo+20),Qo(To,No,Lo),Qo(Io,Bo,Po),Qo(Do,No,1),Qo(So,Bo,1),Wo(),Oo.text(`${Bo} x ${Po}`))}function Wo(){Do.toggleClass("hidden",!Ro),So.toggleClass("hidden",!Ro)}function Qo(e,t,n){e.width(25*t+1),e.height(17*n+1)}function Vo(e){var t=To.offset(),n=t.top-wo.scrollTop(),o=t.left-wo.scrollLeft(),r=n+To.outerHeight(!0)+0,a=r-17-0,i=o+To.outerWidth(!0)+0,l=i-25-0,c=e.clientY,s=e.clientX,d=No,u=Lo;s>i?d+=~~((s-i)/25+1):s<l&&(d+=~~((s-l)/25-1)),c>r?u+=~~((c-r)/17+1):c<a&&(u+=~~((c-a)/17-1)),_o(d,u)}function $o(e){var t=function(e){var t=1+~~(~~(e.offsetX||e.originalEvent.layerX)/25),n=1+~~(~~(e.offsetY||e.originalEvent.layerY)/17);return t<1||t>15||n<1||n>20?null:{width:t,height:n}}(e);e.preventDefault(),Ko(t)}function Ko(e){if(e){Uo();var t={columns:e.width,rows:e.height,options:{headerRows:Ro?1:0}};s.tinymce.activeEditor.execCommand("mceInsertTable",!1,t)}}function Go(e){var t;0===e.charCode&&(t=!e.shiftKey)!=Ro&&(Ro=t,Wo()),27===e.keyCode&&Uo()}function Yo(e){"ArrowLeft"===e.key&&(e.preventDefault(),e.stopPropagation(),_o(Bo-1,Po)),"ArrowUp"===e.key&&(e.preventDefault(),e.stopPropagation(),_o(Bo,Po-1)),"ArrowRight"===e.key&&(e.preventDefault(),e.stopPropagation(),_o(Bo+1,Po)),"ArrowDown"===e.key&&(e.preventDefault(),e.stopPropagation(),_o(Bo,Po+1)),"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),Ko({width:Bo,height:Po}))}function Jo(){var e=c()(s.tinymce.activeEditor.getDoc());wo.bind("keydown.atlassian-table-picker",Yo),e.bind("keydown.atlassian-table-picker",Yo)}function qo(){var e=c()(s.tinymce.activeEditor.getDoc());wo.unbind(".atlassian-table-picker",Yo),e.unbind(".atlassian-table-picker",Yo)}function Zo(){Uo()}class Xo{constructor(){jo(this,"onPickerClick",$o),jo(this,"removePopup",Uo)}}Object(dt.a)("confluence-editor/table-picker",()=>new Xo);var er,tr,nr,or,rr,ar,ir,lr,cr,sr,dr=n(24),ur={},gr=e=>{if(!ur.hasOwnProperty(e)){var t=d.a.document.querySelector("meta[name=ajs-enabled-dark-features]");if(t){var n=t.content.split(",");ur[e]=n.indexOf(e)>-1&&-1===n.indexOf(e+".disable")}}return ur[e]},fr=n(9),mr=gr("editor.ajax.save")&&!gr("editor.ajax.save.disable")&&""!==g.a.get("remote-user"),pr=[],hr=[],br=[],vr=!1,yr=1,wr=!1,Cr=null,Ar=e=>{s.Confluence.Editor.UI.setButtonState(e,s.Confluence.Editor.UI.saveButton),s.Confluence.Editor.UI.setButtonState(e,s.Confluence.Editor.UI.previewButton),s.Confluence.Editor.UI.setButtonState(e,s.Confluence.Editor.UI.cancelButton),c()("#rte-show-changes").length>0&&s.Confluence.Editor.UI.setButtonState(e,c()("#rte-show-changes")),c()("#rte-show-revert").length>0&&s.Confluence.Editor.UI.setButtonState(e,c()("#rte-show-revert"))},xr=e=>{var t=(e=e||{}).messageKey||"editor-error-message",n=e.message||Object(Lt.a)("editor.generic.refresh"),o={title:e.title,type:"error",message:n};e.close&&c.a.extend(o,{close:e.close}),fr.a.handleMessage(t,o,()=>{e.disablePublish&&Ar(!1)})},Mr=()=>"limited"===g.a.get("edit-mode"),kr=e=>{var t=!0;fr.a.closeMessages(["offline-before-save-error"]);for(var n=0;n<hr.length&&(!1===hr[n](e)&&(t=!1),!e.isImmediatePropagationStopped());n++);if(!t||e.isDefaultPrevented()||e.isPropagationStopped())return!1;e.preventDefault(),Tr(e).done(Ir).fail(Er)},Er=e=>{var t=e||{};xr({messageKey:t.messageKey||"offline-before-save-error",message:t.disablePublish?Object(Lt.a)("editor.generic.refresh"):Object(Lt.a)("editor.offline.before.save.error"),disablePublish:t.disablePublish}),e&&Object(y.b)("analytics",{name:"editor.save.error."+e.origin+"."+e.cause}),s.Confluence.Editor.UI.toggleSavebarBusy(!1),s.Confluence.Editor.Drafts.bindUnloadMessage()},Tr=e=>{var t=c.a.Deferred();return t.resolve(e),t.promise()},Dr=()=>{var e=()=>{wr=!0,c()(s.Confluence.Editor.getCurrentForm()).submit(),Object(y.b)("analytics",{name:"confluence.editor.close",data:{source:"publishButton"}})},t=s.Confluence.Editor.Drafts.getDraftSavingPromise();t?t.always(e):e()},Ir=Dr,Sr=function(){for(var e=0;e<pr.length;e++)s.Confluence.Editor.UI.cancelButton.click(pr[e]);for(var t=c()(s.Confluence.Editor.getCurrentForm()),n=0;n<br.length;n++)t.submit(br[n]);Object(y.c)("init.rte",this)},Or=(e,t,n,o)=>{o.push(n),r.a.Rte&&r.a.Rte.BootstrapManager&&r.a.Rte.BootstrapManager.isInitComplete()?e.bind(t,n):vr||(vr=!0,c.a.bind("init.rte",Sr))},jr=(e,t,n)=>{var o,a,i=null,l=n.pop();for(null!==r.a&&void 0!==r.a&&null!==(o=r.a.Rte)&&void 0!==o&&null!==(a=o.BootstrapManager)&&void 0!==a&&a.isInitComplete()&&(i=(e,t,n)=>{e.unbind(t,n)});l;){var c;null===(c=i)||void 0===c||c(e,t,l),l=n.pop()}},Nr=()=>{var e=g.a.getBoolean("shared-drafts"),t=["page","blogpost"].includes(g.a.get("content-type")),n="0"!==r.a.params.pageId;return t&&(n||e)},Lr=e=>{c()("#editpageform").find("input[name='atl_token']").val(e),g.a.set("atl-token",e),g.a.set("atlassian-token",e),c()("#atlassian-token").attr("content",e)},Br=()=>{var e,t,n;return null==s.tinymce.activeEditor?(r.a.debug("Confluence.Editor: editorHasContentChanged - No active editor present. Returning false."),!1):null===r.a||void 0===r.a||null===(e=r.a.Rte)||void 0===e||null===(t=e.Content)||void 0===t||null===(n=t.editorHasContentChanged)||void 0===n?void 0:n.call(t)},Pr=(ir=e=>{tr!==e&&(tr&&tr.clear(),e.start(s.Confluence.Editor.heartbeat),tr=e)},lr=g.a.getNumber("heartbeat-interval")||3e4,cr={start:e=>{r.a.debug("Changing heartbeat to the normal scheduler"),nr=setInterval(e,lr)},clear:()=>{clearInterval(nr)}},ar=Math.max(lr/5,5e3),sr={start:e=>{r.a.debug("Changing heartbeat to the recovery scheduler"),rr=0;var t=()=>{e();var n=ar*Math.pow(2,rr);or=setTimeout(t,Math.min(n,3e5)),rr++};or=setTimeout(t,ar)},clear:()=>{clearTimeout(or)}},{normal:()=>ir(cr),recovery:()=>ir(sr),reset:()=>{var e;null===(e=tr)||void 0===e||e.clear(),(tr=cr).start(s.Confluence.Editor.heartbeat)},cleanup:()=>{var e,t;tr&&(tr.clear(),tr=null),null===(e=er)||void 0===e||null===(t=e.abort)||void 0===t||t.call(e)}}),Rr=e=>{Object(dr.setVisible)("#wysiwyg",e),c()(".toolbar-group-preview").toggleClass("assistive",!e),c()(".toolbar-group-edit").toggleClass("assistive",e),c()("#main").toggleClass("active-richtext",e),s.tinymce.isGecko&&e&&r.a.Rte.fixEditorFocus(s.Confluence.Editor.bookmark)},Hr=e=>{if("comment"!==g.a.get("content-type")){var t=c()("#content-title");t.hasClass("placeholded")?(c()("#preview-title-text").text(""),c()("#title-text").text("")):(c()("#preview-title-text").text(t.val()),c()("#title-text").text(t.val()))}Object(dr.setVisible)("#preview",e),c()(".toolbar-group-preview").toggleClass("assistive",e),c()(".toolbar-group-edit").toggleClass("assistive",!e),c()("#main").toggleClass("active-preview",e),c()("#full-height-container").length&&c()("#full-height-container").toggleClass("active-preview",e)},zr=e=>{r.a.debug("Set mode: "+e),e===s.Confluence.Editor.MODE_RICHTEXT?(Rr(!0),Hr(!1)):e===s.Confluence.Editor.MODE_PREVIEW&&(Hr(!0),Rr(!1),s.Confluence.Editor.UI.spinner.removeClass("aui-icon-wait")),setTimeout(()=>{var e=c()(".toolbar-group-preview");e.height(0),e.height(),e.height("auto")},1),Cr=e,c()(s.document).trigger("mode-changed",[e])},Fr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r.a.debug("Change mode: "+e),_r()&&!r.a.Rte.BootstrapManager.isInitComplete())return!1;if(Cr===e)return!1;var n=Cr;if(Object(y.b)("rte-changeMode",e),e===s.Confluence.Editor.MODE_PREVIEW){var o=s.tinymce.activeEditor;s.tinymce.isGecko&&n===s.Confluence.Editor.MODE_RICHTEXT&&!s.Confluence.Editor.bookmark&&(s.Confluence.Editor.bookmark=s.tinymce.activeEditor.selection.getBookmark()),Cr=e;var a={contentId:s.Confluence.getContentId(),contentType:g.a.get("content-type"),spaceKey:g.a.get("space-key"),xHtml:o.getContent(),outputType:s.Confluence.Editor.PREVIEW_OUTPUT_TYPE};r.a.safe.ajax({type:"POST",url:w.a+"/pages/rendercontent.action",data:a,success:Ur,timeout:2e4,error:()=>{var e;Object(y.b)("rte-preview-action-selected"),Object(y.b)("rte.preview.error",{status:0}),fr.a.closeMessages(["server-offline"]),xr({messageKey:"server-offline",message:Object(Lt.a)("editor.offline.preview.error"),disablePublish:!1}),s.Confluence.Editor.currentEditMode=n,null===(e=t.errorCallback)||void 0===e||e.call(t)}}).always(()=>{g.a.getBoolean("shared-drafts")&&["page","blogpost"].includes(g.a.get("content-type"))&&s.Confluence.Editor.Drafts.save({skipErrorHandler:!0})})}else zr(e);if(e===s.Confluence.Editor.MODE_RICHTEXT&&c()(s.document).trigger("resize.resizeplugin"),n===s.Confluence.Editor.MODE_PREVIEW){var i=s.document.getElementById("editor-preview-iframe");if(i){var l=i.contentDocument||i.contentWindow.document;l.removeChild(l.documentElement),c()(i).remove()}}return!1},Ur=e=>{var t;Object(y.b)("rte-preview-action-selected"),c()("#preview-error").remove(),s.tinymce.activeEditor.setProgressState(!0);var n=c()("#previewArea"),o=c()('<iframe id="editor-preview-iframe" src="about:blank" scrolling="yes" frameborder="0"></iframe>');n.html(o);var r=o[0].contentDocument||(null===(t=o[0].contentWindow)||void 0===t?void 0:t.document);null==r||r.open(),null==r||r.write(e),null==r||r.close()},_r=()=>Cr===s.Confluence.Editor.MODE_RICHTEXT,Wr=()=>{var e=s.tinymce.activeEditor.getBody();switch(g.a.get("content-type")){case"template":e.setAttribute("aria-label",Object(Lt.a)("template.content.ariaLabel"));break;case"page":e.setAttribute("aria-label",Object(Lt.a)("page.content.ariaLabel"));break;case"blogpost":e.setAttribute("aria-label",Object(Lt.a)("blogpost.content.ariaLabel"));break;case"comment":e.setAttribute("aria-label",Object(Lt.a)("quick.comment.label.message"));break;default:e.setAttribute("aria-label",Object(Lt.a)("content.ariaLabel"))}r.a.debug("Set aria-label to editor")},Qr={bookmark:"",MODE_RICHTEXT:"richtext",MODE_PREVIEW:"preview",PREVIEW_OUTPUT_TYPE:"PREVIEW",currentEditMode:Cr,contentHasChangedSinceLastSave:!1,sourceInitialValue:!1,isPublishing:e=>(void 0!==e&&(wr=e),wr),isLimitedModeEnabled:Mr,overrideBeforeSave:e=>{Tr=e},overrideSave:e=>{Ir=e},restoreDefaultSave:()=>{Ir=Dr},getNumConcurrentEditors:()=>yr,addCancelHandler:e=>Or(s.Confluence.Editor.UI.cancelButton,"click",e,pr),addSaveHandler:e=>hr.push(e),addSubmitHandler:e=>Or(c()(s.Confluence.Editor.getCurrentForm()),"submit",e,br),removeAllCancelHandlers:()=>jr(s.Confluence.Editor.UI.cancelButton,"click",pr),removeAllSaveHandlers:()=>jr(s.Confluence.Editor.UI.saveButton,"click",hr),removeAllSubmitHandlers:()=>jr(c()(s.Confluence.Editor.getCurrentForm()),"submit",br),hasContentChanged:()=>!!_r()&&Br(),isEmpty:()=>!c()(s.tinymce.activeEditor.getContent()).text().trim(),getCurrentTitle:()=>{var e;return null===(e=c()("#content-title"))||void 0===e?void 0:e.val()},contentFormSubmit:()=>(!Mr()&&s.Confluence.Editor.Drafts.isSharedDraftsEnabled()||s.Confluence.Editor.Drafts.unBindUnloadMessage(),c()(".editable-title #content-title").prop("disabled",!0),!0),metadataSyncRequired:Nr,heartbeat:()=>{var e={dataType:"json",contentId:g.a.get("content-id"),draftType:g.a.get("content-type"),spaceKey:r.a.params.spaceKey,contributorsHash:g.a.get("contributors-hash")};er=r.a.safe.post(w.a+"/json/startheartbeatactivity.action",e,e=>{if(!Nr()&&e)return Lr(e.atlToken),g.a.set("shared-drafts","legacy"!==e.editMode),void Object(y.b)("rte.heartbeat",e);if(!(null!=e&&e.atlToken&&e.activityResponses instanceof Array))return Object(y.b)("rte.heartbeat-error","Invalid server response"),r.a.logError("Unexpected server response for heartbeat:"),void r.a.log(e);g.a.set("contributors-hash",e.contributorsHash),g.a.set("shared-drafts","legacy"!==e.editMode);var t=e.activityResponses;if(Lr(e.atlToken),s.Confluence.Editor.heartbeatType.normal(),Object(y.b)("rte.heartbeat",t),(yr=(t.length||0)+1)>1){var n=mr?0===c()("#reliable-other-users-span").length?c()("<span id='reliable-other-users-span'></span>"):c()("#reliable-other-users-span"):c()("#other-users-span");n.empty();for(var o=0;o<yr-1;++o){o>0&&n.append(", ");var a=t[o];n.append(c()("<a></a>").attr("href",w.a+"/display/~"+encodeURIComponent(a.userName)).text(a.fullName)),null!=a.lastEditMessage&&n.append(" ").append(c()("<span></span>").addClass("smalltext").text(a.lastEditMessage))}mr&&(fr.a.isDisplayed(["heartBeat"])||""===n.html().trim()||fr.a.handleMessage("heartBeat",{type:"info",message:Object(Lt.a)("heartbeat.page.edited.info","<span id='reliable-other-users-span'>"+n.html()+"</span>")})),c()("#heartbeat-div").hasClass("hidden")&&r.a.Confluence.Analytics.publish("rte.notification.concurrent-editing",{numEditors:yr,pageId:r.a.params.pageId,draftType:r.a.params.draftType})}mr&&yr<=1&&fr.a.closeMessages(["heartBeat"]),Object(dr.setVisible)("#heartbeat-div",yr>1),c()(s.document).trigger("resize.resizeplugin"),Object(y.b)("editor-heartbeat",e),(e=>{var t;if(e!==g.a.get("edit-mode")){if("collaborative"===e&&"limited"!==g.a.get("edit-mode"))return;g.a.set("edit-mode",e),t="collaborative"===e?Object(Lt.a)("editor.collaborative.mode.enabled"):Object(Lt.a)("editor.collaborative.mode.disabled"),xr({messageKey:"edit-mode-transition",message:t,disablePublish:!0})}})(e.editMode)},"json").fail((e,t,n)=>{(e.status>=500||0===e.status)&&s.Confluence.Editor.heartbeatType.recovery(),403===e.status||401===e.status?r.a.logError("Heartbeat error: Unauthorized"):405===e.status?r.a.logError("Heartbeat error: Method not allowed"):(r.a.logError("Server error on heartbeat request:"),r.a.log(n)),Object(y.b)("rte.heartbeat-error",e)})},heartbeatType:Pr,disableFrame:e=>{c()("form",e).each((function(){c()(this).unbind(),this.onsubmit=()=>!1})),c()("a",e).each((function(){var e=c()(this),t=e.attr("href");e.unbind(),t&&"#"!==t.charAt(0)&&(e.attr("target","_top"),e.bind("click",t=>{t.preventDefault(),e.blur()}))})),c()("input, img",e).each((function(){c()(this).unbind()}))},previewFrameOnload:(e,t)=>{s.Confluence.Editor.setMode(s.Confluence.Editor.MODE_PREVIEW),s.tinymce.activeEditor.setProgressState(!1),s.Confluence.Editor.disableFrame(e),c()(".tipsy").remove();var n=c()("#main",e)[0];if("comment"!==g.a.get("content-type")&&0===c()(n).find("#main-header").length){var o=c()("#title-heading"),r=o.attr("class");c()(n).prepend(`<div id="preview-header"><div id="title-heading" class="${r||""}">${(null==o?void 0:o.html())||""}</div></div>`)}if(c()(s.tinymce.activeEditor.getBody()).hasClass("resizable")){var a,i=c()(t||"#previewArea iframe"),l=0,d=0,u=i.height();n&&function e(){if(c()("#editor-preview-iframe").length){var t=c()(n).outerHeight(!0);l!==t?(t!==i.height()&&i.height(0).height(Math.max(t,u)),l=t,d=0):d++,d<500&&(a=setTimeout(e,500))}}(),c()(s.document).one("mode-changed.resize-editor",(function(e,t){t!==s.Confluence.Editor.MODE_PREVIEW&&a&&clearTimeout(a)}))}},showPreview:Hr,setMode:zr,getContentId:()=>s.Confluence.getContentId(),addErrorMessage:(e,t,n)=>{var o=c()("#"+e),a=n?"#any-messages":"#editor-messages";o.length?o.empty():o=c()("<div></div>").attr("id",e).appendTo(a),r.a.messages.error(o,{closeable:!0,body:t})},inRichTextMode:_r,isNewPage:()=>c()("#createpageform, #createpagetemplate").length>0,onInit:()=>{s.Confluence.Editor.setMode(s.Confluence.Editor.MODE_RICHTEXT),s.tinymce.activeEditor.on("click",()=>{var e=s.Confluence.Editor.UI.postingDatePicker;null==e||e.hide()})},getCurrentForm:()=>s.tinymce.activeEditor.formElement,setToolBarInactive:e=>c()("#rte-toolbar").toggleClass("disabled",e),isVisible:()=>c()("#wysiwyg:visible").length>0||c()("#preview:visible").length>0,setAriaLabelByContentType:Wr},Vr=e=>{e.fn.tipsy.autoBounds2=function(t,n){return function(){var o={},r=e(document).scrollTop()+t,a=e(document).scrollLeft()+t,i=e(this);return n.length>1?(o.ns=n[0],o.ew=n[1]):"e"==n[0]||"w"==n[0]?o.ew=n[0]:o.ns=n[0],i.offset().top<r&&(o.ns="n"),i.offset().left<a&&(o.ew="w"),e(window).width()+e(document).scrollLeft()-(i.offset().left+i.width())<t&&(o.ew="e"),e(window).height()+e(document).scrollTop()-(i.offset().top+i.height())<t&&(o.ns="s"),o.ns?o.ns+(o.ew?o.ew:""):o.ew}}};function $r(){c()(".tipsy").remove()}function Kr(){var e=/\+/g;setTimeout(()=>{c()("#rte-savebar .aui-button[title]").each((function(){var t=c()(this),n=t.attr("title");if(t.removeAttr("title"),s.tinymce.Env.mac){var o=n.indexOf("(");o>=0&&(n=n.substr(0,o)+n.substr(o).replace(e,""))}t.attr("data-tooltip",n)}))},0)}function Gr(e,t,n){if("dropdown"===t&&(c()(".tipsy").remove(),n&&n.trigger&&n.trigger.jquery)){var o=n.trigger.data("tipsy");o&&(o.hoverState="out")}}function Yr(){var e=s.Confluence.Editor,t=!1;function n(e){var t=()=>{e&&e.hide()};Ee(s.document,"showLayer",(n,o,r)=>{if("dropdown"==o&&r==e){var a=s.tinymce.activeEditor;a.on("Click",t),a.on("KeyUp",t)}}),Ee(s.document,"hideLayer",(n,o,r)=>{if("dropdown"==o&&r==e){var a=s.tinymce.activeEditor;a.off("Click",t),a.off("KeyUp",t)}})}function o(e){e.addCallback("show",()=>{e.$.parents(".disabled").length&&e.hide()})}function r(e,n){if(!t){var o=f(n);c()("#"+o).removeClass("disabled")}}function a(e,t){var n=f(t);c()("#"+n).addClass("disabled")}function i(e,n){n?e.closest(".aui-button").prop("disabled",!0).attr("aria-disabled","true").toggleClass("disabled",n):t||e.closest(".aui-button").prop("disabled",!1).removeAttr("aria-disabled").toggleClass("disabled",n)}function l(e,n,o,r){var a=!!t||e,i=!!t||n,l=!!t||o,s=c()("#toolbar"),d=s.find(".toolbar-item"),u=c()("#insert-menu, #more-menu"),g=c()("#insert-menu, #color-picker-control"),f=c()("#format-dropdown"),m=r||function(){return!0};d.toggleClass("disabled",a),u.toggleClass("disabled",a),g.toggleClass("disabled",a),f.toggleClass("disabled",!!i),a?(Ho=!0,Ao.addClass("disabled")):(Ho=!1,Ao.removeClass("disabled"),xo.attr("data-tooltip",Object(Lt.a)("tinymce.tablepicker.insert_table_title"))),void 0!==l&&s.find("button, input").filter(m).toggleClass("disabled",l).prop("disabled",l)}var u,g=()=>e=>{var t,n,o=e.element,r=(t=o,n=c()(t).closest("PRE,BLOCKQUOTE,.text-placeholder"),e=>n.is(e)),a=r("BLOCKQUOTE"),i=r("PRE"),s=r(".text-placeholder");if(i)l(!0,c()(o).parents("table").is("[data-macro-body-type='PLAIN_TEXT']"));else if(s)l(!0);else if(a){l(!1),c()("#rte-button-justifyleft, #rte-button-justifycenter, #rte-button-justifyright").toggleClass("disabled",!0)}else l(!1)};function f(e){var t="default";return e&&e.id&&(t=e.id),"rte-toolbar-row-"+t}function m(e){return c()("#"+e).length>0}function p(e,t){var n=t.animate;null==n&&(n=!0);var o=function(){c()(this).remove(),De(s.document,"resize.resizeplugin"),t.onHide&&t.onHide()};clearTimeout(u),u=d.a.setTimeout(()=>{var e=f(t),r=c()("#"+e);n?r.slideUp(400,o):(r.hide(),o.call(r))},100)}function h(e,n){if(!t){var o=f(n),r=n.animate;if(null==r&&(r=!0),m(o))c()(`#${o}:hidden`).slideDown(400,()=>{0});else{var a=c()("<div></div>").addClass("toolbar-split toolbar-split-row toolbar-contextual");a.attr("id",o),n.editorAdjacent&&a.addClass("editor-adjacent");for(var i=n.topToolbar?c()("#rte-toolbar.aui-toolbar:visible"):c()("#savebar-container .aui-toolbar:visible"),l=0,g=n.buttons.length;l<g;l++){var p=n.buttons[l];a.append(p.render())}if(a.css({display:"none"}),n.editorAdjacent)i.append(a);else{var h=c()(".editor-adjacent",i).filter(":first");h.length?h.before(a):i.append(a)}a.find(".toolbar-dropdown").each((function(){b(this)}));var v=()=>{De(s.document,"resize.resizeplugin"),De(s.document,"shown.contextToolbar"),n.onVisible&&n.onVisible()};clearTimeout(u),u=d.a.setTimeout(()=>{r?a.slideDown(400,v):(a.show(),v())},100)}}}function b(e){var r=c()(e),a=r.dropDown("Standard",{alignment:r.data("dropdown-alignment")||"left"})[0];r.find(".dropdown-item").click((function(e){!function(e){if(!t){var n=e.attr("data-macro-name"),o=e.attr("data-command"),r=e.attr("data-format"),a=e.attr("data-control-id"),i=s.tinymce.activeEditor;n&&Jt.macroBrowserToolbarButtonClicked({presetMacroName:n}),o&&i.execCommand(o,!1),r&&i.plugins.atlassiantheme.controlHandlers.formatselect.click.dispatch(r),a&&i.plugins.atlassiantheme.controlHandlers.buttons.click.dispatch(a.toLowerCase())}}(c()(this)),a.hide(),e.preventDefault()})),o(a),n(a)}function v(){var e=[];for(var t in{})e.push("hints."+t);var n=function(e){if(!Array.isArray(e))throw new Error("Hints passed in must be an array of strings");var t=Math.floor(Math.random()*e.length);return{getNextHint:()=>{var n=e[t];return t=(t+1)%e.length,n}}}(e),o=()=>{c()("#rte-savebar .hints-text").html(s.tinymce.activeEditor.translate("tinymce."+n.getNextHint()))};o(),c()("#rte-savebar a.hints-close").click((function(e){c()(this).closest(".toolbar-split").addClass("hidden"),e.preventDefault()})),c()("#rte-savebar a.hints-next").click(e=>{o(),e.preventDefault()})}return{init(t){var i,l;b("#format-dropdown"),b("#more-menu .aui-dd-parent"),b("#insert-menu .aui-dd-parent"),c()("#pagelayout-menu").length&&b("#pagelayout-menu .aui-dd-parent"),c()("#template-menu").length&&b("#template-menu .aui-dd-parent"),function(){var e=c()("#color-picker-control");if(e.length){var t=e.find(".aui-dd-parent"),r=c()("#rte-button-color"),a=r.find(".selected-color"),i=t.dropDown("Standard",{alignment:"left"})[0],l=r.attr("data-color");a.css("background-color","#"+l),e.delegate("a[data-color]","click",(function(e){var t=c()(this),n=t.attr("data-color");e.preventDefault(),t.closest(".disabled").length||(s.tinymce.execCommand("ForeColor",!1,"#"+n),r.attr("data-color",n),a.css("background-color","#"+n))})),o(i),n(i)}}(),zo(),(i=c()("#rte-button-source-mode")).click(()=>{i.hasClass("active")?Fr(e.MODE_RICHTEXT):Fr(e.MODE_SOURCE)}),v(),l=t,De(s.document,"initContextToolbars.Toolbar",l),Ee(s.document,"createContextToolbarRow.Toolbar",h),Ee(s.document,"removeContextToolbarRow.Toolbar",p),Ee(s.document,"enableContextToolbarRow.Toolbar",r),Ee(s.document,"disableContextToolbarRow.Toolbar",a);var d=c()("#format-dropdown"),u=d.find("span.dropdown-text");t.on("BeforeExecCommand",e=>{var n=e.command,o=e.value;if(c.a.each(["pre","blockquote"],(function(){"FormatBlock"==n&&o==this&&(t.formatter.remove("alignleft"),t.formatter.remove("aligncenter"),t.formatter.remove("alignright"))})),c()(t.selection.getNode()).closest("pre,.text-placeholder").length)for(var r=["Bold","Italic","Underline","Strikethrough","InsertUnorderedList","InsertOrderedList","InsertInlineTaskList","InsertInlineTaskListNoToggle","superscript","subscript","mceConfMacroBrowser","mceConfimage","mceConfAttachments","mceEmotion","InsertWikiMarkup","mceConflink","mceInsertTable","mceConfAutocompleteLink"],a=r.length,i=0;i<a;i++)n==r[i]&&e.preventDefault();if("FormatBlock"==n&&"pre"==o&&(t.undoManager.add(),t.execCommand("removeFormat")),"FormatBlock"==n&&"p"==o){var l=d.find(".dropdown-item[data-format='blockquote']").text();u.text()==l&&t.execCommand("FormatBlock",!1,"blockquote")}}),t.on("ExecCommand",e=>{var t=e.command,n=e.value;if("FormatBlock"==t){var o=d.find(`.dropdown-item[data-format='${n}']`);o.length||(o=d.find(".dropdown-item[data-format='p']")),u.text(o.text())}}),t.on("NodeChange",g()),t.on("init",()=>{var e={};c()(".aui-toolbar").find("[data-control-id]").each((n,o)=>{var r=c()(o),a=r.attr("data-control-id");a&&("formatselect"==a?t.plugins.atlassiantheme.controlHandlers[a].state.add(e=>{if("p"==e){var n=t.selection.getNode();c()(n).closest("p").parent().is("blockquote")&&(e="blockquote")}var o=d.find(`.dropdown-item[data-format='${e}']`).text();o&&u.text(o)}):e[a.toLowerCase()]=r)});var n=t.plugins.atlassiantheme.controlHandlers.buttons;n.state.add((t,n,o)=>{var r=e[t];if(r){var a=r.find(".icon-check"),i=r.closest(".toolbar-item");a.length?a.toggleClass("hidden",!o):i.toggleClass(n,o)}}),c()(".aui-toolbar").delegate(".toolbar-item","click",(function(e){var t=c()(this);if(t.hasClass("disabled"))e.preventDefault();else{var o=t.children(".toolbar-trigger[data-control-id]").attr("data-control-id");o&&(n.click.dispatch(o.toLowerCase()),e.preventDefault())}})),c.a.support.shrinkWrapBlocks=!1,function(){Vr(c.a);var e={live:!0,gravity:"n",title:function(){return c()(this).attr("data-tooltip")||""},delayIn:250,delayOut:0},t=c.a.fn.tipsy.autoBounds2(50,"n"),n=c.a.fn.tipsy.autoBounds2(50,"w"),o=c.a.extend({},e,{gravity:t}),r=c.a.extend({},e,{gravity:n}),a=c.a.extend({},e,{gravity:"se"});c()("#rte-toolbar [data-tooltip]:not(.dropdown-item)").tooltip(o),c()("#rte-toolbar .dropdown-item[data-tooltip]").tooltip(r),c()("#rte-savebar [data-tooltip]").tooltip(a),c()("#editor-precursor [data-tooltip]").tooltip(o),c()("#property-panel [data-tooltip]").tooltip(o),Ee(s.document,"showLayer",Gr),Ee(s.document,"hideLayer",Gr),Object(y.a)("created.property-panel",$r),Object(y.a)("destroyed.property-panel",$r),Object(y.a)("register-contexts.keyboardshortcuts",Kr)}()}),t.on("Remove",()=>{Te(s.document,"showLayer",Gr),Te(s.document,"hideLayer",Gr),Object(y.c)("created.property-panel",$r),Object(y.c)("destroyed.property-panel",$r),Object(y.c)("register-contexts.keyboardshortcuts",Kr)})},toggleToolbarButton:i,disableToolbarButton:function(e){i(c()("."+e.replace(".","")),!0)},enableToolbarButton:function(e){t||i(c()("."+e.replace(".","")),!1)},focusToolbarButton:function(e){t||c()("."+e.replace(".","")).closest(".aui-button").focus()},isToolbarRowEnabled:function(e){var t=f({id:e});return m(t)&&!c()("#"+t).hasClass("disabled")},getToolbarRow:function(e){var t=f({id:e}),n=c()("#"+t);return n.length?n[0]:null},isToolbarButtonEnabled:function(e){return!c()("."+e.replace(".","")).closest(".aui-button").prop("disabled")},bindDropdownMenu:b,toggleToolbarButtons:l,disableToolbar:function(e){t=!!e},getInfo:()=>({longname:"customtoolbar",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"})}}var Jr=function(){var e={Button:function(e){var t=e.text,n=e.tooltip,o=e.triggerText,r=e.iconClass,a=e.click,i=!!e.disabled,l=e.id;this.render=()=>{var e=c()('<button type="button"></button>').addClass("aui-button aui-button-subtle").attr("data-tooltip",n||t);if(l&&e.attr("id",l),i&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click(()=>{e.prop("disabled")||a()}),r){var s=c()("<span />");s.addClass("icon "+r),s.text(t),e.append(s)}if(o){var d=c()("<span />");d.addClass("trigger-text"),d.text(o),e.append(d)}return e[0]}},DropDownButton:function(e){var t,n=e.id,o=e.tooltip,r=e.text||"",a=e.iconClass,i=!!e.disabled,l=e.dropDownContent;this.render=function(){var e=c()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").attr("data-tooltip",o);e.attr("id",n);var s=c()("<div/>").addClass("aui-dd-parent"),d=c()("<a href='#'></a>");if(d.addClass("toolbar-trigger").addClass("aui-dd-trigger").addClass("aui-button"),r&&d.append(`<span class="dropdown-text">${r}</span>`),i&&(e.addClass("disabled"),d.addClass("disabled")),a){var u=c()("<span />");u.addClass("icon "+a),u.text(r),d.append(u)}var g=c()("<span/>");return g.addClass("icon").addClass("icon-dropdown"),d.append(g),t=c()("<div/>").addClass("hidden").addClass("aui-dropdown"),l&&t.append(l),s.append(d),s.append(t),e.append(s),e[0]}},TextButton:function(e){var t=e.text,n=e.textClass,o=e.click,r=!!e.disabled,a=e.tooltip;this.render=()=>{var e=c()('<button type="button"></button>').addClass("aui-button aui-button-subtle").addClass(n).text(t);return a&&e.attr("data-tooltip",a),r&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click(()=>{e.prop("disabled")||o()}),e[0]}},TextBox:function(e){var t=e.id,n=e.text,o=e.name,r=e.keydown,a=e.cssClass;this.render=function(){var e=c()("<div></div>").addClass("toolbar-item");e.append(c()(`<label for="${t}">${n}</label>`));var i=c()(`<input id="${t}" type="text" name="${o}" class="${a} text" autocomplete="off">`);return i.keydown(e=>{r(e)}),e.append(i),e[0]}},Group:function(e,t){var n=e;this.render=function(){var e=c()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var o=0,r=n.length;o<r;o++)e.append(n[o].render());return e[0]}}};return e.SplitGroup=function(e,t){var n=e,o=t&&t.dropDownOptions||{};this.render=function(){var e=c()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var r=0,a=n.length;r<a;r++)e.append(n[r].render());return e.append(function(){var e=o.id,t=o.disabled,n=o.dropDownContent,r=o.title,a=o.alignment,i=c()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").addClass("toolbar-splitbutton");e&&i.attr("id",e),r&&i.attr({"data-tooltip":r}),a&&i.data("dropdown-alignment",a);var l=c()("<div/>").addClass("aui-dd-parent"),s=c()("<a href='#'></a>");s.addClass("toolbar-trigger aui-dd-trigger aui-button"),t&&(i.addClass("disabled"),s.addClass("disabled"));var d=c()("<span/>");d.addClass("icon").addClass("icon-dropdown"),s.append(d);var u=c()("<div/>").addClass("hidden").addClass("aui-dropdown");return n&&u.append(n),l.append(s),l.append(u),i.append(l),i[0]}()),t&&t.postProcess&&t.postProcess(e),e[0]}},d.a.Confluence.Editor.Toolbar={},d.a.Confluence.Editor.Toolbar.Components=e,e},qr=[];var Zr=()=>({initContextToolbars(){var e,t,n,o,r=s.tinymce.activeEditor,a=Jr(),i="aui-icon aui-icon-small aui-iconfont-",l=s.AJS.storageManager("atlassian.editor","tables"),d=e=>{var t=r.translate(e),n=e+"_shortcut",o=r.translate(n);return o&&o!==n&&(t+=` (${o})`),t},u={Buttons:[new a.Group([new a.Button({text:d("table.row_before_desc"),iconClass:i+"insert-row-before",click(){s.tinymce.execCommand("mceTableInsertRowBefore",!1,"")}}),new a.Button({text:d("table.row_after_desc"),iconClass:i+"insert-row-after",click(){s.tinymce.execCommand("mceTableInsertRowAfter",!1,"")}}),new a.Button({text:d("table.delete_row_desc"),iconClass:i+"remove-row",click(){s.tinymce.execCommand("mceTableDeleteRow",!1,"")}})]),new a.Group([new a.Button({text:d("table.cut_row_desc"),iconClass:i+"cut-table-row",click(){s.tinymce.execCommand("mceTableCutRow",!1,""),r.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),new a.Button({text:d("table.copy_row_desc"),iconClass:i+"copy-table-row",click(){s.tinymce.execCommand("mceTableCopyRow",!1,""),r.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),new a.Button({text:d("table.paste_row_before_desc"),iconClass:i+"paste-table-row",click(){s.tinymce.execCommand("mceTablePasteRowBefore",!1,"")},disabled:!l.doesContain("copied")})]),new a.Group([new a.Button({text:d("table.col_before_desc"),iconClass:i+"insert-column-before",click(){s.tinymce.execCommand("mceTableInsertColBefore",!1,"")}}),new a.Button({text:d("table.col_after_desc"),iconClass:i+"insert-column-after",click(){s.tinymce.execCommand("mceTableInsertColAfter",!1,"")}}),new a.Button({text:d("table.delete_col_desc"),iconClass:i+"remove-column",click(){s.tinymce.execCommand("mceTableDeleteCol",!1,"")}})]),new a.Group([new a.Button({text:d("table.merge_cells_desc"),iconClass:i+"merge-table-cells",click(){s.tinymce.execCommand("mceTableMergeCells",!1,"")}}),new a.Button({text:d("table.split_cells_desc"),iconClass:i+"split-merged-table-cells",click(){s.tinymce.execCommand("mceTableSplitCells",!1,"")}})]),new a.Group([new a.Button({text:d("table.row_highlight"),iconClass:i+"heading-row",click(){s.tinymce.execCommand("confTableRowToggleHeading",!1),s.tinymce.execCommand("mceTableUpdateNumberingCol",!1)}}),new a.Button({text:d("table.col_highlight"),iconClass:i+"heading-column",click(){s.tinymce.execCommand("confTableColumnToggleHeading",!1)}}),new a.Button({text:d("table.numbering_column_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-insert-numbered-column",id:"insert-numbering-column",click(){r.execCommand("mceTableToggleSeries",!1,{name:"numbers"})}})]),new a.SplitGroup([new a.Button({text:d("table.selection_highlight"),iconClass:i+"paint-bucket",click(){s.tinymce.execCommand("confTableSelectionToggleHighlight",!1)}})],{id:"table-highlight-group",dropDownOptions:{id:"table-highlight-colour",dropDownContent:(e=c()("<ul/>").addClass("table-highlight-picker"),c.a.each(A.a.colorValues,(t,n)=>{var o=c()("<li/>"),r=c()("<a href='#'></a>"),a=A.a.colorNames[n];"clear"===n?r.addClass("remove-highlight").attr("data-remove-highlight","true"):r.addClass("highlight-#"+n).attr("data-highlight-colour","#"+n),r.attr("title",a),r.attr("aria-label",a),r.tooltip(),o.append(r),e.append(o)}),e),alignment:"left"},postProcess(e){e.attr("data-highlight-colour","grey"),e.addClass("highlight-grey");var t=c()("<span>&nbsp;</span>");t.addClass("highlight-indicator"),e.find(".icon.aui-iconfont-paint-bucket").after(t)}}),new a.Group([new a.Button({text:d("table.del"),iconClass:i+"remove-table",click(){s.tinymce.execCommand("mceTableDelete",!1,"")}})])],Events:qr},g=e=>{function t(e,t){return parseInt(e.attr(t),10)}return e.filter((function(){var e=c()(this);return t(e,"rowspan")>1||t(e,"colspan")>1})).length>=1};function f(e){var t=c()(this),n=c()("#table-highlight-group"),o=n.attr("data-highlight-colour"),a=n.attr("data-remove-highlight");o&&(n.removeClass("highlight-"+o),n.removeAttr("data-highlight-colour")),n.removeClass("remove-highlight"),a&&n.removeAttr("data-remove-highlight");var i=t.attr("data-highlight-colour");i&&(n.addClass("highlight-"+i),n.attr("data-highlight-colour",i)),t.attr("data-remove-highlight")&&(n.addClass("remove-highlight"),n.attr("data-remove-highlight","true")),r.focus(!1),r.execCommand("confTableSelectionToggleHighlight",!1,{alwaysHighlight:!0}),e.preventDefault()}return r.on("NodeChange",e=>{var n,o=e.element,a=c()("body"),i=!a.hasClass("no-tools")||a.hasClass("no-tools-toolbars-visible");t||null==o.parentNode||"BODY"===o.nodeName||(t=!0,n=o,c()(n).closest("table:not(.wysiwyg-macro)").length?(De(s.document,"createContextToolbarRow.Toolbar",{buttons:u.Buttons,topToolbar:!0,animate:i}),De(s.document,"enableContextToolbarRow.Toolbar",{id:"default"}),(e=>{c.a.fn.updateTableModeInToolbar&&c()(e).closest("table").updateTableModeInToolbar()})(o),(e=>{var t=c()(e).closest("td,th"),n=c()(".mceSelected",t.closest("table"));g(t.add(n))?r.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-split"):r.plugins.customtoolbar.disableToolbarButton("aui-iconfont-table-split")})(o),(e=>{c()(e).closest("table").find(".numberingColumn").length>0?c()("#insert-numbering-column").addClass("active"):c()("#insert-numbering-column").removeClass("active")})(o)):De(s.document,"disableContextToolbarRow.Toolbar",{animate:i}),t=!1)}),r.on("Undo",()=>{r.nodeChanged()}),r.initialized?c()(s.document).on("click","#table-highlight-colour .aui-dropdown a",f):r.on("init",()=>{c()(s.document).on("click","#table-highlight-colour .aui-dropdown a",f)}),r.on("Remove",()=>{c()(s.document).off("click","#table-highlight-colour .aui-dropdown a",f)}),u.Buttons.splice(0,0,new a.Group([new a.DropDownButton({id:"table-mode-picker",text:d("table.responsive"),dropDownContent:(n=c()("<ul/>").addClass("table-mode-list"),o=[{name:d("table.responsive"),mceCmd:"mceAutoWidth",tooltip:d("table.responsive_tooltip")},{name:d("table.fixed_width"),mceCmd:"mceFixedWidth",tooltip:d("table.fixed_width_tooltip")}],c.a.each(o,(e,t)=>{var o=c()("<li/>").addClass("dropdown-item").attr("data-tooltip",t.tooltip),r=c()(`<a href="#">${t.name}</a>`).addClass("item-link");o.on("click",()=>{s.tinymce.execCommand(t.mceCmd,!1,"")}),n.append(o.append(r))}),n)})])),u.Buttons.splice(3,0,new a.Group([new a.Button({text:d("table.col_cut_desc"),iconClass:i+"cut-table-column",click(){s.tinymce.execCommand("mceTableCutCol",!1,""),r.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new a.Button({text:d("table.col_copy_desc"),iconClass:i+"copy-table-column",click(){s.tinymce.execCommand("mceTableCopyCol",!1,""),r.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new a.Button({text:d("table.col_paste_desc"),iconClass:i+"paste-table-column",click(){s.tinymce.execCommand("mceTablePasteColBefore",!1,"")},disabled:!l.doesContain("copied")})])),u}});n(55);var Xr=function(){var e,t,n,o,r,a,i,l,d,g,f,m,p,h=s.Confluence.PropertyPanel,b=[800,800,400,400,400,300,300,300,300,300,300,300,300,300,300,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100];var v="p,h1,h2,h3,h4,h5,h6,blockquote,li,td,th,img";function w(t){var r=!!o.children(".contentLayout,.contentLayout2").length;function a(){return n.find("#move-indicator")}function i(e){return"move-indicator"===e.attr("id")}function l(e){return r?e.is("div.innerCell,div.cell"):e.is("body")}function s(e,t,o){return e.is("img")?function(e,t){var o=e.offset();return t+n.scrollLeft()-o.left}(e,t)<e.width()/2:d(e,o)<e.height()/2}function d(e,t){var o=e.offset();return t+n.scrollTop()-o.top}return{positionNear:function(e,r){var u=function(e,r){var u=c()(n[0].elementFromPoint(e,r)),g=!0;if(function(e){if(e.is(v)&&!i(e))return(!e.is("td.wysiwyg-macro-body")||"PLAIN_TEXT"!==e.closest("table").attr("data-macro-body-type"))&&!(e.is("img")&&!t.is("img"));return!1}(u))return{target:u,before:s(u,e,r)};if(l(u)){if(function(e,t){return d(e.children().first(),t)<0}(u=function(e){if(e.is("div.cell"))return e.children("div.innerCell").first();return e}(u),r))u=u.children().first();else if(function(e,t){return function(e,t){var n=d(e,t),o=e.height();return n-o}(e.children().last(),t)>0}(u,r))u=u.children().last(),g=!1;else{if(f=u,a().length>0&&a().parent(f).length>0)return null;u=function(e){var n=t.parent(v);n.length||(n=e.find(v).last());n.length||(n=o.find(v).last());return n}(u),g=!1}return{target:u,before:g}}var f;return null}(e,r);u&&function(e,t){if(i(e))return;var n=a();if(e.is("li,td,th")&&e.find(n).length)return;n.length?n.detach():n=c()('<span id="move-indicator">|</span>');(e=function(e){if(e.is("li,td,th")){var t=e.children().first();t.is("p,h1,h2,h3,h4,h5,h6,blockquote")&&(e=t)}return e}(e)).is("img")?e.is("li,td,th")?t?e.prepend(n):e.append(n):t?e.before(n):e.after(n):e.prepend(n)}(u.target,u.before)},replaceWith:function(t){var n=a();n.length?(t.is("img")&&l(n.parent())&&(t=c()("<p></p>").append(t)),n.replaceWith(t),e.dom.isBlock(t[0])&&t.parent().is("p")&&t.unwrap(),u().showElement(t),e.selection.select(t[0]),e.selection.collapse(!0)):e.undoManager.undo()},destroy:function(){var e=a();e.length&&e.remove()}}}function C(t){if(1===t.which&&t.target===t.currentTarget)if(d)k(t);else{d=c()(t.target),e.selection.select(t.target),t.preventDefault(),n.bind({"mousemove.moveable-zone":M,"mouseup.moveable-zone":k,"keydown.moveable-zone":A,"mouseover.moveable-zone":x});var o,s=d.offset();i=t.pageX,l=t.pageY,r=s.top-l,a=s.left-i,f=!0,g=(o=d).attr("style")||"",d=o}}function A(t){27===t.keyCode&&(m.cancelScrolling(),n.unbind(".moveable-zone"),e.undoManager.undo(),e.selection.select(d[0]),e.selection.collapse(!1),d=null)}function x(){n.find(".mceSelected").removeClass("mceSelected")}function M(n){if(f){if(function(e){var t=Math.abs(i-e.pageX),n=Math.abs(l-e.pageY);return t<10&&n<10}(n))return;nt(),e.undoManager.beforeChange(),e.undoManager.typing=!0,e.undoManager.add(),Object(y.b)("synchrony.stop",{id:"confluence.draggable-plugin"}),(c=e.selection.getSel())&&c.removeAllRanges&&c.removeAllRanges(),d.css({position:"absolute",width:d.css("width"),"max-width":"50%"}),h.current&&h.destroy(),d.detach(),o.append(d),p=w(d),f=!1}var c;n.preventDefault(),d.hide(),function(e,n){var o=b.length;if((n=Math.max(n,0))<o)return void m.scrollUp(b[n]);var r=t.height(),a=Math.max(0,r-n);if(a<o)return void m.scrollDown(b[a]);m.cancelScrolling()}(n.clientX,n.clientY),p.positionNear(n.clientX,n.clientY);var s=Math.min(n.pageY+r,m.scrollHeight()-d.outerHeight()),u=n.pageX+a;d.css({top:s,left:u,opacity:.5}),d.show()}function k(t){n.unbind(".moveable-zone"),m.cancelScrolling(),f?d=null:(t.preventDefault(),d.detach(),d.attr("style",g),p.replaceWith(d),p.destroy(),d=null,p=null,x(),e.undoManager.add(),Object(y.b)("synchrony.start",{id:"confluence.draggable-plugin"}))}return{init(r){e=r,r.on("Init",()=>{var e,a,i;t=c()(r.getWin()),n=c()(r.getDoc()),o=c()(r.getBody()),e=s.tinymce.Env.webkit?o:n.find("html"),a=e,i=0,m={scrollUp(e){if(i!==-e){i=-e;var t=a.scrollTop()/e*1e3;a.stop(!1,!1),a.animate({scrollTop:0},{duration:t})}},scrollDown(e){if(i!==e){var t=a[0].scrollHeight,n=(t-a.scrollTop())/e*1e3;a.stop(!1,!1),a.animate({scrollTop:t},{duration:n})}},cancelScrolling(){a.stop(!0,!1)},scrollHeight:()=>a[0].scrollHeight},n.delegate("img.confluence-embedded-image,img.editor-inline-macro,table.wysiwyg-macro",{mousedown:C})})},getInfo:()=>({longname:"Draggable objects (images, tables, placeholders) around the document via drag and drop",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"})}};function ea(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ta{constructor(e){ea(this,"value",void 0),ea(this,"toJSON",void 0),this.value=e,this.valueOf=this.toString=this.toJSON=()=>this.value}}var na,oa=e=>new ta(e),ra={},aa=0,ia=function(e,t){if(e&&(ra[e]?ra[e]++:ra[e]=1,t)){var n=e+"Size";ra[n]?ra[n]+=t:ra[n]=t}},la=function e(){ra.pageID=g.a.get("page-id"),ra.editorVersion=oa("8.4.0"),Object(y.b)("analytics",{name:"confluence.editor.action",data:ra}),ra={},Object(s.clearTimeout)(na),na=Object(s.setTimeout)(e,6e4)},ca={Bold:"bold",confCharmap:"insert.symbol",confMonospace:"monospace",confTableRowToggleHeading:"table.row.toggle.heading",confTableColumnToggleHeading:"table.column.toggle.heading",confTableSelectionToggleHighlight:"table.selection.toggle.highlight",ForeColor:"foreground.color",FormatBlock:"format.block",Indent:"indent",InsertHorizontalRule:"insert.horizontal.rule",InsertOrderedList:"insert.ordered.list",InsertUnorderedList:"insert.unordered.list",InsertWikiMarkup:"insert.wiki.markup",Italic:"italic",JustifyCenter:"justify.center",JustifyLeft:"justify.left",JustifyRight:"justify.right",mceConfimage:"insert.files.images",mceConflink:"insert.link",mceConfMacroBrowser:"open.other.macros.browser",mceEmotion:"insert.emoticon",mceTableCopyRow:"table.copy.row",mceTableCutRow:"table.cut.row",mceTableDelete:"table.delete",mceTableDeleteCol:"table.delete.column",mceTableDeleteRow:"table.delete.row",mceTableInsertColAfter:"table.insert.column.after",mceTableInsertColBefore:"table.insert.column.before",mceTableInsertRowAfter:"table.insert.row.after",mceTableInsertRowBefore:"table.insert.row.before",mceTableMergeCells:"table.merge.cells",mceTablePasteRowBefore:"table.paste.row.before",mceTableSplitCells:"table.split.cells",mcePageLayoutsToolbar:"page.layouts.toolbar.toggle",mcePageLayoutAddSection:"page.layouts.toolbar.add.section",mcePageLayoutRemoveSection:"page.layouts.toolbar.remove.section",mcePageLayoutMoveSectionDown:"page.layouts.toolbar.movedown.section",mcePageLayoutMoveSectionUp:"page.layouts.toolbar.moveup.section",mcePageLayoutChangeSection:"page.layouts.toolbar.change.section",mceConfShortcutDialog:"open.help.dialog",mceSearchReplaceToolbar:"search.replace.toolbar.toggle",mceConfSearchClose:"search.replace.toolbar.close",mceConfSearch:"search",mceConfReplace:"replace",mceConfReplaceAll:"replace.all",Outdent:"outdent",Redo:"redo",Strikethrough:"strikethrough",subscript:"subscript",superscript:"superscript",Underline:"underline",Undo:"undo",InsertInlineTaskList:"insert.inline.tasklist",InsertInlineTaskListNoToggle:"insert.inline.tasklist.no.toggle"};function sa(e,t,n){n&&n.node&&c()(".inline-comment-marker",n.node).contents().unwrap()}n(57);var da="object"==typeof window?window.localStorage:{},ua=function(e,t){var n=`${e}.${g.a.get("remote-user")||""}.${t}`,o=!1,r=/\d+#/,a=function(e){if(!o)return null;var t,a=da.getItem(`${n}.${e}`);return a&&(t=r.exec(a))&&(a=a.replace(t[0],""),+new Date>Number(t[0].replace("#","")))?(da.removeItem(`${n}.${e}`),null):a};try{o=Object.keys(da).length}catch(e){console.log("Browser does not support localStorage, Confluence.storageManager will not work.")}return{getItem:a,getAllItems:function(){if(!o)return null;var e={};for(var t in da)if(da.hasOwnProperty(t)&&t.indexOf(n+".")>-1){var r=t.split(n+".")[1];e[r]=a(r)}return e},doesContain:e=>!!a(e),getItemAsBoolean(e){var t=a(e);return"false"!==t&&("true"===t||!!t)},setItem(e,t,r){var a;o&&(t=((a=1e3*(r||0))?+new Date+a+"#":"")+t,da.setItem(`${n}.${e}`,t))},setItemQuietly(e,t,n){try{this.setItem(e,t,n)}catch(n){console.log(`Unable to write to localStorage. key: ${e}, value: ${t}, cause: ${n}`)}},removeItem(e){o&&da.removeItem(`${n}.${e}`)}}}("confluence","userSettings");function ga(e,t){return t?`${e}.${t.replace(/\./g,"-")}`:e}var fa={get:function(e,t,n){var o=ga(e,t),r=ua.getItem(o);return null!==r?JSON.parse(r):void 0!==n?n:null},set:function(e,t,n,o){var r=ga(e,t);if(o===n)ua.removeItem(r);else{ua.setItem(r,JSON.stringify(o),2592e3)}}},ma=(n(59),{HELP_REST_API:w.a+"/plugins/tinymce/helplink.action",WIKI:{CONFLUENCE:{api:ro.getWikiConfluenceToXhtml,val:"CONFLUENCE",label:"confluence.conf_wikimarkup_confluence_label",helpLink:"help.insert.wiki.markup",restApi:"/rest/tinymce/1/wikixhtmlconverter"},MARKDOWN:{api:ro.getWikiMarkdownToXhtml,val:"MARKDOWN",label:"confluence.conf_wikimarkup_markdown_label",helpLink:"help.insert.wiki.markup.markdown",restApi:"/rest/tinymce/1/markdownxhtmlconverter"}}}),pa={dialog:{id:"insert-wiki-markup-dialog",content:"",width:980,height:500,popup:!1,name:"confluence.conf_wikimarkup_desc"},markupEditId:"insert-wiki-textarea",previewAreaId:"insert-wiki-textarea-preview",selectionMenuId:"wiki-parser-selection-tool",serverRequestTimer:300,entityId:g.a.get("content-id"),spaceKey:g.a.get("space-key")},ha=null,ba=()=>{var e=fa.get("insert-wiki-markup-dialog.parser","global","CONFLUENCE");return ma.WIKI[e]},va=(e,t)=>{var n=c()(((e,t,n)=>`\n    <span class="wiki-parser-selector">\n        <form action="#" method="post" id="d" class="aui">\n            <select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector">\n                <option value="${t.val}">${e(t.label)}</option>\n                ${Object.keys(n).filter(e=>n[e].val!==t.val).map(t=>`<option value="${n[t].val}">${e(n[t].label)}</option>`)}\n            </select>\n        </form>\n    </span>\n`)(e,t,ma.WIKI));return c()("#insert-wiki-insert-title").append(n),c()("#"+pa.selectionMenuId)},ya=()=>{var e=c()("#"+pa.selectionMenuId);return e.length?e.val():ba().val},wa=e=>{var t={wiki:(e=e||{}).textToConvert,entityId:pa.entityId,spaceKey:pa.spaceKey};e.api(JSON.stringify(t),(t,n)=>{t?e.errorCallback(t):e.successCallback(n)})},Ca=()=>{var e=c()("#"+pa.markupEditId).val();c.a.trim(e)?wa({api:ma.WIKI[ya()].api,textToConvert:e,successCallback:e=>{ha.html(e)},errorCallback:()=>{ha.html(xa(e))}}):ha.html(e)},Aa=()=>{var e,t,n,o=ya();fa.set("insert-wiki-markup-dialog.parser","global","CONFLUENCE",o),e=o,t=c()("#"+pa.dialog.id).find(".dialog-help-link"),n=ma.WIKI[e].helpLink,t.load(ma.HELP_REST_API,{linkUrlKey:n}),Ca()};function xa(e){if("string"!=typeof e)return"";var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return e.replace(/[&"'<>`]/g,e=>"string"==typeof t[e]?t[e]:"&quot;")}var Ma={init:(e,t)=>{var n;pa.dialog.content=`\n    <p id="insert-wiki-info-title">${(n=e=>Object(Lt.a)(e))("tinymce.confluence.conf_wikimarkup_info_title")}</p>\n    <form action="#" method="post" id="insert-wiki-markup-form" class="aui">\n        <h3 class="wiki-title">\n            <span id="insert-wiki-insert-title">${n("tinymce.confluence.conf_wikimarkup.insert.label")}</span>\n            <span id="insert-wiki-preview-title">${n("tinymce.confluence.conf_wikimarkup_preview_label")}</span>\n        </h3>\n        <textarea class="monospaceInput textarea" id="insert-wiki-textarea" name="wikitext"></textarea>\x3c!--\n            --\x3e<div class="example-container" id="insert-wiki-textarea-preview"></div>\n    </form>\n`;var o=t=>{var n,o,r,a=pa.dialog.id,i=ya();e.windowManager.setBusy(a,!1),s.tinymce.EditorManager.activeEditor.windowManager.close(a),Object(y.b)("analytics",{name:"insert-wiki-markup-dialog."+i}),"MARKDOWN"===i&&(n=t,(o=c()(n)).find("img").addClass("confluence-embedded-image"),t=c()("<div>").append(o.clone()).html()),e.execCommand("mceInsertContent",!1,t),r=e,s.tinymce.each(r.dom.select("p > p"),e=>{try{e.parentNode&&r.dom.split(e.parentNode,e)}catch(e){}})},r=(t,n,o)=>{e.windowManager.setBusy(pa.dialog.id,!1);var r=((e,t)=>`\n        <p class="warning">\n            ${e}\n        </p>\n        <p class="exception-report">\n            <span class="exceptionMessage">\n                ${t}\n            </span>\n        </p>\n`)(e.translate("confluence.conf_wikimarkup_conversion_errors"),"timeout"===n?e.translate("confluence.conf_wikimarkup_timeout"):`${xa(n||t.message)} : ${xa(o)}`);s.tinymce.EditorManager.activeEditor.windowManager.alert(r)};e.addCommand("InsertWikiMarkup",()=>{var n,a=ba();return e.windowManager.open(pa.dialog,{buttons:[{label:"confluence.conf_insert_button_title",action:()=>{e.windowManager.setBusy(pa.dialog.id,!0),wa({api:ma.WIKI[ya()].api,successCallback:o,errorCallback:r,textToConvert:c()("#"+pa.markupEditId).val(),setBusy:!0})}}],plugin_url:t,helpLink:a.helpLink,hintText:"confluence.conf_wikimarkup_hint",cssClass:"insert-wiki-markup-panel"}),(e=>{var t=c()("#wysiwygTextarea_ifr").contents().find("head").html(),n=c()("<iframe tabindex='-1' id='insert-wiki-markup-preview' />");c()("#"+e).append(n);var o=n.contents(),r=o[0];r.open(),r.write('\n    <!DOCTYPE html>\n    <html class="insert-wiki-markup-dialog">\n        <head>\n        </head>\n        <body class="wiki-content previewWiki">\n        </body>\n    </html>\n'),r.close(),o.find("head").html(t),ha=o.find("body")})(pa.previewAreaId),va(t=>e.translate(t),a).on("change",Aa),c()("#"+pa.markupEditId).on("keydown",(function(){clearTimeout(n),n=d.a.setTimeout(Ca,pa.serverRequestTimer)})),!1}),e.ui.registry.addButton("insertwikimarkup",{text:"confluence.conf_wikimarkup_desc",onAction:function(){e.execCommand("InsertWikiMarkup")}})},getInfo:()=>({longname:"InsertWikiMarkip",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.1"})};n(61);var ka={init(e){var t=s.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.comment.lost")}e.on("Init",()=>{Object(y.a)("beforeunload",n)}),e.on("Remove",()=>{Object(y.c)("beforeunload",n)})},getInfo:()=>({longname:"Confluence Leave Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})};var Ea={init(e){var t=s.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.template.lost")}e.on("Init",()=>{Object(y.a)("beforeunload",n)}),e.on("Remove",()=>{Object(y.c)("beforeunload",n)})},getInfo:()=>({longname:"Confluence Leave Template",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})};var Ta={init(e){var t=e.getParam("atl_macro_class","wysiwyg-macro"),n=function(e){return 3===e.nodeType},o=function(t,n){return e.dom.getParent(t,n)},r=function(e){return n(e)?e.length:e.childNodes.length},a=function(e){return o(e,"table."+t)},i=function(e){return null!==a(e)},l=function(e,t){return e.bottom<=t.top&&e.top<t.bottom},c=function(e,t){return e.top>=t.bottom&&e.bottom>t.top},d=function(e,t){var n=e.childNodes;if(0===n.length)return{node:e,offset:t};if(t<n.length)return{node:n[t],offset:0};var o=n[n.length-1];return"img"===e.nodeName.toLowerCase()?{node:o,offset:1}:{node:o,offset:r(o)}},u=function(t){if(function(e){return 1===e.nodeType}(t))return s.tinymce.toArray(t.getClientRects());if(n(t)){var o=e.dom.createRng();return o.selectNode(t),s.tinymce.toArray(o.getClientRects())}return[]},g=function(t,o){return function(t,o){var r=e.selection.getRng();if(r){var a=d(1===t?r.startContainer:r.endContainer,1===t?r.startOffset:r.endOffset),i=a.node;if(n(i)&&a.offset>0){var l=i.splitText(a.offset),c=o(1===t?i:l);return 0===l.length&&e.dom.remove(l),c}return o(i)}}(o,(function(e){return function(e,t,n,o){var r,a=new s.tinymce.dom.TreeWalker(e,t),i=1===n?a.prev:a.next,d=1===n?l:c,g=e,f=0,m=[];do{var p=u(g).filter((function(e){return 0!==e.height&&0!==e.width}));if(0!==p.length&&(1===n&&p.reverse(),p.forEach((function(e){if(0!==e.height&&0!==e.width){r&&d(e,r)&&f++;var t=m[f];m[f]=t?t.concat([e]):[e],r=e}})),o(m)))return m}while(g=i());return m}(e,t,o,(function(e){return e.length>1})).length<=1}))},f=function(t,n){var o=e.selection.getRng();if(o){var a=1===n?o.startContainer:o.endContainer,i=1===n?o.startOffset:o.endOffset;return(1===n&&i<=0||-1===n&&i>=r(a))&&function(e,t,n){for(var o,a=d(n?t.startContainer:t.endContainer,n?t.startOffset:t.endOffset),i={node:e,offset:n?0:r(e)};!o||i.node!==o.node;){if(a.node===i.node&&a.offset===i.offset)return!0;o=i,i=d(i.node,i.offset)}return!1}(t,o,1===n)}};e.on("init",(function(){e.on("keydown",(function(t){var n,o,l=e.selection.getRng(),c=function(e){return(e.keyCode===s.tinymce.util.VK.LEFT||e.keyCode===s.tinymce.util.VK.RIGHT)&&e.shiftKey}(t),u=function(e){return(e.keyCode===s.tinymce.util.VK.UP||e.keyCode===s.tinymce.util.VK.DOWN)&&e.shiftKey}(t);if((c||u)&&l&&function(e){return i(e.startContainer)&&i(e.endContainer)}(l)){var m=(n=l.startContainer,o=a(n),e.dom.select("th,td",o)[0]),p=t.keyCode===s.tinymce.util.VK.UP||t.keyCode===s.tinymce.util.VK.LEFT?1:-1,h=u&&g(m,p),b=c&&f(m,p);(h||b)&&(!function(t,n){var o=e.selection.getRng();if(o){var a=o.cloneRange(),i=d(t,n?0:r(t));n?a.setStart(i.node,i.offset):a.setEnd(i.node,i.offset),e.selection.setRng(a,!n)}}(m,1===p),t.preventDefault(),t.stopImmediatePropagation())}if(t.keyCode===s.tinymce.util.VK.ENTER||t.keyCode===s.tinymce.util.VK.BACKSPACE||t.keyCode===s.tinymce.util.VK.DELETE){if(!l||l.collapsed)return;e.getDoc().querySelectorAll("td.wysiwyg-macro-body[data-mce-selected]").forEach(e=>{e.removeAttribute("data-mce-selected")})}}),!0),e.on("mouseup",(function(t){if(3===t.detail){var n=e.selection.getRng();if(n){var r=o(n.startContainer,"td.wysiwyg-macro-body"),a=o(n.endContainer,"td.wysiwyg-macro-body");if(r===a)return;if(null!==r&&!r.contains(n.endContainer)&&r.lastChild){var i=e.dom.createRng();i.setStart(n.startContainer,n.startOffset),i.setEndAfter(r.lastChild),e.selection.setRng(i,!0)}if(null!==a&&!a.contains(n.startContainer)&&a.firstChild){var l=e.dom.createRng();l.setStartBefore(a.firstChild),l.setEnd(n.endContainer,n.endOffset),e.selection.setRng(l,!0)}}}}))}))},getInfo:()=>({longname:"Macro Navigation",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})},Da={init(e){e.on("Init",()=>{e.addCommand("mceConfMacroBrowser",s.tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked)})},getInfo:()=>({longname:"Confluence Macro Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})};var Ia={init:e=>{e.on("init",()=>{var e={contentId:g.a.get("content-id")},t=c()("#rte-savebar-tinymce-plugin-point");t.append(`\n    <span class="minor-edit toolbar-item">\n        <input id="notifyWatchers" name="notifyWatchers" value="true" type="checkbox" checked>\n        <label for="notifyWatchers">\n          <span>${(e=>Object(Lt.a)(e))("editor.minor.edit")}</span>\n        </label>\n    </span>\n`);var n=t[0].querySelector('input[id="notifyWatchers"]'),o=fa.get("notifyWatchers",e.contentId,!0);null!==o&&(n.checked=o),Ee(n,"change",()=>{fa.set("notifyWatchers",e.contentId,!0,n.checked)})})},getInfo:()=>({longname:"Confluence Notify Watchers",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})};function Sa(){var e=function(e){this.fileTypes=e};e.prototype.beforeParamsSet=function(e){if(!e.page&&!e.date&&!e.space){var t=g.a.get("content-type");"page"==t||"blogpost"==t?e.page=s.document.getElementById("content-title").value:"comment"==t&&(e.page=g.a.get("page-title"))}if(e.date){var n=e.date.split("/");e.page=["",n[2],n[0],n[1],e.page].join("/")}return e.space&&(e.page=`${e.space}:${e.page}`),e},e.prototype.beforeParamsRetrieved=function(e){if(e.page){var t=e.page.split(":");t.length>1&&(e.space=t[0],e.page=t[1]);var n=e.page.split("/");n.length>1&&(e.date=[n[2],n[3],n[1]].join("/"),e.page=n[4]);var o=g.a.get("content-type");(("page"==o||"blogpost"==o)&&e.page==s.document.getElementById("content-title").value||"comment"==o&&e.page==g.a.get("page-title"))&&delete e.page}return e},e.prototype.fields={attachment:function(e){var t={fileTypes:this.fileTypes},n=s.AJS.MacroBrowser.ParameterFields.attachment(e,t);return n.dependencyUpdated=function(e,t){var n,o,r=(n={},o=t.split(":",2),n.spaceKey=2==o.length&&o[0]||g.a.get("space-key"),n.title=o[o.length-1],0==n.title.indexOf("/")&&(n.postingDay=n.title.substr(1,10),n.title=n.title.substr(12)),n.title==s.document.getElementById("content-title").value&&(n.title=""),n.title||(g.a.get("new-page")?n.draftId=g.a.get("content-id"):n.pageId=g.a.get("page-id")),n);this.getData(r)},n},spacekey:function(e){return s.AJS.MacroBrowser.ParameterFields._hidden(e,{})},date:function(e){return s.AJS.MacroBrowser.ParameterFields._hidden(e,{})},"confluence-content":function(e){return s.AJS.MacroBrowser.ParameterFields["confluence-content"](e,{dependencies:["name"]})}},s.AJS.MacroBrowser.Macros.viewdoc=new e(["doc","docx"]),s.AJS.MacroBrowser.Macros.viewpdf=new e(["pdf"]),s.AJS.MacroBrowser.Macros.viewxls=new e(["xls","xlsx"]),s.AJS.MacroBrowser.Macros.viewppt=new e(["ppt","pptx"]),s.AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro(e){var t=e.params[""]||e.params.name;if(t){var n=t.lastIndexOf(".");if(n>0){var o=t.substring(n+1);o&&("doc"==o&&"docx"==o&&(e.name="viewdoc"),"pdf"==o&&(e.name="viewpdf"),"ppt"==o&&"pptx"==o&&(e.name="viewppt"),"xls"==o&&"xlsx"==o&&(e.name="viewxls"))}}}}}n(63),n(64),n(65);var Oa,ja=n(14),Na=n.n(ja),La=n(25),Ba=n.n(La),Pa=[],Ra=[],Ha=(e,t)=>{var n=new s.Confluence.Editor.FileDialog.FileDialogView({submitCallback:e,cancelCallback:t,beforeShowListeners:Pa,panelComponents:Ra});return n.render(),n},za=e=>{var t=s.Confluence.Link.fromREST(e.attributes);t.attrs["data-linked-resource-container-id"]=e.get("ownerId"),t.attrs.href=e.get("downloadUrl"),t.insert()},Fa=e=>{var t;en.a.insertFilePlaceholder({name:e.get("fileName"),page:e.get("parentTitle"),space:(null===(t=e.get("space"))||void 0===t?void 0:t.key)||"",date:e.get("datePath"),ownerId:e.get("ownerId")})},Ua={beforeShowListeners:Pa,panelComponent:Ra,sizeToFit:function(){return null==this||this.each((function(){var e=this,t=c()(this).parent(),n=t.height();t.children().each((function(){this!==e&&c()(this).is(":visible")&&(n-=c()(this).outerHeight())}));var o=c()(this).outerHeight()-c()(this).height();c()(this).css("height",Math.max(0,n-o)+"px")})),this},defaultInsertImageDialog:()=>{nt(),Ha((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.contentId,o=e.selectItems;if(ot(),t)s.tinymce.confluence.ImageUtils.insertFromProperties({url:t,filename:t,contentId:n});else{var a=!0,i=(null==o?void 0:o.length)>1;null==o||o.forEach(e=>{e.isImage()?s.tinymce.confluence.ImageUtils.insertFromProperties({filename:e.getFileName(),contentId:e.get("ownerId")},i):(a=!1,r.a.MacroBrowser.getMacroMetadata("view-file")?Fa(e):za(e))}),null===Ba.a||void 0===Ba.a||Ba.a.triggerEvent("confluence.insert-files-dialog.insert",o,a)}c()("#comments-section").length&&p.Rte.fixEditorFocus()}),()=>ot())},findPanelComponentById:e=>{for(var t=s.Confluence.Editor.ImageDialog.panelComponent,n=0;n<t.length;n++)if(t[n].id===e)return t[n]},insertImageDialog:Ha,_insertLinkToEditor:za,_insertFilePlaceholderToEditor:Fa},_a=(e,t,n,o)=>{var r=c()("#rte-button-restrictions"),a=r.find(".icon"),i="",l="";if(e||t){var s=e?"aui-iconfont-locked icon-red":"aui-iconfont-unlocked icon-red";a.removeClass("aui-iconfont-locked aui-iconfont-unlocked icon-red").addClass(s),i=Object(Lt.a)("page.restrictions.apply"),l=Object(Lt.a)("editor.restrictions.icon.editor-restricted")}else a.removeClass("aui-iconfont-locked aui-iconfont-unlocked icon-red").addClass("aui-iconfont-unlocked"),n?(i=Object(Lt.a)("page.restrictions.apply"),l=Object(Lt.a)("editor.restrictions.icon.editor-restricted")):(i=Object(Lt.a)("page.restrictions.none"),l=Object(Lt.a)("editor.restrictions.icon.editor-unrestricted"));r.attr("data-tooltip",i),r.attr("aria-label",l),r.data("explicit-restrictions",e),r.data("inherited-restrictions",t),r.data("restrictionsHash",o)},Wa=(e,t)=>{if(void 0!==t.restrictionsHash){var n=c()("#rte-button-restrictions");if(n.data("restrictionsHash")!==t.restrictionsHash)if(c()("#update-page-restrictions-dialog").is(":visible")&&r.a.PagePermissions.updateRestrictionsDialog)r.a.PagePermissions.updateRestrictionsDialog(),n.data("restrictionsHash",t.restrictionsHash);else{var o=""!==t.restrictionsHash,a=t.hasViewRestrictions,i=!!n.data("inherited-restrictions");_a(a,i,o,t.restrictionsHash)}}},Qa=()=>{Object(y.a)("editor-heartbeat",Wa);Object(y.a)("edit-page-restrictions-updated",(e,t)=>{_a(t.hasExplicitRestrictions,t.hasInheritedRestrictions,t.hasAnyExplicitRestrictions,t.restrictionsHash)})},Va=n(26),$a=n.n(Va),Ka=n(13),Ga=n(17),Ya=n(12),Ja=()=>{var e,t,n=()=>g.a.get("new-page"),o={spinner:c()("#rte-spinner"),saveButton:(e="#rte-button-publish",t=Object(Ya.saveButton)({contentType:g.a.get("content-type"),sharedDraftsEnabled:g.a.getBoolean("shared-drafts"),isNewPage:n()}),c()(e).replaceWith(t),c()(e)),overwriteButton:c()("#rte-button-overwrite"),editButton:c()("#rte-button-edit"),previewButton:c()("#rte-button-preview"),cancelButton:c()("#rte-button-cancel"),versionCommentInput:c()("#versionComment"),watchPageCheckbox:c()("#watchPage"),watchPageToolbarGroup:c()(".toolbar-group-watch-page")};o.buttons=[o.saveButton,o.overwriteButton,o.editButton,o.previewButton,o.cancelButton];var a=!1,i=(e,t)=>{if(t=t||o.buttons)for(var n=0;n<t.length;n++)l(e,t[n])},l=(e,t)=>{t&&(e?(t.removeAttr("aria-disabled"),t.removeClass("disabled"),t.is("button")&&t.removeAttr("disabled")):(t.attr("aria-disabled","true"),t.addClass("disabled"),t.is("button")&&t.attr("disabled","disabled")))},d=e=>e.length&&"true"!==e.attr("aria-disabled"),u=()=>n()?"":Object(Lt.a)("edit.name")+" - ";return Object(y.a)("editor-shared-drafts-published",()=>{var e,t=null===(e=/\(.+\)/g.exec(o.saveButton.data("tooltip")))||void 0===e?void 0:e[0];o.saveButton.text(Object(Ya.saveButtonText)({contentType:g.a.get("content-type"),sharedDraftsEnabled:g.a.getBoolean("shared-drafts"),isNewPage:n()})).attr("title",Object(Ya.saveButtonTitle)({contentType:g.a.get("content-type"),sharedDraftsEnabled:g.a.getBoolean("shared-drafts"),isNewPage:n()})+t).tooltip({gravity:"s"})}),Object(y.a)("synchrony.history.evicted",()=>{a=!0,l(!1,o.versionCommentInput),(()=>{try{r.a.Rte.getEditor().plugins.customtoolbar.disableToolbar(!0),r.a.Rte.getEditor().plugins.customtoolbar.toggleToolbarButtons(!0,!0,!0)}catch(e){}try{r.a.Rte.getEditor().setMode("readonly")}catch(e){}try{r.a.Rte.getEditor().plugins.pagelayoutplugin.disableContent()}catch(e){}try{c()("input#content-title").attr("disabled","true")}catch(e){}})()}),o.setButtonsState=i,o.setButtonState=l,o.isButtonEnabled=d,o.registerFormButton=(e,t)=>{var n;o[e]=t,null===(n=o.buttons)||void 0===n||n.push(t)},o.postingDatePicker=null,o.isFormEnabled=()=>{if(o.buttons)for(var e=0;e<o.buttons.length;e++){var t;if(d(null===(t=o.buttons)||void 0===t?void 0:t[e]))return!0}return!1},o.toggleSavebarBusy=e=>{if(!0!==a)if(e){var t;if(null==o||null===(t=o.isFormEnabled)||void 0===t||!t.call(o))return!1;o.spinner.addClass("aui-icon-wait"),i(!1)}else o.spinner.removeClass("aui-icon-wait"),i(!0);return!0},o.init=function(){Ga.a.init(),s.Confluence.Editor.addSaveHandler(e=>{var t,n;null!=o&&null!==(t=o.isButtonEnabled)&&void 0!==t&&t.call(o,o.saveButton)?(null==o||null===(n=o.toggleSavebarBusy)||void 0===n||n.call(o,!0),Object(y.b)("confluence.editor.on.save")):(e.stopImmediatePropagation(),e.preventDefault())}),Object(y.b)("rte.init.ui"),s.Confluence.Editor.isNewPage()&&c()("#content-title").focus().select(),s.Confluence.Editor.addCancelHandler(e=>{var t,n;(s.Confluence.Editor.getNumConcurrentEditors()>1&&r.a.Confluence.Analytics.publish("rte.notification.concurrent-editing.cancel",{numEditors:s.Confluence.Editor.getNumConcurrentEditors(),pageId:r.a.params.pageId,draftType:r.a.params.draftType}),g.a.getBoolean("shared-drafts")&&["page","blogpost"].includes(g.a.get("content-type")))&&(null!=o&&null!==(t=o.isButtonEnabled)&&void 0!==t&&t.call(o,o.cancelButton)?null==o||null===(n=o.toggleSavebarBusy)||void 0===n||n.call(o,!0):(e.stopImmediatePropagation(),e.preventDefault()));Ga.a.process(e)}),"comment"===g.a.get("content-type")&&s.Confluence.Editor.addSaveHandler(()=>{var e;if(r.a.Rte.Content.isEmpty())return Object(Ka.notify)("warning",Object(Lt.a)("content.empty")),null==o||null===(e=o.toggleSavebarBusy)||void 0===e||e.call(o,!1),!1}),["comment","template"].includes(g.a.get("content-type"))&&s.Confluence.Editor.addCancelHandler(e=>{var t;if(null!=o&&null!==(t=o.isFormEnabled)&&void 0!==t&&t.call(o)&&s.Confluence.Editor.hasContentChanged()&&!s.Confluence.Editor.isEmpty()){var n="comment"===g.a.get("content-type")?Object(Lt.a)("unsaved.comment.lost"):Object(Lt.a)("unsaved.template.lost");if(!window.confirm(n))return e.stopImmediatePropagation(),!1}}),o.versionCommentInput.on("keypress",e=>{"Enter"===e.key&&Ga.a.process(e)}),s.Confluence.Editor.addSaveHandler(()=>{s.Confluence.Editor.getNumConcurrentEditors()>1&&r.a.Confluence.Analytics.publish("rte.notification.concurrent-editing.save",{numEditors:s.Confluence.Editor.getNumConcurrentEditors(),pageId:r.a.params.pageId,draftType:r.a.params.draftType})}),s.Confluence.Editor.addSubmitHandler(e=>s.Confluence.Editor.contentFormSubmit(e)),s.Confluence.Editor.currentEditMode=s.Confluence.Editor.MODE_RICHTEXT,o.editButton.click(e=>{var t;null!=o&&null!==(t=o.isFormEnabled)&&void 0!==t&&t.call(o)&&(Fr(s.Confluence.Editor.MODE_RICHTEXT),setTimeout(()=>{r.a.Rte.getEditor().focus(),s.tinymce.isGecko&&s.Confluence.Editor.bookmark&&r.a.Rte.getEditor().selection.moveToBookmark(s.Confluence.Editor.bookmark)},0),a||$a.a.enableElement(o.cancelButton)),e.preventDefault()});var e=()=>{c()("#rte-ellipsis-menu").is(":visible")&&c()("#rte-button-ellipsis").trigger("aui-button-invoke")};o.previewButton.click(t=>{var n;t.preventDefault(),a||null!=o&&null!==(n=o.isFormEnabled)&&void 0!==n&&n.call(o)&&s.Confluence.Editor.currentEditMode!==s.Confluence.Editor.MODE_PREVIEW&&(e(),i(!1),o.spinner.addClass("aui-icon-wait"),s.tinymce.isGecko&&!s.Confluence.Editor.bookmark&&(s.Confluence.Editor.bookmark=s.tinymce.activeEditor.selection.getBookmark()),Fr(s.Confluence.Editor.MODE_PREVIEW,{errorCallback:()=>{i(!0),o.spinner.removeClass("aui-icon-wait")}}),["comment","template"].includes(g.a.get("content-type"))?$a.a.disableElement(o.cancelButton):$a.a.enableElement(o.cancelButton))}),c()("#rte-button-labels").bind("updateLabel",()=>{var e=+g.a.get("num-labels")||0,t=Object(Lt.a)("editor.labels.zero");1===e?t=Object(Lt.a)("editor.labels.singular",e):e>1&&(t=Object(Lt.a)("editor.labels.plural",e)),c()("#rte-button-labels").attr("data-tooltip",t)}),c()("#draft-status-lozenge").length&&c()("#draft-status-lozenge").tooltip();var t=c()("#PostingDate");if(t.length){var n,d,f=new Date;t.attr("max",`${f.getFullYear()}-${(f.getMonth()+1).toString().padStart(2,"0")}-${f.getDate().toString().padStart(2,"0")}`),o.postingDatePicker=t.datePicker({overrideBrowserDefault:!0}),null==o||null===(n=o.postingDatePicker)||void 0===n||null===(d=n.hide)||void 0===d||d.call(n)}c()("#wysiwygTextarea_parent .mceProgress, #wysiwygTextarea_parent .mceBlocker").on("click",()=>{r.a.Rte.getEditor().focus()}),c()(window).bind("render-content-loaded",(e,t)=>{var n,r=c()("#previewArea iframe");r.contents().find("body")[0]==t&&(s.Confluence.Editor.previewFrameOnload(t,r),n=!0,[o.saveButton,o.overwriteButton,o.editButton,o.previewButton].forEach(e=>{l(n,e)}),r.focus(),window.focus(),c()(document).trigger("iframeAppended",r))}),g.a.get("heartbeat")&&(s.Confluence.Editor.heartbeat(),s.Confluence.Editor.heartbeatType.normal(),Object(y.a)("rte-destroyed",s.Confluence.Editor.heartbeatType.cleanup)),Object(y.a)("watchpage.pageoperation",()=>{var e;null==o||null===(e=o.toggleWatchPage)||void 0===e||e.call(o,!1)}),Object(y.a)("unwatchpage.pageoperation",()=>{var e;null==o||null===(e=o.toggleWatchPage)||void 0===e||e.call(o,!0)}),g.a.get("new-page")&&"inlinecommentform"===g.a.get("form-name")&&(document.title=Object(Lt.a)("edit.name")+document.title);var m=document.title;g.a.get("new-page")&&c.a.trim(c()("input#content-title").val())&&(document.title=u()+c()("input#content-title").val()+" - "+g.a.get("space-name")+" - "+g.a.get("site-title")),c()("input#content-title").on("change input",(function(){if("template"!==g.a.get("content-type")){var e=u();this.value.trim()?document.title=e+this.value+" - "+g.a.get("space-name")+" - "+g.a.get("site-title"):document.title=m}})),c()("body",c()("#wysiwygTextarea_ifr").contents()).click(e),Object(y.b)("init.rte-control")},o.toggleWatchPage=e=>{e&&"comment"===g.a.get("content-type")?(o.watchPageToolbarGroup.show(),o.watchPageCheckbox.length&&(o.watchPageCheckbox[0].checked=!1)):o.watchPageToolbarGroup.hide()},o},qa=()=>{var e,t;if(null!==s.Confluence&&void 0!==s.Confluence&&null!==(e=s.Confluence.Editor)&&void 0!==e&&null!==(t=e.ImageDialog)&&void 0!==t&&t.panelComponent){var n=s.Confluence.Editor.FileDialog||{},o=n.eventListener,r=n.ExternalPanelView,a=n.SearchPanelView,i=n.AttachmentsPanelView,l=(s.Confluence.Editor.ImageDialog||{}).panelComponent;if("template"!==g.a.get("content-type")){var c=new i({eventListener:o});l.push(c)}l.push(new r),l.push(new a)}},Za=(n(69),n(72),()=>{Object(y.a)("rte-ready",()=>{var e,t;null===Na.a||void 0===Na.a||null===(e=Na.a.unuse)||void 0===e||e.call(Na.a),null===Na.a||void 0===Na.a||null===(t=Na.a.use)||void 0===t||t.call(Na.a)}),Object(y.a)("rte-ready",()=>{g.a.getBoolean("collaborative-content")||c()('meta[name="ajs-collaborative-editor-status"]').attr("content","off"),s.Confluence.Editor.UI.saveButton.bind("click",kr),Wr()}),Object(y.a)("editor.error.message",(e,t)=>{xr(t)}),Object(y.a)("dismiss.editor.error.message",(e,t)=>{fr.a.closeMessages([t.messageKey]),t.enablePublish&&Ar(!0)}),s.Confluence.Editor=c.a.extend(s.Confluence.Editor||{},Qr,r.a.Editor),r.a.toInit(e=>{e(s.document).ajaxError((e,t)=>{if(405===t.status)try{var n=JSON.parse(t.responseText).reason;void 0!==n&&"READ_ONLY"===n&&(r.a.log("*** READ_ONLY mode detected ***"),Object(y.b)("rte.heartbeat-error",null,t))}catch(e){r.a.logError("Cannot parse xhr.responseText: "+e)}}),Object(y.a)("init.rte",s.Confluence.Editor.onInit)}),r.a.Editor=s.Confluence.Editor,Object(y.a)("init.rte",()=>{var e,t=Ja();s.Confluence.Editor.UI=t,null==t||null===(e=t.init)||void 0===e||e.call(t)}),c.a.fn.sizeToFit=Ua.sizeToFit,s.Confluence.Editor.ImageDialog=Ua,s.Confluence.Editor.defaultInsertImageDialog=Ua.defaultInsertImageDialog,s.Confluence.Editor.insertImageDialog=Ua.insertImageDialog,Object(y.a)("init.rte",qa),r.a.PagePermissions=r.a.PagePermissions||{},c.a.extend(r.a.PagePermissions,{updateEditPageRestrictions:_a}),r.a.toInit(Qa)}),Xa=n(30),ei=n.n(Xa),ti=e=>{var t=e.type;return`<div class="cell ${t}" data-type="${t}"><div class="innerCell"></div></div>`},ni=()=>`<div class="contentLayout2"><div class="columnLayout single" data-layout="single">${ti({type:"normal"})}</div></div>`,oi={name:"pagelayout-none",columns:0},ri=e=>{var t=c()(e.getBody()),n=(e,t)=>{t.attr("contenteditable","false");c()(".innerCell",e).each((function(){var e=c()(this);e.attr("contenteditable","true"),e.children().length||e.append("<p><br /></p>")}))},o=e=>{for(var t=c()(".cell, .header, .footer",e),n=0;n<t.length;n++){var o=c()(t[n]),r=o.html();c()(".innerCell",o).length||(o.removeAttr("contenteditable"),o.html('<div class="innerCell">'+r+"</div>"))}},r=()=>{var r=c()(".contentLayout",t);r.length?(o(r),n(r,t),e.undoManager.add()):t.attr("contenteditable","true")};r();var a=e=>{var t=(e.jquery?e:c()(e)).attr("data-atlassian-layout");return t?JSON.parse(t):oi},i=e=>!(e.header||e.footer||e.columns),l=e=>{var t=e.jquery?e:c()(e);if(t.length)for(var n=t[0].childNodes,o=0;o<n.length;o++){var r=n[o];if("P"!==r.nodeName||1!==r.childNodes.length||"BR"!==r.firstChild.nodeName)return t.html()}return""},s=e=>{c()(".header",e).length||e.prepend('<div class="header"><div class="innerCell"></div></div>')},d=e=>{var t=c()(".header",e),n=f(e),o=l(c()(".innerCell",t));n.length?(n.prepend(o),t.remove()):t.replaceWith(o)},u=e=>{c()(".footer",e).length||e.append('<div class="footer"><div class="innerCell"></div></div>')},g=e=>{var t=c()(".footer",e),n=m(e),o=l(c()(".innerCell",t));n.length?(n.append(o),t.remove()):t.replaceWith(o)},f=e=>c()(".columnLayout > .cell:first-child .innerCell",e),m=e=>c()(".columnLayout > .cell:last-child .innerCell",e),p=e=>c()(".columnLayout",e).append('<div class="cell"><div class="innerCell"></div></div>'),h=e=>{var t="";c()(".columnLayout > .cell",e).each((function(){t+=l(c()(".innerCell",this))})),c()(".columnLayout",e).replaceWith(t)},b=(e,t)=>{var n=l(e);t.append(n),e.parent().remove()},v=(e,t)=>{var n,o=(e=>c()(".columnLayout > .cell",e).length)(t),r=e.name,a=e.columns;if(0===o)for(n=t.html(),t.html('<div class="columnLayout"></div>');o!==a.length;)p(t),o++;var i=r.substring(r.indexOf("-")+1);if(i=i.substring(0,Math.max(0,i.indexOf("-"))||void 0),c()(".columnLayout",t).attr("class","columnLayout "+i+"Columns"),a)for(c()(".columnLayout > .cell",t).each((function(e,t){void 0!==a[e]&&c()(t).attr("class","cell "+a[e])}));o!==a.length;)o<a.length?(p(t),o++):(b(c()(".columnLayout .cell:nth-child("+o+") .innerCell",t),c()(".columnLayout > .cell:nth-child("+(o-1)+") .innerCell",t)),o--);else h(t);n&&f(t).html(n)},w=(e,t)=>{e.empty().append(t)},C=(e,t)=>x('<div class="contentLayout"></div>',e).html(t.html()),A=e=>{var t=e.selection,n=t.getRng(),o=c()('[contenteditable="true"]',e.getBody());if(o.length){e.focus(),o[0].focus();var r=o.children()[0];n.setStart(r,0),n.setEnd(r,0),t.setRng(n)}else e.focus()},x=(e,t)=>{var n=t.dom.create("div");return n.innerHTML=e,c()(n).children()};return{setup:r,getLayout:()=>{var e=c()(".contentLayout",t);return e.length&&e.attr("data-atlassian-layout")?JSON.parse(e.attr("data-atlassian-layout")):oi},body:t,needsContentEditableBody:i,getLayoutOptions:a,setLayout:r=>{var l,f=c()(".contentLayout",t);a(f).name!==r.name&&(Object(y.b)("analyticsEvent",{name:"PageLayoutEvent.pageLayoutChanged",data:{name:r.name}}),l=1===f.length?f.clone():C(e,t),o(l),v(r,l),r.header?s(l):d(l),r.footer?u(l):g(l),i(r)?(l=l.contents().unwrap(),t.attr("contenteditable","true"),f=""):(n(l,t),l.attr("data-atlassian-layout",JSON.stringify(r)),f=l),w(t,l),A(e))},DEFAULT_LAYOUT:oi}};!function(e){e.normal="normal",e.aside="aside",e.sidebars="sidebars"}(Oa||(Oa={}));var ai=[{id:"single",icon:"1col",name:Object(Lt.a)("page-layout-2.layout.single"),cells:[{type:Oa.normal}]},{id:"two-equal",icon:"2col",name:Object(Lt.a)("page-layout-2.layout.two-equal"),cells:[{type:Oa.normal},{type:Oa.normal}]},{id:"two-left-sidebar",icon:"2col-right",name:Object(Lt.a)("page-layout-2.layout.two-left-sidebar"),cells:[{type:Oa.aside},{type:Oa.normal}]},{id:"two-right-sidebar",icon:"2col-left",name:Object(Lt.a)("page-layout-2.layout.two-right-sidebar"),cells:[{type:Oa.normal},{type:Oa.aside}]},{id:"three-equal",icon:"3col",name:Object(Lt.a)("page-layout-2.layout.three-equal"),cells:[{type:Oa.normal},{type:Oa.normal},{type:Oa.normal}]},{id:"three-with-sidebars",icon:"3col-center",name:Object(Lt.a)("page-layout-2.layout.three-with-sidebars"),cells:[{type:Oa.sidebars},{type:Oa.normal},{type:Oa.sidebars}]}],ii=e=>ai.find(t=>t.id===e),li="editor.page-layout.",ci=e=>{var t=c()(e.getBody()),n=(e,t)=>{t.attr("contenteditable","false");c()(".innerCell",e).each((function(){var e=c()(this);e.attr("contenteditable","true"),e.children().length||e.append("<p><br /></p>")}))},o=e=>{e.find("> p").each((function(){""===this.id.trim()&&0===this.classList.length&&c()(this).remove()}))},a=e=>{e.find(".contentLayout2 .cell").filter((function(){return c()(this).find(".innerCell").length>1})).each((function(e,t){for(var n=c()(t).find(".innerCell"),o=n[0],r=1;r<n.length;r++){var a=c()(n[r]);c()(o).append(a.children()),a.remove()}}))},i=()=>{var r=t.find(".contentLayout2");r.length?(n(r,t),o(t),a(t),e.undoManager.add()):t.attr("contenteditable","true")};i();var l=(e,t,o)=>{var r=e.find(".cell"),a=r.length,i=c()(),l=t.cells.length,s=[],d=[];e.attr("class","columnLayout"),e.addClass(t.id),e.attr("data-layout",t.id);for(var g=0;g<a;g++){var f=r.eq(g).detach();s.push(u(f.children(".innerCell")))}for(var m=0;m<l;m++)i=i.add(ti({type:t.cells[m].type||""}));if(a<=l)d=s;else{d=s.slice(0,l);for(var p=l;p<a;p++)d[l-1]+=s[p]}e.prepend(i);for(var h=0;h<l;h++)i.eq(h).find(".innerCell").html(d[h]);n(e,o)},s=()=>{if(!d()){var o=c()(ni()),r=o.find(".innerCell"),a=t.children().detach();r.append(a),t.append(o),n(o,t),f(e)}},d=()=>!!c()(r.a.Rte.getEditor().getBody()).find("div.contentLayout2").length,u=e=>{var t=c()(e);if(t.length)for(var n=t[0].childNodes,o=0;o<n.length;o++){var r=n[o];if("P"!==r.nodeName||1!==r.childNodes.length||!r.firstChild||"BR"!==r.firstChild.nodeName)return t.html()}return""},g=(e,t,n)=>{var o=c()(t.selection.getRng().startContainer).closest(".columnLayout");return!o.length&&n&&(o=e.find(".columnLayout").last()),o},f=e=>{var t=e.selection,n=t.getRng(),o=c()('[contenteditable="true"]',e.getBody());if(o.length){e.focus(),o[0].focus();var r=o.children()[0];n.setStart(r,0),n.setEnd(r,0),t.setRng(n)}else e.focus()},m=(e,t)=>{var n=e.selection,o=n.getRng(),a=t.find('[contenteditable="true"]').first(),i=a.children();if(i.length){e.focus(),a[0].focus();var l=i[0];o.setStart(l,0),o.setEnd(l,0),n.setRng(o),r.a.Rte.showElement(l)}else e.focus()};return{setup:i,body:t,editor:e,Layouts:ai,getLayout:ii,needsContentEditableBody:()=>!d(),findNearestLayoutSection:e=>{var t=r.a.Rte.getEditor(),n=c()(t.getBody());return g(n,t,e)},createInitialLayoutIfNone:s,addSection:n=>{var o=c()(`<div class="columnLayout single" data-layout="single">${ti({type:"normal"})}</div>`),r=n||g(t,e,!0);if(r.length){var a=ii(r.attr("data-layout"));e.undoManager.ignore(()=>{l(o,a,t),r.after(o)}),m(e,o),Object(y.b)(li+"add-section",{section:o})}else s()},removeSection:n=>{if(d()){var o,r,a=n||g(t,e,!0),i=a.next(),l=a.prev();if(i.length)o=i,a.remove();else if(l.length)o=l,a.remove();else{a.closest(".contentLayout2").remove();var s=t.find(".contentLayout2").find(".columnLayout").first();s.length?o=s:(e.getBody().setAttribute("contenteditable","true"),e.setContent("<p></p>"),f(e),(r=c()("#rte-button-pagelayout-2")).hasClass("active")&&r.click())}o&&o.length&&m(e,o),Object(y.b)(li+"remove-section",{})}},changeSection:(n,o)=>{d()||s();var r=o||g(t,e,!1);if(r.length){var a=ii(r.attr("data-layout"));e.undoManager.ignore(()=>{l(r,n,t)}),m(e,r),Object(y.b)(li+"change-layout",{section:r,originalLayout:a,currentLayout:n})}},moveSectionDown:n=>{if(d()){var o=n||g(t,e,!0),r=o.next();r.length&&(o.detach(),r.after(o),m(e,o)),Object(y.b)(li+"move-section-down",{section:o})}},moveSectionUp:n=>{if(d()){var o=n||g(t,e,!0),r=o.prev();r.length&&(o.detach(),r.before(o),m(e,o)),Object(y.b)(li+"move-section-up",{section:o})}}}};function si(e){var t,n=ri(e),o=ci(e);if("comment"!==g.a.get("content-type")){var a=e=>{var t=c()("#pagelayout-menu"),n=c()(".icon-check",t),o=n.not(".hidden"),r=n.siblings("."+e.name).siblings();o.addClass("hidden"),r.removeClass("hidden")},i=e=>{var t=c()(e.getBody());return!t.children(".contentLayout").length&&(t.children(".contentLayout2").length,!0)},l=()=>{s.tinymce.isGecko&&setTimeout(()=>{e.focus(),e.dom.getRoot().focus()},1)},d=r=>{var s=c()("#pagelayout-menu").parent(),d=c()("#page-layout-2-group");r&&r.selection||(i(e)?(s.addClass("hidden"),d.removeClass("hidden"),t=ci(e),o&&o.needsContentEditableBody()&&c()(e.getBody()).attr("contenteditable","true")):(s.removeClass("hidden"),d.addClass("hidden"),t=ri(e),n.needsContentEditableBody(t.getLayout())?t.body.attr("contenteditable","true"):l(),a(t.getLayout())))};return e.on("init",()=>{e.undoManager.clear(),e.undoManager.add(),d(),Object(y.a)("editor.remote.change editor.local.change",()=>{e.undoManager.ignore(()=>{t.setup()})}),Object(y.a)("rte-ready",()=>{var t=c()('[contenteditable="true"]',e.getBody()),n=!1!==g.a.get("editor-auto-focus");t.attr("contenteditable","false"),t.attr("contenteditable","true"),n&&r.a.Rte.editorFocus(e)}),i(e)&&e.on("Undo",()=>{o.needsContentEditableBody()&&t.body.attr("contenteditable","true"),l()}),ei.a.use()}),c()("#pagelayout-menu").delegate("li.dropdown-item a","click",(function(){e.execCommand("mcePageLayout",!1,n.getLayoutOptions(this))})),e.on("Remove",()=>{ei.a.unuse()}),e.on("SetContent",d),e.on("click",t=>{var n=c()(t.target);if((n.is("div.cell")&&n.children(".innerCell").focus(),s.tinymce.isWebKit&&(t.target===e.getBody()||t.target===e.getBody().parentNode))&&n.find(".innerCell").length){e.execCommand("selectAll");var o=t.target!==e.getBody();e.selection.collapse(o)}}),e.on("keyup",t=>{var n=t.keyCode;if(8!==n&&46!==n)return!0;var o=e.selection.getRng().startContainer;if(c()(o).closest(".contentLayout,.contentLayout2",e.getBody()).length){var r=c()(o).closest(".innerCell");if(r&&r.length&&e.dom.isEmpty(r.clone()[0])){r.html('<p><br data-mce-bogus="1"></p>'),t.preventDefault();var a=r[0].firstElementChild&&r[0].firstElementChild.firstChild;a&&e.selection.select(a,!0),e.selection.collapse(!0)}}}),e.addCommand("mcePageLayoutInitialize",()=>{e.undoManager.add(),t.createInitialLayoutIfNone()}),e.addCommand("mcePageLayout",(n,o)=>{e.undoManager.add(),t.setLayout(o),a(t.getLayout())}),e.addCommand("mcePageLayoutAddSection",(n,o)=>{e.undoManager.add(),t.addSection&&t.addSection(o&&o.section)}),e.addCommand("mcePageLayoutChangeSection",(n,o)=>{e.undoManager.add(),t.changeSection&&t.changeSection(o&&o.layout,o&&o.section)}),e.addCommand("mcePageLayoutRemoveSection",(n,o)=>{e.undoManager.add(),t.removeSection&&t.removeSection(o&&o.section)}),e.addCommand("mcePageLayoutMoveSectionUp",(n,o)=>{e.undoManager.add(),t.moveSectionUp&&t.moveSectionUp(o&&o.section)}),e.addCommand("mcePageLayoutMoveSectionDown",(n,o)=>{e.undoManager.add(),t.moveSectionDown&&t.moveSectionDown(o&&o.section)}),{Layouts:o&&o.Layouts,getLayout:o&&o.getLayout,execCommand:t=>{if("selectAll"===t){var n=e.getBody();if("true"==e.dom.getAttrib(n,"contenteditable"))return!1;var o=e.dom.select(".innerCell",n),r=o[0],a=o[o.length-1],i=e.dom.createRng();return i.setStart(r,0),i.setEnd(a,a.childNodes.length),e.selection.setRng(i),!0}return!1},disableContent:()=>{e.dom.setAttribs(e.dom.select("div.innerCell"),{contenteditable:!1}),e.dom.setStyle(e.dom.select(".wiki-content .contentLayout2"),"user-select","auto")},getInfo:()=>({longname:"Page Layout Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"})}}}var di=()=>{"comment"!==g.a.get("content-type")&&Ee(document,"initContextToolbars.Toolbar",()=>{return s.Confluence.Editor.PageLayoutToolbar=(e=s.tinymce.activeEditor,t=ci(e),n=e=>{var n=(e=e||t.findNearestLayoutSection()).attr("data-layout"),o=c()("#rte-toolbar-row-pl2-toolbar").find(".layouts button"),r=o.find(".pl2-layout-"+n).closest(".aui-button");r.hasClass("active")||(o.filter(".active").removeClass("active"),r.addClass("active"))},{initContextToolbars:()=>{var o=c()(document),r=c()("#page-layout-2"),a=c()("#rte-button-pagelayout-2");e.addCommand("mcePageLayoutsToolbar",()=>{a.hasClass("active")?o.trigger("removeContextToolbarRow.Toolbar",{id:"pl2-toolbar",animate:!0}):(o.trigger("createContextToolbarRow.Toolbar",{id:"pl2-toolbar",buttons:s.Confluence.Editor.PageLayoutToolbar.Buttons,topToolbar:!0,animate:!0}),n(),e.execCommand("mcePageLayoutInitialize")),a.toggleClass("active")}),a.click(t=>{t.preventDefault(),r.hasClass("disabled")||e.execCommand("mcePageLayoutsToolbar",!1,null)}),e.on("NodeChange",e=>{var t=c()(e.element).closest(".columnLayout");n(t)});for(var i=t.Layouts,l=[],d=t=>{l.push(new s.Confluence.Editor.Toolbar.Components.Button({text:t.name,iconClass:"aui-icon aui-icon-small aui-iconfont-layout-"+t.icon+"-large",click:()=>{e.execCommand("mcePageLayoutChangeSection",!1,{layout:t})}}))},u=0;u<i.length;u++)d(i[u]);return{Buttons:[new s.Confluence.Editor.Toolbar.Components.Group([new s.Confluence.Editor.Toolbar.Components.Button({triggerText:Object(Lt.a)("page-layout-2.add-section"),id:"add-layout-section",tooltip:Object(Lt.a)("page-layout-2.add-section.tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-add",click:()=>e.execCommand("mcePageLayoutAddSection")}),new s.Confluence.Editor.Toolbar.Components.Button({triggerText:Object(Lt.a)("page-layout-2.remove-section"),id:"remove-layout-section",tooltip:Object(Lt.a)("page-layout-2.remove-section.tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-delete",click:()=>e.execCommand("mcePageLayoutRemoveSection")})]),new s.Confluence.Editor.Toolbar.Components.Group([new s.Confluence.Editor.Toolbar.Components.Button({triggerText:Object(Lt.a)("page-layout-2.move-section-up"),id:"move-up-layout-section",tooltip:Object(Lt.a)("page-layout-2.move-section-up.tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-up",click:()=>e.execCommand("mcePageLayoutMoveSectionUp")}),new s.Confluence.Editor.Toolbar.Components.Button({triggerText:Object(Lt.a)("page-layout-2.move-section-down"),id:"move-down-layout-section",tooltip:Object(Lt.a)("page-layout-2.move-section-down.tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-down",click:()=>e.execCommand("mcePageLayoutMoveSectionDown")})]),new s.Confluence.Editor.Toolbar.Components.Group(l,{id:"pagelayout2-toolbar",text:Object(Lt.a)("page-layout-2.layout.group"),groupClass:"layouts"}),new s.Confluence.Editor.Toolbar.Components.Group([new s.Confluence.Editor.Toolbar.Components.Button({text:Object(Lt.a)("page-layout-2.close"),iconClass:"aui-icon aui-icon-small aui-iconfont-close-dialog",click:()=>e.execCommand("mcePageLayoutsToolbar",!1,null)})],{groupClass:"close"})],Events:[]}}}).initContextToolbars();var e,t,n})};n(75);function ui(e){for(var t=e.offsetTop;e.offsetParent;)t+=(e=e.offsetParent).offsetTop;return t}function gi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fi=new class{constructor(e,t){gi(this,"_namespace",void 0),gi(this,"_sessionStorageSupported",void 0);var n=g.a.get("remote-user")||"";this._namespace=`${e}.${n}.${t}`,this._sessionStorageSupported=!!s.sessionStorage}getItem(e){return this._sessionStorageSupported?s.sessionStorage.getItem(`${this._namespace}.${e}`):null}doesContain(e){return!!this.getItem(e)}setItem(e,t){if(this._sessionStorageSupported)try{s.sessionStorage.setItem(`${this._namespace}.${e}`,t)}catch(n){console.error(`Unable to write to sessionStorage. key: ${e}, value: ${t}, cause: ${n}`)}}removeItem(e){this._sessionStorageSupported&&s.sessionStorage.removeItem(`${this._namespace}.${e}`)}}("atlassian","frontend"),mi=e=>{var t=[];return Array.from(e).forEach((e,n)=>{(function(e,t){var n=t?t.documentElement:s.document.documentElement;if(e&&n){var o=e.getBoundingClientRect(),r=o.top,a=o.bottom,i=n.offsetHeight;return 0<=r&&r<i||0<=a&&a<=i||r<=0&&0<=a&&a>=i}})(e)&&t.push({targetElementIndex:n,visibleBlockEl:e})}),t},pi=e=>{var t=mi(e),n=null;return t.some(e=>!!function(e,t){var n=t?t.documentElement:s.document.documentElement;if(e&&n){var o=e.getBoundingClientRect().top,r=n.offsetHeight;return 0<=o&&o<r}}(e.visibleBlockEl)&&(n=e,!0)),!n&&t.length>0?t[0]:n||{targetElementIndex:-1,visibleBlockEl:null}};function hi(e,t){if(!e||0===t)return null;var n={targetElementIndex:-1,offsetBetweenTargetAndCurrentScroll:0,columnLayoutPosition:{columnIndex:-1,rowIndex:-1}};if((e=>{if(!e)return!1;var t=e.children[0];return t&&t.classList.contains("contentLayout2")})(e)){var o=e.children[0].children,r=pi(o),a=r.targetElementIndex,i=r.visibleBlockEl;if(i){var l=(e=>{var t={targetElementIndexInColumn:-1,columnIndex:-1,visibleBlockEl:null};return Array.from(e).some((e,n)=>{var o=pi(e.children),r=o.visibleBlockEl,a=o.targetElementIndex;return!!r&&(t.columnIndex=n,t.targetElementIndexInColumn=a,t.visibleBlockEl=r,!0)}),t})(i.getElementsByClassName("innerCell")),c=l.columnIndex,s=l.targetElementIndexInColumn,d=l.visibleBlockEl;d&&(n.targetElementIndex=s,n.offsetBetweenTargetAndCurrentScroll=t-ui(d),n.columnLayoutPosition={rowIndex:a,columnIndex:c})}}else{var u=pi(e.children),g=u.targetElementIndex,f=u.visibleBlockEl;f&&(n.targetElementIndex=g,n.offsetBetweenTargetAndCurrentScroll=t-ui(f),delete n.columnLayoutPosition)}return-1!==n.targetElementIndex?n:null}var bi={_saveScrollPosition(e){var t,n,o,r,a,i,l,c;e.getDoc()&&e.getWin()&&(t={contentId:Ut(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()},n=t.contentId,o=t.isInViewPage,r=t.docObject,a=void 0===r?s.document:r,i=t.winObject,l=void 0===i?d.a:i,(c=hi(o?a.getElementById("main-content"):a.body,l.pageYOffset))&&(c.contentId=n,c.isInViewPage=o,fi.setItem("editor-persit-scroll-position",JSON.stringify(c))))},_restoreScrollPositionIfNeeded(e){e.getDoc()&&e.getWin()&&(e=>{var t=e.contentId,n=e.isInViewPage,o=e.docObject,r=void 0===o?s.document:o,a=e.winObject,i=void 0===a?d.a:a,l=fi.getItem("editor-persit-scroll-position");try{l=JSON.parse(l)}catch(e){0}finally{fi.removeItem("editor-persit-scroll-position")}if(l&&l.contentId===t&&l.isInViewPage!==n){var c;c=n?r.getElementById("main-content"):r.body;var u,g=l.columnLayoutPosition;if(g){var f=c.children[0].children[g.rowIndex].getElementsByClassName("innerCell")[g.columnIndex];u=f&&f.children[l.targetElementIndex]}else u=c.children[l.targetElementIndex];if(u){var m=ui(u)+l.offsetBetweenTargetAndCurrentScroll;setTimeout(()=>i.scrollTo(0,m),1)}}})({contentId:Ut(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()})},init:e=>{var t=g.a.get("content-type");"page"!==t&&"blogpost"!==t||(Object(y.a)("rte-collab-ready",()=>{bi._restoreScrollPositionIfNeeded(e)}),Object(y.a)("rte-ready",()=>{s.Confluence.Editor.UI.cancelButton.click(()=>bi._saveScrollPosition(e)),s.Confluence.Editor.UI.saveButton.click(()=>bi._saveScrollPosition(e))}))},getInfo:()=>({longname:"Persist scroll position for transition between view page and edit page",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})};var vi,yi,wi=[],Ci={};function Ai(e){var t=`<span class="text-placeholder">${vi}</span>`,n=c()("<div></div>").append(t);e&&n.find(".text-placeholder").html(e),s.tinymce.activeEditor.execCommand("mceInsertContent",!1,n.html())}function xi(e){var t=s.tinymce.activeEditor,n=c()(t.getBody()),o=vi,r=e&&e.parentElement;r&&"LI"===r.nodeName&&(o=yi);var a=t.dom.create("span",{id:"placeholder-cursor"},"&nbsp;");r&&e&&r.replaceChild(a,e);var i=n.find("#placeholder-cursor")[0];t.selection.select(i.firstChild),t.dom.remove(i,!1),t.execCommand("mceInsertContent",!1,o)}function Mi(){return wi}function ki(e){return Ci[e]}yi=vi=s.tinymce.Env.webKit?"\ufeff{$caret}<br>":"\ufeff{$caret}";var Ei={insertTextPlaceHolder:Ai,removePlaceholder:xi,addPlaceholderType:function(e){e&&e.type&&(wi.push(e),Ci[e.type]=e)},getPlaceholderTypes:Mi,getPlaceholderType:ki};function Ti(){return{name:"textplaceholder",canHandleElement:e=>e.hasClass("text-placeholder"),handle(e){if("click"===e.e.type||"mouseup"===e.e.type){var t,n=Mi(),o=e.containerEl,r=o.getAttribute("data-placeholder-type"),a=[],i=g("default",Object(Lt.a)("property.panel.textplaceholder.display.default"),Object(Lt.a)("property.panel.textplaceholder.display.default.tooltip"));i.selected=!r,a.push(i);for(var l=0,d=n.length;l<d;l++)t=n[l],a.push(g(t.type,t.label,t.tooltip));a.push(null),a.push({className:"text-placeholder-property-panel-remove-button",text:Object(Lt.a)("property.panel.textplaceholder.remove"),click(){s.Confluence.PropertyPanel.destroy(),xi(o)}}),s.Confluence.PropertyPanel.createFromButtonModel("textplaceholder",o,a,{anchorIframe:u().getEditorFrame()})}function g(e,t,n){return{className:"text-placeholder-property-panel-type-item text-placeholder-property-panel-type-"+e,text:t,tooltip:n,selected:r===e,click(){!function(e){"default"===e?o.removeAttribute("data-placeholder-type"):o.setAttribute("data-placeholder-type",e);var t=c()(".text-placeholder-property-panel-type-"+e);t.parent().find(".text-placeholder-property-panel-type-item").removeClass("selected"),t.addClass("selected")}(e)}}}}}}function Di(){var e={click:!1,keypress:!0},t=s.tinymce.VK,n=s.tinymce.dom.Event,o="template"===g.a.get("content-type");function r(e){c()("#rte-button-insert-placeholder").click(e=>{e.preventDefault(),Ai()}),e.on("KeyDown",t=>{if(13===t.keyCode&&!t.shiftKey){var n=e.selection.getNode(),o=c()(n).closest(".text-placeholder"),r=e.selection.getRng();if(o.length&&r&&ho.isCursorAtEnd(e,r))return vo(e,o,!0),s.tinymce.dom.Event.cancel(t)}},!0)}var a={UL:!0,OL:!0,LI:!0,TABLE:!0,TBODY:!0};function i(e){return!a[e.nodeName]}function l(o){function r(){var e=u();e&&o.selection.select(e)}function a(e){e.off("KeyDown",l),e.off("KeyPress",d),e.off("Click",d)}function l(e){var r=u();return e.keyCode===t.LEFT||e.keyCode===t.UP?(function(e,t){for(var n,o=t&&t.previousSibling;t&&!o;)o=(t=t.parentNode).previousSibling;if(o){for(n=o;!i(n)&&n.lastChild;)n=n.lastChild;e.selection.select(n.lastChild||n),e.selection.collapse(!1),e.selection.normalize()}}(o,r),n.cancel(e)):e.keyCode===t.RIGHT||e.keyCode===t.DOWN?(function(e,t){for(var n,o=t&&t.nextSibling;t&&!o;)o=(t=t.parentNode).nextSibling;if(o){for(n=o;!i(n)&&n.firstChild;)n=n.firstChild;e.selection.select(n.firstChild||n),e.selection.collapse(!0),e.selection.normalize()}}(o,r),n.cancel(e)):e.keyCode===t.BACKSPACE||e.keyCode===t.DELETE?(xi(r),n.cancel(e)):void 0}function d(t){if(!s.tinymce.Env.gecko||t.isChar||"keypress"!==t.type){var n,o,r,a=u();if(a){var i=a.getAttribute("data-placeholder-type");n=i,o=t.type,r=n&&ki(n),c.a.extend({},e,r&&r.activation)[o]&&(xi(a),Object(y.b)("editor.text-placeholder.activated",{placeholderType:i||"",triggerEvent:t}))}}}function u(){var e=c()(o.getBody()).find(".text-placeholder.selected");return e.length?e[0]:(a(o),null)}o.on("NodeChange",(function(e){var t=e.element,n=c()(t).closest(".text-placeholder");c()(o.getBody()).find(".text-placeholder.selected").not(n).removeClass("selected"),n.length?(n.hasClass("selected")||(n.addClass("selected"),function(e){e.on("KeyDown",l,!0),e.on("KeyPress",d,!0),e.on("Click",d,!0)}(o)),setTimeout(r,0)):a(o)}),!0)}return{init(e){e.on("init",()=>{(o?r:l)(e),function(e){c()(e.getDoc()).find("head").append('<style type="text/css">.wiki-content .text-placeholder { display: inline-block; }</style>')}(e)})},getInfo:()=>({longname:"Text Placeholder Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"})}}function Ii(e){return e.parentNode&&e.parentNode.childNodes||[]}function Si(e){var t=Ii(e);return function(e){var t=!0,n=/TABLE|TH|TD/;return t=(t=(t=!n.test(e.nodeName))&&e.previousSibling?!n.test(e.previousSibling.nodeName):t)&&e.nextSibling?!n.test(e.nextSibling.nodeName):t}(e)&&(function(e){var t=function(e){return e&&e.innerHTML&&(e.innerHTML.replace(/\uFEFF|\u200B/g,"")||"&nbsp;")}(e);return/^&nbsp;$/.test(t)}(e)||t.length>1&&"BR"==t[0].nodeName)}function Oi(e,t){e.dom.remove(t)}n(77);var ji=()=>{var e=s.Confluence.PropertyPanel,t=[];return Object(y.a)("add-handler.property-panel",(e,n)=>{n&&t.push(n)}),{init:n=>{var o=()=>!!e.current,r=(r,a)=>{var i={focusedEl:a,focusedNodeName:a.nodeName&&a.nodeName.toLowerCase(),ed:n,e:c.a.extend({},r)},l=(e=>{if(e.is("img"))return e[0];var t=e.closest("a,table,.wysiwyg-macro,.editor-inline-macro,.text-placeholder");return t.length?t[0]:""})(c()(a)),d=!!c()(a).closest("table:not(.wysiwyg-macro,.editor-inline-macro)").length,u=!!c()(".toolbar-contextual").length;if(i.containerEl=l,Object(y.b)("user-blurred-rte-element",i),l&&!(e=>"click"==e.type&&(e.which?3===e.which:e.button?2==e.button:void 0))(r)&&!o()&&e.shouldCreate)for(var g=0,f=t.length;g<f;g++)if(t[g].canHandleElement(c()(l))){if(u||!d)return t[g].handle(i);(e=>{Ee(s.document,"shown.contextToolbar",()=>{e.handle(i)})})(t[g])}};function a(e,t){r(e,t.elem)}function i(t,n){o()&&(!n.containerEl||e.current.hasAnchorChanged(n.containerEl)?e.destroy():Object(y.b)("same-anchor.property-panel"))}function l(){setTimeout(()=>{u().bindScroll("property-panel",()=>{e.destroy()})},0),c()(n.getDoc()).bind("keydown.property-panel.escape",t=>{27===t.keyCode&&o()&&e.destroy()})}function d(){u().unbindScroll("property-panel"),c()(n.getDoc()).unbind("keydown.property-panel.escape")}n.on("Click",e=>{r(e,e.target)}),n.on("KeyDown",t=>{if(27!==t.keyCode){if(t.target.classList.contains("editor-inline-macro")){if(13===t.keyCode)return t.target.click(),void t.preventDefault();if(37===t.keyCode||38===t.keyCode||39===t.keyCode||40===t.keyCode)return t.target.blur(),void t.preventDefault()}if(o()&&"Tab"===t.key&&n.selection.getNode().classList.contains("editor-inline-macro"))return e.current.panel.find(".aui-button:first-child").focus(),void t.preventDefault();r(t,n.selection.getNode())}},!0),n.on("ContextMenu",()=>{e.destroy()}),Object(y.a)("trigger.property-panel",a),Object(y.a)("user-blurred-rte-element",i),Object(y.a)("created.property-panel",l),Object(y.a)("destroyed.property-panel",d),n.on("Remove",()=>{Object(y.c)("trigger.property-panel",a),Object(y.c)("user-blurred-rte-element",i),Object(y.c)("created.property-panel",l),Object(y.c)("destroyed.property-panel",d)})},getInfo:()=>({longname:"Image, Link and Macro Property Panels",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})}};var Ni,Li,Bi,Pi=(Ni=function(){function e(e){return e.nodeValue.toLowerCase()}return{search(t,n,o,r,a){var i=t.getSel(),l=function e(t){var n=[];if(t.nodeType===Node.TEXT_NODE)n.push(t);else for(var o=t.childNodes,r=0,a=o.length;r<a;++r)n.push.apply(n,e(o[r]));return n}(r);n=n.replace(/\s/g,"").toLowerCase();var c=l.map(e).join("");o=function(e,t,n){var o=e.getRng();if(o&&o.endContainer.nodeValue){var r=n.indexOf(o.endContainer.nodeValue.toLowerCase(),t)+o.endOffset;t=t!==r&&-1!==t?r:t}return t}(t,o,c);var s,d,u,g,f,m=(s=c,d=n,u=o,(f=(g=a)?s.lastIndexOf(d,u-1):s.indexOf(d,u))<0&&!g?f=s.indexOf(d):0===f&&0===u&&g&&(f=s.lastIndexOf(d)),f);if(m<0)return[!1,m];var p=function(e,t,n){for(var o,r,a,i,l=0,c=0;c<t.length;c++){if(t[c].nodeType===Node.TEXT_NODE){var s=e+n.length;!r&&t[c].length+l>=s&&(r=t[c],i=s-l),!o&&t[c].length+l>e&&(o=t[c],a=e-l),l+=t[c].length}if(o&&r)return{startNode:o,startIndex:a,endNode:r,endIndex:i}}}(m,l,n),h=document.createRange();return h.setStart(p.startNode,p.startIndex),h.setEnd(p.endNode,p.endIndex),i&&i.removeAllRanges(),i&&i.addRange(h),h.startContainer.parentNode&&h.startContainer.parentNode.scrollIntoView(),[!0,m]}}}(),Li=i.a.Env.browser.isEdge,(Bi=function e(t){var n=t,o=null,r=null,a=null,i=null,l=null,c={initialised:!1,find:function(e,t,n){var r=o.getFindInput().val(),i=a.findText(r,!0,e);i&&t?t():!i&&n&&n()},replace:function(e,t){var n=o.getFindInput(),r=o.getReplaceInput(),i="";r&&(i=r.val());var l=a.replaceText(n.val(),i,!0);l&&e?e():!l&&t&&t()},replaceAll:function(e,t){var n=o.getFindInput(),r=o.getReplaceInput(),i="";r&&(i=r.val());var l=a.replaceAll(n.val(),i);l&&e?e():!l&&t&&t()},focus:function(){o.focusFindTextBox()},isVisible:function(){return null!=o},init:function(){o=e.UI(n,i,l),(r=new e.MarkManager).addListener(o),a=null,a=new e.impl(o,r),o.getFindInput().focus()},onVisible:function(e){if(null!=e&&e.length>0){var t=o.getFindInput(),n=t.val();t.val(n+e)}o.onVisible()},onHide:function(){i=o.getFindInput().val(),l=o.getReplaceInput().val(),a.destroy(),a=null,o.destroy(),o=null,r.destroy(),r=null},_clearSavedValues:function(){i=null,l=null}};return c}).utils={moveCursorToEnd(e){if(i.a.Env.gecko){var t=c()(e).val().length;e.setSelectionRange(t,t)}},createTextRange:(e,t)=>e.selection?e.selection.createRange():t.getBody().createTextRange()},Bi.impl=function(e,t){var n=new i.a.html.Writer,o=t,r=-1,a=function e(t,n,a){if(!t)return!1;var l=i.a.activeEditor,c=l.selection,s=l.getWin();function d(){return l.undoManager.ignore(()=>{o.markCurrentlySelectedRange()}),!0}function u(){return l.undoManager.ignore(()=>{o.removeCurrentMark(!0),i.a.activeEditor.selection.isCollapsed()||i.a.activeEditor.selection.collapse()}),!1}if(o.isCursorAtCurrentMark()&&l.undoManager.ignore(()=>{c=o.selectCurrentMark()}),c.isCollapsed()||c.collapse(a),i.a.Env.gecko)return s.find(t,!1,a)?d():n?(c.select(l.getBody(),!1),c.collapse(!a),e(t,!1,a)):u();if(!Li())return s.find(t,!1,a,!0,!1,!1,!1)?d():u();var g=Ni.search(c,t,r,l.getBody(),a);return r=g[1],g[0]?d():void 0},l=function(e){var t=i.a.activeEditor;n.text(e,!1),t.selection.setContent(n.getContent(),{format:"raw"}),n.reset(),t.selection.collapse(!0)},c={};return c.findText=a,c.replaceText=function(e,t,n){var r=i.a.activeEditor;return o.hasCurrentMark()?(r.undoManager.transact(()=>{var e=o.replaceCurrentMark(t);e&&r.selection.select(e)}),a(e,n)):a(e,n)},c.replaceAll=function(e,t){var n=i.a.activeEditor,r=0;return n.undoManager.transact(()=>{var a=n.selection,i=n.getWin();if(o.removeCurrentMark(!1),n.execCommand("selectAll"),n.selection.collapse(!0),Li())for(var c=-1;;){var s=Ni.search(a,e,c,n.getBody(),!1);if(!s[0])break;c=s[1],l(t),r++}else for(;i.find(e,!1,!1,!1,!1,!1,!1);)l(t),r++;if(0===r)Ka.notify("info",n.translate("searchreplace_dlg.notfound"));else if(1===r)Ka.notify("success",n.translate("searchreplace_dlg.allreplacedsingular"));else if(r>1){var d=n.translate("searchreplace_dlg.allreplacedplural");Ka.notify("success",d.replace("{0}",r))}}),r},c.destroy=function(){o=null,n=null},c},Bi.UI=function(e,t,n){var o=null,r=Bi.utils.moveCursorToEnd;i.a.activeEditor&&i.a.activeEditor.plugins&&i.a.activeEditor.plugins.customtoolbar&&(o=i.a.activeEditor.plugins.customtoolbar.getToolbarRow(e));var a,l,s,d,u=function(){return c()(".toolbar-find-input",o)},g=function(){return c()(".toolbar-replace-input",o)},f=function(e){if("input"===e.type||"propertychange"===e.type){var t=u(),n="string"==typeof t.val()&&t.val().length>0;p(n),h(n)}},m=function(){var e=u();y(e&&e.val())},p=function(e){e?(i.a.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-next-button"),i.a.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-previous-button")):(i.a.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-next-button"),i.a.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-previous-button"))},h=function(e){var t=u();b().toggleClass("default-action",e&&t.val().length>0)},b=function(){return c()(".search-toolbar-find-next-button",o).closest(".aui-button")},v=function(e){var t=i.a.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replace-button"):t.disableToolbarButton("search-toolbar-replace-button")},y=function(e){var t=i.a.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replaceall-button"):t.disableToolbarButton("search-toolbar-replaceall-button")},w={};return w.getFindInput=u,w.getReplaceInput=g,w.focusFindTextBox=function(){top.focus(),u().focus()},w.onVisible=function(){var e=u();e.focus(),e.val().length>0&&(r(e[0]),p(!0),y(!0))},w.destroy=function(){},w.marked=function(){v(!0)},w.markRemoved=function(){v(!1)},a=t,l=n,s=u(),d=!1,a&&a.length&&(s.val(a),d=!0),l&&l.length&&g().val(l),function(){function e(e,t){e&&e.bind("input",t)}var t=u();e(t,f),e(t,m),c()(o).focusin(()=>{h(!0)}).focusout(()=>{h(!1)}),t.focus(()=>{h(!0)})}(),p(d),y(d),v(!1),w},Bi.MarkManager=function(){var e=null,t=new i.a.html.Writer,n=null,o=[],r=function(){s()},a=function(){if(!e)return null;var t=i.a.activeEditor;return t.selection.select(e[0]),t.selection},l=function(t){p(),(d(e,t)||n&&i.a.activeEditor.selection.getRng().toString()==n)&&(e=null,n=null,c.a.each(o,(e,t)=>{t.markRemoved()}))},s=function(){p(),c()("mark",i.a.activeEditor.getDoc()).each((e,t)=>{d(c()(t),!1)}),e=null,n=null,c.a.each(o,(e,t)=>{t.markRemoved()})},d=function(e,t){var n=i.a.activeEditor.selection.getRng();if(!e)return!1;var o=function(e,t){if(e.intersectsNode)return e.intersectsNode(t);var n=i.a.activeEditor.getDoc().createRange();return n.selectNodeContents(t),!(e.compareBoundaryPoints(Range.START_TO_END,n)<=0||e.compareBoundaryPoints(Range.END_TO_START,n)>=0)}(n,e[0]),r=null,a=null;if(e.contents().each((t,n)=>{e.before(n),r||(r=n),a=n}),o||t){var l=i.a.activeEditor.selection.getRng();l.setStartBefore(r),l.setEndAfter(a),t||l.collapse(!1),i.a.activeEditor.selection.setRng(l)}return e.remove(),!0},u=function(){return!!e||(n?i.a.activeEditor.selection.getRng().toString()==n:void 0)},g=function(){s()},f=function(){p(),c.a.each(o,(e,t)=>{t.markRemoved()})},m=function(e){var t=i.a.activeEditor;t.on("Change",r),t.on("BeforeSetContent",r),e&&(t.on("Click",f),t.on("DblClick",f))},p=function(){var e=i.a.activeEditor;e.off("Change",r),e.off("BeforeSetContent",r),e.off("Click",f),e.off("DblClick",f)},h={markCurrentlySelectedRange:function(){var t=i.a.activeEditor;if(e){var r=t.selection.getBookmark();l(!1),t.selection.moveToBookmark(r)}n=null;var s=t.selection.getRng();if(e=c()('<mark data-searching class="find-current"></mark>',t.getDoc()),s)try{s.surroundContents(e[0]),m(!1)}catch(t){1==t.code&&(n=s.toString(),e=null,m(!0))}if(c.a.each(o,(e,t)=>{t.marked()}),!n){var d=a();d&&d.collapse()}}};return h.removeCurrentMark=l,h.removeAllMarks=s,h.selectCurrentMark=a,h.isCursorAtCurrentMark=function(){if(!e)return!1;var t=i.a.activeEditor.selection;t.isCollapsed()||t.collapse();var n=t.getRng();if(n){if(3===n.startContainer.nodeType)return n.startContainer.parentNode&&n.startContainer.parentNode.normalize(),n.startContainer.nextSibling===e[0]||n.startContainer.previousSibling===e[0];if(1===n.startContainer.nodeType){var o=n.startContainer.childNodes,r=n.startOffset;return r>0&&o[r-1]===e[0]||r+1<o.length&&o[r+1]===e[0]}}},h.hasCurrentMark=u,h.replaceCurrentMark=function(n){if(function(n){if(e||!u())return!1;var o=i.a.activeEditor;return o.undoManager.transact(()=>{t.text(n,!1),o.selection.setContent(t.getContent(),{format:"raw"}),t.reset()}),o.undoManager.ignore(()=>{l(!1)}),!0}(n))return null;if(!e)return null;var o=i.a.activeEditor,r=[];o.undoManager.ignore(()=>{e.contents().each((e,t)=>{r.push(t)}),l(!1)});var a=void 0;return o.undoManager.transact(()=>{a=c()(r[0]).before(o.getDoc().createTextNode(n))[0].previousSibling;for(var e=r.length-1;e>=0;e--)c()(r[e]).remove()}),a},h.addListener=function(e){o.push(e)},h.destroy=function(){l(!0),i.a.activeEditor.off("BeforeGetContent",g)},i.a.activeEditor.on("BeforeGetContent",g),h},Bi("searchreplace"));function Ri(){var e=s.Confluence.Editor,t=null,n=!1,o=function(e){e.preventDefault(),e.stopPropagation()},r=function(e){o(e);var n=e.which;n||(n=e.charCode?e.charCode:e.keyCode),n<48||t.push(n)},a=function(e){var t=c()("#rte-button-searchreplace a");t.length&&(e?t.unbind("click",!1):t.bind("click",!1))},l=function(){if(!n){n=!0;var l=c()("#rte-button-searchreplace"),d=!l.hasClass("active"),u=c()("body"),g=!u.hasClass("no-tools")||u.hasClass("no-tools-toolbars-visible");d?(l.addClass("active"),c()(s.document).trigger("createContextToolbarRow.Toolbar",{id:"searchreplace",buttons:e.searchToolbar.Buttons,topToolbar:!0,editorAdjacent:!0,animate:g,onVisible(){var e=function(){var e=i.a.activeEditor;e.off("KeyDown",r),e.off("KeyPress",o),e.off("KeyUp",o);for(var n,a="",l=0;l<t.length;l++)a+=(n=t[l])>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(1023&n))):String.fromCharCode(n);return a.toLowerCase()}();Pi.onVisible(e),a(!0),n=!1,Pi.initialised=!0}}).trigger("enableContextToolbarRow.Toolbar"),function(){var e=i.a.activeEditor;t=[],e.on("KeyDown",r),e.on("KeyPress",o),e.on("KeyUp",o)}(),Pi.init(),a(!1)):(l.removeClass("active"),Pi.onHide(),c()(s.document).trigger("removeContextToolbarRow.Toolbar",{id:"searchreplace",animate:g,onHide(){c()(s.document).trigger("contextToolbarRowRemoved.Toolbar"),a(!0),n=!1,Pi.initialised=!1}}),a(!1),i.a.Env.gecko||frames.wysiwygTextarea_ifr.focus(),i.a.activeEditor.focus())}};return{init(e){e.addCommand("mceSearchReplaceToolbar",()=>(e.undoManager.ignore(()=>{l()}),!1)),e.addCommand("mceConfSearch",(t,n)=>!!Pi&&((n=n||{}).backwards&&!e.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-previous-button")?(Pi.focus(),!1):n.backwards||e.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-next-button")?(Pi.find(n.backwards,n.onFound,n.onNotFound),!1):(Pi.focus(),!1))),e.addCommand("mceConfReplaceAll",(t,n)=>!!Pi&&(n=n||{},!!e.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replaceall-button")&&(Pi.replaceAll(n.onReplaced,n.onNotReplaced),!1))),e.addCommand("mceConfSearchClose",()=>!!Pi&&(e.undoManager.ignore(()=>{e.execCommand("mceSearchReplaceToolbar",!1,null)}),!1)),e.ui.registry.addButton("searchreplace",{text:"searchreplace.search_desc",onAction:function(){e.execCommand("mceSearchReplaceToolbar")}}),e.shortcuts.add("meta+f","searchreplace.search_desc",()=>{Pi&&Pi.isVisible()?Pi.focus():e.undoManager.ignore(()=>{e.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})})},getInfo:()=>({longname:"Search/Replace",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:`${i.a.majorVersion}.${i.a.minorVersion}`})}}Object(dt.a)("confluence-editor/search-manager",()=>Pi);var Hi,zi,Fi,Ui,_i=function(){Ee(s.document,"initContextToolbars.Toolbar",(e,t)=>{var n;s.Confluence.Editor.searchToolbar=(n=s.Confluence.Editor,{initContextToolbars(e,t){var o=function(e){if(s.tinymce.Env.gecko){var t=c()(e).val().length;e.setSelectionRange(t,t)}},r=function(e){top.focus(),s.tinymce.activeEditor.plugins.customtoolbar.focusToolbarButton(e)},a=function(){top.focus();var e=c()("#search-toolbar-find-text");e.focus(),o(e[0])},i=function(){top.focus();var e=c()("#search-toolbar-replace-text");e.focus(),o(e[0])},l=function(){if(s.tinymce.Env.gecko){var e=s.tinymce.activeEditor;e.focus(),e.selection.select(e.getBody()),e.selection.collapse(!1),e.focus()}},d=new n.Toolbar.Components.TextBox({id:"search-toolbar-find-text",text:t.translate("searchreplace_dlg.findlabel"),name:"find",keydown:function(e){if((e.ctrlKey||s.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t={backwards:!1,onFound:a,onNotFound:a};s.tinymce.activeEditor.undoManager.ignore(()=>{s.tinymce.activeEditor.execCommand("mceConfSearch",!1,t,{skip_undo:!0})})}else 27===e.which&&(e.preventDefault(),s.tinymce.activeEditor.undoManager.ignore(()=>{s.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})}))},cssClass:"toolbar-find-input"}),u=new n.Toolbar.Components.TextBox({id:"search-toolbar-replace-text",text:t.translate("searchreplace_dlg.replacelabel"),name:"replace",keydown:function(e){if((e.ctrlKey||s.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t=s.tinymce.activeEditor.undoManager.ignore(()=>{s.tinymce.activeEditor.execCommand("mceConfSearch",!1,{backwards:!1,onFound:i,onNotFound:a},{skip_undo:!0})});p(i,a,t)}else 27===e.which&&(e.preventDefault(),s.tinymce.activeEditor.undoManager.ignore(()=>{s.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})}))},cssClass:"toolbar-replace-input"}),g=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.findprevious"),click(){var e={backwards:!0,onFound(){top.focus(),r("search-toolbar-find-previous-button")},onNotFound:a};t.undoManager.ignore(()=>{t.execCommand("mceConfSearch",!1,e,{skip_undo:!0})})},textClass:"search-toolbar-find-previous-button"}),f=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.findnext"),click(){var e={backwards:!1,onFound(){top.focus(),r("search-toolbar-find-next-button")},onNotFound:a};t.undoManager.ignore(()=>{t.execCommand("mceConfSearch",!1,e,{skip_undo:!0})})},textClass:"search-toolbar-find-next-button"}),m=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.replace"),click(){p(()=>{top.focus(),r("search-toolbar-replace-button")},a)},textClass:"search-toolbar-replace-button"}),p=(e,t,n)=>{Pi&&(s.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replace-button")?Pi.replace(e,t):n&&n())},h=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.replaceall"),click(){var e={onReplaced:l,onNotReplaced:a};t.undoManager.transact(()=>{t.execCommand("mceConfReplaceAll",!1,e)})},textClass:"search-toolbar-replaceall-button"}),b=new n.Toolbar.Components.Button({text:t.translate("searchreplace_dlg.close"),iconClass:"icon aui-icon aui-icon-small aui-iconfont-close-dialog",click(){t.undoManager.ignore(()=>{t.execCommand("mceConfSearchClose",!1,null)})}});return{Buttons:[new n.Toolbar.Components.Group([b],{groupClass:"close"}),new n.Toolbar.Components.Group([d,u],{groupClass:"no-separator"}),new n.Toolbar.Components.Group([g,f]),new n.Toolbar.Components.Group([m,h])]}}}).initContextToolbars(e,t)})},Wi={init:e=>{var t=e=>{c()(".tablesorter",e.node).each((e,t)=>{var n,o,r=c()(t).find("thead");1===r.length&&"THEAD"===(r=r[0]).nodeName&&1===r.childNodes.length&&(o=r.removeChild(r.childNodes[0]),n=c()(t).find("tbody")[0],t.removeChild(r),n.insertBefore(o,n.childNodes[0]))})};e.on("PastePostProcess",t),e.on("remove",()=>{e.off("PastePostProcess",t)})},getInfo:()=>({longname:"ConfluenceSortableTablesPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"})},Qi=n(31),Vi=n.n(Qi),$i=(n(80),["Grey","Red","Yellow","Green","Blue"]),Ki=$i[0];function Gi(){Yi();var e=s.Confluence.MacroParameterSerializer.deserialize(c()(zi).attr("data-macro-parameters")),t=!1,n=!1;return e&&Fi&&(t=e.title!==Fi.title,n=e.colour!==Fi.colour),t||n}function Yi(){if(Ui){var e=qi(Fi)==Ui.val(),t=""===Ui.val();e||t?delete Fi.title:Fi.title=Ui.val()}}function Ji(){if(!Hi||!Hi.state||"pending"!==Hi.state()){Yi();var e={contentId:s.Confluence.Editor.getContentId(),macro:{name:"status",params:Fi,defaultParameterValue:"",body:""}};(Hi=s.tinymce.confluence.MacroUtils.insertMacro(e,zi)).done(e=>{var t;t=zi=e,s.tinymce.activeEditor.selection.select(t),nt(),s.tinymce.activeEditor.selection.collapse()}).fail(e=>{0})}}function qi(e){return e.colour||e.color||Ki}function Zi(){var e=c()("<input/>");return e.attr("class","status-macro-title first last editable"),e.keyup(e=>13!==e.keyCode||(s.Confluence.PropertyPanel.destroy(),!1)),e.keydown(e=>27!==e.keyCode||(Ui=null,!0)),e}function Xi(e){(Ui=Zi()).val(e.find("span.panel-button-text").text()),e.replaceWith(Ui),Ui.select().focus()}function el(e){e.on("init",()=>{Vi.a.use()}),e.on("Remove",()=>{Vi.a.unuse()})}
/*! Modified by Atlassian | Copyright (c) 2011 by Jonas Mosbech - https://github.com/jmosbech/StickyTableHeaders
	MIT license info: https://github.com/jmosbech/StickyTableHeaders/blob/master/license.txt */
var tl=0,nl={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:d.a.document,objHead:"head",objWindow:d.a,scrollableArea:d.a,cacheHeaderHeight:!1};function ol(e,t){var n=this;n.$el=c()(e),n.el=e,n.id=tl++,n.$el.bind("destroyed",c.a.proxy(n.teardown,n)),n.$clonedHeader=null,n.$originalHeader=null,n.cachedHeaderHeight=null,n.isSticky=!1,n.hasBeenSticky=!1,n.leftOffset=null,n.topOffset=null,n.init=function(){n.setOptions(t),n.$el.each((function(){var e=c()(this);e.css("padding",0),n.$originalHeader=c()("thead:first",this),n.$clonedHeader=n.$originalHeader.clone(),e.trigger("clonedHeader.stickyTableHeaders",[n.$clonedHeader]),n.$clonedHeader.addClass("tableFloatingHeader"),n.$clonedHeader.css("display","none"),n.$originalHeader.addClass("tableFloatingHeaderOriginal"),n.$originalHeader.after(n.$clonedHeader),n.$printStyle=c()('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),n.$head.append(n.$printStyle)})),n.updateWidth(),n.toggleHeaders(),n.bind()},n.destroy=function(){n.$el.unbind("destroyed",n.teardown),n.teardown()},n.teardown=function(){n.isSticky&&n.$originalHeader.css("position","static"),c.a.removeData(n.el,"plugin_stickyTableHeaders"),n.unbind(),n.$clonedHeader.remove(),n.$originalHeader.removeClass("tableFloatingHeaderOriginal"),n.$originalHeader.css("visibility","visible"),n.$printStyle.remove(),n.el=null,n.$el=null},n.bind=function(){n.$scrollableArea.on("scroll.stickyTableHeaders",n.toggleHeaders),n.isWindowScrolling||(n.$window.on("scroll.stickyTableHeaders"+n.id,n.setPositionValues),n.$window.on("resize.stickyTableHeaders"+n.id,n.toggleHeaders)),n.$scrollableArea.on("resize.stickyTableHeaders",n.toggleHeaders),n.$scrollableArea.on("resize.stickyTableHeaders",n.updateWidth)},n.unbind=function(){n.$scrollableArea.off(".stickyTableHeaders",n.toggleHeaders),n.isWindowScrolling||(n.$window.off(".stickyTableHeaders"+n.id,n.setPositionValues),n.$window.off(".stickyTableHeaders"+n.id,n.toggleHeaders)),n.$scrollableArea.off(".stickyTableHeaders",n.updateWidth)},n.debounce=function(e,t){var n=null;return function(){var o=this,r=arguments;clearTimeout(n),n=setTimeout(()=>{e.apply(o,r)},t)}},n.toggleHeaders=n.debounce(()=>{n.$el&&n.$el.each((function(){var e,t=c()(this),o=n.isWindowScrolling?isNaN(n.options.fixedOffset)?n.options.fixedOffset.outerHeight():n.options.fixedOffset:n.$scrollableArea.offset().top+(isNaN(n.options.fixedOffset)?0:n.options.fixedOffset),r=t.offset(),a=n.$scrollableArea.scrollTop()+o,i=n.$scrollableArea.scrollLeft(),l=n.options.cacheHeaderHeight?n.cachedHeaderHeight:n.$clonedHeader.height(),s=n.isWindowScrolling?a>r.top:o>r.top,d=(n.isWindowScrolling?a:0)<r.top+t.height()-l-(n.isWindowScrolling?0:o);s&&d?(e=r.left-i+n.options.leftOffset,n.$originalHeader.css({position:"fixed","margin-top":n.options.marginTop,left:e,"z-index":3}),n.leftOffset=e,n.topOffset=o,n.$clonedHeader.css("display",""),n.isSticky||(n.isSticky=!0,n.updateWidth(),t.trigger("enabledStickiness.stickyTableHeaders")),n.setPositionValues()):n.isSticky&&(n.$originalHeader.css("position","static"),n.$clonedHeader.css("display","none"),n.isSticky=!1,n.resetWidth(c()("td,th",n.$clonedHeader),c()("td,th",n.$originalHeader)),t.trigger("disabledStickiness.stickyTableHeaders"))}))},0),n.setPositionValues=n.debounce(()=>{var e=n.$window.scrollTop(),t=n.$window.scrollLeft();!n.isSticky||e<0||e+n.$window.height()>n.$document.height()||t<0||t+n.$window.width()>n.$document.width()||n.$originalHeader.css({top:n.topOffset-(n.isWindowScrolling?0:e),left:n.leftOffset-(n.isWindowScrolling?0:t)})},0),n.updateWidth=n.debounce(()=>{if(n.isSticky){n.$originalHeaderCells||(n.$originalHeaderCells=c()("th,td",n.$originalHeader)),n.$clonedHeaderCells||(n.$clonedHeaderCells=c()("th,td",n.$clonedHeader));var e=n.getWidth(n.$clonedHeaderCells);n.setWidth(e,n.$clonedHeaderCells,n.$originalHeaderCells),n.$originalHeader.css("width",n.$clonedHeader.width()),n.options.cacheHeaderHeight&&(n.cachedHeaderHeight=n.$clonedHeader.height())}},0),n.getWidth=function(e){var t=[];return e.each((function(e){var o,r=c()(this);if("border-box"===r.css("box-sizing")){var a=r[0].getBoundingClientRect();o=a.width?a.width:a.right-a.left}else{if("collapse"===c()("th",n.$originalHeader).css("border-collapse"))if(d.a.getComputedStyle)o=parseFloat(d.a.getComputedStyle(this,null).width);else{var i=parseFloat(r.css("padding-left")),l=parseFloat(r.css("padding-right")),s=parseFloat(r.css("border-width"));o=r.outerWidth()-i-l-s}else o=r.width()}t[e]=o})),t},n.setWidth=function(e,t,n){t.each(t=>{var o=e[t];n.eq(t).css({"min-width":o,"max-width":o})})},n.resetWidth=function(e,t){e.each((function(e){var n=c()(this);t.eq(e).css({"min-width":n.css("min-width"),"max-width":n.css("max-width")})}))},n.setOptions=function(e){n.options=c.a.extend({},nl,e),n.$window=c()(n.options.objWindow),n.$head=c()(n.options.objHead),n.$document=c()(n.options.objDocument),n.$scrollableArea=c()(n.options.scrollableArea),n.isWindowScrolling=n.$scrollableArea[0]===n.$window[0]},n.updateOptions=function(e){n.setOptions(e),n.unbind(),n.bind(),n.updateWidth(),n.toggleHeaders()},n.init()}c.a.fn.stickyTableHeaders=function(e){return this.each((function(){var t=c.a.data(this,"plugin_stickyTableHeaders");t?"string"==typeof e?t[e].apply(t):t.updateOptions(e):"destroy"!==e&&c.a.data(this,"plugin_stickyTableHeaders",new ol(this,e))}))};var rl=function(e){return!(e.parents("table").length>0)},al=function(e){return!(e.closest(".columnLayout").length>0)},il=function(){return!c()("body").hasClass("theme-documentation")},ll=function(e){var t=c()(e);return il()&&function(e){return!e.hasClass("stickyTableHeaders")}(t)&&al(t)&&rl(t)&&function(e){return e.find("> thead:first").is(":visible")}(t)&&function(e){return 1===e.find("thead").children().length}(t)&&function(e){return 1===e.find(".confluenceTh").parent().length}(t)&&function(e){return e.find(".confluenceTh").siblings().hasClass("confluenceTh")}(t)},cl=function(e,t){var n=t||c()(window);e.closest(".table-wrap").scroll(()=>{n.trigger("scroll.stickyTableHeaders")})},sl=function(e){c()(e).each((function(){var e=c()(this),t=e.find(".confluenceTh[rowspan]").length>0,n=e.find("> :first-child > :first-child .confluenceTh"),o=n.length&&n.closest("thead").length>0,r=n.length&&0===n.parent().index();if(rl(e)&&al(e)&&!o&&r&&!t){var a=c()("<thead />").append(n.parent());e.prepend(a)}}))},dl=il,ul=function(e,t){var n=e.filter((function(){return ll(this)}));n.stickyTableHeaders(t).addClass("stickyTableHeaders"),Object(y.a)("sticky-table-headers.change.options",(e,t)=>{n.stickyTableHeaders(t)}),cl(n)},gl=function(){var e=c()(".confluenceTable"),t=c()(window);if(dl()){if(sl(e),window.MutationObserver){var n=document.querySelector("#page");if(!n)return;var o=/sticky|tableFloating|confluenceTh/;new MutationObserver(c.a.debounce(e=>{for(var n,r=!1,a=0,i=e.length;a<i;a++)if(n=e[a].target.className,!o.test(n)){r=!0;break}r&&t.trigger("resize.stickyTableHeaders")},0)).observe(n,{subtree:!0,attributes:!0,childList:!0})}ul(e,{cacheHeaderHeight:!0})}};function fl(e){function t(e){var t,r,a,i={id:!0,class:!0,style:!0,rowspan:!0,colspan:!0,"data-mce-style":!0,"data-mce-bogus":!0,"data-macro-name":!0,"data-macro-parameters":!0,"data-macro-body-type":!0,"data-highlight-colour":!0,"data-highlight-class":!0,"data-mce-resize":!0,"data-snooker-col-series":!0,"data-snooker-locked-cols":!0,contenteditable:!0},l=["highlight","nohighlight","relative-table","fixed-table","fixed-width","numberingColumn"],c=0,s=[],d=$(e);if(!e||o(e))return e;if(function(e){var t;e&&e.getAttribute&&(t=e.getAttribute("class"));return t&&t.indexOf("table-wrap")>=0}(e)){var u=$("table",e);if(!u.length)return null;$(u).unwrap(),e=u[0]}if(function(e){return!!e.tagName&&("TABLE"===e.tagName||("TR"===e.tagName||("TH"===e.tagName||("TD"===e.tagName||("TBODY"===e.tagName||("THEAD"===e.tagName||("TFOOT"===e.tagName||("COL"===e.tagName||("COLGROUP"===e.tagName||"CAPTION"===e.tagName)))))))))}(e)&&e.attributes){for(;c<=e.attributes.length;)(t=e.attributes[c])&&!0===t.specified&&!i[t.name]?e.removeAttribute(t.name):c++;n(e)&&s.push(n(e));for(var g=0,f=l.length;g<f;g++)d.hasClass(l[g])&&s.push(l[g]);(r=d.attr("data-highlight-class"))&&s.push(r),(a=d.attr("data-highlight-colour"))&&s.push("highlight-"+a),d.attr("class",s.join(" "))}return e}function n(e){return e.tagName?"TABLE"===e.tagName?"confluenceTable":"TH"===e.tagName?"confluenceTh":"TD"===e.tagName?"confluenceTd":"":""}function o(e){var t;return e&&e.getAttribute&&(t=e.getAttribute("class")),!!e.tagName&&("TABLE"===e.tagName&&(!!t&&-1!==t.indexOf("wysiwyg-macro")))}function r(e,n,r){r.node=function(e,t){for(var n,r,a,i=e;i&&("function"==typeof t&&(i=t(i)),i);)!i.firstChild||(r=i,(a=n)&&a.parentNode===r)||o(i)?i.nextSibling?(n=i,i=i.nextSibling):(n=i,i=i.parentNode):(n=i,i=i.firstChild);return e}(r.node,t)}e.on("Init",(function(){Ee(document,"postPaste",r)})),e.on("Remove",(function(){Te(document,"postPaste",r)}))}var ml;function pl(e,t){var n=c.a.parseHTML(e),o=[Node.ELEMENT_NODE,Node.DOCUMENT_NODE,Node.DOCUMENT_FRAGMENT_NODE],r=!1;return n.forEach((function(e){(ml.dom.is(e,t)||o.includes(e.nodeType)&&e.querySelector(t))&&(r=!0)})),r}function hl(){Object(y.b)("analytics",{name:"confluence.table.image.insert",data:{pageId:g.a.get("page-id"),tableMode:vl()}})}function bl(){return!!c()(ml.selection.getNode()).closest("table.confluenceTable").length}function vl(){var e=c()(ml.selection.getNode()).closest("table.confluenceTable");return e.hasClass("fixed-table")||e.hasClass("fixed-width")?"fixed":e.hasClass("relative-table")?"relative":"fluid"}function yl(){var e=c()(ml.getBody()).find("table.confluenceTable");Object(y.b)("analytics",{name:"confluence.table.quality.in.page",data:{pageId:g.a.get("page-id"),total:e.length,fixed:e.filter(".fixed-table,.fixed-width").length,fluid:e.filter(":not(.fixed-table,.relative-table,.fixed-width)").length,relative:e.filter(".relative-table").length,nested:e.find("table.confluenceTable").length}})}var wl={init(e){function t(e,t){bl()&&function(e){var t,n;e&&e.name&&e.name.indexOf("confluence.editor.image.resize")>=0&&Object(y.b)("analytics",{name:"confluence.table.img.resize",data:{pageId:g.a.get("page-id"),tableMode:vl(),isImgBiggerCell:(t=c()(ml.selection.getNode()),n=t.closest("th, td"),t.width()>n.width())}})}(t)}ml=e,e.on("ExecCommand",e=>{switch(e.command){case"mceAutoWidth":case"mceRelativeWidth":case"mceFixedWidth":Object(y.b)("analytics",{name:"confluence.table.mode.to."+vl(),data:{pageId:g.a.get("page-id")}});break;case"mceTableCopyRow":Object(y.b)("analytics",{name:"confluence.table.row.copy",data:{pageId:g.a.get("page-id")}});break;case"mceTablePasteRowBefore":case"mceTablePasteRowAfter":Object(y.b)("analytics",{name:"confluence.table.row.paste",data:{pageId:g.a.get("page-id")}});break;case"mceTableCopyCol":Object(y.b)("analytics",{name:"confluence.table.col.copy",data:{pageId:g.a.get("page-id")}});break;case"mceTablePasteColBefore":case"mceTablePasteColAfter":Object(y.b)("analytics",{name:"confluence.table.col.paste",data:{pageId:g.a.get("page-id")}});break;case"mceInsertContent":pl(t=e.value,"img")&&bl()&&hl(),pl(t,"table.confluenceTable")&&Object(y.b)("analytics",{name:"confluence.table.paste",data:{pageId:g.a.get("page-id")}});break;case"confTableSelectionToggleHighlight":Object(y.b)("analytics",{name:"confluence.editor.table.selection.toggle.highlight",data:{color:c()("#table-highlight-group").attr("data-highlight-colour")}})}var t}),e.on("Init",()=>{e.on("SetContent",e=>{bl()&&e&&function(e){pl(e.content,".confluence-embedded-image")&&hl()}(e)})}),Object(y.a)("analyticsEvent",t),Object(y.a)("rte.safe-save.success",yl),e.on("Remove",()=>{Object(y.c)("analyticsEvent",t),Object(y.c)("rte.safe-save.success",yl)})},getInfo:()=>({longname:"Table Analytics Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})};var Cl=/^\u200b?(\[)$/;function Al(e){return e.dom.getParent(e.selection.getStart(),"UL,OL")}function xl(e){return!(!e||"ul"!==e.nodeName.toLowerCase()||!e.classList.contains("inline-task-list"))}function Ml(e){return e&&"ul"===e.nodeName.toLowerCase()&&!xl(e)}function kl(e){e&&e.classList.contains("inline-task-list")&&(e.classList.remove("inline-task-list"),0===e.classList.length&&e.removeAttribute("class"),e.removeAttribute("data-inline-tasks-content-id"),Array.prototype.slice.call(e.children).forEach(e=>{e.removeAttribute("data-inline-task-id"),e.classList.remove("checked"),e.style.backgroundImage=""}))}function El(e){var t=Al(e);t&&xl(t)||function(e,t){var n="a11y-notification-"+e.dom.uniqueId();e.getBody().insertAdjacentHTML("afterend",`<div class="assistive" aria-live="assertive" role="Alert" id="${n}"></div>`);var o=e.getDoc().getElementById(n);if(o){o.insertAdjacentHTML("afterbegin",`<span>${t}</span>`);var r=setTimeout(()=>{o.remove(),clearTimeout(r)},3e3)}}(e,s.AJS.format("Task list item created"));var n=e.dom.uniqueId();e.execCommand("InsertUnorderedList",!1,{"list-attributes":{"data-task-list-id":n,class:"inline-task-list"},"list-item-attributes":{"data-inline-task-id":""}}),e.dom.select(`[data-task-list-id="${n}"]`).forEach(t=>{var n=t.querySelectorAll("li")[0];n&&e.dom.isEmpty(t)&&(n.innerHTML=`<span class="placeholder-inline-tasks">${Object(Lt.a)("tinymce.confluence.placeholder.inline.tasks")}</span>`,e.selection.select(n.firstChild,!0)),t.removeAttribute("data-task-list-id")})}function Tl(){return!(e=g.a.get("use-inline-tasks"),"true"===e||!0===e||"page"===g.a.get("content-type")||"blogpost"===g.a.get("content-type")||"template"===g.a.get("content-type"));var e}var Dl={init(e){e.on("init",()=>{e.getBody().classList.add("template-editor")})}};var Il=function(e){if(!e)return null;var t=e.endOffset;return 3===e.endContainer.nodeType?e.endContainer:e.endContainer.childNodes[t-1]},Sl=function(e,t){if(t&&t.previousSibling&&t.previousSibling.hasChildNodes()){var n=t.previousSibling,o=n.childNodes.length,r=n.childNodes[o-1],a=r.length,i=e.dom.createRng();i.setStart(r,a),i.setEnd(r,a),e.selection.setRng(i)}},Ol={init(e){e.on("KeyDown",t=>{s.tinymce.VK.modifierPressed(t)||32!==t.keyCode||function(e){var t=e.selection.getNode(),n=c()(t).closest("a"),o=e.selection.getRng();n.length&&o&&ho.isCursorAtEnd(e,o)&&(o.setStartAfter(n[0]),o.setEndAfter(n[0]),e.selection.setRng(o),e.selection.collapse())}(e),s.tinymce.VK.modifierPressed(t)||8!==t.keyCode&&37!==t.keyCode||function(e){if(e.selection.isCollapsed()&&!function(e){return!!e.dom.getParents(e.selection.getNode(),"#autocomplete-search-text").length}(e)){var t=Il(e.selection.getRng());t&&t.nodeValue&&65279===t.nodeValue.charCodeAt(0)&&function(e,t){return 1==t.nodeValue.length&&1==e.selection.getNode().childNodes.length}(e,t)&&e.undoManager.ignore(()=>{Sl(e,t),t.parentNode&&t.parentNode.removeChild(t)})}}(e)})}};var jl=n(32),Nl=n.n(jl);function Ll(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Bl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ll(Object(n),!0).forEach((function(t){Pl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ll(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Rl=(e,t)=>{if("number"==typeof e)return e;if("string"==typeof e&&/^\d+/.test(e))try{return parseInt(e)}catch(e){return t}return t};class Hl{constructor(e){Pl(this,"scope",void 0),Pl(this,"listeners",void 0),Pl(this,"inDispatch",void 0),this.inDispatch=!1,this.scope=e||this,this.listeners=[]}add(e,t){return this.listeners.push({cb:e,scope:t||this.scope}),e}addToTop(e,t){var n={cb:e,scope:t||this.scope};return this.inDispatch?this.listeners=[n].concat(this.listeners):this.listeners.unshift(n),e}remove(e){var t=this.listeners,n=null;return s.tinymce.each(t,(o,r)=>{if(e==o.cb)return n=o,t.splice(r,1),!1}),n}dispatch(){var e,t,n,o=arguments,r=this.listeners;for(this.inDispatch=!0,t=0;t<r.length&&!1!==(n=(e=r[t]).cb.apply(e.scope,o.length>0?o:[e.scope]));t++);return this.inDispatch=!1,n}}function zl(e){return"object"==typeof e&&e.name}function Fl(e,t){return"string"==typeof t?e.queryCommandState(t):!!zl(t)&&e.queryCommandState(t.name)}function Ul(e){this.init=this.init(e)}function _l(e){var t={},n={bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",justifyleft:"JustifyLeft",justifycenter:"JustifyCenter",justifyright:"JustifyRight",bullist:"InsertUnorderedList",numlist:"InsertOrderedList",tasklist:"InsertInlineTaskList",outdent:"Outdent",indent:"Indent",cut:"Cut",copy:"Copy",paste:"Paste",undo:"Undo",redo:"Redo",removeformat:"RemoveFormat",sub:"subscript",sup:"superscript",forecolor:"ForeColor",forecolorpicker:"mceForeColor",backcolor:"HiliteColor",backcolorpicker:"mceBackColor",charmap:"mceCharMap",visualaid:"mceToggleVisualAid",anchor:"mceInsertAnchor",newdocument:"mceNewDocument",blockquote:"mceBlockQuote",help:"mceConfShortcutDialog"},o=["bold","italic","underline","bullist","numlist","tasklist","justifyleft","justifycenter","justifyright","strikethrough","sub","sup","monospace"];function r(e){var n=e.undoManager;t.buttons.state.dispatch("undo","disabled",!n.hasUndo()&&!n.typing),t.buttons.state.dispatch("redo","disabled",!n.hasRedo())}function a(t){var o=e.ui.registry.getAll().buttons[t];if(!o)return!1;o.cmd?n[t]=o.cmd:n[t]={func:o.onAction,name:t}}function i(){s.tinymce.each(s.tinymce.explode(e.settings.theme_advanced_buttons1),n=>{if(!a(n))switch(n){case"formatselect":t.formatselect={},t.formatselect.state=new Hl,t.formatselect.click=new Hl,t.formatselect.click.add(t=>{e.execCommand("FormatBlock",!1,t)})}}),t.buttons={},t.buttons.state=new Hl,t.buttons.click=new Hl,t.buttons.click.add(t=>{var o=n[t];"string"==typeof o?e.execCommand(n[t]):zl(o)&&o.func()}),function(){var t={toolbar:"toolbar-primary",title:"",tooltip:"",cmd:"",className:"",locationGroup:null,weight:1/0,onclick:null},n=e.ui.registry.getAll().buttons,o=[];for(var r in n)o.push(Bl(Bl(Bl({},t),n[r]),{},{id:r,weight:Rl(n[r].weight,1/0)}));o=o.filter(e=>!!e.locationGroup),["toolbar-primary"].forEach(e=>{var t=c()("."+e);o.filter(t=>t.toolbar===e).sort((e,t)=>e.weight-t.weight).forEach(e=>{a(e.id);var n,o=t.find("."+e.locationGroup),r=c()(`<li id="${(n=e).id}" class="toolbar-item ${n.className}" data-tooltip="${n.tooltip}" data-weight="${n.weight}">\n                            <a class="toolbar-trigger aui-button aui-button-subtle" role="button" aria-label="${n.tooltip}" href="#" data-control-id="${n.id}">\n                                <span class="icon ${n.icon}"></span>\n                                <span class="trigger-text">${n.title}</span>\n                            </a>\n                        </li>`);o.append(r).removeClass("hidden")})})}()}var l=Ul.shouldInit();return l&&Ul.suppressIncompatiblePlugins(),e.on("init",()=>{i(),e.settings.readonly||(e.on("NodeChange",a=>{!function(e,a){s.tinymce.each(o,o=>{t.buttons.state.dispatch(o,"active",!!Fl(e,n[o]))}),r(e),t.buttons.state.dispatch("outdent","disabled",!Fl(e,"Outdent"));var i=function(e){for(var t=a.parents,n=0;n<t.length;n++)if(e(t[n]))return t[n]}(e.dom.isBlock);i&&t.formatselect.state.dispatch(i.nodeName.toLowerCase())}(e,{parents:a.parents})}),e.on("keyup",()=>{r(e)}),e.on("MouseUp",()=>{r(e)}),e.dom.bind(e.dom.getRoot(),"dragend",()=>{r(e)}),l&&new Ul(e)),Nl.a.use()}),e.on("Remove",()=>{Nl.a.unuse()}),{controlHandlers:t}}Ul.INCOMPATIBLE_PLUGINS=["dfe"],Ul.shouldInit=()=>{var e=c()("body");return e.hasClass("edit")||e.hasClass("create")||e.hasClass("copy-page")},Ul.suppressIncompatiblePlugins=()=>{for(var e=()=>{},t=0,n=Ul.INCOMPATIBLE_PLUGINS.length;t<n;t++)s.tinymce.PluginManager.lookup[Ul.INCOMPATIBLE_PLUGINS[t]]=e},Ul.prototype.init=e=>{var t=s.tinymce.util.VK,n=c()("#content-title"),o=c()("form.editor"),r=c()(e.getBody()),a=c()(e.getDoc()),i=c()("#editor-precursor"),l=c()(e.getWin()),u=c()("#toolbar"),g=a.scrollTop(),f=parseInt(r.css("padding-top"),10)+parseInt(r.css("margin-top"),10),m=parseInt(i.css("padding-top"),10),p=d.a.requestAnimationFrame||d.a.webkitRequestAnimationFrame;function h(t){e.plugins.customtoolbar.toggleToolbarButtons(t,t,t,()=>!c()(this).parent().hasClass("close"))}function b(e){return e.getBoundingClientRect().top+document.body.scrollTop}function v(){var e=g-a.scrollTop(),t=b(u[0])-b(o[0]),n=i.outerHeight(),l=u.outerHeight();i.css("top",t+l+e+m+"px"),r.css("padding-top",n+f+"px")}return n.on("keydown",n=>{var o=n.keyCode||n.which;o!==t.ENTER&&o!==t.DOWN||(n.preventDefault(),n.stopPropagation(),e.focus(!1))}).on("focus click",()=>{h(!0)}),l.on("focus",()=>{h(!1)}),function(e){!function t(){e(t),v()}(),r.on("scroll mousewheel",()=>{setTimeout(v,0)})}(p),!0};var Wl="confluence.spa.editor",Ql=(e,t)=>{Object.keys(t).forEach(e=>{t[e]=oa(t[e])}),Object(y.b)("analytics",{name:`${Wl}.plugins.${e}`,data:t})};var Vl={init:e=>{e.on("init",()=>{if(g.a.get("use-watch")){var e={userWatchingOwnContent:g.a.get("user-watching-own-content")};c()("#rte-savebar-tinymce-plugin-point").append(`\n    <ul class="toolbar-group toolbar-group-watch-page" id="toolbar-group-watch-page-after-comment">\n        <li class="toolbar-item">\n            <input id="watchPage" name="watchPageAfterComment" value="true" type="checkbox" ${e.userWatchingOwnContent?'checked="checked"':""}/>\n            <label for="watchPage">${(e=>Object(Lt.a)(e))("comment.notification.enable")}</label>\n        </li>\n    </ul>\n`)}})},getInfo:()=>({longname:"Confluence Watch",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})},$l=[function(){var e;function t(){}function n(t){!e&&d.a&&d.a.console&&(e=!0,console.log("Deprecated TinyMCE API call: "+t))}function o(e,o,r,a){e=e||this;var i=[];o?(this.add=function(t,l,c){function s(n){var i=[];if("string"==typeof r&&(r=r.split(" ")),r&&"function"!=typeof r)for(var c=0;c<r.length;c++)i.push(n[r[c]]);("function"!=typeof r||(i=r(o,n,e)))&&(r||(i=[n]),i.unshift(a||e),!1===t.apply(l||a||e,i)&&n.stopImmediatePropagation())}n(`<target>.on${o}.add(..)`),e.on(o,s,c);var d={original:t,patched:s};return i.push(d),s},this.addToTop=function(e,t){this.add(e,t,!0)},this.remove=function(t){return i.forEach((n,r)=>{if(n.original===t)return i.splice(r,1),e.off(o,n.patched)}),e.off(o,t)},this.dispatch=function(){return e.fire(o),!0}):this.add=this.addToTop=this.remove=this.dispatch=t}function r(e){function r(t,n){s.tinymce.each(t.split(" "),t=>{e["on"+t]=new o(e,t,n)})}function a(e,t,n){return[t.level,n]}function i(e){return function(t,n){if(!n.selection&&!e||n.selection==e)return[n]}}if(!e.controlManager){e.controlManager={buttons:{},setDisabled(e,t){n("controlManager.setDisabled(..)"),this.buttons[e]&&this.buttons[e].disabled(t)},setActive(e,t){n("controlManager.setActive(..)"),this.buttons[e]&&this.buttons[e].active(t)},onAdd:new o,onPostRender:new o,add:e=>e,createButton:l,createColorSplitButton:l,createControl:l,createDropMenu:l,createListBox:l,createMenuButton:l,createSeparator:l,createSplitButton:l,createToolbar:l,createToolbarGroup:l,destroy:t,get:t,setControlType:l},r("PreInit BeforeRenderUI PostRender Load Init Remove Activate Deactivate","editor"),r("Click MouseUp MouseDown DblClick KeyDown KeyUp KeyPress ContextMenu Paste Submit Reset"),r("BeforeExecCommand ExecCommand","command ui value args"),r("PreProcess PostProcess LoadContent SaveContent Change"),r("BeforeSetContent BeforeGetContent SetContent GetContent",i(!1)),r("SetProgressState","state time"),r("VisualAid","element hasVisual"),r("Undo Redo",a),r("NodeChange",(t,n)=>[e.controlManager,n.element,e.selection.isCollapsed(),n]);e.addButton;e.addButton=function(t,n){var o,r,a;n.title&&(n.text=(o=n.title,r=[e.settings.language||"en",o].join("."),a=s.tinymce.i18n.translate(r),r!==a?a:s.tinymce.i18n.translate(o))),n.cmd&&(n.onAction=function(){ed.execCommand(n.cmd)}),e.ui.registry.addButton(t,n)},e.on("init",()=>{var t=e.undoManager,n=e.selection;t.onUndo=new o(e,"Undo",a,null,t),t.onRedo=new o(e,"Redo",a,null,t),t.onBeforeAdd=new o(e,"BeforeAddUndo",null,t),t.onAdd=new o(e,"AddUndo",null,t),n.onBeforeGetContent=new o(e,"BeforeGetContent",i(!0),n),n.onGetContent=new o(e,"GetContent",i(!0),n),n.onBeforeSetContent=new o(e,"BeforeSetContent",i(!0),n),n.onSetContent=new o(e,"SetContent",i(!0),n)}),e.on("BeforeRenderUI",()=>{var t=e.windowManager;t.onOpen=new o,t.onClose=new o,t.createInstance=function(e,t,o,r,a,i){return n("windowManager.createInstance(..)"),new(s.tinymce.resolve(e))(t,o,r,a,i)}}),e.getLang=(t,n)=>e.editorManager.i18n.data[(e.settings.language||"en")+"."+t]||(void 0!==n?n:"{#"+t+"}")}function l(){var e={};function t(){return l()}return n("editor.controlManager.*"),s.tinymce.each("add addMenu addSeparator collapse createMenu destroy displayColor expand focus getLength hasMenus hideMenu isActive isCollapsed isDisabled isRendered isSelected mark postRender remove removeAll renderHTML renderMenu renderNode renderTo select selectByIndex setActive setAriaProperty setColor setDisabled setSelected setState showMenu update".split(" "),n=>{e[n]=t}),e}}s.tinymce.util.Dispatcher=o,s.tinymce.onBeforeUnload=new o(s.tinymce,"BeforeUnload"),s.tinymce.onAddEditor=new o(s.tinymce,"AddEditor","editor"),s.tinymce.onRemoveEditor=new o(s.tinymce,"RemoveEditor","editor"),s.tinymce.util.Cookie={get:t,getHash:t,remove:t,set:t,setHash:t},s.tinymce.on("SetupEditor",e=>{r(e.editor)}),s.tinymce.PluginManager.add("compat3x",r),s.tinymce.addI18n=function(e,t){var n=s.tinymce.util.I18n,o=s.tinymce.each;if("string"!=typeof e||-1!==e.indexOf("."))if(n.data=n.data||{},s.tinymce.is(e,"string"))if(s.tinymce.is(t,"string")){var r=e.split("."),a=r.shift(),i={};i[r.join()]=t,n.add(a,i)}else o(t,(t,o)=>{n.data[`${e}.${o}`]=t;var r=e.split("."),a=r.shift();r.push(o);var i={};i[r.join(".")]=t,n.add(a,i)});else o(e,(e,t)=>{o(e,(e,r)=>{o(e,(e,o)=>{var a={};"common"===r?(n.data[`${t}.${o}`]=e,a[o]=e):(n.data[`${t}.${r}.${o}`]=e,a[`${r}.${o}`]=e),n.add(t,a)})})});else n.add(e,t)}},function(){s.tinymce.PluginManager.add("atlassiantheme",_l)},function(){Object(y.a)("init.rte",yo)},function(){s.tinymce.PluginManager.add("aePaste",et)},()=>{s.tinymce.PluginManager.add("tablePasteFilter",fl)},function(){s.tinymce.create("tinymce.plugins.ConfList",{init:e=>{e.editorCommands.addCommands({outdent:function(){var t=e.selection,n=e.dom;function o(t){var o=n.getParent(t,n.isBlock);return o&&parseInt(e.dom.getStyle(o,"margin-left",!1)||"0",10)+parseInt(e.dom.getStyle(o,"padding-left",!1)||"0",10)>0}return o(t.getStart())||o(t.getEnd())||e.queryCommandState("InsertOrderedList")||e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertInlineTaskList")}},"state")}}),s.tinymce.PluginManager.add("conflist",s.tinymce.plugins.ConfList)},function(){s.tinymce.PluginManager.add("tasklist",(function(e){var t=()=>{var t=Al(e);t&&(t=>{var n=e.dom.getParent(t.parentElement,"UL");return t&&"UL"===t.tagName&&n&&n.classList.contains("inline-task-list")&&t!=n})(t)&&(e=>Array.from(e.childNodes).every(e=>e.hasAttribute("data-inline-task-id")))(t)&&e.undoManager.ignore(()=>{t.classList.add("inline-task-list")})},n=()=>("page"!==g.a.get("content-type")&&"blogpost"!==g.a.get("content-type")&&"template"!==g.a.get("content-type")||e.undoManager.transact(()=>{Ml(Al(e))&&(e.execCommand("InsertOrderedList"),kl(Al(e))),El(e)}),!1);function o(t,n){if(!Tl()){var o=n.handlerManager,r=n.createHandler;o.registerHandler("]".charCodeAt(0),r(Cl,()=>{e.execCommand("InsertInlineTaskList")},!0))}}function r(){e.addQueryStateHandler("InsertInlineTaskList",()=>xl(Al(e))),e.addQueryStateHandler("InsertUnorderedList",()=>Ml(Al(e)))}function a(t,n,o){if(Tl()){var r=e.dom.createFragment("");r.appendChild(o.node),Array.prototype.slice.call(r.querySelectorAll("ul.inline-task-list, ol.inline-task-list")).forEach(e=>kl(e))}}e.addCommand("InsertInlineTaskListNoToggle",()=>(xl(Al(e))||n(),!1)),e.addCommand("InsertInlineTaskList",n),e.on("BeforeExecCommand",t=>{"InsertUnorderedList"===t.command&&xl(Al(e))&&!t.value?e.undoManager.ignore(()=>{e.execCommand("InsertOrderedList"),kl(Al(e))}):"InsertOrderedList"!==t.command||t.value||e.undoManager.ignore(()=>{kl(Al(e))})}),e.on("execCommand",e=>{"Indent"===e.command&&t()}),e.on("Click",(function(t){var n=t.target;if("LI"===n.tagName){var o=e.dom.getParent(n,"ul,ol");"UL"===o.tagName&&e.dom.hasClass(o,"inline-task-list")&&function(t,n){var o,r;if(s.tinymce.Env.gecko){var a=n.getBoundingClientRect();o=t.pageX-(a.left+s.tinymce.DOM.getViewPort(e.getWin()).x),r=t.pageY-(a.top+s.tinymce.DOM.getViewPort(e.getWin()).y)}else o=t.offsetX,r=t.offsetY;return o>=3&&o<=14&&r>=3&&r<=14}(t,n)&&(e.dom.hasClass(n,"checked")?e.dom.removeClass(n,"checked"):e.dom.addClass(n,"checked"))}})),e.on("KeyUp",(function(t){if(t.keyCode===s.tinymce.util.VK.ENTER&&!t.shiftKey){var n=(o=e.selection.getStart())&&o.tagName&&"LI"===o.tagName.toUpperCase()?o:e.dom.getParent(o,"li");if(n){if(e.dom.removeClass(n,"checked"),!n.parentNode)return;e.dom.hasClass(n.parentNode,"inline-task-list")?n.setAttribute("data-inline-task-id",""):n.removeAttribute("data-inline-task-id")}}var o})),e.on("KeyDown",e=>{e.shiftKey||e.keyCode!==s.tinymce.util.VK.TAB||s.tinymce.util.VK.metaKeyPressed(e)||t()}),Object(y.a)("confluence.editor.registerHandlers",o),Object(y.a)("rte-ready",r),Ee(s.document,"postPaste",a),e.on("Remove",()=>{Object(y.c)("confluence.editor.registerHandlers",o),Object(y.c)("rte-ready",r),Te(s.document,"postPaste",a)})}))},()=>{Object(dt.a)("confluence-editor/autoformat",()=>({handlerManager:zn,createHandler:Pn})),Object(y.a)("init.rte",Fn)},function(){s.tinymce.create("tinymce.plugins.DeleteCommandPlugin",{init(e){e.addCommand("mceDelete",(t,n)=>(function(){if(s.tinymce.Env.webkit){var t=e.selection.getRng();if(!t||t.collapsed)return!1;var n=c()(t.startContainer).closest(".wysiwyg-macro-body",e.getBody())[0];if(n&&ho.isRangeAtStartOf(n,t)&&ho.isRangeAtEndOf(n,t)){var o=c()(n.firstChild).is("pre")?"pre":"p",r=c()(`<${o}><br data-mce-bogus="1"></${o}>`)[0];return c()(n).html(r),e.selection.select(r,!0),!0}}return!1}()||e.getDoc().execCommand("Delete",t),!1))},getInfo:()=>({longname:"Delete Command Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})}),s.tinymce.PluginManager.add("deletecommand",s.tinymce.plugins.DeleteCommandPlugin)},function(){},function(){var e,t,n=(e=d.a.Raphael,t=new s.tinymce.util.Dispatcher,{AUIWindowManager:{init:e=>{e.on("init",()=>{e.windowManager=new s.tinymce.AUIWindowManager(e)})},getInfo:()=>({longname:"AUIWindowManager",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})},WindowManager:{AUIWindowManager:function(e){var n=this;n.eventDispatcher=t,n.editor=e,n.params={},n.features={},n.modalDialogsStack=[],n.dialogs={},n.count=0,n.tinymceWM=e.windowManager},open(e,t){var n=this;if(e.title===n.editor.translate("Accessibility Checker"))return n.tinymceWM.open(e,t);e=e||{},n.initialiseSettings(e),t=t||{},(t=this.setDefaultParameters(t)).mce_width=e.width,t.mce_height=e.height,t.mce_auto_focus=e.auto_focus,n.features=e,n.params=t,n.eventDispatcher.dispatch("open",{t:n,settings:e,params:t});var o=e.height;e.name&&(o+=56),(t.cancelLink||t.buttons)&&(o+=51),o+=40,e.popup&&(o+=8);var r=e.id||s.tinymce.DOM.uniqueId(),a=(new st).component({width:e.width,height:o,id:r,onCancel:()=>{a.hide().remove()}});e.name&&a.addHeader(this.editor.translate(e.name)),this.createDialogButtons(a,t,r),e.file=e.file||e.url,e.file&&(e.file=e.file),this.createDialogContent(a,e,t,r),t.helpLink&&this.createHelpLink(a,t.helpLink,t.helpName,r),t.hintText&&this.createHintText(a,t.hintText,r);var i={id:r,settings:e,params:t,dialog:a};return this.modalDialogsStack.push(i),this.dialogs[r]=i,this.count++,nt(),a.show(),null!=a.takeFocus&&a.takeFocus(),r},initialiseSettings:e=>{e.width=parseInt((e.width||400).toString(),10),e.height=parseInt((e.height||250).toString(),10),e.resizable=!1,null==e.popup&&(e.popup=!0),e.popup&&null!=e.content&&(e.popup=!1),e.scrollbars?e.scrollbars="yes":e.scrollbars="no"},createDialogButtons(e,t,n){if(t.buttons)for(var o=0;o<t.buttons.length;o++){var r=t.buttons[o];e.addButton(this.editor.translate(""+r.label),r.action)}t.cancelLink&&e.addCancel(this.editor.translate("auiwindowmanager.cancel"),()=>s.tinymce.activeEditor.windowManager.close(n))},createDialogContent(e,t,n,o){var r=this.createContentId(o),a="panel_"+r;t.popup?(e.addPanel(a,c()(`<iframe id="${r}" width="100%" height="${t.height}px" frameborder="0" name="auidialogiframe" src="${t.file}" scrolling="${t.scrollbars}"></iframe>`),n.cssClass),e.takeFocus=()=>{c()("#"+r).focus()}):(null==t.content?(e.addPanel(a,c()(`<div id="${r}"/>`),n.cssClass),c()("#"+r).load(t.file)):e.addPanel(a,c()(`<div id="${r}">${t.content}</div>`),n.cssClass),e.takeFocus=()=>{var e=c()(`#${r}:input`);if(e.length)c()(e[0]).focus();else{var t=c()(`#${r} .button-panel button`);t.length&&c()(t[0]).focus()}}),e.gotoPanel(0,0)},createHintText:(e,t,n)=>{var o=c()("<div></div>").addClass("dialog-tip");o.text(s.tinymce.activeEditor.translate(""+t)),c()(`#${n} .dialog-button-panel`).append(o)},createHelpLink:(e,t,n,o)=>{var r=c()("<div></div>").addClass("dialog-help-link");r.load(w.a+"/plugins/tinymce/helplink.action",{linkUrlKey:t,linkNameKey:n||""}),c()(`#${o} .dialog-components .dialog-title`).prepend(r)},close(e,t){var n,o;return"string"==typeof e?n=e:t?n=t:(o=this.modalDialogsStack.pop())&&(n=o.id),this.dialogs[n]&&(this.count--,(o=this.dialogs[n]).dialog.remove(),this.dialogs[n]=null,s.tinymce.activeEditor.focus(),ot()),!1},alert(e,t,n){if("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."!==e){var o={content:`<p>${e}</p>`,width:500,height:160,popup:!1},r={buttons:[{label:"auiwindowmanager.ok",action:function(){s.tinymce.activeEditor.windowManager.toggleOtherDialogs(a,!0),s.tinymce.activeEditor.windowManager.close(a),t&&t.call(n||this)}}],cancelLink:!1,cssClass:"tinymce-auidialog-alert"},a=this.open(o,r);this.toggleOtherDialogs(a,!1)}},createInstance:(e,t,n,o,r,a)=>new(s.tinymce.resolve(e))(t,n,o,r,a),toggleOtherDialogs(e,t){for(var n=0;n<this.modalDialogsStack.length;n++){var o=this.modalDialogsStack[n];o.id!=e&&c()(o.id+" .dialog-button-panel").toggle(t)}},confirm(e,t,n,o){o=o||d.a,t.call(n||this,o.confirm(this._decode(this.editor.translate(e))))},setBusy(t,n){var o=this.dialogs[t],r="#"+this.createBusyContentId(t),a="#"+this.createContentId(t),i=c()(a),l=c()(r);if(o)if(n){var s=c()(a);s.hide();var d=s.parent(),u=c()(r,d);u.length||(d.append(c()(`<div id="${r}" class="spinner"></div>`)),u=c()(r,d),e.spinner(u[0],50,"#666")),c()(".button-panel button",c()("#"+t)).each((e,t)=>{c()(t).prop("disabled",!0)}),c()(u[0]).show()}else l.length&&l.hide(),c()(".button-panel button",c()("#"+t)).each((e,t)=>{c()(t).prop("disabled",!1)}),i.show()},logMCESelection:e=>{s.tinymce.activeEditor.selection},setDefaultParameters:e=>(e.inline=!1,e.cssClass||(e.cssClass="tinymce-auidialog"),0!=e.cancelLink&&(e.cancelLink=!0),e),createContentId:e=>"content_"+e,createBusyContentId:e=>"content_busy_"+e,resizeBy:()=>{}}});s.tinymce.create("tinymce.plugins.AUIWindowManager",n.AUIWindowManager),s.tinymce.create("tinymce.AUIWindowManager:tinymce.WindowManager",n.WindowManager),s.tinymce.PluginManager.add("auiwindowmanager",s.tinymce.plugins.AUIWindowManager)},function(){var e;e=Ti(),s.Confluence.PropertyPanel.TextPlaceholder=e,Object(y.a)("init.rte",()=>{"template"===g.a.get("content-type")&&Object(y.b)("add-handler.property-panel",e)}),s.tinymce.create("tinymce.plugins.TextPlaceholderPlugin",Di()),s.tinymce.PluginManager.add("textplaceholders",s.tinymce.plugins.TextPlaceholderPlugin)},function(){s.tinymce.create("tinymce.plugins.EmotionsPlugin",{init(e,t){e.addCommand("mceEmotion",()=>(e.windowManager.open({file:s.tinymce.settings.editor_plugin_action_base_path+"/emotions.action",width:190,height:125,inline:1,id:"insert-emoticon-dialog",name:"emotions_dlg.title"},{plugin_url:t}),!1)),e.ui.registry.addButton("emotions",{text:"emotions.emotions_desc",onAction:function(){e.execCommand("mceEmotion")}}),e.on("Click",t=>{var n,o=t.target;if("IMG"===o.nodeName&&o.classList.contains("emoticon"))return(n=e.selection.getRng())&&((t.offsetX||t.layerX-o.x)<o.width/2?(n.setStartBefore(o),n.setEndBefore(o)):(n.setStartAfter(o),n.setEndAfter(o)),e.selection.setRng(n)),e.selection.collapse(),s.tinymce.dom.Event.cancel(t)})},getInfo:()=>({longname:"Emotions",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/emotions",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})}),s.tinymce.PluginManager.add("emotions",s.tinymce.plugins.EmotionsPlugin)},function(){s.tinymce.create("tinymce.plugins.ConfluencePlugin",{init(e){e.addCommand("mceConfUnlink",(t,n)=>{var o=e.selection,r=n||o.getNode(),a=c()(r);if("A"!==r.nodeName){var i=a.closest("a");if(!i.length)return!1;r=i[0],a=i}var l,d,u=a.attr("href");if(u||(u="#",a.attr("href",u)),!a.attr("data-linked-resource-id")&&s.Confluence.Link.isExternalLink(u)&&a.text()==(null!=(d=/(.*)[/]$/.exec(l=u))?d[1]:l)){var g=e.dom.create("span",{class:"nolink"},u);e.dom.replace(g,r,!1)}else o.select(r),a.removeClass("createlink unresolved"),e.execCommand("UnLink");return!1}),e.ui.registry.addButton("confimage",{text:"confluence.confimage_desc",onAction:function(){e.execCommand("mceConfimage")}}),e.ui.registry.addButton("conf_macro_browser",{text:"confluence.conf_macro_browser_desc",onAction:function(){e.execCommand("mceConfMacroBrowser")}})},getInfo:()=>({longname:"Confluence TinyMCE Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})}),s.tinymce.PluginManager.add("confluence",s.tinymce.plugins.ConfluencePlugin)},function(){var e;s.tinymce.create("tinymce.plugins.MacroPlaceHolderPlugin",(e=s.tinymce.util.VK,{init(t){var n=this;function o(e){t.on("KeyDown",e),s.tinymce.isGecko&&(t.on("KeyPress",e),t.on("KeyUp",e))}function r(e,t){return e&&1===e.childNodes.length&&c()(e).is(t)&&c()(e.firstChild).is("br")}function a(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;if(!t||!t.parentNode)return!1;for(;t&&!c()(t).is(".wysiwyg-macro-body");){if(t.previousSibling||t.nextSibling)return!1;t=t.parentNode}return!0}t.on("Init",()=>{t.on("SetContent",e=>{e.selection&&s.tinymce.each(t.dom.select("p > .wysiwyg-macro"),e=>{var n=t.dom.getParent(e.parentNode,"p");try{t.dom.split(n,e)}catch(e){}})})}),t.on("SetContent",()=>{s.tinymce.each(t.dom.select('.wysiwyg-macro[data-macro-body-type="PLAIN_TEXT"] .wysiwyg-macro-body'),e=>{t.dom.select("pre",e).length||t.dom.setHTML(e,"<pre><br /></pre>")})}),t.on("KeyDown",n=>{var o=t.selection,r=[e.BACKSPACE,e.DELETE,e.ENTER,e.ESCAPE];if(-1==c.a.inArray(n.keyCode,r)&&!function(t){var n=!1;return 0===t.charCode&&(n=-1!=c.a.inArray(t.keyCode,[e.SHIFT,e.CTRL,e.ALT,e.META])),n}(n)&&!o.isCollapsed()&&!(n.ctrlKey||n.metaKey||!s.tinymce.isMac&&n.altKey)){var a=o.getNode();if(Jt.isMacroWithBody(a)){var i=c()(".wysiwyg-macro-body",a);i.length>0&&o.select(i[0],!0)}}}),t.on("DblClick",e=>{var t=c()(e.target),n=t.closest("[data-macro-name]");if(n.length){if(n.attr("data-macro-body-type")&&t.closest(".wysiwyg-macro-body").length)return;Jt.editMacro(n),s.Confluence.PropertyPanel&&s.Confluence.PropertyPanel.current&&s.Confluence.PropertyPanel.destroy()}}),t.addCommand("mceConfRemoveMacro",e=>{c()(e).remove(),s.tinymce.isGecko&&t.execCommand("mceRepaint",!1)}),n._isCursorInMostNestedElement=a,function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return t&&t.previousSibling&&!t.nextSibling&&r(t,"p, pre")}(s.tinymce.isWebKit||s.tinymce.isGecko)&&o(n=>{var o=t.selection.getRng();if(46===n.keyCode&&o&&e(o))return s.tinymce.dom.Event.cancel(n)}),n._isCursorInLastParagraphOrPre=e}(),s.tinymce.isWebKit&&o(e=>{if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng();if(!n)return!0;var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!(function(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return a(e)&&t&&1===t.childNodes.length&&c()(t.firstChild).is("br")}(n)&&(8!==e.keyCode||!c()(o).is("li")))||s.tinymce.dom.Event.cancel(e)}),function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return t&&0===e.startOffset&&c()(t).is(".wysiwyg-macro-body > ul > li")&&1===t.childNodes.length&&c()(t.firstChild).is("br")}s.tinymce.isWebKit&&o(n=>{var o=t.selection.getRng();return 8!==n.keyCode||!o||!e(o)||(t.execCommand("Outdent"),s.tinymce.dom.Event.cancel(n))}),n._isCursorInsideMacroPlacholderInsideListItemContainingSoloBr=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return 0===e.startOffset&&r(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&t&&!t.previousSibling&&t.nextSibling&&r(t.nextSibling,"p, pre")}s.tinymce.isWebKit&&o(n=>{var o=t.selection.getRng();if(46!==n.keyCode||!o)return!0;var r=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,a=c()(r);if(e(o)){var i=r.nextSibling;return a.remove(),t.selection.select(i,!0),s.tinymce.dom.Event.cancel(n)}}),n._isCursorInFirstParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return 0===e.startOffset&&r(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&t&&!t.nextSibling&&t.previousSibling&&!t.previousSibling.previousSibling&&r(t.previousSibling,"p, pre")}s.tinymce.isWebKit&&o(n=>{var o=t.selection.getRng();if(8!==n.keyCode||!o)return!0;var r=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,a=c()(r);if(e(o)){var i=r.previousSibling;return a.remove(),t.selection.select(i,!0),s.tinymce.dom.Event.cancel(n)}}),n._isCursorInSecondParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){if(!e||!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return!(!t||e.startOffset>0)&&(Qt.normalize(t),t&&0===e.startOffset&&r(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&!t.previousSibling&&!t.nextSibling)}(s.tinymce.isWebKit||s.tinymce.isGecko)&&o(n=>8!==n.keyCode&&46!==n.keyCode||(e(t.selection.getRng())?s.tinymce.dom.Event.cancel(n):void 0)),n._isCursorInSoloParagraphOrPreInsidePlaceholder=e}(),function(){function e(e){return e&&e.parentNode&&"BR"===e.nodeName&&e===e.parentNode.lastChild}function r(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&0===t.startOffset&&3===n.nodeType&&a(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function i(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&1===t.startOffset&&3===n.nodeType&&a(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function l(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&0===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&a(e)&&!t.previousSibling&&!t.nextSibling}function d(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&1===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&a(e)&&!t.previousSibling&&!t.nextSibling}(s.tinymce.isWebKit||s.tinymce.isGecko)&&o(e=>{if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng();if(!n)return!0;var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!c()(o).closest(".wysiwyg-macro-body").size()||(Qt.normalize(o),!(46===e.keyCode&&(r(n)||l(n))||8===e.keyCode&&(i(n)||d(n)))||(o.lastChild&&!c()(o.lastChild).is("br")&&c()(o).append("<br/>"),c()(o.firstChild).remove(),t.selection.select(o,!0),s.tinymce.dom.Event.cancel(e)))}),n._isCursorBehindOnlyCharacterInNestedElement=r,n._isCursorAfterOnlyCharacterInNestedElement=i,n._isCursorBehindOnlyChildInNestedElement=l,n._isCursorAfterOnlyChildInNestedElement=d}(),function(){function e(e){return!e.collapsed&&(0===e.startOffset&&r(e.startContainer,(function(e){return!e.previousSibling}))&&(t=e.endContainer,n=e.endOffset,!!t&&(3===t.nodeType?n===t.nodeValue.length:1===t.nodeType&&(1===t.childNodes.length&&c()(t.firstChild).is("br")?0===n:n===t.childNodes.length)))&&r(e.endContainer,(function(e){return!e.nextSibling})));var t,n}function r(e,t){if(!e)return!1;if(c()(e).is(".wysiwyg-macro-body"))return!0;do{if(!t(e))return!1;e=e.parentNode}while(e&&!c()(e).is(".wysiwyg-macro-body"));return!0}s.tinymce.isWebKit&&o(n=>{if(8!==n.keyCode&&46!==n.keyCode)return!0;var o=t.selection.getRng();if(o&&e(o)){var r=c()(o.startContainer).closest(".wysiwyg-macro-body");if(r.length>0){var a,i=c()(r[0].firstChild).is("pre");return t.undoManager.add(),r.empty(),a=i?c()("<pre><br/></pre>").appendTo(r):c()("<p><br/></p>").appendTo(r),t.selection.select(a[0],!0),s.tinymce.dom.Event.cancel(n)}}return!0}),n._isMacroBodySelected=e}(),function(){function e(e){if(!e||!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return 0===e.startOffset&&r(t,"p")&&n.next().is("table")}s.tinymce.isWebKit&&o(n=>{if(46===n.keyCode&&e(t.selection.getRng()))return s.tinymce.dom.Event.cancel(n)}),n._isCursorInEmptyParagraphPrecedingPlaceholder=e}(),function(){function r(e){return e?3===e.nodeType?e:r(e.firstChild)||r(e.nextSibling):null}function a(e){return e&&"PRE"!==e.nodeName&&"TD"!==e.nodeName?"BR"===e.nodeName?e:a(e.previousSibling)||a(e.parentNode):null}function i(e){var t,n;return c()(e.commonAncestorContainer).closest(".wysiwyg-macro td").length>0&&(a(e.startContainer)||(t=r(function e(t){return!t||c()(t.parentNode).is(".wysiwyg-macro td")?null:c()(t.parentNode).is("p")?t.parentNode:e(t.parentNode)}(e.startContainer)))),(n=c()(e.commonAncestorContainer).closest(".wysiwyg-macro td > pre")).length>0&&(a(e.startContainer)||(t=r(n[0]))),t&&(e=e.cloneRange()).setStart(t,0),e}s.tinymce.isWebKit&&s.tinymce.isMac&&o(n=>{var o=t.selection.getRng();if(o&&(n.metaKey||n.ctrlKey)&&n.shiftKey&&n.keyCode===e.LEFT){var r=i(o);if(r!==o)return t.selection.setRng(r),s.tinymce.dom.Event.cancel(n)}}),n._selectTillStart=i}(),t.on("KeyDown",e=>{if(e.keyCode===s.tinymce.util.VK.TAB){var n=t.selection.getRng();if(n){var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;if(c()(o).is(".wysiwyg-macro-body > pre")){t.undoManager.beforeChange(),t.undoManager.add();var r=t.getDoc().createTextNode("\t");return n.insertNode(r),t.selection.setCursorLocation(r,1),t.undoManager.add(),s.tinymce.dom.Event.cancel(e)}}}},!0)},getInfo:()=>({longname:"Macro Place Holder plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"})})),s.tinymce.PluginManager.add("macroplaceholder",s.tinymce.plugins.MacroPlaceHolderPlugin)},function(){Ee(s.document,"initContextToolbars.Toolbar",()=>{Zr().initContextToolbars(),function(e){var t={},n={},o=function(e,n){var o,r;for(r in t)if(t.hasOwnProperty(r)&&t[r].isEnabled)for(var a=0,i=t[r].events.length;a<i;a++)(o=t[r].events[a]).type.toLowerCase().indexOf(n.type)>-1&&(o.shouldTrigger(e,n)?o.callback.apply(this,[n.target]):o.missed&&o.missed())};return{addEventsForComponent(r,a){r in t||(t[r]={},t[r].events=[],t[r].isEnabled=!0);for(var i=function(i,l){var c;!(a[i].type in n)&&(n[a[i].type]=!0,e[a[i].type].add(o)),"function"!=typeof a[i].shouldTrigger&&(c=a[i].shouldTrigger,a[i].shouldTrigger=function(e,t){return t.target.tagName.toLowerCase()==c}),t[r].events.push(a[i])},l=0,c=a.length;l<c;l++)i(l)},disableEventsForComponent(e){for(var n=0,o=t.length;n<o;n++)if(e in t)return t[e].isEnabled=!1,!0;return!1},enableEventsForComponent(e){for(var n=0,o=t.length;n<o;n++)if(e in t)return t[e].isEnabled=!0,!0;return!1}}}(s.tinymce).addEventsForComponent("TableToolbar",qr)})},function(){Jr(),s.tinymce.create("tinymce.plugins.customtoolbar",Yr()),s.tinymce.PluginManager.add("customtoolbar",s.tinymce.plugins.customtoolbar)},function(){s.tinymce.create("tinymce.plugins.InsertWikiMarkupPlugin",Ma),s.tinymce.PluginManager.add("insertwikimarkup",s.tinymce.plugins.InsertWikiMarkupPlugin)},()=>{s.tinymce.create("tinymce.plugins.PropertyPanel",ji()),s.tinymce.PluginManager.add("propertypanel",s.tinymce.plugins.PropertyPanel)},function(){},function(){s.tinymce.create("tinymce.plugins.ConfMonospacePlugin",{init:e=>{e.addCommand("confMonospace",()=>(e.formatter.toggle("monospace",void 0),!1)),e.on("Init",()=>{e.formatter.register({monospace:{inline:"code"}}),e.editorCommands.addCommands({confMonospace:function(){return e.formatter.match("monospace")}},"state")}),e.ui.registry.addButton("monospace",{text:"monospace",onAction:function(){e.execCommand("confMonospace")}})},getInfo:()=>({longname:"Monospace Formatting",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})}),s.tinymce.PluginManager.add("confmonospace",s.tinymce.plugins.ConfMonospacePlugin)},function(){i.a.PluginManager.add("confcharmap",go)},function(){s.tinymce.create("tinymce.plugins.iOSEditing",{init(e){s.tinymce.Env.iOS&&setTimeout(()=>{c()(e.getBody()).addClass("ios")},0)},getInfo:()=>({longname:"iOS Comments Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})}),s.tinymce.PluginManager.add("iosediting",s.tinymce.plugins.iOSEditing)},()=>{s.tinymce.create("tinymce.plugins.aeTable",(T(c.a),{init(e){e.on("copy",()=>{!0===e.selection.isCollapsed()&&e.getBody().querySelectorAll("th[data-mce-selected],td[data-mce-selected]").length>1&&e.selection.select(e.selection.getNode())},!0),e.on("newcell",(function(e){var t=e.node;"TD"===t.nodeName?(t.classList.add("confluenceTd"),t.classList.remove("confluenceTh")):"TH"===t.nodeName&&(t.classList.add("confluenceTh"),t.classList.remove("confluenceTd"))})),e.on("BeforeExecCommand",(function(t){if(t.command.startsWith("mceTable")){var n=e.selection.getNode().closest("table");if(n&&n.classList.contains("wysiwyg-macro")){var o=n.closest("th.confluenceTh, td.confluenceTd");o?e.selection.setCursorLocation(o):t.preventDefault()}}})),O(e),E(e),k(e),b()?c()(window).one("rte-collab-ready",()=>{j(e)}):c()(window).one("rte-ready",()=>{j(e)})}})),s.tinymce.PluginManager.add("aeTable",s.tinymce.plugins.aeTable)},function(){var e=function(){var e=function(e){var t=this;e.on("Undo",()=>{t.cleanLinks(e)}),this.editor=e,this.weightedHandlers=[],this.handlers=[]};function t(e){for(var n=t.options,o=n.parser[n.strictMode?"strict":"loose"].exec(e),r={},a=14;a--;)r[n.key[a]]=o[a]||"";return r[n.q.name]={},r[n.key[12]].replace(n.q.parser,(e,t,o)=>(t&&(r[n.q.name][t]=o),"")),r}e.prototype={addHandler(e,t){this.weightedHandlers.push({handler:e,weight:t||0}),this.weightedHandlers.sort((e,t)=>e.weight-t.weight),this.handlers=[];for(var n=this.weightedHandlers.length,o=0;o<n;o++)this.handlers.push(this.weightedHandlers[o].handler)},cleanLinks:e=>(c()("a.atlassian-autoconvert",e.getDoc()).removeClass("atlassian-autoconvert"),!0),callHandlers(e){var o=0,r=this,a=c()(e),i=c()(e).clone(),l=i.attr("href"),u=t(n(l));function g(e){if(e&&(1!==e.length||!e.attr("href")))return m(e);if(e)o=0,u=t((i=e).attr("href")),f(r.handlers[o],u,i);else{if(!(++o<r.handlers.length))return m(i);f(r.handlers[o],u,i)}}function f(e,t,n){var o=g,a=d.a.setTimeout(()=>{o=function(){0},g()},s.tinymce.plugins.Autoconvert.callbackTimeout);e(t,n,(function(){clearTimeout(a),o.apply(r,arguments),o=function(){0}}))}function m(e){r.editor.undoManager.beforeChange();var t=r.editor.selection,n=r.editor.selection.getBookmark();a.replaceWith(e),t.moveToBookmark(n),r.editor.undoManager.add()}0!==this.handlers.length&&f(this.handlers[0],u,i)}},e.callbackTimeout=5e3,e.convertMacroToDom=function(e,t,n){var o={macro:e,contentId:g.a.get("content-id")};c.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:w.a+"/rest/tinymce/1/macro/placeholder",data:JSON.stringify(o),dataType:"text",success:t,error:n,timeout:45e3})},e.convertMacroToDomViaWikiText=function(t,n,o){var r=["{",t.name],a=!0;for(var i in t.defaultParameterValue&&(r.push(":",t.defaultParameterValue),a=!1),t.params)a?(r.push(":"),a=!1):r.push("|"),r.push(i,"=",t.params[i]);r.push("}"),e.getHtmlFromWikiMarkup(r.join(""),e=>{n(c()(e)[0])},()=>{o()})},e.getHtmlFromWikiMarkup=function(e,t,n){var o={wiki:e,entityId:g.a.get("content-id"),contextType:g.a.get("content-type"),spaceKey:g.a.get("space-key")};c.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:w.a+"/rest/tinymce/1/wikixhtmlconverter",data:JSON.stringify(o),dataType:"text",success:t,error:n,timeout:45e3})},t.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?))?((((?:[^?#/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@/]*@)([^:/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#/]*\.[^?#/.]+(?:[?#]|$)))*\/?)?([^?#/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var n=function(e){return e.replace(/^(.*?\/\/[^/]*?\/.*?)(@)/,"$1%40")},o={init(t){var n=new e(t);function o(e,o,r){var a=c()(r.node).children("a");1===a.length&&"A"===a[0].tagName&&a.text()===a.attr("href")&&(a.attr("class","atlassian-autoconvert"),setTimeout(()=>{var e=c()("a.atlassian-autoconvert",c()(t.selection.getNode().ownerDocument)).removeClass("atlassian-autoconvert");n.callHandlers(e)},0))}s.tinymce.plugins.Autoconvert.autoConvert=n,t.on("init",()=>{c()(document).on("postPaste",o),t.addCommand("addAutoconverter",(e,t)=>(n.addHandler(t),!1))}),t.on("remove",()=>{c()(document).off("postPaste",o)})},getInfo:()=>({longname:"Atlassian Autoconvert",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"})};return{autoConverter:e,plugin:o}}();s.tinymce.plugins.Autoconvert=e.autoConverter,s.tinymce.create("tinymce.plugins.AutoconvertPlugin",e.plugin),s.tinymce.PluginManager.add("autoconvert",s.tinymce.plugins.AutoconvertPlugin),Cn()},function(){Object(y.a)("rte-ready",Tn)},function(){s.tinymce.create("tinymce.plugins.draggable",Xr()),s.tinymce.PluginManager.add("draggable",s.tinymce.plugins.draggable)},function(){s.tinymce.create("tinymce.plugins.InsertFiles",{init(e){e.ui.registry.addButton("confluence-insert-files",{text:Object(Lt.a)("tinymce.confluence.files"),tooltip:`${Object(Lt.a)("tinymce.confluence.conf_file_desc")} (${e.translate("toolbar.insert_files_shortcut_tooltip")})`,className:"insert-files",icon:"aui-icon aui-icon-small aui-iconfont-image",locationGroup:"rte-toolbar-group-files",weight:0,onAction:function(){e.execCommand("mceConfimage")}})},getInfo:()=>({longname:"Insert Files",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"})}),s.tinymce.PluginManager.add("insertfiles",s.tinymce.plugins.InsertFiles)},function(){s.tinymce.create("tinymce.plugins.flextofullsizeplugin",{init(e){e.on("Init",()=>{c()(e.getBody()).addClass("fullsize")})},getInfo:()=>({longname:"flex editor to full size plugin",description:"adjusts height of editor so it always occupies the right space in between the toolbars",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"})}),s.tinymce.PluginManager.add("flextofullsize",s.tinymce.plugins.flextofullsizeplugin)},function(){s.tinymce.create("tinymce.plugins.Referrer",{init(e){e.on("Init",()=>{var e=c()("#createpageform"),t=e.find("#originalReferrer");e.length&&!t.val()&&document.referrer&&t.val(document.referrer)})},getInfo:()=>({longname:"Confluence Cancel Return Url",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})}),s.tinymce.PluginManager.add("referrer",s.tinymce.plugins.Referrer)},()=>{var e,t;s.tinymce.create("tinymce.plugins.TableContentWrapperPlugin",(e=["img:not(.editor-inline-macro, .emoticon)"].concat(["time.non-editable",".editor-inline-macro","a.confluence-link[data-linked-resource-type='userinfo']"]).concat([".wysiwyg-macro"]).join(","),t="<div class='content-wrapper'>",{init(n){function o(){c()(n.dom.select("table.confluenceTable:not(.wrapped)")).each((n,o)=>{c()(o).addClass("wrapped").find("> tbody > tr > th, > tbody > tr > td, > thead > tr > th").each((n,o)=>{var r=c()(o);!r.find("> .content-wrapper").length&&r.find(e).length&&r.wrapInner(t)})})}Object(y.a)("rte-ready",o),n.on("Remove",()=>{Object(y.c)("rte-ready",o)}),n.on("Change",()=>{var o=n.selection;function r(){return o.getBookmark()}function a(e){o.moveToBookmark(e),nt()}var i=o.getNode(),l=c()(i);if(i&&l.closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable").length){!function(e){var t=o.getRng();if(e.is("tr")&&t&&c()(t.startContainer).is("tr")&&t.collapsed){var n=e.find(">td, >th").first(),r=n.find(":first-child:not(.content-wrapper)")[0]||n[0].firstChild;t.setStart(r,0),t.setEnd(r,0),o.setRng(t)}}(l);var s,d=l.closest("table.confluenceTable > tbody > tr > th, table.confluenceTable > tbody > tr > td, table.confluenceTable > thead > tr > th");if(d.find(e).length){var u=d.find("> .content-wrapper");u.length?(s=r(),function(e){for(var t=0;t<e.length;t++)e.eq(t).find("> p, > table, > ul, > ol").length||e.eq(t).wrapInner("<p/>"),t>0&&(e.eq(0).append(e.eq(t).children()),e.eq(t).remove())}(u),a(s)):d.find("> p").length?(s=r(),d.wrapInner(t),a(s)):(s=r(),d.wrapInner("<p/>").wrapInner(t),a(s))}}c()(n.getWin().document).find(".content-wrapper:empty").remove()})},getInfo:()=>({longname:"Table Content Wrapper Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"})})),s.tinymce.PluginManager.add("tableContentWrapper",s.tinymce.plugins.TableContentWrapperPlugin)},function(){var e;s.tinymce.create("tinymce.plugins.LinkBrowser",(e=s.Confluence.Editor.LinkBrowser,{init:t=>{t.ui.registry.addButton("linkbrowserbutton",{text:"confluence.conflink_desc",className:"mce_conflink",onAction:function(){t.execCommand("mceConflink")}}),t.addCommand("mceConflink",()=>(e.open({bookmarkManager:it}),!1)),t.addCommand("mceConfAttachments",()=>(e.open({panelKey:e.ATTACHMENTS_PANEL,bookmarkManager:it}),!1))},getInfo:()=>({longname:"Confluence Link Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})})),s.tinymce.PluginManager.add("linkbrowser",s.tinymce.plugins.LinkBrowser)},function(){s.tinymce.create("tinymce.plugins.ConfluenceVersionComment",{init(e){e.on("Init",()=>{var e=g.a.get("version-comment");c()("#rte-savebar-tinymce-plugin-point").append(((e,t)=>`\n<span class="rte-toolbar-comment toolbar-item">\n    <input id="versionComment" name="versionComment" ${t?`value="${t}"`:""}\n           placeholder="${e("editor.change.comment")}"\n           class="text" type="text" size="35">\n    <label for="versionComment" class="assistive">${e("editor.change.comment")}</label>\n</span>\n`)(e=>Object(Lt.a)(e),e))})},getInfo:()=>({longname:"Confluence Version Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})}),s.tinymce.PluginManager.add("confluenceversioncomment",s.tinymce.plugins.ConfluenceVersionComment)},()=>{s.tinymce.PluginManager.add("autocomplete",jt)},function(){},()=>{s.tinymce.PluginManager.add("autocompletelink",Ht)},function(){s.tinymce.create("tinymce.plugins.AutoCompleteMacro",{init(){qt()},getInfo:()=>({longname:"Auto Complete Macro",author:"Atlassian",authorurl:"http://www.atlassian.com",version:`${s.tinymce.majorVersion}.${s.tinymce.minorVersion}`})}),s.tinymce.PluginManager.add("autocompletemacro",s.tinymce.plugins.AutoCompleteMacro)},()=>{s.tinymce.PluginManager.add("autocompletemedia",sn)},function(){c()(document).ready(gl)},function(){s.tinymce.create("tinymce.plugins.ConfluenceLeaveComment",ka),s.tinymce.PluginManager.add("confluenceleavecomment",s.tinymce.plugins.ConfluenceLeaveComment)},function(){s.tinymce.create("tinymce.plugins.ConfluenceLeaveTemplate",Ea),s.tinymce.PluginManager.add("confluenceleavetemplate",s.tinymce.plugins.ConfluenceLeaveTemplate)},function(){_i(),s.tinymce.create("tinymce.plugins.AtlassianSearchReplacePlugin",Ri()),s.tinymce.PluginManager.add("searchreplace",s.tinymce.plugins.AtlassianSearchReplacePlugin)},function(){s.tinymce.create("tinymce.plugins.ConfluenceDrafts",fo()),s.tinymce.PluginManager.add("confluencedrafts",s.tinymce.plugins.ConfluenceDrafts)},Za,()=>{var e,t,n,o;s.tinymce.PluginManager.add("pagelayoutplugin",si),di(),e=e=>!!e.querySelector(".contentLayout, .contentLayout2"),t=e=>Array.from(e.querySelectorAll(".contentLayout2 .columnLayout.single")),n=(e,t)=>{e.undoManager.ignore(()=>{t.forEach(t=>t.appendChild((e=>e.dom.create("div",{class:"pagelayout-delete-stub synchrony-exclude",style:"display:none;",contenteditable:"true"},"."))(e)))})},o=(e,t)=>{var n=Array.from(t.querySelectorAll(".pagelayout-delete-stub"));e.undoManager.ignore(()=>{n.forEach(e=>e.parentNode&&e.parentNode.removeChild(e))})},Object(y.a)("rte-ready",()=>{var r=s.tinymce.activeEditor,a=r.getDoc(),i=r.getBody();i.addEventListener("keydown",o=>{if((8===o.keyCode||46===o.keyCode)&&e(a))if(r.dom.isEmpty(r.getBody()))o.stopImmediatePropagation();else{var i=t(a);i.length>0&&(n(r,i),o.stopImmediatePropagation())}},!0),i.addEventListener("keyup",t=>{8!==t.keyCode&&46!==t.keyCode||!e(a)||o(r,a)},!0),r.on("beforeExecCommand",o=>{if("delete"===o.command&&e(a)){var i=t(a);i.length>0&&n(r,i)}}),r.on("ExecCommand",t=>{"delete"===t.command&&e(a)&&o(r,a)}),r.on("BeforeGetContent",()=>{o(r,a)})})},function(){},function(){s.tinymce.create("tinymce.plugins.ConfluenceMacroBrowser",Da),s.tinymce.PluginManager.add("confluencemacrobrowser",s.tinymce.plugins.ConfluenceMacroBrowser)},function(){s.tinymce.PluginManager.add("statusmacro",el),s.Confluence.PropertyPanel.Macro.registerInitHandler((e,t)=>{var n,o;zi=e,function(e){var t=function(e){for(var t=0;t<e.length;t++)if(e[t].className.indexOf("macro-placeholder-property-panel-edit-button")>-1)return e[t];return null}(e),n=function(e){Jt.editMacro(e)};t&&(t.click=function(){s.Confluence.PropertyPanel.destroy(),Gi()?Hi.always(n):n(zi)})}(t),Fi=s.Confluence.MacroParameterSerializer.deserialize(c()(zi).attr("data-macro-parameters")),Ui=null,t.splice(1,0,(n=(o=Fi).title||qi(o),{className:"status-macro-title first last editable",text:mt(n),click:Xi}))},"status"),c.a.each($i,(e,t)=>{s.Confluence.PropertyPanel.Macro.registerButtonHandler(t,(function(){Fi.colour=t,s.Confluence.PropertyPanel.destroy()}),"status")}),Object(y.a)("destroyed.property-panel",()=>{Gi()&&Ji()})},function(){},function(){},function(){},function(){s.AJS.MacroBrowser.Macros.code=ao},function(){},()=>{s.tinymce.create("tinymce.plugins.ConfluenceWatch",Vl),s.tinymce.PluginManager.add("confluencewatch",s.tinymce.plugins.ConfluenceWatch)},()=>{s.tinymce.create("tinymce.plugins.ConfluenceSortableTablesPlugin",Wi),s.tinymce.PluginManager.add("confluencesortabletablesplugin",s.tinymce.plugins.ConfluenceSortableTablesPlugin)},function(){s.tinymce.create("tinymce.plugins.AutoResizePlugin",Un),s.tinymce.PluginManager.add("autoresize",s.tinymce.plugins.AutoResizePlugin)},function(){},function(){},()=>{s.tinymce.create("tinymce.plugins.ConfluenceNotifyWatchers",Ia),s.tinymce.PluginManager.add("confluencenotifywatchers",s.tinymce.plugins.ConfluenceNotifyWatchers)},function(){},function(){s.Confluence.PropertyPanel.Macro.registerButtonHandler("office-connector-download-file-button",(e,t)=>{for(var n=(t=t.nodeType?t:t[0]).getAttribute("data-macro-parameters").split("|"),o={},r=0;r<n.length;r++){var a=n[r].split("=");a.length>1&&(o[a[0]]=a[1])}var i=g.a.get("page-id"),l=g.a.get("content-type");function c(e,t,n){return e&&t&&("?"!=n.charAt(n.length-1)&&(n+="&"),n=`${n}${e}=${encodeURI(t)}`),n}o.space||(o.space=g.a.get("space-key"));var s=g.a.get("context-path")+"/plugins/servlet/oc/getattachment?";s=c("title",o.page,s),s=c("date",o.date,s),s=c("space",o.space,s),s=c("filename",o.name,s),s=c("contextid",i,s),s=c("contexttype",l,s);var d=window.open(s,"download-office-attachment");d&&d.opener&&(d.opener=null)}),Sa()},function(){Object(y.a)("rte-ready",()=>{!function(){Object(s.clearTimeout)(na),na=Object(s.setTimeout)(la,6e4);s.tinymce.activeEditor.on("ExecCommand",e=>{var t,n="mceToggleFormat"===e.command?(t=e.value).charAt(0).toUpperCase()+t.slice(1):e.command;ia(ca[n])}),s.tinymce.activeEditor.on("KeyPress",()=>{ia("keys")}),s.tinymce.activeEditor.on("KeyUp",e=>{46===e.keyCode?ia("delete",aa):8===e.keyCode&&ia("backspace",aa),aa=s.tinymce.activeEditor.selection.getContent().length}),s.tinymce.activeEditor.on("MouseUp",()=>{aa=s.tinymce.activeEditor.selection.getContent().length}),s.tinymce.activeEditor.on("PastePostProcess",e=>{var t=e&&e.node?e.node.innerText||e.node.textContent:"";ia("paste",t.length)}),s.tinymce.activeEditor.on("Remove",()=>{la(),Object(s.clearTimeout)(na)})}(),d.a.addEventListener("beforeunload",()=>{la()})})},function(){s.tinymce.create("tinymce.plugins.TableAnalytics",wl),s.tinymce.PluginManager.add("tableAnalytics",s.tinymce.plugins.TableAnalytics)},function(){Object(y.a)("init.rte",_n)},function(){Object(y.a)("init.rte",()=>{Te(s.document,"postPaste",sa),Ee(s.document,"postPaste",sa),s.tinymce.activeEditor&&s.tinymce.activeEditor.on("Remove",()=>{Te(s.document,"postPaste",sa)})})},function(){s.tinymce.create("tinymce.plugins.ConfIndentation",io),s.tinymce.PluginManager.add("confindentation",s.tinymce.plugins.ConfIndentation)},function(){},function(){s.tinymce.create("tinymce.plugins.TextPatternPlugin",Ol),s.tinymce.PluginManager.add("aetextpattern",s.tinymce.plugins.TextPatternPlugin)},function(){s.tinymce.Env.gecko&&Object(y.a)("rte-ready",Wn)},()=>{s.tinymce.create("tinymce.plugins.PersistScrollPosition",bi),s.tinymce.PluginManager.add("persit_scroll_position",s.tinymce.plugins.PersistScrollPosition)},function(){s.tinymce.create("tinymce.plugins.templateeditor",Dl),s.tinymce.PluginManager.add("templateeditor",s.tinymce.plugins.templateeditor)},()=>{s.tinymce.PluginManager.add("preserve-paragraph-formatting-on-delete",(function(e){return e.on("KeyDown",t=>{!function(e,t){var n,o,r=s.tinymce.VK,a=r.BACKSPACE,i=r.DELETE,l=e.selection.getNode(),c=l.nextSibling;if(e.selection.isCollapsed()&&l!=e.dom.getRoot())if(t.keyCode===a){if(n=e.selection,(o=n.getRng())&&0===o.startOffset){var d=l.previousSibling;d&&Si(d)&&(Oi(e,d),s.tinymce.dom.Event.cancel(t))}}else if(t.keyCode==i){if(Ii(l).length<=1||l.childNodes.length>1)return;c&&Si(l)&&(Oi(e,l),s.tinymce.dom.Event.cancel(t),function(e,t){var n=e.selection,o=n.getRng();e.focus(!1),t.focus(),o&&(o.setStart(t,0),o.setEnd(t,0),n.setRng(o))}(e,c))}}(e,t)}),{getMetadata:()=>({name:"Preserve paragraph formatting when deleting empty line",author:"Atlassian",url:"http://www.atlassian.com"})}}))},function(){s.tinymce.create("tinymce.plugins.macroNavigation",Ta),s.tinymce.PluginManager.add("macroNavigation",s.tinymce.plugins.macroNavigation)}],Kl=()=>($l.forEach((e,t)=>{try{e()}catch(n){Ql("initError",{fnName:e.name||t,message:n.message||"",exceptionName:n.name||""})}}),!0),Gl=()=>new Promise(e=>{!function(e,t){e.listener;var n=e.globalProperty,o=e.interval,r=void 0===o?250:o;if(ke(n))return t(),null;var a=setInterval(()=>{ke(n)&&(clearInterval(a),t())},r)}({listener:"editor-plugins/index",globalProperty:"AJS.Confluence.PropertyPanel.Macro",interval:20},()=>{e()})}),Yl=!1,Jl=()=>{if(Yl)return Ql("initError",{message:"Editor was loaded already, stop re-running init phase"}),Promise.reject();var e=d.a.tinymce;return e.VK=e.util.VK,e.confluence=e.confluence||{},s.tinymce.confluence=s.tinymce.confluence||{},s.tinymce.confluence.macrobrowser=Yt,Me(),s.tinymce.confluence=s.tinymce.confluence||{},s.tinymce.confluence.NodeUtils=Wt,s.tinymce.confluence=s.tinymce.confluence||{},s.tinymce.confluence.MacroUtils=Kt,r.a.EditorUtils=po,r.a.Rte=r.a.Rte||{},r.a.Rte.Cursor=r.a.Rte.Cursor||{},c.a.extend(r.a.Rte.Cursor,{insertParagraph:vo,isCursorAtStart:bo,isCursorAtEnd:ho.isCursorAtEnd}),Yl=!0,Gl().then(Kl)},ql=n(37),Zl=n.n(ql),Xl=""!==g.a.get("remote-user"),ec=gr("editor.ajax.save")&&!gr("editor.ajax.save.disable"),tc=()=>g.a.getBoolean("shared-drafts"),nc=null,oc=!1,rc=!1,ac=!1,ic=!1,lc=!1;Object(y.a)("editor-shared-drafts-published editor-shared-drafts-discarded",()=>{oc=!1,rc=!1}),Object(y.a)("synchrony.history.evicted",()=>{ic=!0}),Object(y.a)("synchrony.connected",()=>{lc=!0});var cc=(e,t,n)=>c()("<input>").attr({type:"hidden",name:e,value:t}).appendTo(n),sc=e=>{var t=e.getHours(),n=e.getMinutes(),o=t>11?"PM":"AM";return(0==(t%=12)?"12":t)+":"+(n<10?"0":"")+n+" "+o},dc=()=>oc,uc={isDraftManuallySaved:()=>rc,isDraftBlank:()=>r.a.Rte.Content.isEmpty()&&!s.Confluence.Editor.getCurrentTitle().trim(),isNewContent:()=>r.a.Rte.getEditor()&&g.a.getBoolean("new-page"),isDraftDirty:()=>s.Confluence.Editor.hasContentChanged()||dc()&&!s.Confluence.Editor.Drafts.isDraftManuallySaved(),unloadMessage:()=>{var e=()=>s.Confluence.Editor.Drafts.isDraftBlank()&&!tc()?s.Confluence.Editor.Drafts.discardDraft(g.a.get("draft-id")):s.Confluence.Editor.Drafts.save({skipErrorHandler:!0});if(s.Confluence.Editor.isLimitedModeEnabled()||!tc()){if(s.Confluence.Editor.hasContentChanged()||dc()&&!s.Confluence.Editor.Drafts.isDraftManuallySaved())return e(),Object(Lt.a)("saved.draft")}else if(e(),lc&&(ac||s.Confluence.Editor.hasContentChanged()||ic))return Object(Lt.a)("saved.shared.draft.leave.page")},hasPendingChanges:()=>ac,setPendingChanges:e=>ac=e,isSharedDraftsEnabled:tc,bindUnloadMessage:()=>{!s.Confluence.Editor.isLimitedModeEnabled()&&tc()&&(Object(y.a)("synchrony.entity.ack",(e,t)=>{t.pendingChanges||(ac=!1)}),Object(y.a)("editor.local.change",()=>{ac=!0})),Object(y.a)("beforeunload",s.Confluence.Editor.Drafts.unloadMessage)},unBindUnloadMessage:()=>Object(y.c)("beforeunload"),useDraft:()=>((e,t)=>{s.Confluence.Editor.Drafts.unBindUnloadMessage();var n=s.Confluence.Editor.getCurrentForm();cc(e,"true",n),cc("contentChanged",""+s.Confluence.Editor.hasContentChanged(),n),cc("pageId",r.a.params.pageId,n),c()("#draftId",s.Confluence.Editor.getCurrentForm()).val(t),n.spaceKey||cc("spaceKey",g.a.get("space-key"),n),n.action=w.a+"/pages/"+(r.a.params.newPage?"create":"edit")+r.a.params.draftType+".action",n.submit()})("useDraft",g.a.get("existing-draft-id")),discardDraft:e=>r.a.safe.ajax({url:`${w.a}/rest/api/content/${e}?status=draft`,type:"DELETE",dataType:"json",data:{},contentType:"application/json",success:()=>{c()("#draft-messages").remove(),r.a.messages.success("#editor-messages",{body:"Your draft has been discarded."})},error:e=>{r.a.messages.error({title:"Error",body:e.errors||"An unknown error has occurred. Please check your logs."})}}),save:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ic){if(s.Confluence.Editor.isPublishing()||!Br()&&!e.forceSave)return r.a.debug("skipping draft save because:"),void(s.Confluence.Editor.isPublishing()?r.a.debug("The user is publishing the page already."):Br()||e.forceSave||r.a.debug("The content hasn't changed and a forceSave wasn't requested in the options."));r.a.debug("preparing to save editor draft");var t=c()("#content-title"),n=c()("#newSpaceKey"),o=c()("#originalVersion"),a=s.Confluence.Editor.inRichTextMode(),i={draftId:g.a.get("draft-id"),pageId:g.a.get("page-id"),parentPageId:g.a.get("parent-page-id"),type:r.a.params.draftType,title:t.hasClass("placeholded")?"":t.val(),spaceKey:n.length?n.val():encodeURIComponent(g.a.get("space-key"))},l=()=>{o.length&&(i.pageVersion=parseInt(o.val(),10));nc=c.a.ajax({type:"POST",url:`${w.a}/rest/tinymce/1/drafts${e.ignoreRelations?"?ignoreRelations=true":""}`,data:JSON.stringify(i),contentType:"application/json",dataType:"text json",success:t=>{if(null!=t&&(!(Xl&&0===t.draftId)||!ec)){s.Confluence.Editor.contentHasChangedSinceLastSave=!1,a&&r.a.Rte.Content.editorResetContentChanged(),oc=!0,rc=!!e.manualSave,g.a.set("draft-id",t.draftId+""),c()("#draftId",s.Confluence.Editor.getCurrentForm()).val(t.draftId),c()("#draft-error").remove();var n=t.time||sc(new Date);if(!g.a.get("collaborative-content")){var o,i=c()("#draft-status");o=rc?Object(Lt.a)("draft.saved.at.new",n):Object(Lt.a)("draft.autosaved.at.new",n);var l=r.a.params.newPage?o:"<a id='view-diff-link-heartbeat' class='view-diff-link' href='#'>"+o+"</a>";i.attr("data-tooltip",o),i.html(l)}"function"==typeof e.onSuccessHandler&&e.onSuccessHandler(t),s.Confluence.Editor.Drafts.lastSaveTime=n,Object(y.b)("rte-draft-saved",{draftId:t.draftId})}},error:(t,n)=>{var o=()=>{s.Confluence.Editor.addErrorMessage("draft-error",s.Confluence.Editor.Drafts.lastSaveTime?Object(Lt.a)("draft.saving.error.previous.draft",s.Confluence.Editor.Drafts.lastSaveTime):Object(Lt.a)("draft.saving.error"),!0)};if(!e.skipErrorHandler&&!tc()){if(400===t.status)if(t.responseText.indexOf("Legacy drafts deprecated")>=0)fr.a.handleMessage("legacy-draft-deprecated",{type:"error",message:Object(Lt.a)("editor.page.legacy.draft.deprecated")});else if(t.responseText.indexOf("Unsupported character found in content: ")>=0){var r=t.responseJSON.message.split("Unsupported character found in content: ")[1];fr.a.handleMessage("utf8-validation-failed",{title:Object(Lt.a)("mysql.utf8.content.validation.failed.title"),type:"error",message:Object(Lt.a)("mysql.utf8.content.validation.failed.message",r)})}else o();else o();"function"==typeof e.onErrorHandler&&e.onErrorHandler(n)}},timeout:3e4}).always(()=>{nc=null})};Zl.a.getEditorContent().pipe(e=>{c.a.extend(i,e),l()})}},getDraftSavingPromise:()=>nc};function gc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function fc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gc(Object(n),!0).forEach((function(t){mc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pc,hc;n(83),n(84),n(85),n(86),n(87);i.a.confluenceEditorVersion="8.4.0",me(),Me(),void 0!==s.AJS.Rte&&void 0===s.AJS.Rte.BootstrapManager&&(s.AJS.Rte.BootstrapManager=xe),void 0!==s.AJS.Rte&&void 0===s.AJS.Rte.Placeholder&&(s.AJS.Rte.Placeholder=Ei),void 0!==s.AJS.Rte&&void 0===s.AJS.Rte.BookmarkManager&&(s.AJS.Rte.BookmarkManager=it),void 0!==(null===s.AJS||void 0===s.AJS?void 0:s.AJS.Confluence)&&void 0===(null===s.AJS||void 0===s.AJS||null===(pc=s.AJS.Confluence)||void 0===pc||null===(hc=pc.Editor)||void 0===hc?void 0:hc.Drafts)&&(s.AJS.Confluence.Editor.Drafts=uc),(()=>{var e,t,n;void 0!==(null===s.AJS||void 0===s.AJS?void 0:s.AJS.Confluence)&&void 0===(null===s.AJS||void 0===s.AJS||null===(e=s.AJS.Confluence)||void 0===e||null===(t=e.Templates)||void 0===t||null===(n=t.Editor)||void 0===n?void 0:n.Page)&&(s.AJS.Confluence.Templates.Editor=fc(fc({},s.AJS.Confluence.Templates.Editor),{},{Page:fc({},Ya)}))})(),Object(dt.a)("confluence-editor/loader/tinymce-bootstrap",()=>xe),Object(dt.a)("confluence-editor/editor/atlassian-editor",()=>p),Object(dt.a)("confluence-editor/editor/atlassian-editor-content",()=>h),Object(dt.a)("confluence-editor/utils/tinymce-node-utils",()=>Qt),Object(dt.a)("confluence-editor/init",()=>{Jl().then(()=>{var e={locale:g.a.get("user-locale").replace("_","-")};r.a.toInit(()=>{!function(e){s.tinymce.ThemeManager.requireLangPack("advanced"),s.tinymce.ThemeManager.add("default",ce),d.a.requestAnimFrame=d.a.requestAnimationFrame||d.a.webkitRequestAnimationFrame;var t=q();0===Number(t.page_id)&&(t.page_id=null,t.draft_type=g.a.get("draft-type")),xe.addBeforeInitCallback(e=>{e.contentCssTags=s.document.querySelector('script[title="editor-css"]').innerHTML,e.language=g.a.get("action-locale").replace("_","-");var t=g.a.get("min-editor-height");t&&(e.autoresize_min_height=t)});var n=!(g.a.get("remote-user")&&g.a.get("confluence.prefs.editor.disable.autocomplete"));if(n&&(t.plugins+=",autocomplete,autocompletelink,autocompletemedia"),t.locale="object"==typeof e&&void 0!==e.locale?e.locale:"",!!g.a.get("auto-start")){if(Object(y.b)("rte-loaded",{editPermission:!0}),b()){var o=s.document.getElementById(t.editor_id);Object(y.b)("rte-collaborative-content-ready",{title:g.a.get("page-title")||g.a.get("original-content-title")||"",editorContent:o.value,confRev:g.a.get("conf-revision"),syncRev:s.document.getElementById("syncRev").value,syncRevSource:g.a.get("sync-revision-source")})}ae("confluence.editor"),n&&(t.plugins+=",autocompletemacro");var r=""+g.a.get("page-id")=="0",a=function(e,t){if("template"===e)return le.createProfileForTemplateEditor();if("comment"===e)return le.createProfileForCommentEditor();var n={versionComment:!t,notifyWatchers:!t};return le.createProfileForPageEditor(n)}(g.a.get("content-type"),r).plugins.join(",");a&&(t.plugins+=","+a),xe.preInitialise(t),xe.initialise(),ie("confluence.editor")}else xe.preInitialise(t)}(e)})})})}],[[38,"runtime","vendors~core~page-layout","vendors~core~page-editor-quit-dialog","vendors~core","core~editor-notifications~page-editor-message~page-editor-quit-dialog","core~page-editor-message~page-editor-quit-dialog","core~page-editor-quit-dialog","core~editor-notifications"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:bookmark-manager-conf-frontend', location = 'bookmark/atlassian-editor-bookmark-manager.js' */
define("confluence-editor/atlassian-editor-bookmark-manager",["tinymce","ajs"],function(c,e){var b;return{storeBookmark:function(){var a=c.activeEditor,d=c.DOM.getViewPort(c.activeEditor.getWin());a.focus();a=a.selection.getRng();a=a.cloneRange&&"function"===typeof a.cloneRange?a.cloneRange():a.duplicate&&a.duplicate()||a;b={scrollX:d.x,scrollY:d.y,range:a};e.log("Storing bookmark");e.log(b)},restoreBookmark:function(){var a=c.activeEditor.selection,d=c.activeEditor.getWin();e.log("Restoring bookmark");
e.log(b);b&&(d.scrollTo(b.scrollX,b.scrollY),d.focus(),a.setRng(b.range));b=null}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/atlassian-editor-bookmark-manager","AJS.Rte.BookmarkManager");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:analytics', location = 'analytics/editor-ready-collab-mode-analytics.js' */
define("confluence-editor/analytics/editor-ready-collab-mode-analytics",["ajs","confluence/dark-features","confluence/meta"],function(a,d,b){return{trigger:function(){if(a.Rte&&a.Rte.getEditor()&&(a.$("#editpageform").length||a.$("#createpageform").length)){var c;c="confluence.editor.ready.collab.mode."+(d.isEnabled("site-wide.shared-drafts")?"on":"off");var e=b.get("synchrony-connection-order")?b.get("synchrony-connection-order"):"",f=b.get("synchrony-connection-type")?b.get("synchrony-connection-type"):
"";a.trigger("analyticsEvent",{name:c,data:{connectionOrder:e,connectionType:f}})}}}});require("confluence/module-exporter").safeRequire("confluence-editor/analytics/editor-ready-collab-mode-analytics",function(a){require("ajs").bind("rte-ready",function(){a.trigger()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:unpublished-changes', location = 'unpublished-changes/unpublished-changes.soy' */
// This file was automatically generated from unpublished-changes.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.UnpublishedChanges.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.UnpublishedChanges == 'undefined') { Confluence.Templates.UnpublishedChanges = {}; }


Confluence.Templates.UnpublishedChanges.lozenge = function(opt_data, opt_ignored) {
  return '<a id="unpublished-changes-lozenge" href="#" class="view-diff-link" title="' + soy.$$escapeHtml(opt_data.tooltip) + '"><span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle unpublished-changes-lozenge">' + soy.$$escapeHtml(opt_data.label) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.UnpublishedChanges.lozenge.soyTemplateName = 'Confluence.Templates.UnpublishedChanges.lozenge';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:unpublished-changes', location = 'unpublished-changes/unpublished-changes.js' */
define("confluence-editor/unpublished-changes/unpublished-changes",["jquery","confluence/legacy","ajs","underscore","tinymce"],function(c,a,g,i,h){return{init:function(e){var f=c(a.Templates.UnpublishedChanges.lozenge({tooltip:g.I18n.getText("editor.unpublished.changes.lozenge.tooltip"),label:g.I18n.getText("editor.unpublished.changes.lozenge.label")})),h=function(d){d=i.isBoolean(d)?d:!0;a.Editor.UI.setButtonState(d,c("#rte-button-publish"))},j=function(d,b){var a=b||function(){};(i.isBoolean(d)?
d:1)?f.addClass("visible").fadeIn("fast",a):f.fadeOut("fast",function(){c(this).hide().removeClass("visible");a()})},b={show:function(){f.hasClass("visible")||j(!0,h)},hide:function(){j(!1);h(!1)}};g.bind("rte-ready",function(){var a=c("#content-title-div");b.hide();f.insertBefore(a);f.tooltip();c("#content-title").on("keydown change",b.show);e.onChange.add(b.show);e.onKeyDown.add(b.show);e.onLoad.add(function(){c(e.startContent).text().trim()&&0<g.Meta.get("draft-id")&&b.show()});f.on("mouseenter.tipsy",
function(){g.trigger("analytics",{name:"confluence.editor.unpublished-changes.lozenge.hover"})});e.addCommand("mceConf.UnpublishedChangesLozenge.show",b.show);e.addCommand("mceConf.UnpublishedChangesLozenge.hide",b.hide)})},getInfo:function(){return{longname:"Unpublished Changes",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/unpublished-changes/unpublished-changes",function(c){var a=require("tinymce");a.create("tinymce.plugins.UnpublishedChanges",c);a.PluginManager.add("unpublishedchanges",a.plugins.UnpublishedChanges)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-shared-resources', location = 'tinymce3/plugins/confluencelist/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",["jquery","ajs","tinymce"],function(b,g,h){return{init:function(l){!h.isIE8&&l.onKeyDown.add(function(d,k){function j(a){a&&a.lastChild&&!d.dom.isBlock(a.lastChild)&&!b(a.lastChild).is("br")&&b(a).append("<br/>")}if(8===k.keyCode){var c=d.selection.getRng(!0),e=b(c.startContainer).closest("li",d.getBody());if(0!==e.length&&g.EditorUtils.isCursorAtStartOf(e[0],c)){var c=e.prev("li"),f,i=e[0],a;if(0<c.length)return f=c[0],
a=b(i.firstChild),h.isIE9&&0===a.length?a=b("<br/>").appendTo(e):a.is("p")&&(a=a.contents().first()),d.undoManager.beforeChange(),d.undoManager.add(),b(f.lastChild).is("p")&&!d.dom.isBlock(i.firstChild)?(j(f.lastChild),e.contents().each(function(a,c){if(d.dom.isBlock(c))return!1;b(f.lastChild).append(b(c).detach())})):b(i.firstChild).is("p")&&!d.dom.isBlock(f.lastChild)?(j(f),b.each(b.makeArray(c.contents()).reverse(),function(a,c){if(d.dom.isBlock(c))return!1;b(i.firstChild).prepend(b(c).detach())})):
j(f),c.append(e.detach().contents()),a[0]&&g.EditorUtils.setCursorAtStartOfContents(a[0]),d.undoManager.add(),h.dom.Event.cancel(k)}}})},getInfo:function(){return{longname:"Confluence List Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",function(b){var g=require("tinymce");g.create("tinymce.plugins.ConfluenceListPlugin",b);g.PluginManager.add("confluencelist",g.plugins.ConfluenceListPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-shared-resources', location = 'tinymce3/plugins/confluencepastetable/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",["jquery","document"],function(g,c){return{init:function(i){function m(a){var d={id:!0,"class":!0,style:!0,rowspan:!0,colspan:!0,"data-mce-style":!0,"data-mce-bogus":!0,"data-macro-name":!0,"data-macro-parameters":!0,"data-macro-body-type":!0,"data-highlight-colour":!0,"data-highlight-class":!0},f=["highlight","nohighlight","relative-table","fixed-table"],b,e=0,c=[],h=g(a);if(!a||j(a))return a;a&&a.getAttribute&&(b=
a.getAttribute("class"));if(b&&0<=b.indexOf("table-wrap"))if(a=g("table",a),a.length)g(a).unwrap(),a=a[0];else return null;if((!a.tagName?0:"TABLE"===a.tagName||"TR"===a.tagName||"TH"===a.tagName||"TD"===a.tagName||"TBODY"===a.tagName||"THEAD"===a.tagName||"TFOOT"===a.tagName||"COL"===a.tagName||"COLGROUP"===a.tagName||"CAPTION"===a.tagName)&&a.attributes){for(;e<=a.attributes.length;)(b=a.attributes[e])&&!0===b.specified&&!d[b.name]?a.removeAttribute(b.name):e++;k(a)&&c.push(k(a));d=0;for(e=f.length;d<
e;d++)f[d].exec||h.hasClass(f[d])&&c.push(f[d]);(f=h.attr("data-highlight-class"))&&c.push(f);(f=h.attr("data-highlight-colour"))&&c.push("highlight-"+f);h.attr("class",c.join(" "))}return a}function k(a){return!a.tagName?"":"TABLE"===a.tagName?"confluenceTable":"TH"===a.tagName?"confluenceTh":"TD"===a.tagName?"confluenceTd":""}function j(a){var d="";a&&a.getAttribute&&(d=a.getAttribute("class"));return!a.tagName?!1:"TABLE"!==a.tagName?!1:!d?!1:-1!==d.indexOf("wysiwyg-macro")}function l(a,d,c){for(var a=
c.node,d=m,b=a,e="";b;)if("function"===typeof d&&(b=d(b)),b)b.firstChild&&e.parentNode!==b&&!j(b)?(e=b,b=b.firstChild):b.nextSibling?(e=b,b=b.nextSibling):(e=b,b=b.parentNode);else break;c.node=a}i.on("init",function(){g(c).bind("postPaste",l)});i.on("remove",function(){g(c).unbind("postPaste",l)})},getInfo:function(){return{longname:"ConfluencePasteTablePlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",function(g){var c=require("tinymce");c.create("tinymce.plugins.ConfluencePasteTablePlugin",g);c.PluginManager.add("confluencepastetableplugin",c.plugins.ConfluencePasteTablePlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-shared-resources', location = 'tinymce3/plugins/confcleanup/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",["tinymce","jquery"],function(d,f){return{init:function(g){if(d.isWebKit){var h={},i=function(a,c){var b=a[c];b||(b={},a[c]=b);return b};f("#format-dropdown").find("ul.aui-dropdown li").each(function(){var a=f("a",this),c=a.css("font-size"),b=a.css("font-weight"),a=a.css("color"),a=i(h,a),b=i(a,b);b[c]||(b[c]=f(this).attr("data-format"))});g.onNodeChange.add(function(a){for(var c=a.dom.select("span.Apple-style-span",a.dom.doc.body),
b=a.dom.select("font.Apple-style-span",a.dom.doc.body),c=c.concat(b),b=0,k=c.length;b<k&&!a.dom.is(c[b],'[face="mceinline"]');b++){var e;a:{e=f(c[b]);var d=h[e.css("color")],g=void 0;if(d&&(g=d[e.css("font-weight")])){e=g[e.css("font-size")];break a}e=null}e&&(d=a.selection.getBookmark(),e&&a.dom.remove(c[b],1),a.selection.moveToBookmark(d),a.execCommand("FormatBlock",!1,e))}})}g.onNodeChange.add(function(a){for(var c=a.dom.select("img",a.dom.doc.body),b=c.length,d=0;d<b;d++)"file:///"===c[d].src.substr(0,
8)&&a.dom.remove(c[d])});if(d.isIE9){var j=function(a){a.getBody().childNodes.length||a.setContent("<p></p>")};g.onNodeChange.add(j);g.onSetContent.add(j)}},getInfo:function(){return{longname:"ConfluenceCleanupPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",function(d){var f=require("tinymce");f.create("tinymce.plugins.ConfluenceCleanupPlugin",d);f.PluginManager.add("confluencecleanupplugin",f.plugins.ConfluenceCleanupPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-editor-plugin:split_page-editor-quit-dialog', location = 'page-editor-quit-dialog.js' */
(window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff=window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff||[]).push([["page-editor-quit-dialog"],{90:function(e,i,o){"use strict";o.r(i);var a=o(17),t=o(8);Object(t.a)("confluence-editor/editor/page-editor-quit-dialog",()=>a.a)}},[[90,"runtime","vendors~core~page-editor-quit-dialog","core~editor-notifications~page-editor-message~page-editor-quit-dialog","core~page-editor-message~page-editor-quit-dialog","core~page-editor-quit-dialog"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'templates/reliable-save.soy' */
// This file was automatically generated from reliable-save.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Reliable.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Reliable == 'undefined') { Confluence.Templates.Editor.Reliable = {}; }


Confluence.Templates.Editor.Reliable.draftMessage = function(opt_data, opt_ignored) {
  var output = '<div id="draft-messages">';
  if (opt_data.isNewPage) {
    if (opt_data.existingDraft.title) {
      var escapedTitle__soy8 = '' + soy.$$escapeHtml(opt_data.existingDraft.title);
      output += soy.$$filterNoAutoescape(AJS.format('\u4f60\u6dfb\u52a0\u7684\u4e00\u4e2a\u65b0\u9875\u9762 {0} \u53eb\x26#8216;{1}\x26#8217; \u5df2\u7ecf\u4fdd\u5b58\u8349\u7a3f\u3002',opt_data.existingDraft.date,escapedTitle__soy8));
    } else {
      output += soy.$$filterNoAutoescape(AJS.format('\u4f60\u6dfb\u52a0\u7684\u4e00\u4e2a\u65b0\u9875\u9762{0} \u5df2\u7ecf\u4fdd\u5b58\u8349\u7a3f\u3002',opt_data.existingDraft.date));
    }
    output += ' ' + soy.$$filterNoAutoescape(AJS.format('\u662f\u5426 {0}\u7ee7\u7eed\u7f16\u8f91 {1} \u8fd8\u662f {2} \u653e\u5f03 {3} ?','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft"> ','</a>'));
  } else {
    output += soy.$$filterNoAutoescape(AJS.format('\u4f60\u7f16\u8f91\u7684\u9875\u9762{0}\u7684\u4e00\u4e2a\u7248\u672c\u5df2\u7ecf\u4fdd\u5b58\u8349\u7a3f\u3002',opt_data.existingDraft.date)) + ((opt_data.mergeRequired) ? ' ' + soy.$$escapeHtml('\u7531\u4e8e\u9875\u9762\u5df2\u88ab\u66f4\u65b0\uff0c\u4f60\u6240\u505a\u7684\u4fee\u6539\u5c06\u4e0e\u6700\u65b0\u7248\u672c\u5408\u5e76\u66f4\u65b0\u3002') : '') + ((opt_data.conflictFound) ? ' ' + soy.$$filterNoAutoescape(AJS.format('\u7531\u4e8e\u9875\u9762\u5df2\u88ab\u66f4\u65b0\uff0c\u5e76\u4e0e\u4f60\u6240\u505a\u7684\u4fee\u6539\u5b58\u5728\u51b2\u7a81\uff0c\u56e0\u6b64\u65e0\u6cd5\u5408\u5e76\u66f4\u65b0\u3002\u4f60\u5e0c\u671b{0}\u67e5\u770b\u51b2\u7a81{1}\u8fd8\u662f{2}\u5ffd\u7565{3}\u4fee\u6539\uff1f','<a href="?pageId=' + opt_data.pageId + '&viewConflict=true&spaceKey=' + opt_data.spaceKey + '" >','</a>','<a href="#" class="discard-draft">','</a>','<a href="' + "/confluence" + '/users/viewmydrafts.action">','</a>')) : (opt_data.mergeRequired) ? ' ' + soy.$$filterNoAutoescape(AJS.format('\u4f60\u60f3\u8981 {0}\u67e5\u770b{1}, {2}\u5408\u5e76\u548c\u7ee7\u7eed\u7f16\u8f91{3} \u6216\u8005{4}\u653e\u5f03{5} \u5b83?','<a id="view-diff-link-notification" href="#" class="view-diff-link">','</a>','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft">','</a>')) : ' ' + soy.$$filterNoAutoescape(AJS.format('\u4f60\u60f3\u8981 {0}\u67e5\u770b\u53d8\u66f4{1}, {2}\u7ee7\u7eed\u7f16\u8f91{3} \u6216\u8005{4}\u653e\u5f03{5} \u5b83?','<a id="view-diff-link-notification" href="#" class="view-diff-link">','</a>','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft">','</a>')));
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Reliable.draftMessage.soyTemplateName = 'Confluence.Templates.Editor.Reliable.draftMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'js/reliable-save.js' */
define("confluence-editor-reliable-save/reliable-save","ajs confluence/legacy underscore jquery window document confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/editor/page-editor-quit-dialog".split(" "),function(a,c,n,e,u,L,p,b,D){function v(){return a.Meta.get("shared-drafts")}function w(){return a.Meta.getBoolean("new-page")}function x(){c.Editor.UI.toggleSavebarBusy(!1)}function q(c){var e="\u5904\u7406\u8bf7\u6c42\u65f6\u51fa\u9519\u3002";b.closeMessages(["generic-error"]);
b.handleMessage("generic-error",{type:"error",message:e},f);a.logError("Generic error: "+JSON.stringify(c))}function f(){var b=e("#draft-messages");0<b.length&&(b.is(":visible")&&a.Confluence.Analytics.publish("rte.notification.draft"),b.find("a.use-draft").click(function(b){b.stopPropagation();b.preventDefault();c.Editor.Drafts.useDraft();a.Confluence.Analytics.publish("rte.notification.draft.resume")}),b.find("a.discard-draft").click(function(b){b.stopPropagation();b.preventDefault();h.Draft.discardDraft(a.Meta.get("page-id"),
a.Meta.get("existing-draft-id")).done(h.Draft.onSuccessDiscardDraft).fail(h.Draft.onErrorDiscardDraft)}))}function G(){e("#editor-restore-title-link").click(function(c){c.stopPropagation();c.preventDefault();e("#content-title").val(a.Meta.get("latest-published-page-title"));b.closeMessages(["rename-during-limited-mode"])})}function r(){a.Meta.set("access-mode","READ_ONLY");b.closeMessages(["read-only-mode"]);b.handleMessage("read-only-mode",{title:"\u8fd9\u662f\u53ea\u8bfb\u7f51\u7ad9",
type:"error",message:"\u4ece\u73b0\u5728\u5f00\u59cb\uff0c\u60a8\u7684\u4efb\u4f55\u6539\u52a8\u90fd\u65e0\u6cd5\u4fdd\u5b58\u3002 \u5f53\u60a8\u53ef\u4ee5\u518d\u6b21\u5f00\u59cb\u7f16\u8f91\u65f6\u6211\u4eec\u4f1a\u901a\u77e5\u60a8\u3002"});c.Editor.UI.setButtonsState(!0);c.Editor.UI.toggleSavebarBusy(!1);c.Editor.UI.setButtonState(!1,c.Editor.UI.saveButton);c.Editor.UI.setButtonState(!1,c.Editor.UI.cancelButton)}function A(c){var e="\u770b\u8d77\u6765\u60a8\u7684\u4f1a\u8bdd\u5df2\u8fc7\u671f\u3002\u91cd\u65b0\u767b\u5f55\u4ee5\u7ee7\u7eed\u5de5\u4f5c\u3002\n \u003cdiv\u003e\u003ca href=\u0022dashboard.action\u0022 target=\u0022_blank\u0022\u003e\u767b\u5f55\u003c/a\u003e\u003c/div\u003e";b.closeMessages(["noauthorized"]);b.handleMessage("noauthorized",{title:"\u4e0d\u80fd\u8fde\u63a5\u670d\u52a1\u5668",type:"error",message:e},f);c&&a.trigger("rte.safe-save.invalid-xsrf-token")}
function E(){var c="\u65e0\u6cd5\u4fdd\u5b58\u9875\u9762\u3002\u8bf7\u68c0\u67e5\u4e0e\u670d\u52a1\u5668\u901a\u4fe1\uff0c\u6216\u68c0\u67e5\u5185\u5bb9\u662f\u5426\u6709\u7279\u6b8a\u5b57\u7b26/emoji\u8868\u60c5\u3002";b.closeMessages(["server-offline"]);b.handleMessage("server-offline",{type:"error",message:c},f)}var F=[],t=!1,h={Draft:{discardDraft:function(b,c){b={draftId:c,pageId:b,type:a.Meta.get("draft-type"),spaceKey:a.Meta.get("space-key")};return e.ajax({type:"DELETE",url:p.CONTEXT_PATH+"/rest/tinymce/1/drafts/discard",data:e.toJSON(b),contentType:"application/json",dataType:"json"})},onSuccessDiscardDraft:function(){w()||a.Meta.set("draft-id",
"0");b.closeMessages(["draft-message"]);b.handleMessage("discarding-successfull",{type:"info",message:"\u4f60\u7684\u8349\u7a3f\u5df2\u7ecf\u88ab\u5e9f\u5f03\u3002",close:"auto"},f);a.Confluence.Analytics.publish("rte.notification.draft.discard")},onErrorDiscardDraft:function(c){switch(c.status){case 403:A(!0);break;case 404:b.handleMessage("draft-deleted",{type:"info",message:"\u6b64\u8349\u7a3f\u5df2\u7ecf\u88ab\u5e9f\u5f03\u3002"},f);break;case 405:r();break;case 422:b.handleMessage("discarding-invalid",{type:"error",
message:"\u6b64\u8349\u7a3f\u65e0\u6548\u3002\u6709\u53ef\u80fd\u662f\u5df2\u7ecf\u88ab\u5176\u4ed6\u4eba\u5220\u9664\u6216\u8005\u662f\u4f60\u7684\u767b\u5f55\u8fc7\u671f\u3002"},f);break;default:b.handleMessage("discarding-error",{type:"error",message:"\u53d1\u751f\u672a\u77e5\u9519\u8bef. \u8bf7\u68c0\u67e5\u65e5\u5fd7."},f)}}}};h._internal=c.SafeSafe&&c.SafeSave._internal?c.SafeSave._internal:{};h._internal.onSuccessfulResponse=function(b){e("#rte-button-overwrite").unbind("click.overwrite");var f={dataType:"json",contentId:a.Meta.get("content-id"),draftType:a.Meta.get("draft-type")};a.safe.post(p.CONTEXT_PATH+"/json/stopheartbeatactivity.action",
f,function(){a.log("Stop heartbeat activity on",f.draftType,"id",f.contentId)},"json").fail(function(b,c,e){a.logError("Server error on stop heartbeat activity request:");a.log(e)}).always(function(){var a=b._links.webui;a?0!==a.indexOf("/")?u.location=a:u.location=p.CONTEXT_PATH+a:(c.Editor.isPublishing(!1),x())})};h.resetUnrecoverableEditorError=function(){t=!1};h.initialize=function(){function z(d){x();switch(d.status){case 400:b.closeMessages(["empty-title","duplicate-title","title-too-long",
"legacy-draft-deprecated","utf8-validation-failed"]);0<=d.responseText.indexOf(k.duplicatedTitle)?b.handleMessage("duplicate-title",{type:"error",message:a.format("\u4e00\u4e2a\u6807\u9898\u4e3a \u0027\u0027{0}\u0027\u0027 \u7684\u9875\u9762\u5df2\u7ecf\u5b58\u5728\u4e8e\u8be5\u7a7a\u95f4\u4e2d\u3002\u4e3a\u60a8\u7684\u9875\u9762\u8f93\u5165\u4e00\u4e2a\u4e0d\u540c\u7684\u6807\u9898\u3002",a.escapeHtml(e("#content-title").val()))}):0<=d.responseText.indexOf(k.titleTooLong)?b.handleMessage("title-too-long",{type:"error",message:"\u6807\u9898\u4e0d\u80fd\u957f\u4e8e 255 \u4e2a\u5b57\u7b26\u3002"},f):0<=d.responseText.indexOf(k.publishNewDraftDeprecated)||0<=d.responseText.indexOf(k.existingDraftNotFound)?
a.Meta.get("new-page")&&v()&&!c.Editor.hasContentChanged()?(a.trigger("rte.legacy-draft-can-be-migrated"),b.handleMessage("legacy-draft-deprecated",{type:"error",message:a.format("\u534f\u540c\u7f16\u8f91\u5c31\u5728\u8fd9\u91cc\uff01\u8fd9\u6837\u60a8\u5c31\u53ef\u4ee5\u7ee7\u7eed\u5728\u8fd9\u4e2a\u9875\u9762\u4e0a\u5de5\u4f5c\uff0c\u6211\u4eec\u9700\u8981\u4e3a\u60a8\u5c06\u5185\u5bb9\u8f6c\u79fb\u5230\u4e00\u4e2a\u65b0\u7684\u8349\u7a3f\u3002\u003cbr\u003e \u003ca href={0}\u003e \u73b0\u5728\u8f6c\u79fb \u003c/a\u003e",p.CONTEXT_PATH+"/pages/resumedraft.action?draftId\x3d"+a.Meta.get("draft-id"))},f)):(a.trigger("rte.legacy-draft-cannot-be-migrated"),b.handleMessage("legacy-draft-deprecated",{type:"error",message:"\u534f\u540c\u7f16\u8f91\u5c31\u5728\u8fd9\u91cc\uff01\u8fd9\u610f\u5473\u7740\u6211\u4eec\u9700\u8981\u60a8\u7684\u4e00\u70b9\u5e2e\u52a9\u4ee5\u91cd\u542f\u60a8\u7684\u7f16\u8f91\u4f1a\u8bdd\u3002\u60a8\u9700\u8981\u505a\u7684\u4e00\u5207\u5c31\u662f\u590d\u5236\u5185\u5bb9\uff0c\u91cd\u65b0\u7f16\u8f91\u8be5\u9875\u9762\uff0c\u7136\u540e\u5c06\u5176\u9ecf\u8d34\u5e76\u4fdd\u5b58\u3002"},f)):0<=d.responseText.indexOf(k.utf8ValidationFailed)?
(d=d.responseJSON.message.split(k.utf8ValidationFailed)[1],b.handleMessage("utf8-validation-failed",{title:"\u4e0d\u652f\u6301\u7684\u5b57\u7b26",type:"error",message:a.format("\u6211\u4eec\u65e0\u6cd5\u4fdd\u5b58\u60a8\u7684\u9875\u9762\uff0c\u56e0\u4e3a\u6570\u636e\u5e93\u4e0d\u652f\u6301 {0} \u5b57\u7b26\u3002\u003cbr\u003e\u003cbr\u003e\u8bf7\u5220\u9664\u6b64\u5b57\u7b26\u6216\u6539\u7528 Confluence \u7b26\u53f7\u6216\u8868\u60c5\u7b26\u53f7\u3002\u003ca href = \u0022https://confluence.atlassian.com/x/BYfsNg\u0022 target=\u0022_blank\u0022\u003e\u4e86\u89e3\u66f4\u591a\u003c/a\u003e",d)},f)):q(d);break;case 403:A(!0);break;case 404:b.closeMessages(["page-not-accessible","noauthorized"]);b.handleMessage("page-not-accessible",{title:"\u65e0\u6cd5\u8bbf\u95ee\u6b64\u5185\u5bb9",type:"error",message:a.format("\u60a8\u7684\u4f1a\u8bdd\u5df2\u7ecf\u5230\u671f\uff0c\u60a8\u53ef\u4ee5\u5c1d\u8bd5 \u003ca href=\u0022dashboard.action\u0022 target=\u0022_blank\u0022\u003e \u767b\u5f55\u003c/a\u003e\u3002",
a.Meta.get("space-key"))},f);break;case 405:r();break;case 410:b.closeMessages(["page-deleted"]);b.handleMessage("page-deleted",{title:"\u8be5\u5185\u5bb9\u5df2\u7ecf\u88ab\u5220\u9664",type:"error",message:a.format("\u590d\u5236\u60a8\u7684\u5185\u5bb9\uff0c\u7136\u540e\u5c06\u5176\u6dfb\u52a0\u5230\u65b0\u9875\u9762\u6216 \u003cdiv\u003e\u003ca href=\u0022viewtrash.action?key={0}\u0022 target=\u0022_blank\u0022\u003e\u4ece\u5783\u573e\u6876\u6062\u590d\u6b64\u9875\u9762\u003c/a\u003e\uff0c\u7136\u540e\u518d\u6b21\u5c1d\u8bd5\u3002\u003c/div\u003e",a.Meta.get("space-key"))},f);break;case 413:b.closeMessages(["page-too-big"]);b.handleMessage("page-too-big",{type:"error",message:"\u8be5\u9875\u9762\u592a\u5927\uff0c\u65e0\u6cd5\u4fdd\u5b58\u3002\u60a8\u53ef\u4ee5\u5c06\u5b83\u62c6\u5206\u6210\u591a\u4e2a\u9875\u9762\uff0c\u7136\u540e\u4f7f\u7528 \u003ca href=\u0022https://confluence.atlassian.com/conf51/include-page-macro-336169384.html\u0022 target=\u0022_blank\u0022\u003e \u5305\u62ec\u9875\u9762\u5b8f\u6307\u4ee4 \u003c/a\u003e \u4ee5\u663e\u793a\u5185\u5bb9\u3002"},f);break;case 0:case 500:case 503:E();break;case 501:0<=d.responseText.indexOf(k.renameDuringLimitedMode)?
b.handleMessage("rename-during-limited-mode",{type:"error",message:"\u73b0\u5728\u65e0\u6cd5\u66f4\u6539\u9875\u9762\u6807\u9898\uff0c\u56e0\u4e3a\u534f\u540c\u7f16\u8f91\u5904\u4e8e\u8131\u673a\u72b6\u6001\u3002\u003cdiv\u003e\u5982\u679c\u60a8\u60f3\u8981\u53d1\u5e03\u9875\u9762\uff0c\u90a3\u5c31\u003ca id=\u0022editor-restore-title-link\u0022 href=\u0022#\u0022\u003e\u6062\u590d\u9875\u9762\u6807\u9898\u003c/a\u003e\u3002\u003c/div\u003e"},G):q(d);break;default:q(d)}}function y(d){function I(c){B<J?(B++,C.push(setTimeout(function(){y()},K))):(a.trigger("analyticsEvent",{name:"editor.save.error.conflict"}),B=0,b.handleMessage("page-conflict",{title:"\u65e0\u6cd5\u4e0e\u670d\u52a1\u5668\u540c\u6b65\u3002",type:"error",message:a.format("\u5237\u65b0\u9875\u9762\u4ee5\u5c1d\u8bd5\u91cd\u65b0\u5efa\u7acb\u8fde\u63a5\u3002",g.space.key)},f),k(c))}function k(b){a.trigger("rte.safe-save.error",
{status:b.status})}function n(){c.Editor.isPublishing(!0);e.ajax({type:r,url:l,contentType:"application/json; charset\x3dutf-8",dataType:"json",data:JSON.stringify(g),success:function(b){"page"!==g.type&&"blogpost"!==g.type||a.trigger("analytics",{name:"confluence.editor.close",data:{source:"publishButton"}});a.trigger("rte.safe-save.success",b);h._internal.onSuccessfulResponse(b)},error:function(b){c.Editor.isPublishing(!1);x();var d=!1;switch(b.status){case 409:v()?(d=!0,I(b)):(c.Editor.restoreDefaultSave(),
c.Editor.UI.saveButton.click());break;case 0:case 500:case 503:for(;C.length;)clearTimeout(C.shift());z(b);break;default:z(b)}d||k(b);a.trigger("synchrony.start",{id:"confluence.editor.publish"})}})}a.trigger("synchrony.stop",{id:"confluence.editor.publish"});d&&d.preventDefault();var m=e("#content-title");if(m.hasClass("placeholded")||""===m.val().trim())a.trigger("rte.safe-save.error"),a.trigger("synchrony.start",{id:"confluence.editor.publish"}),b.closeMessages(["title-too-long","duplicate-title"]),
b.handleMessage("empty-title",{title:"\u8be5\u9875\u9762\u9700\u8981\u4e00\u4e2a\u540d\u79f0",type:"error",message:"\u5728\u70b9\u51fb\u53d1\u5e03\u524d\u6dfb\u52a0\u4e00\u4e2a\u9875\u9762\u6807\u9898\u3002"},f),x();else{c.Editor.Drafts.unBindUnloadMessage();var g={};d=a.Meta.get("draft-id");var t=a.Meta.get("content-id"),l=p.CONTEXT_PATH+"/rest/api/content",q=e("#sourceTemplateId").val();g.status="current";g.title=m.val();g.space={key:a.Meta.get("space-key")};g.body={editor:{value:function(a){F.forEach(function(b){a=b(a)});return a}(a.Rte.getEditor().getContent()),
representation:"editor"}};q&&(g.extensions={sourceTemplateId:q});m=(m=c.Editor.UI.postingDatePicker)&&m.getDate();"blogpost"===u.type&&m&&m.toISOString&&(g.history={createdDate:m.toISOString()});if(w()&&!a.Meta.get("shared-drafts")){var r="POST";a.Meta.get("is-blueprint-page")&&(l=l+"/blueprint/instance/"+d);l+="?status\x3ddraft";g.id=d;g.type=a.Meta.get("content-type");g.body.editor.content={id:d}}else r="PUT",w()&&a.Meta.get("is-blueprint-page")&&(l+="/blueprint/instance"),l=l+"/"+t,w()&&v()?(g.id=
d,g.body.editor.content={id:d}):(g.id=a.Meta.get("page-id"),g.body.editor.content={id:a.Meta.get("page-id")}),l="0"===d?l+"?status\x3dcurrent":l+"?status\x3ddraft",d=a.Meta.getNumber("page-version")||0,g.type=a.Meta.get("content-type"),g.version={number:d+1,message:e("#versionComment").val(),minorEdit:!e("#notifyWatchers").is(":checked"),syncRev:e("#syncRev").val()};d=function(){var b={};b.id=a.Meta.get("parent-page-id")||"0";b.type=a.Meta.get("content-type");var c=a.Meta.get("parent-page-id");c&&
g.space.key===a.Meta.get("space-key")||(b.id="0");c&&b.id!==c&&(b.id=e("#parentPageString").val()===a.Meta.get("from-page-title")?b.id:c);return b}();"0"!==d.id&&(g.ancestors=[d]);(d=c.Editor.Drafts.getDraftSavingPromise())?d.always(n):n()}}if(0!==e("#editpageform").length||0!==e("#createpageform").length){var k={duplicatedTitle:"A page with this title already exists",titleTooLong:"Title cannot be longer than 255 characters.",publishNewDraftDeprecated:"Unsupported call to publishNewDraft",existingDraftNotFound:"Could not find existing draft, perhaps you're trying to publish a personal draft?",
renameDuringLimitedMode:"Unable to perform a page rename when limited mode is enabled",utf8ValidationFailed:"Unsupported character found in content: "},u={existingDraftId:a.Meta.get("existing-draft-id")?a.Meta.get("existing-draft-id"):0,pageId:a.Meta.get("page-id"),type:a.Meta.get("draft-type"),spaceKey:a.Meta.get("space-key")};if(!0===a.Meta.get("show-draft-message")){if(0<e("#conflict-diffs").length)return;e.ajax({type:"GET",url:p.CONTEXT_PATH+"/rest/tinymce/1/drafts/message",data:u,contentType:"application/json",
dataType:"text json",success:function(d){d&&d.draftData&&(d=c.Templates.Editor.Reliable.draftMessage({existingDraft:d.draftData,conflictFound:d.conflictFound,mergeRequired:d.mergeRequired,isNewPage:d.newPage,pageId:a.Meta.get("page-id"),spaceKey:a.Meta.get("space-key")}),b.handleMessage("draft-message",{type:"info",message:d},f))}})}var H=0<e("#editor-notifications-container #all-messages .aui-message-error").length;v()?(D.init({saveHandler:y,cancelErrorHandler:z}),c.Editor.overrideSave(D.process)):
H?c.Editor.restoreDefaultSave():c.Editor.overrideSave(y);e("#rte-button-overwrite").bind("click.overwrite",y);var B=0,J=3,K=1E3,C=[];a.bind("rte.heartbeat-error",function(d,e){switch(e.status){case 401:case 403:b.isDisplayed(["page-not-accessible"])||A(!1);break;case 405:if(e.responseText){d=JSON.parse(e.responseText);b.isDisplayed(["read-only-mode"])||"READ_ONLY"!==d.reason||r();break}case 0:case 404:case 500:case 503:c.Editor.metadataSyncRequired()||E();break;default:a.logError("Heartbeat action error: "+
JSON.stringify(e))}});a.bind("rte.heartbeat",function(d){var e=!1;n.each(b.displayedErrors(),function(a){n.contains(["noauthorized","server-offline","page-not-accessible","read-only-mode"],a)&&(e=!0,b.closeMessages([a]))});(d="READ_ONLY"===a.Meta.get("access-mode"))&&a.Meta.set("access-mode","READ_WRITE");(e||d)&&b.handleMessage("reconnect",{type:"info",title:"\u6210\u529f\u91cd\u65b0\u8fde\u63a5",message:"\u6211\u4eec\u6062\u590d\u6b63\u5e38\u4e86\u3002\u60a8\u53ef\u81ea\u7531\u5730\u518d\u6b21\u4fdd\u5b58\u60a8\u7684\u9875\u9762\u3002",close:"auto"},f);c.Editor.UI.isButtonEnabled(c.Editor.UI.saveButton)||
t||c.Editor.UI.setButtonState(!0,c.Editor.UI.saveButton);c.Editor.UI.isButtonEnabled(c.Editor.UI.cancelButton)||t||c.Editor.UI.setButtonState(!0,c.Editor.UI.cancelButton)});a.bind("synchrony.history.evicted",function(){t=!0})}};h.registerCleanupFunction=function(a){F.push(a)};return h});
require("confluence/module-exporter").safeRequire("confluence-editor-reliable-save/reliable-save",function(a){var c=require("ajs"),n=0<window.document.referrer.indexOf("createDialog\x3dtrue\x26flashId");if(c.DarkFeatures.isEnabled("editor.ajax.save")&&""!==c.Meta.get("remote-user")&&!n){var e=require("confluence/legacy");c.bind("rte.init.ui",function(){a.initialize();e.Editor=e.Editor||{};e.Editor.SafeSave=e.Editor.SafeSave||{};e.Editor.SafeSave.Draft=a.Draft;e.Editor.SafeSave._internal=a._internal||
{}})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'js/ajax-login.js' */
define("confluence-editor-reliable-save/ajax-login",["confluence/dark-features","confluence/meta","ajs","jquery","document"],function(p,k,b,f,y){return function(){function z(A,g,a){function h(a){a=a.getResponseHeader("X-AUSERNAME");return v===a}function k(a){for(var d=0,B=a.length;d<B;d++){var e=a[d];b.debug("Rerunning ajax query to: "+e.url,e);w.call(f,e.url,e.settings).done(function(){b.debug("Rerunning done");e.deferred.resolve(arguments)}).fail(function(){b.debug("Rerunning failed");e.deferred.reject(arguments)})}}
function p(a){r.push({deferred:l,url:A,settings:g,defaultCallback:a});t||(u=!1,m||(m=new b.Dialog(840,700),m.addPanel("ajax-login","ajax-login-content","ajax-login-panel",1),a=f(".ajax-login-panel"),n=f("\x3ciframe\x3e\x3c/iframe\x3e"),n.bind("load",function(a){(a=n[0].contentDocument.location.pathname)&&0<=a.indexOf("/ajaxlogincomplete.action")&&(t=!1,u=!0,m.hide(),n.attr("src","about:blank"))}),a.append(n),f(y).bind("hideLayer",function(a,d,e){if("popup"===d&&e===m.popup){b.debug("hiding login dialog");
if(u)k(r);else for(a=r,d=0,e=a.length;d<e;d++){var c=a[d];b.debug("Executing with original response for: "+c.url,c);c.defaultCallback&&c.defaultCallback()}r=[]}})),n.attr("src",C),m.show(),t=!0)}function q(a,b,f,e){function d(){c.readyState=a.readyState;c.status=a.status;c.statusText=a.statusText;a.responseXML?c.responseXML=a.responseXML:c.responseText=a.responseText;b.apply(f,e)}h(a)?d():p(d)}b.debug("Using authenticatingPromise");var c={abort:function(){a.abort.apply(a,arguments)},getAllResponseHeaders:function(){a.getAllResponseHeaders.apply(a,
arguments)},getResponseHeader:function(){a.getResponseHeader.apply(a,arguments)},overrideMimeType:function(){a.overrideMimeType.apply(a,arguments)},readyState:a.readyState,setRequestHeader:function(c,b){a.setRequestHeader.apply(a,arguments)},state:function(){a.state.apply(a,arguments)},status:a.status,statusCode:function(){a.statusCode.apply(a,arguments)},statusText:a.statusText},l=f.Deferred();l.promise(c);c.success=c.done;c.error=c.fail;a.done(function(a,c,b){q(b,l.resolve,l,arguments)});a.fail(function(a,
c,b){q(a,l.reject,l,arguments)});return c}if(p.isEnabled("ajax.login")){b.debug("AJAX login support enabled");var t=!1,m,n,u,r=[],w=f.ajax,v=k.get("remote-user"),q=k.get("base-url"),x=k.get("context-path"),C=k.get("context-path")+"/login.action?os_destination\x3d%2Fajaxlogincomplete.action";f.ajax=function(b,g){var a=w.call(f,b,g);var h=b&&b.url;h=v&&(!g||g&&!g.preventAjaxLogin)&&h&&(q&&0===h.indexOf(q)||x&&0===h.indexOf(x));return h?z(b,g,a):a}}}});
require("confluence/module-exporter").safeRequire("confluence-editor-reliable-save/ajax-login",function(p){require("ajs").toInit(p)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources', location = 'tinymce3/plugins/confluencepaste/linkify.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/linkify",function(){return{RE_EMAIL_PATTERN:"(?:\\s|\\A|^)[\\w.-]+\\+*[\\w.-]+@(?:(?:[\\w-]+\\.)+[A-Za-z]{2,6}|(?:\\d{1,3}\\.){3}\\d{1,3})",RE_URL_SCHEME:"(?:[\\w-]{2,}):/{1,3}",RE_TLD:"(?:aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|travel|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|si|sj|sk|sl|sm|sn|so|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)",
RE_URL_MIDCHAR:"(?:[^\\s()]+|\\((\\S+)\\))",RE_URL_ENDCHAR:"(?:\\((\\S+)\\)|[^\\s`!()\\[\\]{};:'\".,<>?])",init:function(){this.RE_URL_ENDING||(this.RE_URL_ENDING="(?:"+this.RE_URL_MIDCHAR+"*"+this.RE_URL_ENDCHAR+")?",this.RE_FULL_URL=this.RE_URL_SCHEME+"\\w+(?:.\\w+)"+this.RE_URL_ENDING,this.RE_OTHER_URL="\\w[\\w_-]*(?:\\.\\w[\\w_-]*)*\\."+this.RE_TLD+"(?:[\\/\\?#]"+this.RE_URL_ENDING+"|\\b)")},linkify:function(f,b,i){this.init();f=this.match_and_replace(this.RE_EMAIL_PATTERN,f,!0,!1,b,i);
f=this.match_and_replace(this.RE_FULL_URL,f,!1,!1,b,i);return f=this.match_and_replace(this.RE_OTHER_URL,f,!1,!0,b,i)},match_and_replace:function(f,b,i,o,k,h){for(var c=0,a=0,d=0,c=0,l=/<\/[aA]>/,f=RegExp(f,"g"),p=h.hasOwnProperty("add_wbrs")?h.add_wbrs:null,j=h.hasOwnProperty("truncate_length")?h.truncate_length:100,m=h.hasOwnProperty("link_target")?h.link_target:"_blank",h=h.hasOwnProperty("link_titles")?h.link_titles:null,d={},n=0;d=f.exec(b);){n++;if(20<n)break;c=d.index;d=d[0].length;if(0<=b.substring(a,
c).search(/<[aA]/)){l.lastIndex=a;c=b.substring(a,b.length).search(l);if(0>c)break;c+=a;f.lastIndex=c+4;a=c+4}else{var a=b.substr(c,d),g=a.search(/&(amp|gt|lt)$/);if(0<g&&b.length>c+d&&";"==b[c+d]){d-=a.length-g;for(a=b.substr(c,d);!a.match(this.RE_URL_ENDCHAR+"$")&&0<d;)d--,a=b.substr(c,d)}g=a;o&&(g="http://"+g);var e="<a";m&&(e+=' target="'+m+'"');e+=' href="';i&&(e+="mailto:");g=g.replace(/"/g,"%22");e+=g+'"';h&&(e+=' title="'+(i?"Email "+g:g)+'"');j&&a.length>j&&(a=a.substr(0,j)+"...");p&&(a=
a.replace(/([/=])/g,"<wbr>$1"));e+=">"+a+"</a>";k&&k.push(g);b=b.slice(0,c)+e+b.slice(c+d,b.length);f.lastIndex=c+e.length;a=c+e.length}}return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/linkify","linkify");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources', location = 'tinymce3/plugins/confluencepaste/post-paste-node-filter.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter","jquery confluence/legacy confluence-editor/tinymce3/plugins/confluencepaste/linkify ajs document tinymce".split(" "),function(e,B,q,r,y,z){function u(a,b){for(var f=e(a).find("["+b+"]"),c="",d="",g="",h=0,k=f.length;h<k;h++){d=(c=e(f[h]))&&["/",c.attr(b)].join("");g=c&&["/",c.attr("data-mce-"+b)].join("");r.contextPath()&&d.indexOf(r.contextPath())===0&&(f[h]=c.attr(b,d));r.contextPath()&&g.indexOf(r.contextPath())===
0&&(f[h]=c.attr("data-mce-"+b,g))}return f}function m(a,b,f){var a=e(a).find("["+b+"]"),c="",d,g;if(a)for(var h=0,k=a.length;h<k;h++){d=e(a[h]);g=f.standard;for(var n in f)if(f.hasOwnProperty(n)&&d.is(n)){g=f[n];break}if(b.indexOf("style")>-1){var c=d,i=g;g=[];for(var o="",o=void 0,p=c.attr("style"),l=c.attr("data-mce-style"),j=0,m=i.length;j<m;j++)if(p&&p.toLowerCase().indexOf(i[j])>-1)g.push(i[j]+": "+c.css(i[j])+";");else if(l&&l.toLowerCase().indexOf(i[j])>-1){o=RegExp(i[j]+":.+?(?:;|$)");o=l.match(o);
g.push(o[0].indexOf(";")>-1?o:o+";")}c=g.join(" ")}else{c=d;i=b;p=[];if(g){l=0;for(j=g.length;l<j;l++)c.is("["+i+"~="+g[l]+"]")&&p.push(g[l])}c=p.join(" ")}d.removeAttr(b);c.length&&d.attr(b,c)}}function A(a,b){function f(f){var d;if(c.index){d=a.splitText(c.index);a&&b.push(a);a=d}(d=a.splitText(c[0].length))&&b.push(d);e(a).wrap("<a href='"+f+a.data+"'></a>")}var c,d,g;d=s.exec(a.data);g=t.exec(a.data);if(d){c=d;f("mailto:")}else if(g){d=(c=g)&&c[0].indexOf("://")===-1?"http://":"";f(d)}}var t;
q.init();var v=RegExp(q.RE_FULL_URL),w=RegExp(q.RE_OTHER_URL);t={exec:function(a){return v.exec(a)||w.exec(a)},test:function(a){return v.test(a)||w.test(a)}};var s,x=RegExp(q.RE_EMAIL_PATTERN);s={exec:function(a){if((a=x.exec(a))&&/\s/.test(a[0][0])){a[0]=a[0].replace(/\s/,"");a.index++}return a},test:function(a){return x.test(a)}};e(y).bind("postPaste",function(a,b,f){a=f.node;b={standard:["text-decoration","text-align","margin-left"],".wysiwyg-macro":["background-image"],p:["margin-left","text-align"],
span:["color","text-decoration"],pre:["margin-left"]};b.td=b.th=["text-align"];b.li=["list-style-type","background-image"];b.col=["width"];b["table.confluenceTable.relative-table"]=["width"];m(a,"style",b);m(a,"data-mce-style",b);if(e.browser.mozilla){u(a,"src");u(a,"href")}m(a,"face",{standard:[]});m(a,"id",{standard:[]});m(a,"data-mce-href",{standard:[]});a=f.node;b=[];b.push({elements:["div"],attribute:"class",blackValue:"aui-buttons"});for(var c=0;c<b.length;c++)for(var d=b[c],g=0;g<d.elements.length;g++)for(var h=
e(a).find(d.elements[g]+"["+d.attribute+"]"),k=0;k<h.length;k++){var n=h.eq(k).attr(d.attribute),n=n.replace(d.blackValue,"");h.eq(k).attr(d.attribute,n)}var i=f.node;e.each([".contentLayout",".contentLayout2",".columnLayout",".header",".footer",".cell",".innerCell",".panelContent",".panel",".panelHeader",".Apple-converted-space","font",".jira-status",".jira-issue",".diff-html-removed",".diff-html-added",".diff-html-changed"],function(a,b){e(b,i).contents().unwrap()});e("img",i).map(function(){e(this).attr("data-attachment-copy",
"");!e(this).attr("src")&&e(this).remove()});e("dl",i).map(function(){e(this).replaceWith(e("<p></p>").text(e(this).text()))});e("a",i).map(function(){e(this).removeClass("confluence-userlink userLogoLink")});for(a=e.makeArray(f.node.childNodes);a.length;){b=a.pop();e(b).is("a")||(b.nodeType===3?A(b,a):b.nodeType===1&&(b.childNodes&&b.nodeName.toLowerCase()!=="pre")&&(a=a.concat(e.makeArray(b.childNodes))))}if(a=e.browser.mozilla){a=e(f.node);a=a.children("br").length&&!a.find(":not(br)").length&&
!e(z.activeEditor.selection.getStart()).closest("[data-macro-body-type='PLAIN_TEXT']").length}if(a){f=e(f.node);a="<p>"+f.html().replace(/<br>/gi,"</p><p>")+"</p>";f.html(a)}});return{URL:t,EMAIL:s}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter","Confluence.Editor.regex");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources', location = 'com/atlassian/confluence/tinymceplugin/tinymce-adapter-deprecated.js' */
define("confluence-editor/tinymceplugin/tinymce-adapter-deprecated",["tinymce","ajs","confluence/legacy","jquery"],function(e,a,g,h){return{putCursorAtPostionInElement:function(b,a,c){var d=e.activeEditor,i=d.getDoc(),b=h(b,c||i),b=b.contents().filter(function(){return 3===this.nodeType})[0],c=d.selection.getRng(!0);c.setStart(b,a);c.setEnd(b,a);d.selection.setRng(c)},storeCurrentSelectionState:a.Rte.BookmarkManager.storeBookmark,restoreSelectionState:a.Rte.BookmarkManager.restoreBookmark,insertLink:function(b,
f){f&&a.Rte.getEditor().selection.select(f);g.Editor.LinkAdapter.setLink(b)},getCurrentBaseUrl:a.Rte.getCurrentBaseUrl,addOnInitCallback:function(b){a.debug("Adding callback to AJS.Rte.BootstrapManager. AJS.Rte.BootstrapManager = "+a.Rte.BootstrapManager);a.Rte.BootstrapManager.addOnInitCallback(b)},bindScroll:function(b,f){a.Rte.bindScroll(b,f)},unbindScroll:function(b){a.Rte.unbindScroll(b)},getTinyMceHasInit:function(){return a.Rte.BootstrapManager.isInitComplete()},getEditor:a.Rte.getEditor,addTinyMcePluginInit:function(b){a.Rte.BootstrapManager.addTinyMcePluginInit(b)},
isExternalLink:function(a){return g.Link.isExternalLink(a)},isInMacroPlaceholder:function(a){return e.confluence.MacroUtils.isInMacro(a)},initialiseTinyMce:function(){var b=a.Editor.Adapter;e.EditorManager.preInit.apply(e.EditorManager);e.EditorManager.init(b.settings)},offset:function(b){a.Rte.Content.offset(b)},getSelectedText:function(){return a.Rte.Content.getSelectedText()},setEditorValue:function(b){a.Rte.Content.setHtml(b)},editorHasContentChanged:function(){return a.Rte.getEditor().isDirty()},
editorResetContentChanged:function(){a.Rte.getEditor().setDirty(!1)},getChildIndex:function(a,f){for(var c=a.childNodes,d=0,e=c.length;d<e;d++)if(c[d]==f)return d;return-1},getMainEditor:function(){return a.Rte.getMainEditor()},getEditorContainer:function(){return a.Rte.getEditorContainer()},getEditorFrame:function(){return a.Rte.getEditorFrame()},getEditorTable:function(){return a.Rte.getEditorTable()},webResourcePath:a.Rte.webResourcePath,getResourceUrlPrefix:function(){return a.Rte.getResourceUrlPrefix()},
getTinyMceBaseUrl:function(){return a.Rte.getTinyMceBaseUrl()},getMinEditorHeight:function(){return a.Rte.getMinEditorHeight()},getTinyMceEditorMinHeight:function(b){return a.Rte.getTinyMceEditorMinHeight(b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymceplugin/tinymce-adapter-deprecated","AJS.Editor.Adapter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jiraAnalytics', location = '/jira/jiraanalytics.js' */
AJS.Editor.JiraAnalytics={events:{paste:{key:"confluence.jira.plugin.paste"},search:{key:"confluence.jira.plugin.search"},trigger:{key:"confluence.jira.plugin.trigger"},customizeColumn:{key:"confluence.jira.plugin.column.customize"}},linkTypes:{jqlDirect:"direct_jql",jql:"jql_link",xml:"xml_link",rss:"rss_link",filter:"filter_link"},getDisplayType:function(b){var a="single";b.container.find("#opt-table").is(":checked")?a="table":b.container.find("#opt-total").is(":checked")&&(a="count");return a},
setupAnalyticPanelActionObject:function(b,a,d){return{name:b.analyticPanelActionName,properties:this.setupPanelActionProperties(b,a,d)}},setupPanelActionProperties:function(b,a,d){var c={};a===AJS.Editor.JiraConnector.source.instructionalText&&("confluence.jira.plugin.issuecreated"===b.analyticPanelActionName?c.issueType=b.container.find('select[name\x3d"issuetype"] :selected').text():"confluence.jira.plugin.searchadded"===b.analyticPanelActionName&&(c.display=this.getDisplayType(b)),c.label=d);return c},
triggerPasteEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.paste.key,properties:b})},triggerPannelActionEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push(b)},triggerSearchEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.search.key,properties:b})},triggerMarkupEvent:function(b){this.triggerSearchEvent(b)},triggerPannelTriggerEvent:function(b){AJS.EventQueue=
AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.trigger.key,properties:b})},triggerCustomizeColumnEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.customizeColumn.key,properties:b})}};
(function(b){b.aop.before({target:AJS.MacroBrowser,method:"loadMacroInBrowser"},function(a,d){a&&a[0]&&"confluence.extra.jira"==a[0].pluginKey&&AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.macroBrowser})});b.aop.before({target:tinymce.confluence.macrobrowser,method:"macroBrowserToolbarButtonClicked"},function(a,d){a&&a[0]&&a[0].presetMacroMetadata&&"confluence.extra.jira"==a[0].presetMacroMetadata.pluginKey&&AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.editorBraceKey})});
AJS.bind("init.rte",function(){b.aop.before({target:tinyMCE.activeEditor,method:"execCommand"},function(a,d){if(a&&"mceInsertContent"==a[0]&&a[2]&&(d=[Node.ELEMENT_NODE],a=b.parseHTML(a[2]),a.length)){var c=a[0];if(d.includes(c.nodeType)&&(d=c.getAttribute("data-macro-name"),["jira","jiraissues"].includes(d)&&(d=AJS.Editor.JiraAnalytics,a={source:"wiki_markup"},c.getAttribute("data-macro-parameters")))){c=c.getAttribute("data-macro-parameters").split("|");for(var f=0;f<c.length;f++){var e=b.trim(c[f]);
if(0==e.indexOf("jql")||0==e.indexOf("jqlQuery")){a.type=d.linkTypes.jqlDirect;break}else if(0==e.indexOf("url")){c=b.trim(e.substring(e.indexOf("\x3d")+1,e.length));a.type=AJS.JQLHelper.checkQueryType(c);break}else if(0==e.indexOf("http")){c=e;a.type=AJS.JQLHelper.checkQueryType(c);break}}"undefined"===typeof a.type&&(a.type=d.linkTypes.jqlDirect);d.triggerMarkupEvent(a)}}})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_jquery-selection-plugin', location = 'jquery-selection-plugin.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[21],{403:function(t,e,n){"use strict";n.r(e);var s=n(106),o=n.n(s),c=n(4);!function(t,e){if(e.selection){const n=function(t){return t.replace(/\u000D/g,"")};t.fn.selection=function(t){const n=this[0];if(this.focus(),!n)return!1;if(null==t)return e.selection.createRange().text;const{scrollTop:s}=n,o=e.selection.createRange();o.text=t,o.select(),n.focus(),n.scrollTop=s},t.fn.selectionRange=function(t,s){const o=this[0];this.focus();const c=e.selection.createRange();if(null==t){const t=this.val(),e=t.length,s=c.duplicate();s.moveToElementText(o),s.setEndPoint("StartToEnd",c);let i=e-n(s.text).length;s.setEndPoint("StartToStart",c);const l=e-n(s.text).length;return i!==l&&"\n"===t.charAt(i+1)&&(i+=1),{end:i,start:l,text:t.substring(l,i),textBefore:t.substring(0,l),textAfter:t.substring(i)}}c.moveToElementText(o),c.collapse(!0),c.moveStart("character",t),c.moveEnd("character",s-t),c.select()}}else t.fn.selection=function(t){const e=this[0];if(!e)return!1;if(null==t)return!!e.setSelectionRange&&e.value.substring(e.selectionStart,e.selectionEnd);const{scrollTop:n}=e;if(e.setSelectionRange){const{selectionStart:n}=e;e.value=e.value.substring(0,n)+t+e.value.substring(e.selectionEnd),e.selectionStart=n,e.selectionEnd=n+t.length}e.focus(),e.scrollTop=n},t.fn.selectionRange=function(t,e){if(null==t){const t={start:this[0].selectionStart,end:this[0].selectionEnd},e=this.val();return t.text=e.substring(t.start,t.end),t.textBefore=e.substring(0,t.start),t.textAfter=e.substring(t.end),t}this[0].selectionStart=t,this[0].selectionEnd=e};t.fn.wrapSelection=function(t,e){this.selection(t+this.selection()+(e||""))}}(o.a,c.document)}},[[403,0,1,4,9]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/datatable.js' */
(function(d){AJS.DataTable=function(a,b,c){c=null;a&&a.jquery?c=a:"string"==typeof a&&(c=d(a));c.addClass("data-table");if(b&&b.length){this.columns=b;a=d("\x3ctr\x3e\x3c/tr\x3e").appendTo(c);a.addClass("data-table-header");for(var e=0;e<b.length;e++){var f=b[e];a.append('\x3cth class\x3d"'+f.className+'"\x3e'+f.title+"\x3c/th\x3e")}}this.tbl=c;this.rowIdx=0};AJS.DataTable.prototype.addRow=function(a){for(var b=d("\x3ctr\x3e\x3c/tr\x3e").appendTo(this.tbl),c=this.columns,e=0;e<this.columns.length;e++){var f=
c[e],h=d("\x3ctd\x3e\x3c/td\x3e").appendTo(b);h.addClass(f.className);f.renderCell(h,a)}b.data("row-data",a);this._bindRowJs(b,this.rowIdx,"selected","hover");this.rowIdx+=1;b.attr("tabindex","-1")};AJS.DataTable.prototype.selectRow=function(a){a=d("tbody tr",this.tbl)[a+1];d(a).focus()};AJS.DataTable.prototype._bindRowJs=function(a,b,c,e){var f=this;a.click(function(g){c&&(d(f.tbl).find("."+c).removeClass(c),d(this).addClass(c));g=a.data("row-data");f.tbl.trigger("row-select",[g])});var h=function(g){switch(g.keyCode){case 13:var k,
l=a.data("row-data");a.keyup(k=function(m){f.tbl.trigger("row-action",[l]);a.unbind("keyup",k);m.stopPropagation();return!1});g.stopPropagation();return!1;case 38:return 0<b&&a.prev().focus(),g.stopPropagation(),!1;case 40:var n=d("tbody tr",f.tbl).length;b<n-1&&a.next().focus();g.stopPropagation();return!1}};d.browser.mozilla?a.keypress(h):a.keydown(h);a.focus(function(g){a.click()});e&&a.hover(function(){d(this).addClass(e)},function(){d(this).removeClass(e)})}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/dialogs.js' */
(function(){tinymce.create("tinymce.plugins.JiraLink",{init:function(e){e.addCommand("mceJiralink",AJS.Editor.JiraConnector.hotKey);e.on("PostRender",function(){AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:!1,success:function(k){AJS.Editor.JiraConnector.servers=k}});AJS.$("#jiralink").click(function(k){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorDropdownLink,!0);k.stopPropagation();return!1});AJS.$("#insert-menu .macro-jiralink").show();
e.addShortcut("ctrl+shift+j","","mceJiralink")})},getInfo:function(){return{longname:"Confluence Jira Connector",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("jiraconnector",tinymce.plugins.JiraLink)})();AJS.Editor.Adapter.addTinyMcePluginInit(function(e){e.plugins+=",jiraconnector";var k=e.theme_advanced_buttons1,p=k.indexOf("confimage");e.theme_advanced_buttons1=k.substring(0,p)+"jiralinkButton,"+k.substring(p)});
AJS.Editor.JiraConnector=function(e){var k=require("confluence/form-state-control"),p="\u63d2\u5165Jira\u95ee\u9898/\u8fc7\u6ee4\u5668",v="\u63d2\u5165",w="\u53d6\u6d88",q=AJS.format("\u63d0\u793a: \u5728\u7f16\u8f91\u5668\u4e2d\u8f93\u5165 \u0022{0}+Shift+J\u0022 \u8bbf\u95ee\u6b64\u5bf9\u8bdd\u6846\u3002",-1!=navigator.platform.toLowerCase().indexOf("mac")?"Cmd":"Ctrl"),l,m,f,x=function(){var a=e("#createPageLabelsString");0<a.length?(m=a.val().split(" ").join(),AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:l,
label:m})):e.getJSON(AJS.Meta.get("base-url")+"/rest/ui/1.0/content/"+AJS.Meta.get("page-id")+"/labels",function(c){var b=[];e.each(c.labels,function(h,n){b.push(n.name)});m=b.join();AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:l,label:m})})},t=function(a){if(!f){f=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-connector"});f.addHeader(p);for(var c=AJS.Editor.JiraConnector.Panels,b=0;b<c.length;b++){f.addPanel(c[b].title());var h=f.getCurrentPanel();c[b].init(h)}f.addLink("\u9009\u62e9\u5b8f",
function(){f.hide();AJS.MacroBrowser.open(!1)},"dialog-back-link");f.addHelpText(q);e("#jira-connector .dialog-tip").attr("title",q);f.addButton(v,function(){var g=f.getCurrentPanel().id;g=c[g];var r=c[0];AJS.Editor.JiraAnalytics&&(AJS.Editor.JiraConnector.analyticPanelActionObject=AJS.Editor.JiraAnalytics.setupAnalyticPanelActionObject(g,l,m),r.customizedColumn&&AJS.Editor.JiraAnalytics.triggerCustomizeColumnEvent({columns:r.customizedColumn}));g.insertLink()},"insert-issue-button");k.disableElement(AJS.$(".insert-issue-button"));
f.addCancel(w,function(){AJS.Editor.JiraConnector.closePopup()});f.gotoPanel(0);if(AJS.Editor.JiraConnector.servers)for(b=0;b<AJS.Editor.JiraConnector.servers.length;b++){var n=AJS.Editor.JiraConnector.servers[b];AppLinks.makeRequest({appId:n.id,type:"GET",url:"/rest/api/2/field",dataType:"json",serverIndex:b,success:function(g){g&&g.length&&(AJS.Editor.JiraConnector.servers[this.serverIndex].columns=g)},error:function(){AJS.log("Jira Issues Macro: unable to retrieve fields from AppLink: "+n.id)}})}e("#jira-connector ul.dialog-page-menu").append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-chart-dialog",
label:"Jira \u56fe\u8868"}));e("#jira-connector .dialog-page-menu button").click(function(){var g=AJS.Editor.JiraConnector.Panels[f.getCurrentPanel().id];g.setInsertButtonState&&g.setInsertButtonState();g.focusForm&&g.focusForm()});e("#open-jira-chart-dialog").click(function(){AJS.Editor.JiraConnector.closePopup();AJS.Editor.JiraChart&&AJS.Editor.JiraChart.open()})}AJS.Editor.JiraConnector.Panels[0].refreshSearchForm();if(a){f.gotoPanel(1);var d=AJS.Editor.JiraConnector.Panels[1];
d.setSummary(a);setTimeout(function(){d.focusForm&&d.focusForm()},0)}else f.gotoPanel(0);f.overrideLastTab();f.show()},u=function(){AJS.Editor.JiraConnector.clickConfigApplink&&AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:!1,success:function(a){AJS.Editor.JiraConnector.servers=a}});if("undefined"===typeof AJS.Editor.JiraConnector.servers||0===AJS.Editor.JiraConnector.servers.length)return AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin")),!1;AJS.Editor.JiraConnector.clickConfigApplink=
!1;AJS.Editor.JiraConnector.refreshAppLink&&(AJS.Editor.JiraConnector.refreshAppLink.call(),AJS.Editor.JiraConnector.refreshAppLink=!1);return!0};return{warningPopup:function(a){var c=new AJS.ConfluenceDialog({width:600,height:400,id:"warning-applink-dialog"}),b="Confluence \u8fde\u63a5\u5230 Jira";c.addHeader(b);b=Confluence.Templates.ConfluenceJiraPlugin.warningDialog({isAdministrator:a});c.addPanel("Panel 1",b);c.get("panel:0").setPadding(0);a?(c.addButton("\u8bbe\u7f6e\u8fde\u63a5",
function(h){AJS.Editor.JiraConnector.clickConfigApplink=!0;h.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();window.open(Confluence.getContextPath()+"/admin/listapplicationlinks.action").opener=null},"create-dialog-create-button app_link"),c.popup.element.find(".create-dialog-create-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary")):c.addButton("\u8054\u7cfb\u7ba1\u7406\u5458",function(h){h.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();
window.open(Confluence.getContextPath()+"/wiki/contactadministrators.action").opener=null});c.addLink("\u53d6\u6d88",function(h){h.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()});c.show();c.gotoPanel(0)},closePopup:function(){f.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},open:function(a,c){if(u()){AJS.Editor.Adapter.storeCurrentSelectionState();l=a;AJS.Editor.JiraAnalytics&&l&&(l===AJS.Editor.JiraConnector.source.instructionalText?
x():(m=null,AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:l})));a=tinymce.confluence.macrobrowser;var b=a.getCurrentNode();a.isMacroTag(b)&&"jira"==e(b).attr("data-macro-name")?a.editMacro(b):AJS.Editor.JiraConnector.openCleanDialog(c)}},openCleanDialog:function(a){a=a&&tinyMCE.activeEditor.selection&&tinyMCE.activeEditor.selection.getContent({format:"text"});t(a);AJS.Editor.JiraConnector.Panels[0].setMacroParams(null)},edit:function(a){if(u())if("undefined"==typeof a.params)AJS.Editor.JiraConnector.openCleanDialog(!1);
else{m=l="";var c={};if(a.params.url)c.searchStr=a.params.url;else{c.maximumIssues=a.params.maximumIssues;var b;if(!(b=a.defaultParameterValue))b:if(b=a.params,b.hasOwnProperty("jqlQuery"))b=b.jqlQuery;else{var h=/^([0-9]\d*)$/,n="count columns columnIds title renderMode cache width height server serverId anonymous baseurl showSummary".split(" ");for(d in b)if(-1==e.inArray(d,n)&&b.hasOwnProperty(d)){b=h.test(d)?b[d]:d+(" \x3d "+b[d]);break b}b=""}var d=b;c.searchStr="undefined"==typeof d?"":d;if("undefined"!=
typeof a.params.server)c.serverName=a.params.server;else for(d=0;d<AJS.Editor.JiraConnector.servers.length;d++)if(AJS.Editor.JiraConnector.servers[d].selected){c.serverName=AJS.Editor.JiraConnector.servers[d].name;break}c.columnIds=a.params.columnIds}d=a.params.count;"undefined"===typeof d&&(d="false");c.count=d;d=a.params.columns;"undefined"!=typeof d&&d.length&&(c.columns=d);a&&!AJS.Editor.inRichTextMode()&&e("#markupTextarea").selectionRange(a.startIndex,a.startIndex+a.markup.length);t();c.searchStr&&
(f.gotoPanel(0),d=AJS.Editor.JiraConnector.Panels[0],d.setMacroParams(c),a={searchValue:c.searchStr,serverName:c.serverName,isJqlQuery:a.params.hasOwnProperty("jqlQuery"),isAutoSearch:!0},d.doSearch(a))}},source:{macroBrowser:"macro_browser",editorBraceKey:"editor_brace_key",editorHotKey:"editor_hot_key",editorDropdownLink:"editor_dropdown_link",instructionalText:"instructional text"}}}(AJS.$);AJS.MacroBrowser.setMacroJsOverride("jira",{opener:AJS.Editor.JiraConnector.edit});
AJS.MacroBrowser.setMacroJsOverride("jiraissues",{opener:AJS.Editor.JiraConnector.edit});AJS.Editor.JiraConnector.Panels=[];AJS.Editor.JiraConnector.clickConfigApplink=!1;AJS.Editor.JiraConnector.hotKey=function(){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorHotKey,!0)};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/panelhelper.js' */
(function(AJS){var FormStateControl=require("confluence/form-state-control");AJS.Editor.JiraConnector.Panel=function(){};AJS.Editor.JiraConnector.Panel.prototype={SHOW_MESSAGE_ON_TOP:false,insertIssueLink:function(key){this.insertIssueLinkWithParams({"key":key})},insertJqlLink:function(jql){this.insertIssueLinkWithParams({"jqlQuery":jql})},insertIssueLinkWithParams:function(params){var insertMacroAtSelectionFromMarkup=function(macro){tinymce.confluence.macrobrowser.macroBrowserComplete(macro)};params["server"]=
this.selectedServer.name;params["serverId"]=this.selectedServer.id;if(AJS.Editor.inRichTextMode())insertMacroAtSelectionFromMarkup({name:"jira","params":params});else{var markup="{jira:";for(var key in params)markup=markup+key+"\x3d"+params[key]+"|";if(markup.charAt(markup.length-1)=="|")markup=markup.substr(0,markup.length-1);var textArea=AJS.$("#markupTextarea");var selection=textArea.selectionRange();textArea.selectionRange(selection.start,selection.end);textArea.selection(markup);selection=textArea.selectionRange();
textArea.selectionRange(selection.end,selection.end)}if(AJS.Editor.JiraAnalytics&&AJS.Editor.JiraConnector.analyticPanelActionObject){AJS.Editor.JiraAnalytics.triggerPannelActionEvent(AJS.Editor.JiraConnector.analyticPanelActionObject);AJS.Editor.JiraConnector.analyticPanelActionObject=null}AJS.Editor.JiraConnector.closePopup()},disableInsert:function(){FormStateControl.disableElement(AJS.$(".insert-issue-button"))},isInsertDisabled:function(){return AJS.$(".insert-issue-button").is(":disabled")},
getOAuthRealm:function(xhr){var authHeader=xhr.getResponseHeader("WWW-Authenticate")||"";var realmRegEx=/OAuth realm="([^"]+)"/;var matches=realmRegEx.exec(authHeader);if(matches)return matches[1];else return null},enableInsert:function(){FormStateControl.enableElement(AJS.$(".insert-issue-button"))},handleInsertWaiting:function(isWaiting){var $insertButton=AJS.$(".insert-issue-button");return isWaiting?$insertButton.before(aui.icons.icon({icon:"wait"})):$insertButton.prev(".aui-icon.aui-icon-wait").remove()},
msg:function(container,messageObject,messageType){if(aui&&aui.message)try{var auiMessageContainer=AJS.$('\x3cdiv class\x3d"aui-message-container"/\x3e');var message=messageObject;if(messageObject.html)message=messageObject.html();var templateParameters={"content":message};var formattedMessage;switch(messageType){case "error":formattedMessage=aui.message.error(templateParameters);break;case "success":formattedMessage=aui.message.success(templateParameters);break;case "warning":formattedMessage=aui.message.warning(templateParameters);
break;default:formattedMessage=aui.message.info(templateParameters)}auiMessageContainer.append(formattedMessage);messageObject=auiMessageContainer}catch(e){if(AJS&&AJS.logError)AJS.logError("jira-connector",e)}container.append(messageObject)},errorMsg:function(container,messageObject){this.removeError(container);var errorBlock=this.SHOW_MESSAGE_ON_TOP?AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').prependTo(container):AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').appendTo(container);
this.msg(errorBlock,messageObject,"error")},warningMsg:function(container,messageObject){this.removeError(container);var warningBlock=this.SHOW_MESSAGE_ON_TOP?AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').prependTo(container):AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').appendTo(container);this.msg(warningBlock,messageObject,"warning")},noServerMsg:function(container,messageObject){var dataContainer=AJS.$('\x3cdiv class\x3d"data-table jiraSearchResults" \x3e\x3c/div\x3e').appendTo(container);
var messagePanel=this.SHOW_MESSAGE_ON_TOP?AJS.$('\x3cdiv class\x3d"message-panel"/\x3e').prependTo(dataContainer):AJS.$('\x3cdiv class\x3d"message-panel"/\x3e').appendTo(dataContainer);this.msg(messagePanel,messageObject,"info")},ajaxError:function(xhr,onOauthFail){if(xhr.status==401){var authUrl=this.getOAuthRealm(xhr);this.selectedServer.authUrl=authUrl;onOauthFail.call(this)}else this.errorMsg(this.container,"\u4ece\u670d\u52a1\u5668\u63a5\u6536\u5230\u4e0b\u5217 HTTP\u9519\u8bef\u4ee3\u7801"+": "+xhr.status)},removeError:function(container){AJS.$("div.jira-error",
container).remove()},setActionOnEnter:function(input,f,source){input.unbind("keydown").keydown(function(e){if(e.which==13){var keyup=function(e){input.unbind("keyup",keyup);f(source);e.stopPropagation();return false};input.keyup(keyup);e.stopPropagation();return false}})},createOauthForm:function(success){var server=this.selectedServer;var oauthCallbacks={onSuccess:function(){server.authUrl=null;success(server)},onFailure:function(){}};var oauthMessage='\x3ca class\x3d"oauth-init" href\x3d"javascript:void(0)"\x3e'+
"\u767b\u5f55\u5e76\u5141\u8bb8"+"\x3c/a\x3e "+"\u63a5\u6536\u6570\u636e\u4ece"+" "+AJS.escapeHtml(this.selectedServer.name);var oauthForm=AJS.$('\x3cdiv class\x3d"jira-oauth-message-marker"/\x3e');if(!(aui&&aui.message))oauthForm.addClass("oauth-message");this.msg(oauthForm,oauthMessage,"info");AJS.$(".oauth-init",oauthForm).click(function(e){AppLinks.authenticateRemoteCredentials(server.authUrl,oauthCallbacks.onSuccess,oauthCallbacks.onFailure);e.preventDefault()});
return oauthForm},applinkServerSelect:function(container,onchange){var servers=AJS.Editor.JiraConnector.servers;AJS.$(servers).each(function(){var option="\x3coption ";if(this.selected){selectedServer=this;option+='selected\x3d"selected"'}option+='value\x3d"'+this.id+'"\x3e\x3c/option\x3e';option=AJS.$(option);option.text(this.name);AJS.$(container).append(option);option.data("jiraapplink",this)});AJS.$(container).change(function(e){var option=AJS.$("option:selected",container);var server=option.data("jiraapplink");
onchange(server)})},showSpinner:function(element,radius,centerWidth,centerHeight){AJS.$.data(element,"spinner",Raphael.spinner(element,radius,"#666"));if(centerWidth)AJS.$(element).css("marginLeft",-radius*1.2);if(centerHeight)AJS.$(element).css("marginTop",-radius*1.2)},hideSpinner:function(element){AJS.$(element).css("marginTop","");AJS.$(element).css("marginLeft","");var spinner=AJS.$.data(element,"spinner");if(spinner){spinner();delete spinner;AJS.$.data(element,"spinner",null)}},setSelectedIssue:function(issue){this.selectedIssue=
issue;this.enableInsert()},insertSelected:function(){if(this.selectedIssue)this.insertIssueLink(this.selectedIssue.key)},createIssueTableFromUrl:function(container,appId,url,selectHandler,enterHandler,noRowsHandler,onSuccess,onError,isShowCheckBox){AJS.$("div.data-table",container).remove();var dataContainer=AJS.$('\x3cdiv class\x3d"data-table jiraSearchResults" \x3e\x3c/div\x3e').appendTo(container);var spinnyContainer=AJS.$('\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e').appendTo(dataContainer);
this.removeError(container);this.showSpinner(spinnyContainer[0],50,true,true);var thiz=this;this.currentXhr=AppLinks.makeRequest({appId:appId,type:"GET",url:url,dataType:"xml",success:function(data){spinnyContainer.remove();var issues=AJS.$("item",data);FormStateControl.enableElement(AJS.$(":disabled",container));if(issues.length){var table=AJS.$('\x3ctable class\x3d"my-result aui"\x3e\x3c/table\x3e');AJS.$(".jiraSearchResults",container).append(table);var columns=[];if(isShowCheckBox){var checkBoxColumn=
{className:"issue-checkbox-column",title:'\x3cinput type\x3d"checkbox" name\x3d"jira-issue-all" checked/\x3e',renderCell:function(td,issue){var issueCheckbox=Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox({"issueKey":issue.key});AJS.$(issueCheckbox).appendTo(td)}};columns.push(checkBoxColumn)}var defaultColumns=[{className:"issue-key-column",title:"\u952e\u503c",renderCell:function(td,issue){var {rpcUrl,displayUrl}=thiz.selectedServer;var rebasedUrl=issue.iconUrl.replace(rpcUrl,
displayUrl);var issueKey=Confluence.Templates.ConfluenceJiraPlugin.issueKey({"issueIconUrl":rebasedUrl,"issueKey":issue.key});AJS.$(issueKey).appendTo(td)}},{className:"issue-summary-column",title:"\u6458\u8981",renderCell:function(td,issue){td.text(issue.summary)}}];columns=columns.concat(defaultColumns);var dataTable=new AJS.DataTable(table,columns);AJS.$(issues).each(function(){var issue={iconUrl:AJS.$("type",this).attr("iconUrl"),key:AJS.$("key",this).text(),summary:AJS.$("summary",
this).text(),url:AJS.$("link",this).text()};dataTable.addRow(issue)});table.bind("row-action",function(e,data){enterHandler.call(thiz,data)});table.bind("row-select",function(e,data){selectHandler.call(thiz,data)});dataTable.selectRow(0);if(onSuccess){var totalIssues=AJS.$("issue",data).attr("total");onSuccess.call(thiz,totalIssues)}}else{if(noRowsHandler)noRowsHandler();var message="\u6ca1\u6709\u641c\u7d22\u7ed3\u679c\u3002";var messagePanel=AJS.$('\x3cdiv class\x3d"message-panel"/\x3e');
thiz.msg(messagePanel,message,"info");AJS.$(".jiraSearchResults",container).append(messagePanel)}},error:function(xhr){FormStateControl.enableElement(AJS.$(":disabled",container));spinnyContainer.remove();onError.call(thiz,xhr)}})},retrieveJson:function(appId,url,onSuccess,onError){AppLinks.makeRequest({appId:appId,type:"GET",url:url,dataType:"json",success:onSuccess,error:onError})}}})(AJS);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/searchpanel.js' */
AJS.Editor.JiraConnector.Panel.Search=function(){this.jql_operators=/=|!=|~|>|<|!~| is | in /i};AJS.Editor.JiraConnector.Select2=AJS.Editor.JiraConnector.Select2||{};AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,{defaultColumns:"key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution",defaultColumnIds:"issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution",aliases:[{id:"issuekey",clauseName:"key"},{id:"issuetype",clauseName:"type"},{id:"duedate",clauseName:"due"}],DEFAULT_MAX_ISSUES_VAL:20,MAXIMUM_MAX_ISSUES_VAL:1E3,MINIMUM_MAX_ISSUES_VAL:1,
title:function(){return "\u641c\u7d22"},init:function(a){var c=require("confluence/form-state-control");a.html('\x3cdiv id\x3d"my-jira-search"\x3e\x3c/div\x3e');var b=this,d=AJS.$("#my-jira-search");this.container=d;var f=function(){d.children(":not(div.jira-search-form)").remove()},p=function(){c.enableElement(AJS.$("input.text,button",d))},n=function(){c.disableElement(AJS.$("input.text,button",d))},l=function(e){f();b.disableInsert();e&&(b.selectedServer=e);b.selectedServer.authUrl?
(n(),e=b.createOauthForm(function(){f();p()}),d.append(e)):(p(),AJS.$(".search-help").show())};this.authCheck=l;this.doSearch=function(e){var m=e&&e.searchValue,g=e&&e.serverName;m&&AJS.$("input:text",d).val(m);if(g&&g!=this.selectedServer.name){for(var q=AJS.Editor.JiraConnector.servers,t=!1,r=0;r<q.length;r++)if(q[r].name==g){AJS.$('option[value\x3d"'+q[r].id+'"]',d).attr("selected","selected");AJS.$("select",d).change();t=!0;break}if(!t){k(AJS.Meta.get("is-admin"));return}}this.currentXhr&&4!=
this.currentXhr.readyState||(g=m||AJS.$("input",d).val(),AJS.Editor.JiraAnalytics&&(m=AJS.JQLHelper.checkQueryType(g))&&AJS.Editor.JiraAnalytics.triggerSearchEvent({type:m,source:"dialog"}),m=function(w,v,x){v=d.find("#jiraIssueColumnSelector");var y=v.val()&&v.val();c.disableElement(AJS.$("select",d));n();b.lastSearch=w;b.createIssueTableFromUrl(d,b.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery\x3d"+encodeURIComponent(w)+"\x26returnMax\x3dtrue\x26tempMax\x3d20\x26field\x3dsummary\x26field\x3dtype\x26field\x3dlink",
b.selectHandler,b.insertLinkFromForm,function(){b.addDisplayOptionPanel();b.loadMacroParams(y);b.bindEventToDisplayOptionPanel(!0,e);b.enableInsert()},function(u){b.addDisplayOptionPanel();b.loadMacroParams(y);b.bindEventToDisplayOptionPanel(!1,e);b.updateTotalIssuesDisplay(u);b.checkAutoSelectColumns();e&&e.isAutoSearch&&b.focusForm()},function(u){b.disableInsert();400==u.status?x?x():(AJS.$("div.data-table",d).remove(),b.warningMsg(d,AJS.format("Jira\u670d\u52a1\u5668\u4e0d\u7406\u89e3\u60a8\u7684\u641c\u7d22\u67e5\u8be2\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86 JQL\uff0c\u8bf7\u786e\u4fdd\u5b83\u7684\u683c\u5f0f\u6b63\u786e\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86\u95ee\u9898\u5bc6\u94a5\uff0c\u8bf7\u786e\u4fdd\u5b83\u5b58\u5728\u5e76\u4e14\u60a8\u6709\u67e5\u770b\u6743\u9650\u3002 {0}",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))):
(AJS.$("div.data-table",d).remove(),b.ajaxError(u,l));e&&e.isAutoSearch&&b.focusForm()},!0)},AJS.JQLHelper.isFilterUrl(g)?(g=decodeURIComponent(g),q=AJS.JQLHelper.findServerIndexFromUrl(g,AJS.Editor.JiraConnector.servers),-1!=q?(AJS.$('option[value\x3d"'+AJS.Editor.JiraConnector.servers[q].id+'"]',d).attr("selected","selected"),AJS.$("select",d).change(),(g=AJS.JQLHelper.getFilterFromFilterUrl(g))?(AJS.$("input",d).val(g),m(g)):(f(),b.warningMsg(d,AJS.format("Jira\u670d\u52a1\u5668\u4e0d\u7406\u89e3\u60a8\u7684\u641c\u7d22\u67e5\u8be2\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86 JQL\uff0c\u8bf7\u786e\u4fdd\u5b83\u7684\u683c\u5f0f\u6b63\u786e\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86\u95ee\u9898\u5bc6\u94a5\uff0c\u8bf7\u786e\u4fdd\u5b83\u5b58\u5728\u5e76\u4e14\u60a8\u6709\u67e5\u770b\u6743\u9650\u3002 {0}",
Confluence.Templates.ConfluenceJiraPlugin.learnMore())))):(f(),b.disableInsert(),k(AJS.Meta.get("is-admin")))):AJS.JQLHelper.isIssueUrlOrXmlUrl(g)?(g=decodeURIComponent(g),g=AJS.JQLHelper.getJqlAndServerIndexFromUrl(g,AJS.Editor.JiraConnector.servers),h(g)&&(AJS.$("input",d).val(g.jqlQuery),m(g.jqlQuery,!1,null))):g.match(b.jql_operators)?m(g,!1,null):AJS.JQLHelper.isSingleKeyJQLExp(g)?m("key \x3d "+g,!0):AJS.JQLHelper.isMultipleSingleKeyJQLExp(g)?m("key in ("+g+")",!0):m('summary ~ "'+g+'" OR description ~ "'+
g+'"',!1,null))};b.addSearchForm();var h=function(e){if(-1!=e.serverIndex)if(AJS.$('option[value\x3d"'+AJS.Editor.JiraConnector.servers[e.serverIndex].id+'"]',d).attr("selected","selected"),AJS.$("select",d).change(),0==e.jqlQuery.length)f(),b.errorMsg(d,"Jira\u670d\u52a1\u5668\u4e0d\u7406\u89e3\u60a8\u7684\u641c\u7d22\u67e5\u8be2\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86 JQL\uff0c\u8bf7\u786e\u4fdd\u5b83\u7684\u683c\u5f0f\u6b63\u786e\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86\u95ee\u9898\u5bc6\u94a5\uff0c\u8bf7\u786e\u4fdd\u5b83\u5b58\u5728\u5e76\u4e14\u60a8\u6709\u67e5\u770b\u6743\u9650\u3002 {0}");else var m=e.jqlQuery;else f(),b.disableInsert(),k(AJS.Meta.get("is-admin"));return m};b.processJiraParams=h;var k=function(e){e=Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer({isAdministrator:e,
contextPath:Confluence.getContextPath()});b.noServerMsg(d,e);AJS.$("#open_applinks").bind("click",function(){AJS.Editor.JiraConnector.clickConfigApplink=!0;AJS.Editor.JiraConnector.refreshAppLink=function(){b.refreshSearchForm()}})};b.bindPasteEvent();AJS.$(a).select(function(){b.validate()});$(document).tooltip({live:".jql-display-opts-open.disabled",title:function(){return AJS.$(".jql-display-opts-open.disabled").data("title")},gravity:"s",delayIn:300,delayOut:0})},focusForm:function(){AJS.$('input[name\x3d"jiraSearch"]',
this.container).focus()},addSearchForm:function(){var a=this;a.container.empty();var c=AJS.Editor.JiraConnector.servers;a.selectedServer=c[0];var b=!1;1<c.length&&(b=!0);b=Confluence.Templates.ConfluenceJiraPlugin.searchForm({isMultiServer:b});b=AJS.$(b).appendTo(a.container);1<c.length&&(c=AJS.$('\x3cselect class\x3d"select" tabindex\x3d"0"\x3e\x3c/select\x3e').insertAfter("div.search-input",b),a.applinkServerSelect(c,a.authCheck));a.authCheck(a.selectedServer);AJS.$("button",a.container).click(function(){a.doSearch()});
a.setActionOnEnter(AJS.$("input.text",a.container),a.doSearch)},bindPasteEvent:function(){var a=this;AJS.$("#my-jira-search input:text").bind("paste",function(){var c=this;setTimeout(function(){var b=AJS.$(c).val();AJS.JQLHelper.isFilterUrl(b)?a.doSearch():AJS.JQLHelper.isIssueUrlOrXmlUrl(b)&&(b=decodeURIComponent(b),b=AJS.JQLHelper.getJqlAndServerIndexFromUrl(b,AJS.Editor.JiraConnector.servers),a.processJiraParams(b)&&(AJS.$(c).val(b.jqlQuery),a.doSearch()))},100)})},refreshSearchForm:function(){this.container.empty();
this.addSearchForm();this.bindPasteEvent()},validate:function(a,c){var b=this.container,d=AJS.$("input:checkbox[name\x3djira-issue]",b),f=AJS.Editor.JiraConnector.Panel.Search.prototype;d.length||a?(b=AJS.$("input:checkbox[name\x3djira-issue]:checked",b).length,0<b||a?f.enableInsert():f.disableInsert(),f.changeInsertOptionStatus(b,a,c)):(AJS.$(".jira-oauth-message-marker",b).length&&f.authCheck(this.selectedServer),AJS.$("input",b).focus(),f.disableInsert());f.isInsertDisabled()||f.validateMaxIssues()},
isValidMaxIssues:function(a){return AJS.$.isNumeric(a)&&this.MINIMUM_MAX_ISSUES_VAL<=a&&a<=this.MAXIMUM_MAX_ISSUES_VAL},validateMaxIssues:function(a){function c(){b.next("#jira-max-number-error").remove()}var b=AJS.$("#jira-maximum-issues");switch(AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()){case "insert-single":case "insert-count":c();b.attr("disabled","disabled");break;case "insert-table":var d=AJS.Editor.JiraConnector.Panel.Search.prototype;b.removeAttr("disabled");var f=b.val();
if(""===AJS.$.trim(f)){if(a&&"keyup"===a.type){c();break}if(a&&"blur"===a.type){f=d.MAXIMUM_MAX_ISSUES_VAL;b.val(f);break}}d.isValidMaxIssues(f)?(c(),d.enableInsert()):(c(),b.after(Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues()),d.disableInsert())}},customizedColumn:null,checkAndSetDefaultValueMaximumIssues:function(a){if(a){var c=a.element||AJS.$("#jira-maximum-issues");a=a.defaultVal||this.MAXIMUM_MAX_ISSUES_VAL;""===AJS.$.trim(c.val())&&c.val(a)}else AJS.log("Cannot set default value for Maximum Issues")},
setMacroParams:function(a){this.macroParams=a},getMacroParamsFromUserInput:function(){var a=this,c="insert-count"==AJS.$("input:radio[name\x3dinsert-advanced]:checked").val(),b=[],d=[],f=[],p=[],n=[],l={};AJS.$("#my-jira-search .my-result.aui input:checkbox[name\x3djira-issue]").each(function(h){h=AJS.$(this);h.is(":checked")?d[d.length]=h.val():f[f.length]=h.val()});if(c)l.count="true";else{if(!AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox){l.columns=this.defaultColumns;l.columnIds=this.defaultColumnIds;
return}b=AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.select2("data");b.length?(l.columns=b.map(function(h){return a.selectedServer.columns.find(function(k){return k.id===h.id}).custom?h.text.replace(/%/g,encodeURIComponent("%")).replace(/,/g,encodeURIComponent(",")).replace(/;/g,encodeURIComponent(";")):h.id}).map(function(h){var k=a.aliases.find(function(e){return e.id===h});return k?k.clauseName:h}).join(","),l.columnIds=b.map(function(h){return h.id}).join(","),(p=a.selectedServer.columns.find(function(h){return h.clauseNames.find(function(k){k=
k.toLowerCase();return"epic link"===k||"gh.epic.link.name"===k})}))&&!b.some(function(h){return h.id===p.id})&&(n=a.selectedServer.columns.filter(function(h){return h.clauseNames.find(function(k){k=k.toLowerCase();return"epic name"===k||"gh.epic.label.name"===k||"epic colour"===k||"gh.epic.color.name"===k||"epic status"===k||"gh.epic.status.name"===k})}),b.some(function(h){return n.some(function(k){return k.id===h.id})})&&(l.epicLinkId=p.id))):(l.columns=this.defaultColumns,l.columnIds=this.defaultColumnIds)}c=
AJS.$("input:radio[name\x3dinsert-advanced]:checked").val();"insert-single"===c?l.key=d.toString():l.jqlQuery=0==f.length?this.lastSearch+" ":1==d.length?"key \x3d "+d.toString():"key in ("+d.toString()+")";"insert-table"===c&&(l.maximumIssues=AJS.$("#jira-maximum-issues").val());return l},insertLinkFromForm:function(){var a=this.container;AJS.$("input:checkbox[name\x3djira-issue]",a).length&&0<AJS.$("input:checkbox[name\x3djira-issue]:checked",a).length&&this.insertLink()},insertLink:function(a){a=
a&&"function"===typeof a.insertIssueLinkWithParams?a:this;var c=a.getMacroParamsFromUserInput();a.insertIssueLinkWithParams(c);return!0},loadMacroParams:function(a){var c=this.macroParams;c?(c.maximumIssues||AJS.$("#jira-maximum-issues").attr("disabled","disabled"),"true"==c.count?AJS.$("#opt-total").prop("checked",!0):(AJS.$("#opt-table").prop("checked",!0),AJS.$("#jira-maximum-issues").removeAttr("disabled"),this.checkAndSetDefaultValueMaximumIssues({defaultVal:c.maximumIssues||this.DEFAULT_MAX_ISSUES_VAL}))):
this.checkAndSetDefaultValueMaximumIssues({defaultVal:20});this.prepareColumnSelect(a)},selectHandler:function(){var a=this.container.find("tr.selected");a.length&&a.unbind("keydown.space").bind("keydown.space",function(c){32!=c.which&&32!=c.keyCode||a.find("[type\x3dcheckbox]").trigger("click")})},addDisplayOptionPanel:function(){var a=Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml;AJS.$(".jiraSearchResults").after(a());AJS.$("#jiraMacroDlg").unbind("submit").on("submit",function(c){return!1})},
updateTotalIssuesDisplay:function(a){var c=this.selectedServer.url+"/issues/?jql\x3d"+this.lastSearch;20<a&&AJS.$(".my-result.aui").after(Confluence.Templates.ConfluenceJiraPlugin.viewAll({jiraIssuesLink:c}));a=AJS.format("{0}\u95ee\u9898",a);AJS.$(".total-issues-text").html(a);AJS.$(".total-issues-link").attr("href",c)},prepareColumnSelect:function(a){var c=this,b=!(this.macroParams&&!this.macroParams.columnIds),d=a||this.macroParams&&this.macroParams.columnIds&&this.macroParams.columnIds.split(",")||
this.macroParams&&this.macroParams.columns&&this.macroParams.columns.toLowerCase().split(",")||this.defaultColumnIds.split(","),f=this.selectedServer,p=function(n){var l=AJS.$("#jiraIssueColumnSelector"),h="",k="";n.filter(function(e){return e.navigable}).sort(function(e,m){var g=d.map(function(q){var t=c.aliases.find(function(r){return r.clauseName===q});return t?t.id:q});return g.indexOf(b||!e.custom?e.id:e.name.toLowerCase())-g.indexOf(b||!m.custom?m.id:m.name.toLowerCase())}).forEach(function(e){d.find(function(m){return b?
m===e.id:e.clauseNames.includes(m)||m===e.name.toLowerCase()})?k+=AJS.template('\x3coption selected\x3d"true" value\x3d"{fieldId}"\x3e{fieldName}\x3c/option\x3e').fill({fieldId:e.id,fieldName:e.name}):h+=AJS.template('\x3coption value\x3d"{fieldId}"\x3e{fieldName}\x3c/option\x3e').fill({fieldId:e.id,fieldName:e.name})});l.hide();l.html(k+h);l.show();l.auiSelect2({width:"415px",containerCssClass:"select2-container-jira-issue-columns"});AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox=l};f.columns&&
0<f.columns.length?p(f.columns):this.retrieveJson(f.id,"/rest/api/2/field",function(n){n&&n.length&&(f.columns=n,p(f.columns))})},expandDisplayOptPanel:function(){var a=AJS.$(".jql-display-opts-overlay"),c=a.height();a.css("top","");a.css("bottom",-(c-40)+"px");a.animate({bottom:0},500)},minimizeDisplayOptPanel:function(){var a=AJS.$(".jql-display-opts-overlay");a.css("top",a.position().top+"px");a.css("bottom","");a.animate({top:414},500)},disableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",
!1)},enableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",!0)},checkAutoSelectColumns:function(){AJS.$("#opt-table").prop("checked")?this.enableAutoSelectColumns():(this.disableAutoSelectColumns(),this.enableInsert())},bindEventToDisplayOptionPanel:function(a,c){var b=this,d=AJS.$(".jql-display-opts-close, .jql-display-opts-open"),f=AJS.$(".jql-display-opts-overlay"),p=AJS.$(".jql-display-opts-inner .radio"),n=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue-all]"),
l=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]");AJS.$("#jira-maximum-issues").on("blur keyup",AJS.Editor.JiraConnector.Panel.Search.prototype.validateMaxIssues);f.css("top","414px");d.click(function(h){h.preventDefault();AJS.$(this).hasClass("disabled")||(AJS.$(this).hasClass("jql-display-opts-open")?(b.expandDisplayOptPanel(),jQuery(this).addClass("jql-display-opts-close"),jQuery(this).removeClass("jql-display-opts-open")):(b.minimizeDisplayOptPanel(),jQuery(this).removeClass("jql-display-opts-close"),
jQuery(this).addClass("jql-display-opts-open")))});p.change(function(){b.checkAutoSelectColumns();b.validateMaxIssues()});n.bind("click",function(){AJS.$(this).prop("checked")?l.prop("checked","checked"):l.removeAttr("checked");b.validate()});l.change(function(){0<AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]:not(:checked)").length?n.removeAttr("checked"):n.prop("checked","checked");b.validate()});b.validate(a,c)},changeInsertOptionStatus:function(a,c,b){var d=AJS.$("#opt-single"),f=AJS.$("#opt-total"),
p=AJS.$("#opt-table"),n=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]:checked");a="checked"===AJS.$("#my-jira-search input:checkbox[name\x3djira-issue-all]").attr("checked");var l=1===n.length,h=1<n.length;n=0===n.length;var k=AJS.JQLHelper.isSingleKeyJQLExp(AJS.$("#my-jira-search input[name\x3djiraSearch]").val()),e=function(){b&&b.isJqlQuery?p.click():d.click()},m=function(){f.attr("disabled","disabled");p.removeAttr("disabled");d.removeAttr("disabled");e();setTimeout(function(){e()},
100)},g=function(){d.attr("disabled","disabled");f.removeAttr("disabled");"insert-single"===AJS.$("input[name\x3dinsert-advanced]:checked").val()&&setTimeout(function(){p.removeAttr("disabled").click()},100)},q=function(){p.removeAttr("disabled","disabled");f.removeAttr("disabled","disabled");d.removeAttr("disabled","disabled");"insert-single"===AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()&&setTimeout(function(){p.click()},100)};AJS.$(".jql-display-opts-open").removeClass("disabled");
d.removeAttr("disabled");f.removeAttr("disabled");p.removeAttr("disabled");a&&l&&k?m():a&&l&&!k?q():h?g():l&&!a?m():c?g():n&&(d.attr("disabled","disabled"),f.attr("disabled","disabled"),p.attr("disabled","disabled"),AJS.$(".jql-display-opts-close").click(),AJS.$(".jql-display-opts-open").addClass("disabled"))},isInsertTableType:function(){return"insert-table"===AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()},setInsertButtonState:function(){var a=AJS.$(".jql-display-opts-close, .jql-display-opts-open"),
c=AJS.$("#jira-maximum-issues");!a.length||a.length&&this.isInsertTableType()&&!this.isValidMaxIssues(c.val())?this.disableInsert():this.enableInsert()},analyticPanelActionName:"confluence.jira.plugin.searchadded"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Search);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/jip_createissuepanel.js' */
AJS.Editor.JiraConnector.Panel.Create=function(){};AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,{DEFAULT_PROJECT_VALUE:"-1",SHOW_MESSAGE_ON_TOP:!0,EXCLUDED_FIELDS:["project","issuetype","summary","description"],PROJECTS_META:{},setSummary:function(a){var b=AJS.$('.field-group [name\x3d"summary"]',this.jipForm.formEl);b.length&&b.val(a)},resetIssue:function(){AJS.$(".issue-summary",this.container).empty();AJS.$(".issue-description",this.container).empty()},focusForm:function(){var a=AJS.$("select.server-select",
this.container);a.length?a.focus():(a=AJS.$(".project-select",this.container),a.length&&a.focus())},authCheck:function(){this.selectedServer=this.jipForm.getCurrentServer();this.selectedServer.authUrl?this.showOauthChallenge():this.serverSelect()},ajaxAuthCheck:function(a){var b=this;this.endLoading();this.ajaxError(a,function(){b.authCheck(b.jipForm.getCurrentServer())})},showOauthChallenge:function(){AJS.$("div.field-group",this.container).not(".servers").hide();AJS.$(".jira-oauth-message-marker",
this.container).remove();var a=this,b=this.createOauthForm(function(){a.serverSelect()});this.container.append(b)},projectOk:function(){var a=AJS.$(".project-select option:selected",this.container).val();return a&&a.length&&a!=this.DEFAULT_PROJECT_VALUE},setInsertButtonState:function(){if(!1===this.formHasError&&this.projectOk())return this.enableInsert(),!0;this.disableInsert();return!1},startLoading:function(){var a=require("confluence/form-state-control");this.removeError(this.container);AJS.$(".loading-blanket",
this.container).removeClass("hidden");a.disableElement(AJS.$("input,select,textarea",this.container));this.disableInsert();this.handleInsertWaiting(!0)},endLoading:function(){var a=require("confluence/form-state-control");AJS.$(".loading-blanket",this.container).addClass("hidden");a.enableElement(AJS.$("input,select,textarea",this.container));AJS.$(".project-select",this.container).val()===this.DEFAULT_PROJECT_VALUE&&a.disableElement(AJS.$(".issuetype-select",this.container));this.setInsertButtonState();
this.handleInsertWaiting(!1)},bindEvent:function(){var a=this;AJS.$('.field-group [name\x3d"summary"]',this.jipForm.formEl).keyup(function(){a.setInsertButtonState()});this.container.on("focus","input[data-aui-dp-uuid]",function(){var b=AJS.$(this).attr("data-aui-dp-uuid");setTimeout(function(){AJS.$("[data-aui-dp-popup-uuid\x3d"+b+"]").parents(".aui-inline-dialog").addClass("datepicker-patch")},0)})},title:function(){return "\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4e8b\u52a1"},init:function(a){var b=this;
a.html('\x3cdiv class\x3d"create-issue-container"\x3e\x3c/div\x3e');this.container=AJS.$("div.create-issue-container");this.selectedServer=AJS.Editor.JiraConnector.servers[0];this.jipForm=new (require("jira-integration-plugin/jira-create-issue-form"))({container:".create-issue-container",renderSummaryAndDescription:!0,onError:function(){AJS.$(".field-group .error",this.container).remove();b.formHasError=!0;b.disableInsert()},onServerChanged:function(){AJS.$(".field-group .error",this.container).remove();
b.setInsertButtonState();b.selectedServer=this.getCurrentServer()},onRequiredFieldsRendered:function(f,d){AJS.$(".field-group .error",this.container).remove();b.formHasError=!!d.length;b.setInsertButtonState()},ajax:AJS.$.ajax});a.onselect=function(){b.onselect()};this.bindEvent()},convertFormToJSON:function(a){const b=require("jira-integration-plugin/fields");if(!b)return AJS.logError("Jira integration plugin is missing!"),"";var f={issues:[]},d={};d.fields={project:{id:AJS.$(".project-select option:selected",
a).val()},issuetype:{id:AJS.$(".issuetype-select option:selected",a).val()},summary:AJS.$('.field-group [name\x3d"summary"]',a).val(),description:AJS.$('.field-group [name\x3d"description"]',a).val()};a.children(".create-issue-required-fields").children(".jira-field").children("input,select,textarea").not(".select2-input").each(function(c,e){c=AJS.$(e);d.fields[c.attr("name")]=b.getJSON(c)});f.issues.push(d);return JSON.stringify(f)},validateRequiredFieldInForm:function(a){var b=!0,f="placeholder"in
document.createElement("input");a.find(".field-group .icon-required, .field-group .aui-icon-required").each(function(d,c){c=AJS.$(c).parent();d=c.text();var e=c.nextAll("input,select,textarea"),g=AJS.$.trim(e.val());if(!g||!f&&g==e.attr("placeholder"))b=!1,c=c.parent(),d=AJS.format("{0} \u5fc5\u586b",d),c.append(aui.form.fieldError({message:d}))});return b},clearFieldErrors:function(){AJS.$("form div.error",this.container).remove()},insertLink:function(){var a=this,b=Confluence.getContextPath()+
"/rest/jira-integration/1.0/issues",f=AJS.$("div.create-issue-container form"),d=this.jipForm.getCurrentServer();a.clearFieldErrors();a.validateRequiredFieldInForm(f)&&(this.startLoading(),AJS.$.ajax({type:"POST",contentType:"application/json",url:b+"?applicationId\x3d"+this.selectedServer.id,data:this.convertFormToJSON(f),success:function(c){var e=c&&c.issues&&c.issues[0]&&c.issues[0].issue&&c.issues[0].issue.key;e?(a.insertIssueLink(e,d.displayUrl+"/browse/"+e),a.resetIssue()):(_.isEmpty(c.errors[0].elementErrors.errorMessages)||
(e=Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel({errors:c.errors[0].elementErrors.errorMessages,serverUrl:d.displayUrl}),a.errorMsg(AJS.$("div.create-issue-container"),e)),_.each(c.errors[0].elementErrors.errors,function(g,h){g=aui.form.fieldError({message:g});AJS.$(AJS.format(".field-group [name\x3d{0}]",h),f).after(g)}));a.endLoading()},error:function(c,e){a.ajaxAuthCheck(c)}}))},onselect:function(){var a=!!AJS.$(".aui-message \x3e .oauth-init",this.container).length;this.selectedServer&&
!this.selectedServer.authUrl&&a?this.jipForm.defaultFields.server.trigger("change"):this.setInsertButtonState()},analyticPanelActionName:"confluence.jira.plugin.issuecreated"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Create);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/recentlyviewedpanel.js' */
AJS.Editor.JiraConnector.Panel.Recent=function(){};AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,{title:function(){return "\u6700\u8fd1\u6d4f\u89c8"},init:function(d){var a=AJS.Editor.JiraConnector.servers;d.html('\x3cdiv id\x3d"my-recent-issues" '+(1<a.length?'class\x3d"multi-server" ':"")+"\x3e\x3c/div\x3e");var b=this;this.selectedServer=a[0];1<a.length&&(a=AJS.$('\x3cdiv class\x3d"jira-server-select"\x3e\x3cform action\x3d"#" method\x3d"post" class\x3d"aui"\x3e\x3cdiv class\x3d"field-group"\x3e\x3clabel\x3eServer\x3c/label\x3e\x3cselect class\x3d"select" \x3e\x3c/select\x3e\x3c/div\x3e\x3c/form\x3e\x3c/div\x3e').appendTo("div#my-recent-issues"),
this.applinkServerSelect(AJS.$(".select",a),function(e){b.selectedServer=e;b.onselect()}));d.onselect=function(){b.onselect()}},insertLink:function(){this.insertSelected()},onselect:function(){var d=require("confluence/form-state-control"),a=this,b=AJS.$("div#my-recent-issues");this.container=b;var e=function(){b.children().not(".jira-server-select").remove()},g=function(){if(a.selectedServer.authUrl){e();var c=a.createOauthForm(function(){f()});b.append(c)}else f()};var f=function(){if(!a.currentXhr||
4==a.currentXhr.readyState){var c=AJS.$(".select",b);d.disableElement(c);e();a.createIssueTableFromUrl(b,a.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery\x3dkey+in+issueHistory()+ORDER+BY+lastViewed+DESC\x26field\x3dsummary\x26field\x3dtype\x26field\x3dlink\x26tempMax\x3d50\x26returnMax\x3dtrue",a.setSelectedIssue,a.insertLink,a.disableInsert,function(){c.length&&c.focus()},function(h){AJS.$("div.data-table",b).remove();a.ajaxError(h,g)},!1)}};g()},analyticPanelActionName:"confluence.jira.plugin.recentlyviewadded"});
AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Recent);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/dialog.soy' */
// This file was automatically generated from dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-bar data-table\'><a href="javascript:void(0)" class=\'jql-display-opts-open\' data-title="' + soy.$$escapeHtml('\u5982\u679c\u6ca1\u6709\u9009\u4e2d\u95ee\u9898\u5c06\u4e0d\u80fd\u663e\u793a\u9009\u9879\u6846\u3002') + '"><span></span><strong>' + soy.$$escapeHtml('\u663e\u793a\u64cd\u4f5c') + '</strong></a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-overlay data-table\' data-js="display-option-wrapper"><form id="jiraMacroDlg" class="aui" action="#"><div class=\'jql-display-opts-inner\'><a href="javascript:void(0)" class=\'jql-display-opts-open\' data-js="display-option-trigger" data-title="' + soy.$$escapeHtml('\u5982\u679c\u6ca1\u6709\u9009\u4e2d\u95ee\u9898\u5c06\u4e0d\u80fd\u663e\u793a\u9009\u9879\u6846\u3002') + '"><span></span><strong>' + soy.$$escapeHtml('\u663e\u793a\u64cd\u4f5c') + '</strong></a><fieldset class="group"><legend><span>' + soy.$$escapeHtml('\u663e\u793a\u4e3a') + '</span></legend><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-single\' value=\'insert-single\'><label for=\'opt-single\'>' + soy.$$escapeHtml('\u5355\u4e2a\u95ee\u9898') + '</label><div class=\'description\'>' + soy.$$escapeHtml('\u663e\u793a\u6b64\u5b8f\u4e3a\u5355\u4e2a\u95ee\u9898\u3002') + '</div></div><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-total\' value=\'insert-count\'><label for=\'opt-total\'>' + soy.$$escapeHtml('\u95ee\u9898\u603b\u6570') + '</label><div class=\'description\'>' + soy.$$escapeHtml('\u663e\u793a\u95ee\u9898\u603b\u6570\u7684\u94fe\u63a5') + '<a class=\'total-issues-link\' target=\'_blank\' href=\'#\'><span class=\'total-issues-text\'>' + soy.$$escapeHtml(AJS.format('{0}\u95ee\u9898',12)) + '</span></a></div></div><div class="radio"><input type=\'radio\' class=\'radio\' checked=\'checked\' name=\'insert-advanced\' id=\'opt-table\' value=\'insert-table\'><label for=\'opt-table\'>' + soy.$$escapeHtml('\u8868\u683c') + '</label><div class=\'description\'>' + soy.$$escapeHtml('\u5728\u4e0b\u65b9\u81ea\u5b9a\u4e49\u60a8\u7684\u5217\u3002') + '</div></div></fieldset><fieldset><div class="field-group"><label>' + soy.$$escapeHtml('\u6700\u5927\u95ee\u9898\u6570') + '</label><input type="text" name="jira-maximum-issues" id="jira-maximum-issues" class="text short-field" /><div class="description">' + soy.$$escapeHtml('\u7559\u7a7a\u5c06\u83b7\u53d6\u5168\u90e8\u95ee\u9898\u3002') + '</div></div></fieldset><fieldset><div class="field-group"><label>' + soy.$$escapeHtml('\u5f85\u663e\u793a\u7684\u5217') + '</label><select id="jiraIssueColumnSelector" data-placeholder="' + soy.$$escapeHtml('\u5f00\u59cb\u8f93\u5165\u4ee5\u67e5\u770b\u53ef\u80fd\u7684\u5217') + '" multiple="true" class="select long-field"></select></div></fieldset></div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.searchForm = function(opt_data, opt_ignored) {
  return '<div class=\'jira-search-form\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'search-input\'><input type=\'text\' class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('\u4f8b\u5982 \u8fc7\u6ee4\uff1d\u201c\u6211\u7684 Jira \u8fc7\u6ee4\u201d') + '"/></div>' : '<div class=\'search-input one-server\'><input type=\'text\' class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('\u4f8b\u5982 \u8fc7\u6ee4\uff1d\u201c\u6211\u7684 Jira \u8fc7\u6ee4\u201d') + '"/></div>') + '<button type=\'button\' title="' + soy.$$escapeHtml('\u641c\u7d22') + '" class=\'button\'><span class="aui-icon aui-icon-small aui-iconfont-search"></span></button></fieldset><div class=\'search-help\'>' + soy.$$escapeHtml('\u4f7f\u7528\u95ee\u9898\u5173\u952e\u5b57\u3001\u641c\u7d22URL\u3001Jira\u94fe\u63a5\u3001JQL\u6216\u7eaf\u6587\u672c\u8fdb\u884c\u641c\u7d22') + '</div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.searchForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.searchForm';
}


Confluence.Templates.ConfluenceJiraPlugin.warningDialog = function(opt_data, opt_ignored) {
  return '<div class=\'warning-body\'><p>' + soy.$$escapeHtml('Confluence \u8fde\u63a5\u5230 Jira \u540e\uff0c\u4f60\u53ef\u4ee5\u66f4\u7b80\u5355\u7684\u8fde\u63a5\u95ee\u9898...') + '</p>' + ((opt_data.isAdministrator == false) ? '<p>' + soy.$$escapeHtml('\u60a8\u7684\u7ba1\u7406\u5458\u53ef\u4ee5\u8bbe\u7f6e\u8fd9\u4e2a\u3002') + '</p>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningDialog.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningDialog';
}


Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox = function(opt_data, opt_ignored) {
  return '<input type=\'checkbox\' name=\'jira-issue\' value=\'' + soy.$$escapeHtml(opt_data.issueKey) + '\' checked/>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox';
}


Confluence.Templates.ConfluenceJiraPlugin.issueKey = function(opt_data, opt_ignored) {
  return '<span><img class="icon" src="' + soy.$$escapeHtml(opt_data.issueIconUrl) + '"/> ' + soy.$$escapeHtml(opt_data.issueKey) + '</span>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueKey.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueKey';
}


Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer = function(opt_data, opt_ignored) {
  return '' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('\u627e\u4e0d\u5230\u4e0eURL\u5339\u914d\u7684\u670d\u52a1\u5668\u3002') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('\u70b9\u51fb\u8fd9\u91cc\u8fdb\u884c\u6b64\u8bbe\u7f6e') + '</a>' : soy.$$escapeHtml('\u627e\u4e0d\u5230\u4e0eURL\u5339\u914d\u7684\u670d\u52a1\u5668\uff0c\u7ba1\u7406\u5458\u624d\u80fd\u8fdb\u884c\u8bbe\u7f6e\u3002') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('\u70b9\u51fb\u8fd9\u91cc\u8054\u7cfb\u4f60\u7684\u7ba1\u7406\u5458') + '</a>');
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer';
}


Confluence.Templates.ConfluenceJiraPlugin.viewAll = function(opt_data, opt_ignored) {
  return '<div class=\'view-all\'>' + soy.$$escapeHtml('\u663e\u793a\u593420\u4e2a\u7ed3\u679c\u3002') + '<a href=\'' + soy.$$escapeHtml(opt_data.jiraIssuesLink) + '\' target=\'_blank\'>' + soy.$$escapeHtml('\u67e5\u770b\u5168\u90e8\u3002') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.viewAll.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.viewAll';
}


Confluence.Templates.ConfluenceJiraPlugin.learnMore = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml('https://confluence.atlassian.com/display/DOC/Jira+Issues+Macro') + '" target=\'_blank\'>' + soy.$$escapeHtml('\u4e86\u89e3\u66f4\u591a') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.learnMore.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.learnMore';
}


Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart = function(opt_data, opt_ignored) {
  return '<div id="jira-chart-content-' + soy.$$escapeHtml(opt_data.chartType) + '"><div class=\'jira-chart-search\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'jira-chart-search-input\'><input type=\'text\' id="jira-chart-search-input" class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('\u4f8b\u5982 \u8fc7\u6ee4\uff1d\u201c\u6211\u7684 Jira \u8fc7\u6ee4\u201d') + '"/></div><select id="jira-chart-servers" class="select" name="server" tabindex="0"></select>' : '<div class=\'jira-chart-search-input one-server\'><input type=\'text\' id="jira-chart-search-input" class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('\u4f8b\u5982 \u8fc7\u6ee4\uff1d\u201c\u6211\u7684 Jira \u8fc7\u6ee4\u201d') + '"/></div>') + '<button id="jira-chart-search-button" type=\'button\' class=\'button\'>' + soy.$$escapeHtml('\u9884\u89c8') + '</button></fieldset><div class=\'search-help\'>' + soy.$$escapeHtml('\u4f7f\u7528\u95ee\u9898\u5173\u952e\u5b57\u3001\u641c\u7d22URL\u3001Jira\u94fe\u63a5\u3001JQL\u6216\u7eaf\u6587\u672c\u8fdb\u884c\u641c\u7d22') + '</div></form></div><div class="jira-chart-img"></div><div class="jira-chart-option" data-js="display-option-wrapper" ><form action="#" class="aui" id="jiraChartMacroOption"><div class="jiraChartOption"><a class="jirachart-display-opts-open" data-js="display-option-trigger" href="javascript:void(0)"><span class="display-option-icon"></span><strong>' + soy.$$escapeHtml('\u663e\u793a\u64cd\u4f5c') + '</strong></a>' + ((opt_data.chartType == 'pie') ? Confluence.Templates.ConfluenceJiraPlugin.piechartForm(null) : (opt_data.chartType == 'createdvsresolved') ? Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved(null) : (opt_data.chartType == 'twodimensional') ? Confluence.Templates.ConfluenceJiraPlugin.twoDimensional(null) : '') + '</div></form></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart';
}


Confluence.Templates.ConfluenceJiraPlugin.piechartForm = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="jira-chart-statType">' + soy.$$escapeHtml('\u56fe\u8868\u751f\u6210\u81ea') + '</label><select name="type" id="jira-chart-statType" class="select"></select></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('\u5bbd') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('\u6309\u50cf\u7d20\u70b9\u3001\u767e\u5206\u6bd4\u65b9\u5f0f\u8f93\u5165\u5bbd\u5ea6\uff0c\u6216\u4e0d\u8f93\u5165\u5185\u5bb9\u81ea\u52a8\u8c03\u6574\u5927\u5c0f') + '"></span><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-pie-chart-show-border">' + soy.$$escapeHtml('\u663e\u793a\u8fb9\u6846') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-pie-chart-show-infor">' + soy.$$escapeHtml('\u663e\u793a\u56fe\u8868\u4fe1\u606f') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.piechartForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.piechartForm';
}


Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="created-vs-resolved-chart-periodName">' + soy.$$escapeHtml('\u671f\u95f4') + '</label><select class="select" id="created-vs-resolved-chart-periodName" name="created-vs-resolved-chart-periodName"><option value="hourly">' + soy.$$escapeHtml('\u6bcf\u5c0f\u65f6') + '</option><option value="daily">' + soy.$$escapeHtml('\u6bcf\u65e5') + '</option><option value="weekly">' + soy.$$escapeHtml('\u6bcf\u5468') + '</option><option value="monthly">' + soy.$$escapeHtml('\u6bcf\u6708') + '</option><option value="quarterly">' + soy.$$escapeHtml('\u6bcf\u5b63') + '</option><option value="yearly">' + soy.$$escapeHtml('\u6bcf\u5e74') + '</option></select><div class="error"></div></div><div class="field-group"><label for="created-vs-resolved-chart-daysprevious">' + soy.$$escapeHtml('\u51e0\u5929\u4ee5\u524d') + '<span class="aui-icon icon-required"></span></label><input type="text" class="text" id="created-vs-resolved-chart-daysprevious" value="30"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment daysPreviousInfo" title="' + soy.$$escapeHtml('\u8981\u5305\u62ec\u7684\u5929\u6570\uff08\u4ece\u4eca\u5929\u5f80\u56de\u7b97\uff09\u3002') + '"></span><div class="error days-previous-error"></div></div><fieldset class="group"><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-cumulative" name="created-vs-resolved-chart-cumulative" class="checkbox"><label for="created-vs-resolved-chart-cumulative">' + soy.$$escapeHtml('\u7d2f\u8ba1') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment cumulativeInfo" title="' + soy.$$escapeHtml('\u9010\u6b65\u6dfb\u52a0\u603b\u8ba1 (1, 2, 3) \u6d3b\u7740\u663e\u793a\u5355\u4e2a\u7684\u503c(1,1,1)\u3002') + '"></span></div><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-showunresolvedtrend" name="created-vs-resolved-chart-showunresolvedtrend" class="checkbox"><label for="created-vs-resolved-chart-showunresolvedtrend">' + soy.$$escapeHtml('\u663e\u793a\u672a\u89e3\u51b3\u7684\u8d8b\u52bf') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment showunresolvedtrendInfo" title="' + soy.$$escapeHtml('\u5305\u62ec\u4e00\u4e2a\u663e\u793a\u672a\u89e3\u51b3\u7684\u95ee\u9898\u7684\u6b21\u8981\u60c5\u8282\u3002') + '"></span></div></fieldset><div class="field-group"><label for="created-vs-resolved-chart-versionLabel">' + soy.$$escapeHtml('\u663e\u793a\u7248\u672c') + '</label><select class="select" id="created-vs-resolved-chart-versionLabel" name="created-vs-resolved-chart-versionLabel"><option value="all">' + soy.$$escapeHtml('\u5168\u90e8\u7248\u672c') + '</option><option value="major">' + soy.$$escapeHtml('\u4ec5\u4e3b\u8981\u7248\u672c') + '</option><option value="none">' + soy.$$escapeHtml('\u65e0') + '</option></select><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment versionLabelInfo" title="' + soy.$$escapeHtml('\u6807\u8bb0\u8fd9\u4e2a\u56fe\u8868\u4e2d\u7684\u7248\u672c\u53d1\u5e03\u65e5\u671f\u3002') + '"></span><div class="error"></div></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('\u5bbd') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('\u6309\u50cf\u7d20\u70b9\u3001\u767e\u5206\u6bd4\u65b9\u5f0f\u8f93\u5165\u5bbd\u5ea6\uff0c\u6216\u4e0d\u8f93\u5165\u5185\u5bb9\u81ea\u52a8\u8c03\u6574\u5927\u5c0f') + '"></span><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-createdvsresolved-chart-show-border">' + soy.$$escapeHtml('\u663e\u793a\u8fb9\u6846') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-createdvsresolved-chart-show-infor">' + soy.$$escapeHtml('\u663e\u793a\u56fe\u8868\u4fe1\u606f') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved';
}


Confluence.Templates.ConfluenceJiraPlugin.twoDimensional = function(opt_data, opt_ignored) {
  return '<fieldset><div id="jira-chart-support-all-version" class="hidden"></div><div class="field-group"><label for="twodimensional-xaxis">' + soy.$$escapeHtml('X\u8f74') + '</label><select class="select" id="twodimensional-xaxis"><option value="statuses">' + soy.$$escapeHtml('\u72b6\u6001') + '</option><option value="priorities">' + soy.$$escapeHtml('\u4f18\u5148\u7ea7') + '</option><option value="assignees">' + soy.$$escapeHtml('\u7ecf\u529e\u4eba') + '</option><option value="allFixfor">' + soy.$$escapeHtml('\u4fee\u590d\u7248\u672c\uff08\u6240\u6709\uff09') + '</option><option value="components">' + soy.$$escapeHtml('\u7ec4\u4ef6') + '</option><option value="issuetype">' + soy.$$escapeHtml('\u4e8b\u52a1\u7c7b\u578b') + '</option></select></div><div class="field-group"><label for="twodimensional-yaxis">' + soy.$$escapeHtml('Y\u8f74') + '</label><select class="select" id="twodimensional-yaxis"><option value="statuses">' + soy.$$escapeHtml('\u72b6\u6001') + '</option><option value="priorities">' + soy.$$escapeHtml('\u4f18\u5148\u7ea7') + '</option><option value="assignees">' + soy.$$escapeHtml('\u7ecf\u529e\u4eba') + '</option><option value="allFixfor">' + soy.$$escapeHtml('\u4fee\u590d\u7248\u672c\uff08\u6240\u6709\uff09') + '</option><option value="components">' + soy.$$escapeHtml('\u7ec4\u4ef6') + '</option><option value="issuetype">' + soy.$$escapeHtml('\u4e8b\u52a1\u7c7b\u578b') + '</option></select></div><div class="field-group"><label for="twodimensional-number-of-result">' + soy.$$escapeHtml('\u663e\u793a\u7684\u884c') + '</label><input type="text" name="twodimensional-number-of-result" id="twodimensional-number-of-result" class="text short-field"><div class="error twodimensional-number-of-result-error"></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.twoDimensional.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.twoDimensional';
}


Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message error closeable shadowed"><span class=\'message\'>' + soy.$$escapeHtml(opt_data.message) + '</span><span class="aui-icon icon-close" role="button" tabindex="0"></span></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage';
}


Confluence.Templates.ConfluenceJiraPlugin.noServerWarning = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('\u627e\u4e0d\u5230\u4e0eURL\u5339\u914d\u7684\u670d\u52a1\u5668\u3002') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('\u70b9\u51fb\u8fd9\u91cc\u8fdb\u884c\u6b64\u8bbe\u7f6e') + '</a>' : soy.$$escapeHtml('\u627e\u4e0d\u5230\u4e0eURL\u5339\u914d\u7684\u670d\u52a1\u5668\uff0c\u7ba1\u7406\u5458\u624d\u80fd\u8fdb\u884c\u8bbe\u7f6e\u3002') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('\u70b9\u51fb\u8fd9\u91cc\u8054\u7cfb\u4f60\u7684\u7ba1\u7406\u5458') + '</a>') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.noServerWarning.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.noServerWarning';
}


Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><button class="item-button moreToCome"><a target="_blank" href="http://go.atlassian.com/confluencejiracharts">' + soy.$$escapeHtml('\u66f4\u591a...') + '</a></button></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink';
}


Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><hr><span class="aui-nav-heading jira-padding-left-10px"><strong>' + soy.$$escapeHtml('\u5176\u4ed6 Jira \u5185\u5bb9') + '</strong></span><nav class="aui-navgroup aui-navgroup-vertical"><div class="aui-navgroup-inner"><ul class="aui-nav"><li><button class="item-button jira-left-panel-link" id="' + soy.$$escapeHtml(opt_data.id) + '">' + soy.$$escapeHtml(opt_data.label) + '</button></li></ul></div></nav></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink';
}


Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('Jira\u670d\u52a1\u5668\u4e0d\u80fd\u7406\u89e3\u60a8\u7684\u67e5\u8be2\uff0c\u5982\u679c\u8f93\u5165\u7684\u662f JQL, \u8bf7\u786e\u4fdd\u8bed\u6cd5\u683c\u5f0f\u6b63\u786e\uff0c\u5982\u679c\u8f93\u5165\u7684\u662f\u95ee\u9898\u5173\u952e\u5b57\uff0c\u8bf7\u786e\u4fdd\u6b64\u95ee\u9898\u5b58\u5728\u5e76\u6709\u6743\u67e5\u770b\u3002') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn = function(opt_data, opt_ignored) {
  return '<div class="error width-error">' + ((opt_data.error == 'wrongFormat') ? soy.$$escapeHtml('\u5bbd\u5ea6\u5fc5\u987b\u4e3a\u6b63\u786e\u683c\u5f0f') : (opt_data.error == 'wrongNumber') ? soy.$$escapeHtml('\u5bbd\u5ea6\u5fc5\u987b\u662f100 \u81f3 9000\u4e4b\u95f4\u7684\u6570\u5b57') : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues = function(opt_data, opt_ignored) {
  return '<div id="jira-max-number-error" class="error">' + soy.$$escapeHtml('\u5fc5\u987b\u4e3a\u6570\u5b571\u81f31000\u3002') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues';
}


Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion = function(opt_data, opt_ignored) {
  return '<div class="jira-unsupported-version aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('Jira \u56fe\u8868\u5728\u6b64\u7248\u672cJira\u4e2d\u65e0\u6cd5\u4f7f\u7528\uff0c\u5347\u7ea7\u5230Jira 6.1.1 \u6216\u4ee5\u4e0a\u7248\u672c\u624d\u80fd\u4f7f\u7528\u6b64\u5b8f\u3002') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/create_issues.soy' */
// This file was automatically generated from create_issues.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui" id="create-issues-form"><div class="loading-blanket hidden"><div class="loading-data"></div></div><div class="field-group servers"><label>' + soy.$$escapeHtml('\u670d\u52a1\u5668') + '</label><select class="select server-select"></select></div><div class="field-group project-select-parent" ><label>' + soy.$$escapeHtml('\u9879\u76ee') + '</label><select class="select project-select" name="pid"></select></div><div class="field-group type-select-parent issues-type-group" ><label>' + soy.$$escapeHtml('\u4e8b\u52a1\u7c7b\u578b') + '</label><select class="select type-select" name="issuetype"></select></div><div class="field-group"><label>' + soy.$$escapeHtml('\u6982\u8981') + '<span class="aui-icon icon-required"></span></label><input class="text issue-summary" type="text" name="summary"/></div><div id="jira-required-fields-panel"></div><div class="field-group"><label>' + soy.$$escapeHtml('\u63cf\u8ff0') + '</label><textarea class="issue-description textarea" rows="5" name="description"></textarea></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOptions = function(opt_data, opt_ignored) {
  var output = '';
  var optionList15 = opt_data.options;
  var optionListLen15 = optionList15.length;
  for (var optionIndex15 = 0; optionIndex15 < optionListLen15; optionIndex15++) {
    var optionData15 = optionList15[optionIndex15];
    output += '<option value="' + soy.$$escapeHtml(optionData15.id) + '">' + soy.$$escapeHtml(optionData15.name) + '</option>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOptions.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOptions';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOption = function(opt_data, opt_ignored) {
  return '<option value="' + soy.$$escapeHtml(opt_data.option.id) + '" data-jira-option-key="' + soy.$$escapeHtml(opt_data.option.key) + '">' + soy.$$escapeHtml(opt_data.option.name) + '</option>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOption.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOption';
}


Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel = function(opt_data, opt_ignored) {
  var output = '<div>' + soy.$$escapeHtml('\u521b\u5efa\u95ee\u9898\u53d1\u751f\u9519\u8bef\u5728') + '<a target="_blank" href=' + soy.$$escapeHtml(opt_data.serverUrl) + '>Jira</a></div><ul>';
  var errorList36 = opt_data.errors;
  var errorListLen36 = errorList36.length;
  for (var errorIndex36 = 0; errorIndex36 < errorListLen36; errorIndex36++) {
    var errorData36 = errorList36[errorIndex36];
    output += '<li>' + soy.$$escapeHtml(errorData36) + '</li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:text-placeholders-jira', location = '/jira/placeholder.js' */
(function(){AJS.bind("init.rte",function(){AJS.bind("editor.text-placeholder.activated",function(b,a){a&&"jira"===a.placeholderType&&AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.instructionalText)});AJS.Rte.Placeholder&&AJS.Rte.Placeholder.addPlaceholderType&&AJS.Rte.Placeholder.addPlaceholderType({type:"jira",label:"Jira \u5b8f",tooltip:"\u8bf4\u660e\u6587\u672c\u5c06\u7528Jira\u5b8f\u66ff\u6362\u3002",activation:{click:!0,keypress:!1}})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-dialog.js' */
AJS.Editor.JiraChart=function(h){var l=require("confluence/form-state-control"),x="\u63d2\u5165",y="\u53d6\u6d88",z="\u63d2\u5165Jira\u56fe\u8868",c,d,u=function(a){if(!c){c=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-chart"});c.addHeader(z);d=AJS.Editor.JiraChart.Panels;for(var b=0;b<d.length;b++){"function"===typeof d[b].title?c.addPanel(d[b].title()):void 0!==d[b].title&&c.addPanel(d[b].title);
var f=c.getCurrentPanel();d[b].init(f)}h("#jira-chart ul.dialog-page-menu").show().append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-issue-dialog",label:"Jira\u95ee\u9898/\u8fc7\u6ee4\u5668"}));c.addButton(x,function(){var e=d[c.getCurrentPanel().id],g=e.chartType;0<c.getCurrentPanel().body.find("#jira-chart-content-"+g).length&&e.isImageChartExisted()?(e=e.getMacroParamsFromDialog(),t(e),AJS.Editor.JiraChart.close()):m(h("#jira-chart-content-"+e.chartType))},"insert-jira-chart-macro-button");
c.addLink("\u9009\u62e9\u5b8f",function(){c.hide();AJS.MacroBrowser.open(!1)},"dialog-back-link");c.addCancel(y,function(){AJS.Editor.JiraChart.close()})}AJS.$("#jira-chart .dialog-page-menu button").click(function(){var e=d[c.getCurrentPanel().id],g=c.getCurrentPanel().body,n=AJS.Editor.JiraChart.Helper.getSelectedServer(g);p(g,n);k(g);e.handleInsertButton();e.focusForm();e.resetDisplayOption()});b=c.getCurrentPanel().body;k(b);var q=q||function(e){var g={};_.each(e,
function(n,A){g[n.chartType]=A});return g}(d);B(q,a);r();b=c;f=b.gotoPanel;a=a&&a.params?q[a.params.chartType]:0;f.call(b,a);c.overrideLastTab();c.show();C()},D=function(){_.each(AJS.Editor.JiraChart.Panels,function(a){a.preBinding&&"function"===typeof a.preBinding&&a.preBinding()})},C=function(){h("#open-jira-issue-dialog").click(function(){AJS.Editor.JiraChart.close();AJS.Editor.JiraConnector&&AJS.Editor.JiraConnector.openCleanDialog(!1)})},m=function(a){void 0!==AJS.Editor.JiraChart.Helper.convertSearchTextToJQL(a)&&
d[c.getCurrentPanel().id].renderChart()},k=function(a){if(a.find("#jira-chart-support-all-version").length)return!0;var b=AJS.Editor.JiraChart.Helper.getSelectedServer(a).buildNumber;return-1==b||6109<=b&&6155>b?(a.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion()),a.find("#jira-chart-search-input").attr("disabled","disabled"),a.find("#jira-chart-search-button").attr("disabled","disabled"),a=a.find(".jirachart-display-opts-close, .jirachart-display-opts-open"),
a.hasClass("jirachart-display-opts-close")&&a.click(),a.addClass("disabled"),r(),!1):!0},t=function(a){AJS.Editor.inRichTextMode()&&tinymce.confluence.macrobrowser.macroBrowserComplete({name:"jirachart",params:a})},B=function(a,b){for(var f=0;f<d.length;f++)d[f].resetDialogValue();D();b&&b.params&&d[a[b.params.chartType]].bindingDataFromMacroToForm(b.params)},v=function(a){a.find(".jira-oauth-message-marker").remove();a.find(".jira-chart-img").empty();a.find("#jira-chart-search-input").empty()},r=
function(){l.disableElement(h("#jira-chart").find(".insert-jira-chart-macro-button"))},p=function(a,b){h(".jira-oauth-message-marker",a).remove();var f={selectedServer:b,msg:AJS.Editor.JiraConnector.Panel.prototype.msg};b&&b.authUrl&&(b=AJS.Editor.JiraConnector.Panel.prototype.createOauthForm.call(f,function(){h(".jira-oauth-message-marker",a).remove();AJS.Editor.JiraChart.search(a)}),a.find("div.jira-chart-search").append(b))},w=function(a){a.find("#jira-chart-search-input").removeAttr("disabled");
a.find("#jira-chart-search-button").removeAttr("disabled");a.find(".jirachart-display-opts-open").removeClass("disabled")};return{close:function(){c.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},edit:function(a){if(void 0===AJS.Editor.JiraConnector.servers||0===AJS.Editor.JiraConnector.servers.length){AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin"));var b=!1}else b=!0;b&&(u(a),b=c.getCurrentPanel().body,k(b)&&(w(b),void 0!==a.params&&void 0!==a.params.serverId&&m(b),
a=AJS.Editor.JiraChart.Helper.getSelectedServer(b),p(b,a)))},search:m,disableInsert:r,enableInsert:function(){var a=AJS.$("#jira-chart").find(".insert-jira-chart-macro-button");a.is(":disabled")&&l.enableElement(a)},disableSearch:function(a){l.disableElement(a.find("#jira-chart-search-button"))},enableSearch:function(a){a.find("#jira-chart-search-button").is(":disabled")&&l.enableElement(a.find("#jira-chart-search-button"))},insertJiraChartMacroWithParams:t,open:u,clearChartContent:v,loadServers:function(a){0<
AJS.Editor.JiraConnector.servers.length&&AJS.Editor.JiraConnector.Panel.prototype.applinkServerSelect(a.find("#jira-chart-servers"),function(b){v(a);k(a)&&(p(a,b),w(a))})},validateServerSupportedChart:k}}(AJS.$);AJS.Editor.JiraChart.Panels=[];AJS.MacroBrowser.setMacroJsOverride("jirachart",{opener:AJS.Editor.JiraChart.edit});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-helper.js' */
AJS.Editor.JiraChart.Helper=function(p){var m=/^\d+$/,f={},g=function(a){a=a&&"string"===typeof a?a.replace("px",""):"";"auto"===a&&(a="");0<a.indexOf("%")&&(a=4*a.replace("%",""));return a},k=function(a){return m.test(a)},h=function(a){var b=AJS.Editor.JiraConnector.servers;return 1<b.length?a.find("#jira-chart-servers option:selected").data("jiraapplink"):b[0]};return{getSelectedServer:h,bindingCommonChartElements:function(a){return{jql:a.find("#jira-chart-search-input"),width:a.find("#jira-chart-width"),
border:a.find(".jira-chart-show-border"),showinfor:a.find(".jira-chart-show-infor"),displayOption:a.find(".jirachart-display-opts-close, .jirachart-display-opts-open"),server:a.find("#jira-chart-servers")}},bindingCommonDataFromMacroToForm:function(a,b){a.jql.val(decodeURIComponent(b.jql));a.width.val(b.width);a.border.attr("checked","true"===b.border);a.showinfor.attr("checked","true"===b.showinfor);1<AJS.Editor.JiraConnector.servers.length&&a.server.val(b.serverId)},getCommonMacroParamsFromDialog:function(a,
b){b=h(b);return{jql:encodeURIComponent(a.jql.val()),width:g(a.width.val()),border:a.border.prop("checked"),showinfor:a.showinfor.prop("checked"),serverId:b.id,server:b.name,isAuthenticated:!b.authUrl}},getCommonChartParamsRequest:function(a,b){return{contentId:AJS.Meta.get("page-id"),macro:{name:"jirachart",params:{jql:a.jql,serverId:a.serverId,width:a.width,border:a.border,showinfor:a.showinfor,chartType:b}}}},convertSearchTextToJQL:function(a){var b=AJS.Editor.JiraConnector.servers,c=a.find("#jira-chart-search-input").val();
if(0===c.indexOf("http")){var e=AJS.JQLHelper.findServerIndexFromUrl(c,b);if(-1!==e)e=b[e].id,a.find("#jira-chart-servers").val(e);else{b=Confluence.Templates.ConfluenceJiraPlugin.noServerWarning({isAdministrator:AJS.Meta.get("is-admin"),contextPath:Confluence.getContextPath()});a.find(".jira-chart-img").html(b);AJS.Editor.JiraChart.disableInsert();return}}(b=AJS.JQLHelper.convertToJQL(c,e))?a.find("#jira-chart-search-input").val(b):(a.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid()),
AJS.Editor.JiraChart.disableInsert());return b},convertFormatWidth:g,isChartWidthValid:function(a){a.next().next(".width-error").remove();var b=g(a.val());if(b)if(k(b)){if(100>b||9E3<b)var c="wrongNumber"}else c="wrongFormat";return c?(a.next().after(Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn({error:c})),AJS.Editor.JiraChart.disableInsert(),!1):!0},isNumber:k,isJqlNotEmpty:function(a){return a?""!==AJS.$.trim(a.val())&&a.val()!==a.attr("placeholder"):!1},populateStatType:function(a,
b){var c=h(a);if(b){var e=f[c.id];e||AppLinks.makeRequest({appId:c.id,type:"GET",url:"/rest/gadget/1.0/statTypes",dataType:"json",async:!1,success:function(d){d&&(e=f[c.id]=d)},error:function(d){if(d)try{f[c.id]=JSON.parse(d.responseText),e=JSON.parse(d.responseText)}catch(n){AJS.error("Error contacting the server "+c.id+" with response "+d.response)}AJS.log("Jira Chart Macro: unable to retrieve statTypes from AppLink: "+c.id)}}).fail(function(d){if(d)try{f[c.id]=JSON.parse(d.responseText),e=JSON.parse(d.responseText)}catch(n){AJS.error("Error contacting the server "+
c.id+" with response "+d.response)}});var l="";e&&"undefined"!==typeof e.stats&&_.each(e.stats,function(d){l+="\x3coption value \x3d '"+d.value+"'\x3e"+AJS.escapeHtml(d.label)+" \x3c/option\x3e"});b.html(l)}}}}(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-panel.js' */
AJS.Editor.JiraChart.Panel=function(){};
AJS.Editor.JiraChart.Panel.prototype={init:function(a){var d=Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart({isMultiServer:1<AJS.Editor.JiraConnector.servers.length,chartType:this.chartType});a.html(d);this.container=AJS.$(this.containerId);AJS.Editor.JiraChart.clearChartContent(this.container);AJS.Editor.JiraChart.loadServers(this.container);this.bindingChartElements();this.bindingActions()},bindingActions:function(){var a=this,d=function(){a.isFormValid()?AJS.Editor.JiraChart.search(a.container):
AJS.Editor.JiraChart.disableInsert()};a.container.find(a.clickableElements).click(d);a.container.find(a.onChangeElements).change(d);a.chartElements.jql.change(function(){this.value!==a.jqlWhenEnterKeyPress&&(a.container.find(".jira-chart-img").empty(),AJS.Editor.JiraChart.disableInsert());a.jqlWhenEnterKeyPress=""}).bind("paste",function(){setTimeout(function(){a.isFormValid()&&(a.jqlWhenEnterKeyPress=a.chartElements.jql.val(),AJS.Editor.JiraChart.search(a.container))},100)});var c=a.container.find("input[type\x3d'text']");
c.unbind("keydown").keydown(function(b){if(13==b.which){var f=function(e){c.unbind("keyup",f);a.isFormValid()&&AJS.Editor.JiraChart.search(a.container);"jira-chart-search-input"===c.attr("id")&&(a.jqlWhenEnterKeyPress=c.val());e.stopPropagation();return!1};c.keyup(f);b.stopPropagation();return!1}});a.bindSelectOption();a.bindingServerChange()},bindingServerChange:function(){var a=this;a.chartElements.server.change(function(){a.isFormValid()&&AJS.Editor.JiraChart.validateServerSupportedChart(a.container)?
AJS.Editor.JiraChart.search(a.container):AJS.Editor.JiraChart.disableInsert()})},renderChart:function(){var a=this,d=this.getChartParamsRequest(),c=Confluence.getContextPath()+"/rest/tinymce/1/macro/preview",b=this.container.find(".jira-chart-img");b.html('\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e');var f=b.find(".loading-data")[0];AJS.$.data(f,"spinner",Raphael.spinner(f,50,"#666"));a.request&&a.request.abort();a.request=AJS.$.ajax({url:c,type:"POST",contentType:"application/json",data:JSON.stringify(d)}).done(function(e){b.html("").hide();
var g=AJS.$('\x3ciframe frameborder\x3d"0" id\x3d"chart-preview-iframe"\x3e\x3c/iframe\x3e');g.appendTo(b);var k=g[0].contentWindow,h=k.document;g.on("load",function(){k.AJS.$("#main").addClass("chart-preview-main");b.show();a.handleInsertButton()});e=e.replace("window.onload","var chartTest");h.open();h.write(e);h.close()}).error(function(e){"abort"!=e.statusText&&(AJS.log("Jira Chart Macro - Fail to get data from macro preview"),b.html(Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage({message:"\u4e0d\u80fd\u5448\u73b0Jira\u56fe\u8868\u5b8f\uff0c\u53d1\u751f\u8fd0\u884c\u9519\u8bef\u3002"})));
AJS.Editor.JiraChart.disableInsert()})},resetDialogValue:function(){var a=AJS.$("input",this.container);a.filter(":text").val("");a.filter(":checked").removeAttr("checked");this.container.find("#jira-chart-search-input").val();this.container.find(".jira-chart-img").empty();this.resetDisplayOption()},resetDisplayOption:function(){var a=this,d=this.chartElements.displayOption;d.addClass("jirachart-display-opts-open");d.removeClass("jirachart-display-opts-close");setTimeout(function(){var c=a.container.find(".jira-chart-option");
c.scrollTop(0);c.css({overflow:"hidden",top:"430px"})},0)},bindSelectOption:function(){var a=this.container.find(".jira-chart-option"),d=function(c){var b=a.position().top+"px",f="",e={top:430};c?(b="",f=40-a.find("#jiraChartMacroOption").height()+"px",e={bottom:0},a.css("overflow","auto")):a.css("overflow","hidden");a.css("top",b);a.css("bottom",f);a.animate(e,500)};a.css("top","430px");this.chartElements.displayOption.click(function(c){var b=AJS.$(this);c.preventDefault();b.hasClass("disabled")||
(b.hasClass("jirachart-display-opts-open")?(d(!0),b.addClass("jirachart-display-opts-close"),b.removeClass("jirachart-display-opts-open")):(d(),b.removeClass("jirachart-display-opts-close"),b.addClass("jirachart-display-opts-open")))})},isImageChartExisted:function(){return 0<this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-img").length},focusForm:function(){this.container.find("#jira-chart-search-input").focus()},handleInsertButton:function(){this.isFormValid()&&this.isResultValid()?
AJS.Editor.JiraChart.enableInsert():AJS.Editor.JiraChart.disableInsert()}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/piechart-panel.js' */
AJS.Editor.JiraChart.Panel.PieChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var b=this;this.title="\u997c\u56fe";this.chartType="pie";this.containerId="#jira-chart-content-pie";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor";this.onChangeElements="#jira-chart-statType, #jira-chart-width";this.isFormValid=function(){return AJS.Editor.JiraChart.Helper.isChartWidthValid(b.chartElements.width)&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};
this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.bindingActions=function(){AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(this);this.container.find(".widthInfo").tooltip({gravity:"w"})};this.bindingServerChange=function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.statType);b.isFormValid()?AJS.Editor.JiraChart.search(b.container):
AJS.Editor.JiraChart.disableInsert()})};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.statType=this.container.find("#jira-chart-statType")};this.getChartParamsRequest=function(){var a=this.getMacroParamsFromDialog(),c=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(a,this.chartType);c.macro.params.statType=a.statType;return c};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,
this.container);a.chartType="pie";a.statType=this.chartElements.statType.val();return a};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(this.chartElements,a),this.chartElements.statType.val(a.statType))};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#jira-chart-statType"))}};AJS.Editor.JiraChart.Panel.PieChart.prototype=AJS.Editor.JiraChart.Panel.prototype;
AJS.Editor.JiraChart.Panel.PieChart.prototype.constructor=AJS.Editor.JiraChart.Panel.PieChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.PieChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/createdvsresolvedchart-panel.js' */
AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart=function(e){AJS.Editor.JiraChart.Panel.call(this);var c=this,f=function(){c.container.find("#created-vs-resolved-chart-periodName").val("daily");c.container.find("#created-vs-resolved-chart-daysprevious").val("30")},g=function(){var a=c.chartElements.periodName.val(),b=e.trim(c.chartElements.daysprevious.val()),d=c.container.find(".days-previous-error");if(""===b)return c.container.find(".days-previous-error").html("\u4e4b\u524d\u7684\u5929\u6570\u662f\u5fc5\u586b\u5b57\u6bb5\u3002"),
!1;if(!AJS.Editor.JiraChart.Helper.isNumber(b)||0>b)return d.html("\u4e4b\u524d\u7684\u5929\u6570\u5fc5\u987b\u662f\u4e00\u4e2a\u6b63\u6570\u3002"),!1;switch(a){case "hourly":(isValid=10>=b)||d.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",10,a));break;case "daily":(isValid=300>=b)||d.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",300,a));break;case "weekly":(isValid=1750>=b)||d.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",
1750,a));break;case "monthly":(isValid=7500>=b)||d.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",7500,a));break;case "quarterly":(isValid=22500>=b)||d.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",22500,a));break;case "yearly":(isValid=36500>=b)||d.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",36500,a));break;default:isValid=!1}isValid&&d.empty();return isValid};this.title="\u521b\u5efaVS\u89e3\u51b3";
this.chartType="createdvsresolved";this.containerId="#jira-chart-content-createdvsresolved";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #created-vs-resolved-chart-cumulative, #created-vs-resolved-chart-showunresolvedtrend";this.onChangeElements="#created-vs-resolved-chart-periodName, #created-vs-resolved-chart-daysprevious, #created-vs-resolved-chart-versionLabel, #jira-chart-width";this.isFormValid=function(){var a=AJS.Editor.JiraChart.Helper.isChartWidthValid(c.chartElements.width);
return g()&&a&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(c.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.init=function(a){AJS.Editor.JiraChart.Panel.prototype.init.call(this,a);f()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.periodName=this.container.find("#created-vs-resolved-chart-periodName");
this.chartElements.daysprevious=this.container.find("#created-vs-resolved-chart-daysprevious");this.chartElements.isCumulative=this.container.find("#created-vs-resolved-chart-cumulative");this.chartElements.showUnresolvedTrend=this.container.find("#created-vs-resolved-chart-showunresolvedtrend");this.chartElements.versionLabel=this.container.find("#created-vs-resolved-chart-versionLabel")};this.bindingActions=function(){AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(this);this.container.find(".widthInfo").tooltip({gravity:"w"});
this.container.find(".showunresolvedtrendInfo").tooltip({gravity:"w"});this.container.find(".cumulativeInfo").tooltip({gravity:"w"});this.container.find(".versionLabelInfo").tooltip({gravity:"w"});this.container.find(".daysPreviousInfo").tooltip({gravity:"w"})};this.getChartParamsRequest=function(){var a=this.getMacroParamsFromDialog(),b=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(a,this.chartType);b.macro.params.periodName=a.periodName;b.macro.params.daysprevious=a.daysprevious;b.macro.params.isCumulative=
a.isCumulative;b.macro.params.showUnresolvedTrend=a.showUnresolvedTrend;b.macro.params.versionLabel=a.versionLabel;return b};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);a.chartType="createdvsresolved";a.periodName=this.chartElements.periodName.val();a.daysprevious=e.trim(this.chartElements.daysprevious.val());a.isCumulative=this.chartElements.isCumulative.prop("checked");a.showUnresolvedTrend=this.chartElements.showUnresolvedTrend.prop("checked");
a.versionLabel=this.chartElements.versionLabel.val();return a};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);f()};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(c.chartElements,a),c.chartElements.isCumulative.attr("checked","false"!==a.isCumulative),c.chartElements.showUnresolvedTrend.attr("checked","true"===a.showUnresolvedTrend),c.chartElements.periodName.val(""===a.periodName?"daily":
a.periodName),c.chartElements.versionLabel.val(a.versionLabel),c.chartElements.daysprevious.val(""===a.daysprevious?"30":a.daysprevious))}};AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype.constructor=AJS.Editor.JiraChart.Panels.CreatedVsResolvedChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/twodimensionalchart-panel.js' */
AJS.Editor.JiraChart.Panel.TwoDimensionalChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var b=this,e=function(){b.chartElements.numberToShow.val(5);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.title="\u4e8c\u7ef4";this.chartType="twodimensional";this.containerId="#jira-chart-content-twodimensional";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #twodimensional-show-total";
this.onChangeElements="#twodimensional-xaxis, #twodimensional-yaxis, #twodimensional-number-of-result";this.isFormValid=function(){var a=d(".twodimensional-number-of-result-error");var c=b.chartElements.numberToShow.val();AJS.Editor.JiraChart.Helper.isNumber(c)&&0<c?(a.empty(),a=!0):(a.html("\u884c\u6570\u5e94\u8be5\u662f\u4e00\u4e2a\u6b63\u6574\u6570"),a=!1);return a&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length};
this.init=function(a){AJS.Editor.JiraChart.Panel.prototype.init.call(this,a);e()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.xstattype=this.container.find("#twodimensional-xaxis");this.chartElements.ystattype=this.container.find("#twodimensional-yaxis");this.chartElements.sortBy=this.container.find("#twodimensional-sortby");this.chartElements.sortDirection=this.container.find("#twodimensional-sort-direction");
this.chartElements.showTotals=this.container.find("#twodimensional-show-total");this.chartElements.numberToShow=this.container.find("#twodimensional-number-of-result")};this.getChartParamsRequest=function(){var a=this.getMacroParamsFromDialog(),c=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(a,this.chartType);c.macro.params.xstattype=a.xstattype;c.macro.params.ystattype=a.ystattype;c.macro.params.sortBy=a.sortBy;c.macro.params.sortDirection=a.sortDirection;c.macro.params.showTotals=a.showTotals;
c.macro.params.numberToShow=a.numberToShow;return c};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);a.chartType="twodimensional";a.xstattype=this.chartElements.xstattype.val();a.ystattype=d.trim(this.chartElements.ystattype.val());a.sortBy=d.trim(this.chartElements.sortBy.val());a.sortDirection=d.trim(this.chartElements.sortDirection.val());a.showTotals=this.chartElements.showTotals.prop("checked");a.numberToShow=
this.chartElements.numberToShow.val();return a};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(b.chartElements,a),b.chartElements.xstattype.val(a.xstattype),b.chartElements.ystattype.val(a.ystattype),b.chartElements.sortBy.val(a.sortBy),b.chartElements.sortDirection.val(a.sortDirection),b.chartElements.showTotals.attr("checked","true"===a.showTotals),b.chartElements.numberToShow.val(a.numberToShow))};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);
e()};this.isImageChartExisted=function(){return 0<this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-xaxis"));AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-yaxis"));b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.bindingServerChange=
function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.xstattype);AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.ystattype);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees");b.isFormValid()?AJS.Editor.JiraChart.search(b.container):AJS.Editor.JiraChart.disableInsert()})}};AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype=AJS.Editor.JiraChart.Panel.prototype;
AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype.constructor=AJS.Editor.JiraChart.Panel.TwoDimensionalChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.TwoDimensionalChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-support-util', location = 'support/atlassian-editor-support.js' */
define("confluence-editor/support/atlassian-editor-support",["ajs","confluence/meta"],function(c,b){return{inlineTasks:function(){var a=b.get("use-inline-tasks");return"true"===a||!0===a},isCollaborativeContentType:function(){var a=b.get("content-type");return b.get("collaborative-content")&&("page"===a||"blogpost"===a)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/support/atlassian-editor-support","AJS.Rte.Support");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/is-valid-uri.js' */
define("confluence-collaborative-editor-plugin/util/is-valid-uri",[],function(){function d(a,c){var b=a.lastIndexOf(c);return-1!==b&&b===a.length-c.length}var e=/^(((?![':"<>])[\s-\$\+<->\^`\|~-------------------------------------------------------------------------!-#%-\*,-/:;\?@\[-\]_\{\}-------------------------------------------------A-Za-z-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9-------------------------------------------------------------])+|\#(\w)+)$/,
f=/^(?:\s*(?:([a-zA-Z]*):\/\/|mailto:|skype:|callto:|facetime:|git:|irc:|irc6:|news:|nntp:|feed:|cvs:|svn:|mvn:|ssh:|itms:|notes:|smb:|sourcetree:|urn:|tel:|xmpp:|telnet:|vnc:|rdp:|whatsapp:|slack:|sip:|sips:|magnet:)[A-Za-z-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9-------------------------------------------------------------\/]+(?:(?!['"<>])[\s-\$\+<->\^`\|~-------------------------------------------------------------------------!-#%-\*,-/:;\?@\[-\]_\{\}-------------------------------------------------A-Za-z-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9-------------------------------------------------------------])*(?:\s)*)$/;
return function(a){if(null===a)return!1;var c=e.test(a),b=(a=a.match(f))&&a.length&&a[1];a=a&&a.length&&(!b||!d(b,"script")&&!d(b,"data"));return c||a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/template/synchrony-presence.soy' */
// This file was automatically generated from synchrony-presence.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.SynchronyPresence.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.SynchronyPresence == 'undefined') { Confluence.Templates.SynchronyPresence = {}; }


Confluence.Templates.SynchronyPresence.container = function(opt_data, opt_ignored) {
  return '<ul id="avatar-list" class="synchrony-doc-' + soy.$$escapeHtml(opt_data.docId) + ' collaborative-avatars-list"></ul><aui-inline-dialog id="more-avatars" alignment="bottom right" responds-to="toggle" aria-hidden="true"><h3>' + soy.$$escapeHtml('\u4e5f\u662f\u7f16\u8f91\u8fc7\u7684') + '</h3><ul id="more-avatars-list" class="collaborative-avatars-list"></ul></aui-inline-dialog>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.container.soyTemplateName = 'Confluence.Templates.SynchronyPresence.container';
}


Confluence.Templates.SynchronyPresence.avatar = function(opt_data, opt_ignored) {
  return '<li class="avatar-item' + ((opt_data.active) ? ' p' + soy.$$escapeHtml(opt_data.telepointer) + ' active' : '') + ((opt_data.currentUser) ? ' no-animate-entry' : '') + '"><span title="' + soy.$$escapeHtml(opt_data.title) + '" avatar="' + soy.$$escapeHtml(opt_data.initial) + '"' + ((opt_data.active) ? ' data-origin="' + soy.$$escapeHtml(opt_data.origin) + '"' : '') + ' class="avatar' + ((opt_data.active) ? ' active' : '') + '"' + ((opt_data.username) ? ' data-username="' + soy.$$escapeHtml(opt_data.username) + '"' : '') + '><img src="' + soy.$$escapeHtml(opt_data.avatarUrl) + '" alt="' + soy.$$escapeHtml(AJS.format('{0} \u7684\u4e2a\u4eba\u8d44\u6599\u5934\u50cf',opt_data.username)) + '"/></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.avatar.soyTemplateName = 'Confluence.Templates.SynchronyPresence.avatar';
}


Confluence.Templates.SynchronyPresence.overlay = function(opt_data, opt_ignored) {
  return '<span id="synchrony-presence-overlay" class="overlay avatar"><a href="#" aria-controls="more-avatars" class="aui-button" data-aui-trigger></a></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.overlay.soyTemplateName = 'Confluence.Templates.SynchronyPresence.overlay';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-presence.js' */
define("confluence-collaborative-editor-plugin/synchrony-presence","backbone confluence-collaborative-editor-plugin/avatar-list-view confluence-collaborative-editor-plugin/overlay-view ajs confluence/legacy confluence/meta confluence/templates jquery underscore".split(" "),function(A,B,u,e,C,f,D,l,h){function v(){q=l(D.SynchronyPresence.container({docId:C.getContentId()}));l("#rte-toolbar").append(q);new B({el:"#avatar-list",collection:c});m=new u({collection:c});l("#rte-toolbar").append(m.render())}
function w(b){var a=l.extend({},b);a.id=b.origin;a.fullname=b.fullname||"\u533f\u540d\u7528\u6237";a.name=b.name||"anonymous";a.username=b.name;a.avatarURL=e.contextPath()+b.avatarURL;a.active=b.active||!0;a.currentUser=b.currentUser||r===b.origin;return a}function E(){return c.filter(function(b){return b.get("active")}).length}function t(){var b=[];c.each(function(a){a.get("active")||h.some(n,function(g){return a.get("id")===g.name})||b.push(a)});h.each(b,function(a){c.remove(a)});h.each(n,
function(a){a.name===f.get("remote-user")||c.any(function(g){return g.get("id")===a.name||g.get("name")===a.name})||(a.active=!1,a.id=a.name,c.add(a))})}var c=new A.Collection;c.add(w({origin:"current-user",fullname:f.get("current-user-fullname"),name:f.get("remote-user"),avatarURL:f.get("current-user-avatar-url"),active:!0,currentUser:!0}));var x=!1,r="",p,n=[],q=null,m,y=!1;e.Rte.getEditor()&&e.Rte.getEditor().initialized?v():e.bind("rte-collab-ready",v);return{appendTo:function(b,a,g){r=b;x||(p=
p||require("tinymce"),x=!0,n=g,a.on("presence",function(z){m.hideInlineDialog();z.joined.filter(function(d){return d.origin!==r}).forEach(function(d){d=w(d);var k=c.findWhere({active:!1,id:d.name});k&&c.remove(k);c.add(d,{at:E()})});z.left.forEach(function(d){d.id=d.origin;c.remove(d);t()});t();y||(e.bind("editor-heartbeat",function(d,k){h.isArray(k.contributors)&&(n=k.contributors,t())}),y=!0);e.trigger("analyticsEvent",{name:"confluence.synchrony.user.in.session",data:{numOtherUsers:c.length,draftId:f.get("draft-id"),
contentId:f.get("content-id")}})}),p.EditorManager.activeEditor.on("click",h.bind(u.prototype.hideInlineDialog,m)));return q},setTinyMce:function(b){p=b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/avatar-list-view.js' */
define("confluence-collaborative-editor-plugin/avatar-list-view",["backbone","confluence-collaborative-editor-plugin/avatar-view","ajs","jquery","underscore"],function(e,f,d,h,g){return e.View.extend({initialize:function(){this.collection.on("add",this.addAvatar,this);this.collection.on("remove",this.removeAvatar,this);this.collection.each(this.addAvatar,this)},addAvatar:function(a){var b=new f({model:a});a.get("active")?(d.log(a.get("fullname")+" joined. ("+a.get("origin")+")"),a=this.$el.find("li.active").last(),
b=a.length?b.render().insertAfter(a):b.render().prependTo(this.$el)):b=b.render().appendTo(this.$el);a=function(c){c.addClass("show");c.children(".avatar").tooltip({fade:!0,gravity:"ne"})};6===this.collection.length?a(b):g.defer(a,b);this._manageOverlayClass()},removeAvatar:function(a){a.get("active")&&d.log(a.get("fullname")+" left. ("+a.get("origin")+")");this._manageOverlayClass()},_manageOverlayClass:function(){var a=this.collection.length;this.collection.each(function(b,c){b.set("hidden",5<a&&
4<=c)});5<a?this.$el.addClass("has-overlay"):this.$el.removeClass("has-overlay")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/avatar-view.js' */
define("confluence-collaborative-editor-plugin/avatar-view",["backbone","ajs","confluence/templates","jquery"],function(f,d,g,e){return f.View.extend({initialize:function(){this.model.on("remove",this.remove,this)},render:function(){return this.$el=e(g.SynchronyPresence.avatar({title:this._determineTitle(),initial:this.model.get("fullname").charAt(0).toUpperCase(),fullname:this.model.get("fullname"),username:this.model.get("username"),avatarUrl:this.model.get("avatarURL"),origin:this.model.get("origin"),
active:this.model.get("active"),currentUser:this.model.get("currentUser"),telepointer:this._synchronyTelepointerId()}))},remove:function(){this.$el.removeClass().addClass("avatar-item animate");this.model.get("hidden")||this.$el.addClass("removing");this.$el.one(this._getSupportedTransition(),function(){e(this).removeClass("animate removing");e(this).remove()})},_determineTitle:function(){if(this.model.get("currentUser")){var a=["\u5c31\u662f\u4f60\uff0c\u4f46\u66f4\u5c0f\uff01","\u770b\u770b\u4f60\uff0c\u628a\u4e8b\u60c5\u5b8c\u6210\uff01"];
return a[Math.floor(Math.random()*a.length)]}return this.model.get("fullname")+" "+(this.model.get("active")?"\u6b63\u5728\u7f16\u8f91\u6b64\u9875\u3002":"\u6709\u672a\u53d1\u5e03\u7684\u4fee\u6539\u3002")},_getSupportedTransition:function(){var a={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",MsTransition:"msTransitionEnd",WebkitTransition:"webkitTransitionEnd"},b=document.createElement("_"),c;for(c in a)if(void 0!==b.style[c])return a[c]},_synchronyTelepointerId:function(){for(var a=
""+(this.model.get("sub")||this.model.get("origin")||""),b=0,c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return Math.abs(b)%10}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/overlay-view.js' */
define("confluence-collaborative-editor-plugin/overlay-view","backbone aui/inline-dialog2 confluence-collaborative-editor-plugin/avatar-view confluence/templates ajs jquery underscore".split(" "),function(d,h,e,f,g,a,k){return d.View.extend({initialize:function(){this.collection.on("add remove",this.reconcile,this);this.inlineDialog2=document.querySelector("#more-avatars")},render:function(){this.$el=a(f.SynchronyPresence.overlay());this.$el.children("a").tooltip({fade:!0,gravity:"ne"});this.$el.on("click",
function(){a(".tipsy").remove()});return this.$el},reconcile:function(){var b=this.collection.where({hidden:!0});0<b.length?(this.$el.addClass("show"),this.$el.children(".aui-button").html("+"+b.length).attr("title",b.length+" "+"\u5176\u4ed6\u7528\u6237\u6b63\u5728\u7f16\u8f91"),a("#more-avatars-list").children().remove(),b.forEach(function(c){c=new e({model:c});a("#more-avatars-list").append(c.render())})):(this.$el.removeClass("show"),this.hideInlineDialog())},hideInlineDialog:function(){this.inlineDialog2&&
this.inlineDialog2.isVisible&&this.inlineDialog2.isVisible()&&(this.inlineDialog2.open=!1)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/template/status-indicator.soy' */
// This file was automatically generated from status-indicator.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.CollaborativeEditor.StatusIndicator.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.CollaborativeEditor == 'undefined') { Confluence.Templates.CollaborativeEditor = {}; }
if (typeof Confluence.Templates.CollaborativeEditor.StatusIndicator == 'undefined') { Confluence.Templates.CollaborativeEditor.StatusIndicator = {}; }


Confluence.Templates.CollaborativeEditor.StatusIndicator.container = function(opt_data, opt_ignored) {
  return '<div class="synchrony-status-indicator"><div class="status-indicator-icon aui-icon aui-icon-small' + ((opt_data.error) ? ' aui-iconfont-warning' : (opt_data.saving) ? ' aui-iconfont-devtools-task-in-progress' : ' aui-iconfont-approve') + '" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipMessage) + '"></div><div class="status-indicator-message" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipMessage) + '">' + soy.$$escapeHtml(opt_data.statusMessage) + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.CollaborativeEditor.StatusIndicator.container.soyTemplateName = 'Confluence.Templates.CollaborativeEditor.StatusIndicator.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/status-indicator-view.js' */
define("confluence-collaborative-editor-plugin/status-indicator-view",["confluence/templates","backbone","ajs","jquery","underscore"],function(f,g,c,h,d){return g.View.extend({initialize:function(){this.$el.addClass("synchrony");this.listenTo(this.model,"change:saving change:error",this.render);this.model.set("confluenceUnreachable",!1);this.model.set("synchronyUnreachable",!1);this.model.set("tokenExpired",!1);c.bind("rte.heartbeat",d.bind(this.onConfluenceConnectedState,this));c.bind("rte.safe-save.error",
d.bind(this._errorPublishing,this));c.bind("rte.preview.error",d.bind(this._errorPublishing,this));this.model.set("connecting",!0);this._setProgressState()},render:function(){h(".tipsy").remove();this.$el.html(f.CollaborativeEditor.StatusIndicator.container(this.model.attributes))},onConnectedState:function(a){this.model.set("synchronyUnreachable",!1);if(!this.model.has("synchronyEntity")){this.model.set("synchronyEntity",a);var b=this;this.model.get("synchronyEntity").on("update",function(e){b._handleSynchronyUpdateEvent(e,
b)});this.model.get("synchronyEntity").on("ack",function(e){b._handleSynchronyAckEvent(e,b)})}this._setSavedState()},onDisconnectedState:function(){this.model.set("synchronyUnreachable",!0);this.model.set("connecting",!0);this._setErrorState()},onConfluenceConnectedState:function(){this.model.get("confluenceUnreachable")&&(this.model.set("confluenceUnreachable",!1),this._setSavedState())},onConfluenceDisconnectedState:function(){this.model.set("confluenceUnreachable",!0);this.model.set("connecting",
!0);this._setErrorState()},onTokenRenewedState:function(){this.model.get("tokenExpired")&&(this.model.set("tokenExpired",!1),this._setSavedState())},onTokenExpiredState:function(){this.model.set("tokenExpired",!0);this.model.set("connecting",!0);this._setErrorState()},_handleSynchronyUpdateEvent:function(a,b){"local"===a.updateType&&(b.model.set("pendingChanges",!0),b._saving())},_handleSynchronyAckEvent:function(a,b){a=0<a.pending.length;b.model.set("pendingChanges",a);a||b.model.set("lastSavedTime",
(new Date).getTime())},_saving:function(){var a=this,b=function(){setTimeout(function(){a.model.get("pendingChanges")||(new Date).getTime()-a.model.get("lastSavedTime")<a.model.get("minActiveTime")?b():a._setSavedState()},a.model.get("minActiveTime"))};this.model.get("saving")||(this.model.set("connecting",!1),this._setProgressState(),b())},_reachable:function(){return!this.model.get("confluenceUnreachable")&&!this.model.get("synchronyUnreachable")&&!this.model.get("tokenExpired")},_errorPublishing:function(a,
b){switch(b.status){case 0:this.onConfluenceDisconnectedState();break;case 500:case 503:this.onConfluenceDisconnectedState()}},_setSavedState:function(){this._reachable()&&"READ_ONLY"!==c.Meta.get("access-mode")?(this.model.set("statusMessage",this.model.get("connecting")?"\u5373\u5c06\u5f00\u59cb~":"\u66f4\u6539\u5df2\u4fdd\u5b58"),this.model.set("isReadyToGo",!!this.model.get("connecting")),this.model.set("tooltipMessage","\u81ea\u52a8\u4fdd\u5b58\u6240\u6709\u4fee\u6539\u5230\u8349\u7a3f\u4e2d"),this.model.set("connecting",
!1),this.model.set("saving",!1),this.model.set("error",!1)):this._setErrorState()},_setErrorState:function(){var a="READ_ONLY"!==c.Meta.get("access-mode");this.model.set("statusMessage","\u4e0d\u80fd\u4fdd\u5b58\u53d8\u66f4");this.model.set("tooltipMessage",a?"\u65e0\u6cd5\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff0c\u8bf7\u68c0\u67e5\u4f60\u7684\u82f1\u7279\u7f51\u8fde\u63a5\uff0c\u6211\u4eec\u5c06\u6301\u7eed\u5c1d\u8bd5\u8ddf\u60a8\u91cd\u65b0\u5efa\u7acb\u8fde\u63a5\u3002":"\u8fd9\u662f\u53ea\u8bfb\u7f51\u7ad9\u3002 \u60a8\u73b0\u5728\u65e0\u6cd5\u8fdb\u884c\u66f4\u6539\u3002");this.model.set("saving",!1);this.model.set("error",!0)},_setProgressState:function(){this._reachable()?(this.model.set("statusMessage",
this.model.get("connecting")?"\u8fde\u63a5\u4e2d...":"\u6b63\u5728\u4fdd\u5b58\u4fee\u6539"),this.model.set("tooltipMessage","\u81ea\u52a8\u4fdd\u5b58\u6240\u6709\u4fee\u6539\u5230\u8349\u7a3f\u4e2d"),this.model.set("saving",!0),this.model.set("error",!1)):this._setErrorState()}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/initialise-metrics.js' */
define("collaborative-editing-initialise-metrics-collection",["confluence/legacy"],function(a){return function(){var b={"confluence.editor":!0,"confluence.editor.preload":!0,"confluence.editor.quick.fetchContent":!0,"confluence.editor.tinymce":!0,"confluence.editor.synchrony":!0,"confluence.editor.synchrony.CR":!0,"confluence.editor.synchrony.connect":!0,"confluence.editor.synchrony.deps":!0,"confluence.editor.synchrony.init":!0,"confluence.editor.synchrony.jsLoad":!0,"confluence.editor.synchrony.snapshot":!0,
"confluence.editor.synchrony.unmarshal":!0},c={"confluence.editor.synchrony.connect":!0};a.registerPerformanceSession&&a.registerPerformanceSession("confluence.editor.quickedit.loading.times",b,c)}});require("confluence/module-exporter").safeRequire("collaborative-editing-initialise-metrics-collection",function(a){a()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/lib/SyncManager.js' */
define("confluence-collaborative-editor-plugin/lib/SyncManager",["ajs","jquery"],function(e,f){var h=["id"],k={START_SYNCHRONIZING_EVENT_NAME:"start",STOP_SYNCHRONIZING_EVENT_NAME:"stop",MAX_CONSECUTIVE_AUTO_RECOVERY_TRIGGERED:10,MAX_WAIT_TIME_TO_RESTART:3E4,DEBUG_MODE:!1},l=function(a){return h.every(function(b){return"undefined"!==typeof a[b]})},c=function(a,b){this.entity=a;this.settings=f.extend({},k,b||{});this.controlSyncState={};this.recoveryTimeoutTasks={};a=function(d,m,g){l(g)?d(g):this.displayLogMessage("Invalid payload, missing required params",
m,g)};e.bind("synchrony."+this.settings.START_SYNCHRONIZING_EVENT_NAME,a.bind(this,this.enableSynchronization.bind(this)));e.bind("synchrony."+this.settings.STOP_SYNCHRONIZING_EVENT_NAME,a.bind(this,this.disableSynchronization.bind(this)))};c.prototype.getOrCreateControlSyncState=function(a){return this.controlSyncState[a]=this.controlSyncState[a]||{DISABLED_SYNC_STATUS:!1,RECOVERY_TIMER_RUNNING:!1,CONSECUTIVE_AUTO_RECOVERY_TRIGGERED:0}};c.prototype.enableDebug=function(a){this.settings.DEBUG_MODE=
"undefined"!==typeof a?a:!0};c.prototype.displayLogMessage=function(){if(this.settings.DEBUG_MODE){var a=Array.prototype.slice.call(arguments);a.splice(0,0,"DEBUG: "+(new Date).toLocaleTimeString());console.log.apply(console,a)}};c.prototype.disableSynchronization=function(a){var b=a.id;this.getOrCreateControlSyncState(b).DISABLED_SYNC_STATUS=!0;this.clearAutoRecoveryTimer(b);this.setAutoRecoveryTimer(a);this.entity.stop(b);this.displayLogMessage("Stoping entity synchronization",b,f.extend(!0,{},
this.controlSyncState))};c.prototype.enableSynchronization=function(a){a=a.id;this.getOrCreateControlSyncState(a).DISABLED_SYNC_STATUS=!1;this.clearAutoRecoveryTimer(a);this.entity.start(a);this.displayLogMessage("Starting entity synchronization",a,f.extend(!0,{},this.controlSyncState))};c.prototype.clearAutoRecoveryTimer=function(a){var b=this.getOrCreateControlSyncState(a);clearTimeout(this.recoveryTimeoutTasks[a]);delete this.recoveryTimeoutTasks[a];b.RECOVERY_TIMER_RUNNING=!1};c.prototype.setAutoRecoveryTimer=
function(a){var b=a.id,d=this.getOrCreateControlSyncState(b);d.RECOVERY_TIMER_RUNNING=!0;this.recoveryTimeoutTasks[b]=setTimeout(function(){this.displayLogMessage("Auto recovery has been triggered",b);this.clearAutoRecoveryTimer(b);d.DISABLED_SYNC_STATUS=!1;d.RECOVERY_TIMER_RUNNING=!1;d.CONSECUTIVE_AUTO_RECOVERY_TRIGGERED++;e.trigger("analyticsEvent",{name:"confluence.synchrony.syncmanager.failed-to-restart",data:{id:b}});d.CONSECUTIVE_AUTO_RECOVERY_TRIGGERED>=this.settings.MAX_CONSECUTIVE_AUTO_RECOVERY_TRIGGERED&&
(this.displayLogMessage("Auto recovery has been triggered too many times for the same action",b,this.controlSyncState[b].CONSECUTIVE_AUTO_RECOVERY_TRIGGERED),e.trigger("analyticsEvent",{name:"confluence.synchrony.syncmanager.consecutive-failed-to-restart",data:{id:b}}));this.entity.start(b)}.bind(this),a.maxWaitTimeToRestart||this.settings.MAX_WAIT_TIME_TO_RESTART)};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/telepointer-cleaner.js' */
define("confluence-collaborative-editor-plugin/telepointer-cleaner",["confluence-editor-reliable-save/reliable-save","jquery"],function(b,c){b.registerCleanupFunction(function(d){var a=c("\x3cdiv\x3e");a.append(d);a.find(".synchrony-container, .synchrony-tp").remove();return a.html()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/editor-blanket.js' */
define("confluence-collaborative-editor-plugin/editor-blanket",["ajs","jquery","confluence/meta","confluence-editor/support/atlassian-editor-support"],function(l,a,m,h){var c,d;function f(b){switch(b){case "block":c="editor-block";d="aria-disabled";e="";break;default:c="editor-loading editor-loading-spinner",d="aria-busy",e="editor-loading"}b=a("#editpageform, #createpageform");b.addClass(c);b.attr(d,!0);a("#content-title").attr("tabindex",-1);a("#wysiwygTextarea_ifr").attr("tabindex",-1);a(".aui-toolbar2-primary").addClass(e)}
function k(){var b=a("#editpageform, #createpageform");b.removeClass(c);b.attr(d,!1);a("#rte").css("opacity",1).addClass("editor-blanket-ease-in");a("#content-title").attr("tabindex",0);a("#wysiwygTextarea_ifr").attr("tabindex",0);a("#content-title-div").css("opacity",1).addClass("editor-blanket-ease-in");a(".aui-toolbar2-primary").removeClass(e);e=d=c=void 0}function g(){a("#rte").css("opacity",1);a("#content-title-div").css("opacity",1)}var e=d=c=void 0;return{applyBlanket:function(b){h.isCollaborativeContentType()&&
"pending"===b.state()?(f(),b.done(k)):g()},showEditor:g,showBlanket:f}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-auth.js' */
define("confluence-collaborative-editor-plugin/synchrony-auth",["jquery","ajs","confluence/meta","confluence/legacy","confluence-collaborative-editor-plugin/synchrony-util"],function(l,d,m,n,f){function p(c,a){f.time("confluence.editor.synchrony.token");var b=a&&a.errorType?"?errorType\x3d"+a.errorType:"";l.ajax({dataType:"json",method:"GET",url:encodeURI(d.contextPath()+"/rest/synchrony/1.0/token/"+n.getContentId()+"/generate"+b)}).done(function(g){m.set("synchrony-token",g.synchronyToken);m.set("synchrony-expiry",
g.synchronyExpiry);h=0;c.resolve(g.synchronyToken);e&&(e.onConfluenceConnectedState(),e.onTokenRenewedState());d.trigger("dismiss.editor.error.message",{messageKey:"synchrony-token-expired",enablePublish:!0});d.debug("Synchrony JWT token updated.");f.timeEnd("confluence.editor.synchrony.token")}).fail(function(){h++;10<=h&&d.trigger("editor.error.message",{messageKey:"synchrony-token-expired",message:"\u6211\u4eec\u4e0d\u80fd\u5904\u7406\u60a8\u7684\u8bf7\u6c42\uff0c\u56e0\u4e3a\u5b83\u7f3a\u5c11\u5fc5\u8981\u7684\u5b89\u5168\u4ee4\u724c\u3002\u590d\u5236\u60a8\u7684\u5de5\u4f5c\uff0c\u7136\u540e\u91cd\u65b0\u63d0\u53ca\u8868\u683c\u6216\u91cd\u65b0\u52a0\u8f7d\u9875\u9762\u3002",disablePublish:!0});e&&(e.onConfluenceDisconnectedState(),
e.onTokenExpiredState());d.log(a?a.message:"Confluence failed to renew JWT token.");c.reject("token")})}function k(c){var a=l.Deferred(),b;if(b=!c)b=parseInt(f.retrieveMetadata("synchrony-expiry")),b=isNaN(b)?!1:b>Date.now()/1E3;b?a.resolve(f.retrieveMetadata("synchrony-token")):(d.log("["+new Date+"] Synchrony JWT expired or invalid, retrieving new token."),p(a,c));return a.promise()}var e,h=0;return{init:function(c){e=c},performRequest:function(c){return k().pipe(c).pipe(function(a){var b="error"===
a[1]&&a[0].responseText?JSON.parse(a[0].responseText):a[0];return"error"===a[1]&&b.type&&b.type.match(/^jwt\//)?k({errorType:b.type,message:b.message}).pipe(c):a})},getTokenPromise:k}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/unsupported-extension.js' */
define("confluence-collaborative-editor-plugin/unsupported-extension","ajs jquery confluence/legacy confluence-editor/editor/page-editor-message window confluence-collaborative-editor-plugin/editor-blanket".split(" "),function(a,c,d,e,f,g){function h(){var b=a.Rte.getEditor().getBody();b.hasAttribute("data-gramm")&&b.hasAttribute("data-gramm_id")&&(a.trigger("synchrony.stop",{id:"confluence.editor.block.by.grammarly",maxWaitTimeToRestart:31536E6}),a.trigger("analyticsEvent",{name:"confluence.synchrony.editor.grammarly.block"}),
b.setAttribute("contentEditable",!1),c(b).find(".contentLayout2 .innerCell").each(function(){this.setAttribute("contentEditable",!1)}),g.showBlanket("block"),d.Editor.UI.setButtonsState(!1,d.Editor.UI.buttons),e.handleMessage("collaborative-editor-unsupported-extension",{type:"error",title:"\u4e0d\u652f\u6301 Grammarly",message:a.format("Grammarly \u6269\u5c55\u672a\u80fd\u826f\u597d\u5730\u7ed3\u5408\u534f\u540c\u7f16\u8f91\u3002\u7981\u7528\u5b83\u5e76 \u003ca {0}\u003e\u91cd\u65b0\u52a0\u8f7d\u9875\u9762 \u003c/a\u003e \u6765\u7ee7\u7eed\u5de5\u4f5c\u3002",'href\x3d"#" id\x3d"collabGrammarlyReload"')}),c("#collabGrammarlyReload").click(function(){a.trigger("analyticsEvent",
{name:"confluence.synchrony.editor.grammarly.reload.click"});f.location.reload();return!1}),a.trigger("synchrony-unsupported-extension"))}return{check:function(){h()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-entity.js' */
define("confluence-collaborative-editor-plugin/synchrony-entity","jquery ajs confluence-collaborative-editor-plugin/synchrony-auth confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/unsupported-extension confluence-collaborative-editor-plugin/util/is-valid-uri".split(" "),function(g,h,p,k,q,r){function l(c){return function(d){return null===d||c.test(d)}}function n(c){var d=l(/^[\w\.\-\+%]+$/i),e=l(/^[\w-]+$/),f=l(/^data:image\/png;base64,([\w+\/%\-]+)=*$/),
a=c.whitelists.tinymce.attributes.src;return g.extend({},c.whitelists.tinymce,{styles:g.extend({},c.whitelists.tinymce.styles,{"padding-top":!1,"padding-right":!1,"padding-bottom":!1,"padding-left":!1,padding:!1,display:d,"list-style-type":d}),attributes:g.extend({},c.whitelists.tinymce.attributes,{"confluence-query-params":!0,"data-element-title":!0,"data-ref":!0,accesskey:!0,datetime:!0,"data-anchor":!0,"data-encoded-xml":!0,"data-highlight-class":!0,"data-highlight-colour":!0,"data-space-key":!0,
"data-username":!0,"data-emoticon-name":e,"data-hipchat-emoticon":e,"data-entity-id":!0,"data-entity-type":!0,"data-favourites-bound":!0,"data-macro-id":!0,"data-macro-name":!0,"data-macro-schema-version":!0,"data-macro-body-type":!0,"data-macro-parameters":!0,"data-macro-default-parameter":!0,"data-atlassian-layout":!0,"data-placeholder-type":!0,"data-layout":!0,"data-title":!0,"data-type":!0,"data-inline-task-id":!0,"data-inline-tasks-content-id":!0,"data-base-url":!0,"data-linked-resource-id":!0,
"data-linked-resource-type":!0,"data-linked-resource-version":!0,"data-linked-resource-default-alias":!0,"data-linked-resource-container-version":!0,"data-linked-resource-content-type":!0,"data-unresolved-comment-count":!0,"data-location":!0,"data-image-height":!0,"data-image-width":!0,"data-attachment-copy":!0,"data-content-title":!0,"data-snooker-locked-cols":!0,"data-snooker-col-series":!0,"data-mce-resize":!0,"data-filename":!0,username:!0,src:function(b){return f(b)||a(b)},href:r,role:!0,tabindex:!0,
"aria-haspopup":!0,"aria-label":!0}),classes:function(b){switch(b){case "mceSelected":case "active-resizable":return!1;default:return!0}},elements:g.extend({},c.whitelists.tinymce.elements,{time:!0,mark:!0,label:!0,form:!0})})}function t(c,d,e){var f=n(c);return{profile:"tinymce",selectionCorrections:!1,telepointer:{refreshOnResize:!0,label:{hover:!0,movement:1E3,text:function(a){try{return(a.fullname||"\u533f\u540d\u7528\u6237").charAt(0).toUpperCase()}catch(b){h.log(b)}return"\x26#9786;"}}},
tinymce:{monkeyPatchUndoManager:!0,instance:d},whitelist:function(a){var b=a.domNode,m="node"===a.type,u="attribute"===a.type&&"data-title"===a.name;if(b===e)return m||u;m=b&&b.classList.contains("numberingColumn")&&("TD"===b.nodeName||"TH"===b.nodeName);if("attribute"===a.type&&"contenteditable"===a.name&&m)return!0;if(a.name&&a.name.includes("mce-visual-caret")&&"class"===a.type&&b){const {classList:v,attributes:w,nodeName:x}=b||{};if(v.contains("mce-visual-caret")&&"all"===w["data-mce-bogus"].value&&
"DIV"===x)return!1}return c.isWhitelisted(f,a)},domReadHook:function(){h.trigger("cursor-target-refresh");q.check()}}}return{bind:function(c,d,e,f,a){return c.entity({url:k.getServiceUrl(),entityId:k.getEntityId(),jwt:p.getTokenPromise,initRev:a.confRev,history:f,presence:!0,useFallback:k.getXhrFallbackFlag()}).bind(e,t(c,d,e))},makeWhitelist:n}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/url-parser.js' */
define("confluence-collaborative-editor-plugin/util/url-parser",["window"],function(b){return{parseUrl:function(c){var a=b.document.createElement("a");a.href=c;return{protocol:a.protocol.replace(":",""),hostname:a.hostname,port:a.port,pathname:"/"===a.pathname?"":a.pathname,search:a.search,hash:a.hash.substr(a.hash.indexOf("#")+1,a.hash.length),host:a.host}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/location-provider.js' */
define("confluence-collaborative-editor-plugin/util/location-provider",["window"],function(a){return{getLocation:function(){return a.location}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/editor-format-fixer.js' */
define("confluence-collaborative-editor-plugin/util/editor-format-fixer",["underscore","confluence/meta","confluence-collaborative-editor-plugin/util/url-parser"],function(q,p,k){var r=function(a){a=a.querySelectorAll("a[data-linked-resource-id][data-linked-resource-type\x3d'userinfo'][userkey]");Array.prototype.forEach.call(a,function(n){n.removeAttribute("data-linked-resource-id")});return a.length};return{fixStaleBaseUrl:function(a){var n=0;for(var l=p.get("base-url"),f=k.parseUrl(l),g=a.querySelectorAll("img[data-base-url]"),
h=0;h<g.length;h++){var b=g[h],c=k.parseUrl(b.attributes["data-base-url"].value);if(!q.isEqual(c,f)){var d=b.attributes.src.value,e=b.attributes["data-image-src"].value.replace(c.pathname,f.pathname);c=d.replace(c.pathname,f.pathname);b.setAttribute("data-base-url",l);b.setAttribute("data-image-src",e);b.setAttribute("src",c);n++}}l=0;f=k.parseUrl(p.get("base-url"));g=a.querySelectorAll("img[data-macro-name\x3d'view-file']");for(h=0;h<g.length;h++)for(b=g[h],e=b.attributes.src.value,c=["/rest/documentConversion/latest/",
"/plugins/servlet/confluence/placeholder/unknown-attachment?"],d=0;d<c.length;d++){var m=e.indexOf(c[d]);-1!=m&&e.substr(0,m)!==f.pathname&&(m=f.pathname+e.substr(m),b.setAttribute("src",m),l++)}f=0;g=p.get("base-url");h=k.parseUrl(g);a=a.querySelectorAll("a[data-base-url][href][data-linked-resource-type\x3d'page'],a[data-base-url][href][data-linked-resource-type\x3d'blogpost'],a[data-base-url][href][data-linked-resource-type\x3d'comment'],a[data-base-url][href][data-linked-resource-type\x3d'space'],a[data-base-url][href][data-linked-resource-type\x3d'attachment'],a[data-base-url][href][data-linked-resource-type\x3d'custom']");
for(b=0;b<a.length;b++)e=a[b],c=k.parseUrl(e.attributes["data-base-url"].value),q.isEqual(c,h)||(d=k.parseUrl(e.attributes.href.value),c=g+d.pathname.replace(c.pathname,"")+d.search+(d.hash?"#"+d.hash:""),e.setAttribute("data-base-url",g),e.setAttribute("href",c),f++);return n+l+f},fixMentions:function(a){return r(a)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-handlers.js' */
define("confluence-collaborative-editor-plugin/synchrony-handlers","underscore jquery ajs confluence/meta confluence/analytics-support confluence/legacy confluence-editor/editor/page-editor-message confluence-collaborative-editor-plugin/lib/SyncManager confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/synchrony-content confluence-collaborative-editor-plugin/synchrony-presence confluence-collaborative-editor-plugin/util/location-provider confluence-collaborative-editor-plugin/util/url-parser confluence-collaborative-editor-plugin/util/editor-format-fixer confluence-collaborative-editor-plugin/editor-blanket confluence/api/event window".split(" "),
function(I,k,f,g,J,p,z,K,l,m,L,M,y,A,N,c,q){function B(a,b){b.contributors&&(C=b.contributors,c.unbind(a,B))}function O(a){w=!0;u.val(a.rev.toString())}function P(a){u.val(a.rev.toString());c.trigger("synchrony.entity.ack",{pendingChanges:0<a.pending.length})}function Q(){v.onDisconnectedState();f.log("Synchrony disconnected!")}function R(a){if("null/no-such-sequence"===a.errorType||"null/entity-evicted"===a.errorType||"hub.error/locked"===a.errorType){c.trigger("analyticsEvent",{name:"confluence.editor.data.evicted.error",
data:{errorType:a.errorType,onLoad:!w,afterReload:null!==q.sessionStorage.getItem(x())}});e.destroy();c.trigger("synchrony.history.evicted");a=null===q.sessionStorage.getItem(x());var b=w?"\u003cb\u003e\u65e0\u6cd5\u540c\u6b65\u60a8\u7684\u66f4\u6539\u003c/b\u003e\u003cbr/\u003e\u590d\u5236\u60a8\u9700\u8981\u4fdd\u7559\u7684\u66f4\u6539\uff0c\u7136\u540e\u5237\u65b0\u6b64\u9875\u9762\u4ee5\u7ee7\u7eed\u7f16\u8f91\u3002":a?"\u91cd\u65b0\u52a0\u8f7d\u8be5\u9875\u9762\uff0c\u4f7f\u5176\u7ee7\u7eed\u540c\u6b65\u3002":"\u003cb\u003e\u540c\u6b65\u6b64\u9875\u9762\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u003c/b\u003e\u003cbr/\u003e\u8bf7\u7a0d\u5019\uff0c\u7136\u540e\u5237\u65b0\u8be5\u9875\u9762\u4ee5\u5f00\u59cb\u7f16\u8f91\u3002\u5982\u9700\u8be5\u95ee\u9898\u4ecd\u7136\u5b58\u5728\uff0c\u8bf7\u8054\u7cfb Confluence \u7ba1\u7406\u5458\u3002";c.trigger("editor.error.message",{disablePublish:!0,close:"never",message:b});if(w)v.onDisconnectedState();
else N.showBlanket("block"),a&&(q.sessionStorage.setItem(x(),"false"),q.location.reload());S()}else"fatal"===a.level&&c.trigger("editor.error.message",{disablePublish:!0})}function S(){q.onerror=function(a,b,d,r,t){if(!(b||d||r||t)){if(D)return!0;D=!0}else if(t&&t.message&&"entity destroyed"===t.message)return!0;return!1}}function x(){return"_reload_for_"+g.get("draft-id")}function T(a){l.timeEnd("confluence.editor.synchrony.connect");f.log("Synchrony connected.");L.appendTo(a.sid,e,C);v.onConnectedState(e);
c.trigger("synchrony.connected");m.fixTinymceCaretContainer(n,h);q.sessionStorage.removeItem(x())}function E(a,b,d){return{origin:"synchrony",cause:a,messageKey:b,disablePublish:d}}function U(a){function b(r){r.pending.length||(e.off("ack",b),u.val(r.rev.toString()),d.resolve(a))}var d=k.Deferred();e.ackState().pending.length?(e.on("ack",b),setTimeout(function(){e.off("ack",b);d.reject(E("timeout"))},5E3)):d.resolve(a);return k.when(d,F).promise()}function G(a){return(a=l.getLatestRevisionWithAttr(a.revisions,
"user"))?a.meta.user:"\u533f\u540d\u7528\u6237"}function V(a){z.handleMessage("editor.synchrony.page-published",{type:"info",message:f.format("\u6b64\u9875\u5df2\u53d1\u5e03{0}\u6b21\u3002",f.escapeHtml(a)),close:"auto"});c.trigger("analyticsEvent",{name:"confluence.synchrony.external-changes.publish"});c.trigger("editor-shared-drafts-published")}function W(a){if("remote"===a.updateType){u.val(a.revisions[a.revisions.length-1].rev.toString());l.hasRevisionTrigger(a.revisions,"reset")&&(z.handleMessage("editor.synchrony.revert-page",
{type:"info",message:f.format("{0} \u6062\u590d\u5230\u8be5\u9875\u9762\u4e00\u4e2a\u4e4b\u524d\u7684\u7248\u672c\u3002",f.escapeHtml(G(a)))}),g.set("has-collaborated",!1),H(),c.trigger("analyticsEvent",{name:"confluence.synchrony.external-changes.revert"}),c.trigger("editor-shared-drafts-discarded"),p.Editor.heartbeat());l.hasRevisionTrigger(a.revisions,"publish")&&(m.isUnpublished()&&(g.set("new-page",!1),g.set("page-id",p.getContentId()),g.set("draft-id","0"),p.Editor.isLimitedModeEnabled()||p.Editor.UI.setButtonState(!0,k("#rte-button-discard"))),
g.set("has-collaborated",!1),H(),V(G(a)),p.Editor.heartbeat());l.hasRevisionType(a.revisions,"external")&&c.trigger("editor.external.change");var b=l.getLatestRevisionWithAttr(a.revisions,"confVersion");b&&b.meta.confVersion&&(k('meta[name\x3d"page-version"]').attr("content",b.meta.confVersion),k('meta[name\x3d"ajs-page-version"]').attr("content",b.meta.confVersion),g.set("page-version",b.meta.confVersion))}setTimeout(function(){if("init"===a.updateType||"remote"===a.updateType)c.trigger("editor.remote.change"),
m.readTitleFromRootElement(n);"init"==a.updateType&&(X(M.getLocation())?h.undoManager.ignore(function(){var d=A.fixStaleBaseUrl(n);0<d&&J.publish("collab.edit.format.stale.fix.count",{staleformatfixed:d})}):f.log("Request url does not match the configured base url. Not performing fixStaleBaseUrl()."),h.undoManager.ignore(function(){A.fixMentions(n)}));m.fixTinymceCaretContainer(n,h);"local"===a.updateType&&(h.undoManager.hasUndo()||h.setDirty(!1),c.trigger("editor.local.change"))},0)}function H(){0===
e.ackState().pending.length&&h.setDirty(!1)}function X(a){var b=g.get("context-path"),d=y.parseUrl(g.get("base-url"));a=y.parseUrl(a);b=y.parseUrl(a.protocol+"://"+a.host+b);return I.isEqual(d,b)}var u,v,h,n,e,F,C=[],w=!1,D=!1;c.bind("editor-heartbeat",B);return{handle:function(a,b,d,r){l.time("confluence.editor.synchrony.connect");e=a;h=b;v=d;F=r.pipe(null,function(t){e.destroy();v.onDisconnectedState();return E(t,"collaborative-editor-load-failure",!0)});u=k("#syncRev");n=h.getBody();e.on("init",
O).on("update",W).on("ack",P).on("connected",T).on("disconnected",Q).on("error",R);new K(e,{DEBUG_MODE:!0});m.bindPostPasteFix();m.readTitleFromRootElement(n);p.Editor.overrideBeforeSave(U);k("#content-title").keyup(m.writeTitleToRootElement)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-editor.js' */
define("confluence-collaborative-editor-plugin/synchrony-editor","window jquery ajs confluence/legacy confluence-collaborative-editor-plugin/editor-blanket confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/synchrony-content confluence-collaborative-editor-plugin/synchrony-auth confluence-collaborative-editor-plugin/synchrony-entity confluence-collaborative-editor-plugin/synchrony-handlers confluence-editor/support/atlassian-editor-support confluence-editor/loader/collaborative-helper".split(" "),
function(t,g,d,p,I,f,y,H,J,T,U,V){function z(a){g('meta[name\x3d"ajs-collaborative-editor-status"]').attr("content",a)}function W(){return!d.Rte.isQuickEdit}function X(){var a=g.Deferred();d.$(function(){d.$("body").addClass("synchrony-active");A=new (require("confluence-collaborative-editor-plugin/status-indicator-view"))({el:"#pluggable-status",model:new Backbone.Model({minActiveTime:500})});H.init(A);a.resolve()});return a}function B(a){if(!0!==K){switch(a){case "timeout":a="\u7f16\u8f91\u5668\u8fd9\u6b21\u6ca1\u6709\u52a0\u8f7d";
var b="\u8fde\u63a5\u8d85\u65f6\u3002\u5982\u679c\u6b64\u95ee\u9898\u518d\u6b21\u53d1\u751f\uff0c\u8bf7\u8054\u7cfb\u60a8\u7684 Confluence \u7ba1\u7406\u5458\u3002\u60a8\u53ef\u80fd\u6b63\u5728\u4f7f\u7528\u4e00\u4e2a\u4e0d\u5141\u8bb8 WebSocket \u8fde\u63a5\u7684\u4ee3\u7406\u670d\u52a1\u5668\u3002\u003c/br\u003e\u003ca href=\u0022#\u0022 id=\u0022websocketRetry\u0022\u003e\u8bf7\u91cd\u8bd5\u003c/a\u003e\u3002\u003ca href=\u0022https://confluence.atlassian.com/display/CONFKB/Confluence+throws+The+editor+didn%27t+load+this+time+error+when+trying+to+edit+a+page\u0022 target=\u0022_blank\u0022 id=\u0022websocketFindmore\u0022\u003e\u4e86\u89e3\u66f4\u591a\u003c/a\u003e";break;case "synchrony-requests":C=!0;a="";b="\u52a0\u8f7d\u7f16\u8f91\u5668\u540e\u51fa\u73b0\u4e86\u4e00\u4e9b\u95ee\u9898\u3002\u8bf7\u590d\u5236\u60a8\u8fd8\u672a\u4fdd\u5b58\u7684\u4fee\u6539\uff0c\u7136\u540e\u5237\u65b0\u9875\u9762\u6765\u7ee7\u7eed\u7f16\u8f91\u3002";break;case "limited-mode":C=!0;a="";b="\u52a0\u8f7d\u7f16\u8f91\u5668\u51fa\u9519\uff0c\u8bf7\u91cd\u8bd5\u3002";break;default:C=!0,a="",b="\u8be5\u6587\u4ef6\u7684\u52a0\u8f7d\u65f6\u95f4\u6bd4\u5e73\u65f6\u8981\u957f\u3002\u8bf7\u7a0d\u7b49\u7247\u523b\uff0c\u7136\u540e\u5c1d\u8bd5\u5237\u65b0\u3002\u95ee\u9898\u4f9d\u7136\u5b58\u5728\uff1f\u8bf7\u8054\u7cfb Confluence \u7ba1\u7406\u5458\u3002"}d.trigger("editor.error.message",{title:a,messageKey:"collaborative-editor-load-failure",message:b,disablePublish:!0,close:"manual"})}}
function L(){d.trigger("dismiss.editor.error.message",{messageKey:"collaborative-editor-load-failure",enablePublish:!0})}function M(a,b){var c=g.Deferred();a.done(function(){f.timeEnd(b)},c.resolve);a.fail(c.resolve);return c.promise()}function N(a,b){var c="error"===b[1]&&b[0].responseText?JSON.parse(b[0].responseText):"",e=!1;"invalid-ancestor"===c.type?e="synchrony":"out-of-order-revision"===c.type&&(e="confluence");return e?(d.log("Performing synchrony recovery"),g.ajax({url:d.contextPath()+"/rest/synchrony/1.0/content/"+
p.getContentId()+"/recovery?behind\x3d"+e+"\x26conflictingRev\x3d"+c["conflicting-rev"],type:"PUT"}),"synchrony-requests"):"success"!==b[1]&&"success"!==a[1]||"success"!==b[1]&&"duplicate-mismatch"!==c.type?(d.trigger("analyticsEvent",{name:"confluence.synchrony.client.content.reconciliation.failure",data:{type:c.type,contentId:p.getContentId()}}),"synchrony-requests"):!1}function O(a){return H.performRequest(function(b){f.time("confluence.editor.synchrony.snapshot");return M(g.ajax({type:"POST",
url:encodeURI(f.getServiceUrl()+"/data"+f.getEntityId()+"?state-at\x3d@head\x26state-format\x3dtype-tagged\x26rewrite-request\x3dtrue\x26cached\x3d"+a),contentType:"text/plain",dataType:"json",data:JSON.stringify({headers:{"content-type":"application/json","x-token":b},method:"GET"})}).pipe(f.asArray,f.asArray),"confluence.editor.synchrony.snapshot")})}function Y(a){return a.syncRev||!y.isUnpublished()||0!==a.raw.length&&!/^\s+$/.test(a.raw)?y.isContentEmpty(a.raw)?(d.trigger("analyticsEvent",{name:"confluence.synchrony.client.content.reconciliation.blank-content",
data:{contentId:p.getContentId()}}),g.Deferred().resolve([{},"success"])):H.performRequest(function(b){f.time("confluence.editor.synchrony.CR");return M(g.ajax({type:"POST",url:encodeURI(f.getServiceUrl()+"/data"+f.getEntityId()+"?optimistic\x3dtrue\x26rewrite-request\x3dtrue"),dataType:"json",contentType:"text/plain",data:JSON.stringify({body:{ancestor:a.syncRev,rev:a.confRev,state:{format:"html",value:a.html},merges:{master:{meta:{type:"client-reconciliation"}}}},headers:{"content-type":"application/json",
"x-token":b},method:"PUT"})}).pipe(f.asArray,f.asArray),"confluence.editor.synchrony.CR")}):g.Deferred().resolve([{},"success"])}function Z(a){f.time("confluence.editor.synchrony");g.when(Date.now(),a).pipe(function(b){z("on");var c=Date.now();d.trigger("analyticsEvent",{name:"confluence.synchrony.editor.loaded",data:{durationMillis:c-b,contentId:p.getContentId()}});d.trigger("rte-collab-ready");f.timeEnd("confluence.editor.synchrony");f.timeEnd("confluence.editor")})}function aa(){var a=D("synchrony.connected synchrony.connected.fake");
D("synchrony.connected synchrony.connected.fake synchrony-unsupported-extension",3E4).fail(function(b){B(b);d.trigger("analyticsEvent",{name:"confluence.synchrony.editor.load.timeout",data:{contentId:p.getContentId()}});ba();P=!0;a.done(function(){C||(Q=!0,L())})})}function ca(a,b,c){var e=m._initialiseSynchrony(),l=D("synchrony.connected.fake"),h=D(null);b.pipe(function(){setTimeout(h.reject,3E4,"synchrony-requests")});var q=m._initialiseCollabEditingComponents(h),r=Date.now(),u=null,E=null;d.DarkFeatures.isEnabled("synchrony-pessimistic-snapshot")||
(u=e.pipe(function(){return O(!0)}),u.done(function(k){E=k[1]}));var v=g.when(a,e).pipe(function(){return!u||"rejected"===u.state()||"error"===E||6E5<Date.now()-r?O(!1):u});c.pipe(function(){aa();Z(l);I.applyBlanket(l)});b.pipe(function(k){var F=e.pipe(function(){return Y(k)});v=g.when(v,e).pipe(function(n,w){f.time("confluence.editor.synchrony.unmarshal");var R=n;"success"===n[1]&&(R=[{stateAt:n[0].stateAt,state:w.unmarshal(n[0].state.value)},n[1]]);f.timeEnd("confluence.editor.synchrony.unmarshal");
return R});g.when(v,F).pipe(function(n,w){(n=N(n,w))?h.reject(n):h.resolve()});return d.DarkFeatures.isEnabled("synchrony-pessimistic-CR")||"synchrony-ack"!==k.syncRevSource&&!y.isUnpublished()?g.when(k,c,v,F,q):(d.debug("confluence.editor.synchrony: content up to date, not waiting for CR"),h.fail(B),g.when(k,c,v,[{},"success"],q))}).pipe(function(k,F,n,w){if(!m._bindEditor(k,F,n,w,h))return d.trigger("analyticsEvent",{name:"confluence.synchrony.bind.failure",data:{contentId:p.getContentId()}}),g.Deferred().reject("editor-binding-failed");
l.resolve()}).fail(function(k){c.always(function(){"synchrony-not-enabled"!==k&&(d.log("Failed to load the collaborative editor",k),B(k),d.$(function(){A.onDisconnectedState()}),z("failed"),d.trigger("analyticsEvent",{name:"confluence.synchrony.error",data:{error:k,contentId:p.getContentId()}}))})})}function D(a,b,c){var e=g.Deferred();a&&d.bind(a,function r(h,q){d.debug("confluence.editor.synchrony.event: "+h.type+"."+h.namespace);d.unbind(a,r);e.resolve(q)});b&&setTimeout(e.reject,b,c||"timeout");
return e}function x(a,b,c,e,l){var h=l||g.Deferred();if(f.isEditorInitialised()||b&&f.synchronyReady())return S(h,c);d.bind(a,function E(r,u){d.debug("confluence.editor.event "+r.type+"."+r.namespace);h.always(function(){d.unbind(a,E)});S(h,c,u,e)});return h}function S(a,b,c,e){return f.synchronyReady()?!e||e()?(b=b?b(c):c)&&b.error?a.reject(b.error):a.resolve(b):a:a.reject("synchrony-not-enabled")}function ba(){g("#websocketRetry").on("click",function(){d.trigger("analyticsEvent",{name:"confluence.synchrony.editor.websocket.retry.click"});
t.location.reload();return!1});g("#websocketFindmore").on("click",function(){d.trigger("analyticsEvent",{name:"confluence.synchrony.editor.websocket.findmore.click"})})}var m={};f.time("confluence.editor.synchrony.jsLoad");var A,C=!1,K=!1,Q=!1,P=!1,G;g(t).bind("beforeunload",function(){Q||d.trigger("analyticsEvent",{name:"confluence.synchrony.exit.before.connecting",data:{afterTimeout:P,contentId:p.getContentId()}})});d.bind("synchrony.history.evicted",function(a){K=!0});m._bindEditor=function(a,
b,c,e,l){f.time("confluence.editor.synchrony.init");if(N(c,e))return null;e=g("#syncRev");var h=null;"success"===c[1]&&(c=c[0],h={base:{rev:Synchrony.rev(c.stateAt),state:c.state}},e.val(h.base.rev.toString()));d.log("Synchrony will load with contentId: ",p.getContentId());try{var q=b.getBody();q.setAttribute("data-title",a.title);G=J.bind(Synchrony,b,q,h,a);T.handle(G,b,A,l);d.trigger("editor.remote.change");b.setDirty(!1);f.timeEnd("confluence.editor.synchrony.init");return G}catch(r){return d.logError(r),
null}};m._initialiseCollabEditingComponents=function(a){var b=X();g(t).one("synchrony.connected.fake",function(c){"connected.fake"===c.namespace&&(b.resolve(),a.resolve(),L(),z("fake"))});return b};m._initialiseSynchrony=function(){f.time("confluence.editor.synchrony.deps");(function(b){var c=b.Synchrony=b.Synchrony||{};if(!c.ready){var e=c._cbs=c._cbs||[];c.ready=function(q){e.push(q)}}var l=function(){1===c.state&&(c.SockJS=b.SockJS,c.init())};if(b.SockJS)c.init&&l();else{var h=b._sockjs_onload;
b._sockjs_onload=function(){l();h&&h.apply(this,arguments)}}})(t);var a=g.Deferred();Synchrony.ready(a.resolve);return g.when(a.promise(),f.loadScript(["/js/vendor/sockjs.min.js","/js/synchrony.min.js"])).pipe(function(b){f.timeEnd("confluence.editor.synchrony.deps");d.log("Synchrony successfully initialised.");return b})};m.init=function(){if(U.isCollaborativeContentType()){var a=x("rte-quick-edit-init rte-collaborative-content-ready rte-initial-raw-content-ready",!0),b=x("rte-quick-edit-init rte-collaborative-content-ready rte-initial-raw-content-ready rte-collab-editor-loaded",
!1),c=x("rte-collaborative-content-ready rte-initial-raw-content-ready",!1,y.getContent),e=x("rte-collab-editor-loaded",!1,d.Rte.getEditor);e=x("rte-ready rte-begin-collab-editing",!1,d.Rte.getEditor,W,e);a.pipe(function(){ca(b.promise(),c.promise(),e.promise())});c.fail(B);d.trigger("synchrony-events-bound");e.fail(function(l){"synchrony-not-enabled"===l&&(I.showEditor(),z("off"),d.log("Synchrony is not available in this context."))})}};m.register=function(){V.registerPlugin(m)};m.getSynchronisedEditorContent=
function(){var a=G.ackState();if(a.rev){var b=Synchrony.makeDom(a.state,{document,whitelist:J.makeWhitelist(Synchrony)});return{content:require("tinymce").activeEditor.serializer.serialize(b),syncRev:a.rev.toString()}}d.logError("Synchrony hasn't acked any data, can't fetch draft data");return null};f.timeEnd("confluence.editor.synchrony.jsLoad");return m});require("confluence/module-exporter").safeRequire("confluence-collaborative-editor-plugin/synchrony-editor",function(t){t.register();t.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:board-editor', location = 'boards/js/editor.js' */
var requirejs=require||requirejs;
requirejs(["cb","ajs","tinymce"],function(b,e,f){var c,g;b.toInit(function(){var d=b.getParam("spaceKey").trim(),l=d?"macro":"template",h=b.getParam("pageId");d=l+"/"+(d?d+"/":"")+h;var m=new b.Dialog({id:"board-macro-builder",width:800,height:550,path:"/boards/builder/"+d,customData:function(){return g},reloadEvent:"AppReload"}),n=new b.Dialog({id:"board-macro-picker",width:800,height:550,path:"/boards/picker/"+d,closeable:!1});b.connect("insertBoardMacro",function(a){var p=f.confluence.macrobrowser,
q=f.confluence.MacroUtils,k;a.filter&&a.filter.labels&&(k=a.filter.labels.join(","));a={contentId:h,macro:{name:"adhocboard",body:JSON.stringify(a),params:Object.assign({},a.filter,{name:a.name,labels:k})}};e.Rte.BookmarkManager.restoreBookmark();q.insertMacro(a,p.editedMacroDiv)});b.connect("fullScreen",function(a){c&&c.getState("open")&&c.resize({width:a?$(window).width():800,height:a?$(window).height():550})});e.MacroBrowser.setMacroJsOverride("adhocboard",{opener:function(a){e.Rte.BookmarkManager.storeBookmark();
a&&a.body&&1<a.body.length?(g={board:JSON.parse(a.body)},c=m):c=n;c.show()}})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:boardpagetemplates', location = 'templates/adhoclists/js/boards/boardpagetemplates.js' */
var requirejs=require||requirejs;
requirejs(["jquery","ajs","confluence/root"],function(a,c,f){function e(){console.log("init ad hoc boards createpage from template.");if(b.isBoardTemplate){a("#header").hide();a("#rte-button-preview").hide();a("#rte-savebar").find(".toolbar-split-left").hide();var d=c.getWindowQueryParams.createPageLabelsString||"";0<d.length&&a("#createpageform").find("#createPageLabelsString").val(d);f.Editor.addSaveHandler(function(){var g=a("#content-title").val();window.opener.$("body").trigger("boardTemplate.savePage",[g]);
a("body").fadeOut()})}}var b=b||{};b.hasQuery=location.href.indexOf("?")+1;b.queryString=b.hasQuery?location.href.substr(b.hasQuery):"";b.isBoardTemplate="true"===c.getWindowQueryParams().boardTemplate;c.toInit(function(){a("#rte").is(":visible")?e():c.bind("init.rte",function(d){console.log("AHP init.rte",d);0===a("#comments-section").size()&&e()})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:checklistdesigner', location = 'templates/adhoclists/js/checklists/checklistcore.js' */
var Adhoc=Adhoc||{};Adhoc.Checklist=Adhoc.Checklist||{};var Canvas=Canvas||{};
(function(a){Canvas.initialized&&Canvas.initialized("checklists.designer.core")||(a.fn.extend({setColumn:function(b){a(this).data("column",b);for(var c in b)break;a(this).data("type",c)},getColumnInfo:function(){var b={};if(a(this).hasClass("column"))return a(this).data("column");if(a(this).hasClass("aui.checklist"))return this.data("column");if(1==a(this).parents("form.aui.checklist").length)return a(this).parents("form.aui.checklist").data("column");a(this).hasClass("heading")?b.$heading=a(this):
b.$heading=a(this).parents("th.heading");b.column=b.$heading.data("column");b.type=b.$heading.data("type");var c=b.type;b.toJson=function(){return JSON.stringify(b.column[c])};b.resetHeading=function(){var d=AJS.escapeHtml(b.column[b.type].header);b.$heading.find("td.caption").html(d)};b.setAttributes=function(d){d=a("#column-header").val();var e=a("#cssclass").val(),f=a("#width").val();b.column[c].width=f;b.column[c].style=e;b.column[c].header=d};return b}}),Adhoc.Checklist.toJson=function(){return JSON.stringify(Adhoc.Checklist.checklist)},
Adhoc.Checklist.update=function(){Adhoc.Checklist.checklist.name=a("#checklistname").val();Adhoc.Checklist.checklist.maxRows=a("#checklistmaxrows").val();Adhoc.Checklist.checklist.leftJustified=0==a("#checklistCentered:checked").length;Adhoc.Checklist.checklist.templateName=a("#checklistTemplateName option:selected").val();Adhoc.Checklist.checklist.columns=[];var b={order:a("input[name\x3d'ascending']:checked").val(),sortBy:a("#checklistsorttype option:selected").val()};Adhoc.Checklist.checklist.sortType=
b;a("table.adhocchecklist tr.headings th.heading:not(.new)").each(function(){var c=a(this);c.removeClass("empty").removeClass("new");Adhoc.Checklist.checklist.columns.push(c.getColumnInfo().column)})},Adhoc.Checklist.init=function(){try{Adhoc.Checklist.checklist=JSON.parse(a(".checklistobject").text())}catch(c){AJS.log("error parsing "+a(".checklistobject").text())}var b=0;a("table.adhocchecklist tr.headings th.heading").each(function(){a(this).setColumn(Adhoc.Checklist.checklist.columns[b++])});
Adhoc.Checklist.spaceKey=AJS.params.spaceKey;AJS.tabs.setup()})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:checklistdesigner', location = 'templates/adhoclists/js/checklists/checklistdesigner.js' */
var Adhoc=Adhoc||{};Adhoc.Checklist=Adhoc.Checklist||{};Adhoc.debug={};Adhoc.debug2={};var requirejs=require||requirejs;
requirejs(["cb","jquery"],function(g,b){if(!Canvas.initialized("checklist.designer")){var n=function(){Adhoc.Checklist.update();var a=Adhoc.filter.labelsList(),c=Adhoc.filter.parent(),e=Adhoc.filter.depth();b.ajax({type:"POST",cache:!1,data:Adhoc.Checklist.toJson(),contentType:"application/json",url:g.contextPath+"/rest/adhoclists/latest/lists/"+Adhoc.Checklist.spaceKey+"/save?labels\x3d"+a+"\x26parent\x3d"+c+"\x26depth\x3d"+e,success:function(d,f,h){window.location=b(".savechecklist").attr("href")+
"\x26name\x3d"+Adhoc.Checklist.checklist.name},error:function(d,f,h){Adhoc.common.errorHandler(b(".checklistwrapper"),d,f,h)}})};Adhoc.Checklist.moveColumn=function(a){var c=a.parents("table.adhocchecklist"),e=c.find("tr.headings th").length;1!=e&&(a=Adhoc.Checklist.getColumnIndex(a,c),a<e-1?(l(c.find("tr.headings"),a,"th.heading"),l(c.find("tbody.rows tr"),a,"td")):(Adhoc.Checklist.moveCellsToFirstColumn(c.find("tr.headings"),a,"th.heading"),Adhoc.Checklist.moveCellsToFirstColumn(c.find("tbody.rows tr"),
a,"td")))};Adhoc.Checklist.addColumn=function(a){var c=a.parents("table.adhocchecklist"),e=Adhoc.Checklist.getColumnIndex(a,c),d,f;c.find("tr.headings").each(function(){d=jQuery(this).children("th.heading");f=d.eq(e).clone().insertAfter(d.eq(e))});c.find("tbody.rows tr").each(function(){d=jQuery(this).children("td");d.eq(e).clone().insertAfter(d.eq(e)).html("").attr("class","new")});f.add("new");f.setColumn({"new":{}});$caption=f.addClass("new").find("td.caption");$caption.html("\x26nbsp;");Adhoc.Checklist.columnDialog.trigger=
$caption.get(0);_.delay(function(){$caption.click()})};Adhoc.Checklist.getColumnIndex=function(a,c){a.addClass("moving");var e=0,d=-1;c.find("tr.headings th").each(function(){b(this).hasClass("moving")&&(d=e);e++});a.removeClass("moving");return d};var l=function(a,c,e){var d;a.each(function(){d=jQuery(this).children(e);d.eq(c).detach().insertAfter(d.eq(c+1))})};Adhoc.Checklist.removeColumn=function(a){var c=a.parents("table.adhocchecklist");if(1!=c.find("tr.headings th").length){var e=Adhoc.Checklist.getColumnIndex(a,
c);c.find("tr.headings th.heading").eq(e).remove();c.find("tbody.rows tr").each(function(){b(this).children("td").eq(e).remove()})}};Adhoc.Checklist.moveCellsToFirstColumn=function(a,c,e){var d;a.each(function(){d=jQuery(this).children(e);d.eq(c).detach().insertBefore(d.eq(0))})};Adhoc.Checklist.refresh=function(){Adhoc.Checklist.update();var a=b("tbody.rows");a.empty();b.ajax({type:"POST",cache:!1,data:Adhoc.Checklist.toJson(),contentType:"application/json",url:g.contextPath+"/rest/adhoclists/latest/lists/rows?spaceKey\x3d"+
g.getParam("spaceKey")+"\x26start\x3d0\x26count\x3d5\x26labels\x3d"+Adhoc.filter.labelsList(),success:function(c,e,d){a.append(c)},error:function(c,e,d){Adhoc.common.errorHandler(b(".checklistwrapper"),c,e,d)}})};var m=function(a){var c=a.getContainer();a=b(a.trigger);Adhoc.addSmallSpinner(c);var e=a.parents("th.heading"),d=a.getColumnInfo();e.hasClass("new")?b.ajax({type:"GET",cache:!1,contentType:"text/plain; charset\x3dutf-8",url:g.contextPath+"/rest/adhoclists/latest/lists/form/new",success:function(f){c.html(f);
c.find("form.aui.checklist").addClass("new").data("column",d)},error:function(f,h,k){Adhoc.common.errorHandler(b(".checklistwrapper"),f,h,k)}}):b.ajax({type:"POST",cache:!1,contentType:"application/json",url:g.contextPath+"/rest/adhoclists/latest/lists/form?type\x3d"+d.type+"\x26spaceKey\x3d"+Adhoc.Checklist.spaceKey,data:d.toJson(),success:function(f){c.html(f);c.find("form.aui.checklist").data("column",d);b(".accept",c).toggleButton(b("input.required",c))},error:function(f,h,k){Adhoc.common.errorHandler(b(".checklistwrapper"),
f,h,k)}})};Adhoc.Checklist.removeNewColumn=function(a){a=a.$el.find("form.checklist");var c=a.getColumnInfo().$heading;(a.hasClass("new")||c.hasClass("empty"))&&Adhoc.Checklist.removeColumn(c)};Adhoc.Checklist.checklistDesigner=function(){g.log("init checklist designer");Adhoc.Checklist.columnDialog&&Adhoc.Checklist.columnDialog.remove();Adhoc.Checklist.columnDialog=new g.InlineDialog({id:"columnDialog",width:320,trigger:".adhocchecklist.edit .headings .heading .caption",content:m,alignment:"bottom left",
onHide:Adhoc.Checklist.removeNewColumn,className:"cc-inline-dialog-columnPopup"});b(document.body).append(Adhoc.Checklist.columnDialog.render())};g.toInit(function(){b(document).on("click",".cnv-list-movecolumn",function(a){a.preventDefault();Adhoc.Checklist.moveColumn(b(this).parents("th.heading"))});b(document).on("click",".cnv-list-addcolumn",function(a){a.preventDefault();a=b(this).parents("th.heading");Adhoc.Checklist.addColumn(a)});b(document).on("click","form.aui.checklist.column .delete",
function(a){a.preventDefault();var c=b(this).getColumnInfo().$heading;Adhoc.doIfconfirm(c.find("td.caption").text(),"Are you sure you want to delete this column?",function(){a.preventDefault();Adhoc.Checklist.columnDialog.hide();Adhoc.Checklist.removeColumn(c)})});b(document).on("click","form.aui.checklist.column .cancel",function(a){a.preventDefault();Adhoc.Checklist.columnDialog.hide()});b(document).on("click","form.aui.checklist.column .moredetails a",function(a){a.preventDefault();
b(this).parents(".moredetails").addClass("hidden");b(".columndetails",b(this).parents("form")).removeClass("hidden")});b(document).on("change","#column-type",function(a){a.preventDefault();var c=b(this).find("option:selected").val();a=b(this).getColumnInfo();c=eval('({"'+c+'":{}})');a.$heading.setColumn(c);a.$heading.removeClass("new").addClass("empty");m(Adhoc.Checklist.columnDialog)});b(document).on("change","#checklistname",function(){b(".savechecklist").toggleButton(b(this));b(".continuechecklist").toggleButton(b(this))}).change();
b(document).on("keyup","#checklistname",function(){b(".savechecklist").toggleButton(b(this));b(".continuechecklist").toggleButton(b(this))}).change();b(document).on("change keyup","input.required",function(){var a=b(this).parents("form.aui"),c=b("input.required",a);b(".accept",a).toggleButton(c)});b(document).on("click",".savechecklist",function(){n()});b(document).on("click",".continuechecklist",function(a){a.preventDefault();b(".spacechecklistdesigner").removeClass("NEW");g.changeTab(b("a[href\x3d#checklist-editor-tab]"))});
b(document).on("submit",".checklistproperties",function(a){a.preventDefault();b(".spacechecklistdesigner").removeClass("NEW");g.changeTab(b("a[href\x3d#checklist-editor-tab]"))})})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:filterresources', location = 'templates/adhoclists/js/filter.js' */
Adhoc=Adhoc||{};Adhoc.filter=Adhoc.filter||{};var Canvas=Canvas||{};Adhoc.switchFilterGroup=function(c){$(c).is(":checked")?$(".main-filter").attr("readonly",!0):$(".main-filter").attr("readonly",!1)};
(function(c){if(!Canvas.initialized("filters")){Adhoc.filter.labelsList=function(){var a;if(a=Adhoc.filter.labels){for(var b="",d="",e=0;e<a.length;e++)b=b+d+a[e],d=",";a=b}else a="";return a};Adhoc.filter.load=function(){Adhoc.filter.labels=[];var a=AJS.params.adhocFilterLabels;a&&(Adhoc.filter.labels=a.split(","))};Adhoc.filter.parent=function(){var a=c("#checklistparent").val();return""!=a?a:""};Adhoc.filter.allSpaces=function(){return c("#allSpaces").is(":checked")?!0:!1};Adhoc.filter.spacekey=
function(){var a=c("#adhocFilterSpaceKey").val();return""!=a?a:""};Adhoc.filter.depth=function(){return c("#adhocFilterDepth.filterinput").val()||0};Adhoc.filter.getFilterParams=function(a){var b={labels:"",allSpaces:!1,parent:"",spacekey:"",depth:""};a&&a.params&&(a.params.allSpaces&&(b.allSpaces=a.params.allSpaces),a.params.labels&&(b.labels=a.params.labels),a.params.parent&&(b.parent=a.params.parent),a.params.spacekey&&(b.spacekey=a.params.spacekey),a.params.depth&&(b.depth=a.params.depth));return b};
Adhoc.filter.setFilterMacroParams=function(a){0<Adhoc.filter.labelsList().length&&(a.macro.params.labels=Adhoc.filter.labelsList());Adhoc.filter.allSpaces()&&(a.macro.params.allSpaces=Adhoc.filter.allSpaces());0<Adhoc.filter.parent().length&&(a.macro.params.parent=Adhoc.filter.parent());0<Adhoc.filter.spacekey().length&&(a.macro.params.spacekey=Adhoc.filter.spacekey());var b=Adhoc.filter.depth();0<b.length&&0<b&&(a.macro.params.depth=b)};var f=function(a){c("#filterlabels li[name\x3d'"+a+"']").remove();
c("#filterlabels").append("\x3cli name\x3d'"+a+"'\x3e"+a+"\x3ca class\x3d'remove-label' title\x3d'Delete'\x3eDelete\x3c/a\x3e\x3c/li\x3e");c("#filterlabelsstring").val("");c("#suggested-"+a).remove();c("#filterlabels").trigger("adhoc.update")};Adhoc.filter.init=function(){Adhoc.switchFilterGroup(c("input#allSpaces"));c("#filterlabelsstring").quicksearch("/labels/autocompletelabel.action",function(){},{makeParams:function(a){return{query:a,contentId:""}},dropdownPlacement:function(a){c("#labelsAutocompleteList").append(a)},
ajsDropDownOptions:{selectionHandler:function(a,b){b=c("span",b);b=c.data(b[0],"properties").name;f(b);this.hide();a.preventDefault()}}});Adhoc.filter.load();c("#filterlabels").trigger("adhoc.update")};AJS.toInit(function(a){AJS.log("init filter");a(document).on("click","#adhocfilter .suggested-label",function(b){b.preventDefault();f(a(this).text())});a(document).on("click","#adhocfilter .editfilterlabels",function(b){b.preventDefault();if(a("#adhocfilter .labelsdialog:visible").length)a("#adhocfilter .labelsdialog").toggleClass("hidden"),
a("#adhocfilter fieldset.labels").toggleClass("edit");else{var d=a(this).parent().find("#suggestedLabelsSpan .container");b=Adhoc.filter.spacekey()||AJS.params.spaceKey;a("#adhocfilter .labelsdialog").toggleClass("hidden");a("#adhocfilter fieldset.labels").toggleClass("edit");Adhoc.common.getSuggestedLabels(b,function(e){d.empty();a.each(e,function(h,g){d.append(AJS.template.load(Adhoc.sanitizeBoardContent("suggested-label").fill({suggestedLabel:g.name}).toString()))})})}});a(document).on("click",
"#filterlabels li a",function(b){b.preventDefault();a(this).parents("li").remove();a("#filterlabels").trigger("adhoc.update")});a(document).on("click","#add-filter-label",function(b){b.preventDefault();(b=a("#filterlabelsstring").val())&&0<b.length&&(f(b),a("#filterlabelsstring").val(""))});a(document).on("click","#done-filter-label",function(b){b.preventDefault();a("#adhocfilter .editfilterlabels").click()});a(document).on("adhoc.update","#filterlabels",function(){Adhoc.filter.labels=[];a("#filterlabels li").each(function(){Adhoc.filter.labels.push(a(this).attr("name"))});
0<Adhoc.filter.labels.length?a("fieldset.labels .description").removeClass("hidden"):a("fieldset.labels .description").addClass("hidden")});a(document).on("focusout","input#adhocFilterSpaceKey",()=>{setTimeout(()=>{var b=Adhoc.filter.spacekey();0<b.length&&(a("input#checklistparent").attr("data-spacekey",b),AJS.log("changed data-spacekey to "+b),Confluence.Binder.autocompletePage())},100)});a(document).on("change","input#allSpaces",function(){Adhoc.switchFilterGroup(this)});Adhoc.filter.init()})}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:columnresources', location = 'templates/adhoclists/js/checklists/columns/label.js' */
(function(e){Canvas.initialized("label.column")||AJS.toInit(function(a){AJS.log("init label.column");a(document).on("change","#column-label-select",function(b){b.preventDefault();b=a("#column-label-select option:selected").val();0<b.length?(a(".field-group.labelname").addClass("existinglabel"),0==a("#column-header").val()&&(a("#column-header").val(b),a("#column-header").change()),a(".field-group.labelname input").val(b),a(".field-group.labelname input").trigger("keyup")):(a(".field-group.labelname input").val(""),
a(".field-group.labelname input").trigger("keyup"),a(".field-group.labelname").removeClass("existinglabel"))});a(document).on("click","form.aui.checklist.column.label .accept",function(b){b.preventDefault();var d=a(this).parents("form.aui.checklist");b=d.getColumnInfo();b.setAttributes(d);b.resetHeading();d=a("#readonly:checked").val();b.column[b.type].readOnly="undefined"!=typeof d;b.column[b.type].color=a("#label-color").val()||"";if(0<a("#column-label-select").length)var c=a("#column-label-select option:selected").val();
if(c&&0<c.length)b.column[b.type].labelName=c;else if(0<a("#column-label").val().length)if(c=a("#column-label").val(),Adhoc.common.isValidLabel(c))b.column[b.type].labelName=c;else return Adhoc.common.errorMessage(a("#column-label").parent(),"Invalid label name",5E3),!1;else return!1;Adhoc.Checklist.columnDialog.hide();Adhoc.Checklist.refresh()})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:columnresources', location = 'templates/adhoclists/js/checklists/columns/input.js' */
(function(g){Canvas.initialized("input.column")||AJS.toInit(function(b){AJS.log("init input.column");b(document).on("click","form.aui.checklist.column.input .accept",function(a){a.preventDefault();var c=b(this).parents("form.aui.checklist");a=c.getColumnInfo();a.setAttributes(c);a.resetHeading();c=a.column[a.type].header;var e=b("#inputWidth").val(),f=b("#readonly:checked").val(),d=a.column[a.type];d.readOnly="undefined"!=typeof f;d.inputWidth=e;d.valueName=c;Adhoc.debug=a;Adhoc.Checklist.columnDialog.hide();
Adhoc.Checklist.refresh()})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:columnresources', location = 'templates/adhoclists/js/checklists/columns/page.js' */
(function(d){Canvas.initialized("page.column")||AJS.toInit(function(a){AJS.log("init page.column");a(document).on("change","#column-page-type",function(b){b.preventDefault();a("#column-header").val(a("#column-page-type option:selected").text());a("#column-header").change()});a(document).on("click","form.aui.checklist.column.page .accept",function(b){b.preventDefault();b=a(this).parents("form.aui.checklist");var c=b.getColumnInfo();c.setAttributes(b);c.resetHeading();c.column[c.type].type=a("#column-page-type option:selected").val();
Adhoc.debug=c;Adhoc.Checklist.columnDialog.hide();Adhoc.Checklist.refresh()})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:columnresources', location = 'templates/adhoclists/js/checklists/columns/wiki.js' */
(function(d){Canvas.initialized("wiki.column")||AJS.toInit(function(b){AJS.log("init wiki.column");b(document).on("click","form.aui.checklist.column.wiki .accept",function(c){c.preventDefault();c=b(this).parents("form.aui.checklist");var a=c.getColumnInfo();a.setAttributes(c);a.resetHeading();0<b("#wikicontent").length&&(a.column[a.type].body=b("#wikicontent").val());Adhoc.debug=a;Adhoc.Checklist.columnDialog.hide();Adhoc.Checklist.refresh()})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:columnresources', location = 'templates/adhoclists/js/checklists/columns/metadata.js' */
(function(d){Canvas.initialized("metadata.column")||AJS.toInit(function(c){AJS.log("init metadata.column");c(document).on("click","form.aui.checklist.column.metadata .accept",function(b){b.preventDefault();b=c(this).parents("form.aui.checklist");var a=b.getColumnInfo();a.setAttributes(b);a.resetHeading();a.column[a.type].valueName=a.column[a.type].header;Adhoc.debug=a;Adhoc.Checklist.columnDialog.hide();Adhoc.Checklist.refresh()})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:columnresources', location = 'templates/adhoclists/js/checklists/columns/wikiinput.js' */
(function(h){Canvas.initialized("wikiinput.column")||AJS.toInit(function(b){AJS.log("init wikiinput.column");b(document).on("click","form.aui.checklist.column.wikiinput .accept",function(a){a.preventDefault();var c=b(this).parents("form.aui.checklist");a=c.getColumnInfo();a.setAttributes(c);a.resetHeading();c=a.column[a.type].header;var e=b("#rows").val(),f=b("#inputWidth").val(),g=b("#readonly:checked").val(),d=a.column[a.type];d.readOnly="undefined"!=typeof g;d.rows=e;d.inputWidth=f;d.valueName=
c;Adhoc.debug=a;Adhoc.Checklist.columnDialog.hide();Adhoc.Checklist.refresh()})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:columnresources', location = 'templates/adhoclists/js/checklists/columns/selectlabel.js' */
(function(k){function g(b){return 0<b.find("input").filter(function(){return""!==this.value}).length}Canvas.initialized("selectlabel.column")||AJS.toInit(function(b){AJS.log("init selectlabel.column");b(document).on("click","form.aui.checklist.column.selectlabel .addoption",function(a){a.preventDefault();a=b(this).parents("tr");var c=g(a),f=a.prev(),e=a.next(),d=g(e);if(!e.length&&c||!f.length&&d||c&&d)c=a.clone(),b("input",c).val(""),a.after(c)});b(document).on("click","form.aui.checklist.column.selectlabel .removeoption",
function(a){a.preventDefault();a.stopPropagation();1<b(this).parents("tbody").find(".removeoption").length&&b(this).parents("tr").remove()});b(document).on("change","form.aui.checklist.column.selectlabel input[name\x3d'label']",function(a){a.preventDefault();a=b(this).parents("tr");a=b("input[name\x3d'caption']",a);""==a.val()&&a.val(b(this).val())});b(document).on("blur","form.aui.checklist.column.selectlabel input[name\x3d'caption']",function(a){a.preventDefault();a=b(this).parents("tr");if(!a.next()||
!a.next().is("tr")){var c=a.clone();b("input",c).val("");a.after(c);b("input[name\x3d'label']",c).focus()}});b(document).on("click","form.aui.checklist.column.selectlabel .accept",function(a){a.preventDefault();a=b(this).parents("form.aui.checklist");var c=a.getColumnInfo();c.setAttributes(a);c.resetHeading();var f=b("#readonly:checked",a).val();c.column[c.type].readOnly="undefined"!=typeof f;c.column[c.type].options=[];var e=0;b("tr",a).each(function(){var d={},h=b(this).find("input[name\x3d'label']");
d.key=h.val();d.value=b(this).find("input[name\x3d'caption']").val();d.key&&0<d.key.length&&(Adhoc.common.isValidLabel(d.key)?(void 0==d.value&&0==d.value.length&&(d.value=d.key),c.column[c.type].options.push(d)):(Adhoc.common.errorMessage(h.parent(),"Invalid label name",5E3),e++))});0<c.column[c.type].options.length&&0==e&&(Adhoc.Checklist.columnDialog.hide(),Adhoc.Checklist.refresh())})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:columnresources', location = 'templates/adhoclists/js/checklists/columns/select.js' */
(function(h){function f(c){return 0<c.find("input").filter(function(){return""!==this.value}).length}Canvas.initialized("select.column")||AJS.toInit(function(c){AJS.log("init select.column");c(document).on("eveclicknt","form.aui.checklist.column.select .addoption",function(a){a.preventDefault();a=c(this).parents("tr");var b=f(a),e=a.prev(),d=a.next(),g=f(d);if(!d.length&&b||!e.length&&g||b&&g)b=a.clone(),c("input",b).val(""),a.after(b)});c(document).on("click","form.aui.checklist.column.select .removeoption",
function(a){a.preventDefault();a.stopPropagation();1<c(this).parents("tbody").find(".removeoption").length&&c(this).parents("tr").remove()});c(document).on("blur","form.aui.checklist.column.select input[name\x3d'option']",function(a){a.preventDefault();a=c(this).parents("tr");if(0<c(this).val().length&&(!a.next()||!a.next().is("tr"))){var b=a.clone();c("input",b).val("");a.after(b);c("input[name\x3d'option']",b).focus()}});c(document).on("click","form.aui.checklist.column.select .accept",function(a){a.preventDefault();
a=c(this).parents("form.aui.checklist");var b=a.getColumnInfo();b.setAttributes(a);b.resetHeading();var e=c("#readonly:checked",a).val();b.column[b.type].readOnly="undefined"!=typeof e;b.column[b.type].options=[];c("tr",a).each(function(){var d={};d.key=c(this).find("input[name\x3d'option']").val();(d.value=d.key)&&0<d.key.length&&b.column[b.type].options.push(d)});0<b.column[b.type].options.length&&(Adhoc.Checklist.columnDialog.hide(),Adhoc.Checklist.refresh())})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:rte-checklistresources', location = 'templates/adhoclists/js/rte/lists-rte.js' */
var requirejs=require||requirejs;
requirejs(["jquery","ajs","confluence/root"],function(a,c,r){var n=function(){var b=a("#list-name-select option:selected");return{name:b.text(),spaceList:b.hasClass("spacelist"),popularLabels:b.hasClass("popularlabels"),empty:b.hasClass("empty"),importList:b.hasClass("import"),listMarkup:encodeURIComponent(a("#newlistmarkup").val())}},v=function(b,g){var e=Adhoc.filter.getFilterParams(b);if(b&&b.body&&1<b.body.length)e=c.Confluence.getContextPath()+"/rest/adhoclists/latest/lists/"+c.params.contentId+
"/edit?parent\x3d"+e.parent+"\x26filterspacekey\x3d"+e.spacekey+"\x26labels\x3d"+e.labels+"\x26depth\x3d"+e.depth,a.ajax({type:"POST",cache:!1,data:b.body,contentType:"application/json",url:e,success:function(f,k,l){f=(new Canvas.CML.Dialog({id:"listDesigner",className:"adhocmacrodialog",width:870,height:530,title:"Edit List",content:f,open:!0,remove:!0,actions:[{id:"insert",style:"primary "+(g?"insert-list":"save-list"),label:g?"\u63d2\u5165":"\u4fdd\u5b58",
onClick:function(d){d.preventDefault();Canvas.CML.analytics.trackEvent("checklist","edit");console.log("makeUpdateChecklistMacro");Adhoc.Checklist.update();d={contentId:r.Editor.getContentId(),macro:{name:"adhoclist",body:Adhoc.Checklist.toJson(),params:{name:Adhoc.Checklist.checklist.name}}};Adhoc.filter.setFilterMacroParams(d);macroRenderRequest=debugo=d;d=tinymce.confluence.macrobrowser;c.Rte.BookmarkManager.restoreBookmark();tinymce.confluence.MacroUtils.insertMacro(macroRenderRequest,d.editedMacroDiv);
Canvas.CML.closeDialogs()}},{id:"cancel",style:"link cancel-insert-list",label:"\u53d6\u6d88"}],onOpen:function(){Adhoc.Checklist.init();Adhoc.Checklist.checklistDesigner();Adhoc.filter.init()}})).getContent();c.Confluence.Binder.autocompletePage(f);c.Confluence.Binder.autocompleteSpace(f)},error:function(f,k,l){Adhoc.common.errorHandler(void 0,f,k,l)}});else{var m=!1;b&&b.params&&b.params.name?(b=b.params.name,m=!0):b="";a.ajax({type:"GET",cache:!1,url:c.Confluence.getContextPath()+
"/rest/adhoclists/latest/lists/"+c.params.spaceKey+"/select?name\x3d"+encodeURIComponent(b)+"\x26parent\x3d"+e.parent+"\x26filterspacekey\x3d"+e.spacekey+"\x26labels\x3d"+e.labels+"\x26depth\x3d"+e.depth+"\x26allSpaces\x3d"+e.allSpaces,success:function(f,k,l){f=(new Canvas.CML.Dialog({id:"insertList",className:"adhocmacrodialog",width:870,height:530,title:"Insert List",content:f,open:!0,remove:!0,actions:[{id:"insert",style:"primary insert-list",label:"\u63d2\u5165",
onClick:function(){console.log("insert list inside");var d=t(),h=tinymce.confluence.macrobrowser;console.log("22",h);c.Rte.BookmarkManager.restoreBookmark();console.log("33",d);tinymce.confluence.MacroUtils.insertMacro(d,h.editedMacroDiv);console.log("44");Canvas.CML.closeDialogs()}},{id:"modify",style:"primary modify-list",label:"Continue",onClick:function(){var d=t(),h=n();a.ajax({type:"GET",cache:!1,url:c.Confluence.getContextPath()+"/rest/adhoclists/latest/lists/"+d.contentId+
"/get?name\x3d"+encodeURIComponent(d.macro.params.name)+"\x26space\x3d"+d.macro.params.spacelist+"\x26popularLabels\x3d"+d.macro.params.popularlabels+"\x26empty\x3d"+h.empty+"\x26listMarkup\x3d"+h.listMarkup,success:function(p,u,q){200==q.status?(d.macro.body=p,h.empty&&(d.macro.params.parent="@self"),Canvas.CML.closeDialogs(),v(d.macro,!0)):a("#listmarkuperror").html("Invalid list markup").removeClass("hidden")},error:function(p,u,q){Adhoc.common.errorHandler(a("#insertList .dialog-page-menu"),p,
u,q)}})}},{id:"cancel",style:"link cancel-insert-list",label:"\u53d6\u6d88"}],onOpen:function(){m&&a("#list-copy-param").addClass("hidden");a("#list-name-select").focus().change();Adhoc.filter.init()}})).getContent();c.Confluence.Binder.autocompletePage(f);c.Confluence.Binder.autocompleteSpace(f)},error:function(f,k,l){Adhoc.common.errorHandler(void 0,f,k,l)}})}},t=function(){var b=n(),g={contentId:r.Editor.getContentId(),macro:{name:"adhoclist",params:{name:b.name}}};b.popularLabels&&
(g.macro.params.popularlabels=b.popularLabels);Adhoc.filter.setFilterMacroParams(g);return g},w=function(){a(document).on("change","#copy-list",function(b){a(this).prop("checked")?(a(".insert-list").addClass("hidden"),a(".modify-list").removeClass("hidden"),a("#adhocfilter").addClass("hidden")):(a(".insert-list").removeClass("hidden"),a(".modify-list").addClass("hidden"),a("#adhocfilter").removeClass("hidden"))});a(document).on("change","#list-name-select",function(b){b=n();b.empty?(a("#copy-list").prop("checked",
"checked").change().prop("disabled","disabled"),a("#macro-browser-preview").html(""),a(".insert-list").addClass("hidden"),a(".modify-list").removeClass("hidden"),a("#bundled-list-desc").empty(),a(".listmarkup").addClass("hidden"),a("#boardmarkuperror").addClass("hidden"),a(".pagetablefilter").addClass("hidden")):b.importList?(a("#copy-list").prop("checked","checked").change().prop("disabled","disabled"),a("#macro-browser-preview").html(""),a(".insert-list").addClass("hidden"),a(".modify-list").removeClass("hidden"),
a("#bundled-list-desc").empty(),a(".listmarkup").removeClass("hidden"),a(".pagetablefilter").addClass("hidden")):(a(".pagetablefilter").removeClass("hidden"),a("#boardmarkuperror").addClass("hidden"),a(".listmarkup").addClass("hidden"),a("#copy-list").removeAttr("disabled").change(),a(".insert-list").removeClass("hidden"),a("#adhocfilter").removeClass("hidden"),a(".modify-list").addClass("hidden"),a.ajax({type:"GET",cache:!1,url:c.Confluence.getContextPath()+"/rest/adhoclists/latest/lists/"+c.params.spaceKey+
"/namedpreview?name\x3d"+b.name+"\x26space\x3d"+b.spaceList+"\x26popularLabels\x3d"+b.popularLabels,success:function(g,e,m){a("#macro-browser-preview.macro-preview-dialog").html(g);g=a(".list-desc").html();a("#bundled-list-desc").html(g)},error:function(g,e,m){Adhoc.common.errorHandler(a("#macro-browser-preview.macro-preview-dialog"),g,e,m)}}))});a(document).on("click",".cancel-insert-list",Canvas.CML.closeDialogs);a(document).on("click",".aui-tabs.checklist li.menu-item a",function(b){b.preventDefault();
b=a(this).parents(".aui-tabs");b.find(".menu-item").removeClass("active-tab");a(this).parents("li").addClass("active-tab");b.find(".tabs-pane").removeClass("active-pane");a(a(this).attr("href")).addClass("active-pane")})};c.bind("init.rte",function(){c.log("init lists-rte");c.MacroBrowser.setMacroJsOverride("adhoclist",{opener:v});w()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.adhoccanvas:boardsrte', location = 'templates/com/comalatech/adhoccanvas/rte/soy/boards.soy' */
// This file was automatically generated from boards.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Canvas.RTE.
 */

if (typeof Canvas == 'undefined') { var Canvas = {}; }
if (typeof Canvas.RTE == 'undefined') { Canvas.RTE = {}; }


Canvas.RTE.iframe = function(opt_data, opt_ignored) {
  return '<iframe frameborder=\'0\' width=\'100%\' height=\'624\' class=\'canvas\'src="' + soy.$$escapeHtml(opt_data.contextPath) + '/plugins/servlet/adhoccanvas/picker?spaceKey=' + soy.$$escapeHtml(opt_data.spaceKey) + '"/>';
};
if (goog.DEBUG) {
  Canvas.RTE.iframe.soyTemplateName = 'Canvas.RTE.iframe';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:trigger', location = '/includes/js/trigger.js' */
define("confluence/trigger",["jquery","window"],function(b,c){return function(a,d){a=new b.Event(a);b(d||c.top.document).trigger(a);return!a.isDefaultPrevented()}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/trigger","AJS.jiraTrigger");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:keyboard', location = '/includes/js/api/keyboard.js' */
define("confluence/api/keyboard",["jquery"],function(f){function b(a,b,c){h[b]=a;i[a]=b;c&&(j[b]=!0);return a}function g(a){a=a.originalEvent||a;return null==a.which?a.keyCode:0!==a.which&&0!==a.charCode?a.which:null}function k(a){var a=a.originalEvent||a,b=e.specialKeyEntered(a);if(b)return b;if(f.browser.mozilla){if("keypress"===a.type&&(a=g(a),null!==a))return String.fromCharCode(a).toLowerCase()}else if("keypress"!==a.type)return String.fromCharCode(a.keyCode).toLowerCase()}var e={},h={},i={},
j={},c=e.SpecialKey={BACKSPACE:b("backspace",8,!0),TAB:b("tab",9,!0),RETURN:b("return",13,!0),SHIFT:b("shift",16),CTRL:b("ctrl",17),ALT:b("alt",18),PAUSE:b("pause",19),CAPS_LOCK:b("capslock",20),ESC:b("esc",27,!0),SPACE:b("space",32,!0),PAGE_UP:b("pageup",33),PAGE_DOWN:b("pagedown",34),END:b("end",35),HOME:b("home",36),LEFT:b("left",37),UP:b("up",38),RIGHT:b("right",39),DOWN:b("down",40),INSERT:b("insert",45),DELETE:b("del",46),F1:b("f1",112),F2:b("f2",113),F3:b("f3",114),F4:b("f4",115),F5:b("f5",
116),F6:b("f6",117),F7:b("f7",118),F8:b("f8",119),F9:b("f9",120),F10:b("f10",121),F11:b("f11",122),F12:b("f12",123),NUMLOCK:b("numlock",144),SCROLL:b("scroll",145),META:b("meta",224)};c.eventType=function(){return f.browser.mozilla?"keypress":"keydown"};c.fromKeyCode=function(a){return h[a]};c.toKeyCode=function(a){return i[a]};c.isAscii=function(a){return!!j[a]};c.isSpecialKey=function(a){return!!c.toKeyCode(a)};e.characterEntered=function(a){a=a.originalEvent||a;if("keypress"===a.type&&(a=g(a),
null!==a&&(!c.isAscii(a)||c.fromKeyCode(a)===c.SPACE)))return String.fromCharCode(a)};e.specialKeyEntered=function(a){a=a.originalEvent||a;if(f.browser.mozilla){if("keypress"===a.type){var b=g(a);if(null===b)return c.fromKeyCode(a.keyCode);if(c.isAscii(b))return c.fromKeyCode(b)}}else if("keypress"!==a.type)return c.fromKeyCode(a.keyCode)};e.shortcutEntered=function(a){a=a.originalEvent||a;if(a.type===e.SpecialKey.eventType()){var b=e.specialKeyEntered(a),d="";a.altKey&&b!==c.ALT&&(d+=c.ALT+"+");
a.ctrlKey&&b!==c.CTRL&&(d+=c.CTRL+"+");a.metaKey&&(!a.ctrlKey&&b!==c.META)&&(d+=c.META+"+");a.shiftKey&&b!==c.SHIFT&&(d+=c.SHIFT+"+");if(b)return d+b;if(0<d.length&&"shift+"!==d&&(a=k(a)))return d+a}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence/api/keyboard","AJS.Keyboard");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/class.js' */
define("confluence/class",["jquery"],function(f){var j=function(d){var a=function(){};a.prototype=d;return new a},i=!1,l=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,k=function(){};k.extend=function(){function d(){!i&&this.init&&this.init.apply(this,arguments)}var a,g=this.prototype;if(1<arguments.length){var c=f.makeArray(arguments);a=c.pop();var h;f.each(c,function(b,a){h=h?h.extend(a):a});return h.extend(this.prototype).extend(a)}a=arguments[0];i=!0;c=new this;i=!1;for(var b in a)if(c[b]="function"===
typeof a[b]&&"function"===typeof g[b]&&l.test(a[b]))c[b]=function(a,b){return function(){var c=this._super;this._super=g[a];var d=b.apply(this,arguments);this._super=c;return d}}(b,a[b]);else if("object"===typeof g[b]){var e=j(a[b]);f.each(g[b],function(a,b){if(e[a]){if("object"===typeof e[a]){var c=j(e[a]);f.each(b,function(a,b){c[a]||(c[a]=b)});e[a]=c}}else e[a]=b});c[b]=e}else c[b]=a[b];d.prototype=c;d.constructor=d;d.extend=arguments.callee;return d};return k});
require("confluence/module-exporter").exportModuleAsGlobal("confluence/class","Class");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/control.js' */
define("confluence/control","confluence/class confluence/trigger confluence/api/logger confluence/api/keyboard jquery document".split(" "),function(k,l,i,g,d,e){return k.extend({INVALID:"INVALID",_throwReadOnlyError:function(a){Error(this.CLASS_SIGNATURE+": Sorry ["+a+"] is a read-only property")},_assignEvents:function(a,b){this._unassignEvents(a,b);if(typeof b==="string")for(var c in this._events[a])d(e).delegate(b,c,this._getDispatcher(a,c));else{b=d(b);for(c in this._events[a]){b.bind(c,this._getDispatcher(a,
c));i.debug("Control bound eventType '"+c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")}}},_unassignEvents:function(a,b){if(typeof b==="string")for(var c in this._events[a])d(e).undelegate(b,c,this._getDispatcher(a,c));else{b=d(b);try{for(c in this._events[a])b.unbind(c,this._getDispatcher(a,c))}catch(g){var f=d._data(b[0],"events");if(f)for(c in f)if(c in this._events[a]){for(var m=this._getDispatcher(a,c),j=f[c],h=0;h<j.length;h++)if(j[h]===m){j.splice(h,1);break}i.debug("Control unbound eventType '"+
c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")}}}},_getDispatcher:function(a,b){var c=a+"/"+b;if(!this._dispatchers)this._dispatchers={};if(!this._dispatchers[c]){var e=this._events[a][b],f=this;this._dispatchers[c]=function(c){i.debug("Control dispatching eventType '"+b+"' for group '"+a+"' on instance '"+f.type+"'");return e.call(f,c,d(this))}}return this._dispatchers[c]},_isValidInput:function(){return true},_handleKeyEvent:function(a){if(this._isValidInput(a)){var b=g.SpecialKey,c=
g.shortcutEntered(a);if(c){if(this.keys[c]){this.keys[c].call(this,a);return}if((c===b.BACKSPACE||c===b.DELETE)&&this.keys.onEdit){this.keys.onEdit.call(this,a);return}}(b=g.characterEntered(a))&&this.keys.onEdit&&this.keys.onEdit.call(this,a,b)}},getCustomEventName:function(a){return(this.CLASS_SIGNATURE||"")+"_"+a},_getCustomEventArgs:function(){return[this]},trigger:function(a){return l(a,this)},_supportsBoxShadow:function(){var a=e.body.style;return a.WebkitBoxShadow!==void 0||a.MozBoxShadow!==
void 0||a.boxShadow!==void 0},_setOptions:function(a){var b,c,a=a||{};if(a instanceof d||typeof a==="string"||typeof a==="object"&&a.nodeName)a={element:a};b=d(a.element);c=b.getOptionsFromAttributes();this.options=d.extend(true,this._getDefaultOptions(a),c,a);if(b.length===0)return this.INVALID},getCaret:function(a){var b=a.selectionStart;if(b>=0)return a.selectionEnd>b?-1:b;if(e.selection){b=e.selection.createRange();if(b.text.length===0){var c=b.duplicate();c.moveToElementText(a);c.setEndPoint("EndToStart",
b);return c.text.length}}return-1},_render:function(){var a,b=arguments[0],c=[];for(a=1;a<arguments.length;a++)c.push(arguments[a]);return this._renders[b].apply(this,c)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence/control","AJS.Control");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/api/mouse.js' */
define("confluence/api/mouse",["jquery","window"],function(d,e){var b={MotionDetector:function(){this.reset()}};b.MotionDetector.prototype.reset=function(){this._y=this._x=this._handler=null;this.moved=!1};b.MotionDetector.prototype.wait=function(b){var a=this;a._handler||(this.reset(),d(e.top.document).bind("mousemove",a._handler=function(c){!a._x&&!a._y?(a._x=c.pageX,a._y=c.pageY):c.pageX===a._x&&c.pageY===a._y||(a.unbind(),a.moved=!0,b&&b.call(this,c))}))};b.MotionDetector.prototype.unbind=function(){this._handler&&
(d(e.top.document).unbind("mousemove",this._handler),this.reset())};return b});require("confluence/module-exporter").exportModuleAsGlobal("confluence/api/mouse","AJS.Mouse");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/group.js' */
define("confluence/group",["confluence/control","confluence/api/logger","jquery"],function(d,e,c){return d.extend({init:function(){this.type=this.type||"Group";this.items=[];this.index=-1;this._assignEvents("instance",this)},addItem:function(a){this.items.push(a);this._assignEvents("item",a)},removeItem:function(a){var b=c.inArray(a,this.items);if(0>b)throw Error("Group: item ["+a+"] is not a member of this group");a.trigger("blur");b<this.index&&this.index--;this.items.splice(b,1);this._unassignEvents("item",
a)},removeAllItems:function(){for(var a=0;a<this.items.length;a++)this._unassignEvents("item",this.items[a]),this.items[a].trigger("blur");this.index=-1;this.items.length=0;this._unassignEvents("keys",document)},shiftFocus:function(a){e.debug("Group.shiftFocus called with offset: "+a);-1===this.index&&1===a&&(a=0);0<this.items.length&&(a=(Math.max(0,this.index)+this.items.length+a)%this.items.length,this.items[a].trigger("focus"))},prepareForInput:function(){this._assignEvents("keys",document)},_events:{instance:{focus:function(){0!==
this.items.length&&(0>this.index?this.items[0].trigger("focus"):this._assignEvents("keys",document))},blur:function(){0<=this.index?this.items[this.index].trigger("blur"):this._unassignEvents("keys",document)}},keys:{"keydown keypress":function(a){this._handleKeyEvent(a)}},item:{focus:function(a){var b=this.index;this.index=c.inArray(a.target,this.items);0>b?this.trigger("focus"):b!==this.index&&this.items[b].trigger("blur")},blur:function(a){this.index===c.inArray(a.target,this.items)&&(this.index=
-1,this.trigger("blur"))},remove:function(a){this.removeItem(a.target)}}},keys:{}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence/group","AJS.Group");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/select-grid.js' */
define("confluence/select-grid",["ajs","jquery","confluence/templates","confluence/group","confluence/control"],function(g,d,j,e,m){var e=e.extend({init:function(a){this.type=this.type||"SelectGrid";this._super();var b=d(j.SelectGrid.gridOutline()),c=b.find("thead tr");d(a.columns).each(function(a,b){var f=d("<th></th>").addClass(b.getClassName()).text(b.heading);c.append(f)});this.gridContainer=d(a.gridContainer).append(b);this.getRowId=a.getRowId;this.table=b;this.columns=a.columns;this.selectionCallback=
a.selectionCallback;this.body=b.find("tbody");this.body.delegate("a","click",function(a){a.preventDefault()});this.dontShiftFocus=a.dontShiftFocus||function(){}},keys:{up:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(-1),a.preventDefault())},down:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(1),a.preventDefault())}},_addRow:function(a,b,c,h){d.isFunction(c)&&(h=c,c=!1);c?this.body.prepend(a):this.body.append(a);a=new n({row:a,data:b,
callback:h,getRowId:this.getRowId,selectionCallback:h});this.addItem(a);return a},clear:function(){this.removeAllItems();this.body.children().remove()},_addRows:function(a,b){var c=this,h=[];d(a).each(function(a,f){var g=c.columns,e,i,k,l;e=d("<tr></tr>");d(g).each(function(a,b){i={outerClass:b.getClassName(f)||"",href:b.getHref&&b.getHref(f)||"",innerClass:b.getInnerClass&&b.getInnerClass(f)||"",title:b.getTitle&&b.getTitle(f)||"",text:b.getText(f)||""};k=i.href?"cellWithLink":"cellWithoutLink";
l=j.SelectGrid[k](i);e.append(l)});e.attr("data-id",c.getRowId(f));h.push(c._addRow(e,f,b,c.selectionCallback))});return h},update:function(a){this.clear();!a||!a.length?g.debug("SelectGrid.update called with no data, returning."):(this._addRows(a),this.prepareForInput())},prependAndSelect:function(a,b){!a||!a.length?g.debug("SelectGrid.prependAndSelect called with no data, returning."):this._addRows(a,!0)[b||0].selectRow()},findItem:function(a){for(var b=0;b<this.items.length;b++)if(this.items[b].getRowId()==
a)return this.items[b];g.debug("SelectGrid.findItem didn't find item, returning null.");return null},select:function(a){(a=this.findItem(a))&&a.selectRow()},selectIndex:function(a){a=a||0;this.items[a]?this.items[a].selectRow():g.debug("SelectGrid.selectIndex couldn't select row with index "+a+", not found")},show:function(){this.gridContainer.removeClass("hidden")},hide:function(){this.gridContainer.addClass("hidden")},isVisible:function(){return!this.gridContainer.hasClass("hidden")}}),n=m.extend({init:function(a){this.type=
"SelectableRow";this.$row=d(a.row);this.$row.data("properties",a.data);this.getRowId=function(){return a.getRowId(a.data)};this.selectionCallback=a.selectionCallback;this._assignEvents("element",this.$row);this._assignEvents("instance",this);g.debug("SelectableRow initialized")},_events:{instance:{focus:function(){var a=this.$row;a.addClass("selected");this.selectionCallback(a,a.data("properties"))},blur:function(){this.$row.removeClass("selected")}},element:{click:function(){this.trigger("focus")}}},
selectRow:function(){this.trigger("focus")}});e.Column=function(a){var b=function(b){return b[a.key]};return{key:a.key,heading:a.heading,getClassName:a.getClassName||function(){return a.className||a.key+"-field"},getHref:a.getHref,getInnerClass:a.getInnerClass,getTitle:a.getTitle,getText:a.getText||b}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence/select-grid","AJS.SelectGrid");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/select-grid.soy' */
// This file was automatically generated from select-grid.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.SelectGrid.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.SelectGrid == 'undefined') { Confluence.Templates.SelectGrid = {}; }


Confluence.Templates.SelectGrid.gridOutline = function(opt_data, opt_ignored) {
  return '<table class="select-grid aui"><thead><tr class="data-table-header"></tr></thead><tbody></tbody></table>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.gridOutline.soyTemplateName = 'Confluence.Templates.SelectGrid.gridOutline';
}


Confluence.Templates.SelectGrid.cellWithLink = function(opt_data, opt_ignored) {
  return '<td class="' + soy.$$escapeHtml(opt_data.outerClass) + '"><a class="' + soy.$$escapeHtml(opt_data.innerClass) + '" href="' + soy.$$escapeHtml(opt_data.href) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"><span>' + soy.$$escapeHtml(opt_data.text) + '</span></a></td>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.cellWithLink.soyTemplateName = 'Confluence.Templates.SelectGrid.cellWithLink';
}


Confluence.Templates.SelectGrid.cellWithoutLink = function(opt_data, opt_ignored) {
  return '<td class="' + soy.$$escapeHtml(opt_data.outerClass) + '"><span class="' + soy.$$escapeHtml(opt_data.innerClass) + '" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.text) + '</span></td>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.cellWithoutLink.soyTemplateName = 'Confluence.Templates.SelectGrid.cellWithoutLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/result-grid.js' */
define("confluence/result-grid",["ajs","jquery","confluence/control"],function(d,g,l){return l.extend({init:function(a){this.type=this.type||"ResultGrid";var c,f,k,h,j,e,i;f=a.gridContainer||g(a.baseElement).find(".data-table");f.length||d.debug("gridContainer for AJS.ResultGrid not found!");k=function(b){return b.id};c=new d.SelectGrid({gridContainer:f,columns:a.columns,selectionCallback:a.selectionCallback,getRowId:a.getRowId||k,dontShiftFocus:a.dontShiftFocus});e=a.messageHandler||d.MessageHandler({baseElement:g(a.baseElement).find(".message-panel")});
i=a.noResultMessage||"\u65e0\u7ed3\u679c\u3002";g.extend(this,{update:function(b,a){e.clearMessages();h&&(h(),j.remove(),h=null);c.clear();if(!b||!b.length){c.hide();var m=g.isFunction(i)?i(a):i;e.displayMessages(m);return!1}c.update(b);c.show();return!0},updateAndSelect:function(b,c,a){this.update(b,c)&&this.selectIndex(a)},prependAndSelect:function(b,a){!b||!b.length?d.debug("ResultGrid.prependAndSelect called with no data, returning."):(e.clearMessages(),c.prependAndSelect(b,
a),c.show())},select:function(b){c.select(b)},selectIndex:function(b){c.selectIndex(b)},clear:function(){e.clearMessages();c.hide()},loading:function(){c.show();var b=f.width(),a=f.height();this.clear();if(!h){var d,e;d=b/2-73;e=a/2-73;j=g("<div></div>").addClass("spinner-container").width(b-d).height(a-e).css({"padding-left":d,"padding-top":e}).insertAfter(f);h=Raphael.spinner(j[0],60,"#666")}},isVisible:function(){return c.isVisible()}})}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence/result-grid","AJS.ResultGrid");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:breadcrumbs-jquery', location = '/includes/js/breadcrumbs-jquery.js' */
define("confluence/breadcrumbs-jquery",["jquery","confluence/templates"],function(e,h){return function(a){var i=this,f=[],b=0,c=a.length-1,d=a[b],j=i.closest(".breadcrumbs-container").width(),g=function(){return i.width()<j};for(f.push(h.Dialog.breadcrumbItem({text:d.title,title:d.title,className:b===c?"last":""}));b++<c;)d=a[b],f.push(h.Dialog.breadcrumbItem({text:d.title,title:d.title,className:b===c?"last":""}));this.html(f.join(""));a=e("li a span",this);a.each(function(a){0!==a&&a!==c&&e(this).shortenUntil(g)});
e(a.get(0)).shortenUntil(g);e(a.get(c)).shortenUntil(g);return this}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/breadcrumbs-jquery","jQuery.fn.renderBreadcrumbs");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/js/dialog-breadcrumbs.js' */
define("confluence/dialog-breadcrumbs",["ajs","jquery","confluence/meta","confluence/templates"],function(b,d,e,k){var h={},l=function(a,e,f){var g=a.userName?a.userName:a.pageId?a.pageId+":"+a.fileName:a.spaceKey+":"+a.title+":"+a.postingDay+":"+a.fileName;g in h?e(h[g],"success"):d.ajax({type:"GET",dataType:"json",data:a,url:b.contextPath()+"/pages/breadcrumb.action",error:f||function(){},success:function(a,b){if(!a||!a.breadcrumbs)f(a,b);else{for(var c=d.makeArray(a.breadcrumbs);c[0]&&"userinfo"!==
a.type&&/peopledirectory\.action$/.test(c[0].url);)c.shift();"page"===a.type&&(c[1]&&/pages\.action/.test(c[1].url))&&c.splice(1,1);c.type=a.type;h[g]=c;e(c,b)}}})};return{getBreadcrumbsDefault:l,Breadcrumbs:function(a,h){var f=0;return{update:function(g,j){a.html(k.Dialog.breadcrumbLoading());var m=f+=1,c=function(){return m!==f?(b.debug("Breadcrumb response for ",g," is stale, ignoring."),!0):!1};(h||l)(g,function(f,h){if(!c())if("success"!==h||!f)a.html(k.Dialog.breadcrumbError());else{var i=g.spaceKey;
a.renderBreadcrumbs(f);if(!(i=i!==e.get("space-key")))a:{for(i=1;i<f.length;i++)if(f[i].title===e.get("page-title")){i=!1;break a}i=!0}i?(j.clearErrors(),d(j.moveButton).prop("disabled",!1)):(j.error("\u4f60\u4e0d\u80fd\u628a\u4e00\u4e2a\u9875\u9762\u79fb\u52a8\u5230\u81ea\u5df1\u7684\u5b50\u9875\u9762\u4e2d\u3002"),d("li:last-child",a).addClass("warning"))}},function(d){c()||(a.html(k.Dialog.breadcrumbError()),404===d.status&&j.error("\u672a\u53d1\u73b0\u6307\u5b9a\u7684\u9875\u9762\u3002"))})}}},getBreadcrumbsLegacy:function(a,e,f){if(!a.id)throw Error("id is a required parameter in 'options'");
if(!a.type)throw Error("type is a required parameter in 'options'");var g=a.id+":"+a.type;g in h?e(h[g],"success"):d.ajax({type:"GET",dataType:"json",data:a,url:b.contextPath()+b.REST.getBaseUrl()+"breadcrumb",error:f||function(){},success:function(a,b){if(!a||!a.breadcrumbs)f(a,b);else{for(var c=d.makeArray(a.breadcrumbs);c[0]&&"userinfo"!==a.type&&/peopledirectory.action$/.test(c[0].url);)c.shift();c.type=a.type;h[g]=c;e(c,b)}}})}}});
require("confluence/module-exporter").safeRequire("confluence/dialog-breadcrumbs",function(b){var d=require("ajs"),e=require("confluence/legacy");d.toInit(function(){d.MoveDialog||(d.MoveDialog={});d.MoveDialog.Breadcrumbs=b.Breadcrumbs;d.MoveDialog.getBreadcrumbs=b.getBreadcrumbsDefault;d.Breadcrumbs={};d.Breadcrumbs.getBreadcrumbs=b.getBreadcrumbsLegacy;e.Dialogs||(e.Dialogs={});e.Dialogs.Breadcrumbs=d.Breadcrumbs;e.Dialogs.Breadcrumbs.getBreadcrumbs=b.getBreadcrumbsLegacy;e.Dialogs.Breadcrumbs.Controller=
b.Breadcrumbs;e.Dialogs.Breadcrumbs.defaultGetBreadcrumbs=b.getBreadcrumbsDefault})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/soy/dialog-breadcrumbs.soy' */
// This file was automatically generated from dialog-breadcrumbs.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Dialog.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Dialog == 'undefined') { Confluence.Templates.Dialog = {}; }


Confluence.Templates.Dialog.breadcrumbItem = function(opt_data, opt_ignored) {
  return '<li><a class="' + soy.$$escapeHtml(opt_data.className) + '" title="' + soy.$$escapeHtml(opt_data.title) + '" tabindex="-1"><span>' + soy.$$escapeHtml(opt_data.text) + '</span></a></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbItem.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbItem';
}


Confluence.Templates.Dialog.breadcrumbLoading = function(opt_data, opt_ignored) {
  return '<li class="loading"><span>' + soy.$$filterNoAutoescape('\u6b63\u5728\u52a0\u8f7d\u5bfc\u822a\u9879...') + '</span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbLoading.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbLoading';
}


Confluence.Templates.Dialog.breadcrumbError = function(opt_data, opt_ignored) {
  return '<li class="warning last"><span>' + soy.$$escapeHtml('\u83b7\u53d6\u7f29\u7565\u56fe\u65f6\u53d1\u751f\u9519\u8bef\u3002') + '</span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbError.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbError';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:page-location', location = '/includes/js/page-location.js' */
define("confluence/page-location",["ajs","confluence/meta"],function(c,a){var b=null;return{get:function(){return b?b:{spaceName:a.get("space-name"),spaceKey:a.get("space-key"),parentPageTitle:a.get("parent-page-title")}},set:function(a){b=a}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/page-location","Confluence.PageLocation");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--8cfcf1af69', location = 'aui.chunk.a74d9dded03a92620c41--1fa67204f5c8e3af90cc.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--8cfcf1af69"],{iwe4:function(t,e,i){"use strict";i.r(e)},rNKm:function(t,e,i){var s,a,l;
/*! jQuery Fancy File Input plugin - v2.0.4 - 2018-11-23
* Copyright (c) 2018 Atlassian Pty Ltd; Licensed Apache-2.0 */void 0===(l=this)&&void 0!==window&&(l=window),s=[i("oDIA")],void 0===(a=function(t){return l.FancyFileInput=function(t){"use strict";var e=/^.*[\\\/]/,i=/\{0\}/gi,s=function(){var t=3,e=document.createElement("div"),i=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(i[0]);return t>4?t:document.documentMode}();function a(e,i){var s=t(e).data("FancyFileInput");if(s)return s;i=t.extend({},a.defaults,i),this.el=e,this.$el=t(e),this.$label=this.createLabel(i.buttonText),this._addLabelText(),this.$clearButton=t("<button>",{text:this.$label.attr("data-ffi-clearButtonText")||i.clearButtonText,class:"ffi-clear",type:"button",tabindex:"-1"}),this.multipleFileTextPattern=this.$label.attr("data-ffi-multipleFileTextPattern")||i.multipleFileTextPattern,this._eventNamespace=".ffi",this.CLASSES={disabled:"is-disabled",focused:"is-focused",active:"is-active",valid:"is-valid",invalid:"is-invalid"},this[this.isDisabled()?"disable":"enable"](),this.isFocused=!1}return a.defaults={buttonText:"Browse",clearButtonText:"Clear",multipleFileTextPattern:"{0} files"},a.prototype._addLabelText=function(){var e=t('label[for="'+this.el.id+'"]');e.length&&this.$el.attr("aria-label",e.text())},a.prototype.createLabel=function(e){var i=this.$el.parent(".ffi[data-ffi-button-text]");return i.length||(i=this.$el.wrap(t("<label>",{class:"ffi","data-ffi-button-text":e})).parent()),i},a.prototype.isDisabled=function(){return this.$el.is(":disabled")},a.prototype.formatMultipleFileText=function(t){return this.multipleFileTextPattern.replace(i,t)},a.prototype.bindEvents=function(){this.$el.on("invalid"+this._eventNamespace,t.proxy(this.checkValidity,this)).on("change"+this._eventNamespace,t.proxy(this.change,this)).on("keydown"+this._eventNamespace,t.proxy(this.keydown,this)).on("mousedown"+this._eventNamespace,t.proxy(this.mousedown,this)).on("mouseup"+this._eventNamespace,t.proxy(this.mouseup,this)).on("focus"+this._eventNamespace,t.proxy(this.focus,this)).on("blur"+this._eventNamespace,t.proxy(this.blur,this)),this.$clearButton.on("click"+this._eventNamespace,t.proxy(this.clear,this))},a.prototype.unbindEvents=function(){this.$el.off(this._eventNamespace),this.$clearButton.off(this._eventNamespace)},a.prototype.fireEvent=function(t){this.$el.trigger(t+this._eventNamespace)},a.prototype.enable=function(){this.bindEvents(),this.$el.prop("disabled",!1),this.$label.removeClass(this.CLASSES.disabled)},a.prototype.disable=function(){this.unbindEvents(),this.$el.prop("disabled",!0),this.$label.addClass(this.CLASSES.disabled)},a.prototype.clear=function(){return this.$el.wrap("<form>").closest("form").get(0).reset(),this.$el.unwrap(),this.el.value="",this.change(),!1},a.prototype.focus=function(){var t=this;this.$label.addClass(this.CLASSES.focused),s&&!this.isFocused&&(this.isFocused=!0,setTimeout((function(){t.$el.blur(),t.$el.focus()}),0))},a.prototype.blur=function(){s&&this.isFocused||(this.$label.removeClass(this.CLASSES.focused),this.isFocused=!1)},a.prototype.mousedown=function(){this.$label.addClass(this.CLASSES.active)},a.prototype.mouseup=function(){this.$label.removeClass(this.CLASSES.active)},a.prototype.keydown=function(t){var e=t.which,i=9;if(8!==e&&46!==e||(this.clear(),t.preventDefault()),s&&e===i){var a=this;this.isFocused=!1,this.$el.prop("disabled",!0),setTimeout((function(){a.$el.prop("disabled",!1).blur()}),0)}},a.prototype.checkValidity=function(){if(this.el.required){var t=this.$el.is(":invalid");this.$label.toggleClass(this.CLASSES.invalid,t).toggleClass(this.CLASSES.valid,!t)}},a.prototype.change=function(){var t,i="";this.checkValidity(),(t=this.el.multiple&&this.el.files.length>1?this.formatMultipleFileText(this.el.files.length):this.el.value).length?(i=t.replace(e,""),this.$clearButton.appendTo(this.$label)):this.$clearButton.detach(),this.$el.focus(),this.setFieldText(i),this.fireEvent("value-changed")},a.prototype.setFieldText=function(t){var e="data-ffi-value";t.length?(this.$label.attr(e,t),this.fireEvent("value-added")):(this.$label.removeAttr(e),this.fireEvent("value-cleared"))},t.fn.fancyFileInput=function(e){return this.each((function(){var i=new a(this,e);t(this).data("FancyFileInput",i)}))},a}(t)}.apply(e,s))||(t.exports=a)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form.file-select', location = 'aui.chunk.647b6db9cb2996fa83a0--246ac123afad62eb1860.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form.file-select"],{"7hWp":function(i,u,c){"use strict";c.r(u),c.d(u,"FancyFileInput",(function(){return a}));c("6fSn"),c("iwe4");var n=c("rNKm"),a=c.n(n).a}},[["7hWp","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--8cfcf1af69","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.d7c46c2734","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.908fe798b4","aui.splitchunk.462ee5f9ef","aui.splitchunk.26116b3cbd","aui.splitchunk.50dca3e042"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-object.js' */
define("confluence-link-browser/link-object",["jquery","ajs","confluence/legacy"],function(c,g,m){function j(a){return c.nodeName(a,"img")?a:a.hasChildNodes()&&1===a.childNodes.length&&c.nodeName(a,"a")&&c.nodeName(a.firstChild,"img")?a.firstChild:null}function k(a){return!a?"":c(a).attr("data-linked-resource-default-alias")||c(a).attr("src")}function l(a){var b={};"A"===a.nodeName&&c(a.attributes).each(function(){b[this.name]=this.value});return b}function i(a,b){for(var c=a;c&&c!=b;){if(3!=c.nodeType)return!1;
c=c.nextSibling}return 3===b.nodeType}var e={isLink:function(a){return a&&!!a.fillNode}},f=function(a){if(e.isLink(a))return a;var b={insert:function(){return m.Editor.LinkAdapter.setLink(b)},fillNode:function(a){var b=this.attrs;b.href=b.href||"#";b.href.replace(/\s+/g,"").toLowerCase().includes("javascript:")&&(b.href="#");a.attr(b);this.classes&&this.classes.length&&a.addClass(this.classes.join(" "));a.html(this.body.html);return a},getData:function(){var a={},b;for(b in this)this.hasOwnProperty(b)&&
!c.isFunction(this[b])&&(a[b]=this[b]);return a},getLinkedImage:function(){return this.body&&this.body.jquery?1===this.body.length&&this.body.is("img")&&this.body:null},getResourceId:function(){return this.attrs["data-linked-resource-id"]||""},getResourceVersion:function(){return this.attrs["data-linked-resource-version"]||""},isToConfluenceEntity:function(){return this.attrs["data-linked-resource-id"]},isToAttachmentOnSamePage:function(a){return"attachment"==this.attrs["data-linked-resource-type"]&&
this.attrs["data-linked-resource-container-id"]==a},isCustomAtlassianContentLink:function(){return this.classes&&this.classes.length?-1!=c.inArray("confluence-link",this.classes):!1},hasAnchor:function(){return this.attrs["data-anchor"]},getResourceType:function(){return this.attrs["data-linked-resource-type"]},getDefaultAlias:function(){return this.attrs["data-linked-resource-default-alias"]},getHref:function(){return this.attrs.href},getAnchor:function(){return this.attrs["data-anchor"]},getHtml:function(){return this.body.html},
getShortcut:function(){return this.attrs["data-linked-resource-shortcut"]},isHrefValid:function(){return this.attrs.href&&"http://"!=this.attrs.href},isImage:function(){return this.body.isImage},isNewLink:function(){return c.isEmptyObject(this.attrs)},isShortcutLink:function(){return"shortcut"===this.getResourceType()},isExternalLink:function(){return!this.isCustomAtlassianContentLink()},showsBreadcrumbs:function(){return!0},getTarget:function(){return this.attrs.target},setTarget:function(a){a?this.attrs.target=
a:this.removeTarget()},removeTarget:function(){this.attrs&&this.attrs.target&&delete this.attrs.target}};if(a&&a.attrs){var f={},h=null;c.each(a.attrs,function(a,b){"class"==a?h=b:f[a]=b});a.attrs=f;if(h){var d=h.split(" ");a.classes=a.classes&&a.classes.length?a.classes.concat(d):d}}c.extend(b,a);return b};e.fromData=function(a){return f(a)};e.fromNode=function(a,b){f({attrs:{},body:{html:b,text:b}});return f({attrs:l(a),body:{html:b,text:b}})};e.fromSelectedAnchor=function(a,b){var e=c(a),h=j(a),
d=!h&&i(a.firstChild,a.lastChild);return f({attrs:l(a),body:{isEditable:d,isImage:!!h,html:e.html(),imgName:k(h),text:b}})};e.fromSelection=function(a,b,c,e){var b=j(b),d;if(d=!b)if(a.collapsed)d=!0;else if(d=a.startContainer,d==a.endContainer)d=3===d.nodeType?!0:i(d.childNodes[a.startOffset],d.childNodes[a.endOffset-1]);else{var g=require("tinymce").activeEditor.dom;d=g.isBlock(a.startContainer)?a.startContainer.childNodes[a.startOffset]:a.startContainer;a=g.isBlock(a.endContainer)?a.endContainer.childNodes[a.endOffset-
1]:a.endContainer;a=d&&a&&d.parentNode==a.parentNode?{start:d,end:a}:null;d=!!a&&i(a.start,a.end)}return f({attrs:{},body:{isEditable:d,isImage:!!b,html:c,imgName:k(b),text:e}})};e.fromREST=function(a){var b=f({attrs:{"data-base-url":g.Confluence.getBaseUrl(),"data-linked-resource-id":a.id,"data-linked-resource-type":a.type,"data-linked-resource-content-type":a.contentType,href:g.REST.findLink(a.link),"data-linked-resource-default-alias":a.title},body:{html:g.escapeHtml(a.title),text:g.escapeHtml(a.title)},
classes:["confluence-link"]});"user"===a.type&&(b.attrs["data-linked-resource-type"]="userinfo");return b};e.createLinkToNewPage=function(a,b){return f({attrs:{"data-space-key":b,"data-content-title":a,href:g.contextPath()+"/pages/createpage.action?spaceKey="+b+"&title="+a},body:{html:g.escapeEntities(a),text:a},classes:["createlink","confluence-link"]})};e.makeExternalLink=function(a){return f({attrs:{href:a},body:{html:a,text:a}})};e.isExternalLink=function(a){return a&&(a.match(/^(\/\/|mailto:|file:|http:|https:)/)||
0===a.indexOf("\\"))};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-object","Confluence.Link");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-adapter.js' */
define("confluence-link-browser/link-adapter",["ajs","jquery","confluence/legacy","tinymce"],function(d,e,f,h){return{setLink:function(a){var b=d.Rte.getEditor(),b=e(b.dom.create("a"),b.getDoc());a.fillNode(b);a=h.confluence.NodeUtils.replaceSelection(b);e("#comments-section").length&&d.Rte.fixEditorFocus();return a},getLink:function(){var a,b,c;a=d.Rte.getEditor().selection;var g=a.getNode();if(c=e(g).parents().andSelf().filter("a[href]")[0])return a.select(c),b=a.getContent({format:"text"}),f.Link.fromSelectedAnchor(c,
b);c=a.getRng(!0);b=a.getContent({format:"text"});a=a.getContent();return f.Link.fromSelection(c,g,a,b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-adapter","Confluence.Editor.LinkAdapter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser.js' */
define("confluence-link-browser/link-browser",["ajs","confluence/legacy","jquery"],function(b,o,h){function r(){if(!f.prop("disabled")){f.prop("disabled",!0);b.debug("link-browser.js: submit");i.preSubmit&&i.preSubmit();var a=c.getLink();b.DarkFeatures.isEnabled(s)||a.removeTarget();n();a.insert();b.trigger("closed.link-browser")}}function n(){k.hide().remove();b.Rte.BookmarkManager.restoreBookmark()}function p(){n();b.trigger("closed.link-browser")}function t(a,f,l){var d=f.key,f=f.label,e=d+"-panel",
g=o.Templates.LinkBrowser[d+"Panel"]({atlToken:b.Meta.get("atl-token")});k.addPanel(f,g,e,e+"-id");var a=k.get("panel:"+a),j=l.tabs[d];j.panelObj=a;j.key=d;j.createPanel({baseElement:h(a[0].body)});a[0].onblur=j.onDeselect;a[0].onselect=function(){var a=!!j.hasBreadcrumbs;b.debug("Link Browser: on tab select, breadcrumbs enabled: "+a);j.onSelect();c.refresh(a);i=j};return j}var s="link.openInNewWindow",k,c,f,i;return{SEARCH_PANEL:"search",ATTACHMENTS_PANEL:"attachments",WEBLINK_PANEL:"weblink",ADVANCED_PANEL:"advanced",
open:function(a){h(function(){h('.ffi input[type="file"]#file_0').fancyFileInput()});if(h(".aui-dialog:visible").length)return null;a=a||{};b.Rte.BookmarkManager.storeBookmark();a.linkInfo=a.linkInfo||o.Editor.LinkAdapter.getLink();if(a.opener)return a.opener(a.linkInfo.alias,a.linkInfo);var q=a,a={OPEN_IN_NEW_WINDOW_DARK_FEATURE:s,tabs:{},setLink:function(u,a){c.setLink(u,a)},getLink:function(){return c.getLink()},getSelectedDataTableItem:function(){return h(".data-table:visible tr.selected")},linkValid:function(a){f.prop("disabled",
!a)},focusLinkText:function(){c.focusLinkText()||(b.debug("LinkBrowser: focusing submit button"),f.focus())},getLinkText:function(){return c.getLinkText()},isLinkTextVisible:function(){return c.isLinkTextVisible()},isNewWindowCheckboxVisible:function(){return c.isNewWindowCheckboxVisible()},hasBreadcrumbs:function(a){return c.hasBreadcrumbs(a)},getLocationPresenter:function(){return c},doSearch:function(a){this.tabs.search.doSearch(a)},getSearchTextField:function(){return this.tabs.search.getSearchTextField()},
moveLocationPanel:function(a){c.moveLocationPanel(a)},restoreLocationPanel:function(){c.restoreLocationPanel()},gotoPanel:function(a){this.popup.gotoPanel(a)},getCurrentPanel:function(){return this.popup.getCurrentPanel()},setWebLinkURL:function(a){var c=this.tabs.weblink;i!=c?b.debug("Cannot set URL "+a+" on hidden Web Link panel"):c.setURL(a)},getWebLinkUrl:function(){var a=this.tabs.weblink;return i!=a?(b.debug("Cannot get URL on hidden Web Link panel"),null):a.getURL()},getTitle:function(){return this.popup.getTitle()},
getSubmitButtonText:function(){return f.text()},isSubmitButtonEnabled:function(){return f.is(":enabled")},isVisible:function(){return this.popup.isVisible()},showOpenInNewWindowCheckbox:function(a){return c.showOpenInNewWindowCheckbox(a)},getAdvancedTextField:function(){var a=this.tabs.advanced;return i!=a?(b.debug("Cannot get link text on hidden advanced panel"),null):a.getLink()},setAdvancedTextField:function(a){var c=this.tabs.advanced;i!=c?b.debug("Cannot set link text on hidden advanced panel"):
c.setLink(a)},submit:r,cancel:p},l=q.linkInfo,d=l.isNewLink(),e,g;e=new b.ConfluenceDialog({width:840,height:590,id:"insert-link-dialog",onCancel:p,onSubmit:r});g=d?"\u63d2\u5165\u94fe\u63a5":"\u7f16\u8f91\u94fe\u63a5";d=d?"\u63d2\u5165":"\u4fdd\u5b58";e.addHeader(g);e.addButton(d,r);e.addCancel("\u53d6\u6d88",p);e.addHelpText("\u63d0\u793a: \u5728\u7f16\u8f91\u5668\u4e2d\u8f93\u5165 \u0022[\u0022\u540e\uff0c\u51fa\u73b0\u5efa\u8bae\u7684\u9875\u9762\uff0c\u7136\u540e\u63d2\u5165\u94fe\u63a5\u3002");g=h("#insert-link-dialog .dialog-tip");
g.attr("title",g.text());h("#insert-link-dialog .dialog-components .dialog-title").prepend(o.Templates.LinkBrowser.helpLink());f=e.get("button:0")[0].item;f.attr("id","link-browser-insert");f.prop("disabled",!0);k=e;a.popup=k;b.trigger("dialog-created.link-browser",[a]);c=o.Editor.LinkBrowser.LinkInfoPresenter(a);c.setLinkBody(l.body);q=q.panelKey;e=h("#link-browser-tab-items").find("div").map(function(){var a=h(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,
b){return a.weight-b.weight});var j="template"!==b.Meta.get("content-type");e=h.grep(e,function(a){return j||"attachments"!==a.key});var n;g=null;for(var d=0,v=e.length;d<v;d++){var m=t(d,e[d],a);0===d&&(n=m);!l.isNewLink()&&h.isFunction(m.handlesLink)&&m.handlesLink(l)?(g=m,m.openedLink=l):q==m.key&&(g=m)}g?a.popup.overrideLastTab():g=n;i=g;k.popup.element.find(".dialog-page-body:first").append(c.getContainer());i.panelObj.select();i.openedLink=null;k.show();b.trigger("dialog-shown.link-browser",
k);return a},cancel:p}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-browser","Confluence.Editor.LinkBrowser");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-location.js' */
define("confluence-link-browser/link-browser-location",["jquery","confluence/legacy","ajs","confluence/dialog-breadcrumbs"],function(k,B,i,s){return function(t){function m(){return i.escapeHtml(u())}function u(){return b.val()}function v(a){j.closest(".row").toggleClass("hidden",!a);e.toggleClass("has-breadcrumbs",!!a)}function w(a){var c=a.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/),a=c[2],d=c[3],f=c[5],e=c[7],c=c[9],b="";a&&(b=a.toLowerCase()+":");d&&(b+=d);b+=n(f);e&&(b+=
"?"+n(e));c&&(b+="#"+n(c));return b}function n(a){var c={"'":"%27","\\[":"%5B","\\]":"%5D","`":"%60","\\\\":"%5C"},d;for(d in c)c.hasOwnProperty(d)&&(a=a.replace(RegExp(d,"g"),c[d]));return a}function x(){return b.is(":visible")}function y(a,c){i.trigger("analyticsEvent",{name:a,data:{resourceType:c.getResourceType(),isExternal:c.isExternalLink()}})}var e,j,o,f,g,b,p,z,A,q,l,r,h;e=k(B.Templates.LinkBrowser.locationPanel());j=e.find("#breadcrumbs-container");o=s.Breadcrumbs(j,s.getBreadcrumbsLegacy);
g=e.find("#link-open-in-new-window");z=e.find(".link-image");A=e.find(".link-mixed");l=e.find("#link-image-filename");q=e.find("#link-mixed-content");p=e.find(".link-text");b=p.find("input");b.change(function(a){a.keyCode=a.keyCode||a.which;a.keyCode&&13!==a.keyCode&&b.removeClass("default-alias")});g.change(function(){g.prop("checked")?("attachment"!==f.getResourceType()&&f.setTarget("_blank"),y("editor.linkBrowser.location.openInNewWindow.checked",f)):(f.removeTarget(),y("editor.linkBrowser.location.openInNewWindow.unchecked",
f))});return{setLink:function(a,c){i.debug("Link Browser: setting link : "+a);var d=a.attrs["data-linked-resource-default-alias"]||a.getHtml();if(""===m()||b.hasClass("default-alias"))b.addClass("default-alias"),b.val(d);if(c&&a.getResourceId()&&a.getResourceType()){var e={clearErrors:function(){},error:function(){},select:function(a){o.update(a,e)}},d={id:a.getResourceId(),type:a.getResourceType()};o.update(d,e)}v(c);i.DarkFeatures.isEnabled(t.OPEN_IN_NEW_WINDOW_DARK_FEATURE)?(g.prop("checked")&&
a.setTarget("_blank"),g.prop("checked","_blank"===a.getTarget())):a.removeTarget();f=a;t.linkValid(f&&f.isHrefValid())},getLink:function(){if(!f)return null;var a=r;a||((a=m())||(a=f.getDefaultAlias()||f.getHref()),a={html:a});f.body=a;f.attrs.href=w(f.attrs.href);return f},refresh:function(a){f&&v(a)},setLinkBody:function(a){r||(a.isEditable?b.val(a.text):a.isImage?l.text(a.imgName):q.text(a.text),r=a.isEditable?null:a,p.toggleClass("hidden",!a.isEditable),z.toggleClass("hidden",!a.isImage),A.toggleClass("hidden",
a.isEditable||a.isImage))},getContainer:function(){return e},isLinkTextVisible:x,isLinkImageVisible:function(){return l.is(":visible")},isNewWindowCheckboxVisible:function(){return g.is(":visible")},isNewWindowCheckboxChecked:function(){return g.prop("checked")},isLinkMixedContentVisible:function(){return q.is(":visible")},focusLinkText:function(){return x()?(i.debug("LinkInfoPresenter.focusLinkText focusing alias"),b.select(),!0):!1},getLinkText:m,getRawLinkText:u,getLinkImageName:function(){return l.text()},
moveLocationPanel:function(a){h||(h=e.find(".row:not(.hidden) .field-group"),h.each(function(a,d){k(d).data("original-parent",k(d).parent())}));h.appendTo(a);e.hide()},restoreLocationPanel:function(){h&&h.each(function(a,c){var d=k(c);d.data("original-parent")&&(d.appendTo(d.data("original-parent")),d.removeData("original-parent"))});e.show();h=null},hasBreadcrumbs:function(a){if(!j.is(":visible"))return!1;var c=a.length,d=j.find("li");if(d.length!==c)return!1;for(var b=0;b<c;b++)if(d.eq(b).text()!==
a[b])return!1;return!0},showOpenInNewWindowCheckbox:function(a){g.closest(".row").toggleClass("hidden",!a)},encodeURLSafely:w}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-browser-location","Confluence.Editor.LinkBrowser.LinkInfoPresenter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-search.js' */
define("confluence-link-browser/link-browser-tab-search",["jquery","ajs","document","confluence/legacy","confluence/page-location"],function(d,b,n,i,o){return{dialogCreatedLinkBrowserSearch:function(n,j){var c,e,f,m,p=b.REST.getBaseUrl()+"search.json",k=function(a,b){i.Link.isLink(a)||(a=i.Link.fromREST(a));b&&c.val(a.attrs["data-linked-resource-default-alias"]);j.setLink(a,!0);j.focusLinkText()},l=function(a){b.debug("link-browser-tab-search.js: doing search");c.trigger("hide.autocomplete");var g=
d.trim(c.val());g?(f.loading(),b.getJSONWrap({url:p,data:{search:"site",query:g,spaceKey:e.val()},successCallback:function(b){d.isFunction(a)?(f.update(b.result),a()):f.updateAndSelect(b.result);c.trigger("hide.autocomplete")},messageHandler:m})):d.isFunction(a)&&a()};j.tabs.search={hasBreadcrumbs:!0,createPanel:function(a){var g=a.baseElement;c=g.find("#link-search-text");e=g.find("#search-panel-space");var h=o.get();e.find("option:eq(1)").text(h.spaceName).val(h.spaceKey);e.change(function(){c.attr("data-spacekey",
e.val());c.trigger("clearCache.autocomplete")});i.Binder.autocompleteSearch(c.parent());c.bind("selected.autocomplete-content",function(a,b){b.searchFor?l():(f.clear(),k(b.content,!1))});h=[b.SelectGrid.Column({key:"title",heading:"\u6807\u9898",getHref:function(a){return b.REST.findLink(a.link)},getInnerClass:function(a){return a.iconClass||"content-type-"+a.type}}),b.SelectGrid.Column({key:"space",heading:"\u7a7a\u95f4",getText:function(a){return a.space&&
a.space.title||""}}),b.SelectGrid.Column({key:"last-modified",heading:"\u6700\u8fd1\u4fee\u6539\u8fc7",getText:function(a){return a.lastModifiedDate&&a.lastModifiedDate.friendly||""},getTitle:function(a){return a.lastModifiedDate&&a.lastModifiedDate.date||""}})];m=b.MessageHandler({baseElement:a.baseElement.find(".message-panel")});f=new b.ResultGrid({baseElement:a.baseElement,columns:h,selectionCallback:function(a,b){k(b)},noResultMessage:"\u65e0\u641c\u7d22\u7ed3\u679c\u3002",
dontShiftFocus:function(){return d(c).add(e).is(":focus")}});g.find(".search-form").submit(function(){l();return!1}).keydown(function(a){13===a.keyCode&&!d(".aui-dropdown:visible .active",this).length&&(d("#search-panel-button").focus(),a.stopPropagation())})},onSelect:function(){b.debug("Link Browser Search panel selected");var a=this.openedLink;a?(b.debug("Link Browser Search panel setting link info"),k(a,!0)):c.focus()},handlesLink:function(a){return a.isCustomAtlassianContentLink()&&!a.hasAnchor()&&
!a.isShortcutLink()&&!a.isToAttachmentOnSamePage(b.Meta.get("content-id"))},doSearch:function(a,b){c.val(a);l(b)},isResultGridVisible:function(){return f.isVisible()},getSearchTextField:function(){return c}}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-search",function(d){require("ajs").bind("dialog-created.link-browser",d.dialogCreatedLinkBrowserSearch)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-history.js' */
define("confluence-link-browser/link-browser-tab-history",["ajs","confluence/legacy"],function(a,h){return{dialogCreatedLinkBrowserHistory:function(i,d){var e=a.REST.makeUrl("session/history.json?max-results=20"),f,g;d.tabs.recentlyviewed={createPanel:function(c){var e=[a.SelectGrid.Column({key:"title",heading:"\u6807\u9898",getHref:function(b){return a.REST.findLink(b.link)},getInnerClass:function(b){return b.iconClass||"content-type-"+b.type}}),a.SelectGrid.Column({key:"space",
heading:"\u7a7a\u95f4",getText:function(b){return b.space&&b.space.title||""}}),a.SelectGrid.Column({key:"last-modified",heading:"\u6700\u8fd1\u4fee\u6539\u8fc7",getText:function(b){return b.lastModifiedDate&&b.lastModifiedDate.friendly||""},getTitle:function(b){return b.lastModifiedDate&&b.lastModifiedDate.date||""}})];g=a.MessageHandler({baseElement:c.baseElement.find(".message-panel")});f=new a.ResultGrid({baseElement:c.baseElement,
columns:e,getRowId:function(b){return b.attachmentId},selectionCallback:function(b,a){var c=h.Link.fromREST(a);d.setLink(c);d.focusLinkText()},messageHandler:g,noResultMessage:"\u6ca1\u6709\u6700\u8fd1\u6d4f\u89c8\u8fc7\u7684\u5185\u5bb9\u3002"})},onSelect:function(){f.loading();a.getJSONWrap({url:e,messageHandler:g,successCallback:function(c){f.update(c.content);a.trigger("updated.link-browser-recently-viewed")}})}}}}});
require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-history",function(a){require("ajs").bind("dialog-created.link-browser",a.dialogCreatedLinkBrowserHistory)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-attachment.js' */
define("confluence-link-browser/link-browser-tab-attachment",["jquery","ajs","confluence/legacy"],function(h,a,j){return{dialogCreatedLinkBrowserAttachment:function(m,i){var f=a.REST.makeUrl("content/"+a.Meta.get("attachment-source-content-id")+"/attachments.json"),g,k,l,d;i.tabs.attachments={hasBreadcrumbs:!1,createPanel:function(b,c){var e=b.baseElement.find(".attach-file-form");g=h.extend({getUploaderController:function(){return j.AttachmentUploader({baseElement:e},function(){return{onUploadSuccess:function(a){for(var b=
0,c=a.length;b<c;b++)a[b].type="attachment";d.prependAndSelect(a)}}})}},c&&c(b));k=g.getUploaderController(b);l=k.getMessageHandler();var f=[a.SelectGrid.Column({key:"title",heading:"\u540d\u79f0",getHref:function(b){return b.link?a.REST.findLink(b.link):b.url},getInnerClass:function(a){return a.iconClass}}),a.SelectGrid.Column({key:"size",heading:"\u5927\u5c0f",getText:function(a){return a.niceFileSize}}),a.SelectGrid.Column({key:"comment",
heading:"\u5907\u6ce8"})];d=new a.ResultGrid({baseElement:b.baseElement,columns:f,selectionCallback:function(b,c){var d=j.Link.fromREST(c);d.attrs["data-linked-resource-container-id"]=a.Meta.get("content-id");if(h.isArray(c.link))for(var e=0,f=c.link.length;e<f;e++){var g=c.link[e];"download"===g.rel&&(d.attrs.href=g.href)}i.setLink(d);i.focusLinkText()},noResultMessage:"\u6b64\u9875\u6ca1\u6709\u4efb\u4f55\u6587\u4ef6\u3002"})},onSelect:function(){var b=this.openedLink,c=i.getLink();
d.loading();a.getJSONWrap({url:f,messageHandler:l,successCallback:function(e){d.update(e.attachment);c?"attachment"==c.getResourceType()&&d.select(c.getResourceId()):b?d.select(b.getResourceId()):e.attachment.length&&d.select(e.attachment[0].id);a.debug("Loaded attachments")}})},handlesLink:function(b){return b.isToAttachmentOnSamePage(a.Meta.get("content-id"))}}}}});
require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-attachment",function(h){var a=require("ajs");"template"!==a.Meta.get("content-type")&&a.bind("dialog-created.link-browser",h.dialogCreatedLinkBrowserAttachment)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-weblink.js' */
define("confluence-link-browser/link-browser-tab-weblink",["ajs","jquery","confluence/legacy"],function(d,k,h){return{dialogCreatedLinkBrowserWeblink:function(n,c){function e(){return k.trim(b.val())}function f(){var a=e();if(!(d.Validate.url(a)||0===a.indexOf("mailto:"))){if(d.Validate.email(a))a="mailto:"+a;else{if(l.test(a))return;a="http://"+a}d.debug("Updating Link Browser Web Link URL to: "+a);b.val(a);a=h.Link.makeExternalLink(a);c.setLink(a)}}function i(){var a=e();(a=a?h.Link.makeExternalLink(a):
null)&&c.setLink(a)}function m(){f();i()}var b,g,j,l=/[:/]/;j=c.tabs.weblink={createPanel:function(a){g=a.baseElement;b=g.find("input[name='destination']");b.keyup(function(){i()});b.change(f);b.bind("paste",function(){d.debug("Link Browser web link url pasted");setTimeout(m,0)})},onSelect:function(){d.DarkFeatures.isEnabled(c.OPEN_IN_NEW_WINDOW_DARK_FEATURE)&&c.showOpenInNewWindowCheckbox(!0);c.moveLocationPanel(g.find("form:first"));this.openedLink&&(j.setURL(this.openedLink.attrs.href),c.setLink(this.openedLink));
setTimeout(function(){b.focus()})},onDeselect:function(){c.restoreLocationPanel();c.showOpenInNewWindowCheckbox(!1)},preSubmit:f,handlesLink:function(a){return!a.isCustomAtlassianContentLink()},setURL:function(a){b.val(a);b.keyup();b.change()},getURL:e}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-weblink",function(d){require("ajs").bind("dialog-created.link-browser",d.dialogCreatedLinkBrowserWeblink)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-advanced.js' */
define("confluence-link-browser/link-browser-tab-advanced",["jquery","ajs","confluence/legacy","confluence/api/constants","confluence/meta"],function(g,e,l,m,i){return{dialogCreatedLinkBrowserAdvanced:function(p,d){var c,f,h,k,n=function(b){b=g(b);if(b.length){var a=b.find("a:first");a.length?a.hasClass("unresolved")?(b=a.attr("shortcut-key"),a=a.attr("data-space-key"),b?f.text(e.format("{0} \u662f\u4e0d\u80fd\u8bc6\u522b\u7684\u5feb\u6377\u952e",b)):a&&f.text(e.format("{0} \u662f\u65e0\u6cd5\u8bc6\u522b\u7684\u7a7a\u95f4",
a))):(b=l.Link.fromNode(a[0],c.val()),d.setLink(b)):f.text("\u65e0\u6548\u7684\u94fe\u63a5\u6807\u8bb0")}},o=function(b,a,c){e.debug("Error during conversion: textStatus = "+a+", errorThrown = "+c);f.text("\u53d1\u751f\u5185\u90e8\u670d\u52a1\u5668\u9519\u8bef")},j=d.tabs.advanced={createPanel:function(b){h=b.baseElement;c=h.find("input[name='advanced-link']");f=h.find("div[name='advanced-error']");h.find("form").keydown(function(a){13===a.keyCode&&!d.isSubmitButtonEnabled()&&a.preventDefault()});
c.keyup(function(){clearTimeout(k);f.text("");c.val()&&(k=setTimeout(function(){var a=c.val(),a=a.replace(/\[/g,"\\[").replace(/]/g,"\\]"),a={wiki:"["+a+"]",entityId:i.get("content-id"),spaceKey:i.get("space-key"),contextType:i.get("content-type")};g.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:m.CONTEXT_PATH+"/rest/tinymce/1/wikixhtmlconverter",data:g.toJSON(a),dataType:"text",success:n,error:o,timeout:1E4})},200))})},setLink:function(b){c.val(b);c.keyup();c.change()},getLink:function(){return c.val()},
onSelect:function(){e.DarkFeatures.isEnabled(d.OPEN_IN_NEW_WINDOW_DARK_FEATURE)&&d.showOpenInNewWindowCheckbox(!0);d.moveLocationPanel(h.find("form:first"));this.openedLink&&(this.openedLink.isShortcutLink()?j.setLink(this.openedLink.getShortcut()):this.openedLink.getResourceId()?j.setLink(this.openedLink.getDefaultAlias()):j.setLink("#"+this.openedLink.getAnchor()),d.setLink(this.openedLink));setTimeout(function(){c.focus()})},onDeselect:function(){d.restoreLocationPanel();d.showOpenInNewWindowCheckbox(!1)},
handlesLink:function(b){return b.isShortcutLink()||b.hasAnchor()}}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-advanced",function(g){require("ajs").bind("dialog-created.link-browser",g.dialogCreatedLinkBrowserAdvanced)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'templates/link-browser.soy' */
// This file was automatically generated from link-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.LinkBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.LinkBrowser == 'undefined') { Confluence.Templates.LinkBrowser = {}; }


Confluence.Templates.LinkBrowser.searchPanel = function(opt_data, opt_ignored) {
  return '<form class="aui search-form" onsubmit="return false;"><fieldset class="inline"><div class="search-input"><label for="link-search-text" id="linkSearch-label" class="assistive">' + soy.$$escapeHtml('\u641c\u7d22') + '</label><input id="link-search-text" type="text" tabindex="0" class="text autocomplete-search" name="linkSearch" autocomplete="off" data-search-link-message="' + soy.$$escapeHtml('\u641c\u7d22\x26lsquo;{0}\x26rsquo;') + '"></div><select tabindex="0" class="search-space select" id="search-panel-space"><option value="">' + soy.$$escapeHtml('\u5168\u90e8\u5185\u5bb9') + '</option><option value=""> </option></select><button type="submit" tabindex="0" class="aui-button" id="search-panel-button">' + soy.$$escapeHtml('\u641c\u7d22') + '</button></fieldset></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table hidden"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.searchPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.searchPanel';
}


Confluence.Templates.LinkBrowser.recentlyviewedPanel = function(opt_data, opt_ignored) {
  return '<div class="recently-viewed-panel"><div class="message-panel hidden"></div><div class="data-table"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.recentlyviewedPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.recentlyviewedPanel';
}


Confluence.Templates.LinkBrowser.attachmentsPanel = function(opt_data, opt_ignored) {
  return '<div class="attach-file-form"><form method="post" enctype="multipart/form-data" id="attachments-attachfile-form" action="' + soy.$$escapeHtml("/confluence") + '/pages/attachfile.action" class="aui"><p>' + soy.$$escapeHtml('\u94fe\u63a5\u5230\u672c\u9875\u9762\u7684\u9644\u4ef6\uff0c\u6216\u9644\u52a0\u4e00\u4e2a\u65b0\u7684\u9644\u4ef6\u3002') + '</p><div class="upload-field field-group"><label for="file_0">' + soy.$$escapeHtml('\u4e0a\u4f20\u6587\u4ef6') + '</label><label id="fancy-file-upload" class="ffi" data-ffi-button-text="Browse"><input type="file" name="file_0" id="file_0"></label><input type="hidden" name="minorEdit_0" value="true"></div><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" /></form><div class="upload-in-progress upload-field hidden">' + soy.$$escapeHtml('\u6b63\u5728\u4e0a\u4f20...') + '</div><div class="warning"><ul class="hidden message-panel"></ul></div></div><div class="message-panel hidden"></div><div id="attachments-table" class="attachment-list data-table"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.attachmentsPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.attachmentsPanel';
}


Confluence.Templates.LinkBrowser.weblinkPanel = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="field-group"><label id="destination-label" for="weblink-destination">' + soy.$$escapeHtml('\u5730\u5740') + '</label><input type="text" tabindex="0" class="text" id="weblink-destination" name="destination"><div class="web-link-desc description">' + soy.$$escapeHtml('Web\u3001email \u6216\u5176\u4ed6\u4e92\u8054\u7f51\u5730\u5740') + '</div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.weblinkPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.weblinkPanel';
}


Confluence.Templates.LinkBrowser.advancedPanel = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="advanced-desc title">' + soy.$$filterNoAutoescape(AJS.format('\u8fd9\u91cc\u60a8\u53ef\u4ee5\u4f7f\u7528 \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3ewiki\u6807\u8bb0\x3c/a\x3e \u63d2\u5165\u4e00\u4e2a\u94fe\u63a5\u5230\u9875\u9762\u4e2d\u3002',"https://docs.atlassian.com/confluence/docs-80/Links")) + '</div><div class="field-group"><label id="advanced-label" for="advanced-link">' + soy.$$escapeHtml('\u94fe\u63a5') + '</label><input type="text" tabindex="0" class="text" id="advanced-link" name="advanced-link"><div class="advanced-desc description">' + soy.$$escapeHtml('\u5728\u65b0\u9875\u9762\u4e2d\u63d2\u5165\u94fe\u63a5\uff0c\u8f93\u5165\u9875\u9762\u6807\u9898\u3002') + '<br/>' + soy.$$escapeHtml('\u63d2\u5165\u951a\u70b9\u94fe\u63a5, \u8f93\u5165 #\u951a\u70b9\u540d\u3002') + '</div><div name="advanced-error" class="advanced-error error"></div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.advancedPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.advancedPanel';
}


Confluence.Templates.LinkBrowser.locationPanel = function(opt_data, opt_ignored) {
  return '<div id="link-browser-location" class="location-info"><form class="aui"><div class="row hidden field-group"><label class="link-location-label" for="breadcrumbs-link">' + soy.$$escapeHtml('\u94fe\u63a5\u4f4d\u7f6e') + '</label><div class="breadcrumbs-container" id="breadcrumbs-link"><div class="breadcrumbs-line"><ol id="breadcrumbs-container" class="breadcrumbs"></ol></div></div></div></form><div class="row link-text"><form class="aui" onsubmit="return false;"><div class="field-group"><label for="alias" id="alias-label">' + soy.$$escapeHtml('\u94fe\u63a5\u6587\u5b57') + '</label><input type="text" tabindex="0" class="text" name="alias" id="alias"></div></form></div><div class="row link-open-in-new-window hidden"><div class="field-group"><div class="checkbox"><input type="checkbox" class="checkbox" name="open-in-new-window" tabindex="0" id="link-open-in-new-window"><label for="link-open-in-new-window" id="open-window-label">' + soy.$$escapeHtml('\u5728\u65b0\u6807\u7b7e\uff0f\u7a97\u53e3\u4e2d\u6253\u5f00') + '</label></div></div></div><div class="row link-image hidden"><div class="readonly"><label for="link-image-filename">' + soy.$$escapeHtml('\u94fe\u63a5\u56fe\u7247') + '</label><span id="link-image-filename" class="content-type-attachment-image"></span></div></div><div class="row link-mixed hidden"><div class="readonly"><label for="link-mixed-content">' + soy.$$escapeHtml('\u94fe\u63a5\u6587\u5b57') + '</label><span id="link-mixed-content"></span></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.locationPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.locationPanel';
}


Confluence.Templates.LinkBrowser.helpLink = function(opt_data, opt_ignored) {
  return '<div class="dialog-help-link"><a href="' + soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-80/Links") + '" target="_blank">' + soy.$$escapeHtml('\u5e2e\u52a9') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.helpLink.soyTemplateName = 'Confluence.Templates.LinkBrowser.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:editor-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/move-hidden-fields-hack.js' */
AJS.toInit(function(a){a("fieldset.create-content-template-fields \x3e input").appendTo("form.editor")});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:create-from-template-macro-browser-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/create-from-template-macro-fields.js' */
AJS.toInit(function(g){function k(a,b){a=a||AJS.Meta.get("space-key");Confluence.Blueprint.Dialog.requestWebItems(a,!1,function(e){var f=Confluence.Blueprint.Dialog.loadedWebitems[a];_.isEmpty(f)?AJS.log("create-from-template-macro-fields: No Create dialog web items found for spaceKey \x3e"+a+"\x3c"):b(e,f)},function(){AJS.error("create-from-template-macro-fields: requestWebItems call for spaceKey \x3e"+a+"\x3c failed")})}function h(a,b){k(b,function(e,f){e=a.val();a.empty();_.each(f,function(c){var d=
c.itemModuleCompleteKey;"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blank-page"!==d&&"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blog-post"!==d&&(c.templateId||c.contentBlueprintId)&&(d=g("\x3coption\x3e\x3c/option\x3e").text(c.name),d.attr("data-template-id",c.templateId),d.attr("data-blueprint-module-complete-key",c.blueprintModuleCompleteKey),d.attr("data-content-blueprint-id",c.contentBlueprintId),d.attr("data-create-result",c.createResult),
d.val(c.templateId||c.contentBlueprintId),a.append(d))});a.val(e)})}AJS.MacroBrowser.setMacroJsOverride("create-from-template",{fields:{spacekey:{spaceKey:function(a){var b=AJS.MacroBrowser.ParameterFields.spacekey(a),e=b.input.val();a=function(){var f=b.input.val();f!=e&&h(AJS.MacroBrowser.fields.templateName.input,f);e=f};b.input.bind("selected.autocomplete-content",a);b.input.blur(a);return b}}},beforeParamsSet:function(a,b){a.buttonLabel=a.buttonLabel||a.createButtonLabel||"\u4ece\u6a21\u677f\u521b\u5efa";
h(g("#macro-param-templateName"),a.spaceKey);return a},beforeParamsRetrieved:function(a,b,e){b=AJS.MacroBrowser.fields.templateName.input.find("option:selected");a.blueprintModuleCompleteKey=b.data("blueprint-module-complete-key");a.contentBlueprintId=b.data("content-blueprint-id");a.templateId=b.data("template-id");a.createResult=b.data("create-result");return a}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:soy-resources', location = 'soy/image-attributes-panel.soy' */
// This file was automatically generated from image-attributes-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.ImageAttributes.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.ImageAttributes == 'undefined') { Confluence.Templates.Editor.ImageAttributes = {}; }


Confluence.Templates.Editor.ImageAttributes.content = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="field-group"><label for="image-title-attribute">' + soy.$$escapeHtml('\u6807\u9898\u6587\u672c') + '</label><input class="text" type="text" id="image-title-attribute" name="image-title-attribute" value="' + ((opt_data.imgTitle) ? soy.$$escapeHtml(opt_data.imgTitle) : '') + '"><div class="description">' + soy.$$escapeHtml('\u6863\u5149\u6807\u5728\u56fe\u50cf\u4e0a\u60ac\u505c\u65f6\u663e\u793a') + '</div></div><div class="field-group"><label for="image-alt-attribute">' + soy.$$escapeHtml('\u66ff\u4ee3\u6587\u672c') + '</label><input class="text" type="text" id="image-alt-attribute" name="image-alt-attribute" value="' + ((opt_data.imgAlt) ? soy.$$escapeHtml(opt_data.imgAlt) : '') + '"><div class="description">' + soy.$$escapeHtml('\u5f53\u56fe\u50cf\u65e0\u6cd5\u663e\u793a\u65f6\u7531\u5c4f\u5e55\u9605\u8bfb\u5668\u4f7f\u7528') + '</div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.ImageAttributes.content.soyTemplateName = 'Confluence.Templates.Editor.ImageAttributes.content';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:image-attributes', location = 'js/image-attributes-panel.js' */
define("confluence-image-attributes/image-attributes-panel",["jquery","ajs","confluence/legacy"],function(f,h,g){return function(){function k(){var a=c.val();d.attr({"data-element-title":a,title:l(d.attr("data-location"),a),alt:e.val()})}function m(){c.val()===e.val()&&(c.bind("input.chained",function(a){e.val(c.val())}),e.on("change",function(){c.unbind("input.chained")}))}function l(a,b){return a&&0<a.length&&b&&0<b.length?a+" ("+b+")":a&&0<a.length?a:b&&0<b.length?"("+b+")":""}h.bind("dialog-created.image-properties",
function(a,b){d=f(b.img);a=f(g.Templates.Editor.ImageAttributes.content({imgTitle:d.attr("data-element-title"),imgAlt:d.attr("alt")}));c=a.find("#image-title-attribute");e=a.find("#image-alt-attribute");m();g.Editor.ImageProps.registerPanel(n,a,p,k)});var n="image-attributes",p="image-attributes-panel",d,c,e}});require("confluence/module-exporter").safeRequire("confluence-image-attributes/image-attributes-panel",function(f){require("ajs").toInit(f)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/imagedialog/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",["tinymce","confluence/legacy"],function(a,b){return{init:function(a){a.on("init",function(){a.addCommand("mceConfimage",b.Editor.defaultInsertImageDialog)})},getInfo:function(){return{longname:"Confluence Image Dialog",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",function(a){var b=require("tinymce");b.create("tinymce.plugins.ConfluenceImageDialog",a);b.PluginManager.add("confluenceimagedialog",b.plugins.ConfluenceImageDialog)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'utils/tinymce-image-utils.js' */
define("confluence-editor/utils/tinymce-image-utils","jquery confluence/api/logger confluence/meta ajs tinymce confluence/api/constants".split(" "),function(d,m,n,j,o,r){var p=["imagetext","src","align","border","width","height"],s=/\/download\/(thumbnails|attachments)\/([0-9]+)\//,q=function(a,b,f,c,e){if(c){a.width=b>=e?e:b;a.style.maxWidth=""}else{a.height=f>=e?e:f;a.style.maxHeight=""}},k;k={isScaledByWidth:function(){return false},updateImageElement:function(a,b){var f=d(a),c;c=b.destination;
c=k.isRemoteImg(c)?c:b.thumbnail?c.replace("/attachments/","/thumbnails/"):c.replace("/thumbnails/","/attachments/");b.src=c;f.toggleClass("confluence-content-image-border",!!b.border);f.toggleClass("confluence-thumbnail",!!b.thumbnail);c=0;for(var e=p.length;c<e;c++){var h=p[c],g=b[h];g!==false&&g!=null?f.attr(h,g):f.removeAttr(h)}o.activeEditor.undoManager.add()},insertFromProperties:function(a,b){d.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:r.CONTEXT_PATH+"/rest/tinymce/1/embed/placeholder/image",
data:d.toJSON(a),dataType:"text",success:function(a){k.insertImagePlaceholder(a,b)}})},insertImagePlaceholder:function(a,b){var f,c=k.isScaledByWidth(),e=d(a);f=c?j.Confluence.PropertyPanel.Image.getPresetImageSize("large"):n.get("content-type")==="comment"?j.Confluence.PropertyPanel.Image.getPresetImageSize("small"):j.Confluence.PropertyPanel.Image.getPresetImageSize("medium");e.css(c?"max-width":"max-height",f+"px");var h=o.activeEditor,g="_"+ +new Date,i=d("<div></div>").append(e.attr("id",g));
h.selection.setContent(i.html());var l=h.dom.get(g);h.dom.setAttrib(l,"id","");if(!e.hasClass("confluence-external-resource")){g=e.attr("data-image-width");i=e.attr("data-image-height");if(g===void 0&&i===void 0){g=e.attr("width");i=e.attr("height")}q(l,g,i,c,f);this.updateThumbnailAttribute(l)}d(l).one("load",function(){e.hasClass("confluence-external-resource")&&q(this,this.width,this.height,c,f);j.Rte.showSelection(function(){b||j.trigger("trigger.property-panel",{elem:l});h.undoManager.add()});
h.fire("Change")})},updateThumbnailAttribute:function(a){var b=a.width,f=a.height;if(b||f){var c=d(a),e=c.attr("data-image-width"),h=c.attr("data-image-height"),g=n.get("max-thumb-width"),i=n.get("max-thumb-height"),a=!this.isRemoteImg(a.src)&&this.isThumbnailUsable(b,f,e,h,g,i);c.attr("thumbnail",a);c.toggleClass("confluence-thumbnail",a)}},isRemoteImg:function(a){var b=j.Rte.getCurrentBaseUrl();return a.match("(https?://)")&&a.indexOf(b)===-1},isThumbnailUsable:function(a,b,f,c,e,d){if(a){if(a>
e)return false;if(f===void 0&&c===void 0)return true;e=f/c;return e>=1?true:e*d>=a}a=b;if(a>d)return false;if(f===void 0&&c===void 0)return true;d=c/f;return d>=1?true:d*e>=a}};return{ImageProperties:function(a){if(a&&d.nodeName(a,"img")&&d(a).hasClass("confluence-embedded-image")){var b=d(a),a={destination:b.attr("src"),url:b.attr("src"),border:b.attr("class")&&b.attr("class").indexOf("confluence-content-image-border")!==-1?1:0,width:b.prop("width"),height:b.prop("height"),originalSelected:!b.attr("width")&&
!b.attr("height")};if(!k.isRemoteImg(a.destination)&&!d(b).hasClass("confluence-external-resource")){var f=a;var b=d(b).attr("src"),c=b.match(s);if(c&&c.length===3)b=c[2];else{m.log("ERROR: could not parse page id from image url "+b);b="0"}f.pageId=b}return d.extend({},a)}if(a.destination){a.imageFileName=a.imageFileName||a.destination;return d.extend({},a)}return null},ImageUtils:k}});
require("confluence/module-exporter").safeRequire("confluence-editor/utils/tinymce-image-utils",function(d){var m=require("tinymce");m.confluence.ImageProperties=d.ImageProperties;m.confluence.ImageUtils=d.ImageUtils});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-links.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links",["ajs","jquery","confluence/legacy","tinymce","window"],function(a,e,i,j,k){var h=0;return{name:"link",canHandleElement:function(a){return a.is("a")&&"#"!=a.attr("href")&&!a.hasClass("unresolved")},handle:function(f){var c=f.containerEl,g=f.ed,b=function(c){return a.Rte.getEditor().translate(c)},f={anchorIframe:a.Rte.getEditorFrame()},d=0===(c.getAttribute("href")||"").indexOf("#"),b=[{className:"link-property-panel-goto-button",
text:b("propertypanel.links_goto"),tooltip:d?b("propertypanel.links_goto_disabled_tooltip"):c.href,href:c.href,disabled:d,click:function(){a.Confluence.PropertyPanel.destroy();var b=k.open(c.href,j.isIE?"_blank":"confluence-goto-link-"+a.params.pageId+"-"+h);b.focus();b.opener=null}},{className:"link-property-panel-edit-button",text:b("propertypanel.links_edit"),tooltip:b("propertypanel.links_edit_tooltip"),disabled:e(c).hasClass("createlink")||!c.href,click:function(){a.Confluence.PropertyPanel.destroy();
g.selection.select(c);i.Editor.LinkBrowser.open()}},{className:"link-property-panel-unlink-button",text:b("propertypanel.links_unlink"),tooltip:b("propertypanel.links_unlink_tooltip"),click:function(){a.Confluence.PropertyPanel.destroy();g.execCommand("mceConfUnlink",!1,c);g.focus()}}],d=[];a.trigger("link-property-panel-buttons.created",{buttons:d,link:c});b=b.concat(d);a.Confluence.PropertyPanel.createFromButtonModel(this.name,c,b,f);h++}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links","AJS.Confluence.PropertyPanel.Link",function(a){var e=require("ajs");e.bind("init.rte",function(){e.trigger("add-handler.property-panel",a)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-macros.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","ajs tinymce jquery confluence/legacy document confluence/macro-js-overrides underscore".split(" "),function(b,m,d,s,n,t,u){var o=[],p=[],l={},k="__PROPERTY_PANEL_SPACER",v=[{key:k}];return{name:"macro",registeredEvents:o,canHandleElement:function(a){return a.hasClass("editor-inline-macro")||a.hasClass("wysiwyg-macro")},handle:function(a){function i(){var c="macro-placeholder-property-panel-remove-button";e.length>
0&&e[e.length-1].key==k&&(c=c+" first");h.push({className:c,text:"\u5220\u9664",click:function(){b.Confluence.PropertyPanel.destroy();b.Rte.getEditor().execCommand("mceConfRemoveMacro",j)}});if(g.attr("data-macro-parameters")){var a=s.MacroParameterSerializer.deserialize(g.attr("data-macro-parameters"));if("atlassian-macro-output-type"in a){c=function(c){return function(b){a["atlassian-macro-output-type"]=c;g.attr("data-macro-parameters",s.MacroParameterSerializer.serialize(a));
c=="INLINE"?d(".macro-placeholder-property-panel-display-newline-button").removeClass("active"):d(".macro-placeholder-property-panel-display-inline-button").removeClass("active");d(b).addClass("active")}};h.push(null);h.push({className:"macro-placeholder-property-panel-display-newline-button",tooltip:"\u5728\u65b0\u884c\u663e\u793a",selected:a["atlassian-macro-output-type"]=="BLOCK",click:c("BLOCK")});h.push({className:"macro-placeholder-property-panel-display-inline-button",
tooltip:"\u663e\u793a\u5185\u8054",selected:a["atlassian-macro-output-type"]=="INLINE",click:c("INLINE")})}}d.each(o,function(){(!this.macroName||this.macroName==f)&&d(n).bind(q(this.id,this.macroName),this.handler)});c=p;f&&l[f]&&(c=c.concat(l[f]));d.each(c,function(){try{this(j,h,w)}catch(c){b.debug("Property panel init handler failed for : "+f+".  Is global handler : "+(d.inArray(this,p)>-1),c)}});if(h.length>0){var c=b.Confluence.PropertyPanel.createFromButtonModel("macro",
j,h,w),x=t.getFunction(f,"propertyPanelIFrameInjector");x&&x(c)}}if(!(a.e.type!=="click"&&a.e.type!=="mouseup")){var j=a.containerEl,g=d(j),f,e=[],a=!g.hasClass("editor-inline-macro"),y=!g.hasClass("wysiwyg-unknown-macro"),h=[],w={originalHeight:a&&g.height(),anchorIframe:b.Rte.getEditorFrame()},q=function(c,a){return c+"-button-click"+(a?a+".macro":"")+".property-panel"};if(y){var r=d.Deferred();f=g.attr("data-macro-name");if(b.MacroBrowser.getMacroMetadata(f))e=b.MacroBrowser.getMacroMetadata(f).buttons;
(a=t.getFunction(f,"getControls"))?a(function(a){var b=e,a=u.filter(a,function(a){return a.type==="button"}),a=u.map(a,function(a){return{key:a.key,label:a.name.value}});e=b.concat(v).concat(a).concat(v);r.resolve()}):r.resolve();r.done(function(){var a="macro-placeholder-property-panel-edit-button";e.length>0&&e[0].key==k&&(a=a+" last");h.push({className:a,text:"\u7f16\u8f91",click:function(){b.Confluence.PropertyPanel.destroy();m.confluence.macrobrowser.editMacro(g)}});
d.each(e,function(a,c){if(c.key!=k){var i="macro-property-panel-"+c.key;a>0&&e[a-1].key==k&&(i=i+" first");a<e.length-1&&e[a+1].key==k&&(i=i+" last");h.push({className:i,text:c.label,parameterName:c.key,click:function(){d(n).trigger(q(c.key),g);d(n).trigger(q(c.key,f),g);b.Confluence.PropertyPanel.destroy()}})}})}).then(i())}else i()}},registerButtonHandler:function(a,b,d){Array.isArray(a)||(a=[a]);a.forEach(function(a){o.push({id:a,handler:b,macroName:d})})},registerInitHandler:function(a,b){if(b){l[b]=
l[b]||[];l[b].push(a)}else p.push(a)},yieldButtonFor:function(a,b){var j;d.each(a,function(){this.parameterName&&this.parameterName==b&&(j=this)});return j}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","AJS.Confluence.PropertyPanel.Macro",function(b){var m=require("ajs");m.bind("init.rte",function(){m.trigger("add-handler.property-panel",b)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-images.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","jquery ajs tinymce confluence-editor/utils/tinymce-image-utils confluence/meta confluence/legacy confluence/api/browser confluence/property-panel".split(" "),function(f,g,s,F,v,w,G,h){function x(){var a=[];f.each(t,function(b,c){a.push(c)});h.current.panel.find(a.join(", ")).removeClass("active")}function p(a,b,c){var e=y(a,b),c=y(a,c),j=e||c;if(j){var d=h.getAnchor(),i=d.width(),d=d.height(),f=v.get("max-thumb-width"),
g=v.get("max-thumb-height");a.thumbnail=k.isRemoteImg(a.destination)?false:k.isThumbnailUsable(e,c,i,d,f,g);a.originalSelected=false;if(b){delete a.height;a.width=j}else{delete a.width;a.height=j}m(a);x();return true}return false}function z(a,b){if(u?p(a,n[b]):p(a,null,n[b])){A(b);m(a);return true}return false}function B(a){delete a.width;delete a.height;a.thumbnail=false;a.originalSelected=true;x();A("original");var b=h,c=b.getAnchor();b.current.updating=true;c.one("load",function(){l(b);q(a);a.width=
Math.floor(c.width());a.height=Math.floor(c.height())});k.updateImageElement(c,a);s.isGecko&&g.Rte.getEditor().execCommand("mceRepaint",false);c.each(function(){this.complete&&f(this).trigger("load")});return true}function A(a){h.current.panel.find(t[a]).addClass("active")}function C(a){f(".image-border-toggle").toggleClass("active",!a.border);a.border=+!a.border||false;m(a)}function m(a){var b=h,c=b.getAnchor(),e=c.attr("src"),f=c.height();b.current.updating=true;k.updateImageElement(c,a);s.isGecko&&
g.Rte.getEditor().execCommand("mceRepaint",false);if(a.src!=e){var d=setInterval(function(){var a=c.height();if(a!=f){g.debug("updateImageElement : height changed after image src change - "+f+" to "+a);clearTimeout(d);d=null;l(b)}},10);setTimeout(function(){if(d){clearTimeout(d);d=null;l(b)}},1E3)}else l(b);q(a)}function q(a){a=a.width?a.width:h.getAnchor().width();a=Math.floor(a);f("#image-size-input").val(a+"px")}function y(a,b){b=parseInt(b);if(!isNaN(b)){b<D?b=D:b>E&&(b=E);return b}return null}
var k=F.ImageUtils,u=k.isScaledByWidth(),n;n=u?{small:100,medium:300,large:500}:{small:150,medium:250,large:400};var t={small:".image-size-small",medium:".image-size-medium",large:".image-size-large",original:".image-size-original"},D=16,E=9E4,l=function(a){a.current.updating=false;a.current.snapToElement({animate:true,animateDuration:100})};return{_resizeImage:p,pluginButtons:[],name:"image",getPresetImageSize:function(a){return n[a]},canHandleElement:function(a){return a.is("img")&&!a.hasClass("editor-inline-macro")&&
!a.hasClass("template-variable")},handle:function(a){function b(){p(e,f("#image-size-input").val())?true:q(e);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.custom"})}var c;c=a.nodeName==="IMG"?a:a.containerEl;var a=f(c),e=s.confluence.ImageProperties(c);if(e&&!a.attr("data-resource-id")){var j=g.Rte.getEditor(),d=function(a){return j.translate(a)},i=function(a){return{className:["image-size-"+a,"editor-resize","resize-"+a].join(" "),text:d("propertypanel.images_"+a),tooltip:d("propertypanel.images_"+
a+"_tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:function(){z(e,a);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize."+a})},selected:u?e.width==n[a]:e.height==n[a]}},i=[{className:"editable",tooltip:d("propertypanel.images_sizing_tooltip"),html:'<input id="image-size-input"/>'},null,i("small"),i("medium"),i("large"),{className:"image-size-original",text:d("propertypanel.images_original"),tooltip:d("propertypanel.images_original_tooltip"),click:function(){B(e);
g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.original"})},selected:e.originalSelected},null,{className:"image-border-toggle",text:d("propertypanel.images_border"),tooltip:d("propertypanel.images_border_tooltip"),click:function(){C(e)},selected:e.border||e.border==1}];i.push(null);var k=a.parent();if(k.is("a[href]")){i.push({className:"image-link-edit",text:d("propertypanel.images_link_edit"),tooltip:d("propertypanel.images_link_edit_tooltip"),click:function(){h.destroy();j.selection.select(k[0]);
w.Editor.LinkBrowser.open()}});i.push({className:"image-link-remove",text:d("propertypanel.images_link_remove"),tooltip:d("propertypanel.images_link_remove_tooltip"),click:function(){h.destroy();j.execCommand("mceConfUnlink",false,c);j.focus()}})}else i.push({className:"image-make-link",text:d("propertypanel.images_link_create"),tooltip:d("propertypanel.images_link_create_tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-link",click:function(){h.destroy();j.selection.select(c);w.Editor.LinkBrowser.open()}});
for(var l=h.Image.pluginButtons,r=0;r<l.length;r++)if(l[r]===null)i.push(null);else{var m=l[r].create(a);m&&i.push(m)}h.createFromButtonModel(this.name,c,i,{anchorIframe:g.Rte.getEditorFrame()});a=f("#image-size-input");a.bind("focus",function(){f(this).select()});a.bind("change",function(){b()});(new G(window.navigator.userAgent)).isIE()&&a.bind("keyup",function(a){a.keyCode===13&&b()});h.current.imageProps=e;q(e);var o=e;return{setPresetSize:function(a){z(o,a)},setPixelSize:function(a){p(o,a)},
setToOriginalSize:function(){B(o)},toggleBorder:function(){C(o)},getWidth:function(){return o.width},getHeight:function(){return o.height},getDisplayWidth:function(){return f("#image-size-input").val()},isButtonSelected:function(a){return h.current.panel.find(t[a]).hasClass("active")}}}}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","AJS.Confluence.PropertyPanel.Image",function(f){var g=require("ajs");g.bind("init.rte",function(){g.trigger("add-handler.property-panel",f)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/imageproperties/js/image-properties-dialog.js' */
define("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog",["jquery","ajs"],function(d,a){function l(){h||(h=d("#image-properties-tab-items > div").map(function(){var a=d(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,b){return a.weight-b.weight}));return h}function m(){var a=c.popup.element,b=650/60,e=d('<div class="image-properties-loading-blanket"><div class="loading-data"></div></div>').appendTo(a.find(".dialog-page-body")),
f=e.find(".loading-data");e.css({width:e.parent().width(),height:a.height()});f.css({marginTop:-60,marginLeft:-60});f.spin({color:"#666",width:b,radius:25,length:25,top:0,left:0,zIndex:0,speed:1.042});var a=[],g;for(g in i)b=i[g],(b=b.saveFn&&b.saveFn())&&b.done&&a.push(b);d.when.apply(d,a).done(function(){var a=c.popup.element.find(".image-properties-loading-blanket .loading-data");a.css({marginTop:"",marginLeft:""});a.spinStop();a.closest(".image-properties-loading-blanket").remove();c.hide().remove()})}
function o(){c.hide().remove()}var c,h,i={},n;return{init:function(){n||(h=null,0<l().length&&(n=!0,a.Confluence.PropertyPanel.Image.pluginButtons.push(null,{create:function(){return{className:"image-properties",text:"\u5c5e\u6027",tooltip:"\u8bbe\u7f6e\u989d\u5916\u7684\u56fe\u50cf\u5c5e\u6027",click:function(h,b){a.trigger("analyticsEvent",{name:"confluence.editor.image-properties-trigger"});a.Confluence.PropertyPanel.destroy();d("#image-properties-dialog").remove();c=new a.ConfluenceDialog({id:"image-properties-dialog",
onSubmit:m});a.trigger("dialog-created.image-properties",{img:b});c.popup.element.attr("data-tab-default","0");c.addHeader("\u56fe\u50cf\u5c5e\u6027");c.addSubmit("\u4fdd\u5b58",m);c.addCancel("\u53d6\u6d88",o);for(var e=c,f=l(),g=0;g<f.length;g++){var j=f[g],k=i[j.key];k&&e.addPanel(j.label,k.content,k.panelClass,j.key)}1===f.length&&e.popup.element.find(".dialog-page-menu").show();a.trigger("dialog-before-show.image-properties");
c.show()}}}})))},registerPanel:function(a,b,c,d){i[a]={content:b,panelClass:c,saveFn:d}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog","Confluence.Editor.ImageProps",function(d){var a=require("ajs");a.toInit(d.init);a.bind("quickedit.success",d.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-manager.js' */
define("confluence-templates/variable-manager",["confluence/api/event","jquery"],function(f,g){function i(c,a){var b=c.toLocaleLowerCase(),d=a.toLocaleLowerCase(),b=b.localeCompare(d);0==b&&(b=c.localCompare(a));return b}function h(c){return g.extend(!0,{},e.defaults[c]||e.defaults.string)}var e=function(){var c={};return{find:function(a){var a=a.toLocaleLowerCase(),b={},d;for(d in c)if(c.hasOwnProperty(d)&&(!a.length||0===d.toLocaleLowerCase().indexOf(a)))b[d]=c[d];return b},contains:function(a){return!!c[a]},
get:function(a){return c[a]},getAll:function(){return g.extend(!0,{},c)},getSortedNames:function(){var a=[],b;for(b in c)a.push(b);return a.sort(i)},add:function(a,b){c[a]=b||h();f.trigger("add.confluence-variable",{name:a,details:g.extend(!0,{},b)})},del:function(a){var b=c[a];delete c[a];f.trigger("delete.confluence-variable",{name:a,details:g.extend(!0,{},b)})},rename:function(a,b){var d=c[a];delete c[a];d&&(c[b]=d,f.trigger("rename.confluence-variable",{oldName:a,newName:b,details:g.extend(!0,
{},details)}))},createDefault:h}};e.defaultVariableManager=e();e.defaults={textarea:{type:"textarea",rows:5,columns:100},list:{type:"list",options:[]},string:{type:"string"}};return e});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-manager",function(f){require("confluence/legacy").VariableManager=f});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-placeholder.js' */
define("confluence-templates/variable-placeholder",["ajs","jquery"],function(a,d){return{component:{insertPlaceholder:function(c,e){var b;b="$"+c;var f=a.Rte.getEditor();a.Rte.BookmarkManager.storeBookmark();b={title:b,src:a.Meta.get("context-path")+"/plugins/servlet/confluence/placeholder/template-variable?name="+encodeURIComponent(c),"data-variable-name":c,"class":"template-variable",alt:"$"+c};e&&d.extend(b,e);b=d("<img/>").attr(b);f.selection.setNode(b[0])}},init:function(){d(a.Rte.getEditor().getBody()).delegate("img.template-variable",
"dragstart",function(a){a.preventDefault()})}}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-placeholder",function(a){require("confluence/legacy").VariablePlaceHolder=a.component;require("ajs").bind("init.rte",a.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-toolbar.js' */
define("confluence-templates/variable-toolbar",["ajs","document","confluence/api/event","jquery","confluence/legacy"],function(e,k,h,f,c){return{init:function(){h.bind("init.rte",function(){var g=c.VariableManager.defaultVariableManager,a=f("#template-menu"),i=a.find(".variables-list");h.bind("add.confluence-variable,delete.confluence-variable,rename.confluence-variable",function(){var b=g.getSortedNames(),j=b.length,d="";i.toggleClass("hidden",!j);for(var a=0;a<j;a++)d+=c.Templates.Variables.renderVariableItem({variableName:"$"+
b[a],tooltip:e.format("\u5728\u9875\u9762\u4e2d\u63d2\u5165\u201c{0}\u201d\u5b57\u6bb5\uff0c\u4f9b\u6a21\u677f\u7528\u6237\u586b\u5199\u3002",b[a])});i.html(d)});a.delegate(".variables-list a","click",function(){var b=f(this).attr("data-variable-name");!g.contains(b)&&g.add(b);c.VariablePlaceHolder.insertPlaceholder(b)});a.delegate(".variables-add","click",function(b){var a=c.Editor.Autocompleter.Manager.getInputDrivenDropdown();e.Rte.getEditor().focus();(!a||a.inactive)&&c.Editor.Autocompleter.Manager.shortcutFired("$",!0);b.stopPropagation()});f(k).bind("showLayer",
function(b,c,d){"dropdown"===c&&d.$.closest(a).length&&d.reset()})})}}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-toolbar",function(e){e.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/autocomplete-settings-variables.js' */
define("confluence-templates/autocomplete-settings-variables",["confluence/legacy","ajs"],function(d,c){return function(){function e(a,b){return{callback:function(c){c.replaceWithSelectedSearchText();!f.contains(a)&&f.add(a);d.VariablePlaceHolder.insertPlaceholder(a,b)},name:c.escapeHtml(a),href:"#"}}function i(a,b){return!a&&!b?0:!a?-1:!b?1:a.toLocaleLowerCase().localeCompare(b.toLocaleLowerCase())}var f=d.VariableManager.defaultVariableManager;return{ch:"$",cache:!1,endChars:[],dropDownDelay:0,
preventStartNodes:"",dropDownClassName:"autocomplete-variables",selectFirstItem:!0,getHeaderText:function(a,b){return b?"\u53d8\u91cf\u5efa\u8bae":"\u53d8\u91cf\u5efa\u8bae"},getAdditionalLinks:function(a,b){var e=d.unescapeEntities(b);return f.get(e)||0===b.length?[]:[{className:"dropdown-create-variable",href:"#",callback:function(a){var b=a.plainText();a.replaceWithSelectedSearchText();!f.contains(b)&&f.add(b);d.VariablePlaceHolder.insertPlaceholder(b,
void 0)},name:c.format("\u521b\u5efa\u53d8\u91cf \u0027\u0027{0}\u0027\u0027",b)}]},getDataAndRunCallback:function(a,b,c){var g,k,a=d.unescapeEntities(b),j=f.find(a),h=[],l=[];for(g in j)j.hasOwnProperty(g)&&h.push(g);h.sort(i);a=0;for(k=h.length;a<k;a++)g=h[a],l.push(e(g,j[g]));c([l],b)},update:function(){}}}});
require("confluence/module-exporter").safeRequire("confluence-templates/autocomplete-settings-variables",function(d){var c=require("ajs"),e=require("confluence/legacy"),i=require("confluence/meta");c.bind("init.rte",function(){var c=require("tinymce");"template"===i.get("content-type")&&(e.Editor.Autocompleter||(e.Editor.Autocompleter=c.confluence.Autocompleter),e.Editor.Autocompleter.Settings.$=d())})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/property-panel-variables.js' */
define("confluence-templates/property-panel-variables",["ajs","jquery","confluence/legacy"],function(b,a,h){return{name:"variable",canHandleElement:function(a){return a.hasClass("template-variable")},handle:function(f){function l(d){b.debug("clicked type: "+d);var c=a("#property-panel");c.find(".panel-buttons").toggleClass("no-inputs","string"===d);c.find(".textarea-section,.list-section,.string-section").addClass("hidden");c.find("."+d+"-section").removeClass("hidden");"textarea"===d?(a("#variable-property-panel-textarea-rows").val(e.rows),
a("#variable-property-panel-textarea-columns").val(e.columns)):"list"===d&&a("#variable-property-panel-list-values").val(e.options.join(","))}function i(d,b,c){return{className:"variable-property-panel-type-item variable-property-panel-type-"+d,text:b,tooltip:c,selected:m===d,click:function(){e.type=d;e=j.createDefault(d);j.add(k,e);a(".variable-property-panel-type-item").removeClass("selected");a(".variable-property-panel-type-"+d).addClass("selected");l(d)}}}function g(a){return m===a?"":" hidden"}
if(!("click"!==f.e.type&&"mouseup"!==f.e.type)){var f=f.containerEl,n=a(f),k,c=[],o={originalHeight:n.height(),anchorIframe:b.Rte.getEditorFrame()};k=n.attr("data-variable-name");var j=h.VariableManager.defaultVariableManager,e=j.get(k),m=e&&e.type||"string";c.push(i("string","\u6587\u672c","\u5355\u884c\u6587\u672c\u8f93\u5165\u6846\u3002"));c.push(i("textarea","\u591a\u884c\u6587\u672c","\u591a\u884c\u6587\u672c\u8f93\u5165\u6846\u3002"));
c.push(i("list","\u5217\u8868","\u4e0b\u62c9\u5217\u8868\u3002"));c.push(null);c.push({className:"editable textarea-section"+g("textarea"),tooltip:"\u5b57\u6bb5\u7684\u884c\u6570\u3002",html:'<input id="variable-property-panel-textarea-rows"/>'});c.push({className:"variable-property-panel-textarea-split textarea-section"+g("textarea"),tooltip:"",html:"<span>x</span>"});c.push({className:"editable textarea-section"+
g("textarea"),tooltip:"\u5b57\u6bb5\u7684\u5217\u6570\u3002",html:'<input id="variable-property-panel-textarea-columns"/>'});c.push(null);c.push({className:"editable list-section"+g("list"),tooltip:"\u8f93\u5165\u5217\u8868\u7684\u6bcf\u4e00\u4e2a\u9879\uff0c\u7528\u9017\u53f7\u5206\u9694\u3002",html:"<input id=\"variable-property-panel-list-values\" size='50'/>"});b.Confluence.PropertyPanel.createFromButtonModel("variable",f,c,o);l(e.type);a("#variable-property-panel-textarea-rows").change(function(){e.rows=
+a(this).val()||h.VariableManager.defaults.textarea.rows});a("#variable-property-panel-textarea-columns").change(function(){e.columns=+a(this).val()||h.VariableManager.defaults.textarea.columns});a("#variable-property-panel-list-values").change(function(){var d,b,c,f=a(this).val().split(",");e.options=[];d=0;for(b=f.length;d<b;d++)(c=a.trim(f[d]))&&e.options.push(c)});a("#variable-property-panel-textarea-rows,#variable-property-panel-textarea-columns,#variable-property-panel-list-values").keypress(function(b){13===
b.which&&a(this).blur()})}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-templates/property-panel-variables","AJS.Confluence.PropertyPanel.Variable",function(b){var a=require("ajs");a.bind("init.rte",function(){a.trigger("add-handler.property-panel",b)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-marshaller.js' */
define("confluence-templates/variable-marshaller",["ajs","jquery","confluence/legacy"],function(d,b,p){function q(c){var a=c.attr("data-variable-type");return"textarea"===a?{type:a,rows:+c.attr("data-variable-rows")||i,columns:+c.attr("data-variable-columns")||r}:"list"===a?{type:a,options:c.find("li").map(function(){return b(this).attr("data-variable-option")}).toArray()}:{type:"string"}}function m(){var c=b(d.Rte.getEditor().getBody()).find("img[data-variable-name]"),a={};b.map(c,function(c){var f=
{};b(c).attr("data-variable-raw-xhtml")&&(f={"data-variable-raw-xhtml":!0});a[b(c).attr("data-variable-name")]=f});return a}var i=5,r=100;return function(){function c(a){for(var b in a)a.hasOwnProperty(b)&&!f.contains(b)&&(d.debug("adding: ",b),f.add(b,a[b]))}var a=d.Rte.getEditor(),i=b(a.getBody()),f=p.VariableManager.defaultVariableManager;a.on("GetContent",function(a){var d=b("<div></div>"),i=b("<ul></ul>").attr("data-variable-declarations","true"),e;d.append(i);var n=m();c(n);var o=f.getAll(),
l;for(l in o)if(n.hasOwnProperty(l)){var j=l;e=o[l];var g=void 0,k=void 0,g=e.type,h=b("<li></li>");h.attr("data-variable-name",j);h.attr("data-variable-type",g);h.text(j);if("textarea"===g)h.attr("data-variable-rows",e.rows),h.attr("data-variable-columns",e.columns);else if("list"===g){g=b("<ul></ul>");j=void 0;for(j in e.options)k=e.options[j],k=b("<li></li>").text(k).attr("data-variable-option",k),g.append(k);h.append(g)}e=h;i.append(e)}a.content=d.html()+a.content});a=i.find("ul[data-variable-declarations]");
a.remove();a.find("li[data-variable-name]").each(function(){var a=b(this);f.add(a.attr("data-variable-name"),q(a))});c(m())}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-marshaller",function(d){require("ajs").bind("init.rte",d)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-template-resources', location = 'js/variable-templates.soy' */
// This file was automatically generated from variable-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Variables.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Variables == 'undefined') { Confluence.Templates.Variables = {}; }


Confluence.Templates.Variables.renderVariableItem = function(opt_data, opt_ignored) {
  return '<li class="dropdown-item" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltip) + '"><a href="#" class="item-link variable-item" title="' + soy.$$escapeHtml(opt_data.variableName) + '" data-variable-name="' + soy.$$escapeHtml(opt_data.variableName) + '">' + soy.$$escapeHtml(opt_data.variableName) + '</a></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Variables.renderVariableItem.soyTemplateName = 'Confluence.Templates.Variables.renderVariableItem';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = 'templates/mentions.soy' */
// This file was automatically generated from mentions.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Mentions.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Mentions == 'undefined') { Confluence.Templates.Mentions = {}; }


Confluence.Templates.Mentions.userNotFoundResult = function(opt_data, opt_ignored) {
  return '<div class="mention-error no-result">' + soy.$$escapeHtml('\u62b1\u6b49\uff0c\u6211\u4eec\u65e0\u6cd5\u627e\u5230\u8fd9\u4e2a\u4eba') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.userNotFoundResult.soyTemplateName = 'Confluence.Templates.Mentions.userNotFoundResult';
}


Confluence.Templates.Mentions.searchFailureResult = function(opt_data, opt_ignored) {
  return '<div class="mention-error search-failure"><div class="search-failure-title">' + soy.$$escapeHtml('\u51fa\u73b0\u9519\u8bef') + '</div><div class="search-failure-body">' + soy.$$escapeHtml('\u6211\u4eec\u73b0\u5728\u65e0\u6cd5\u83b7\u53d6\u4eba\u5458\u4fe1\u606f\u3002 \u51e0\u5206\u949f\u540e\u518d\u8bd5\u3002') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.searchFailureResult.soyTemplateName = 'Confluence.Templates.Mentions.searchFailureResult';
}


Confluence.Templates.Mentions.loadingPlaceholder = function(opt_data, opt_ignored) {
  return '<div class="mention-loading"><div class="avatar-placeholder"></div><div class="text-container"><div class="text-placeholder lg"></div><div class="text-placeholder sm"></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.loadingPlaceholder.soyTemplateName = 'Confluence.Templates.Mentions.loadingPlaceholder';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = '/js-target/bundle.js' */
define("confluence-mentions", ["ajs","confluence/meta","jquery","confluence/legacy","confluence/templates","confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager","tinymce","confluence/storage-manager","confluence/dark-features","confluence/analytics-support","confluence-link-browser/link-object","confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings"], function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_11__, __WEBPACK_EXTERNAL_MODULE_16__, __WEBPACK_EXTERNAL_MODULE_18__, __WEBPACK_EXTERNAL_MODULE_19__, __WEBPACK_EXTERNAL_MODULE_37__, __WEBPACK_EXTERNAL_MODULE_45__, __WEBPACK_EXTERNAL_MODULE_51__, __WEBPACK_EXTERNAL_MODULE_52__, __WEBPACK_EXTERNAL_MODULE_53__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 20);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_0__;

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    'use strict';

    exports.default = {
        CURRENT: 'current',
        RELATED: 'related',
        RECENT: 'recent',
        SERVER: 'server'
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_2__;

/***/ }),
/* 3 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_3__;

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(29), __webpack_require__(37), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _lruCache, _storageManager, _userSupplierKeys) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var LRU = _interopRequireDefault(_lruCache).default;

    var StorageManager = _interopRequireDefault(_storageManager).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Returns users from a localstorage-backed LRU (least-recently-used) cache, and adds entries to that cache.
     */
    var inMemoryCache = void 0;
    var persistentCache = void 0;

    var CACHE_PREFIX = 'mentions';
    var CACHE_ID = 'recently-mentioned-users';
    var CACHE_ITEMS_KEY = 'items';

    /**
     * The maximum number of recently-mentioned users to keep in the cache.
     * @type {number}
     */
    var RECENT_USER_LIMIT = 20;
    /**
     * WaterTightValidation means that any users at or past this expiry _must_ be refreshed before being displayed in the UI.
     * @type {{expireTimeMillis: number}}
     */
    var WATERTIGHT_VALIDATION = { expireTimeMillis: 29 * 24 * 60 * 60 * 1000 }; //29 days in millis
    /**
     * EarlyValidation means that any users at or past this expiry _should_ be refreshed after the UI is completed (so as to not block users)
     * @type {{expireTimeMillis: number}}
     */
    var EARLY_VALIDATION = { expireTimeMillis: 7 * 24 * 60 * 60 * 1000 }; //7 days in millis
    /**
     * stores the enums used for calls to {getStaleUsers()}.
     * @type {{WATERTIGHT_VALIDATION: {expireTimeMillis: number}, EARLY_VALIDATION: {expireTimeMillis: number}}}
     */
    var ValidationType = { WATERTIGHT_VALIDATION: WATERTIGHT_VALIDATION, EARLY_VALIDATION: EARLY_VALIDATION };

    // Lazy-initialise to avoid interacting with localStorage when it isn't required.
    function loadCache() {
        inMemoryCache = LRU(RECENT_USER_LIMIT);
        persistentCache = new StorageManager(CACHE_PREFIX, CACHE_ID);

        var recentUsersDump = persistentCache.getItem(CACHE_ITEMS_KEY);
        if (recentUsersDump) {
            var recentUsersJson = JSON.parse(recentUsersDump);
            inMemoryCache.load(recentUsersJson);
        }
    }

    function getUsers() {
        return new Promise(function (resolve) {
            inMemoryCache || loadCache();

            // Add users with order of most-recently-mentioned first
            var users = [];
            var index = 0;
            inMemoryCache.forEach(function (user) {
                user.supplier = UserSupplier.RECENT;
                user.role = null;
                user.sortIndex = index++;
                users.push(user);
            });
            AJS.debug('Found ' + users.length + ' recently-mentioned users');
            resolve(users);
        });
    }

    /**
     * Store a recently-mentioned User in the cache.
     * @param user
     * @param refreshed {Boolean} true if the user is from the server. This will update the timestamp of the last refresh to now().
     *                            Defaults to false if not passed in.
     */
    function store(user, refreshed) {
        inMemoryCache || loadCache();
        var oldUser = inMemoryCache.peek(user.username);
        var oldRefreshDate = oldUser ? oldUser.refreshedAt || 0 : 0;
        var refreshedAt = refreshed || !oldUser ? new Date().getTime() : oldRefreshDate;
        inMemoryCache.set(user.username, Object.assign({}, user.model ? user.model : user, { timestamp: user.timestamp, refreshedAt: refreshedAt }));
        persistentCache.setItemQuietly(CACHE_ITEMS_KEY, JSON.stringify(inMemoryCache.dump()));
    }

    function remove(username) {
        inMemoryCache || loadCache();
        inMemoryCache.del(username);
        persistentCache.setItemQuietly(CACHE_ITEMS_KEY, JSON.stringify(inMemoryCache.dump()));
    }

    /**
     * A stale user is one which has not been refreshed from the server for X days or more, X being calculated from the validation type.
     * @param validationType {{expireTimeMillis: number}} an enum to flag what kind of stale users to return. Use a value from ValidationType
     * @return {Array} a list of stale usersnames (NOTE: not the user objects - just the usernames)
     */
    function getStaleUsers(validationType) {
        inMemoryCache || loadCache();
        var stale = [];
        var now = new Date().getTime();
        //use a hack to iterate the keys to prevent the LRU from changing the ordering
        var existingKeys = inMemoryCache.keys();
        existingKeys.map(function (k) {
            return [inMemoryCache.peek(k), k];
        }).forEach(function (entry) {
            var val = entry[0];
            var key = entry[1];
            if (!val.refreshedAt || now - val.refreshedAt > validationType.expireTimeMillis) {
                stale.push(key);
            }
        });
        return stale;
    }

    function refresh(users) {
        inMemoryCache || loadCache();
        users.forEach(function (user) {
            if (inMemoryCache.has(user.username)) {
                var entry = inMemoryCache.peek(user.username);
                var timestamp = entry.timestamp || 0;
                //treat no timestamp as though it is stale, and refresh it
                if (!user.timestamp || !timestamp || user.timestamp > timestamp) {
                    store(user, true);
                }
            }
        });
    }

    // Used in tests
    function _clear() {
        loadCache();
    }

    exports.default = {
        getUsers: getUsers,
        store: store,
        remove: remove,
        getStaleUsers: getStaleUsers,
        refresh: refresh,
        _clear: _clear,
        RECENT_USER_LIMIT: RECENT_USER_LIMIT,
        ValidationType: ValidationType
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(6), __webpack_require__(4), __webpack_require__(10), __webpack_require__(41), __webpack_require__(13)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _relatedUsersSupplier, _recentUsersSupplier, _serverUsersSupplier, _currentUserSupplier, _userCache) {
    'use strict';

    var RelatedUsersSupplier = _interopRequireDefault(_relatedUsersSupplier).default;

    var RecentUsersSupplier = _interopRequireDefault(_recentUsersSupplier).default;

    var ServerUsersSupplier = _interopRequireDefault(_serverUsersSupplier).default;

    var CurrentUserSupplier = _interopRequireDefault(_currentUserSupplier).default;

    var UserCache = _interopRequireDefault(_userCache).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var _slicedToArray = function () {
        function sliceIterator(arr, i) {
            var _arr = [];
            var _n = true;
            var _d = false;
            var _e = undefined;

            try {
                for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
                    _arr.push(_s.value);

                    if (i && _arr.length === i) break;
                }
            } catch (err) {
                _d = true;
                _e = err;
            } finally {
                try {
                    if (!_n && _i["return"]) _i["return"]();
                } finally {
                    if (_d) throw _e;
                }
            }

            return _arr;
        }

        return function (arr, i) {
            if (Array.isArray(arr)) {
                return arr;
            } else if (Symbol.iterator in Object(arr)) {
                return sliceIterator(arr, i);
            } else {
                throw new TypeError("Invalid attempt to destructure non-iterable instance");
            }
        };
    }();

    "use strict";

    /**
     *
     * @param {string}   query              User's query
     * @param {object}   editor             the currently-active editor
     */
    function search(query, editor) {

        var serverUsersPromise = ServerUsersSupplier.getUsers(query);
        var relatedUsersPromise = RelatedUsersSupplier.getUsers(editor);
        var recentUsersPromise = RecentUsersSupplier.getUsers();
        var currentUserPromise = CurrentUserSupplier.getCurrentUser();

        var fastPromises = [relatedUsersPromise, recentUsersPromise, currentUserPromise];

        return {
            client: Promise.all(fastPromises).then(function (_ref) {
                var _ref2 = _slicedToArray(_ref, 3),
                    relatedUsers = _ref2[0],
                    recentUsers = _ref2[1],
                    currentUser = _ref2[2];

                UserCache.addAll(relatedUsers);
                UserCache.addAll(recentUsers, true);
                if (currentUser) {
                    // May be undefined if anonymous.
                    UserCache.add(currentUser, true);
                }
            }),
            server: serverUsersPromise.then(function (serverUsers) {
                UserCache.addAll(serverUsers);
                RecentUsersSupplier.refresh(serverUsers);
            })
        };
    }

    function prefetchSuppliers(editor) {
        var waterTightValidationCheck = RecentUsersSupplier.getStaleUsers(RecentUsersSupplier.ValidationType.WATERTIGHT_VALIDATION);
        if (waterTightValidationCheck.length > 0) {
            //found some users whose stale for longer than 30 days. Must revalidate and delete if needed, before showing in UI.
            deleteStaleUsers(waterTightValidationCheck, RecentUsersSupplier.ValidationType.WATERTIGHT_VALIDATION);
        }
        // This will load related users into the cache in 'service/content-users/users-related-to-content'.
        RelatedUsersSupplier.getUsers(editor);
    }

    function deleteStaleUsers(usersToCheck, validationType) {
        ServerUsersSupplier._searchWithUsernames(usersToCheck).then(function (resultUsers) {
            RecentUsersSupplier.refresh(resultUsers);
            //if users are still stale after a refresh, it means they've not been returned by the server
            //time to delete 'em
            var usersToDelete = RecentUsersSupplier.getStaleUsers(validationType);
            usersToDelete.forEach(function (u) {
                return RecentUsersSupplier.remove(u);
            });
        });
    }

    // Reset any of the suppliers that hold state. Used in testing.
    function reset() {
        RelatedUsersSupplier.reset();
        ServerUsersSupplier.reset();
        RecentUsersSupplier._clear();
    }

    exports.default = {
        search: search,
        prefetchSuppliers: prefetchSuppliers,
        deleteStaleUsers: deleteStaleUsers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(24), __webpack_require__(25)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _draftContentSupplier, _usersRelatedToContent) {
    'use strict';

    var getDraft = _interopRequireDefault(_draftContentSupplier).default;

    var UsersRelatedToContent = _interopRequireDefault(_usersRelatedToContent).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     Returns users related to the Content currently in the Editor, optionally filtered by a search string.
    
     You can test this logic in your browser console against a running instance by running something like :
    
     `require('confluence-mentions').userSuppliers.contentRelated.getUsers().then((result) => { window.relatedUsers = result; });`
    
     and then viewing the `window.relatedUsers` value.
     */
    function getUsers(editor) {
        var content = getDraft(editor);
        return UsersRelatedToContent.getUsers(content);
    }

    /*
     We assume that all useful information is returned in the getUsersRelatedTo call.
     */
    function isExhausted() {
        return true;
    }

    // Clears the related user cache, used in testing.
    function reset() {
        UsersRelatedToContent.reset();
    }

    exports.default = {
        getUsers: getUsers,
        isExhausted: isExhausted,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(8)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _i18n) {
    'use strict';

    var I18n = _interopRequireDefault(_i18n).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var newRole = function newRole(role) {
        return {
            role: role,
            i18n: I18n('user.role.' + role)
        };
    }; /**
        A simple User Role bean that can provide its i18n'd display name.
        */
    exports.default = {
        CREATOR: newRole('creator'),
        CONTRIBUTOR: newRole('contributor'),
        COMMENTER: newRole('commenter'),
        ANCESTOR_COMMENTER: newRole('ancestorCommenter') // never shown, but available
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var i18nMap = {
        'user.role.creator': "\u521b\u5efa\u8005",
        'user.role.contributor': "\u8d21\u732e\u8005",
        'user.role.commenter': "\u8bc4\u8bba\u5458",
        'user.supplier.recent': "\u6700\u8fd1\u7684"
    }; /**
        A way to get the i18nTransformer away from all-the-JS, this module allows clients to get I18n text using
        dynamic keys. Normally the i18nTransformer would fail to handle this and the developer would be forced to add
       
        AJS.format("foo100")
       
        entries for each case. By extracting those invocations of AJS.I18n.getText to a single place, we can plan for a future
        where the transformer is not necessary and we can serve one set of JS resources for all locales.
       
        A future improvement might be to generate an i18n.js file directly from a plugin's
        i18n.properties file at build time.
        */

    exports.default = function (key) {
        // TODO - could interpolate args, etc. dT
        return i18nMap[key];
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 9 */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),
/* 10 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(11), __webpack_require__(2), __webpack_require__(3), __webpack_require__(12), __webpack_require__(39), __webpack_require__(1), __webpack_require__(40)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _legacy, _meta, _jquery, _userRanker, _serverUserCache, _userSupplierKeys, _luceneQuery) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Confluence = _interopRequireDefault(_legacy).default;

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    var UserRanker = _interopRequireDefault(_userRanker).default;

    var Cache = _interopRequireDefault(_serverUserCache).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    var LuceneQuery = _interopRequireDefault(_luceneQuery).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Wait this long after REST call triggers before actually doing a search - results in fewer HTTP requests.
     */
    var DEBOUNCE_WAIT_MS = 250;

    // 1 char query is now supported by CQL.
    var MIN_CHARS_TO_SEARCH = 1;

    var limit = 100;
    var cache = Cache(limit);

    /**
     * The id of the last timeout to be created for a REST call. We cancel this timeout if
     * a scheduled call becomes stale.
     */
    var lastTimeout = void 0;

    /**
     Returns users from the backend via a CQL search.
     */
    function getUsers(query) {
        return new Promise(function (resolve, reject) {

            if (!query || query.length < MIN_CHARS_TO_SEARCH) {
                // No query - no server results.
                return resolve([]);
            }

            AJS.debug('server-users-supplier: Looking in cache for ' + query);
            var cacheEntry = cache.getClosest(query);
            if (cacheEntry) {
                AJS.debug('server-users-supplier: Found cache entry with query ' + cacheEntry.query);
                if (cacheEntry.query === query) {
                    // Exact match - just serve these results.
                    return resolve(cacheEntry.users);
                }

                // Not an exact match. Might need a REST call, but we can show results based on what we have cached.
                var rankedUsers = UserRanker(cacheEntry.users, query);
                cache.add(query, rankedUsers);

                // TODO Always resolve with what we have from the cache - this is information that can be put in front of
                // the user immediately. We then decide whether to follow up the local results with remote ones.
                // However, we need the ability to 'resolve' multiple times - to call the render once with the cached
                // results and again (if not debounced, stale, etc, etc) with the server results.
                if (cacheEntry.isExhausted) {
                    return resolve(rankedUsers);
                }

                // Else we might be searching for "John" but "Joh" already has >={limit} users.
                // We need to hit the server!
                // TODO - can we resolve multiple times?
            }

            var contextPath = Meta.get('context-path');
            var escapedQuery = LuceneQuery.escape(query);
            var queryParameters = {
                cql: 'user ~ "' + Confluence.unescapeEntities(escapedQuery) + '"',
                start: 0,
                limit: limit
            };
            var url = contextPath + '/rest/api/search';
            var success = function success(response) {
                var results = response.results;
                var users = results.map(function (result) {
                    var user = result.user;
                    user.supplier = UserSupplier.SERVER;
                    user.timestamp = result.timestamp;
                    AJS.debug('server-users-supplier: Adding user to cache: ' + user.username);
                    return user;
                });
                cache.add(query, users);
                resolve(users);
            };

            // Debounce
            clearTimeout(lastTimeout);
            lastTimeout = setTimeout(function () {
                $.getJSON(url, queryParameters, success).fail(reject);
            }, DEBOUNCE_WAIT_MS);
        });
    }

    /**
     * Forces a search for exact usernames. Use this to ensure the cached entries in
     * other suppliers are not stale.
     * @param usernames {Array} Array of username strings
     * @returns {Promise} a promise which will resolve with an array of user objects from the search that matched any of the input usernames.
     * @private
     */
    function _searchWithUsernames(usernames) {
        return new Promise(function (resolve, reject) {
            if (!usernames || usernames.length === 0) {
                return resolve([]);
            }
            var contextPath = Meta.get('context-path');
            var queryParameters = {
                cql: 'user in (' + usernames.map(function (u) {
                    return '"' + u + '"';
                }).join(",") + ')',
                start: 0,
                limit: usernames.length
            };
            AJS.debug('querying with \'' + queryParameters.cql + '\'');
            var url = contextPath + '/rest/api/search';
            var success = function success(response) {
                var results = response.results;
                var users = results.map(function (result) {
                    var user = result.user;
                    user.supplier = UserSupplier.SERVER;
                    user.timestamp = result.timestamp;
                    return user;
                });
                resolve(users);
            };

            // Debounce
            clearTimeout(lastTimeout);
            lastTimeout = setTimeout(function () {
                $.getJSON(url, queryParameters, success).fail(reject);
            }, DEBOUNCE_WAIT_MS);
        });
    }

    /**
     If a given search returns less that the specified limit, we say that that query is exhausted - adding more
     characters to the query will return a subset of users from the shorter query.
     */
    function isExhausted(query) {
        return true;
    }

    // Flushes the cache between tests.
    function reset() {
        cache.reset();
        AJS.debug('server-users-supplier: Cache reset');
    }

    exports.default = {
        getUsers: getUsers,
        _searchWithUsernames: _searchWithUsernames,
        isExhausted: isExhausted,
        reset: reset,
        DEBOUNCE_WAIT_MS: DEBOUNCE_WAIT_MS
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 11 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_11__;

/***/ }),
/* 12 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(11), __webpack_require__(38)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _legacy, _fuse) {
    'use strict';

    var Confluence = _interopRequireDefault(_legacy).default;

    var Fuse = _interopRequireDefault(_fuse).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Details for these options are available at http://fusejs.io/, but the basic gist is:
     *
     * - tokenize is required so that first and last names are searched from their first character
     * - matchAllTokens so that tokenize will match all words in the query
     * - threshold close to 0 to avoid unhelpful results, but this can be tweaked because...
     * - shouldSort will put the best matches at the top of the result array.
     * - location means that matching should start at the beginning of words, which is usually
     *     what name searches will want
     */
    /**
     * Ranks users, given a query.
     */
    var options = {
        includeMatches: true,
        includeScore: true,
        tokenize: true,
        matchAllTokens: true,
        threshold: 0.1,
        location: 0,
        distance: 0,
        maxPatternLength: 16,
        minMatchCharLength: 1,
        keys: [{
            name: 'displayName',
            weight: 0.7
        }, {
            name: 'username',
            weight: 0.3
        }]
    };

    exports.default = function (users, query) {
        if (!query) {
            return users;
        }

        // TODO Depending on what kind of setup is done in the Fuse constructor, we might want to
        // optimise by keeping an instance around that has all of the users currently-known to the
        // frontend: including cached Server search results.
        var fuse = new Fuse(users, options);
        var results = fuse.search(Confluence.unescapeEntities(query));
        return results.map(function (result) {
            var item = result.item;
            item.fuseMatches = result.matches;
            item.fuseScore = result.score;
            return item;
        });
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 13 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    /**
     * Where all the aggregation and caching happens
     */
    "use strict";

    function _toConsumableArray(arr) {
        if (Array.isArray(arr)) {
            for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {
                arr2[i] = arr[i];
            }

            return arr2;
        } else {
            return Array.from(arr);
        }
    }

    var userCache = new Map();

    /**
     * Updates the incoming User object to split "displayName" into "firstName" and "lastNames" to aid Fuse matching.
     * @param user
     * @private
     */
    function _splitNames(user) {
        if (!user || !user.displayName) {
            return;
        }

        // We store first and last names separately to enable search weightings in Fuse.
        // JS String.split doesn't quite do what we need so we just use a substring.
        var firstSpace = user.displayName.indexOf(' ');
        if (firstSpace > 0) {
            user.firstName = user.displayName.substring(0, firstSpace);
            user.lastNames = user.displayName.substring(firstSpace + 1);
        } else {
            // A user display name in a language without spaces. Setting the firstName should work in most cases.
            user.firstName = user.displayName;
            user.lastNames = '';
        }
    }

    function _isStaleEntry(user) {
        if (!userCache.has(user.username)) {
            return true;
        }
        var entry = userCache.get(user.username);
        var timestamp = entry.timestamp || 0;
        return user.timestamp > timestamp;
    }

    exports.default = {
        /**
         * Will add the user to the user cache, if it's not already present.
         * @param {user}    user     A single user in API format
         * @param {boolean} force    if true, any cached user with the same username will be replaced with this user
         */
        add: function add(user) {
            var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

            // Existing cache entries may have a different Supplier for a given user - don't overwrite.
            if (user && user.hasOwnProperty("username") && (force === true || _isStaleEntry(user))) {
                _splitNames(user);
                userCache.set(user.username, user);
            }
        },

        /**
         * Will add all the supplied users by individually calling add
         * @param users an array of users
         */
        addAll: function addAll(users, force) {
            var _this = this;

            users.forEach(function (user) {
                _this.add(user, force);
            });
        },

        /**
         * @returns an array of all the users in the cache
         */
        getAll: function getAll() {
            return [].concat(_toConsumableArray(userCache.values()));
        },

        /**
         * Used for testing
         * @private
         */
        _get: function _get(username) {
            return userCache.get(username);
        },

        /**
         * Used for testing
         * @private
         */
        _clear: function _clear() {
            userCache.clear();
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 14 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(5), __webpack_require__(13), __webpack_require__(42), __webpack_require__(49), __webpack_require__(17)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _userSupplierManager, _userCache, _pipelines, _executor, _scoreBooster) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var userSupplierManager = _interopRequireDefault(_userSupplierManager).default;

    var UserCache = _interopRequireDefault(_userCache).default;

    var Pipelines = _interopRequireDefault(_pipelines).default;

    var PipelineExecutor = _interopRequireDefault(_executor).default;

    var ScoreBooster = _interopRequireDefault(_scoreBooster).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * The maximum number of Users that will be displayed in the Mentions dropdown.
     */
    var DISPLAY_LIMIT = 5;
    var NON_BREAKING_SPACE = String.fromCharCode(160);

    // The last query to be triggered, used when server responses return out of order and we need to skip the render of
    // stale responses.
    var latestQuery = void 0;

    /**
     *
     * @param {string}   query              User's query
     * @param {function} renderCallback     Callback function to render the results
     * @param {function} selectedUser       (optional) the currently-selected user in the dropdown
     * @param {object} editor               the currently-active editor
     */
    function searchAndRender(query, renderCallback, selectedUser, editor) {
        // Trim the query but don't convert to lowercase just yet - the ranker should handle this. (i.e. upper case
        // letters could be weighted higher in matches).
        // Note that 160 is the non-breaking-space character and is not handled by trim().
        // It IS handled by $.trim(str) but noooooo, noooooo.
        query = query.replace(NON_BREAKING_SPACE, ' ').trim();
        latestQuery = query;

        var promises = userSupplierManager.search(query, editor);

        promises.client.then(function () {
            resolveClientUsers();
            // Guarantee that server results are handled after local ones - chain the promises!
            promises.server.then(resolveServerUsers, renderErrorOnReject);
        }, renderErrorOnReject);

        function resolveClientUsers() {
            renderPipeline(UserCache.getAll(), query, renderCallback, selectedUser, false);
        }

        function resolveServerUsers() {
            // We could in future wrap the renderCallback so that if the server render would have the same values as the
            // client render, we skip it and avoid a browser repaint.
            renderPipeline(UserCache.getAll(), query, renderCallback, selectedUser, true);
        }

        function renderErrorOnReject() {
            var iterator = new PipelineExecutor(Pipelines.error(renderCallback));
            iterator.execute([]);
        }
    }

    function renderPipeline(users, query, renderCallback, selectedUser, isServerCall) {
        var context = {
            query: query,
            latestQuery: latestQuery,
            selectedUser: selectedUser,
            isServerCall: isServerCall,
            DISPLAY_LIMIT: DISPLAY_LIMIT
        };

        var pipeline = void 0;
        if (!query) {
            pipeline = Pipelines.default(renderCallback);
        } else {
            pipeline = isServerCall ? Pipelines.server(renderCallback) : Pipelines.client(renderCallback);
        }

        var executor = new PipelineExecutor(pipeline, context);
        executor.execute(users);
    }

    // Called during testing to clear caches.
    function reset() {
        userSupplierManager.reset();
        UserCache._clear();
        ScoreBooster.reset();
    }

    exports.default = {
        searchAndRender: searchAndRender,
        prefetchSuppliers: userSupplierManager.prefetchSuppliers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 15 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    exports.default = {
        resultWithHtml: function resultWithHtml(html) {
            return {
                html: html
            };
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 16 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_16__;

/***/ }),
/* 17 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userSupplierKeys) {
    'use strict';

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var suggestedUsers = [];

    /**
     * When searching for a user you're likely to want a user you've recently mentioned, even if other Fuse matches have
     * slightly better (lower) scores. For now we boost all recent matches, but we could adjust this to only the recent match
     * with the best score.
     *
     * Also, contributors should bubble to the top in the search results, at least until the search token is compelling enough
     * to switch.
     */
    function boostScores(users, next, context) {
        var query = context && context.query || '';
        if (query.indexOf(' ') > 0) {
            // Don't boost on supplier once multiple names are being added - the user seems to know who they're after so
            // let Fuse do its job.
            return next(users);
        }

        // The pipeline could be ensuring that users passed down the pipe are immutable, but for now just clone. fuseScore
        // should NOT be making its way into the user cache.
        var boostedUsers = users.map(function (userIn) {
            var user = Object.assign({}, userIn);
            if (suggestedUsers.includes(user.username)) {
                user.fuseScore /= 1000; // keep ordering for multiple matched suggestions
            } else if (typeof user.fuseScore === 'number') {
                switch (user.supplier) {
                    case UserSupplier.RECENT:
                        user.fuseScore /= 5;
                        break;
                    case UserSupplier.RELATED:
                        user.fuseScore /= 10;
                        break;
                }
            }
            return user;
        });
        return next(boostedUsers);
    }

    function setSuggestedUsers(users, next) {
        suggestedUsers = users.map(function (user) {
            return user.username;
        });
        return next(users);
    }

    function reset() {
        suggestedUsers = [];
    }

    exports.default = {
        boostScores: boostScores,
        setSuggestedUsers: setSuggestedUsers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 18 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_18__;

/***/ }),
/* 19 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_19__;

/***/ }),
/* 20 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(21);


/***/ }),
/* 21 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(22), __webpack_require__(6), __webpack_require__(4), __webpack_require__(10), __webpack_require__(19)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _editorPluginInit, _relatedUsersSupplier, _recentUsersSupplier, _serverUsersSupplier, _tinymce) {
    'use strict';

    var editorPluginInit = _interopRequireDefault(_editorPluginInit).default;

    var RelatedUsersSupplier = _interopRequireDefault(_relatedUsersSupplier).default;

    var RecentUsersSupplier = _interopRequireDefault(_recentUsersSupplier).default;

    var ServerUsersSupplier = _interopRequireDefault(_serverUsersSupplier).default;

    var tinymce = _interopRequireDefault(_tinymce).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    function init(e, context) {
        var editor = context && context.editor; // in case the initCallback internal code breaks API

        tinymce.create('tinymce.plugins.InsertMentions', {
            init: editorPluginInit(editor),

            getInfo: function getInfo() {
                return {
                    longname: 'Insert Mentions',
                    author: 'Atlassian',
                    authorurl: 'http://www.atlassian.com',
                    version: tinymce.majorVersion + "." + tinymce.minorVersion
                };
            }
        });

        tinymce.PluginManager.add('insertmentions', tinymce.plugins.InsertMentions);
    }

    /**
     * This is the main export from the Mentions module set.
     */
    exports.default = {
        init: init,
        userSuppliers: {
            // Users from localstorage
            recent: RecentUsersSupplier,
            // Users from the server
            serverSearch: ServerUsersSupplier,
            // Users from the front-end cache of the Content in the editor
            contentRelated: RelatedUsersSupplier
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 22 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(3), __webpack_require__(23), __webpack_require__(14), __webpack_require__(18), __webpack_require__(53)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _jquery, _autocompleteAdapter, _Mentions, _autocompleteManager, _autocompleteSettings) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var $ = _interopRequireDefault(_jquery).default;

    var Adapter = _interopRequireDefault(_autocompleteAdapter).default;

    var Mentions = _interopRequireDefault(_Mentions).default;

    var AutocompleteManager = _interopRequireDefault(_autocompleteManager).default;

    var AutocompleteSettings = _interopRequireDefault(_autocompleteSettings).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function activateMentions() {
        AJS.EventQueue.push({ name: 'confluencementioninsert' });
        AutocompleteManager.shortcutFired("@");
    }

    function onClickEvent(event) {
        event.stopPropagation();
        event.preventDefault();
        AJS.Rte.getEditor().focus();
        activateMentions();
    }

    function editorPluginInit(editor) {
        AJS.EventQueue = AJS.EventQueue || [];
        Mentions.prefetchSuppliers(editor);

        AutocompleteSettings.Settings["@"] = {
            ch: "@",
            cache: true,
            endChars: [],
            dropDownClassName: "autocomplete-mentions fabric",
            autocompleteClassNames: "fabric",
            dropDownDelay: 0, // No delay needed because there is no AJAX request involved
            selectFirstItem: true,
            minLengthForGetData: 1,
            displayHandler: function displayHandler(user) {
                // Use Jquery to encode the user name
                return $('<div/>').text(user.name).html();
            },

            getHeaderText: function getHeaderText() {
                return null; // HACK this could be an option in core, the header is currently being hidden with CSS.
            },

            getAdditionalLinks: function getAdditionalLinks(autoCompleteControl, value, callback) {
                var additionalLinks = [];
                if (callback) callback(value, additionalLinks);
                return additionalLinks;
            },

            /**
             *
             * @param autoCompleteControl
             * @param value     The user's input
             * @param {function} renderResults  function to run with the resulting users (from input-driven-dropdown in
             *                                  Core)
             */
            getDataAndRunCallback: function getDataAndRunCallback(autoCompleteControl, value, renderResults) {
                Adapter.search(autoCompleteControl, value, renderResults, editor);
            },

            /**
             * Overrides the confluence/highlighter used to highlight query term matches in results
             */
            // For now, this override is ignored: we're getting better results from the default highlighter than with the
            // highlighting based on Fuse.js output.
            // Highlighter,

            update: Adapter.insert
        };

        $('#insertmention-button').on('click', onClickEvent);

        if (AJS.Rte.Placeholder && AJS.Rte.Placeholder.addPlaceholderType) {
            AJS.Rte.Placeholder.addPlaceholderType({
                type: 'mention',
                label: "\u7528\u6237\u63d0\u53ca",
                tooltip: "\u5f53\u7528\u6237\u8f93\u5165\u65f6\uff0c\u5f15\u5bfc\u6027\u6587\u5b57\u5c06\u88ab\u63a8\u8350\u4eba\u5458\u66ff\u6362\u3002"
            });
        }
    }

    exports.default = editorPluginInit;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 23 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(14), __webpack_require__(4), __webpack_require__(5), __webpack_require__(50), __webpack_require__(2), __webpack_require__(52), __webpack_require__(19)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _Mentions, _recentUsersSupplier, _userSupplierManager, _mentionAnalytics, _meta, _linkObject, _tinymce) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Mentions = _interopRequireDefault(_Mentions).default;

    var RecentUsers = _interopRequireDefault(_recentUsersSupplier).default;

    var UserSupplierManager = _interopRequireDefault(_userSupplierManager).default;

    var MentionsAnalytics = _interopRequireDefault(_mentionAnalytics).default;

    var Meta = _interopRequireDefault(_meta).default;

    var Link = _interopRequireDefault(_linkObject).default;

    var tinymce = _interopRequireDefault(_tinymce).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    var BASE_URL = Meta.get('base-url');

    function search(autoCompleteControl, value, renderResults, editor) {
        MentionsAnalytics.updateSession(autoCompleteControl);

        // The && guard here can be removed once the core tinymce3/plugins/autocomplete/autocomplete-manager.js code is released.
        // Hacky try catch to work around CONFSRVDEV-3101 and CONFSRVDEV-3138
        var selectedUser = void 0;
        try {
            var selectedItem = autoCompleteControl.getCurrentItem && autoCompleteControl.getCurrentItem();
            selectedUser = selectedItem && selectedItem.model;
        } catch (ignored) {
            console.log('Error retrieving currently-selected autoComplete item');
            console.log(ignored);
        }

        // renderResults likes a 2D array, and the query tokens in an array for highlighting
        var tokens = value && value.split(' ') || [];
        var render = function render(results, next, context) {
            return renderResults([results], value, null, tokens, context);
        };
        Mentions.searchAndRender(value, render, selectedUser, editor);
    }

    function insert(autoCompleteControl, user) {
        MentionsAnalytics.publishEventForSelection(user, autoCompleteControl.analytics);

        // Add this user to the cache - it will be retrieved with the recent-users-supplier module.
        RecentUsers.store(user);

        var earlyValidationCheck = RecentUsers.getStaleUsers(RecentUsers.ValidationType.EARLY_VALIDATION);
        if (earlyValidationCheck.length > 0) {
            //asynchronously attempt to update the recently mentioned cache to remove any stale users, after the UI insert is completed
            setTimeout(function () {
                return UserSupplierManager.deleteStaleUsers(earlyValidationCheck, RecentUsers.ValidationType.EARLY_VALIDATION);
            }, 0);
        }

        var link = {
            attrs: {
                href: user.link,
                'userkey': user.model.userKey, // required to unmarshall ResourceIdentifier
                'data-base-url': BASE_URL,
                'data-linked-resource-type': 'userinfo',
                'data-linked-resource-default-alias': user.name
            },
            body: {
                html: AJS.escapeHtml(user.name)
            },
            classes: ['confluence-link']
        };
        Link.fromData(link).insert();
        tinymce.activeEditor.selection.setContent(" ");
    }

    // Called during testing
    function reset() {
        Mentions.reset();
    }

    exports.default = {
        search: search,
        insert: insert,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 24 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _jquery) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    // Adapted from confluence-quick-edit/src/main/resources/jscripts/handlers/comment.js.
    /**
     Supplies the Content API model object associated with the current draft in the editor.
    
     This is basically a shim for something that the Editor JS API *should* provide but currently doesn't
     */
    function getParameter(url, paramName) {
        if (!url) {
            return '';
        }
        var regex = new RegExp("[?&]" + paramName + "=(\\d+)");
        var match = url.match(regex);
        return match && match.length > 1 ? match[1] : '';
    }

    function safeGetDraft(editor) {
        if (!editor) {
            return null;
        }

        try {
            return getDraft(editor);
        } catch (e) {
            // This might happen if the Editor is being initialised in a context we don't yet support.
            console.error(e.message);
            return null;
        }
    }

    function getDraft(editor) {
        var id = Meta.get('page-id');

        var form = editor.formElement;
        var action = form.action || '';

        if (action.indexOf('/doaddcomment.action') > -1 || action.indexOf('/doeditcomment.action') > -1 || $(form).closest('.ic-sidebar').length) {
            var commentId = getParameter(action, "commentId") || '0';

            var content = {
                id: commentId,
                type: 'comment',
                status: 'draft',
                container: {
                    id: id
                }
            };

            var parentCommentId = getParameter(action, "parentId");
            if (parentCommentId) {
                content.ancestors = [{
                    id: parentCommentId
                }];
            }

            return content;
        }

        var previewContainer = $(form).closest('.cp-container');
        if (previewContainer.length) {
            // This is a comment for a Preview. Until we have a proper API, scrape the DOM and shed a single tear.
            var previewTitle = previewContainer.find('.cp-file-title').text().replace(/"/g, "\\\"");
            // CONFSRVDEV-11704 because the previewer can be triggered from like million places, and because we suck
            // and don't set the alias for attachment titles consistently , which means we need to look for them with spaces
            // a well as with + for space
            var alternateTitle = escape(previewTitle.replace(/\s/g, "+"));
            var $element = $('body').find('*[data-linked-resource-default-alias="' + previewTitle + '"], *[data-linked-resource-default-alias="' + alternateTitle + '"]');
            if ($element.length) {
                var attachmentId = $element.attr('data-linked-resource-id');
                // Again, until Previews exposes an API, and the Editor consumes it in a way that THIS code can consume,
                // we're limited in how Smart the suggestions here can be. For now, editing an existing comment or replying
                // to a comment are treated the same as creating a new comment.
                return {
                    id: 0,
                    type: 'comment',
                    status: 'draft',
                    container: {
                        id: attachmentId
                    }
                };
            }
        }

        var newPage = Meta.get('new-page');

        var type = Meta.get('content-type');
        return {
            id: newPage ? '0' : id,
            type: type,
            status: 'draft'
        };
    }

    exports.default = safeGetDraft;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 25 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(3), __webpack_require__(26), __webpack_require__(27), __webpack_require__(28)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _jquery, _aggregateUsers, _restParameters, _relatedUserTransformer) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    var aggregateUsers = _interopRequireDefault(_aggregateUsers).default;

    var getRestParameters = _interopRequireDefault(_restParameters).default;

    var flattenUsers = _interopRequireDefault(_relatedUserTransformer).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict"; /**
                   Supplies Users that are related to a piece of Content, calculated from server data via the Content API.
                   */


    var cache = {};

    var getUsers = function getUsers(contentStub) {
        var restParams = getRestParameters(contentStub);
        if (!restParams) {
            // Will be null for new pages and blogposts: don't make a REST call, don't cache
            return Promise.resolve([]);
        }

        if (restParams.contentId in cache) {
            return cache[restParams.contentId];
        }

        var promise = new Promise(function (resolve, reject) {
            var contextPath = Meta.get('context-path');
            var url = contextPath + '/rest/api/content/' + restParams.contentId;
            var queryParameters = {
                expand: restParams.expand
            };

            $.getJSON(url, queryParameters, function (content) {
                resolve(flattenUsers(aggregateUsers(content)));
            }).fail(reject);
        });

        cache[restParams.contentId] = promise;
        return promise;
    };

    // Used in testing.
    function reset() {
        cache = {};
    }

    exports.default = {
        getUsers: getUsers,
        reset: reset,
        _cache: cache //exposed for testing
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 26 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(7), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userRole, _userSupplierKeys) {
    'use strict';

    var UserRole = _interopRequireDefault(_userRole).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    exports.default = function (content) {
        var relatedUsers = {};

        // Used to track users that have already been added to relatedUsers
        var usernames = new Set();

        // Skip anonymous users, disabled/deleted users, and users already in the result
        function shouldAddUser(user) {
            if (user.type === 'anonymous') {
                return false;
            }

            if (typeof user.status === 'undefined') {
                console.error("User status is undefined. Not adding to relatedUsers aggregate.");
                return false;
            }
            return user.status === 'current' && !usernames.has(user.username);
        }

        function addUser(user, role) {
            user.role = role;
            user.supplier = UserSupplier.RELATED;
            var roleKey = role.role;
            relatedUsers[roleKey] = relatedUsers[roleKey] || [];
            relatedUsers[roleKey].push(user);
            usernames.add(user.username);
        }

        function addUserWithRole(user, role) {
            if (shouldAddUser(user)) {
                addUser(user, role);
            }
        }

        var page = content.type === 'comment' ? content.container : content;

        // Only do this for content that has history
        if ('history' in page) {
            addUserWithRole(page.history.createdBy, UserRole.CREATOR);

            // Contributors are reversed to descending chronological order - users are more likely to mention contributors who
            // edited the content more recently.
            page.history.contributors.publishers.users.reverse().forEach(function (contributor) {
                addUserWithRole(contributor, UserRole.CONTRIBUTOR);
            });
        }

        if (content.type === 'comment' && content.ancestors) {
            // A new or existing comment that is a reply to another comment. We catch ancestor commenters before other
            // commenters because they are more likely to be mentioned.
            // Ancestor order is not reversed because they are already ordered youngest to oldest.
            content.ancestors.forEach(function (ancestorComment) {
                addUserWithRole(ancestorComment.version.by, UserRole.ANCESTOR_COMMENTER);
            });
        }

        if ('children' in page) {
            // Page commenters are also listed in reverse order
            page.children.comment.results.reverse().forEach(function (comment) {
                addUserWithRole(comment.version.by, UserRole.COMMENTER);
            });
        }

        return relatedUsers;
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 27 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    'use strict';

    /**
     Calculations the content id and expansions that should be used in the REST API call when building the
     list of users related to a piece of Content in the editor.
     */

    var PAGE_REST_EXPANSIONS = 'history.createdBy.status,history.contributors.publishers.users.status,children.comment.version.by.status';
    var COMMENT_REST_EXPANSIONS = 'ancestors.version.by.status,container.history.createdBy.status,container.history.contributors.publishers.users.status,container.children.comment.version.by.status';

    function restParams(id, expansions) {
        return {
            contentId: id,
            expand: expansions
        };
    }

    function isBlankId(val) {
        return !val || val === '0';
    }

    exports.default = function (contentStub) {
        if (!contentStub) {
            return null;
        }

        if (contentStub.type === 'page' || contentStub.type === 'blogpost') {
            var pageId = contentStub.id;
            if (isBlankId(pageId)) {
                // A new page/blogpost has no related users.
                return null;
            }
            // Editing an existing page or blogpost
            return restParams(pageId, PAGE_REST_EXPANSIONS);
        }

        if (contentStub.type === 'comment') {
            var commentId = contentStub.id;
            if (!isBlankId(commentId)) {
                // Editing an existing comment
                return restParams(commentId, COMMENT_REST_EXPANSIONS);
            }

            // A new comment: the stub will include the id of the comment it is replying to, unless this is a top-level
            // comment. NOTE: if we end up with access to a Draft comment, we should be able to use its id as the
            // content id, and not use the parent-comment or page ids here.
            var parentCommentId = contentStub.ancestors && contentStub.ancestors[0] && contentStub.ancestors[0].id;
            if (!isBlankId(parentCommentId)) {
                // A new reply
                return restParams(parentCommentId, COMMENT_REST_EXPANSIONS);
            }

            // A new top-level comment
            var _pageId = contentStub.container.id;
            return restParams(_pageId, PAGE_REST_EXPANSIONS);
        }
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 28 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(7)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userRole) {
    "use strict";

    var UserRole = _interopRequireDefault(_userRole).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * Converts the map of users by role into a list of users.
     */

    exports.default = function (usersMap) {
        var transformedList = [];

        function addUsersWithRoleToList(userRole) {
            var users = usersMap[userRole.role];
            if (users && users.length) {
                transformedList = transformedList.concat(users);
            }
        }

        addUsersWithRoleToList(UserRole.CREATOR);
        addUsersWithRoleToList(UserRole.CONTRIBUTOR);
        addUsersWithRoleToList(UserRole.COMMENTER);
        addUsersWithRoleToList(UserRole.ANCESTOR_COMMENTER);

        return transformedList;
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 29 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = LRUCache

// This will be a proper iterable 'Map' in engines that support it,
// or a fakey-fake PseudoMap in older versions.
var Map = __webpack_require__(30)
var util = __webpack_require__(32)

// A linked list to keep track of recently-used-ness
var Yallist = __webpack_require__(36)

// use symbols if possible, otherwise just _props
var hasSymbol = typeof Symbol === 'function'
var makeSymbol
if (hasSymbol) {
  makeSymbol = function (key) {
    return Symbol.for(key)
  }
} else {
  makeSymbol = function (key) {
    return '_' + key
  }
}

var MAX = makeSymbol('max')
var LENGTH = makeSymbol('length')
var LENGTH_CALCULATOR = makeSymbol('lengthCalculator')
var ALLOW_STALE = makeSymbol('allowStale')
var MAX_AGE = makeSymbol('maxAge')
var DISPOSE = makeSymbol('dispose')
var NO_DISPOSE_ON_SET = makeSymbol('noDisposeOnSet')
var LRU_LIST = makeSymbol('lruList')
var CACHE = makeSymbol('cache')

function naiveLength () { return 1 }

// lruList is a yallist where the head is the youngest
// item, and the tail is the oldest.  the list contains the Hit
// objects as the entries.
// Each Hit object has a reference to its Yallist.Node.  This
// never changes.
//
// cache is a Map (or PseudoMap) that matches the keys to
// the Yallist.Node object.
function LRUCache (options) {
  if (!(this instanceof LRUCache)) {
    return new LRUCache(options)
  }

  if (typeof options === 'number') {
    options = { max: options }
  }

  if (!options) {
    options = {}
  }

  var max = this[MAX] = options.max
  // Kind of weird to have a default max of Infinity, but oh well.
  if (!max ||
      !(typeof max === 'number') ||
      max <= 0) {
    this[MAX] = Infinity
  }

  var lc = options.length || naiveLength
  if (typeof lc !== 'function') {
    lc = naiveLength
  }
  this[LENGTH_CALCULATOR] = lc

  this[ALLOW_STALE] = options.stale || false
  this[MAX_AGE] = options.maxAge || 0
  this[DISPOSE] = options.dispose
  this[NO_DISPOSE_ON_SET] = options.noDisposeOnSet || false
  this.reset()
}

// resize the cache when the max changes.
Object.defineProperty(LRUCache.prototype, 'max', {
  set: function (mL) {
    if (!mL || !(typeof mL === 'number') || mL <= 0) {
      mL = Infinity
    }
    this[MAX] = mL
    trim(this)
  },
  get: function () {
    return this[MAX]
  },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'allowStale', {
  set: function (allowStale) {
    this[ALLOW_STALE] = !!allowStale
  },
  get: function () {
    return this[ALLOW_STALE]
  },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'maxAge', {
  set: function (mA) {
    if (!mA || !(typeof mA === 'number') || mA < 0) {
      mA = 0
    }
    this[MAX_AGE] = mA
    trim(this)
  },
  get: function () {
    return this[MAX_AGE]
  },
  enumerable: true
})

// resize the cache when the lengthCalculator changes.
Object.defineProperty(LRUCache.prototype, 'lengthCalculator', {
  set: function (lC) {
    if (typeof lC !== 'function') {
      lC = naiveLength
    }
    if (lC !== this[LENGTH_CALCULATOR]) {
      this[LENGTH_CALCULATOR] = lC
      this[LENGTH] = 0
      this[LRU_LIST].forEach(function (hit) {
        hit.length = this[LENGTH_CALCULATOR](hit.value, hit.key)
        this[LENGTH] += hit.length
      }, this)
    }
    trim(this)
  },
  get: function () { return this[LENGTH_CALCULATOR] },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'length', {
  get: function () { return this[LENGTH] },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'itemCount', {
  get: function () { return this[LRU_LIST].length },
  enumerable: true
})

LRUCache.prototype.rforEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this[LRU_LIST].tail; walker !== null;) {
    var prev = walker.prev
    forEachStep(this, fn, walker, thisp)
    walker = prev
  }
}

function forEachStep (self, fn, node, thisp) {
  var hit = node.value
  if (isStale(self, hit)) {
    del(self, node)
    if (!self[ALLOW_STALE]) {
      hit = undefined
    }
  }
  if (hit) {
    fn.call(thisp, hit.value, hit.key, self)
  }
}

LRUCache.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this[LRU_LIST].head; walker !== null;) {
    var next = walker.next
    forEachStep(this, fn, walker, thisp)
    walker = next
  }
}

LRUCache.prototype.keys = function () {
  return this[LRU_LIST].toArray().map(function (k) {
    return k.key
  }, this)
}

LRUCache.prototype.values = function () {
  return this[LRU_LIST].toArray().map(function (k) {
    return k.value
  }, this)
}

LRUCache.prototype.reset = function () {
  if (this[DISPOSE] &&
      this[LRU_LIST] &&
      this[LRU_LIST].length) {
    this[LRU_LIST].forEach(function (hit) {
      this[DISPOSE](hit.key, hit.value)
    }, this)
  }

  this[CACHE] = new Map() // hash of items by key
  this[LRU_LIST] = new Yallist() // list of items in order of use recency
  this[LENGTH] = 0 // length of items in the list
}

LRUCache.prototype.dump = function () {
  return this[LRU_LIST].map(function (hit) {
    if (!isStale(this, hit)) {
      return {
        k: hit.key,
        v: hit.value,
        e: hit.now + (hit.maxAge || 0)
      }
    }
  }, this).toArray().filter(function (h) {
    return h
  })
}

LRUCache.prototype.dumpLru = function () {
  return this[LRU_LIST]
}

LRUCache.prototype.inspect = function (n, opts) {
  var str = 'LRUCache {'
  var extras = false

  var as = this[ALLOW_STALE]
  if (as) {
    str += '\n  allowStale: true'
    extras = true
  }

  var max = this[MAX]
  if (max && max !== Infinity) {
    if (extras) {
      str += ','
    }
    str += '\n  max: ' + util.inspect(max, opts)
    extras = true
  }

  var maxAge = this[MAX_AGE]
  if (maxAge) {
    if (extras) {
      str += ','
    }
    str += '\n  maxAge: ' + util.inspect(maxAge, opts)
    extras = true
  }

  var lc = this[LENGTH_CALCULATOR]
  if (lc && lc !== naiveLength) {
    if (extras) {
      str += ','
    }
    str += '\n  length: ' + util.inspect(this[LENGTH], opts)
    extras = true
  }

  var didFirst = false
  this[LRU_LIST].forEach(function (item) {
    if (didFirst) {
      str += ',\n  '
    } else {
      if (extras) {
        str += ',\n'
      }
      didFirst = true
      str += '\n  '
    }
    var key = util.inspect(item.key).split('\n').join('\n  ')
    var val = { value: item.value }
    if (item.maxAge !== maxAge) {
      val.maxAge = item.maxAge
    }
    if (lc !== naiveLength) {
      val.length = item.length
    }
    if (isStale(this, item)) {
      val.stale = true
    }

    val = util.inspect(val, opts).split('\n').join('\n  ')
    str += key + ' => ' + val
  })

  if (didFirst || extras) {
    str += '\n'
  }
  str += '}'

  return str
}

LRUCache.prototype.set = function (key, value, maxAge) {
  maxAge = maxAge || this[MAX_AGE]

  var now = maxAge ? Date.now() : 0
  var len = this[LENGTH_CALCULATOR](value, key)

  if (this[CACHE].has(key)) {
    if (len > this[MAX]) {
      del(this, this[CACHE].get(key))
      return false
    }

    var node = this[CACHE].get(key)
    var item = node.value

    // dispose of the old one before overwriting
    // split out into 2 ifs for better coverage tracking
    if (this[DISPOSE]) {
      if (!this[NO_DISPOSE_ON_SET]) {
        this[DISPOSE](key, item.value)
      }
    }

    item.now = now
    item.maxAge = maxAge
    item.value = value
    this[LENGTH] += len - item.length
    item.length = len
    this.get(key)
    trim(this)
    return true
  }

  var hit = new Entry(key, value, len, now, maxAge)

  // oversized objects fall out of cache automatically.
  if (hit.length > this[MAX]) {
    if (this[DISPOSE]) {
      this[DISPOSE](key, value)
    }
    return false
  }

  this[LENGTH] += hit.length
  this[LRU_LIST].unshift(hit)
  this[CACHE].set(key, this[LRU_LIST].head)
  trim(this)
  return true
}

LRUCache.prototype.has = function (key) {
  if (!this[CACHE].has(key)) return false
  var hit = this[CACHE].get(key).value
  if (isStale(this, hit)) {
    return false
  }
  return true
}

LRUCache.prototype.get = function (key) {
  return get(this, key, true)
}

LRUCache.prototype.peek = function (key) {
  return get(this, key, false)
}

LRUCache.prototype.pop = function () {
  var node = this[LRU_LIST].tail
  if (!node) return null
  del(this, node)
  return node.value
}

LRUCache.prototype.del = function (key) {
  del(this, this[CACHE].get(key))
}

LRUCache.prototype.load = function (arr) {
  // reset the cache
  this.reset()

  var now = Date.now()
  // A previous serialized cache has the most recent items first
  for (var l = arr.length - 1; l >= 0; l--) {
    var hit = arr[l]
    var expiresAt = hit.e || 0
    if (expiresAt === 0) {
      // the item was created without expiration in a non aged cache
      this.set(hit.k, hit.v)
    } else {
      var maxAge = expiresAt - now
      // dont add already expired items
      if (maxAge > 0) {
        this.set(hit.k, hit.v, maxAge)
      }
    }
  }
}

LRUCache.prototype.prune = function () {
  var self = this
  this[CACHE].forEach(function (value, key) {
    get(self, key, false)
  })
}

function get (self, key, doUse) {
  var node = self[CACHE].get(key)
  if (node) {
    var hit = node.value
    if (isStale(self, hit)) {
      del(self, node)
      if (!self[ALLOW_STALE]) hit = undefined
    } else {
      if (doUse) {
        self[LRU_LIST].unshiftNode(node)
      }
    }
    if (hit) hit = hit.value
  }
  return hit
}

function isStale (self, hit) {
  if (!hit || (!hit.maxAge && !self[MAX_AGE])) {
    return false
  }
  var stale = false
  var diff = Date.now() - hit.now
  if (hit.maxAge) {
    stale = diff > hit.maxAge
  } else {
    stale = self[MAX_AGE] && (diff > self[MAX_AGE])
  }
  return stale
}

function trim (self) {
  if (self[LENGTH] > self[MAX]) {
    for (var walker = self[LRU_LIST].tail;
         self[LENGTH] > self[MAX] && walker !== null;) {
      // We know that we're about to delete this one, and also
      // what the next least recently used key will be, so just
      // go ahead and set it now.
      var prev = walker.prev
      del(self, walker)
      walker = prev
    }
  }
}

function del (self, node) {
  if (node) {
    var hit = node.value
    if (self[DISPOSE]) {
      self[DISPOSE](hit.key, hit.value)
    }
    self[LENGTH] -= hit.length
    self[CACHE].delete(hit.key)
    self[LRU_LIST].removeNode(node)
  }
}

// classy, since V8 prefers predictable objects.
function Entry (key, value, length, now, maxAge) {
  this.key = key
  this.value = value
  this.length = length
  this.now = now
  this.maxAge = maxAge || 0
}


/***/ }),
/* 30 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process) {if (process.env.npm_package_name === 'pseudomap' &&
    process.env.npm_lifecycle_script === 'test')
  process.env.TEST_PSEUDOMAP = 'true'

if (typeof Map === 'function' && !process.env.TEST_PSEUDOMAP) {
  module.exports = Map
} else {
  module.exports = __webpack_require__(31)
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(9)))

/***/ }),
/* 31 */
/***/ (function(module, exports) {

var hasOwnProperty = Object.prototype.hasOwnProperty

module.exports = PseudoMap

function PseudoMap (set) {
  if (!(this instanceof PseudoMap)) // whyyyyyyy
    throw new TypeError("Constructor PseudoMap requires 'new'")

  this.clear()

  if (set) {
    if ((set instanceof PseudoMap) ||
        (typeof Map === 'function' && set instanceof Map))
      set.forEach(function (value, key) {
        this.set(key, value)
      }, this)
    else if (Array.isArray(set))
      set.forEach(function (kv) {
        this.set(kv[0], kv[1])
      }, this)
    else
      throw new TypeError('invalid argument')
  }
}

PseudoMap.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  Object.keys(this._data).forEach(function (k) {
    if (k !== 'size')
      fn.call(thisp, this._data[k].value, this._data[k].key)
  }, this)
}

PseudoMap.prototype.has = function (k) {
  return !!find(this._data, k)
}

PseudoMap.prototype.get = function (k) {
  var res = find(this._data, k)
  return res && res.value
}

PseudoMap.prototype.set = function (k, v) {
  set(this._data, k, v)
}

PseudoMap.prototype.delete = function (k) {
  var res = find(this._data, k)
  if (res) {
    delete this._data[res._index]
    this._data.size--
  }
}

PseudoMap.prototype.clear = function () {
  var data = Object.create(null)
  data.size = 0

  Object.defineProperty(this, '_data', {
    value: data,
    enumerable: false,
    configurable: true,
    writable: false
  })
}

Object.defineProperty(PseudoMap.prototype, 'size', {
  get: function () {
    return this._data.size
  },
  set: function (n) {},
  enumerable: true,
  configurable: true
})

PseudoMap.prototype.values =
PseudoMap.prototype.keys =
PseudoMap.prototype.entries = function () {
  throw new Error('iterators are not implemented in this version')
}

// Either identical, or both NaN
function same (a, b) {
  return a === b || a !== a && b !== b
}

function Entry (k, v, i) {
  this.key = k
  this.value = v
  this._index = i
}

function find (data, k) {
  for (var i = 0, s = '_' + k, key = s;
       hasOwnProperty.call(data, key);
       key = s + i++) {
    if (same(data[key].key, k))
      return data[key]
  }
}

function set (data, k, v) {
  for (var i = 0, s = '_' + k, key = s;
       hasOwnProperty.call(data, key);
       key = s + i++) {
    if (same(data[key].key, k)) {
      data[key].value = v
      return
    }
  }
  data.size++
  data[key] = new Entry(k, v, key)
}


/***/ }),
/* 32 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global, process) {// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

var formatRegExp = /%[sdj%]/g;
exports.format = function(f) {
  if (!isString(f)) {
    var objects = [];
    for (var i = 0; i < arguments.length; i++) {
      objects.push(inspect(arguments[i]));
    }
    return objects.join(' ');
  }

  var i = 1;
  var args = arguments;
  var len = args.length;
  var str = String(f).replace(formatRegExp, function(x) {
    if (x === '%%') return '%';
    if (i >= len) return x;
    switch (x) {
      case '%s': return String(args[i++]);
      case '%d': return Number(args[i++]);
      case '%j':
        try {
          return JSON.stringify(args[i++]);
        } catch (_) {
          return '[Circular]';
        }
      default:
        return x;
    }
  });
  for (var x = args[i]; i < len; x = args[++i]) {
    if (isNull(x) || !isObject(x)) {
      str += ' ' + x;
    } else {
      str += ' ' + inspect(x);
    }
  }
  return str;
};


// Mark that a method should not be used.
// Returns a modified function which warns once by default.
// If --no-deprecation is set, then it is a no-op.
exports.deprecate = function(fn, msg) {
  // Allow for deprecating things in the process of starting up.
  if (isUndefined(global.process)) {
    return function() {
      return exports.deprecate(fn, msg).apply(this, arguments);
    };
  }

  if (process.noDeprecation === true) {
    return fn;
  }

  var warned = false;
  function deprecated() {
    if (!warned) {
      if (process.throwDeprecation) {
        throw new Error(msg);
      } else if (process.traceDeprecation) {
        console.trace(msg);
      } else {
        console.error(msg);
      }
      warned = true;
    }
    return fn.apply(this, arguments);
  }

  return deprecated;
};


var debugs = {};
var debugEnviron;
exports.debuglog = function(set) {
  if (isUndefined(debugEnviron))
    debugEnviron = process.env.NODE_DEBUG || '';
  set = set.toUpperCase();
  if (!debugs[set]) {
    if (new RegExp('\\b' + set + '\\b', 'i').test(debugEnviron)) {
      var pid = process.pid;
      debugs[set] = function() {
        var msg = exports.format.apply(exports, arguments);
        console.error('%s %d: %s', set, pid, msg);
      };
    } else {
      debugs[set] = function() {};
    }
  }
  return debugs[set];
};


/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 */
/* legacy: obj, showHidden, depth, colors*/
function inspect(obj, opts) {
  // default options
  var ctx = {
    seen: [],
    stylize: stylizeNoColor
  };
  // legacy...
  if (arguments.length >= 3) ctx.depth = arguments[2];
  if (arguments.length >= 4) ctx.colors = arguments[3];
  if (isBoolean(opts)) {
    // legacy...
    ctx.showHidden = opts;
  } else if (opts) {
    // got an "options" object
    exports._extend(ctx, opts);
  }
  // set default options
  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;
  if (isUndefined(ctx.depth)) ctx.depth = 2;
  if (isUndefined(ctx.colors)) ctx.colors = false;
  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;
  if (ctx.colors) ctx.stylize = stylizeWithColor;
  return formatValue(ctx, obj, ctx.depth);
}
exports.inspect = inspect;


// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics
inspect.colors = {
  'bold' : [1, 22],
  'italic' : [3, 23],
  'underline' : [4, 24],
  'inverse' : [7, 27],
  'white' : [37, 39],
  'grey' : [90, 39],
  'black' : [30, 39],
  'blue' : [34, 39],
  'cyan' : [36, 39],
  'green' : [32, 39],
  'magenta' : [35, 39],
  'red' : [31, 39],
  'yellow' : [33, 39]
};

// Don't use 'blue' not visible on cmd.exe
inspect.styles = {
  'special': 'cyan',
  'number': 'yellow',
  'boolean': 'yellow',
  'undefined': 'grey',
  'null': 'bold',
  'string': 'green',
  'date': 'magenta',
  // "name": intentionally not styling
  'regexp': 'red'
};


function stylizeWithColor(str, styleType) {
  var style = inspect.styles[styleType];

  if (style) {
    return '\u001b[' + inspect.colors[style][0] + 'm' + str +
           '\u001b[' + inspect.colors[style][1] + 'm';
  } else {
    return str;
  }
}


function stylizeNoColor(str, styleType) {
  return str;
}


function arrayToHash(array) {
  var hash = {};

  array.forEach(function(val, idx) {
    hash[val] = true;
  });

  return hash;
}


function formatValue(ctx, value, recurseTimes) {
  // Provide a hook for user-specified inspect functions.
  // Check that value is an object with an inspect function on it
  if (ctx.customInspect &&
      value &&
      isFunction(value.inspect) &&
      // Filter out the util module, it's inspect function is special
      value.inspect !== exports.inspect &&
      // Also filter out any prototype objects using the circular check.
      !(value.constructor && value.constructor.prototype === value)) {
    var ret = value.inspect(recurseTimes, ctx);
    if (!isString(ret)) {
      ret = formatValue(ctx, ret, recurseTimes);
    }
    return ret;
  }

  // Primitive types cannot have properties
  var primitive = formatPrimitive(ctx, value);
  if (primitive) {
    return primitive;
  }

  // Look up the keys of the object.
  var keys = Object.keys(value);
  var visibleKeys = arrayToHash(keys);

  if (ctx.showHidden) {
    keys = Object.getOwnPropertyNames(value);
  }

  // IE doesn't make error fields non-enumerable
  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx
  if (isError(value)
      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {
    return formatError(value);
  }

  // Some type of object without properties can be shortcutted.
  if (keys.length === 0) {
    if (isFunction(value)) {
      var name = value.name ? ': ' + value.name : '';
      return ctx.stylize('[Function' + name + ']', 'special');
    }
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    }
    if (isDate(value)) {
      return ctx.stylize(Date.prototype.toString.call(value), 'date');
    }
    if (isError(value)) {
      return formatError(value);
    }
  }

  var base = '', array = false, braces = ['{', '}'];

  // Make Array say that they are Array
  if (isArray(value)) {
    array = true;
    braces = ['[', ']'];
  }

  // Make functions say that they are functions
  if (isFunction(value)) {
    var n = value.name ? ': ' + value.name : '';
    base = ' [Function' + n + ']';
  }

  // Make RegExps say that they are RegExps
  if (isRegExp(value)) {
    base = ' ' + RegExp.prototype.toString.call(value);
  }

  // Make dates with properties first say the date
  if (isDate(value)) {
    base = ' ' + Date.prototype.toUTCString.call(value);
  }

  // Make error with message first say the error
  if (isError(value)) {
    base = ' ' + formatError(value);
  }

  if (keys.length === 0 && (!array || value.length == 0)) {
    return braces[0] + base + braces[1];
  }

  if (recurseTimes < 0) {
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    } else {
      return ctx.stylize('[Object]', 'special');
    }
  }

  ctx.seen.push(value);

  var output;
  if (array) {
    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);
  } else {
    output = keys.map(function(key) {
      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);
    });
  }

  ctx.seen.pop();

  return reduceToSingleString(output, base, braces);
}


function formatPrimitive(ctx, value) {
  if (isUndefined(value))
    return ctx.stylize('undefined', 'undefined');
  if (isString(value)) {
    var simple = '\'' + JSON.stringify(value).replace(/^"|"$/g, '')
                                             .replace(/'/g, "\\'")
                                             .replace(/\\"/g, '"') + '\'';
    return ctx.stylize(simple, 'string');
  }
  if (isNumber(value))
    return ctx.stylize('' + value, 'number');
  if (isBoolean(value))
    return ctx.stylize('' + value, 'boolean');
  // For some reason typeof null is "object", so special case here.
  if (isNull(value))
    return ctx.stylize('null', 'null');
}


function formatError(value) {
  return '[' + Error.prototype.toString.call(value) + ']';
}


function formatArray(ctx, value, recurseTimes, visibleKeys, keys) {
  var output = [];
  for (var i = 0, l = value.length; i < l; ++i) {
    if (hasOwnProperty(value, String(i))) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          String(i), true));
    } else {
      output.push('');
    }
  }
  keys.forEach(function(key) {
    if (!key.match(/^\d+$/)) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          key, true));
    }
  });
  return output;
}


function formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {
  var name, str, desc;
  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };
  if (desc.get) {
    if (desc.set) {
      str = ctx.stylize('[Getter/Setter]', 'special');
    } else {
      str = ctx.stylize('[Getter]', 'special');
    }
  } else {
    if (desc.set) {
      str = ctx.stylize('[Setter]', 'special');
    }
  }
  if (!hasOwnProperty(visibleKeys, key)) {
    name = '[' + key + ']';
  }
  if (!str) {
    if (ctx.seen.indexOf(desc.value) < 0) {
      if (isNull(recurseTimes)) {
        str = formatValue(ctx, desc.value, null);
      } else {
        str = formatValue(ctx, desc.value, recurseTimes - 1);
      }
      if (str.indexOf('\n') > -1) {
        if (array) {
          str = str.split('\n').map(function(line) {
            return '  ' + line;
          }).join('\n').substr(2);
        } else {
          str = '\n' + str.split('\n').map(function(line) {
            return '   ' + line;
          }).join('\n');
        }
      }
    } else {
      str = ctx.stylize('[Circular]', 'special');
    }
  }
  if (isUndefined(name)) {
    if (array && key.match(/^\d+$/)) {
      return str;
    }
    name = JSON.stringify('' + key);
    if (name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)) {
      name = name.substr(1, name.length - 2);
      name = ctx.stylize(name, 'name');
    } else {
      name = name.replace(/'/g, "\\'")
                 .replace(/\\"/g, '"')
                 .replace(/(^"|"$)/g, "'");
      name = ctx.stylize(name, 'string');
    }
  }

  return name + ': ' + str;
}


function reduceToSingleString(output, base, braces) {
  var numLinesEst = 0;
  var length = output.reduce(function(prev, cur) {
    numLinesEst++;
    if (cur.indexOf('\n') >= 0) numLinesEst++;
    return prev + cur.replace(/\u001b\[\d\d?m/g, '').length + 1;
  }, 0);

  if (length > 60) {
    return braces[0] +
           (base === '' ? '' : base + '\n ') +
           ' ' +
           output.join(',\n  ') +
           ' ' +
           braces[1];
  }

  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];
}


// NOTE: These type checking functions intentionally don't use `instanceof`
// because it is fragile and can be easily faked with `Object.create()`.
function isArray(ar) {
  return Array.isArray(ar);
}
exports.isArray = isArray;

function isBoolean(arg) {
  return typeof arg === 'boolean';
}
exports.isBoolean = isBoolean;

function isNull(arg) {
  return arg === null;
}
exports.isNull = isNull;

function isNullOrUndefined(arg) {
  return arg == null;
}
exports.isNullOrUndefined = isNullOrUndefined;

function isNumber(arg) {
  return typeof arg === 'number';
}
exports.isNumber = isNumber;

function isString(arg) {
  return typeof arg === 'string';
}
exports.isString = isString;

function isSymbol(arg) {
  return typeof arg === 'symbol';
}
exports.isSymbol = isSymbol;

function isUndefined(arg) {
  return arg === void 0;
}
exports.isUndefined = isUndefined;

function isRegExp(re) {
  return isObject(re) && objectToString(re) === '[object RegExp]';
}
exports.isRegExp = isRegExp;

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}
exports.isObject = isObject;

function isDate(d) {
  return isObject(d) && objectToString(d) === '[object Date]';
}
exports.isDate = isDate;

function isError(e) {
  return isObject(e) &&
      (objectToString(e) === '[object Error]' || e instanceof Error);
}
exports.isError = isError;

function isFunction(arg) {
  return typeof arg === 'function';
}
exports.isFunction = isFunction;

function isPrimitive(arg) {
  return arg === null ||
         typeof arg === 'boolean' ||
         typeof arg === 'number' ||
         typeof arg === 'string' ||
         typeof arg === 'symbol' ||  // ES6 symbol
         typeof arg === 'undefined';
}
exports.isPrimitive = isPrimitive;

exports.isBuffer = __webpack_require__(34);

function objectToString(o) {
  return Object.prototype.toString.call(o);
}


function pad(n) {
  return n < 10 ? '0' + n.toString(10) : n.toString(10);
}


var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',
              'Oct', 'Nov', 'Dec'];

// 26 Feb 16:19:34
function timestamp() {
  var d = new Date();
  var time = [pad(d.getHours()),
              pad(d.getMinutes()),
              pad(d.getSeconds())].join(':');
  return [d.getDate(), months[d.getMonth()], time].join(' ');
}


// log is just a thin wrapper to console.log that prepends a timestamp
exports.log = function() {
  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));
};


/**
 * Inherit the prototype methods from one constructor into another.
 *
 * The Function.prototype.inherits from lang.js rewritten as a standalone
 * function (not on Function.prototype). NOTE: If this file is to be loaded
 * during bootstrapping this function needs to be rewritten using some native
 * functions as prototype setup using normal JavaScript does not work as
 * expected during bootstrapping (see mirror.js in r114903).
 *
 * @param {function} ctor Constructor function which needs to inherit the
 *     prototype.
 * @param {function} superCtor Constructor function to inherit prototype from.
 */
exports.inherits = __webpack_require__(35);

exports._extend = function(origin, add) {
  // Don't do anything if add isn't an object
  if (!add || !isObject(add)) return origin;

  var keys = Object.keys(add);
  var i = keys.length;
  while (i--) {
    origin[keys[i]] = add[keys[i]];
  }
  return origin;
};

function hasOwnProperty(obj, prop) {
  return Object.prototype.hasOwnProperty.call(obj, prop);
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(33), __webpack_require__(9)))

/***/ }),
/* 33 */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || Function("return this")() || (1,eval)("this");
} catch(e) {
	// This works if the window reference is available
	if(typeof window === "object")
		g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),
/* 34 */
/***/ (function(module, exports) {

module.exports = function isBuffer(arg) {
  return arg && typeof arg === 'object'
    && typeof arg.copy === 'function'
    && typeof arg.fill === 'function'
    && typeof arg.readUInt8 === 'function';
}

/***/ }),
/* 35 */
/***/ (function(module, exports) {

if (typeof Object.create === 'function') {
  // implementation from standard node.js 'util' module
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    ctor.prototype = Object.create(superCtor.prototype, {
      constructor: {
        value: ctor,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
  };
} else {
  // old school shim for old browsers
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    var TempCtor = function () {}
    TempCtor.prototype = superCtor.prototype
    ctor.prototype = new TempCtor()
    ctor.prototype.constructor = ctor
  }
}


/***/ }),
/* 36 */
/***/ (function(module, exports) {

module.exports = Yallist

Yallist.Node = Node
Yallist.create = Yallist

function Yallist (list) {
  var self = this
  if (!(self instanceof Yallist)) {
    self = new Yallist()
  }

  self.tail = null
  self.head = null
  self.length = 0

  if (list && typeof list.forEach === 'function') {
    list.forEach(function (item) {
      self.push(item)
    })
  } else if (arguments.length > 0) {
    for (var i = 0, l = arguments.length; i < l; i++) {
      self.push(arguments[i])
    }
  }

  return self
}

Yallist.prototype.removeNode = function (node) {
  if (node.list !== this) {
    throw new Error('removing node which does not belong to this list')
  }

  var next = node.next
  var prev = node.prev

  if (next) {
    next.prev = prev
  }

  if (prev) {
    prev.next = next
  }

  if (node === this.head) {
    this.head = next
  }
  if (node === this.tail) {
    this.tail = prev
  }

  node.list.length--
  node.next = null
  node.prev = null
  node.list = null
}

Yallist.prototype.unshiftNode = function (node) {
  if (node === this.head) {
    return
  }

  if (node.list) {
    node.list.removeNode(node)
  }

  var head = this.head
  node.list = this
  node.next = head
  if (head) {
    head.prev = node
  }

  this.head = node
  if (!this.tail) {
    this.tail = node
  }
  this.length++
}

Yallist.prototype.pushNode = function (node) {
  if (node === this.tail) {
    return
  }

  if (node.list) {
    node.list.removeNode(node)
  }

  var tail = this.tail
  node.list = this
  node.prev = tail
  if (tail) {
    tail.next = node
  }

  this.tail = node
  if (!this.head) {
    this.head = node
  }
  this.length++
}

Yallist.prototype.push = function () {
  for (var i = 0, l = arguments.length; i < l; i++) {
    push(this, arguments[i])
  }
  return this.length
}

Yallist.prototype.unshift = function () {
  for (var i = 0, l = arguments.length; i < l; i++) {
    unshift(this, arguments[i])
  }
  return this.length
}

Yallist.prototype.pop = function () {
  if (!this.tail) {
    return undefined
  }

  var res = this.tail.value
  this.tail = this.tail.prev
  if (this.tail) {
    this.tail.next = null
  } else {
    this.head = null
  }
  this.length--
  return res
}

Yallist.prototype.shift = function () {
  if (!this.head) {
    return undefined
  }

  var res = this.head.value
  this.head = this.head.next
  if (this.head) {
    this.head.prev = null
  } else {
    this.tail = null
  }
  this.length--
  return res
}

Yallist.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this.head, i = 0; walker !== null; i++) {
    fn.call(thisp, walker.value, i, this)
    walker = walker.next
  }
}

Yallist.prototype.forEachReverse = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {
    fn.call(thisp, walker.value, i, this)
    walker = walker.prev
  }
}

Yallist.prototype.get = function (n) {
  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {
    // abort out of the list early if we hit a cycle
    walker = walker.next
  }
  if (i === n && walker !== null) {
    return walker.value
  }
}

Yallist.prototype.getReverse = function (n) {
  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {
    // abort out of the list early if we hit a cycle
    walker = walker.prev
  }
  if (i === n && walker !== null) {
    return walker.value
  }
}

Yallist.prototype.map = function (fn, thisp) {
  thisp = thisp || this
  var res = new Yallist()
  for (var walker = this.head; walker !== null;) {
    res.push(fn.call(thisp, walker.value, this))
    walker = walker.next
  }
  return res
}

Yallist.prototype.mapReverse = function (fn, thisp) {
  thisp = thisp || this
  var res = new Yallist()
  for (var walker = this.tail; walker !== null;) {
    res.push(fn.call(thisp, walker.value, this))
    walker = walker.prev
  }
  return res
}

Yallist.prototype.reduce = function (fn, initial) {
  var acc
  var walker = this.head
  if (arguments.length > 1) {
    acc = initial
  } else if (this.head) {
    walker = this.head.next
    acc = this.head.value
  } else {
    throw new TypeError('Reduce of empty list with no initial value')
  }

  for (var i = 0; walker !== null; i++) {
    acc = fn(acc, walker.value, i)
    walker = walker.next
  }

  return acc
}

Yallist.prototype.reduceReverse = function (fn, initial) {
  var acc
  var walker = this.tail
  if (arguments.length > 1) {
    acc = initial
  } else if (this.tail) {
    walker = this.tail.prev
    acc = this.tail.value
  } else {
    throw new TypeError('Reduce of empty list with no initial value')
  }

  for (var i = this.length - 1; walker !== null; i--) {
    acc = fn(acc, walker.value, i)
    walker = walker.prev
  }

  return acc
}

Yallist.prototype.toArray = function () {
  var arr = new Array(this.length)
  for (var i = 0, walker = this.head; walker !== null; i++) {
    arr[i] = walker.value
    walker = walker.next
  }
  return arr
}

Yallist.prototype.toArrayReverse = function () {
  var arr = new Array(this.length)
  for (var i = 0, walker = this.tail; walker !== null; i++) {
    arr[i] = walker.value
    walker = walker.prev
  }
  return arr
}

Yallist.prototype.slice = function (from, to) {
  to = to || this.length
  if (to < 0) {
    to += this.length
  }
  from = from || 0
  if (from < 0) {
    from += this.length
  }
  var ret = new Yallist()
  if (to < from || to < 0) {
    return ret
  }
  if (from < 0) {
    from = 0
  }
  if (to > this.length) {
    to = this.length
  }
  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {
    walker = walker.next
  }
  for (; walker !== null && i < to; i++, walker = walker.next) {
    ret.push(walker.value)
  }
  return ret
}

Yallist.prototype.sliceReverse = function (from, to) {
  to = to || this.length
  if (to < 0) {
    to += this.length
  }
  from = from || 0
  if (from < 0) {
    from += this.length
  }
  var ret = new Yallist()
  if (to < from || to < 0) {
    return ret
  }
  if (from < 0) {
    from = 0
  }
  if (to > this.length) {
    to = this.length
  }
  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {
    walker = walker.prev
  }
  for (; walker !== null && i > from; i--, walker = walker.prev) {
    ret.push(walker.value)
  }
  return ret
}

Yallist.prototype.reverse = function () {
  var head = this.head
  var tail = this.tail
  for (var walker = head; walker !== null; walker = walker.prev) {
    var p = walker.prev
    walker.prev = walker.next
    walker.next = p
  }
  this.head = tail
  this.tail = head
  return this
}

function push (self, item) {
  self.tail = new Node(item, self.tail, null, self)
  if (!self.head) {
    self.head = self.tail
  }
  self.length++
}

function unshift (self, item) {
  self.head = new Node(item, null, self.head, self)
  if (!self.tail) {
    self.tail = self.head
  }
  self.length++
}

function Node (value, prev, next, list) {
  if (!(this instanceof Node)) {
    return new Node(value, prev, next, list)
  }

  this.list = list
  this.value = value

  if (prev) {
    prev.next = this
    this.prev = prev
  } else {
    this.prev = null
  }

  if (next) {
    next.prev = this
    this.next = next
  } else {
    this.next = null
  }
}


/***/ }),
/* 37 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_37__;

/***/ }),
/* 38 */
/***/ (function(module, exports, __webpack_require__) {

/*!
 * Fuse.js v3.2.0 - Lightweight fuzzy-search (http://fusejs.io)
 * 
 * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)
 * All Rights Reserved. Apache Software License 2.0
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 */
(function webpackUniversalModuleDefinition(root, factory) {
	if(true)
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define("Fuse", [], factory);
	else if(typeof exports === 'object')
		exports["Fuse"] = factory();
	else
		root["Fuse"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmony imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 8);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (obj) {
  return Object.prototype.toString.call(obj) === '[object Array]';
};

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var bitapRegexSearch = __webpack_require__(5);
var bitapSearch = __webpack_require__(7);
var patternAlphabet = __webpack_require__(4);

var Bitap = function () {
  function Bitap(pattern, _ref) {
    var _ref$location = _ref.location,
        location = _ref$location === undefined ? 0 : _ref$location,
        _ref$distance = _ref.distance,
        distance = _ref$distance === undefined ? 100 : _ref$distance,
        _ref$threshold = _ref.threshold,
        threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
        _ref$maxPatternLength = _ref.maxPatternLength,
        maxPatternLength = _ref$maxPatternLength === undefined ? 32 : _ref$maxPatternLength,
        _ref$isCaseSensitive = _ref.isCaseSensitive,
        isCaseSensitive = _ref$isCaseSensitive === undefined ? false : _ref$isCaseSensitive,
        _ref$tokenSeparator = _ref.tokenSeparator,
        tokenSeparator = _ref$tokenSeparator === undefined ? / +/g : _ref$tokenSeparator,
        _ref$findAllMatches = _ref.findAllMatches,
        findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
        _ref$minMatchCharLeng = _ref.minMatchCharLength,
        minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng;

    _classCallCheck(this, Bitap);

    this.options = {
      location: location,
      distance: distance,
      threshold: threshold,
      maxPatternLength: maxPatternLength,
      isCaseSensitive: isCaseSensitive,
      tokenSeparator: tokenSeparator,
      findAllMatches: findAllMatches,
      minMatchCharLength: minMatchCharLength
    };

    this.pattern = this.options.isCaseSensitive ? pattern : pattern.toLowerCase();

    if (this.pattern.length <= maxPatternLength) {
      this.patternAlphabet = patternAlphabet(this.pattern);
    }
  }

  _createClass(Bitap, [{
    key: 'search',
    value: function search(text) {
      if (!this.options.isCaseSensitive) {
        text = text.toLowerCase();
      }

      // Exact match
      if (this.pattern === text) {
        return {
          isMatch: true,
          score: 0,
          matchedIndices: [[0, text.length - 1]]
        };
      }

      // When pattern length is greater than the machine word length, just do a a regex comparison
      var _options = this.options,
          maxPatternLength = _options.maxPatternLength,
          tokenSeparator = _options.tokenSeparator;

      if (this.pattern.length > maxPatternLength) {
        return bitapRegexSearch(text, this.pattern, tokenSeparator);
      }

      // Otherwise, use Bitap algorithm
      var _options2 = this.options,
          location = _options2.location,
          distance = _options2.distance,
          threshold = _options2.threshold,
          findAllMatches = _options2.findAllMatches,
          minMatchCharLength = _options2.minMatchCharLength;

      return bitapSearch(text, this.pattern, this.patternAlphabet, {
        location: location,
        distance: distance,
        threshold: threshold,
        findAllMatches: findAllMatches,
        minMatchCharLength: minMatchCharLength
      });
    }
  }]);

  return Bitap;
}();

// let x = new Bitap("od mn war", {})
// let result = x.search("Old Man's War")
// console.log(result)

module.exports = Bitap;

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var isArray = __webpack_require__(0);

var deepValue = function deepValue(obj, path, list) {
  if (!path) {
    // If there's no path left, we've gotten to the object we care about.
    list.push(obj);
  } else {
    var dotIndex = path.indexOf('.');
    var firstSegment = path;
    var remaining = null;

    if (dotIndex !== -1) {
      firstSegment = path.slice(0, dotIndex);
      remaining = path.slice(dotIndex + 1);
    }

    var value = obj[firstSegment];

    if (value !== null && value !== undefined) {
      if (!remaining && (typeof value === 'string' || typeof value === 'number')) {
        list.push(value.toString());
      } else if (isArray(value)) {
        // Search each item in the array.
        for (var i = 0, len = value.length; i < len; i += 1) {
          deepValue(value[i], remaining, list);
        }
      } else if (remaining) {
        // An object. Recurse further.
        deepValue(value, remaining, list);
      }
    }
  }

  return list;
};

module.exports = function (obj, path) {
  return deepValue(obj, path, []);
};

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function () {
  var matchmask = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var minMatchCharLength = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

  var matchedIndices = [];
  var start = -1;
  var end = -1;
  var i = 0;

  for (var len = matchmask.length; i < len; i += 1) {
    var match = matchmask[i];
    if (match && start === -1) {
      start = i;
    } else if (!match && start !== -1) {
      end = i - 1;
      if (end - start + 1 >= minMatchCharLength) {
        matchedIndices.push([start, end]);
      }
      start = -1;
    }
  }

  // (i-1 - start) + 1 => i - start
  if (matchmask[i - 1] && i - start >= minMatchCharLength) {
    matchedIndices.push([start, i - 1]);
  }

  return matchedIndices;
};

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (pattern) {
  var mask = {};
  var len = pattern.length;

  for (var i = 0; i < len; i += 1) {
    mask[pattern.charAt(i)] = 0;
  }

  for (var _i = 0; _i < len; _i += 1) {
    mask[pattern.charAt(_i)] |= 1 << len - _i - 1;
  }

  return mask;
};

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var SPECIAL_CHARS_REGEX = /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;

module.exports = function (text, pattern) {
  var tokenSeparator = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : / +/g;

  var regex = new RegExp(pattern.replace(SPECIAL_CHARS_REGEX, '\\$&').replace(tokenSeparator, '|'));
  var matches = text.match(regex);
  var isMatch = !!matches;
  var matchedIndices = [];

  if (isMatch) {
    for (var i = 0, matchesLen = matches.length; i < matchesLen; i += 1) {
      var match = matches[i];
      matchedIndices.push([text.indexOf(match), match.length - 1]);
    }
  }

  return {
    // TODO: revisit this score
    score: isMatch ? 0.5 : 1,
    isMatch: isMatch,
    matchedIndices: matchedIndices
  };
};

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (pattern, _ref) {
  var _ref$errors = _ref.errors,
      errors = _ref$errors === undefined ? 0 : _ref$errors,
      _ref$currentLocation = _ref.currentLocation,
      currentLocation = _ref$currentLocation === undefined ? 0 : _ref$currentLocation,
      _ref$expectedLocation = _ref.expectedLocation,
      expectedLocation = _ref$expectedLocation === undefined ? 0 : _ref$expectedLocation,
      _ref$distance = _ref.distance,
      distance = _ref$distance === undefined ? 100 : _ref$distance;

  var accuracy = errors / pattern.length;
  var proximity = Math.abs(expectedLocation - currentLocation);

  if (!distance) {
    // Dodge divide by zero error.
    return proximity ? 1.0 : accuracy;
  }

  return accuracy + proximity / distance;
};

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var bitapScore = __webpack_require__(6);
var matchedIndices = __webpack_require__(3);

module.exports = function (text, pattern, patternAlphabet, _ref) {
  var _ref$location = _ref.location,
      location = _ref$location === undefined ? 0 : _ref$location,
      _ref$distance = _ref.distance,
      distance = _ref$distance === undefined ? 100 : _ref$distance,
      _ref$threshold = _ref.threshold,
      threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
      _ref$findAllMatches = _ref.findAllMatches,
      findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
      _ref$minMatchCharLeng = _ref.minMatchCharLength,
      minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng;

  var expectedLocation = location;
  // Set starting location at beginning text and initialize the alphabet.
  var textLen = text.length;
  // Highest score beyond which we give up.
  var currentThreshold = threshold;
  // Is there a nearby exact match? (speedup)
  var bestLocation = text.indexOf(pattern, expectedLocation);

  var patternLen = pattern.length;

  // a mask of the matches
  var matchMask = [];
  for (var i = 0; i < textLen; i += 1) {
    matchMask[i] = 0;
  }

  if (bestLocation !== -1) {
    var score = bitapScore(pattern, {
      errors: 0,
      currentLocation: bestLocation,
      expectedLocation: expectedLocation,
      distance: distance
    });
    currentThreshold = Math.min(score, currentThreshold);

    // What about in the other direction? (speed up)
    bestLocation = text.lastIndexOf(pattern, expectedLocation + patternLen);

    if (bestLocation !== -1) {
      var _score = bitapScore(pattern, {
        errors: 0,
        currentLocation: bestLocation,
        expectedLocation: expectedLocation,
        distance: distance
      });
      currentThreshold = Math.min(_score, currentThreshold);
    }
  }

  // Reset the best location
  bestLocation = -1;

  var lastBitArr = [];
  var finalScore = 1;
  var binMax = patternLen + textLen;

  var mask = 1 << patternLen - 1;

  for (var _i = 0; _i < patternLen; _i += 1) {
    // Scan for the best match; each iteration allows for one more error.
    // Run a binary search to determine how far from the match location we can stray
    // at this error level.
    var binMin = 0;
    var binMid = binMax;

    while (binMin < binMid) {
      var _score3 = bitapScore(pattern, {
        errors: _i,
        currentLocation: expectedLocation + binMid,
        expectedLocation: expectedLocation,
        distance: distance
      });

      if (_score3 <= currentThreshold) {
        binMin = binMid;
      } else {
        binMax = binMid;
      }

      binMid = Math.floor((binMax - binMin) / 2 + binMin);
    }

    // Use the result from this iteration as the maximum for the next.
    binMax = binMid;

    var start = Math.max(1, expectedLocation - binMid + 1);
    var finish = findAllMatches ? textLen : Math.min(expectedLocation + binMid, textLen) + patternLen;

    // Initialize the bit array
    var bitArr = Array(finish + 2);

    bitArr[finish + 1] = (1 << _i) - 1;

    for (var j = finish; j >= start; j -= 1) {
      var currentLocation = j - 1;
      var charMatch = patternAlphabet[text.charAt(currentLocation)];

      if (charMatch) {
        matchMask[currentLocation] = 1;
      }

      // First pass: exact match
      bitArr[j] = (bitArr[j + 1] << 1 | 1) & charMatch;

      // Subsequent passes: fuzzy match
      if (_i !== 0) {
        bitArr[j] |= (lastBitArr[j + 1] | lastBitArr[j]) << 1 | 1 | lastBitArr[j + 1];
      }

      if (bitArr[j] & mask) {
        finalScore = bitapScore(pattern, {
          errors: _i,
          currentLocation: currentLocation,
          expectedLocation: expectedLocation,
          distance: distance
        });

        // This match will almost certainly be better than any existing match.
        // But check anyway.
        if (finalScore <= currentThreshold) {
          // Indeed it is
          currentThreshold = finalScore;
          bestLocation = currentLocation;

          // Already passed `loc`, downhill from here on in.
          if (bestLocation <= expectedLocation) {
            break;
          }

          // When passing `bestLocation`, don't exceed our current distance from `expectedLocation`.
          start = Math.max(1, 2 * expectedLocation - bestLocation);
        }
      }
    }

    // No hope for a (better) match at greater error levels.
    var _score2 = bitapScore(pattern, {
      errors: _i + 1,
      currentLocation: expectedLocation,
      expectedLocation: expectedLocation,
      distance: distance
    });

    if (_score2 > currentThreshold) {
      break;
    }

    lastBitArr = bitArr;
  }

  // Count exact matches (those with a score of 0) to be "almost" exact
  return {
    isMatch: bestLocation >= 0,
    score: finalScore === 0 ? 0.001 : finalScore,
    matchedIndices: matchedIndices(matchMask, minMatchCharLength)
  };
};

/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Bitap = __webpack_require__(1);
var deepValue = __webpack_require__(2);
var isArray = __webpack_require__(0);

var Fuse = function () {
  function Fuse(list, _ref) {
    var _ref$location = _ref.location,
        location = _ref$location === undefined ? 0 : _ref$location,
        _ref$distance = _ref.distance,
        distance = _ref$distance === undefined ? 100 : _ref$distance,
        _ref$threshold = _ref.threshold,
        threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
        _ref$maxPatternLength = _ref.maxPatternLength,
        maxPatternLength = _ref$maxPatternLength === undefined ? 32 : _ref$maxPatternLength,
        _ref$caseSensitive = _ref.caseSensitive,
        caseSensitive = _ref$caseSensitive === undefined ? false : _ref$caseSensitive,
        _ref$tokenSeparator = _ref.tokenSeparator,
        tokenSeparator = _ref$tokenSeparator === undefined ? / +/g : _ref$tokenSeparator,
        _ref$findAllMatches = _ref.findAllMatches,
        findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
        _ref$minMatchCharLeng = _ref.minMatchCharLength,
        minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng,
        _ref$id = _ref.id,
        id = _ref$id === undefined ? null : _ref$id,
        _ref$keys = _ref.keys,
        keys = _ref$keys === undefined ? [] : _ref$keys,
        _ref$shouldSort = _ref.shouldSort,
        shouldSort = _ref$shouldSort === undefined ? true : _ref$shouldSort,
        _ref$getFn = _ref.getFn,
        getFn = _ref$getFn === undefined ? deepValue : _ref$getFn,
        _ref$sortFn = _ref.sortFn,
        sortFn = _ref$sortFn === undefined ? function (a, b) {
      return a.score - b.score;
    } : _ref$sortFn,
        _ref$tokenize = _ref.tokenize,
        tokenize = _ref$tokenize === undefined ? false : _ref$tokenize,
        _ref$matchAllTokens = _ref.matchAllTokens,
        matchAllTokens = _ref$matchAllTokens === undefined ? false : _ref$matchAllTokens,
        _ref$includeMatches = _ref.includeMatches,
        includeMatches = _ref$includeMatches === undefined ? false : _ref$includeMatches,
        _ref$includeScore = _ref.includeScore,
        includeScore = _ref$includeScore === undefined ? false : _ref$includeScore,
        _ref$verbose = _ref.verbose,
        verbose = _ref$verbose === undefined ? false : _ref$verbose;

    _classCallCheck(this, Fuse);

    this.options = {
      location: location,
      distance: distance,
      threshold: threshold,
      maxPatternLength: maxPatternLength,
      isCaseSensitive: caseSensitive,
      tokenSeparator: tokenSeparator,
      findAllMatches: findAllMatches,
      minMatchCharLength: minMatchCharLength,
      id: id,
      keys: keys,
      includeMatches: includeMatches,
      includeScore: includeScore,
      shouldSort: shouldSort,
      getFn: getFn,
      sortFn: sortFn,
      verbose: verbose,
      tokenize: tokenize,
      matchAllTokens: matchAllTokens
    };

    this.setCollection(list);
  }

  _createClass(Fuse, [{
    key: 'setCollection',
    value: function setCollection(list) {
      this.list = list;
      return list;
    }
  }, {
    key: 'search',
    value: function search(pattern) {
      this._log('---------\nSearch pattern: "' + pattern + '"');

      var _prepareSearchers2 = this._prepareSearchers(pattern),
          tokenSearchers = _prepareSearchers2.tokenSearchers,
          fullSearcher = _prepareSearchers2.fullSearcher;

      var _search2 = this._search(tokenSearchers, fullSearcher),
          weights = _search2.weights,
          results = _search2.results;

      this._computeScore(weights, results);

      if (this.options.shouldSort) {
        this._sort(results);
      }

      return this._format(results);
    }
  }, {
    key: '_prepareSearchers',
    value: function _prepareSearchers() {
      var pattern = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

      var tokenSearchers = [];

      if (this.options.tokenize) {
        // Tokenize on the separator
        var tokens = pattern.split(this.options.tokenSeparator);
        for (var i = 0, len = tokens.length; i < len; i += 1) {
          tokenSearchers.push(new Bitap(tokens[i], this.options));
        }
      }

      var fullSearcher = new Bitap(pattern, this.options);

      return { tokenSearchers: tokenSearchers, fullSearcher: fullSearcher };
    }
  }, {
    key: '_search',
    value: function _search() {
      var tokenSearchers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      var fullSearcher = arguments[1];

      var list = this.list;
      var resultMap = {};
      var results = [];

      // Check the first item in the list, if it's a string, then we assume
      // that every item in the list is also a string, and thus it's a flattened array.
      if (typeof list[0] === 'string') {
        // Iterate over every item
        for (var i = 0, len = list.length; i < len; i += 1) {
          this._analyze({
            key: '',
            value: list[i],
            record: i,
            index: i
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }

        return { weights: null, results: results };
      }

      // Otherwise, the first item is an Object (hopefully), and thus the searching
      // is done on the values of the keys of each item.
      var weights = {};
      for (var _i = 0, _len = list.length; _i < _len; _i += 1) {
        var item = list[_i];
        // Iterate over every key
        for (var j = 0, keysLen = this.options.keys.length; j < keysLen; j += 1) {
          var key = this.options.keys[j];
          if (typeof key !== 'string') {
            weights[key.name] = {
              weight: 1 - key.weight || 1
            };
            if (key.weight <= 0 || key.weight > 1) {
              throw new Error('Key weight has to be > 0 and <= 1');
            }
            key = key.name;
          } else {
            weights[key] = {
              weight: 1
            };
          }

          this._analyze({
            key: key,
            value: this.options.getFn(item, key),
            record: item,
            index: _i
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }
      }

      return { weights: weights, results: results };
    }
  }, {
    key: '_analyze',
    value: function _analyze(_ref2, _ref3) {
      var key = _ref2.key,
          _ref2$arrayIndex = _ref2.arrayIndex,
          arrayIndex = _ref2$arrayIndex === undefined ? -1 : _ref2$arrayIndex,
          value = _ref2.value,
          record = _ref2.record,
          index = _ref2.index;
      var _ref3$tokenSearchers = _ref3.tokenSearchers,
          tokenSearchers = _ref3$tokenSearchers === undefined ? [] : _ref3$tokenSearchers,
          _ref3$fullSearcher = _ref3.fullSearcher,
          fullSearcher = _ref3$fullSearcher === undefined ? [] : _ref3$fullSearcher,
          _ref3$resultMap = _ref3.resultMap,
          resultMap = _ref3$resultMap === undefined ? {} : _ref3$resultMap,
          _ref3$results = _ref3.results,
          results = _ref3$results === undefined ? [] : _ref3$results;

      // Check if the texvaluet can be searched
      if (value === undefined || value === null) {
        return;
      }

      var exists = false;
      var averageScore = -1;
      var numTextMatches = 0;

      if (typeof value === 'string') {
        this._log('\nKey: ' + (key === '' ? '-' : key));

        var mainSearchResult = fullSearcher.search(value);
        this._log('Full text: "' + value + '", score: ' + mainSearchResult.score);

        if (this.options.tokenize) {
          var words = value.split(this.options.tokenSeparator);
          var scores = [];

          for (var i = 0; i < tokenSearchers.length; i += 1) {
            var tokenSearcher = tokenSearchers[i];

            this._log('\nPattern: "' + tokenSearcher.pattern + '"');

            // let tokenScores = []
            var hasMatchInText = false;

            for (var j = 0; j < words.length; j += 1) {
              var word = words[j];
              var tokenSearchResult = tokenSearcher.search(word);
              var obj = {};
              if (tokenSearchResult.isMatch) {
                obj[word] = tokenSearchResult.score;
                exists = true;
                hasMatchInText = true;
                scores.push(tokenSearchResult.score);
              } else {
                obj[word] = 1;
                if (!this.options.matchAllTokens) {
                  scores.push(1);
                }
              }
              this._log('Token: "' + word + '", score: ' + obj[word]);
              // tokenScores.push(obj)
            }

            if (hasMatchInText) {
              numTextMatches += 1;
            }
          }

          averageScore = scores[0];
          var scoresLen = scores.length;
          for (var _i2 = 1; _i2 < scoresLen; _i2 += 1) {
            averageScore += scores[_i2];
          }
          averageScore = averageScore / scoresLen;

          this._log('Token score average:', averageScore);
        }

        var finalScore = mainSearchResult.score;
        if (averageScore > -1) {
          finalScore = (finalScore + averageScore) / 2;
        }

        this._log('Score average:', finalScore);

        var checkTextMatches = this.options.tokenize && this.options.matchAllTokens ? numTextMatches >= tokenSearchers.length : true;

        this._log('\nCheck Matches: ' + checkTextMatches);

        // If a match is found, add the item to <rawResults>, including its score
        if ((exists || mainSearchResult.isMatch) && checkTextMatches) {
          // Check if the item already exists in our results
          var existingResult = resultMap[index];
          if (existingResult) {
            // Use the lowest score
            // existingResult.score, bitapResult.score
            existingResult.output.push({
              key: key,
              arrayIndex: arrayIndex,
              value: value,
              score: finalScore,
              matchedIndices: mainSearchResult.matchedIndices
            });
          } else {
            // Add it to the raw result list
            resultMap[index] = {
              item: record,
              output: [{
                key: key,
                arrayIndex: arrayIndex,
                value: value,
                score: finalScore,
                matchedIndices: mainSearchResult.matchedIndices
              }]
            };

            results.push(resultMap[index]);
          }
        }
      } else if (isArray(value)) {
        for (var _i3 = 0, len = value.length; _i3 < len; _i3 += 1) {
          this._analyze({
            key: key,
            arrayIndex: _i3,
            value: value[_i3],
            record: record,
            index: index
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }
      }
    }
  }, {
    key: '_computeScore',
    value: function _computeScore(weights, results) {
      this._log('\n\nComputing score:\n');

      for (var i = 0, len = results.length; i < len; i += 1) {
        var output = results[i].output;
        var scoreLen = output.length;

        var totalScore = 0;
        var bestScore = 1;

        for (var j = 0; j < scoreLen; j += 1) {
          var weight = weights ? weights[output[j].key].weight : 1;
          var score = weight === 1 ? output[j].score : output[j].score || 0.001;
          var nScore = score * weight;

          if (weight !== 1) {
            bestScore = Math.min(bestScore, nScore);
          } else {
            output[j].nScore = nScore;
            totalScore += nScore;
          }
        }

        results[i].score = bestScore === 1 ? totalScore / scoreLen : bestScore;

        this._log(results[i]);
      }
    }
  }, {
    key: '_sort',
    value: function _sort(results) {
      this._log('\n\nSorting....');
      results.sort(this.options.sortFn);
    }
  }, {
    key: '_format',
    value: function _format(results) {
      var finalOutput = [];

      this._log('\n\nOutput:\n\n', JSON.stringify(results));

      var transformers = [];

      if (this.options.includeMatches) {
        transformers.push(function (result, data) {
          var output = result.output;
          data.matches = [];

          for (var i = 0, len = output.length; i < len; i += 1) {
            var item = output[i];

            if (item.matchedIndices.length === 0) {
              continue;
            }

            var obj = {
              indices: item.matchedIndices,
              value: item.value
            };
            if (item.key) {
              obj.key = item.key;
            }
            if (item.hasOwnProperty('arrayIndex') && item.arrayIndex > -1) {
              obj.arrayIndex = item.arrayIndex;
            }
            data.matches.push(obj);
          }
        });
      }

      if (this.options.includeScore) {
        transformers.push(function (result, data) {
          data.score = result.score;
        });
      }

      for (var i = 0, len = results.length; i < len; i += 1) {
        var result = results[i];

        if (this.options.id) {
          result.item = this.options.getFn(result.item, this.options.id)[0];
        }

        if (!transformers.length) {
          finalOutput.push(result.item);
          continue;
        }

        var data = {
          item: result.item
        };

        for (var j = 0, _len2 = transformers.length; j < _len2; j += 1) {
          transformers[j](result, data);
        }

        finalOutput.push(data);
      }

      return finalOutput;
    }
  }, {
    key: '_log',
    value: function _log() {
      if (this.options.verbose) {
        var _console;

        (_console = console).log.apply(_console, arguments);
      }
    }
  }]);

  return Fuse;
}();

module.exports = Fuse;

/***/ })
/******/ ]);
});
//# sourceMappingURL=fuse.js.map

/***/ }),
/* 39 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    /**
     * Stores user search results for the server-users-supplier
     */
    // TODO CONFSRVDEV-2015 - shouldn't store the same User object more than once. Should only store lists of keys in the query map,
    // and then have a separate cross-supplier Map of User objects by key. dT
    var cache = {};
    var queries = [];

    exports.default = function (limit) {
        return {
            add: function add(query, users) {
                cache[query] = {
                    query: query,
                    users: users,
                    isExhausted: users.length < limit
                };

                // Queries list is alph sorted descending so that longer queries are above the shorter queries that
                // they contain.
                queries.push(query);
                queries.sort();
                queries.reverse();
            },

            /**
             * Look in the cache for this query or a shorter one.
             */
            getClosest: function getClosest(query) {
                if (cache[query]) {
                    return cache[query];
                }

                // Else find the longest matching substring of the query.
                // The query list is sorted, so the first item found should be the longest one.
                var queryMatch = queries.find(function (subquery) {
                    return query.indexOf(subquery) === 0;
                });
                if (queryMatch) {
                    return cache[queryMatch];
                }

                return null; // just to make this obvious...
            },

            // Used in tests.
            reset: function reset() {
                cache = {};
                queries = [];
            }
        };
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 40 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    function escape(query) {
        return [].map.call(query, function escapeSpecialCharacter(char) {
            if (char === '+' || char === '-' || char === '&' || char === '|' || char === '!' || char === '(' || char === ')' || char === '{' || char === '}' || char === '[' || char === ']' || char === '^' || char === '"' || char === '~' || char === '*' || char === '?' || char === ':' || char === '\\') return '\\' + char;
            return char;
        }).join('');
    }

    exports.default = {
        escape: escape
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 41 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _userSupplierKeys) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function getCurrentUser() {
        return new Promise(function (resolve) {

            var username = Meta.get('remote-user');
            if (!username) {
                // Anonymous user.
                return resolve();
            }

            var userKey = Meta.get('remote-user-key');
            var displayName = Meta.get('current-user-fullname');
            var path = Meta.get('current-user-avatar-uri-reference');

            resolve({
                type: "known",
                username: username,
                userKey: userKey,
                profilePicture: {
                    path: path,
                    width: 48,
                    height: 48
                },
                displayName: displayName,
                supplier: UserSupplier.CURRENT
            });
        });
    }

    exports.default = {
        getCurrentUser: getCurrentUser
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 42 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(16), __webpack_require__(43), __webpack_require__(12), __webpack_require__(44), __webpack_require__(15), __webpack_require__(46), __webpack_require__(47), __webpack_require__(48), __webpack_require__(17)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _templates, _resultPlaceholder, _userRanker, _userConverter, _utils, _defaultOrdering, _scoreLogger, _defaultFiltering, _scoreBooster) {
    'use strict';

    var Templates = _interopRequireDefault(_templates).default;

    var ResultPlaceholder = _interopRequireDefault(_resultPlaceholder).default;

    var SearchUsers = _interopRequireDefault(_userRanker).default;

    var ConvertUsers = _interopRequireDefault(_userConverter).default;

    var RenderUtils = _interopRequireDefault(_utils).default;

    var ensureDefaultOrder = _interopRequireDefault(_defaultOrdering).default;

    var scoreLogger = _interopRequireDefault(_scoreLogger).default;

    var filterServerResults = _interopRequireDefault(_defaultFiltering).default;

    var ScoreBooster = _interopRequireDefault(_scoreBooster).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict"; /**
                   * The contents of the UserCache is passed through the user pipeline which filters, ranks and modifies
                   * the list until we arrive at the final 5 elements to display.
                   *
                   * Want To add another function to the user pipeline? Easy...
                   *
                   * Define a function like the following and add it to a pipeline. Ordering is very important.
                   *
                   * @param results   The results array as supplied by the previous function
                   * @param next      Call this function and pass some results to trigger the next stage of the pipeline
                   * @param context   Some context about the current rendering request. See Mentions.js
                   *
                   * function pipelineTransformation(results, next, context) {
                   *      //Do some things on results
                   *      results.forEach((results) => transform(result))
                   *
                   *      //Remember to call next
                   *      next(results);
                   * }
                   */

    function filterUsingQuery(results, next, context) {
        next(SearchUsers(results, context.query));
    }

    function moveSelectedUserToTop(oldUsers, next, context) {
        if (!context.selectedUser) {
            return next(oldUsers);
        }

        var index = oldUsers.findIndex(function (user) {
            return user.username === context.selectedUser.username;
        });
        // Note that > -1 means that the user IS in the array. If index is 0, the user is already in the correct position
        // at the start of the array and there is nothing to do.
        if (index <= 0) {
            return next(oldUsers);
        }

        // Put this user at the start of the array.
        var user = oldUsers[index];
        var newUsers = oldUsers.slice(0); // clone the array to avoid modifying the original
        newUsers.splice(index, 1);
        newUsers.unshift(user);

        return next(newUsers);
    }

    /**
     * fuseScore is available on all user results for a query-term search, so we can sort at any point in the pipeline.
     */
    function sortOnScore(users, next) {
        if (users.length && typeof users[0].fuseScore === 'number') {
            // If the first result has a fuseScore they all will.
            users.sort(function (user1, user2) {
                return user1.fuseScore - user2.fuseScore;
            });
        }
        next(users);
    }

    function limit(array, next, context) {
        next(array.slice(0, context.DISPLAY_LIMIT));
    }

    // Called in the Server pipeline when there are no results.
    function userNotFound(results, next) {
        if (!results.length) {
            var notFoundResult = RenderUtils.resultWithHtml(Templates.Mentions.userNotFoundResult());
            results = [notFoundResult];
        }

        next(results);
    }

    function empty(results, next) {
        if (!results.length) {
            next([RenderUtils.resultWithHtml(Templates.Mentions.loadingPlaceholder())]);
        } else {
            next(results);
        }
    }

    function addErrorResult(results, next) {
        var failureResult = RenderUtils.resultWithHtml(Templates.Mentions.searchFailureResult());
        next([failureResult]);
    }

    /**
     * This function convert Users from API format to something that the Dropdown can display.
     *
     * All elements in the results array should be Users in API format.
     * If you want to add other elements to the results array, do this *after* convertUsers in the pipeline
     *
     * @param results
     * @param next
     */
    function convertUsers(results, next) {
        next(ConvertUsers(results));
    }

    // Don't continue the render if the query is stale.
    function staleServerResponseFilter(results, next, context) {
        if (context.latestQuery === context.query) {
            next(results);
        }
    }

    exports.default = {

        default: function _default(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, filterServerResults, ensureDefaultOrder, limit, ScoreBooster.setSuggestedUsers, convertUsers, renderCallback];
        },

        client: function client(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, filterUsingQuery, ScoreBooster.boostScores, sortOnScore, limit, moveSelectedUserToTop, convertUsers, ResultPlaceholder.startTimeout, empty, renderCallback];
        },
        server: function server(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, staleServerResponseFilter, filterUsingQuery, ScoreBooster.boostScores, sortOnScore, limit, moveSelectedUserToTop, scoreLogger, convertUsers, userNotFound, renderCallback];
        },

        error: function error(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, addErrorResult, renderCallback];
        },

        _functions: {
            moveSelectedUserToTop: moveSelectedUserToTop,
            sortOnScore: sortOnScore
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 43 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(15), __webpack_require__(16)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _utils, _templates) {
    'use strict';

    var RenderUtils = _interopRequireDefault(_utils).default;

    var Templates = _interopRequireDefault(_templates).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var displayTimeout = void 0;

    function _padResults(results, context) {
        var additionalElements = context.DISPLAY_LIMIT - results.length;
        if (additionalElements > 0) {
            var placeholder = RenderUtils.resultWithHtml(Templates.Mentions.loadingPlaceholder());
            for (var index = 0; index < additionalElements; index++) {
                results.push(placeholder);
            }
        }
        return results;
    }

    function startTimeout(results, next, context) {
        displayTimeout = setTimeout(function () {
            results = _padResults(results, context);
            next(results);
        }, window.skeletonPlaceholder || 3000); // CONFSRVDEV-3833 Remove once an appropriate value has been found.
        next(results);
    }

    function cancelTimeout(results, next) {
        clearTimeout(displayTimeout);
        next(results);
    }

    exports.default = {
        startTimeout: startTimeout,
        cancelTimeout: cancelTimeout
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 44 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(8), __webpack_require__(1), __webpack_require__(45)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _i18n, _userSupplierKeys, _darkFeatures) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var I18n = _interopRequireDefault(_i18n).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    var DarkFeatures = _interopRequireDefault(_darkFeatures).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Converts Users from API format to something that the Dropdown can display.
     */
    var contextPath = Meta.get('context-path');

    function getProfilePicture(user) {
        if (user && user.profilePicture && Meta.get('can-view-profile')) {
            // HACK - work around CONFSRVDEV-2936 by removing the dud context-path from the path.
            return user.profilePicture.path.replace('/_' + contextPath, '/_');
        }
        return contextPath + '/images/icons/profilepics/anonymous.svg';
    }

    var converter = function converter(users) {
        var addRecentLozenge = DarkFeatures.isEnabled('smart.mentions.recent.lozenge');
        var linkBase = Meta.get('base-url') + '/display/~';

        return users.map(function (user) {
            var link = linkBase + user.username;

            var lozenge = user.supplier === UserSupplier.RELATED && user.role && user.role.i18n;

            if (!lozenge && addRecentLozenge) {
                // Including a lozenge for Recent helps us see why an item is promoted, but make it opt-in.
                lozenge = user.supplier === UserSupplier.RECENT && I18n('user.supplier.recent');
            }
            // Uncomment this line to see why the results are in the order they are.
            // const lozenge = "" + user.fuseScore;

            return {
                className: 'insert-mentions-dropdown-option',
                name: user.displayName,
                username: user.username,
                href: link, // only used if the user tries to middle-click/open-in-new-tab the dropdown item
                icon: getProfilePicture(user),
                lozenge: lozenge,
                link: link,
                model: user,
                fuseMatches: user.fuseMatches
            };
        });
    };

    // Available for unit testing.
    converter._getProfilePicture = getProfilePicture;

    exports.default = converter;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 45 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_45__;

/***/ }),
/* 46 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(4)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _recentUsersSupplier) {
    "use strict";

    var RecentUsers = _interopRequireDefault(_recentUsersSupplier).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
        return typeof obj;
    } : function (obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };

    var supplierToScoreMap = {
        "current": 1,
        "recent": 2,
        "related": {
            "creator": 3,
            "contributor": 4,
            "commenter": 5
        },
        "server": 6
    };

    var MAX_SCORE = 100;

    function scoreUser(user) {
        var potentialScore = supplierToScoreMap[user.supplier];

        if (typeof potentialScore === "number") {
            if (typeof user.sortIndex === "number") {
                // This allows us to sort recent users coming out of the cache. The highest calculated score will be just < 3.
                potentialScore += user.sortIndex / (RecentUsers.RECENT_USER_LIMIT + 1);
            }
            return potentialScore;
        }

        // Not a number, probably another object, index into it with role
        // Otherwise, it might have been undefined
        return (typeof potentialScore === "undefined" ? "undefined" : _typeof(potentialScore)) === "object" ? potentialScore[user.role.role] : MAX_SCORE;
    }

    function ensureDefaultOrder(results, next) {
        var sorted = results.sort(function (user1, user2) {
            return scoreUser(user1) - scoreUser(user2);
        });
        next(sorted);
    }

    exports.default = ensureDefaultOrder;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 47 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs) {
    "use strict";

    exports.default = logScores;

    var AJS = _interopRequireDefault(_ajs).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * Just used during development, logs result score information to help us figure out reasons for result order.
     */
    function logScores(results, next, context) {
        if (context.query) {
            AJS.debug("*** Mentions *** user-pipeline/logger: Logging search results for " + context.query);

            results.forEach(function (user) {
                AJS.debug("*** Mentions *** user-pipeline/logger: " + user.displayName + " has a score of " + user.fuseScore);
            });
        }

        next(results);
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 48 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userSupplierKeys) {
    "use strict";

    var DEFAULT_SUPPLIERS = [_userSupplierKeys.RECENT, _userSupplierKeys.CURRENT, _userSupplierKeys.RELATED];

    function filterServerResults(results, next) {
        var filteredUsers = results.filter(function (user) {
            return DEFAULT_SUPPLIERS.indexOf(user.supplier) !== -1;
        });
        next(filteredUsers);
    }

    exports.default = filterServerResults;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 49 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    function PipelineExecutor(pipeline, context) {
        this.pipeline = pipeline;
        this.context = context;
    }

    PipelineExecutor.prototype.execute = function (input) {
        this._next(0, input);
    };

    PipelineExecutor.prototype._next = function (index, results) {
        this.pipeline[index](results, this._next.bind(this, index + 1), this.context);
    };

    exports.default = PipelineExecutor;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 50 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(51), __webpack_require__(18)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _analyticsSupport, _autocompleteManager) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Analytics = _interopRequireDefault(_analyticsSupport).default;

    var AutocompleteManager = _interopRequireDefault(_autocompleteManager).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function publishEventForSelection(user) {
        var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        var idd = typeof AutocompleteManager.getInputDrivenDropdown === 'function' && AutocompleteManager.getInputDrivenDropdown();
        if (!idd || !user) {
            AJS.debug("Cannot publish 'confluence.mention.selection' analytics with missing dropdown, user or context.");
            return;
        }

        var query = idd._value || '';
        var dd = idd.dd;
        var index = dd && typeof dd.getFocusIndex === 'function' && dd.getFocusIndex();

        var analyticsData = {
            source: user.model.supplier,
            queryLength: query.length,
            queryWords: query.split(' ').length,
            index: index,
            numberOfSearches: context.numGetDataAndRunCallbackCalls
        };

        // By publishing the supplier source of the selected User, we can determine whether users are finding
        // the users they need from the Smart mentions or whether they still have to wait for the Dumb (server)
        // ones.
        Analytics.publish('confluence.mention.selection', analyticsData);
        AJS.debug("Published 'confluence.mention.selection' event with supplier: " + user.model.supplier);
    }

    /**
     * Updates the state of the current Mention interaction.
     * @param autoCompleteControl
     */
    function updateSession(autoCompleteControl) {
        autoCompleteControl.analytics = Object.assign({
            numGetDataAndRunCallbackCalls: 0
        }, autoCompleteControl.analytics);

        autoCompleteControl.analytics.numGetDataAndRunCallbackCalls += 1;
    }

    exports.default = {
        updateSession: updateSession,
        publishEventForSelection: publishEventForSelection
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 51 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_51__;

/***/ }),
/* 52 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_52__;

/***/ }),
/* 53 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_53__;

/***/ })
/******/ ])});;
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = '/js/smart-mentions-init.js' */
require([
    'confluence-editor/loader/tinymce-bootstrap',
    'confluence-mentions'
], function (BootstrapManager,
             Mentions) {
    // Main entry point to Smart Mentions logic. To lower page weight, we could potentially pull in the Mentions
    // bundle.js via a WRM.require on the bootstrap init.
    BootstrapManager.addOnInitCallback(Mentions.init);
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-fixed-headers:confluence-fixed-headers-editor-resources', location = '/js/slow-edit-handler.js' */
require(["confluence/fh/utils/dom","ajs"],function(c,a){a.toInit(function(){var b=a.Meta.get("browse-page-tree-mode");if("create"===b||"edit"===b)c.addClassToPage(),$("#content").css({paddingRight:0})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.share-page:edit-resources', location = 'js/edit-init.js' */
require(["ajs","confluence/meta","confluence/share-page/service/share-page","confluence/share-page/service/share-dialog-loader","confluence/dark-features"],function(a,b,k,l,m){function g(){if("page"===b.get("content-type")||"blogpost"===b.get("content-type")){var c=a.$;if(m.isEnabled("react.share.dialog")){var h=c("\x3cdiv\x3e").addClass("invite-to-edit-container").tooltip({title:function(){return "\u9080\u8bf7\u6210\u5458\u548c\u60a8\u4e00\u8d77\u7f16\u8f91"},gravity:"ne"});h.append(c("\x3cspan\x3e").attr("id",
"share-react-link"));c("#rte-toolbar").prepend(h);l.init("share-react-link","edit")}else{c("#rte-toolbar").prepend(c(document.createElement("div")).prop("id","#inviteToEditLink".replace("#","")).addClass("aui-button").addClass("invite-to-edit-button").html('\x3cspan class\x3d"invite-plus-icon"\x3e\x3c/span\x3e').tooltip({title:function(){return "\u9080\u8bf7\u6210\u5458\u548c\u60a8\u4e00\u8d77\u7f16\u8f91"},gravity:"ne"}));var e=c("#inviteToEditLink");c="page"===b.get("content-type")?"\u8ba9\u6211\u4eec\u4e00\u8d77\u5b8c\u6210\u6b64\u9875\u9762":
"\u8ba9\u6211\u4eec\u4e00\u8d77\u5b8c\u6210\u6b64\u535a\u5ba2";k.initDialog("#inviteToEditLink","inviteToEditPopup",{},{heading:"\u9080\u8bf7\u6210\u5458\u7f16\u8f91",notePlaceholder:c,link:function(){return require("confluence/share-page/fetch/content-info")(b.get("content-id"),"draft").pipe(function(d){return b.get("base-url")+d._links.edit})},entityId:function(){return b.get("draft-id")},restriction:function(){return require("confluence/share-page/fetch/content-restrictions")(b.get("content-id")).pipe(function(d){var f=
{};if(d.read.restrictions.user.size||d.read.restrictions.group.size||d.update.restrictions.user.size||d.update.restrictions.group.size)f.type="restrict",f.message="\u6b64\u9875\u9762\u7684\u9650\u5236\u53ef\u4ee5\u9632\u6b62\u6210\u5458\u67e5\u770b\u6216\u7f16\u8f91\u3002";return f})},copyOption:"invite",shareType:"edit",contentType:b.get("content-type"),errorText:"\u53d1\u751f\u610f\u5916\u9519\u8bef\u3002\u8bf7\u91cd\u8bd5\u3002",beforeLoad:function(){e.find(".invite-plus-icon").css("visibility","hidden");e.spin()},afterLoad:function(){e.find(".invite-plus-icon").css("visibility","visible");
e.spinStop()}})}}}"collaborative"===b.get("edit-mode")&&b.get("remote-user")&&(a.Rte.getEditor()&&a.Rte.getEditor().initialized?g():a.bind("rte-collab-ready",g))});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.deprecated.pattern.toolbar1', location = 'aui.chunk.2e5a57e4e871239c85ed--04322bc020cb0bd3caaf.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.deprecated.pattern.toolbar1"],{DHJP:function(i,n,t){"use strict";t.r(n)}},[["DHJP","runtime"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.keyboardshortcuts:confluence-tinymce-keyboard-shortcuts', location = 'js/tinymce-plugin.js' */
define("confluence-keyboard-shortcuts/tinymce-plugin",["ajs","confluence-keyboard-shortcuts/confluence-keyboard-shortcuts"],function(e,b){return{init:function(a){e.debug("Init Editor Keyboard shortcuts plugin");for(var c=function(b){return function(){a.execCommand("FormatBlock",!1,b)}},d=1;7>d;d++)a.addCommand("FormatBlock-h"+d,c("h"+d));a.addCommand("FormatBlock-p",c("p"));a.addCommand("FormatBlock-pre",c("pre"));a.addCommand("FormatBlock-blockquote",c("blockquote"));a.addCommand("mceConfShortcutDialog",
b.keyboardShortcuts.openDialog);a.ui.registry.addButton("help",{text:"confluence.conf_shortcuts_help_desc",onAction:function(){a.execCommand("mceConfShortcutDialog")}})},getInfo:function(){var a=require("tinymce");return{longname:"Atlassian Editor Keyboard Shortcuts Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-keyboard-shortcuts/tinymce-plugin",function(e){var b=require("tinymce");b.create("tinymce.plugins.KeyboardShortcutsPlugin",e);b.PluginManager.add("keyboardshortcuts",b.plugins.KeyboardShortcutsPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/vendor/jquery.stickytableheaders.js' */
/*
 Modified by Atlassian | Copyright (c) 2011 by Jonas Mosbech - https://github.com/jmosbech/StickyTableHeaders
 MIT license info: https://github.com/jmosbech/StickyTableHeaders/blob/master/license.txt */
(function(d,l,t){function p(g,k){var a=this;a.$el=d(g);a.el=g;a.id=q++;a.$el.bind("destroyed",d.proxy(a.teardown,a));a.$clonedHeader=null;a.$originalHeader=null;a.cachedHeaderHeight=null;a.isSticky=!1;a.hasBeenSticky=!1;a.leftOffset=null;a.topOffset=null;a.init=function(){a.setOptions(k);a.$el.each(function(){var c=d(this);c.css("padding",0);a.$originalHeader=d("thead:first",this);a.$clonedHeader=a.$originalHeader.clone();c.trigger("clonedHeader.stickyTableHeaders",[a.$clonedHeader]);a.$clonedHeader.addClass("tableFloatingHeader");
a.$clonedHeader.css("display","none");a.$originalHeader.addClass("tableFloatingHeaderOriginal");a.$originalHeader.after(a.$clonedHeader);a.$printStyle=d('\x3cstyle type\x3d"text/css" media\x3d"print"\x3e.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}\x3c/style\x3e');a.$head.append(a.$printStyle)});a.updateWidth();a.toggleHeaders();a.bind()};a.destroy=function(){a.$el.unbind("destroyed",a.teardown);a.teardown()};a.teardown=function(){a.isSticky&&
a.$originalHeader.css("position","static");d.removeData(a.el,"plugin_stickyTableHeaders");a.unbind();a.$clonedHeader.remove();a.$originalHeader.removeClass("tableFloatingHeaderOriginal");a.$originalHeader.css("visibility","visible");a.$printStyle.remove();a.el=null;a.$el=null};a.bind=function(){a.$scrollableArea.on("scroll.stickyTableHeaders",a.toggleHeaders);a.isWindowScrolling||(a.$window.on("scroll.stickyTableHeaders"+a.id,a.setPositionValues),a.$window.on("resize.stickyTableHeaders"+a.id,a.toggleHeaders));
a.$scrollableArea.on("resize.stickyTableHeaders",a.toggleHeaders);a.$scrollableArea.on("resize.stickyTableHeaders",a.updateWidth)};a.unbind=function(){a.$scrollableArea.off(".stickyTableHeaders",a.toggleHeaders);a.isWindowScrolling||(a.$window.off(".stickyTableHeaders"+a.id,a.setPositionValues),a.$window.off(".stickyTableHeaders"+a.id,a.toggleHeaders));a.$scrollableArea.off(".stickyTableHeaders",a.updateWidth)};a.debounce=function(c,e){var f=null;return function(){var b=this,h=arguments;clearTimeout(f);
f=setTimeout(function(){c.apply(b,h)},e)}};a.toggleHeaders=a.debounce(function(){a.$el&&a.$el.each(function(){var c=d(this),e=a.isWindowScrolling?isNaN(a.options.fixedOffset)?a.options.fixedOffset.outerHeight():a.options.fixedOffset:a.$scrollableArea.offset().top+(isNaN(a.options.fixedOffset)?0:a.options.fixedOffset);var f=c.offset();var b=a.$scrollableArea.scrollTop()+e,h=a.$scrollableArea.scrollLeft(),m=a.options.cacheHeaderHeight?a.cachedHeaderHeight:a.$clonedHeader.height(),n=a.isWindowScrolling?
b>f.top:e>f.top;b=(a.isWindowScrolling?b:0)<f.top+c.height()-m-(a.isWindowScrolling?0:e);n&&b?(f=f.left-h+a.options.leftOffset,a.$originalHeader.css({position:"fixed","margin-top":a.options.marginTop,left:f,"z-index":3}),a.leftOffset=f,a.topOffset=e,a.$clonedHeader.css("display",""),a.isSticky||(a.isSticky=!0,a.updateWidth(),c.trigger("enabledStickiness.stickyTableHeaders")),a.setPositionValues()):a.isSticky&&(a.$originalHeader.css("position","static"),a.$clonedHeader.css("display","none"),a.isSticky=
!1,a.resetWidth(d("td,th",a.$clonedHeader),d("td,th",a.$originalHeader)),c.trigger("disabledStickiness.stickyTableHeaders"))})},0);a.setPositionValues=a.debounce(function(){var c=a.$window.scrollTop(),e=a.$window.scrollLeft();!a.isSticky||0>c||c+a.$window.height()>a.$document.height()||0>e||e+a.$window.width()>a.$document.width()||a.$originalHeader.css({top:a.topOffset-(a.isWindowScrolling?0:c),left:a.leftOffset-(a.isWindowScrolling?0:e)})},0);a.updateWidth=a.debounce(function(){if(a.isSticky){a.$originalHeaderCells||
(a.$originalHeaderCells=d("th,td",a.$originalHeader));a.$clonedHeaderCells||(a.$clonedHeaderCells=d("th,td",a.$clonedHeader));var c=a.getWidth(a.$clonedHeaderCells);a.setWidth(c,a.$clonedHeaderCells,a.$originalHeaderCells);a.$originalHeader.css("width",a.$clonedHeader.width());a.options.cacheHeaderHeight&&(a.cachedHeaderHeight=a.$clonedHeader.height())}},0);a.getWidth=function(c){var e=[];c.each(function(f){var b=d(this);if("border-box"===b.css("box-sizing"))b=b[0].getBoundingClientRect(),b=b.width?
b.width:b.right-b.left;else if("collapse"===d("th",a.$originalHeader).css("border-collapse"))if(l.getComputedStyle)b=parseFloat(l.getComputedStyle(this,null).width);else{var h=parseFloat(b.css("padding-left")),m=parseFloat(b.css("padding-right")),n=parseFloat(b.css("border-width"));b=b.outerWidth()-h-m-n}else b=b.width();e[f]=b});return e};a.setWidth=function(c,e,f){e.each(function(b){var h=c[b];f.eq(b).css({"min-width":h,"max-width":h})})};a.resetWidth=function(c,e){c.each(function(f){var b=d(this);
e.eq(f).css({"min-width":b.css("min-width"),"max-width":b.css("max-width")})})};a.setOptions=function(c){a.options=d.extend({},r,c);a.$window=d(a.options.objWindow);a.$head=d(a.options.objHead);a.$document=d(a.options.objDocument);a.$scrollableArea=d(a.options.scrollableArea);a.isWindowScrolling=a.$scrollableArea[0]===a.$window[0]};a.updateOptions=function(c){a.setOptions(c);a.unbind();a.bind();a.updateWidth();a.toggleHeaders()};a.init()}var q=0,r={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:document,
objHead:"head",objWindow:l,scrollableArea:l,cacheHeaderHeight:!1};d.fn.stickyTableHeaders=function(g){return this.each(function(){var k=d.data(this,"plugin_stickyTableHeaders");k?"string"===typeof g?k[g].apply(k):k.updateOptions(g):"destroy"!==g&&d.data(this,"plugin_stickyTableHeaders",new p(this,g))})}})(jQuery,window);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/utils.js' */
define("sticky-table-headers/utils",["jquery"],function(d){var e=function(){return!d("body").hasClass("theme-documentation")};return{isAValidTable:function(a){a=d(a);var b;if(b=e()&&!a.hasClass("stickyTableHeaders")&&0< !a.closest(".columnLayout").length&&0< !a.parents("table").length&&a.find("\x3e thead:first").is(":visible")&&1===a.find("thead").children().length&&1===a.find(".confluenceTh").parent().length)b=0===a.find(".confluenceTh").siblings().length||0===a.find(".confluenceTh").siblings().not(".confluenceTh").length;
return b},bindHorizontalScrolling:function(a,b){var c=b||d(window);a.closest(".table-wrap").scroll(function(){c.trigger("scroll.stickyTableHeaders")})},moveHeaderRowsToTHead:function(a){d(a).each(function(){var b=d(this);if(!(0<b.find("\x3e thead").length)){var c=b.find("\x3e tbody \x3e :first-child \x3e :first-child.confluenceTh");!(0>=c.length||0<c.parent().find("\x3e .confluenceTh[rowspan]").length)&&0< !b.parents("table").length&&0< !b.closest(".columnLayout").length&&(c=d("\x3cthead /\x3e").append(c.parent()),
b.prepend(c))}})},isNotDocumentationTheme:e}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/viewpage.js' */
define("sticky-table-headers/viewpage",["jquery","ajs","sticky-table-headers/utils"],function(c,l,d){var e,h,f,n=function(a,b){a=c(a).filter(function(){return d.isAValidTable(this)});a.stickyTableHeaders(b).addClass("stickyTableHeaders");f?f.add(a):f=a;b=function(m,g){f.stickyTableHeaders(g)};h&&l.unbind("sticky-table-headers.change.options",h);l.bind("sticky-table-headers.change.options",b);h=b;d.bindHorizontalScrolling(a)};return{initialize:function(){var a=c(".confluenceTable:not(.stickyTableHeaders)"),
b=c(window);if(d.isNotDocumentationTheme()){d.moveHeaderRowsToTHead(a);if(window.MutationObserver){a=document.querySelector("#page")||document.querySelector("#confluence-ui");var m=/sticky|tableFloating|confluenceTh/,g=new MutationObserver(c.debounce(function(p){for(var q=!1,r,k=0,t=p.length;k<t;k++)if(r=p[k].target.className,!m.test(r)){q=!0;break}q&&b.trigger("resize.stickyTableHeaders")},0));e&&e.unobserve&&e.unobserve();g.observe(a,{subtree:!0,attributes:!0,childList:!0});e=g}n(c(".confluenceTable"),
{cacheHeaderHeight:!0})}},setupTable:n}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/editor.js' */
define("sticky-table-headers/editor",["ajs","jquery","sticky-table-headers/utils"],function(f,c,e){var h=function(a){var b={};b.objWindow=c(a.getWin());b.scrollableArea=b.objWindow;b.objDocument=c(a.getDoc());b.objHead=b.objDocument.find("head");return b},g=function(a,b){var d=f.Rte.getEditor();d&&(d=h(d),b=c.extend({},d,b),a=c(a).filter(function(){return e.isAValidTable(this)}),a.stickyTableHeaders(b).addClass("stickyTableHeaders"),e.bindHorizontalScrolling(a,b.objWindow))};return{initialize:function(){var a=
f.Rte.getEditor();a&&(a=c(a.getBody()).find(".confluenceTable"),e.moveHeaderRowsToTHead(a),g(a))},setupTable:g}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/stickytableheaders.js' */
define("sticky-table-headers",["ajs","sticky-table-headers/viewpage","sticky-table-headers/editor","jquery"],function(a,c,b,d){var e=a.debounce(c.initialize,0);return{initialize:function(){a.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers.disabled")||d(function(){e()});a.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers-editor")&&(a.bind("rte-ready",b.initialize),a.bind("rte-quick-edit-push-state",b.initialize),a.bind("rte-quick-edit-push-hash",b.initialize))}}});
require("sticky-table-headers").initialize();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.image.effects.ImageEffectsPlugin:propertiespanel', location = 'com/atlassian/confluence/image/effects/property-panel.js' */
AJS.toInit(function(e){function u(){AJS.bind("dialog-created.image-properties",function(a,c){d=c.img;n()?d.naturalHeight&&d.naturalWidth&&16E6<d.naturalHeight*d.naturalWidth?Confluence.Editor.ImageProps.registerPanel("image-effects",k("\u8be5\u56fe\u7247\u592a\u5927\uff0c\u65e0\u6cd5\u65cb\u8f6c\u6216\u5e94\u7528\u56fe\u50cf\u6548\u679c\u3002\u60a8\u9700\u8981\u4e0a\u4f20\u4e00\u4e2a\u8f83\u5c0f\u7248\u672c\u7684\u6587\u4ef6\u3002"),"image-effects-panel",null):Confluence.Editor.ImageProps.registerPanel("image-effects",k(),"image-effects-panel",v):Confluence.Editor.ImageProps.registerPanel("image-effects",k("\u56fe\u7247\u6548\u679c\u4e0d\u80fd\u5e94\u7528\u4e8eweb\u56fe\u7247"),
"image-effects-panel",null)});AJS.bind("dialog-before-show.image-properties",function(){p();q(l(e(d)))})}function w(){var a=new AJS.Dialog({width:600,height:500,id:"image-effects-dialog"});a.addHeader("\u589e\u52a0\u56fe\u7247\u6548\u679c");a.addPanel("",k(),"");p();a.addSubmit("\u4fdd\u5b58",function(){r(x,y).done(function(){a.hide()})});a.addCancel("\u5173\u95ed",function(){a.hide()});AJS.Confluence.PropertyPanel.Image.pluginButtons.push(null,
{create:function(c){d=c[0];c=l(c);var b=!n();return{className:"image-effects",text:"\u6548\u679c...",tooltip:b?"\u56fe\u7247\u6548\u679c\u4e0d\u80fd\u5e94\u7528\u4e8eweb\u56fe\u7247":"\u6dfb\u52a0\u56fe\u7247\u7684\u6548\u679c\u5982\u9634\u5f71\u6216\u56fe\u7247\u8fb9\u6846",click:function(){if(d.naturalHeight&&d.naturalWidth&&16E6<d.naturalHeight*d.naturalWidth)return alert("\u8be5\u56fe\u7247\u592a\u5927\uff0c\u65e0\u6cd5\u65cb\u8f6c\u6216\u5e94\u7528\u56fe\u50cf\u6548\u679c\u3002\u60a8\u9700\u8981\u4e0a\u4f20\u4e00\u4e2a\u8f83\u5c0f\u7248\u672c\u7684\u6587\u4ef6\u3002"),!1;q(l(e(d)));AJS.Confluence.PropertyPanel.destroy();a.show()},disabled:b,selected:!!c}}})}function z(a,
c){var b=a.attr("src"),f=A.exec(b),h=c?"effects\x3d"+c:"";f?b=b.replace(f[2],h):c&&(b=b+(-1!=b.indexOf("?")?"\x26":"?")+h);a.attr("src",b);a.attr("data-mce-src",b);c=(c=a.attr("confluence-query-params"))?(f=t.exec(c))?c.replace(f[2],h):c+"\x26"+h:h;a.attr("confluence-query-params",c)}function l(a){a=a.attr("confluence-query-params");if(a=t.exec(a))return a[3]}function q(a){e(".image-effect-preview.selected").removeClass("selected");a?e(g).each(function(c,b){if(b.effects==a)return e(e(".image-effect-preview")[c]).addClass("selected"),
!1}):e(".image-effect-preview.image-effect-none").addClass("selected");m=a}function k(a){return a?'\x3cdiv class\x3d"aui-message aui-message-warning warning"\x3e\x3cspan class\x3d"aui-icon icon-warning"\x3e\x3c/span\x3e'+a+"\x3c/div\x3e":'\x3cdiv class\x3d"image-effects"\x3e\x3cul class\x3d"image-list"\x3e\x3c/ul\x3e\x3c/div\x3e'}function p(){for(var a=e("div.image-effects ul.image-list"),c=Math.floor(22*Math.random())+1,b=0;b<g.length;b++){var f=e('\x3cli class\x3d"attached-image image-effect-preview'+
(g[b].effects?"":" image-effect-none")+'"\x3e\x3cdiv class\x3d"image-container"\x3e\x3cimg class\x3d"thumbnail" src\x3d"'+AJS.contextPath()+"/plugins/servlet/imgFilter.png?preview\x3dtrue\x26id\x3d"+c+"\x26effects\x3d"+g[b].effects+'" title\x3d"'+g[b].name+'" style\x3d"margin-top: 5px"\x3e\x3c/div\x3e\x3cspan class\x3d"caption filename" title\x3d"'+g[b].name+'"\x3e'+g[b].name+"\x3c/span\x3e\x3c/li\x3e");f.hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")});a.append(f);
f.click(g[b],function(h){e(".image-effect-preview.selected").removeClass("selected");e(this).addClass("selected");m=h.data.effects})}}function n(){return!e(d).hasClass("confluence-external-resource")}function v(){return r()}function r(a,c){function b(){c&&c();f.resolve();d.onload=null;tinyMCE.activeEditor.undoManager.add()}var f=e.Deferred();a&&a();d.onload=b;a=d.src;z(e(d),m);d.src==a&&b();return f}function x(){var a=dialog.popup.element,c=650/60,b=e('\x3cdiv class\x3d"image-properties-loading-blanket"\x3e\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e\x3c/div\x3e').appendTo(a.find(".dialog-page-body")),
f=b.find(".loading-data");b.css({width:b.parent().width(),height:a.height()});f.css({marginTop:-60,marginLeft:-60});f.spin({color:"#666",width:c,radius:25,length:25,top:0,left:0,zIndex:0,speed:1.042})}function y(){var a=dialog.popup.element.find(".image-properties-loading-blanket .loading-data");a.css({marginTop:"",marginLeft:""});a.spinStop();a.closest(".image-properties-loading-blanket").remove()}var d,A=/(\?|&)(effects=[^&]+)($|&)/,t=/(^|&)(effects=([^&]+))($|&)/,m=null,g=[];g.push({name:"\u65e0",
effects:null});g.push({name:"\u5e26\u8d34",effects:"border-simple,blur-border,tape"});g.push({name:"\u62cd\u7acb\u5f97",effects:"border-polaroid,blur-border"});g.push({name:"\u5377\u66f2\u9634\u5f71",effects:"border-simple,shadow-kn"});g.push({name:"\u5feb\u7167",effects:"border-simple,blur-border"});g.push({name:"\u9634\u5f71",effects:"drop-shadow"});Confluence.Editor.ImageProps?
u():w()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-browser-metrics:editor', location = '/js/editor.js' */
require(["internal/browser-metrics","jquery"],function(a,e){e(function(){var c=AJS.Meta.get("content-type"),d=AJS.Meta.getBoolean("new-page")?"create":"edit",f=e("body");if((f.hasClass("edit")||f.hasClass("create"))&&c&&d)if(AJS.Meta.getBoolean("collaborative-content")){var b="confluence."+c+"."+d+".collaborative.view";a.start({key:b,isInitial:!0});AJS.bind("rte-collab-ready",function(){a.end({key:b});a.start({key:b+".connected"})});AJS.bind("synchrony.connected",function(){a.end({key:b+".connected"})})}else AJS.Meta.getBoolean("collaborative-content")||
a.start({key:"confluence."+c+"."+d+".view",ready:".active-richtext",isInitial:!0})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:latexmath-js-helpers', location = '/js/latexmath-helpers.js' */
/*
Copyright (c) 2022 Appfire Technologies, LLC.
All rights reserved.

This software is licensed under the provisions of the "Appfire EULA"
(https://appfire.com/eula/) as well as under the provisions of
the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
(http://www.atlassian.com/licensing/marketplace/termsofuse).
See the LICENSE file for more details.
*/
(function($) {
    window.latexmathHelpers = {
        createCookie: createCookie,
        readCookie: readCookie,
        eraseCookie: eraseCookie,
        doVerticalAlign: doVerticalAlign,
        encodeLatex: encodeLatex,
        decodeLatex: decodeLatex,
        escapeHtml: escapeHtml
    };

    function createCookie(name,value,days) {
        var expires;
        if (days) {
            var date = new Date();
            date.setTime(date.getTime()+(days*24*60*60*1000));
            expires = "; expires=" + date.toUTCString();
        }
        else expires = "";
        document.cookie = name+"="+value+expires+"; path=/";
    }

    function readCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for(var i=0;i < ca.length;i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
        }
        return null;
    }

    //noinspection JSUnusedLocalSymbols
    function eraseCookie(name) {
        createCookie(name,"",-1);
    }

    var re = new RegExp("vertAlign=(-?\\d+(?:\\.\\d+)?)([pe]x)");

    function doVerticalAlign() {
        var vals = re.exec($(this).attr("src"));
        if (vals && vals.length > 0) {
            var distance = parseInt(vals[1]);

            if (distance && vals[2] == 'px' && distance < this.naturalHeight) {
                $(this).css('vertical-align', ""+(parseInt(vals[1])-1)+vals[2]);
            }
        }
    }

    var encodingKey = '--uriencoded--';
    function encodeLatex(latex) {
      var encoded = latex.replace(/%/g, '%25').replace(/\^/g, '%5e').replace(/{/g, '%7B').replace(/}/g, '%7D').replace(/\|/g, '%7C');
      return encoded !== latex ? encodingKey+encoded : latex;
    }

    function decodeLatex(latex) {
      if (latex && latex.slice(0, encodingKey.length) === encodingKey) {
        return decodeURIComponent(latex.slice(encodingKey.length));
      } else {
        return latex;
      }
    }

    var entities = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '\'': '&#39;',
        '"': '&quot;'
    };

    function escapeHtml(str) {
        if (str == null) {
            return str;
        }
        if (str.isHtml) {
            return '' + str;
        }
        return ('' + str).replace(/[&<>'"]/g, function(c) { return entities[c] || c; });
    }
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.pattern.icon', location = 'aui.chunk.cd632ae6195f5d08d4f7--3e38ec8cd250cae67657.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.pattern.icon"],[],[["YQ7q","runtime","aui.splitchunk.d7c46c2734"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.pattern.forms', location = 'aui.chunk.e8201091f7ea659abf44--3ff13660a8a60a0c4009.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.pattern.forms"],[],[["6fSn","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.d7c46c2734","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.908fe798b4","aui.splitchunk.462ee5f9ef","aui.splitchunk.26116b3cbd","aui.splitchunk.50dca3e042"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.4331a05956', location = 'aui.chunk.fb9e4cfe5e93e16ac212--ce86d6464bfef27305b4.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.4331a05956"],{LTUc:function(n,i,u){"use strict";u.r(i),u.d(i,"INPUT_SUFFIX",(function(){return t}));const t="-input"}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form.toggle', location = 'aui.chunk.275e02295fc51983c0df--f855e4e8115e84846c98.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form.toggle"],{KKmC:function(e,t,i){"use strict";i.r(t),i.d(t,"ToggleEl",(function(){return L}));i("6fSn"),i("eSvk"),i("oSOL"),i("XphB");var n=i("+x/D"),u=i("kdZR"),a=i("cWqH"),c=i("fVKi"),s=i("+ay7"),l=i("gjsO"),o=i.n(l),r=i("4dFR"),d=i("LTUc"),f=i("P3rJ"),h=i("tYoR"),b=i("HH5i");function p(e){return e._input||(e._input=e.querySelector("input"))}function k(e){return e._spinner||(e._spinner=new h.default)}function v(e,t){p(t).removeAttribute(e)}function g(e,t,i){p(t).setAttribute(e,i.newValue)}function m(e){return{removed:v.bind(this,e),fallback:g.bind(this,e)}}const A={removed:function(e){v.call(this,"form",e),e._formId=null},fallback:function(e,t){g.call(this,"form",e,t),e._formId=t.newValue}};var y={removed:v.bind(void 0,"id"),fallback:function(e,t){const i="".concat(t.newValue).concat(d.INPUT_SUFFIX);p(e).setAttribute("id",i)}},w={removed:function(e){v.call(this,"value",e),p(e).value="on"},fallback:function(e,t){g.call(this,"value",e,t)}},_={removed:function(e){p(e).checked=!1},fallback:function(e){p(e).checked=!0}},E={removed:function(e){p(e).removeAttribute("aria-label")},fallback:function(e,t){p(e).setAttribute("aria-label",t.newValue)}};var L=Object(r.default)("aui-toggle",{template:o()('<input type="checkbox" class="aui-toggle-input assistive">','<span class="aui-toggle-view">','<span class="aui-toggle-tick aui-icon aui-icon-small aui-iconfont-success"></span>','<span class="aui-toggle-cross aui-icon aui-icon-small aui-iconfont-close-dialog"></span>',"</span>"),created:function(e){p(e),k(e).setAttribute("size",h.SIZE.SMALL.name),Object(n.default)(p(e)).tooltip({title:function(){return this.checked?this.getAttribute("tooltip-on"):this.getAttribute("tooltip-off")},gravity:"s",hoverable:!1}),function(e){p(e).addEventListener("keydown",(function(t){e.busy&&t.keyCode===s.default.SPACE&&t.preventDefault()})),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&p(e).addEventListener("click",(function(t){e.busy&&t.preventDefault()})),Object(a.supportsFocusWithin)()||(e._input.addEventListener("focus",(()=>e.classList.add("active"))),e._input.addEventListener("blur",(()=>e.classList.remove("active"))))}(e),e.hasAttribute("checked")&&p(e).setAttribute("checked",""),e._canFireEventsNow=!0},attached:function(e){Object(c.default)(e).attributeExists("label")},events:{click:function(e,t){var i=p(e);e.disabled||e.busy||t.target===i||(i.checked=!i.checked,function(e){e._canFireEventsNow&&e.dispatchEvent(new f.default("change",{bubbles:!0}))}(e)),Object(u.setBooleanAttribute)(e,"checked",i.checked)}},attributes:{id:y,checked:_,disabled:m("disabled"),form:A,name:m("name"),value:w,"tooltip-on":{value:"\u5f00",fallback:function(e,t){p(e).setAttribute("tooltip-on",t.newValue||"\u5f00")}},"tooltip-off":{value:"\u5173",fallback:function(e,t){p(e).setAttribute("tooltip-off",t.newValue||"\u5173")}},label:E},prototype:{focus:function(){return p(this).focus(),this},get checked(){return p(this).checked},set checked(e){p(this).checked!==e&&(p(this).checked=e,Object(u.setBooleanAttribute)(this,"checked",e))},get disabled(){return p(this).disabled},set disabled(e){return Object(u.setBooleanAttribute)(this,"disabled",e)},get form(){return document.getElementById(this._formId)},set form(e){return A.fallback.call(this,this,{newValue:e||null}),this.form},get name(){return p(this).name},set name(e){return this.setAttribute("name",e),e},get value(){return p(this).value},set value(e){let t=null===e?"":e;return this.setAttribute("value",t),t},get busy(){return"true"===p(this).getAttribute("aria-busy")},set busy(e){const t=p(this),i=k(this);var a,c;return Object(u.setBooleanAttribute)(this,"busy",e),e?(t.setAttribute("aria-busy","true"),t.indeterminate=!0,this.checked?(t.classList.add("indeterminate-checked"),Object(n.default)(this.querySelector(".aui-toggle-tick")).append(i)):Object(n.default)(this.querySelector(".aui-toggle-cross")).append(i)):(t.classList.remove("indeterminate-checked"),t.indeterminate=!1,t.removeAttribute("aria-busy"),i.parentNode&&i.parentNode.removeChild(this._spinner)),c=!!e,(a=this).id&&Array.prototype.forEach.call(document.querySelectorAll('aui-label[for="'.concat(a.id,'"]')),(function(e){e.disabled=c})),e}}})}},[["KKmC","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.vendors--d2297af84a","aui.splitchunk.vendors--be1eb78c1a","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.dd803a46b4","aui.splitchunk.994e478d48","aui.splitchunk.d7c46c2734","aui.splitchunk.e54c7c7304","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.f1e06f97a4","aui.splitchunk.479fe6ee76","aui.splitchunk.9c48cc20a9","aui.splitchunk.908fe798b4","aui.splitchunk.5f851f97df","aui.splitchunk.462ee5f9ef","aui.splitchunk.afa5039e04","aui.splitchunk.26116b3cbd","aui.splitchunk.ed86a19e01","aui.splitchunk.50dca3e042","aui.splitchunk.e5af17b48e","aui.splitchunk.be1eb78c1a","aui.splitchunk.5b7fdbd666","aui.splitchunk.8a641c03a4","aui.splitchunk.86ad04cc86","aui.splitchunk.57d1ac075f","aui.splitchunk.4331a05956"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-vertical-align.js' */
/*
Copyright (c) 2022 Appfire Technologies, LLC.
All rights reserved.

This software is licensed under the provisions of the "Appfire EULA"
(https://appfire.com/eula/) as well as under the provisions of
the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
(http://www.atlassian.com/licensing/marketplace/termsofuse).
See the LICENSE file for more details.
*/
/*********************************************************
 * Vertically align placeholders
 */
(function($) {
    function doVerticalAlignAll() {
        var editorIframe = $("#wysiwygTextarea_ifr");
        editorIframe.contents().find("img[data-macro-name=mathinline]").each(latexmathHelpers.doVerticalAlign);
        editorIframe.contents().find("img[data-macro-name=unit]").each(latexmathHelpers.doVerticalAlign);
    }

    AJS.bind("init.rte", function() {
        setTimeout(doVerticalAlignAll, 500);
        setInterval(doVerticalAlignAll, 5000);
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-dedup-anchors.js' */
/*
Copyright (c) 2022 Appfire Technologies, LLC.
All rights reserved.

This software is licensed under the provisions of the "Appfire EULA"
(https://appfire.com/eula/) as well as under the provisions of
the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
(http://www.atlassian.com/licensing/marketplace/termsofuse).
See the LICENSE file for more details.
*/
/*********************************************************
 * Generate new anchors when pasting math blocks
 */
var latexmath_getExistingAnchors;
(function($) {
    var macroName = "mathblock";
    var anchorField = "anchor";
    var needsUpdate = "data-latexmath-needs-update";

    function makeAnchor()
    {
        var text = "";
        var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

        for( var i=0; i < 5; i++ )
            text += possible.charAt(Math.floor(Math.random() * possible.length));

        return text;
    }

    function getExistingAnchors() {
        var anchors = [];
        $("#wysiwygTextarea_ifr").contents().find("#tinymce").find("[data-macro-name="+macroName+"]").each(function() {
            if (typeof $(this).attr(needsUpdate) !== 'string') {
                var anchor = Confluence.MacroParameterSerializer.deserialize($(this).attr("data-macro-parameters"))[anchorField];
                if (anchor) {
                    anchors.push(anchor)
                }
            }
        });
        return anchors;
    }
    latexmath_getExistingAnchors = getExistingAnchors;

    var updateAnchor = function(macroNode, existingAnchors) {
        var $macroNode = $(macroNode);

        var macroParameters = Confluence.MacroParameterSerializer.deserialize($macroNode.attr("data-macro-parameters"));
        var body = $macroNode.find(".wysiwyg-macro-body > pre").html();

        macroParameters[anchorField] = macroParameters[anchorField] || makeAnchor();
        if (macroParameters[anchorField] && existingAnchors.indexOf(macroParameters[anchorField]) >= 0) {
            macroParameters[anchorField] = makeAnchor();

            AJS.Rte.getEditor().selection.select($macroNode[0]);
            AJS.Rte.BookmarkManager.storeBookmark();

            var macroRenderRequest = {
                contentId : Confluence.Editor.getContentId(),
                macro : {
                    name : macroName,
                    params : macroParameters,
                    defaultParameterValue : null,
                    body : body
                }
            };

            tinymce.confluence.MacroUtils.insertMacro(macroRenderRequest, macroNode);
        }
    };

    var updateAnchors = function() {
        var existingAnchors = getExistingAnchors();
        $("#wysiwygTextarea_ifr").contents().find("#tinymce").children("["+needsUpdate+"]").each(function() {
            updateAnchor(this, existingAnchors);
            $(this).attr(needsUpdate, null);
        });
    };

    AJS.bind("init.rte", function() {
        // Set random anchor when copy-pasting macro (to avoid duplicates)
        $(document).bind('postPaste', function (e, pl, o) {
            // Find out what is being pasted
            //noinspection JSValidateTypes
            $(o.node).children("[data-macro-name="+macroName+"]").each(function() {
                $(this).attr(needsUpdate, "");
            });
            setTimeout(function () {
                updateAnchors();
            }, 0);
        });
    });
})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-hide-latex-macro.js' */
/*
Copyright (c) 2022 Appfire Technologies, LLC.
All rights reserved.

This software is licensed under the provisions of the "Appfire EULA"
(https://appfire.com/eula/) as well as under the provisions of
the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
(http://www.atlassian.com/licensing/marketplace/termsofuse).
See the LICENSE file for more details.
*/
(function($) {
    AJS.bind("init.rte", function() {
        $( document ).ready(function() {
            $.ajax({
                url: AJS.params.baseUrl+"/rest/latexmath/latest/showlatexmacro",
                dataType: "json"
            }).done(function (data) {
                $("body").toggleClass("showLatexFalse", !data.enabled);
            });          
        });
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-macro-math.js' */
/*
Copyright (c) 2022 Appfire Technologies, LLC.
All rights reserved.

This software is licensed under the provisions of the "Appfire EULA"
(https://appfire.com/eula/) as well as under the provisions of
the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
(http://www.atlassian.com/licensing/marketplace/termsofuse).
See the LICENSE file for more details.
*/
(function($) {
    var srcUrl = document.currentScript.src;
    var mmltex;
    $.ajax({ type: "GET",
        url: srcUrl.substr(0, srcUrl.lastIndexOf('/')+1) + "mmltex.xsl",
        async: false,
        success : function(text)
        {
            mmltex = text;
        }
    });

    window.LatexMathTryConvert = function(math) {
        try {
            if (math.charAt(0) === '`' && math.charAt(math.length - 1) === '`') {
                return AMTparseAMtoTeX(math.substr(1, math.length - 2));
            } else if (math.charAt(0) === '<' && math.charAt(math.length - 1) === '>') {
                return xslt(math.replace(/&\w+;/g, convertEntity), mmltex)
                    .replace(/&gt;/g, ">")
                    .replace(/&lt;/g, "<")
                    .replace(/&amp;/g, "&")
                    .replace(/^\$([^$]*)\$$/g, "$1")
            }
        } catch(e) {
            alert(e.message);
        }
        return null;
    };

    function convertEntity(input) {
        var doc = new DOMParser().parseFromString(input, "text/html");
        return '&#'+doc.documentElement.textContent.codePointAt(0)+';';
    }

    var editorIframe = $("#wysiwygTextarea_ifr");
    $(editorIframe.contents()).on("paste", '[data-macro-name="mathblock"] .wysiwyg-macro-body', window.LatexMathHandleBodyPaste);
})(AJS.$);

/*********************************************************
 * Custom math macro editors
 */
(function($) {
    AJS.bind("init.rte", function() {

        var macroName = '';

        var fancyNames = {
            mathblock: "LaTeX Math Block",
            mathinline: "LaTeX Math Inline",
            latex: "LaTeX",
            unit: "LaTeX Unit"
        };

        var inlineList = ["mathinline", "unit"];

        var MathJax, MathJaxWarnings;

        var dialog = new AJS.Dialog({width: 800, height: 650, id: "latexmath-editor"});

        dialog.addPanel("Panel",
            '<form id="input" action="#" class="aui">'+
            '  <div class="macro-desc" id="math-macro-desc"></div>'+
            '  <div class="macro-param-div required" id="math-body-div">'+
            '    <textarea class="textarea long-field macro-param-input" id="math-body" rows=5 placeholder="'+AJS.escapeHtml("Type LaTeX Math here (e.g. E=mc^2) or paste AsciiMath or MathML for automatic conversion to LaTeX")+'"></textarea>'+
            '  </div>'+
            '  <div class="macro-param-div field-group" id="math-alignment-div">'+
            '    <label for="math-alignment">'+"Alignment"+': </label>'+
            '    <select class="select macro-param-input" id="math-alignment">'+
            '      <option value=""></option>'+
            '      <option value="left">'+"Left"+'</option>'+
            '      <option value="center">'+"Center"+'</option>'+
            '      <option value="right">'+"Right"+'</option>'+
            '    </select>'+
            '  </div>'+
            '  <div class="macro-param-div field-group" id="math-anchor-div">'+
            '    <label for="math-anchor">'+"Anchor name"+': </label>'+
            '    <input type="text" class="text macro-param-input" id="math-anchor">'+
            '    <div class="description">'+"The anchor used for linking to the math block."+'</div>'+
            '  </div>'+
            '  <div class="macro-param-div group checkbox" id="math-rawMarkup-div">'+
            '    <input type="checkbox" class="checkbox macro-param-input" id="math-rawMarkup">'+
            '    <label for="math-rawMarkup">'+"Raw LaTeX markup"+': </label>'+
            '    <div class="description">'+"Use this to ignore the LaTeX header and footer given in settings."+'</div>'+
            '  </div>'+
            '</form>'+
            '<div id="latexmath-editor-output">'+
            '  <h4 id="math-preview-heading">'+"\u9884\u89c8"+':</h4>'+
            '  <div class="math-preview" id="math-preview"></div>'+
            '  <div id="tex-warning"><h4>Parse warnings:</h4><p id="tex-warning-text"></p></div>'+
            '</div>'
            , "panel-body");

        function isInline() {
            return inlineList.indexOf(macroName)>-1;
        }

        function getBodyElement() {
            return $('textarea#math-body');
        }

        function getAnchorElement() {
            return $('input#math-anchor');
        }

        function getAlignmentElement() {
            return $('select#math-alignment');
        }

        function getRawMarkupElement() {
            return $('input#math-rawMarkup');
        }

        getBodyElement().bind("paste", function(e) {
            var pastedData = e.originalEvent.clipboardData.getData('text').trim();

            var latex = window.LatexMathTryConvert(pastedData);
            if (latex !== null) {
                document.execCommand("insertText", false, latex);
                e.preventDefault();
            }
        });

        function getParams() {
            var params = {};

            function setParam(key, element) {
                if (element.attr('type') == 'checkbox') {
                    params[key] = element.prop('checked');
                } else {
                    var val = element.val();
                    if (val != "") params[key] = val;
                }
            }

            setParam("alignment", getAlignmentElement());
            setParam("anchor", getAnchorElement());
            setParam("rawMarkup", getRawMarkupElement());

            if (!params["rawMarkup"]) delete params["rawMarkup"];

            if (isInline()) {
                setParam("body", getBodyElement());
                if (params["body"]) params["body"] = latexmathHelpers.encodeLatex(params["body"]);
            }

            return params;
        }

        function getBody() {
            if (!isInline()) {
                return getBodyElement().val();
            }
            return "";
        }

        function onSave() {
            var macro = {name: macroName, bodyHtml: getBody(), params: getParams(), defaultParameterValue: null};
            dialog.hide();
            tinymce.confluence.macrobrowser.macroBrowserComplete(macro);
        }

        dialog.addSubmit("\u4fdd\u5b58", onSave);

        dialog.addLink("\u53d6\u6d88", function() {
            dialog.hide();
            tinymce.confluence.macrobrowser.macroBrowserCancel();
        });

        function openDialog(macro) {
            macroName = macro.name;
            var params = macro.params || {};

            if (macroName=="mathblock") {
                getAlignmentElement().parent().show();
                getAnchorElement().parent().show();
            } else {
                getAlignmentElement().parent().hide();
                getAnchorElement().parent().hide();
            }

            if (macroName=="latex") {
                getRawMarkupElement().parent().show();
            } else {
                getRawMarkupElement().parent().hide();
            }

            if (macro.params) {
                dialog.addHeader(AJS.format("\u7f16\u8f91\u2018{0}\u2019\u5b8f", [fancyNames[macroName]]));
                dialog.page[0].button[0].html("\u4fdd\u5b58");
            } else {
                dialog.addHeader(AJS.format("\u63d2\u5165 \u2018{0}\u2019 \u5b8f", [fancyNames[macroName]]));
                dialog.page[0].button[0].html("\u63d2\u5165");
            }

            var macroDesc = $("#math-macro-desc")[0];
            var featDiscId = "math-macro-desc-featdisc";
            macroDesc.innerHTML = "<span id=\""+featDiscId+"\"></span>";
            switch (macroName) {
                case 'mathinline':
                    macroDesc.innerHTML += "Inserts LaTeX formatted math. Math delimiters (ie. $$ .. $$) are not necessary.";
                    break;
                case 'mathblock':
                    macroDesc.innerHTML += "Inserts LaTeX formatted math. Math delimiters (ie. $$ .. $$) are not necessary.";
                    break;
                case 'unit':
                    macroDesc.innerHTML += "Inserts LaTeX formatted units (e.g. m/s).";
                    break;
                case 'latex':
                    macroDesc.innerHTML += "Inserts LaTeX. For math mode, use of Math Block and Math Inline is recommended instead.";
                    break;
            }
            macroDesc.innerHTML += ' <a target="_blank" href="https://apps.appf.re/lm/doc"><span class="aui-icon icon-help"><span>Help</span></span></a>';

            if (!latexmathHelpers.readCookie(featDiscId)) {
                $.ajax({
                    url: AJS.params.baseUrl + "/rest/feature-discovery/latest/com.tensixtwo.conf.latexmath/addinlineShortcut",
                    dataType: "json"
                }).done(function (data) {
                    $.ajax({
                        url: AJS.params.baseUrl+"/rest/latexmath/latest/featdisc",
                        data: {userKey: AJS.params.remoteUserKey},
                        dataType: "json"
                    }).then(function(featdisc) {
                        if (featdisc.enabled) {
                            if (data.isNew) {
                                AJS.messages.generic("#" + featDiscId, {
                                    id: featDiscId+"Div",
                                    body: "Hint: Press Ctrl-Enter to save the macro and close this window."
                                });
                            }
                        }
                    });
                });
                $(document).on('messageClose', function (e) {
                    if (e.target.id == featDiscId+"Div") {
                        latexmathHelpers.createCookie(featDiscId, "read", 30)
                    }
                });
            }

            dialog.id = "macro-"+macroName;

            var latex = "";
            if (isInline()) {
                latex = params["body"];
            }
            if (latex == null || latex == "") {
                latex = macro.body;
            }

            getBodyElement().val(latexmathHelpers.decodeLatex(latex));
            getAlignmentElement().val(params["alignment"]);
            getAnchorElement().val(params["anchor"]);
            getRawMarkupElement().prop('checked', params["rawMarkup"]);

            dialog.show();
            previewMacro();

            function onKeyDown(event) {
                if ((event.keyCode == 10 || event.keyCode == 13) && event.ctrlKey) {
                    getBodyElement().parent().off('keydown', onKeyDown);
                    onSave()
                }
            }

            getBodyElement().parent().on('keydown', onKeyDown);
        }

        for (var key in fancyNames) {
            if (fancyNames.hasOwnProperty(key)) {
                AJS.MacroBrowser.setMacroJsOverride(key, {opener: openDialog});
            }
        }

        var oldBodyVal = null;
        getBodyElement().on("change keyup paste", function() {
            var currentVal = $(this).val();
            if(currentVal == oldBodyVal) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldBodyVal = currentVal;

            previewMacro(currentVal);
        });

        var oldHasAnchor = null;
        getAnchorElement().on("change keyup paste", function() {
            var currentVal = $(this).val().length>0;
            if(currentVal == oldHasAnchor) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldHasAnchor = currentVal;

            previewMacro();
        });

        var oldAlignmentVal = null;
        getAlignmentElement().on("change", function() {
            var currentVal = $(this).val();
            if(currentVal == oldAlignmentVal) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldAlignmentVal = currentVal;

            previewMacro();
        });

        var oldRawMarkupVal = null;
        getRawMarkupElement().on("change", function() {
            var currentVal = $(this).prop('checked');
            if(currentVal == oldRawMarkupVal) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldRawMarkupVal = currentVal;

            previewMacro();
        });

        var getEditorWarningElement = function () {
            return $('#editor-warning');
        }

        var getWarningElement = function () {
            return $("#tex-warning");
        }

        var getWarningTextElement = function () {
            return $("#tex-warning-text");
        };

        function getPreviewContainerDiv() {
            return $("div#math-preview");
        }

        function createPreviewContainer() {
            // Set the iframe source to an empty JS statement to avoid
            // secure/nonsecure warnings on https, without needing a back-end call.
            var src = AJS.params.staticResourceUrlPrefix + "/blank.html";
            getPreviewContainerDiv().html('<iframe src="' + src + '" frameborder="0" name="macro-browser-preview-frame math-preview" id="macro-preview-iframe"></iframe><div id="loading-fog"></div>');
        }

        function removePreviewContainer() {
            // removes the iFrame.
            getPreviewContainerDiv().html("");
        }

        function onPreviewComplete() {
            if (MathJax) {
                MathJax.Hub.Queue(function () {
                    if (MathJaxWarnings && MathJaxWarnings.length) {
                        getWarningTextElement().html(MathJaxWarnings.join('<br />'));
                        getWarningElement().show();
                        MathJaxWarnings.length = 0;
                    }
                    loadingInProgress(false);
                });
            } else {
                loadingInProgress(false);
            }
        }

        function loadIframe(html) {
            var iframe = $("#macro-preview-iframe");
            var doc = $(iframe).contents()[0];
            doc.write(html);
            doc.close(); // for firefox

            iframe.load(function() {
                $(doc).find('body').addClass('latexmath-preview').attr('data-macro-name', macroName);

                var iframeWindow = iframe[0].contentWindow;
                MathJax = iframeWindow.MathJax;
                MathJaxWarnings = iframeWindow.MathJaxWarnings;

                onPreviewComplete();
            });
        }

        var _loadingInProgress = false;

        function loadingInProgress(loading) {
            if (arguments.length==0) return _loadingInProgress;
            if (loading === _loadingInProgress) return;

            _loadingInProgress = loading;

            if (_loadingInProgress) {
                $('#loading-fog').show();
                getWarningElement().hide();
                getPreviewContainerDiv().spin('large');
            } else {
                $('#loading-fog').hide();
                getPreviewContainerDiv().spinStop();
            }
        }

        var delay = (function(){
            var timer = 0;
            return function(callback, ms){
                clearTimeout (timer);
                timer = setTimeout(callback, ms);
            };
        })();

        function previewMacro (newMath) {
            loadingInProgress(true);

            var mathElements = MathJax && MathJax.Hub.getAllJax('content');
            if (newMath !== undefined && mathElements && mathElements.length) {
                delay(function() {
                    $.ajax({
                        url: AJS.params.baseUrl + "/rest/latexmath/latest/preprocessmarkup",
                        data: {markup: newMath, macro: macroName.toUpperCase()},
                        dataType: "json"
                    }).then(function (data) {
                        MathJax.Hub.Queue(["Text", mathElements[0], data.markup]);
                        onPreviewComplete();
                    });
                }, 250);
                return;
            }

            removePreviewContainer();

            delay(function(){
                if (!getBodyElement().val() || (getBodyElement().val().trim().length==0)) {
                    loadingInProgress(false);
                    return;
                }

                //noinspection JSUnusedGlobalSymbols
                var options = {
                    contentId: Confluence.getContentId(),
                    macroName: macroName,
                    params: getParams(),
                    body: getBody(),
                    defaultParameterValue: null,

                    successCallback : function(html) {
                        loadIframe(html);
                    },

                    errorCallback : function(e) {
                        AJS.logError(e);
                        loadingInProgress(false);
                    }
                };

                createPreviewContainer();
                loadingInProgress(true);


                AJS.MacroBrowser.Rest.fetchMacroPreviewData(options);
            }, 1000 );
        }

        getPreviewContainerDiv().on('hide.dialog',function() {
            removePreviewContainer();
        })
    });
})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-macro-ref.js' */
/*
Copyright (c) 2022 Appfire Technologies, LLC.
All rights reserved.

This software is licensed under the provisions of the "Appfire EULA"
(https://appfire.com/eula/) as well as under the provisions of
the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
(http://www.atlassian.com/licensing/marketplace/termsofuse).
See the LICENSE file for more details.
*/
/*********************************************************
 * Custom math block reference editor
 */
(function($) {

    $(document).ready(function(){

        var macroName = '';

        var fancyNames = {
            'mathblock-ref': "LaTeX Math Block Reference"
        };

        var dialog = new AJS.Dialog({width: 800, height: 650});

        dialog.addPanel("Panel",
            '  <form action="#" class="aui">'+
            '    <div class="macro-desc" id="mathblock-ref-macro-desc">'+"Inserts reference with link to the Math Block with the given anchor."+'</div>'+
            '    <div class="macro-param-div field-group" id="mathblock-ref-page-div">'+
            '      <label for="mathblock-ref-page-helper">'+"Confluence page"+'</label>'+
            '      <input type="text" class="text autocomplete-page macro-param-input" id="mathblock-ref-page-helper" placeholder="This page" autocomplete="off" data-none-message="'+"Not found"+'">'+
            '      <input type="text" class="hidden" id="mathblock-ref-page">'+
            '      <div class="description">'+"The page containing the math block (leave blank for this page)."+'</div>'+
            '    </div>'+
            '    <div class="macro-param-div field-group required" id="mathblock-ref-anchor-div">'+
            '      <label for="mathblock-ref-anchor">'+"Anchor name"+'<span class="aui-icon icon-required">required</span></label>'+
            '      <input type="text" class="text macro-param-input" id="mathblock-ref-anchor" list="mathblock-ref-anchor-list" autocomplete="off"><datalist id="mathblock-ref-anchor-list"></datalist>'+
            '      <div class="description">'+"The anchor used for linking to the math block."+'</div>'+
            '    </div>'+
            '    <div class="macro-param-div field-group" id="mathblock-ref-displaytext-div">'+
            '      <label for="mathblock-ref-displaytext">'+"Link text"+'</label>'+
            '      <input type="text" class="text macro-param-input" id="mathblock-ref-displaytext" autocomplete="off">'+
            '      <div class="description">'+"Leave blank to use the number from the math block."+'</div>'+
            '    </div>'+
            '  </form>'+
            '<h4 id="mathblock-ref-preview-heading">'+"\u9884\u89c8"+':</h4>'+
            '<div class="mathblock-ref-preview" id="mathblock-ref-preview">'+
            '</div>'
            , "panel-body");

        AJS.toInit(function () {
            Confluence.Binder.autocompletePage(AJS.$("#mathblock-ref-page-div"));
        });

        function updateDatalist(page) {
            var datalist = $("#mathblock-ref-anchor-list");
            datalist.html('');
            function doUpdate(anchors) {
                $(anchors).each(function() {
                    datalist.append($('<option value="'+latexmathHelpers.escapeHtml(this)+'"></option>'));
                })
            }

            var anchors;
            if (!page || page == '') {
                doUpdate(latexmath_getExistingAnchors());
            } else {
                var pageRef = getPageRef(page);

                $.ajax({
                    url: AJS.params.baseUrl+"/rest/api/content",
                    data: {spaceKey: pageRef.space, title: pageRef.title},
                    dataType: "json"
                }).done(function(response) {
                    if (response.results.length == 1) {
                        $.ajax({
                            url: AJS.params.baseUrl + "/rest/api/content/" + response.results[0].id,
                            data: {expand: 'body.view'},
                            dataType: "json"
                        }).done(function (response) {
                            if (response.body) {
                                var re = new RegExp("\\d+_(.*)");
                                anchors = [];

                                $(response.body.view.value).find("span.latexmath-number").each(function () {
                                    var res = re.exec($(this).attr("data-latexmath-anchor"));
                                    anchors.push(res[1]);
                                });
                                doUpdate(anchors);
                            }
                        });
                    }
                });
            }
        }

        function getPageElement() {
            return $('input#mathblock-ref-page');
        }

        function getPageHelperElement() {
            return $('input#mathblock-ref-page-helper');
        }

        function getAnchorElement() {
            return $('input#mathblock-ref-anchor');
        }

        function getDisplayTextElement() {
            return $('input#mathblock-ref-displaytext');
        }

        function getParams() {
            var params = {};

            function setParam(key, element) {
                var val = element.val();
                if (val!="") params[key] = val;
            }

            setParam("page", getPageElement());
            setParam("anchor", getAnchorElement());
            setParam("displaytext", getDisplayTextElement());

            return params;
        }

        var getPageRef = (function(){
            var re = new RegExp("(?:(\\w+):)?(.*)");
            return function(page){
                var match = re.exec(page || '');
                return {
                    space: match[1] || '',
                    title: match[2]
                };
            };
        })();

        var makeDelay = function() {
            return (function(){
                var timer = 0;
                return function(callback, ms){
                    clearTimeout (timer);
                    timer = setTimeout(callback, ms);
                };
            })();
        };

        function onSave() {
            var macro = {name: macroName, bodyHtml: null, params: getParams(), defaultParameterValue: null};
            dialog.hide();
            tinymce.confluence.macrobrowser.macroBrowserComplete(macro);
        }

        dialog.addSubmit("\u4fdd\u5b58", onSave);

        dialog.addLink("\u53d6\u6d88", function() {
            dialog.hide();
            tinymce.confluence.macrobrowser.macroBrowserCancel();
        });

        function openDialog(macro) {
            oldAnchor = null;
            oldPage = null;
            oldDisplayText = null;

            macroName = macro.name;
            var params = macro.params || {};

            if (macro.params) {
                dialog.addHeader(AJS.format("\u7f16\u8f91\u2018{0}\u2019\u5b8f", [fancyNames[macroName]]));
                dialog.page[0].button[0].html("\u4fdd\u5b58");
            } else {
                dialog.addHeader(AJS.format("\u63d2\u5165 \u2018{0}\u2019 \u5b8f", [fancyNames[macroName]]));
                dialog.page[0].button[0].html("\u63d2\u5165");
            }

            dialog.id = "macro-"+macroName;

            getPageElement().val(params["page"]);
            getPageHelperElement().val(getPageRef(params["page"]).title);
            getAnchorElement().val(params["anchor"]);
            getDisplayTextElement().val(params["displaytext"]);
            updateDatalist(params["page"]);

            dialog.show();
            previewMacro();
        }

        for (var key in fancyNames) {
            if (fancyNames.hasOwnProperty(key)) {
                AJS.MacroBrowser.setMacroJsOverride(key, {opener: openDialog});
            }
        }

        var oldAnchor = null;
        getAnchorElement().on("change keyup paste input blur", function() {
            var currentVal = $(this).val();
            if(currentVal == oldAnchor) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldAnchor = currentVal;

            previewMacro();
        });

        var oldPage = null;
        var updateDatalistDelay = makeDelay();
        getPageHelperElement().on("change keyup paste input selected.autocomplete-content", function(event, data) {
            var el = $(this);
            var pageEl = getPageElement();

            if (data && data.content) {
                pageEl.val(AJS.template('{space.key}:{title}').fillHtml(data.content));
            } else if (el.val()) {
                pageEl.val(AJS.params.spaceKey+':'+el.val());
            } else {
                pageEl.val('');
            }

            var currentVal = pageEl.val();
            if(currentVal == oldPage) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldPage = currentVal;

            getAnchorElement().val('');
            updateDatalistDelay(function() {
                updateDatalist(pageEl.val())
            }, 50);
            previewMacro();
        });

        var oldDisplayText = null;
        getDisplayTextElement().on("change keyup paste", function() {
            var currentVal = $(this).val();
            if(currentVal == oldDisplayText) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldDisplayText = currentVal;

            previewMacro();
        });

        function getPreviewContainerDiv() {
            return $("div#mathblock-ref-preview");
        }

        function createPreviewContainer() {
            // Set the iframe source to an empty JS statement to avoid
            // secure/nonsecure warnings on https, without needing a back-end call.
            var src = AJS.params.staticResourceUrlPrefix + "/blank.html";
            getPreviewContainerDiv().html('<iframe src="' + src + '" frameborder="0" name="macro-browser-preview-frame mathblock-ref-preview" id="macro-preview-iframe" style="width: 100%;"></iframe>');
        }

        function removePreviewContainer() {
            // removes the iFrame.
            getPreviewContainerDiv().html("");
        }

        function renderPreview(html) {
            var iframe = getPreviewContainerDiv().find("iframe")[0];
            var doc = iframe.contentDocument || iframe.contentWindow.document;
            doc.write(html);
            doc.close(); // for firefox

            $(iframe).load(function() {
                loadingInProgress(false);
            });
        }

        var _loadingInProgress = false;

        function loadingInProgress(loading) {
            if (arguments.length==0) return _loadingInProgress;

            _loadingInProgress = loading;

            if (_loadingInProgress) {
                getPreviewContainerDiv().spin('large');
            } else {
                getPreviewContainerDiv().spinStop();
            }
        }

        var previewDelay = makeDelay();

        function previewMacro () {
            removePreviewContainer();
            loadingInProgress(true);

            previewDelay(function(){
                if (!getAnchorElement().val() || (getAnchorElement().val().trim().length==0)) {
                    loadingInProgress(false);
                    return;
                }

                var options = {
                    contentId: Confluence.getContentId(),
                    macroName: macroName,
                    params: getParams(),
                    body: null,
                    defaultParameterValue: null,

                    successCallback : function(html) {
                        renderPreview(html);
                    },

                    errorCallback : function(e) {
                        // todo: better err handling?
                        AJS.logError(e);
                        loadingInProgress(false);
                    }
                };

                createPreviewContainer();
                loadingInProgress(true);


                AJS.MacroBrowser.Rest.fetchMacroPreviewData(options);
            }, 1000 );
        }

        getPreviewContainerDiv().on('hide.dialog',function() {
            removePreviewContainer();
        })
    });
})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-math-panel.js' */
/*
Copyright (c) 2022 Appfire Technologies, LLC.
All rights reserved.

This software is licensed under the provisions of the "Appfire EULA"
(https://appfire.com/eula/) as well as under the provisions of
the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
(http://www.atlassian.com/licensing/marketplace/termsofuse).
See the LICENSE file for more details.
*/
/*********************************************************
 * Math inline and unit editing from panel
 */

(function($) {

    // property-panel button ids from the plugin descriptor, assumes that the parameter names equal the button ids
    var titleParameterName = "body";

    var updateMacro = function(macroName, macroNode, macroParameterCallback) {
        var $macroNode = $(macroNode);

        AJS.Rte.getEditor().selection.select($macroNode[0]);
        AJS.Rte.BookmarkManager.storeBookmark();

        var macroParameters = Confluence.MacroParameterSerializer.deserialize($macroNode.attr("data-macro-parameters"));
        var body = decodeURIComponent($macroNode.attr("data-macro-body"));
        macroParameterCallback(macroParameters);

        var macroRenderRequest = {
            contentId : Confluence.Editor.getContentId(),
            macro : {
                name : macroName,
                params : macroParameters,
                defaultParameterValue : null,
                body : body
            }
        };

        tinymce.confluence.MacroUtils.insertMacro(macroRenderRequest, macroNode);
    };

    var getCurrentTitle = function(macroNode) {
        var $macroNode = $(macroNode);
        var macroParameters = Confluence.MacroParameterSerializer.deserialize($macroNode.attr("data-macro-parameters"));
        var title = macroParameters[titleParameterName] || "";
        if(!title && ($macroNode.attr("data-macro-body-type")=="PLAIN_TEXT")) {
            title = decodeURIComponent($macroNode.attr("data-macro-body"));
        }
        return latexmathHelpers.decodeLatex(title);
    };

    AJS.bind("init.rte", function() {
        AJS.Confluence.PropertyPanel.Macro.registerInitHandler(function (macroNode, buttons) {
            var title = getCurrentTitle(macroNode);
            buttons.splice(1, 0, createTitleElement(macroNode, title, "unit")); // insert after the first element = 'Edit'
        }, "unit");

        AJS.Confluence.PropertyPanel.Macro.registerInitHandler(function (macroNode, buttons) {
            var title = getCurrentTitle(macroNode);
            buttons.splice(1, 0, createTitleElement(macroNode, title, "mathinline")); // insert after the first element = 'Edit'
        }, "mathinline");
    });

    var createTitleElement = function(macroNode, currentTitle, macroName) {
        var cssClassNames = macroName+"-macro-body first last editable";
        var $linkTitleElement;
        var $inputTitleElement = $("<input/>");
        $inputTitleElement.attr("class", cssClassNames);

        var swapTitleElement = function($currentTitleElement) {
            var currentTagName = $currentTitleElement.prop("tagName").toLowerCase();
            if(currentTagName == "a") {
                if(!$linkTitleElement) {
                    $linkTitleElement = $currentTitleElement;
                }
                $inputTitleElement.val($linkTitleElement.find("span.panel-button-text").text());
                $currentTitleElement.replaceWith($inputTitleElement);
                $inputTitleElement.focus(function() {
                    this.select();
                });
                $inputTitleElement.focus();
                var changeTitle = function() {
                    $inputTitleElement = $(this);
                    updateMacro(macroName, macroNode, function(macroParameters) {
                        var body = $inputTitleElement.val();
                        if (body.trim()) {
                            macroParameters.body = latexmathHelpers.encodeLatex(body);
                        } else if (macroParameters.body) {
                            delete macroParameters["body"];
                        }
                    });
                    AJS.Confluence.PropertyPanel.destroy();
                    swapTitleElement($inputTitleElement);
                };
                $inputTitleElement.change(function() {
                    changeTitle.call(this);
                });
                // register one for the IEs ...
                $inputTitleElement.keyup(function(e) {
                    // enter key
                    if(e.keyCode == 13) {
                        changeTitle.call(this);
                    }
                });
            }
        };

        return {
            className: cssClassNames,
            text: AJS.escapeHtml(currentTitle),
            click: swapTitleElement
        }
    }

})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-handlers.js' */
/*
Copyright (c) 2022 Appfire Technologies, LLC.
All rights reserved.

This software is licensed under the provisions of the "Appfire EULA"
(https://appfire.com/eula/) as well as under the provisions of
the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
(http://www.atlassian.com/licensing/marketplace/termsofuse).
See the LICENSE file for more details.
*/
(function($) {
    var autoformatHandlers = [
        {macro: 'mathinline', regex: /(?:[\s\xA0\u200b\uFEFF]+|^)(\$(?=[^\s$])([^$]*?[^\s]))$/, endChar: '$'},
        {macro: 'mathinline', regex: /(\\$)/, endChar: '('},
        {macro: 'mathblock', regex: /(\$\$(?=[^$])([^$]*?)\$)$/, endChar: '$'},
        {macro: 'mathblock', regex: /(\\$)/, endChar: '['}
    ];

    var pasteHandlers = [
        {macro: 'mathinline', regex: /^\$([^$]+)\$$/},
        {macro: 'mathinline', regex: /^\\\(([^$]+)\\\)$/},
        {macro: 'mathblock', regex: /^\$\$(?=[^$])(.+)\$\$$/},
        {macro: 'mathblock', regex: /^\\\[(.+)\\]$/}
    ];

    function makeMacro(macroName, body) {
        body = body && body.trim() || '';
        var params = {};
        if (macroName.indexOf('block') === -1) {
            if (body) {
                params['body'] = body;
            }
            body = null;
        }

        return {
            contentId: AJS.Meta.get('content-id') || "0",
            macro : {
                name : macroName,
                params : params,
                defaultParameterValue : null,
                body : body
            }
        };
    }

    function isInPlainTextMacro(element) {
        return $(element).closest("[data-macro-body-type='PLAIN_TEXT']").length;
    }

    function insertMacro(macro, body) {
        AJS.Rte.BookmarkManager.storeBookmark();
        tinymce.confluence.MacroUtils.insertMacro(makeMacro(macro, body))
            .done(function (node) {
                if (!body && node.tagName.toLowerCase() === 'img') {
                    // If we are creating an empty inline macro, then select it so it is ready for user input
                    $(node).click();
                    $('#property-panel').each(function () {
                        $(this).find('a.mathinline-macro-body').click();
                        $(this).find('input.mathinline-macro-body').focus();
                    });
                }
            });
    }

    AJS.bind("confluence.editor.registerHandlers", function(e, data) {
        var handlerManager = data.handlerManager;
        var createHandler = data.createHandler;
        var editor = data.ed;

        autoformatHandlers.forEach(function(h) {
            handlerManager.registerHandler(h.endChar.charCodeAt(0), createHandler(h.regex, function (matchGroups) {
                insertMacro(h.macro, matchGroups[2]);
            }, true, 'span#autocomplete')); // Don't do this in autocomplete mode
        });

        $(document).bind('prePaste', function () {
            if (editor.removed) return;
            editor.undoManager.add();
        });

        $(document).bind('postPaste', function (e, pl, o) {
            if (editor.removed) return;

            if (!editor.selection || !isInPlainTextMacro(editor.selection.getStart())) {
                var text = o.node.textContent.trim();
                var match, macro;
                pasteHandlers.forEach(function (h) {
                    if (!match) {
                        match = h.regex.exec(text);
                        macro = h.macro;
                    }
                });

                if (match && match.length && match[1]) {
                    setTimeout(function () {
                        editor.undoManager.undo();
                        AJS.Rte.BookmarkManager.storeBookmark();
                        tinymce.confluence.MacroUtils.insertMacro(makeMacro(macro, match[1])).done(function () {
                            editor.undoManager.add();
                        });
                    }, 1);
                }
            }
        });

        editor.onPaste.add(function (editor, e) {
            if (isInPlainTextMacro(editor.selection.getStart()) && isInPlainTextMacro(editor.selection.getEnd())) {
                var content = ((e.originalEvent || e).clipboardData || window.clipboardData).getData('Text');
                var latex = window.LatexMathTryConvert(content);
                if (latex !== null) {
                    e.preventDefault();

                    setTimeout(function () {
                        editor.undoManager.undo();
                        AJS.Rte.BookmarkManager.storeBookmark();

                        editor.selection.setContent(latex);
                        // editor.execCommand('mceInsertContent', false, latex);
                        e.preventDefault();

                        editor.undoManager.add();
                    }, 1);
                }
            }
        });
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/ASCIIMathTeXImg.js' */
/*
ASCIIMathTeXImg.js
Based on ASCIIMathML, Version 1.4.7 Aug 30, 2005, (c) Peter Jipsen http://www.chapman.edu/~jipsen
Modified with TeX conversion for IMG rendering Sept 6, 2006 (c) David Lippman http://www.pierce.ctc.edu/dlippman
  Updated to match ver 2.2 Mar 3, 2014
  Latest at https://github.com/mathjax/asciimathml
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/

(function() {
var config = {
  translateOnLoad: true,		  //true to autotranslate
  mathcolor: "",       	      // defaults to back, or specify any other color
  displaystyle: true,         // puts limits above and below large operators
  showasciiformulaonhover: true, // helps students learn ASCIIMath
  decimalsign: ".",           // change to "," if you like, beware of `(1,2)`!
  AMdelimiter1: "`", AMescape1: "\\\\`", // can use other characters
  AMusedelimiter2: false, 	  //whether to use second delimiter below
  AMdelimiter2: "$", AMescape2: "\\\\\\$", AMdelimiter2regexp: "\\$",
  AMdocumentId: "wikitext",   // PmWiki element containing math (default=body)
  doubleblankmathdelimiter: false // if true,  x+1  is equal to `x+1`
};                                // for IE this works only in <!--   -->

var CONST = 0, UNARY = 1, BINARY = 2, INFIX = 3, LEFTBRACKET = 4,
    RIGHTBRACKET = 5, SPACE = 6, UNDEROVER = 7, DEFINITION = 8,
    LEFTRIGHT = 9, TEXT = 10; // token types

var AMsqrt = {input:"sqrt", tag:"msqrt", output:"sqrt", tex:null, ttype:UNARY},
  AMroot  = {input:"root", tag:"mroot", output:"root", tex:null, ttype:BINARY},
  AMfrac  = {input:"frac", tag:"mfrac", output:"/",    tex:null, ttype:BINARY},
  AMdiv   = {input:"/",    tag:"mfrac", output:"/",    tex:null, ttype:INFIX},
  AMover  = {input:"stackrel", tag:"mover", output:"stackrel", tex:null, ttype:BINARY},
  AMsub   = {input:"_",    tag:"msub",  output:"_",    tex:null, ttype:INFIX},
  AMsup   = {input:"^",    tag:"msup",  output:"^",    tex:null, ttype:INFIX},
  AMtext  = {input:"text", tag:"mtext", output:"text", tex:null, ttype:TEXT},
  AMmbox  = {input:"mbox", tag:"mtext", output:"mbox", tex:null, ttype:TEXT},
  AMquote = {input:"\"",   tag:"mtext", output:"mbox", tex:null, ttype:TEXT};

var AMsymbols = [
//some greek symbols
{input:"alpha",  tag:"mi", output:"\u03B1", tex:null, ttype:CONST},
{input:"beta",   tag:"mi", output:"\u03B2", tex:null, ttype:CONST},
{input:"chi",    tag:"mi", output:"\u03C7", tex:null, ttype:CONST},
{input:"delta",  tag:"mi", output:"\u03B4", tex:null, ttype:CONST},
{input:"Delta",  tag:"mo", output:"\u0394", tex:null, ttype:CONST},
{input:"epsi",   tag:"mi", output:"\u03B5", tex:"epsilon", ttype:CONST},
{input:"varepsilon", tag:"mi", output:"\u025B", tex:null, ttype:CONST},
{input:"eta",    tag:"mi", output:"\u03B7", tex:null, ttype:CONST},
{input:"gamma",  tag:"mi", output:"\u03B3", tex:null, ttype:CONST},
{input:"Gamma",  tag:"mo", output:"\u0393", tex:null, ttype:CONST},
{input:"iota",   tag:"mi", output:"\u03B9", tex:null, ttype:CONST},
{input:"kappa",  tag:"mi", output:"\u03BA", tex:null, ttype:CONST},
{input:"lambda", tag:"mi", output:"\u03BB", tex:null, ttype:CONST},
{input:"Lambda", tag:"mo", output:"\u039B", tex:null, ttype:CONST},
{input:"lamda",   tag:"mi", output:"lambda", tex:null, ttype:DEFINITION},
{input:"Lamda",   tag:"mi", output:"Lambda", tex:null, ttype:DEFINITION},
{input:"mu",     tag:"mi", output:"\u03BC", tex:null, ttype:CONST},
{input:"nu",     tag:"mi", output:"\u03BD", tex:null, ttype:CONST},
{input:"omega",  tag:"mi", output:"\u03C9", tex:null, ttype:CONST},
{input:"Omega",  tag:"mo", output:"\u03A9", tex:null, ttype:CONST},
{input:"phi",    tag:"mi", output:"\u03C6", tex:null, ttype:CONST},
{input:"varphi", tag:"mi", output:"\u03D5", tex:null, ttype:CONST},
{input:"Phi",    tag:"mo", output:"\u03A6", tex:null, ttype:CONST},
{input:"pi",     tag:"mi", output:"\u03C0", tex:null, ttype:CONST},
{input:"Pi",     tag:"mo", output:"\u03A0", tex:null, ttype:CONST},
{input:"psi",    tag:"mi", output:"\u03C8", tex:null, ttype:CONST},
{input:"Psi",    tag:"mi", output:"\u03A8", tex:null, ttype:CONST},
{input:"rho",    tag:"mi", output:"\u03C1", tex:null, ttype:CONST},
{input:"sigma",  tag:"mi", output:"\u03C3", tex:null, ttype:CONST},
{input:"Sigma",  tag:"mo", output:"\u03A3", tex:null, ttype:CONST},
{input:"tau",    tag:"mi", output:"\u03C4", tex:null, ttype:CONST},
{input:"theta",  tag:"mi", output:"\u03B8", tex:null, ttype:CONST},
{input:"vartheta", tag:"mi", output:"\u03D1", tex:null, ttype:CONST},
{input:"Theta",  tag:"mo", output:"\u0398", tex:null, ttype:CONST},
{input:"upsilon", tag:"mi", output:"\u03C5", tex:null, ttype:CONST},
{input:"xi",     tag:"mi", output:"\u03BE", tex:null, ttype:CONST},
{input:"Xi",     tag:"mo", output:"\u039E", tex:null, ttype:CONST},
{input:"zeta",   tag:"mi", output:"\u03B6", tex:null, ttype:CONST},

//binary operation symbols
{input:"*",  tag:"mo", output:"\u22C5", tex:"cdot", ttype:CONST},
{input:"**", tag:"mo", output:"\u2217", tex:"ast", ttype:CONST},
{input:"***", tag:"mo", output:"\u22C6", tex:"star", ttype:CONST},
{input:"//", tag:"mo", output:"/",      tex:"/", ttype:CONST, val:true, notexcopy:true},
{input:"\\\\", tag:"mo", output:"\\",   tex:"backslash", ttype:CONST},
{input:"setminus", tag:"mo", output:"\\", tex:null, ttype:CONST},
{input:"xx", tag:"mo", output:"\u00D7", tex:"times", ttype:CONST},
{input:"|><", tag:"mo", output:"\u22C9", tex:"ltimes", ttype:CONST},
{input:"><|", tag:"mo", output:"\u22CA", tex:"rtimes", ttype:CONST},
{input:"|><|", tag:"mo", output:"\u22C8", tex:"bowtie", ttype:CONST},
{input:"-:", tag:"mo", output:"\u00F7", tex:"div", ttype:CONST},
{input:"divide",   tag:"mo", output:"-:", tex:null, ttype:DEFINITION},
{input:"@",  tag:"mo", output:"\u2218", tex:"circ", ttype:CONST},
{input:"o+", tag:"mo", output:"\u2295", tex:"oplus", ttype:CONST},
{input:"ox", tag:"mo", output:"\u2297", tex:"otimes", ttype:CONST},
{input:"o.", tag:"mo", output:"\u2299", tex:"odot", ttype:CONST},
{input:"sum", tag:"mo", output:"\u2211", tex:null, ttype:UNDEROVER},
{input:"prod", tag:"mo", output:"\u220F", tex:null, ttype:UNDEROVER},
{input:"^^",  tag:"mo", output:"\u2227", tex:"wedge", ttype:CONST},
{input:"^^^", tag:"mo", output:"\u22C0", tex:"bigwedge", ttype:UNDEROVER},
{input:"vv",  tag:"mo", output:"\u2228", tex:"vee", ttype:CONST},
{input:"vvv", tag:"mo", output:"\u22C1", tex:"bigvee", ttype:UNDEROVER},
{input:"nn",  tag:"mo", output:"\u2229", tex:"cap", ttype:CONST},
{input:"nnn", tag:"mo", output:"\u22C2", tex:"bigcap", ttype:UNDEROVER},
{input:"uu",  tag:"mo", output:"\u222A", tex:"cup", ttype:CONST},
{input:"uuu", tag:"mo", output:"\u22C3", tex:"bigcup", ttype:UNDEROVER},
{input:"overset", tag:"mover", output:"stackrel", tex:null, ttype:BINARY},
{input:"underset", tag:"munder", output:"stackrel", tex:null, ttype:BINARY},

//binary relation symbols
{input:"!=",  tag:"mo", output:"\u2260", tex:"ne", ttype:CONST},
{input:":=",  tag:"mo", output:":=",     tex:null, ttype:CONST},
{input:"lt",  tag:"mo", output:"<",      tex:null, ttype:CONST},
{input:"gt",  tag:"mo", output:">",      tex:null, ttype:CONST},
{input:"<=",  tag:"mo", output:"\u2264", tex:"le", ttype:CONST},
{input:"lt=", tag:"mo", output:"\u2264", tex:"leq", ttype:CONST},
{input:"gt=",  tag:"mo", output:"\u2265", tex:"geq", ttype:CONST},
{input:">=",  tag:"mo", output:"\u2265", tex:"ge", ttype:CONST},
{input:"-<",  tag:"mo", output:"\u227A", tex:"prec", ttype:CONST},
{input:"-lt", tag:"mo", output:"\u227A", tex:null, ttype:CONST},
{input:">-",  tag:"mo", output:"\u227B", tex:"succ", ttype:CONST},
{input:"-<=", tag:"mo", output:"\u2AAF", tex:"preceq", ttype:CONST},
{input:">-=", tag:"mo", output:"\u2AB0", tex:"succeq", ttype:CONST},
{input:"in",  tag:"mo", output:"\u2208", tex:null, ttype:CONST},
{input:"!in", tag:"mo", output:"\u2209", tex:"notin", ttype:CONST},
{input:"sub", tag:"mo", output:"\u2282", tex:"subset", ttype:CONST},
{input:"sup", tag:"mo", output:"\u2283", tex:"supset", ttype:CONST},
{input:"sube", tag:"mo", output:"\u2286", tex:"subseteq", ttype:CONST},
{input:"supe", tag:"mo", output:"\u2287", tex:"supseteq", ttype:CONST},
{input:"-=",  tag:"mo", output:"\u2261", tex:"equiv", ttype:CONST},
{input:"~=",  tag:"mo", output:"\u2245", tex:"stackrel{\\sim}{=}", notexcopy: true, ttype:CONST}, //back hack b/c mimetex doesn't support /cong
{input:"cong",   tag:"mo", output:"~=", tex:null, ttype:DEFINITION},
{input:"~~",  tag:"mo", output:"\u2248", tex:"approx", ttype:CONST},
{input:"prop", tag:"mo", output:"\u221D", tex:"propto", ttype:CONST},

//logical symbols
{input:"and", tag:"mtext", output:"and", tex:null, ttype:SPACE},
{input:"or",  tag:"mtext", output:"or",  tex:null, ttype:SPACE},
{input:"not", tag:"mo", output:"\u00AC", tex:"neg", ttype:CONST},
{input:"=>",  tag:"mo", output:"\u21D2", tex:"Rightarrow", ttype:CONST},
{input:"implies",   tag:"mo", output:"=>", tex:null, ttype:DEFINITION},
{input:"if",  tag:"mo", output:"if",     tex:null, ttype:SPACE},
{input:"<=>", tag:"mo", output:"\u21D4", tex:"Leftrightarrow", ttype:CONST},
{input:"iff",   tag:"mo", output:"<=>", tex:null, ttype:DEFINITION},
{input:"AA",  tag:"mo", output:"\u2200", tex:"forall", ttype:CONST},
{input:"EE",  tag:"mo", output:"\u2203", tex:"exists", ttype:CONST},
{input:"_|_", tag:"mo", output:"\u22A5", tex:"bot", ttype:CONST},
{input:"TT",  tag:"mo", output:"\u22A4", tex:"top", ttype:CONST},
{input:"|--",  tag:"mo", output:"\u22A2", tex:"vdash", ttype:CONST},
{input:"|==",  tag:"mo", output:"\u22A8", tex:"models", ttype:CONST}, //mimetex doesn't support

//grouping brackets
{input:"(", tag:"mo", output:"(", tex:null, ttype:LEFTBRACKET, val:true},
{input:")", tag:"mo", output:")", tex:null, ttype:RIGHTBRACKET, val:true},
{input:"[", tag:"mo", output:"[", tex:null, ttype:LEFTBRACKET, val:true},
{input:"]", tag:"mo", output:"]", tex:null, ttype:RIGHTBRACKET, val:true},
{input:"left(", tag:"mo", output:"(", tex:"(", notexcopy: true, ttype:LEFTBRACKET, val:true},
{input:"right)", tag:"mo", output:")", tex:")", notexcopy: true, ttype:RIGHTBRACKET, val:true},
{input:"left[", tag:"mo", output:"[", tex:"[", notexcopy: true, ttype:LEFTBRACKET, val:true},
{input:"right]", tag:"mo", output:"]", tex:"]", notexcopy: true, ttype:RIGHTBRACKET, val:true},
{input:"{", tag:"mo", output:"{", tex:"lbrace", ttype:LEFTBRACKET},
{input:"}", tag:"mo", output:"}", tex:"rbrace", ttype:RIGHTBRACKET},
{input:"|", tag:"mo", output:"|", tex:null, ttype:LEFTRIGHT, val:true},
{input:"|:", tag:"mo", output:"|", tex:"|", ttype:LEFTBRACKET, notexcopy:true, val:true},
{input:":|", tag:"mo", output:"|", tex:"|", ttype:RIGHTBRACKET, notexcopy:true, val:true},
{input:":|:", tag:"mo", output:"|", tex:"|", ttype:CONST, notexcopy:true, val:true},
//{input:"||", tag:"mo", output:"||", tex:null, ttype:LEFTRIGHT},
{input:"(:", tag:"mo", output:"\u2329", tex:"langle", ttype:LEFTBRACKET},
{input:":)", tag:"mo", output:"\u232A", tex:"rangle", ttype:RIGHTBRACKET},
{input:"<<", tag:"mo", output:"\u2329", tex:"langle", ttype:LEFTBRACKET},
{input:">>", tag:"mo", output:"\u232A", tex:"rangle", ttype:RIGHTBRACKET},
{input:"{:", tag:"mo", output:"{:", tex:null, ttype:LEFTBRACKET, invisible:true},
{input:":}", tag:"mo", output:":}", tex:null, ttype:RIGHTBRACKET, invisible:true},

//miscellaneous symbols
{input:"int",  tag:"mo", output:"\u222B", tex:null, ttype:CONST},
{input:"dx",   tag:"mi", output:"{:d x:}", tex:null, ttype:DEFINITION},
{input:"dy",   tag:"mi", output:"{:d y:}", tex:null, ttype:DEFINITION},
{input:"dz",   tag:"mi", output:"{:d z:}", tex:null, ttype:DEFINITION},
{input:"dt",   tag:"mi", output:"{:d t:}", tex:null, ttype:DEFINITION},
{input:"oint", tag:"mo", output:"\u222E", tex:null, ttype:CONST},
{input:"del",  tag:"mo", output:"\u2202", tex:"partial", ttype:CONST},
{input:"grad", tag:"mo", output:"\u2207", tex:"nabla", ttype:CONST},
{input:"+-",   tag:"mo", output:"\u00B1", tex:"pm", ttype:CONST},
{input:"O/",   tag:"mo", output:"\u2205", tex:"emptyset", ttype:CONST},
{input:"oo",   tag:"mo", output:"\u221E", tex:"infty", ttype:CONST},
{input:"aleph", tag:"mo", output:"\u2135", tex:null, ttype:CONST},
{input:"...",  tag:"mo", output:"...",    tex:"ldots", ttype:CONST},
{input:":.",  tag:"mo", output:"\u2234",  tex:"therefore", ttype:CONST},
{input:":'",  tag:"mo", output:"\u2235",  tex:"because", ttype:CONST},
{input:"/_",  tag:"mo", output:"\u2220",  tex:"angle", ttype:CONST},
{input:"/_\\",  tag:"mo", output:"\u25B3",  tex:"triangle", ttype:CONST},
{input:"\\ ",  tag:"mo", output:"\u00A0", tex:null, ttype:CONST, val:true},
{input:"frown",  tag:"mo", output:"\u2322", tex:null, ttype:CONST},
{input:"%",  tag:"mo", output:"%", tex:"%", ttype:CONST, notexcopy:true},
{input:"quad", tag:"mo", output:"\u00A0\u00A0", tex:null, ttype:CONST},
{input:"qquad", tag:"mo", output:"\u00A0\u00A0\u00A0\u00A0", tex:null, ttype:CONST},
{input:"cdots", tag:"mo", output:"\u22EF", tex:null, ttype:CONST},
{input:"vdots", tag:"mo", output:"\u22EE", tex:null, ttype:CONST},
{input:"ddots", tag:"mo", output:"\u22F1", tex:null, ttype:CONST},
{input:"diamond", tag:"mo", output:"\u22C4", tex:null, ttype:CONST},
{input:"square", tag:"mo", output:"\u25A1", tex:"boxempty", ttype:CONST},
{input:"|__", tag:"mo", output:"\u230A",  tex:"lfloor", ttype:CONST},
{input:"__|", tag:"mo", output:"\u230B",  tex:"rfloor", ttype:CONST},
{input:"|~", tag:"mo", output:"\u2308",  tex:"lceil", ttype:CONST},
{input:"lceiling",   tag:"mo", output:"|~", tex:null, ttype:DEFINITION},
{input:"~|", tag:"mo", output:"\u2309",  tex:"rceil", ttype:CONST},
{input:"rceiling",   tag:"mo", output:"~|", tex:null, ttype:DEFINITION},
{input:"CC",  tag:"mo", output:"\u2102", tex:"mathbb{C}", ttype:CONST, notexcopy:true},
{input:"NN",  tag:"mo", output:"\u2115", tex:"mathbb{N}", ttype:CONST, notexcopy:true},
{input:"QQ",  tag:"mo", output:"\u211A", tex:"mathbb{Q}", ttype:CONST, notexcopy:true},
{input:"RR",  tag:"mo", output:"\u211D", tex:"mathbb{R}", ttype:CONST, notexcopy:true},
{input:"ZZ",  tag:"mo", output:"\u2124", tex:"mathbb{Z}", ttype:CONST, notexcopy:true},
{input:"f",   tag:"mi", output:"f",      tex:null, ttype:UNARY, func:true, val:true},
{input:"g",   tag:"mi", output:"g",      tex:null, ttype:UNARY, func:true, val:true},
{input:"''", tag:"mo", output:"''", tex:null, val:true},
{input:"'''", tag:"mo", output:"'''", tex:null, val:true},
{input:"''''", tag:"mo", output:"''''", tex:null, val:true},


//standard functions
{input:"lim",  tag:"mo", output:"lim", tex:null, ttype:UNDEROVER},
{input:"Lim",  tag:"mo", output:"Lim", tex:null, ttype:UNDEROVER},
{input:"sin",  tag:"mo", output:"sin", tex:null, ttype:UNARY, func:true},
{input:"cos",  tag:"mo", output:"cos", tex:null, ttype:UNARY, func:true},
{input:"tan",  tag:"mo", output:"tan", tex:null, ttype:UNARY, func:true},
{input:"arcsin",  tag:"mo", output:"arcsin", tex:null, ttype:UNARY, func:true},
{input:"arccos",  tag:"mo", output:"arccos", tex:null, ttype:UNARY, func:true},
{input:"arctan",  tag:"mo", output:"arctan", tex:null, ttype:UNARY, func:true},
{input:"sinh", tag:"mo", output:"sinh", tex:null, ttype:UNARY, func:true},
{input:"cosh", tag:"mo", output:"cosh", tex:null, ttype:UNARY, func:true},
{input:"tanh", tag:"mo", output:"tanh", tex:null, ttype:UNARY, func:true},
{input:"cot",  tag:"mo", output:"cot", tex:null, ttype:UNARY, func:true},
{input:"coth",  tag:"mo", output:"coth", tex:null, ttype:UNARY, func:true},
{input:"sech",  tag:"mo", output:"sech", tex:null, ttype:UNARY, func:true},
{input:"csch",  tag:"mo", output:"csch", tex:null, ttype:UNARY, func:true},
{input:"sec",  tag:"mo", output:"sec", tex:null, ttype:UNARY, func:true},
{input:"csc",  tag:"mo", output:"csc", tex:null, ttype:UNARY, func:true},
{input:"log",  tag:"mo", output:"log", tex:null, ttype:UNARY, func:true},
{input:"ln",   tag:"mo", output:"ln",  tex:null, ttype:UNARY, func:true},
{input:"abs",   tag:"mo", output:"abs",  tex:null, ttype:UNARY, notexcopy:true, rewriteleftright:["|","|"]},
{input:"norm",   tag:"mo", output:"norm",  tex:null, ttype:UNARY, notexcopy:true, rewriteleftright:["\\|","\\|"]},
{input:"floor",   tag:"mo", output:"floor",  tex:null, ttype:UNARY, notexcopy:true, rewriteleftright:["\\lfloor","\\rfloor"]},
{input:"ceil",   tag:"mo", output:"ceil",  tex:null, ttype:UNARY, notexcopy:true, rewriteleftright:["\\lceil","\\rceil"]},
{input:"Sin",  tag:"mo", output:"Sin", tex:null, ttype:UNARY, func:true},
{input:"Cos",  tag:"mo", output:"Cos", tex:null, ttype:UNARY, func:true},
{input:"Tan",  tag:"mo", output:"Tan", tex:null, ttype:UNARY, func:true},
{input:"Arcsin",  tag:"mo", output:"Arcsin", tex:null, ttype:UNARY, func:true},
{input:"Arccos",  tag:"mo", output:"Arccos", tex:null, ttype:UNARY, func:true},
{input:"Arctan",  tag:"mo", output:"Arctan", tex:null, ttype:UNARY, func:true},
{input:"Sinh", tag:"mo", output:"Sinh", tex:null, ttype:UNARY, func:true},
{input:"Cosh", tag:"mo", output:"Cosh", tex:null, ttype:UNARY, func:true},
{input:"Tanh", tag:"mo", output:"Tanh", tex:null, ttype:UNARY, func:true},
{input:"Cot",  tag:"mo", output:"Cot", tex:null, ttype:UNARY, func:true},
{input:"Sec",  tag:"mo", output:"Sec", tex:null, ttype:UNARY, func:true},
{input:"Csc",  tag:"mo", output:"Csc", tex:null, ttype:UNARY, func:true},
{input:"Log",  tag:"mo", output:"Log", tex:null, ttype:UNARY, func:true},
{input:"Ln",   tag:"mo", output:"Ln",  tex:null, ttype:UNARY, func:true},
{input:"Abs",   tag:"mo", output:"abs",  tex:null, ttype:UNARY, notexcopy:true, rewriteleftright:["|","|"]},

{input:"det",  tag:"mo", output:"det", tex:null, ttype:UNARY, func:true},
{input:"exp",  tag:"mo", output:"exp", tex:null, ttype:UNARY, func:true},
{input:"dim",  tag:"mo", output:"dim", tex:null, ttype:CONST},
{input:"mod",  tag:"mo", output:"mod", tex:"text{mod}", ttype:CONST, notexcopy:true},
{input:"gcd",  tag:"mo", output:"gcd", tex:null, ttype:UNARY, func:true},
{input:"lcm",  tag:"mo", output:"lcm", tex:"text{lcm}", ttype:UNARY, func:true, notexcopy:true},
{input:"lub",  tag:"mo", output:"lub", tex:null, ttype:CONST},
{input:"glb",  tag:"mo", output:"glb", tex:null, ttype:CONST},
{input:"min",  tag:"mo", output:"min", tex:null, ttype:UNDEROVER},
{input:"max",  tag:"mo", output:"max", tex:null, ttype:UNDEROVER},

//arrows
{input:"uarr", tag:"mo", output:"\u2191", tex:"uparrow", ttype:CONST},
{input:"darr", tag:"mo", output:"\u2193", tex:"downarrow", ttype:CONST},
{input:"rarr", tag:"mo", output:"\u2192", tex:"rightarrow", ttype:CONST},
{input:"->",   tag:"mo", output:"\u2192", tex:"to", ttype:CONST},
{input:">->",   tag:"mo", output:"\u21A3", tex:"rightarrowtail", ttype:CONST},
{input:"->>",   tag:"mo", output:"\u21A0", tex:"twoheadrightarrow", ttype:CONST},
{input:">->>",   tag:"mo", output:"\u2916", tex:"twoheadrightarrowtail", ttype:CONST},
{input:"|->",  tag:"mo", output:"\u21A6", tex:"mapsto", ttype:CONST},
{input:"larr", tag:"mo", output:"\u2190", tex:"leftarrow", ttype:CONST},
{input:"harr", tag:"mo", output:"\u2194", tex:"leftrightarrow", ttype:CONST},
{input:"rArr", tag:"mo", output:"\u21D2", tex:"Rightarrow", ttype:CONST},
{input:"lArr", tag:"mo", output:"\u21D0", tex:"Leftarrow", ttype:CONST},
{input:"hArr", tag:"mo", output:"\u21D4", tex:"Leftrightarrow", ttype:CONST},

//commands with argument
AMsqrt, AMroot, AMfrac, AMdiv, AMover, AMsub, AMsup,
{input:"cancel", tag:"menclose", output:"cancel", tex:null, ttype:UNARY},
{input:"Sqrt", tag:"msqrt", output:"sqrt", tex:null, ttype:UNARY},
{input:"hat", tag:"mover", output:"\u005E", tex:null, ttype:UNARY, acc:true},
{input:"bar", tag:"mover", output:"\u00AF", tex:"overline", ttype:UNARY, acc:true},
{input:"vec", tag:"mover", output:"\u2192", tex:null, ttype:UNARY, acc:true},
{input:"tilde", tag:"mover", output:"~", tex:null, ttype:UNARY, acc:true},
{input:"dot", tag:"mover", output:".",      tex:null, ttype:UNARY, acc:true},
{input:"ddot", tag:"mover", output:"..",    tex:null, ttype:UNARY, acc:true},
{input:"overarc", tag:"mover", output:"\u23DC", tex:"stackrel{\\frown}", notexcopy: true, ttype:UNARY, acc:true},
{input:"overparen", tag:"mover", output:"\u23DC", tex:"stackrel{\\frown}", notexcopy: true, ttype:UNARY, acc:true},
{input:"ul", tag:"munder", output:"\u0332", tex:"underline", ttype:UNARY, acc:true},
{input:"ubrace", tag:"munder", output:"\u23DF", tex:"underbrace", ttype:UNARY, acc:true},
{input:"obrace", tag:"mover", output:"\u23DE", tex:"overbrace", ttype:UNARY, acc:true},
AMtext, AMmbox, AMquote,
//{input:"var", tag:"mstyle", atname:"fontstyle", atval:"italic", output:"var", tex:null, ttype:UNARY},
{input:"color", tag:"mstyle", ttype:BINARY},
{input:"bb", tag:"mstyle", atname:"mathvariant", atval:"bold", output:"bb", tex:"mathbf", ttype:UNARY, notexcopy:true},
{input:"mathbf", tag:"mstyle", atname:"mathvariant", atval:"bold", output:"mathbf", tex:null, ttype:UNARY},
{input:"sf", tag:"mstyle", atname:"mathvariant", atval:"sans-serif", output:"sf", tex:"mathsf", ttype:UNARY, notexcopy:true},
{input:"mathsf", tag:"mstyle", atname:"mathvariant", atval:"sans-serif", output:"mathsf", tex:null, ttype:UNARY},
{input:"bbb", tag:"mstyle", atname:"mathvariant", atval:"double-struck", output:"bbb", tex:"mathbb", ttype:UNARY, notexcopy:true},
{input:"mathbb", tag:"mstyle", atname:"mathvariant", atval:"double-struck", output:"mathbb", tex:null, ttype:UNARY},
{input:"cc",  tag:"mstyle", atname:"mathvariant", atval:"script", output:"cc", tex:"mathcal", ttype:UNARY, notexcopy:true},
{input:"mathcal", tag:"mstyle", atname:"mathvariant", atval:"script", output:"mathcal", tex:null, ttype:UNARY},
{input:"tt",  tag:"mstyle", atname:"mathvariant", atval:"monospace", output:"tt", tex:"mathtt", ttype:UNARY, notexcopy:true},
{input:"mathtt", tag:"mstyle", atname:"mathvariant", atval:"monospace", output:"mathtt", tex:null, ttype:UNARY},
{input:"fr",  tag:"mstyle", atname:"mathvariant", atval:"fraktur", output:"fr", tex:"mathfrak", ttype:UNARY, notexcopy:true},
{input:"mathfrak",  tag:"mstyle", atname:"mathvariant", atval:"fraktur", output:"mathfrak", tex:null, ttype:UNARY}
];

function compareNames(s1,s2) {
  if (s1.input > s2.input) return 1
  else return -1;
}

var AMnames = []; //list of input symbols

function AMinitSymbols() {
  var i;
  var symlen = AMsymbols.length;
  for (i=0; i<symlen; i++) {
    if (AMsymbols[i].tex && !(typeof AMsymbols[i].notexcopy == "boolean" && AMsymbols[i].notexcopy)) {
       AMsymbols.push({input:AMsymbols[i].tex,
        tag:AMsymbols[i].tag, output:AMsymbols[i].output, ttype:AMsymbols[i].ttype,
        acc:(AMsymbols[i].acc||false)});
    }
  }
  refreshSymbols();
}

function refreshSymbols(){
  var i;
  AMsymbols.sort(compareNames);
  for (i=0; i<AMsymbols.length; i++) AMnames[i] = AMsymbols[i].input;
}

function newcommand(oldstr,newstr) {
  AMsymbols.push({input:oldstr, tag:"mo", output:newstr, tex:null, ttype:DEFINITION});
  refreshSymbols();
}

function newsymbol(symbolobj) {
  AMsymbols.push(symbolobj);
  refreshSymbols();
}

function AMremoveCharsAndBlanks(str,n) {
//remove n characters and any following blanks
  var st;
  if (str.charAt(n)=="\\" && str.charAt(n+1)!="\\" && str.charAt(n+1)!=" ")
    st = str.slice(n+1);
  else st = str.slice(n);
  for (var i=0; i<st.length && st.charCodeAt(i)<=32; i=i+1);
  return st.slice(i);
}

function AMposition(arr, str, n) {
// return position >=n where str appears or would be inserted
// assumes arr is sorted
  if (n==0) {
    var h,m;
    n = -1;
    h = arr.length;
    while (n+1<h) {
      m = (n+h) >> 1;
      if (arr[m]<str) n = m; else h = m;
    }
    return h;
  } else
    for (var i=n; i<arr.length && arr[i]<str; i++);
  return i; // i=arr.length || arr[i]>=str
}

function AMgetSymbol(str) {
//return maximal initial substring of str that appears in names
//return null if there is none
  var k = 0; //new pos
  var j = 0; //old pos
  var mk; //match pos
  var st;
  var tagst;
  var match = "";
  var more = true;
  for (var i=1; i<=str.length && more; i++) {
    st = str.slice(0,i); //initial substring of length i
    j = k;
    k = AMposition(AMnames, st, j);
    if (k<AMnames.length && str.slice(0,AMnames[k].length)==AMnames[k]){
      match = AMnames[k];
      mk = k;
      i = match.length;
    }
    more = k<AMnames.length && str.slice(0,AMnames[k].length)>=AMnames[k];
  }
  AMpreviousSymbol=AMcurrentSymbol;
  if (match!=""){
    AMcurrentSymbol=AMsymbols[mk].ttype;
    return AMsymbols[mk];
  }
// if str[0] is a digit or - return maxsubstring of digits.digits
  AMcurrentSymbol=CONST;
  k = 1;
  st = str.slice(0,1);
  var integ = true;

  while ("0"<=st && st<="9" && k<=str.length) {
    st = str.slice(k,k+1);
    k++;
  }
  if (st == config.decimalsign) {
    st = str.slice(k,k+1);
    if ("0"<=st && st<="9") {
      integ = false;
      k++;
      while ("0"<=st && st<="9" && k<=str.length) {
        st = str.slice(k,k+1);
        k++;
      }
    }
  }
  if ((integ && k>1) || k>2) {
    st = str.slice(0,k-1);
    tagst = "mn";
  } else {
    k = 2;
    st = str.slice(0,1); //take 1 character
    tagst = (("A">st || st>"Z") && ("a">st || st>"z")?"mo":"mi");
  }
  if (st=="-" && AMpreviousSymbol==INFIX) {
    AMcurrentSymbol = INFIX;
    return {input:st, tag:tagst, output:st, ttype:UNARY, func:true, val:true};
  }
  return {input:st, tag:tagst, output:st, ttype:CONST, val:true}; //added val bit
}

function AMTremoveBrackets(node) {

  var st;
  if (node.charAt(0)=='{' && node.charAt(node.length-1)=='}') {
    var leftchop = 0;

    st = node.substr(1,5);
    if (st=='\\left') {
    	    st = node.charAt(6);
    	    if (st=="(" || st=="[" || st=="{") {
    	    	    leftchop = 7;
    	    } else {
    	    	    st = node.substr(6,7);
    	    	    if (st=='\\lbrace') {
    	    	    	    leftchop = 13;
    	    	    }
    	    }
    } else {
    	    st = node.charAt(1);
    	    if (st=="(" || st=="[") {
    	    	    leftchop = 2;
    	    }
    }
    if (leftchop>0) {
    	    //st = node.charAt(node.length-7);
    	    st = node.substr(node.length-8);
    	    if (st=="\\right)}" || st=="\\right]}" || st=='\\right.}') {
    	    	    node = '{'+node.substr(leftchop);
    	    	    node = node.substr(0,node.length-8)+'}';
    	    } else if (st=='\\rbrace}') {
    	    	    node = '{'+node.substr(leftchop);
    	    	    node = node.substr(0,node.length-14)+'}';
    	    }
    }
  }
  return node;
}

/*Parsing ASCII math expressions with the following grammar
v ::= [A-Za-z] | greek letters | numbers | other constant symbols
u ::= sqrt | text | bb | other unary symbols for font commands
b ::= frac | root | stackrel         binary symbols
l ::= ( | [ | { | (: | {:            left brackets
r ::= ) | ] | } | :) | :}            right brackets
S ::= v | lEr | uS | bSS             Simple expression
I ::= S_S | S^S | S_S^S | S          Intermediate expression
E ::= IE | I/I                       Expression
Each terminal symbol is translated into a corresponding mathml node.*/

var AMnestingDepth,AMpreviousSymbol,AMcurrentSymbol;

function AMTgetTeXsymbol(symb) {
	if (typeof symb.val == "boolean" && symb.val) {
		pre = '';
	} else {
		pre = '\\';
	}
	if (symb.tex==null) {
		//can't remember why this was here.  Breaks /delta /Delta to removed
		//return (pre+(pre==''?symb.input:symb.input.toLowerCase()));
		return (pre+symb.input);
	} else {
		return (pre+symb.tex);
	}
}

function AMTparseSexpr(str) { //parses str and returns [node,tailstr]
  var symbol, node, result, i, st,// rightvert = false,
    newFrag = '';
  str = AMremoveCharsAndBlanks(str,0);
  symbol = AMgetSymbol(str);             //either a token or a bracket or empty
  if (symbol == null || symbol.ttype == RIGHTBRACKET && AMnestingDepth > 0) {
    return [null,str];
  }
  if (symbol.ttype == DEFINITION) {
    str = symbol.output+AMremoveCharsAndBlanks(str,symbol.input.length);
    symbol = AMgetSymbol(str);
  }
  switch (symbol.ttype) {
  case UNDEROVER:
  case CONST:
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
     var texsymbol = AMTgetTeXsymbol(symbol);
     if (texsymbol.charAt(0)=="\\" || symbol.tag=="mo") return [texsymbol,str];
     else return ['{'+texsymbol+'}',str];

  case LEFTBRACKET:   //read (expr+)
    AMnestingDepth++;
    str = AMremoveCharsAndBlanks(str,symbol.input.length);

    result = AMTparseExpr(str,true);
    AMnestingDepth--;
    var leftchop = 0;
    if (result[0].substr(0,6)=="\\right") {
    	    st = result[0].charAt(6);
    	    if (st==")" || st=="]" || st=="}") {
    	    	    leftchop = 6;
    	    } else if (st==".") {
    	    	    leftchop = 7;
    	    } else {
    	    	    st = result[0].substr(6,7);
    	    	    if (st=='\\rbrace') {
    	    	    	    leftchop = 13;
    	    	    }
    	    }
    }
    if (leftchop>0) {
	    result[0] = result[0].substr(leftchop);
	    if (typeof symbol.invisible == "boolean" && symbol.invisible)
		    node = '{'+result[0]+'}';
	    else {
		    node = '{'+AMTgetTeXsymbol(symbol) + result[0]+'}';
	    }
    } else {
	    if (typeof symbol.invisible == "boolean" && symbol.invisible)
		    node = '{\\left.'+result[0]+'}';
	    else {
		    node = '{\\left'+AMTgetTeXsymbol(symbol) + result[0]+'}';
	    }
    }
    return [node,result[1]];
  case TEXT:
      if (symbol!=AMquote) str = AMremoveCharsAndBlanks(str,symbol.input.length);
      if (str.charAt(0)=="{") i=str.indexOf("}");
      else if (str.charAt(0)=="(") i=str.indexOf(")");
      else if (str.charAt(0)=="[") i=str.indexOf("]");
      else if (symbol==AMquote) i=str.slice(1).indexOf("\"")+1;
      else i = 0;
      if (i==-1) i = str.length;
      st = str.slice(1,i);
      if (st.charAt(0) == " ") {
	      newFrag = '\\ ';
      }
     newFrag += '\\text{'+st+'}';
      if (st.charAt(st.length-1) == " ") {
	      newFrag += '\\ ';
      }
      str = AMremoveCharsAndBlanks(str,i+1);
      return [newFrag,str];
  case UNARY:
      str = AMremoveCharsAndBlanks(str,symbol.input.length);
      result = AMTparseSexpr(str);
      if (result[0]==null) return ['{'+AMTgetTeXsymbol(symbol)+'}',str];
      if (typeof symbol.func == "boolean" && symbol.func) { // functions hack
        st = str.charAt(0);
        if (st=="^" || st=="_" || st=="/" || st=="|" || st=="," || (symbol.input.length==1 && symbol.input.match(/\w/) && st!="(")) {
          return ['{'+AMTgetTeXsymbol(symbol)+'}',str];
        } else {
		node = '{'+AMTgetTeXsymbol(symbol)+'{'+result[0]+'}}';
		return [node,result[1]];
        }
      }
      result[0] = AMTremoveBrackets(result[0]);
      if (symbol.input == "sqrt") {           // sqrt
	      return ['\\sqrt{'+result[0]+'}',result[1]];
      } else if (symbol.input == "cancel") {           // cancel
	      return ['\\cancel{'+result[0]+'}',result[1]];
      } else if (typeof symbol.rewriteleftright != "undefined") {  // abs, floor, ceil
	      return ['{\\left'+symbol.rewriteleftright[0]+result[0]+'\\right'+symbol.rewriteleftright[1]+'}',result[1]];
      } else if (typeof symbol.acc == "boolean" && symbol.acc) {   // accent
	      //return ['{'+AMTgetTeXsymbol(symbol)+'{'+result[0]+'}}',result[1]];
	      return [AMTgetTeXsymbol(symbol)+'{'+result[0]+'}',result[1]];
      } else {                        // font change command
	    return ['{'+AMTgetTeXsymbol(symbol)+'{'+result[0]+'}}',result[1]];
      }
  case BINARY:
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    result = AMTparseSexpr(str);
    if (result[0]==null) return ['{'+AMTgetTeXsymbol(symbol)+'}',str];
    result[0] = AMTremoveBrackets(result[0]);
    var result2 = AMTparseSexpr(result[1]);
    if (result2[0]==null) return ['{'+AMTgetTeXsymbol(symbol)+'}',str];
    result2[0] = AMTremoveBrackets(result2[0]);
    if (symbol.input=="color") {
    	newFrag = '{\\color{'+result[0].replace(/[\{\}]/g,'')+'}'+result2[0]+'}';
    } else  if (symbol.input=="root") {
	    newFrag = '{\\sqrt['+result[0]+']{'+result2[0]+'}}';
    } else {
	    newFrag = '{'+AMTgetTeXsymbol(symbol)+'{'+result[0]+'}{'+result2[0]+'}}';
    }
    return [newFrag,result2[1]];
  case INFIX:
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    return [symbol.output,str];
  case SPACE:
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    return ['{\\quad\\text{'+symbol.input+'}\\quad}',str];
  case LEFTRIGHT:
//    if (rightvert) return [null,str]; else rightvert = true;
    AMnestingDepth++;
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    result = AMTparseExpr(str,false);
    AMnestingDepth--;
    var st = "";
    st = result[0].charAt(result[0].length -1);
//alert(result[0].lastChild+"***"+st);
    if (st == "|" && str.charAt(0)!==",") { // its an absolute value subterm
	    node = '{\\left|'+result[0]+'}';
      return [node,result[1]];
    } else { // the "|" is a \mid
      node = '{\\mid}';
      return [node,str];
    }

  default:
//alert("default");
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    return ['{'+AMTgetTeXsymbol(symbol)+'}',str];
  }
}

function AMTparseIexpr(str) {
  var symbol, sym1, sym2, node, result;
  str = AMremoveCharsAndBlanks(str,0);
  sym1 = AMgetSymbol(str);
  result = AMTparseSexpr(str);
  node = result[0];
  str = result[1];
  symbol = AMgetSymbol(str);
  if (symbol.ttype == INFIX && symbol.input != "/") {
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
   // if (symbol.input == "/") result = AMTparseIexpr(str); else
    result = AMTparseSexpr(str);
    if (result[0] == null) // show box in place of missing argument
	    result[0] = '{}';
    else result[0] = AMTremoveBrackets(result[0]);
    str = result[1];
//    if (symbol.input == "/") AMTremoveBrackets(node);
    if (symbol.input == "_") {
      sym2 = AMgetSymbol(str);
      if (sym2.input == "^") {
        str = AMremoveCharsAndBlanks(str,sym2.input.length);
        var res2 = AMTparseSexpr(str);
        res2[0] = AMTremoveBrackets(res2[0]);
        str = res2[1];
        node = '{' + node;
       	node += '_{'+result[0]+'}';
	node += '^{'+res2[0]+'}';
        node += '}';
      } else {
        node += '_{'+result[0]+'}';
      }
    } else { //must be ^
      //node = '{'+node+'}^{'+result[0]+'}';
      node = node+'^{'+result[0]+'}';
    }
    if (typeof sym1.func != 'undefined' && sym1.func) {
    	sym2 = AMgetSymbol(str);
    	if (sym2.ttype != INFIX && sym2.ttype != RIGHTBRACKET &&
    	    (sym1.input.length>1 || sym2.ttype == LEFTBRACKET)) {
    		result = AMTparseIexpr(str);
    		node = '{'+node+result[0]+'}';
    		str = result[1];
    	}
    }
  }

  return [node,str];
}

function AMTparseExpr(str,rightbracket) {
  var symbol, node, result, i, nodeList = [],
  newFrag = '';
  var addedright = false;
  do {
    str = AMremoveCharsAndBlanks(str,0);
    result = AMTparseIexpr(str);
    node = result[0];
    str = result[1];
    symbol = AMgetSymbol(str);
    if (symbol.ttype == INFIX && symbol.input == "/") {
      str = AMremoveCharsAndBlanks(str,symbol.input.length);
      result = AMTparseIexpr(str);

      if (result[0] == null) // show box in place of missing argument
	      result[0] = '{}';
      else result[0] = AMTremoveBrackets(result[0]);
      str = result[1];
      node = AMTremoveBrackets(node);
      node = '\\frac' + '{'+ node + '}';
      node += '{'+result[0]+'}';
      newFrag += node;
      symbol = AMgetSymbol(str);
    }  else if (node!=undefined) newFrag += node;
  } while ((symbol.ttype != RIGHTBRACKET &&
           (symbol.ttype != LEFTRIGHT || rightbracket)
           || AMnestingDepth == 0) && symbol!=null && symbol.output!="");
  if (symbol.ttype == RIGHTBRACKET || symbol.ttype == LEFTRIGHT) {
//    if (AMnestingDepth > 0) AMnestingDepth--;
	var len = newFrag.length;
	if (len>2 && newFrag.charAt(0)=='{' && newFrag.indexOf(',')>0) { //could be matrix (total rewrite from .js)
		var right = newFrag.charAt(len - 2);
		if (right==')' || right==']') {
			var left = newFrag.charAt(6);
			if ((left=='(' && right==')' && symbol.output != '}') || (left=='[' && right==']')) {
				var mxout = '';
				var pos = new Array(); //position of commas
				pos.push(0);
				var matrix = true;
				var mxnestingd = 0;
				var subpos = [];
				subpos[0] = [0];
				var lastsubposstart = 0;
				var mxanynestingd = 0;
				var columnaligns = '';
				for (i=1; i<len-1; i++) {
					if (newFrag.charAt(i)==left) mxnestingd++;
					if (newFrag.charAt(i)==right) {
						mxnestingd--;
						if (mxnestingd==0 && newFrag.charAt(i+2)==',' && newFrag.charAt(i+3)=='{') {
							pos.push(i+2);
							lastsubposstart = i+2;
							subpos[lastsubposstart] = [i+2];
						}
					}
					if (newFrag.charAt(i)=='[' || newFrag.charAt(i)=='(' || newFrag.charAt(i)=='{') { mxanynestingd++;}
					if (newFrag.charAt(i)==']' || newFrag.charAt(i)==')' || newFrag.charAt(i)=='}') { mxanynestingd--;}
					if (newFrag.charAt(i)==',' && mxanynestingd==1) {
						subpos[lastsubposstart].push(i);
					}
					if (mxanynestingd<0) {  //happens at the end of the row
						if (lastsubposstart == i+1) { //if at end of row, skip to next row
							i++;
						} else { //misformed something - abandon treating as a matrix
							matrix = false;
						}
					}
				}

				pos.push(len);
				var lastmxsubcnt = -1;
				if (mxnestingd==0 && pos.length>0 && matrix) {
					for (i=0;i<pos.length-1;i++) {
						if (i>0) mxout += '\\\\';
						if (i==0) {
							//var subarr = newFrag.substr(pos[i]+7,pos[i+1]-pos[i]-15).split(',');
							if (subpos[pos[i]].length==1) {
								var subarr = [newFrag.substr(pos[i]+7,pos[i+1]-pos[i]-15)];
							} else {
								var subarr = [newFrag.substring(pos[i]+7,subpos[pos[i]][1])];
								for (var j=2;j<subpos[pos[i]].length;j++) {
									subarr.push(newFrag.substring(subpos[pos[i]][j-1]+1,subpos[pos[i]][j]));
								}
								subarr.push(newFrag.substring(subpos[pos[i]][subpos[pos[i]].length-1]+1,pos[i+1]-8));
							}
						} else {
							//var subarr = newFrag.substr(pos[i]+8,pos[i+1]-pos[i]-16).split(',');
							if (subpos[pos[i]].length==1) {
								var subarr = [newFrag.substr(pos[i]+8,pos[i+1]-pos[i]-16)];
							} else {
								var subarr = [newFrag.substring(pos[i]+8,subpos[pos[i]][1])];
								for (var j=2;j<subpos[pos[i]].length;j++) {
									subarr.push(newFrag.substring(subpos[pos[i]][j-1]+1,subpos[pos[i]][j]));
								}
								subarr.push(newFrag.substring(subpos[pos[i]][subpos[pos[i]].length-1]+1,pos[i+1]-8));
							}
						}
						for (j=subarr.length-1;j>=0;j--) {
							if (subarr[j]=="{\\mid}") {
								if (i==0) {
									columnaligns = "|"+columnaligns;
								}
								subarr.splice(j,1);
							} else if (i==0) {
								columnaligns = "c"+columnaligns;
							}
						}
						if (lastmxsubcnt>0 && subarr.length!=lastmxsubcnt) {
							matrix = false;
						} else if (lastmxsubcnt==-1) {
							lastmxsubcnt=subarr.length;
						}
						mxout += subarr.join('&');
					}
				}
				mxout = "\\begin{array}{"+columnaligns+"} "+mxout+"\\end{array}";

				if (matrix) { newFrag = mxout;}
			}
		}
	}

    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    if (typeof symbol.invisible != "boolean" || !symbol.invisible) {
      node = '\\right'+AMTgetTeXsymbol(symbol); //AMcreateMmlNode("mo",document.createTextNode(symbol.output));
      newFrag += node;
      addedright = true;
    } else {
	    newFrag += '\\right.';
	    addedright = true;
    }

  }
  if(AMnestingDepth>0 && !addedright) {
	  newFrag += '\\right.'; //adjust for non-matching left brackets
	  //todo: adjust for non-matching right brackets
  }

  return [newFrag,str];
}

function AMTparseAMtoTeX(str) {
 AMnestingDepth = 0;
  str = str.replace(/(&nbsp;|\u00a0|&#160;)/g,"");
  str = str.replace(/&gt;/g,">");
  str = str.replace(/&lt;/g,"<");
  if (str.match(/\S/)==null) {
	  return "";
  }
  return AMTparseExpr(str.replace(/^\s+/g,""),false)[0];
}

function AMparseMath(str) {
 //DLMOD to remove &nbsp;, which editor adds on multiple spaces
  str = str.replace(/(&nbsp;|\u00a0|&#160;)/g,"");
  str = str.replace(/&gt;/g,">");
  str = str.replace(/&lt;/g,"<");
  if (str.match(/\S/)==null) {
	  return document.createTextNode(" ");
  }
  var texstring = AMTparseAMtoTeX(str);

  if (typeof mathbg != "undefined" && mathbg=='dark') {
	  texstring = "\\reverse " + texstring;
  }
  if (config.mathcolor!="") {
	  texstring = "\\"+config.mathcolor + texstring;
  }
  if (config.displaystyle) {
	  texstring = "\\displaystyle" + texstring;
  } else {
	  texstring = "\\textstyle" + texstring;
  }
  texstring = texstring.replace(/\$/g,'\\$');

  var node = document.createElement("img");
  if (typeof encodeURIComponent == "function") {
	  texstring = encodeURIComponent(texstring);
  } else {
	  texstring = escape(texstring);
  }
  node.src = AMTcgiloc + '?' + texstring;
  node.style.verticalAlign = "middle";
  if (config.showasciiformulaonhover)                      //fixed by djhsu so newline
    node.setAttribute("title",str.replace(/\s+/g," "));//does not show in Gecko

  var snode = document.createElement("span");
  snode.appendChild(node); //chg
  return snode;
}
//alias to align with wFallback function
function AMTparseMath(str) {
	return AMparseMath(str);
}

function AMstrarr2docFrag(arr, linebreaks) {
  var newFrag=document.createDocumentFragment();
  var expr = false;
  for (var i=0; i<arr.length; i++) {
    if (expr) newFrag.appendChild(AMparseMath(arr[i]));
    else {
      var arri = (linebreaks ? arr[i].split("\n\n") : [arr[i]]);
      newFrag.appendChild(document.createElement("span").
      appendChild(document.createTextNode(arri[0])));
      for (var j=1; j<arri.length; j++) {
        newFrag.appendChild(document.createElement("p"));
        newFrag.appendChild(document.createElement("span").
        appendChild(document.createTextNode(arri[j])));
      }
    }
    expr = !expr;
  }
  return newFrag;
}

function AMprocessNodeR(n, linebreaks) {
  var mtch, str, arr, frg, i;
  if (n.childNodes.length == 0) {
   if ((n.nodeType!=8 || linebreaks) &&
    n.parentNode.nodeName!="form" && n.parentNode.nodeName!="FORM" &&
    n.parentNode.nodeName!="textarea" && n.parentNode.nodeName!="TEXTAREA" &&
    n.parentNode.nodeName!="pre" && n.parentNode.nodeName!="PRE") {
    str = n.nodeValue;
    if (!(str == null)) {
      str = str.replace(/\r\n\r\n/g,"\n\n");
      if (config.doubleblankmathdelimiter) {
        str = str.replace(/\x20\x20\./g," "+config.AMdelimiter1+".");
        str = str.replace(/\x20\x20,/g," "+config.AMdelimiter1+",");
        str = str.replace(/\x20\x20/g," "+config.AMdelimiter1+" ");
      }
      str = str.replace(/\x20+/g," ");
      str = str.replace(/\s*\r\n/g," ");
       mtch = false;
      if (config.AMusedelimiter2) {
      str = str.replace(new RegExp(config.AMescape2, "g"),
              function(st){mtch=true;return "AMescape2"});
      }
      str = str.replace(new RegExp(config.AMescape1, "g"),
              function(st){mtch=true;return "AMescape1"});
     if (config.AMusedelimiter2)  str = str.replace(new RegExp(config.AMdelimiter2regexp, "g"),config.AMdelimiter1);
      arr = str.split(config.AMdelimiter1);
      for (i=0; i<arr.length; i++)
      	if (config.AMusedelimiter2) {
		arr[i]=arr[i].replace(/AMescape2/g,config.AMdelimiter2).replace(/AMescape1/g,config.AMdelimiter1);
	} else {
		arr[i]=arr[i].replace(/AMescape1/g,config.AMdelimiter1);
	}
      if (arr.length>1 || mtch) {

      frg = AMstrarr2docFrag(arr,n.nodeType==8);
      var len = frg.childNodes.length;
      n.parentNode.replaceChild(frg,n);
      return len-1;

      }
    }
   } else return 0;
  } else if (n.nodeName!="math") { //should this change to img?
    for (i=0; i<n.childNodes.length; i++)
      i += AMprocessNodeR(n.childNodes[i], linebreaks);
  }
  return 0;
}

function AMprocessNode(n, linebreaks, spanclassAM) {
  var frag,st;
  if (spanclassAM!=null) {
    frag = document.getElementsByTagName("span");
    for (var i=0;i<frag.length;i++)
      if (frag[i].className == "AM")
        AMprocessNodeR(frag[i],linebreaks);
  } else {
    try {
      st = n.innerHTML;
    } catch(err) {}
    if (st==null ||
        st.indexOf(config.AMdelimiter1)!=-1)// || st.indexOf(config.AMdelimiter2)!=-1)
      AMprocessNodeR(n,linebreaks);
  }
}

function translate(spanclassAM) {
  if (!AMtranslated) { // run this only once
    AMtranslated = true;
    var body = document.getElementsByTagName("body")[0];
    var processN = document.getElementById(config.AMdocumentId);
    AMprocessNode((processN!=null?processN:body), false, spanclassAM);
  }
}

var AMbody;
var AMtranslated = false;
var AMnoMathML = true;

AMinitSymbols();

window.AMTparseAMtoTeX = AMTparseAMtoTeX;

function generic(){
  if (config.translateOnLoad) {
      translate();
  }
}

//setup onload function
if(typeof window.addEventListener != 'undefined'){
  //.. gecko, safari, konqueror and standard
  window.addEventListener('load', generic, false);
}
else if(typeof document.addEventListener != 'undefined'){
  //.. opera 7
  document.addEventListener('load', generic, false);
}
else if(typeof window.attachEvent != 'undefined'){
  //.. win/ie
  window.attachEvent('onload', generic);
}else{
  //.. mac/ie5 and anything else that gets this far
  //if there's an existing onload function
  if(typeof window.onload == 'function'){
    //store it
    var existing = onload;
    //add new onload handler
    window.onload = function(){
      //call existing onload function
      existing();
      //call generic onload function
      generic();
    };
  }else{
    window.onload = generic;
  }
}
})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'xslt/xslt.js' */
/*! xslt v0.9.1+master.0.67dff610fd9b | (c) 2017 Justin Murray | built on 2017-08-09 */

(function(){var e=[].slice,n=[].indexOf||function(e){for(var n=0,r=this.length;n<r;n++)if(n in this&&this[n]===e)return n;return-1};!function(e,n){"function"==typeof define&&null!=define.amd?define([],function(){return n(e)}):"object"==typeof("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=n(e):null!=e&&(e.xslt=n(e))}(this,function(r){var t,l,o,u,i,a,c,s,m,d,f,p,v,x,g,M,D,h,y,N,E,O,X,L,S,T,w,z,b,F,H,P,A;return S={xmlNode:function(){return/<([a-z_][a-z_0-9:\.\-]*\b)\s*(?:\/(?!>)|[^>\/])*(\/?)>/i},xmlLike:function(){return/^\s*</},xmlHeader:function(){return/^\s*<\?xml\b[^<]+/i},namespaces:function(){return/\bxmlns(?::([a-z0-9:\-]+))?\s*=\s*"([^"]*)"/gi}},y=function(e){return S.xmlLike().test(e)},h=function(e){return S.xmlHeader().test(e)},O=function(e){return y(e)&&!h(e)},A=function(e,n){var r;return r='<?xml version="1.0" ',null!=e&&(r+='encoding="'+e+'" '),null!=n&&(r+='standalone="'+n+'" '),r+="?>"},L=function(e,n,r){return A(n,r)+e},b=function(e){return null!=e?e.replace(S.xmlHeader(),""):void 0},g=function(e){var n,r;return(null!=(n=null!=e?e.match(S.xmlHeader()):void 0)?n.length:void 0)&&(null!=(r=n[0])&&"function"==typeof r.trim?r.trim():void 0)||null},v=function(e,n){var r;return(null!=(r=new RegExp("\\b"+n+'\\s*=\\s*"([^"]*)"',"g").exec(e))?r.length:void 0)>1&&r[1]||null},M=function(e){return v(g(e),"encoding")},D=function(e){return v(g(e),"standalone")},l="undefined"!=typeof ActiveXObject&&null!==ActiveXObject||"ActiveXObject"in r,P=function(){var n,r,t,o;if(o=1<=arguments.length?e.call(arguments,0):[],!l)return null;for(n=0,t=o.length;n<t;n++){r=o[n];try{return new ActiveXObject(r)}catch(e){}}return null},c=function(){var e;if(null!=(e=P.apply(null,["Msxml2.FreeThreadedDOMDocument.6.0","Msxml2.FreeThreadedDOMDocument.3.0","Msxml2.FreeThreadedDOMDocument","Microsoft.XMLDOM","Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","Msxml2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument"])))for(e.async=!1;4!==e.readyState;);return e},s=function(){return P.apply(null,["Msxml2.XSLTemplate.6.0","Msxml2.XSLTemplate"])},E=function(){var e,n;return n=document.createElement("xml"),n.src=A(),document.body.appendChild(n),e=n.XMLDocument,document.body.removeChild(n),e},X=function(){var e,n;return null==(e=null)&&(e=c()),"undefined"!=typeof DOMParser&&null!==DOMParser?e:(null==e&&(e=E()),null==e&&(e=null!=(n=document.implementation)&&"function"==typeof n.createDocument?n.createDocument("","test",null):void 0),e)},T=function(e){var n,r,t,l,o;if("string"!=typeof e||!y(e))return null;if(O(e)&&(e=L(e)),null!=(n=X())&&"loadXML"in n){if(n.loadXML(e),null==n.documentElement||0!==(null!=(r=n.parseError)?r.errorCode:void 0))throw new Error("loadXML error: "+n.parseError)}else if(null!=n&&"load"in n)n.load(e);else if("undefined"!=typeof DOMParser&&null!==DOMParser&&((null!=(n=null!=(t=new DOMParser)&&"function"==typeof t.parseFromString?t.parseFromString(e,"text/xml"):void 0)&&"function"==typeof n.getElementsByTagName&&null!=(l=n.getElementsByTagName("parsererror"))?l.length:void 0)>0||"parsererror"===(null!=n&&null!=(o=n.documentElement)?o.nodeName:void 0)))throw new Error("Failed to load document from string:\r\n"+n.documentElement.textContent);return n},d=function(e){var n,r;return null==e?null:((null!=(r="string"==typeof e?e:null!=(null!=e?e.xml:void 0)?e.xml:"undefined"!=typeof XMLSerializer&&null!==XMLSerializer?null!=(n=new XMLSerializer)&&"function"==typeof n.serializeToString?n.serializeToString(e):void 0:null)&&"function"==typeof r.indexOf?r.indexOf("<transformiix::result"):void 0)>=0&&(r=r.substring(r.indexOf(">")+1,r.lastIndexOf("<"))),r)},x=function(e,n){var r,t,l,o,u,i,a,c;for(r=/\s([a-z0-9:\-]+)\s*=\s*("([^"]*)"|'([^']*)')/gi,t={};a=r.exec(e);)a[0],u=a[1],i=a[2],l=a[3],o=a[4],c={outer:i,inner:l||o},("function"==typeof n?n(u,c):void 0)||(t[u]=c);return t},o=function(e,n,r){var t,l;null==n&&(n={}),null==r&&(r=""),t="<"+e;for(l in n)t+=" "+l+"="+n[l].outer;return t+=r+">"},u=function(e,r,t,l){var u,i,a,c,s,m,d;i=x(e,function(e,r){var t;return/^xmlns/.test(e)&&(t=r.inner,n.call(l.excludedNamespaceUris,t)>=0)}),s=l.includeNamespaces;for(c in s)m=s[c],n.call(function(){var e;e=[];for(a in i)d=i[a],e.push(d.inner);return e}(),m)<0&&(u="xmlns",c.length&&(u+=":"+c),i[u]={outer:'"'+m+'"',inner:m});return o(r,i,t)},z=function(e,r,t,l){var u;return null==l&&(l=[]),u=x(e,function(e,r){var t;return t=r.inner,n.call(l,t)>=0}),o(r,u,t)},H=function(e){return e.replace(/xmlns\s*=\s*""/gi,"")},w=function(e){return e.replace(S.namespaces(),"")},F=function(e){var n,r,t,l;for(l=[],e=e.replace(/xmlns:NS([0-9]+)=""/gi,function(e,n){return l.push(n),""}),n=0,r=l.length;n<r;n++)t=l[n],e=e.replace(new RegExp("NS"+t+":xmlns:","g"),"xmlns:");return e},p=function(e,r){var t;return null==r&&(r=[]),t={},e=null!=e?e.replace(S.namespaces(),function(e,l,o){return null==l&&(l=""),null!=t[l]&&t[l]!==o?e:n.call(r,o)>=0?"":(t[l]=o,"")}):void 0,{xml:e,ns:t}},i=function(e,n){var r,t;return t=[],r=!0,null!=e?e.replace(new RegExp(S.xmlNode().source,"gi"),function(e,l,o){var i,a,c,s,m,d,f;if(n.removeNamespacedNamespace&&(e=F(e)),n.removeNullNamespace&&(e=H(e)),n.removeAllNamespaces&&(e=w(e)),r)for(r=!1,e=u(e,l,o,n),m=x(e,function(e){return!/^xmlns/.test(e)}),t=function(){var e;e=[];for(c in m)f=m[c],e.push(f.inner);return e}(),i=0,a=(s=n.excludedNamespaceUris).length;i<a;i++)d=s[i],t.push(d);else(n.removeDupAttrs||n.removeDupNamespace)&&(e=z(e,l,o,t));return e}):void 0},a=function(e){return null!=e?e.replace(/<(([a-z_][a-z_0-9:\.\-]*\b)\s*(?:\/(?!>)|[^>\/])*)><\/\2>/gi,function(e,n){return"<"+n+"/>"}):void 0},f=function(e){return null!=e?e.replace(/<(([a-z_][a-z_0-9:\.\-]*\b)\s*(?:\/(?!>)|[^>\/])*)\/>/gi,function(e,n,r){return"<"+n+"></"+r+">"}):void 0},m={fullDocument:!1,cleanup:!0,xmlHeaderInOutput:!0,normalizeHeader:!0,encoding:"UTF-8",preserveEncoding:!1,collapseEmptyElements:!0,expandCollapsedElements:!1,removeDupNamespace:!0,removeDupAttrs:!0,removeNullNamespace:!0,removeAllNamespaces:!1,removeNamespacedNamespace:!0,includeNamespaces:{},excludedNamespaceUris:[],moveNamespacesToRoot:!1},N=function(e){var n,r;n={};for(r in m)n[r]=m[r];if(null!=e)for(r in e)n[r]=e[r];return n},t=function(e,n,r){var o,u,i,a,c,m,f,p,v;if(o=N(r),null==(m=T(e)))throw new Error("Failed to load the XML document");if(null==(v=T(n)))throw new Error("Failed to load the XSLT document");return"undefined"!=typeof XSLTProcessor&&null!==XSLTProcessor&&null!=("undefined"!=typeof document&&null!==document&&null!=(a=document.implementation)?a.createDocument:void 0)?((i=new XSLTProcessor).importStylesheet(v),c=o.fullDocument?i.transformToDocument(m):i.transformToFragment(m,document)):"transformNode"in m?c=m.transformNode(v):l&&((p=s()).stylesheet=v,(f=p.createProcessor()).input=m,f.transform(),c=f.output),u=d(c),o.preserveEncoding&&(o.encoding=M(u)||M(e)||o.encoding),o.cleanup&&(u=t.cleanup(u,o)),u},t.cleanup=function(e,n){var r,t,l,o,u,c,s;if((l=N(n)).cleanup){if(l.preserveEncoding&&(l.encoding=M(e)||l.encoding),c=D(e),!l.normalizeHeader&&l.xmlHeaderInOutput||(e=b(e)),l.xmlHeaderInOutput&&O(e)&&(e=L(e,l.encoding,c)),l.moveNamespacesToRoot){t=(o=p(e,l.excludedNamespaceUris)).ns,e=o.xml,u=l.includeNamespaces;for(r in u)s=u[r],t[r]=s;l.includeNamespaces=t}return e=i(e,l),l.collapseEmptyElements&&!l.expandCollapsedElements&&(e=a(e)),l.expandCollapsedElements&&!l.collapseEmptyElements&&(e=f(e)),e}},t})}).call(this);
//# sourceMappingURL=xslt.min.js.map
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor-feat-disc', location = 'js/editor-feat-disc.js' */
/*
Copyright (c) 2022 Appfire Technologies, LLC.
All rights reserved.

This software is licensed under the provisions of the "Appfire EULA"
(https://appfire.com/eula/) as well as under the provisions of
the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
(http://www.atlassian.com/licensing/marketplace/termsofuse).
See the LICENSE file for more details.
*/
/*********************************************************
 * Feature discovery for editor shortcuts
 */
(function($) {
    AJS.bind("init.rte", function() {
        var featDiscId = 'latexmath-neweditorcommands';
        if (!latexmathHelpers.readCookie(featDiscId)) {
            $.ajax({
                url: AJS.params.baseUrl + "/rest/feature-discovery/latest/com.tensixtwo.conf.latexmath/editor-commands",
                dataType: "json"
            }).done(function (data) {
                if (data.isNew && $('#' + featDiscId).size() === 0) {
                    $.ajax({
                        url: AJS.params.baseUrl+"/rest/latexmath/latest/featdisc",
                        data: {userKey: AJS.params.remoteUserKey},
                        dataType: "json"
                    }).then(function(featdisc) {
                       if (featdisc.enabled) {
                           var disableText = '';
                           if (featdisc.userCanDisable) {
                               var adminLink = AJS.params.baseUrl + '/admin/plugins/latexmath/viewconfig.action'+'#featDisc';
                               disableText = ' '+AJS.format("\u003ca href=\u0022{0}\u0022\u003eHide this message for all users\u003c/a\u003e", adminLink);
                           }

                           AJS.messages.generic("#editor-precursor", {
                               id: featDiscId,
                               body: "Inserting LaTeX Math macros is now even easier. Try adding macros by using the following commands: $x$, $$ x $$, \u005C( x \u005C), \u005C[ x \u005C]." + disableText
                           });
                        }
                    });
                }
            });
            $(document).on('messageClose', function (e) {
                if (e.target.id === featDiscId) {
                    latexmathHelpers.createCookie(featDiscId, "read", 30)
                }
            });
        }
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor-commands', location = 'js/editor-handlers.js' */
/*
Copyright (c) 2022 Appfire Technologies, LLC.
All rights reserved.

This software is licensed under the provisions of the "Appfire EULA"
(https://appfire.com/eula/) as well as under the provisions of
the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
(http://www.atlassian.com/licensing/marketplace/termsofuse).
See the LICENSE file for more details.
*/
(function($) {
    var autoformatHandlers = [
        {macro: 'mathinline', regex: /(?:[\s\xA0\u200b\uFEFF]+|^)(\$(?=[^\s$])([^$]*?[^\s]))$/, endChar: '$'},
        {macro: 'mathinline', regex: /(\\$)/, endChar: '('},
        {macro: 'mathblock', regex: /(\$\$(?=[^$])([^$]*?)\$)$/, endChar: '$'},
        {macro: 'mathblock', regex: /(\\$)/, endChar: '['}
    ];

    var pasteHandlers = [
        {macro: 'mathinline', regex: /^\$([^$]+)\$$/},
        {macro: 'mathinline', regex: /^\\\(([^$]+)\\\)$/},
        {macro: 'mathblock', regex: /^\$\$(?=[^$])(.+)\$\$$/},
        {macro: 'mathblock', regex: /^\\\[(.+)\\]$/}
    ];

    function makeMacro(macroName, body) {
        body = body && body.trim() || '';
        var params = {};
        if (macroName.indexOf('block') === -1) {
            if (body) {
                params['body'] = body;
            }
            body = null;
        }

        return {
            contentId: AJS.Meta.get('content-id') || "0",
            macro : {
                name : macroName,
                params : params,
                defaultParameterValue : null,
                body : body
            }
        };
    }

    function isInPlainTextMacro(element) {
        return $(element).closest("[data-macro-body-type='PLAIN_TEXT']").length;
    }

    function insertMacro(macro, body) {
        AJS.Rte.BookmarkManager.storeBookmark();
        tinymce.confluence.MacroUtils.insertMacro(makeMacro(macro, body))
            .done(function (node) {
                if (!body && node.tagName.toLowerCase() === 'img') {
                    // If we are creating an empty inline macro, then select it so it is ready for user input
                    $(node).click();
                    $('#property-panel').each(function () {
                        $(this).find('a.mathinline-macro-body').click();
                        $(this).find('input.mathinline-macro-body').focus();
                    });
                }
            });
    }

    AJS.bind("confluence.editor.registerHandlers", function(e, data) {
        var handlerManager = data.handlerManager;
        var createHandler = data.createHandler;
        var editor = data.ed;

        autoformatHandlers.forEach(function(h) {
            handlerManager.registerHandler(h.endChar.charCodeAt(0), createHandler(h.regex, function (matchGroups) {
                insertMacro(h.macro, matchGroups[2]);
            }, true, 'span#autocomplete')); // Don't do this in autocomplete mode
        });

        $(document).bind('prePaste', function () {
            if (editor.removed) return;
            editor.undoManager.add();
        });

        $(document).bind('postPaste', function (e, pl, o) {
            if (editor.removed) return;

            if (!editor.selection || !isInPlainTextMacro(editor.selection.getStart())) {
                var text = o.node.textContent.trim();
                var match, macro;
                pasteHandlers.forEach(function (h) {
                    if (!match) {
                        match = h.regex.exec(text);
                        macro = h.macro;
                    }
                });

                if (match && match.length && match[1]) {
                    setTimeout(function () {
                        editor.undoManager.undo();
                        AJS.Rte.BookmarkManager.storeBookmark();
                        tinymce.confluence.MacroUtils.insertMacro(makeMacro(macro, match[1])).done(function () {
                            editor.undoManager.add();
                        });
                    }, 1);
                }
            }
        });

        editor.onPaste.add(function (editor, e) {
            if (isInPlainTextMacro(editor.selection.getStart()) && isInPlainTextMacro(editor.selection.getEnd())) {
                var content = ((e.originalEvent || e).clipboardData || window.clipboardData).getData('Text');
                var latex = window.LatexMathTryConvert(content);
                if (latex !== null) {
                    e.preventDefault();

                    setTimeout(function () {
                        editor.undoManager.undo();
                        AJS.Rte.BookmarkManager.storeBookmark();

                        editor.selection.setContent(latex);
                        // editor.execCommand('mceInsertContent', false, latex);
                        e.preventDefault();

                        editor.undoManager.add();
                    }, 1);
                }
            }
        });
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:latex-visibility-resourse', location = 'js/editor-hide-latex-macro.js' */
/*
Copyright (c) 2022 Appfire Technologies, LLC.
All rights reserved.

This software is licensed under the provisions of the "Appfire EULA"
(https://appfire.com/eula/) as well as under the provisions of
the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
(http://www.atlassian.com/licensing/marketplace/termsofuse).
See the LICENSE file for more details.
*/
(function($) {
    AJS.bind("init.rte", function() {
        $( document ).ready(function() {
            $.ajax({
                url: AJS.params.baseUrl+"/rest/latexmath/latest/showlatexmacro",
                dataType: "json"
            }).done(function (data) {
                $("body").toggleClass("showLatexFalse", !data.enabled);
            });          
        });
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-helper.js' */
(function($,_){var RM=Confluence.Roadmap=Confluence.Roadmap||{};RM.Helper={getPosXOnMonthTimeline:function(timeline,date){const startDate=Confluence.Roadmap.DateUtilities.parseDate(timeline.startDate);const dateToBeginRender=Confluence.Roadmap.DateUtilities.parseDate(date);var months=RM.DateUtilities.getNumberOfMonths(RM.DateUtilities.getStartOfMonth(startDate),RM.DateUtilities.getStartOfMonth(dateToBeginRender));var posX=months*Roadmap.MONTH_WIDTH;var pixelFromStartMonth=RM.DateUtilities.getMillisecondsFromStartMonth(dateToBeginRender)*
Roadmap.MONTH_WIDTH/RM.DateUtilities.getMillisecondsInMonth(dateToBeginRender);return Math.round(posX+pixelFromStartMonth)},getPosXOnWeekTimeline:function(timeline,startDate){const date=Confluence.Roadmap.DateUtilities.parseDate(timeline.startDate);const startDateTimelineStartFromMonday=RM.DateUtilities.getStartOfIsoWeek(date);const weeks=(startDate-startDateTimelineStartFromMonday)/RM.DateUtilities.MILLISECONDS_A_WEEK;const posX=weeks*Roadmap.WEEK_WIDTH;return Math.round(posX)},getWidthTimeline:function(timeline,
bar){var barWidth=bar.duration;if(timeline.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH)barWidth*=Roadmap.MONTH_WIDTH;else barWidth*=Roadmap.WEEK_WIDTH;return barWidth<Roadmap.EXTRA_SPACE_AROUND?0:Math.round(barWidth-Roadmap.EXTRA_SPACE_AROUND)},getMonthStartDateByPosition:function(timeline,positionX){const months=Math.floor(positionX/Roadmap.MONTH_WIDTH);const startDate=RM.DateUtilities.parseDate(timeline.startDate);const timelineStartMonth=RM.DateUtilities.getStartOfMonth(startDate);timelineStartMonth.setMonth(timelineStartMonth.getMonth()+
months);const daysWidth=Math.abs(positionX)%Roadmap.MONTH_WIDTH;if(daysWidth!==0&&months<0)daysWidth=Roadmap.MONTH_WIDTH-daysWidth;const msFromMonth=RM.DateUtilities.getMillisecondsInMonth(timelineStartMonth)*daysWidth/Roadmap.MONTH_WIDTH;return new Date(timelineStartMonth.getTime()+msFromMonth)},getWeekStartDateByPosition:function(timeline,positionX){const startDate=RM.DateUtilities.parseDate(timeline.startDate);const startDateTimeline=Confluence.Roadmap.DateUtilities.getStartOfIsoWeek(startDate);
const numberOfWeeks=positionX/Roadmap.WEEK_WIDTH;return new Date(startDateTimeline.setDate(startDateTimeline.getDate()+numberOfWeeks*7))},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)})}};RM.ColorHelper={resetColorCounts:function(){_.each(Roadmap.COLORS,function(color){color.count=0})},findColor:function(color){return _.find(Roadmap.COLORS,function(roadmapColor){return roadmapColor.lane===color.lane})},
adjustColorCount:function(color,adjustAmount){var roadmapColor=RM.ColorHelper.findColor(color);if(roadmapColor)roadmapColor.count=roadmapColor.count+adjustAmount},getColor:function(){return _.min(Roadmap.COLORS,function(color){return color.count})}}})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-utilities.js' */
(function(g,p){var e=Confluence.Roadmap=Confluence.Roadmap||{},h=AJS.Meta.get("user-locale").replace("_","-");e.DateUtilities={MILLISECONDS_A_DAY:864E5,MILLISECONDS_A_WEEK:6048E5,getStartOfIsoWeek:a=>new Date(a.getFullYear(),a.getMonth(),a.getDate()-a.getDay()+1),getEndOfIsoWeek:a=>new Date(a.getFullYear(),a.getMonth(),a.getDate()-a.getDay()+7),getStartOfMonth:a=>new Date(a.getFullYear(),a.getMonth(),1),getEndOfMonth:a=>new Date((new Date(a.getFullYear(),a.getMonth()+1,1)).getTime()-1),areInSameWeek:(a,
b)=>{a=new Date((new Date(a)).setHours(0,0,0,0));b=new Date((new Date(b)).setHours(0,0,0,0));return(new Date(a.setDate(a.getDate()-a.getDay()))).getTime()===(new Date(b.setDate(b.getDate()-b.getDay()))).getTime()},setIsoWeekday:(a,b)=>new Date(a.setDate(a.getDate()-a.getDay()+b)),parseDate:function(a){if(!a)return null;if(a instanceof Date||"number"===typeof a||a.includes&&a.includes(":"))return new Date(a);a=a.split("-");var b=a[0].toString();const c=(new Date).getFullYear().toString();a[0]=c.substring(0,
c.length-b.length)+b;b=Date.parse(a.join("-"));return isNaN(b)?null:new Date(new Date(a[0],a[1]-1,a[2]))},getDateStringFromDate:function(a,b){switch(b){case Roadmap.SHORT_DATE_FORMAT:return`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,0)}-${a.getDate().toString().padStart(2,0)}`;case Roadmap.WEEK_FORMAT:return a.getDate().toString().padStart(2,"0")+"-"+a.toLocaleString(h,{month:"short"});case Roadmap.MONTH_FORMAT:return a.toLocaleString(h,{month:"short"});default:return a.getFullYear().toString()+
"-"+(a.getMonth()+1).toString().padStart(2,"0")+"-"+a.getDate().toString().padStart(2,"0")+" "+a.getHours().toString().padStart(2,"0")+":"+a.getMinutes().toString().padStart(2,"0")+":"+a.getSeconds().toString().padStart(2,"0")}},getNumberOfMonths:function(a,b){return b.getMonth()-a.getMonth()+12*(b.getFullYear()-a.getFullYear())},getMillisecondsInMonth:function(a){return(new Date(a.getFullYear(),a.getMonth()+1,0)).getDate()*e.DateUtilities.MILLISECONDS_A_DAY},getMillisecondsFromStartMonth:function(a){return a.getTime()-
(new Date(a.getFullYear(),a.getMonth(),1)).getTime()},calculateDurationInformation:function(a){var b=e.DateUtilities.getMillisecondsInMonth(a);a=e.DateUtilities.getMillisecondsFromStartMonth(a);var c=b-a;return{totalMsOfMonth:b,msFromStartMonth:a,msRemainingOfMonth:c,durationOfMonth:a/b,remainingDurationOfMonth:c/b}},convertToWeekDuration:function(a,b){let c=new Date(a);var d=e.DateUtilities.calculateDurationInformation(a);b<=d.remainingDurationOfMonth?(b*=d.totalMsOfMonth,c=new Date(c.getTime()+
b)):(c=new Date(c.getTime()+d.msRemainingOfMonth),b-=d.remainingDurationOfMonth,d=Math.floor(b),0<d&&c.setMonth(c.getMonth()+d),b%=1,d=e.DateUtilities.getMillisecondsInMonth(c),b*=d,c=new Date(c.getTime()+b));return result=Math.abs(c.getTime()-a.getTime())/e.DateUtilities.MILLISECONDS_A_WEEK},convertToMonthDuration:function(a,b){const c=b*e.DateUtilities.MILLISECONDS_A_WEEK;var d=new Date(a.getTime()+c);b=12*d.getFullYear()+d.getMonth();b-=12*a.getFullYear()+a.getMonth();a=e.DateUtilities.calculateDurationInformation(a);
0===b?b=c/a.totalMsOfMonth:(a=a.remainingDurationOfMonth,d=e.DateUtilities.calculateDurationInformation(d),a+=d.durationOfMonth,b=a+=b-1);return b}};e.FieldUtilities={fixDatePickerFields:function(a){a.find("input[data-aui-dp-uuid]").each(function(b,c){var d=g(c),k=d.attr("data-aui-dp-uuid");d.on("click focus",function(){var f=g("[data-aui-dp-popup-uuid\x3d"+k+"]");if("5.4.5">=AJS.version){var l=f.datepicker("option","onSelect");f.datepicker("option","onSelect",function(m,n){l(m,n);d.change()})}f.parents(".aui-inline-dialog").addClass("datepicker-roadmap-patch")})})}}})(AJS.$,
window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/model.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bar=Backbone.Model.extend({defaults:function(){return{id:Confluence.Roadmap.Helper.guid(),title:"\u65b0\u6a2a\u6761",description:"",startDate:new Date,duration:1,rowIndex:0,pageLink:{}}}});Roadmap.Lane=Backbone.Model.extend({defaults:function(){return{title:"\u65b0\u7684\u901a\u9053",color:Confluence.Roadmap.ColorHelper.getColor(),bars:[]}},initialize:function(){var a=new Roadmap.Bars(this.get("bars"));
this.set("bars",a)},getNumberOfRows:function(){var a=this.get("bars");if(0===a.length)return 0;var b=0;a.each(function(c){b=Math.max(c.get("rowIndex"),b)});return b+1}});Roadmap.Marker=Backbone.Model.extend({defaults:function(){return{title:"\u6807\u8bb0"}}});Roadmap.Timeline=Backbone.Model.extend({defaults:function(){return{displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH}},validate:function(a){var b=[],c=Confluence.Roadmap.DateUtilities.parseDate(a.startDateString);
a=Confluence.Roadmap.DateUtilities.parseDate(a.endDateString);c&&a?c>=a?b.push({name:"endDate",message:"\u5f00\u59cb\u65e5\u671f\u5fc5\u987b\u5728\u7ed3\u675f\u65e5\u671f\u4e4b\u524d"}):a.getFullYear()-c.getFullYear()>=Roadmap.TIMELINE_YEARS_LIMIT&&a.getMonth()>=c.getMonth()&&a.getDate()>c.getDate()&&b.push({name:"endDate",message:AJS.format("\u60a8\u4e0d\u80fd\u8ba1\u5212\u8d85\u8fc7\u672a\u6765 {0} \u5e74\u3002",Roadmap.TIMELINE_YEARS_LIMIT)}):b.push({name:"date",message:"\u8f93\u5165\u683c\u5f0f\u4e3a\u5e74\uff0d\u6708\uff0d\u65e5\u7684\u65e5\u671f"});return 0<b.length?b:!1},calculateTimelineColumns:function(){var a=
Confluence.Roadmap.DateUtilities.parseDate(this.get("startDate")),b=Confluence.Roadmap.DateUtilities.parseDate(this.get("endDate")),c=[];if(this.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){a=Confluence.Roadmap.DateUtilities.getStartOfMonth(a);b=Confluence.Roadmap.DateUtilities.getEndOfMonth(b);do c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(a,Roadmap.MONTH_FORMAT),year:a.getFullYear()}),a.setMonth(a.getMonth()+1);while(a<b)}else{a=Confluence.Roadmap.DateUtilities.getStartOfIsoWeek(a);
b=Confluence.Roadmap.DateUtilities.getEndOfIsoWeek(b);do c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(a,Roadmap.WEEK_FORMAT),year:a.getFullYear()}),a.setDate(a.getDate()+7);while(a<b)}this.attributes.displayTimelineColumns=c}});Roadmap.Roadmap=Backbone.Model.extend({defaults:function(){return{title:"\u8def\u7ebf\u56fe\u7f16\u8f91\u5668",lanes:[],markers:[]}},initialize:function(){var a=new Roadmap.Lanes(this.get("lanes"));this.set("lanes",a);a=new Roadmap.Markers(this.get("markers"));
this.set("markers",a);a=new Roadmap.Timeline(this.get("timeline"));this.set("timeline",a)},parse:function(a){return a.timeline?this.fromMacroData(a):Roadmap.getDefaultRoadmapData()},fromMacroData:function(a){var b=a.timeline;b.startDate=Confluence.Roadmap.DateUtilities.parseDate(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.parseDate(b.endDate);b=a.lanes;_.each(b,function(c){var d=c.bars;_.each(d,function(e){e.startDate=Confluence.Roadmap.DateUtilities.parseDate(e.startDate);e.id||(e.id=
Confluence.Roadmap.Helper.guid())});c.bars=d});a.lanes=b;b=a.markers;_.each(b,function(c){c.markerDate=Confluence.Roadmap.DateUtilities.parseDate(c.markerDate)});a.markers=b;return a},toMacroData:function(){var a=this.toJSON(),b=a.timeline.toJSON();b.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.endDate);delete b.displayTimelineColumns;a.timeline=b;b=a.lanes.toJSON();_.each(b,function(c){var d=c.bars.toJSON();
_.each(d,function(e){e.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.startDate)});c.bars=d});a.lanes=b;b=a.markers.toJSON();_.each(b,function(c){c.markerDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(c.markerDate)});a.markers=b;return a},updateDurationUnit:function(a){this.get("lanes").each(function(b){b.get("bars").each(function(c){var d=a===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.DateUtilities.convertToMonthDuration(c.get("startDate"),c.get("duration")):
Confluence.Roadmap.DateUtilities.convertToWeekDuration(c.get("startDate"),c.get("duration"));c.attributes.duration=d})})}})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/collection.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bars=Backbone.Collection.extend({model:Roadmap.Bar});Roadmap.Lanes=Backbone.Collection.extend({model:Roadmap.Lane});Roadmap.Markers=Backbone.Collection.extend({model:Roadmap.Marker})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar-templates.soy' */
// This file was automatically generated from toolbar-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.toolbar = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-toolbar" class="aui-toolbar2"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-group"><div class="aui-toolbar2-primary">' + aui.buttons.buttons({content: '' + aui.buttons.button({id: 'toolbar-button-add-lane', text: ' ' + soy.$$escapeHtml('\u6dfb\u52a0\u752c\u9053'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-bar', text: ' ' + soy.$$escapeHtml('\u6dfb\u52a0\u6a2a\u6761'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-marker', text: ' ' + soy.$$escapeHtml('\u6dfb\u52a0\u6807\u8bb0'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'})}) + '</div><div class="aui-toolbar2-secondary">' + Confluence.Templates.Roadmap.timelineOptionsForm(null) + '</div></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.toolbar.soyTemplateName = 'Confluence.Templates.Roadmap.toolbar';
}


Confluence.Templates.Roadmap.timelineOptionsForm = function(opt_data, opt_ignored) {
  return '' + aui.form.form({id: 'timeline-options-form', action: '#', content: '<fieldset>' + aui.form.selectField({id: 'timeline-display-options-select', labelContent: '' + soy.$$escapeHtml('\u67e5\u770b\u901a\u8fc7'), options: [{text: '\u6708', value: 'MONTH'}, {text: '\u5468', value: 'WEEK'}], extraClasses: 'view-by'}) + aui.form.textField({id: 'timeline-startdate-input', name: 'startDate', isRequired: true, extraClasses: 'roadmap-toolbar-date start-date aui-date-picker'}) + ' - ' + aui.form.textField({id: 'timeline-enddate-input', name: 'endDate', isRequired: true, extraClasses: 'roadmap-toolbar-date end-date aui-date-picker'}) + '<div class="field-group timeline-field-group-error"><div id="roadmap-timeline-error" class="error"></div></div></fieldset>'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineOptionsForm.soyTemplateName = 'Confluence.Templates.Roadmap.timelineOptionsForm';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar.js' */
(function(f,e){window.Roadmap=window.Roadmap||{};Roadmap.ToolbarView=Backbone.View.extend({className:"roadmap-toolbar",events:{"click #toolbar-button-add-bar":"onAddBarClick","click #toolbar-button-add-lane":"onAddLaneClick","click #toolbar-button-add-marker":"onAddMarkerClick","change #timeline-display-options-select":"onTimelineOptionChange"},initialize:function(){e.bindAll(this,"render")},render:function(){f(this.$el).html(Confluence.Templates.Roadmap.toolbar());this._initVariables();this._setupTimelineOptionsForm();
return this},onAddBarClick:function(a){a.preventDefault();a=this.model.get("lanes").at(0);var c=a.get("bars"),b=this.model.get("timeline"),d=Confluence.Roadmap.DateUtilities.parseDate(this.model.get("timeline").get("startDate"));b=b.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.DateUtilities.getStartOfMonth(d):Confluence.Roadmap.DateUtilities.getStartOfIsoWeek(d);c.add(new Roadmap.Bar({rowIndex:a.getNumberOfRows(),startDate:b}))},onAddLaneClick:function(a){a.preventDefault();
this.model.get("lanes").add(new Roadmap.Lane)},onAddMarkerClick:function(a){a=this.model.get("markers");const c=this.model.get("timeline"),b=Confluence.Roadmap.DateUtilities.parseDate(c.get("startDate")),d=Confluence.Roadmap.DateUtilities.parseDate(b);c.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?b.setDate(15):Confluence.Roadmap.DateUtilities.setIsoWeekday(b,4);a.add(new Roadmap.Marker({markerDate:d}))},onTimelineOptionChange:function(a){this.model.get("timeline").set({displayOption:this.$timelineSelect.val()})},
_initVariables:function(){this.$timelineForm=this.$el.find("#timeline-options-form");this.$startDateInput=this.$timelineForm.find("#timeline-startdate-input");this.$endDateInput=this.$timelineForm.find("#timeline-enddate-input");this.$timelineSelect=this.$timelineForm.find("#timeline-display-options-select");this.$timelineError=this.$timelineForm.find("#roadmap-timeline-error");this.newTimeline=new Roadmap.Timeline},_clearTimelineErrors:function(){this.$timelineError.empty()},_showTimelineErrors:function(){var a=
this;e.each(a.newTimeline.validationError,function(c){a.$timelineError.append(c.message)})},_applyNewTimeline:function(){this.model.get("timeline").set({startDate:Confluence.Roadmap.DateUtilities.parseDate(this.$startDateInput.val()),endDate:Confluence.Roadmap.DateUtilities.parseDate(this.$endDateInput.val())});this._showTimeLineFormat()},_showTimeLineFormat:function(){var a=this.model.get("timeline");this.$startDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(a.get("startDate"),
Roadmap.SHORT_DATE_FORMAT));this.$endDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(a.get("endDate"),Roadmap.SHORT_DATE_FORMAT))},_validate:function(){this._clearTimelineErrors();this.newTimeline.isValid()?this._applyNewTimeline():this._showTimelineErrors()},_setupTimelineOptionsForm:function(){var a=this.model.get("timeline"),c=Confluence.Roadmap.DateUtilities.parseDate(a.get("startDate")),b=Confluence.Roadmap.DateUtilities.parseDate(a.get("endDate"));c=Confluence.Roadmap.DateUtilities.getDateStringFromDate(c,
Roadmap.SHORT_DATE_FORMAT);b=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b,Roadmap.SHORT_DATE_FORMAT);this.$startDateInput.val(c);this.$endDateInput.val(b);this.newTimeline.set({startDateString:c,endDateString:b});this.$timelineSelect.val(a.get("displayOption"));a={overrideBrowserDefault:!0,firstDay:1};this.$startDateInput.datePicker(a);this.$endDateInput.datePicker(a);Confluence.Roadmap.FieldUtilities.fixDatePickerFields(this.$timelineForm);var d=this;this.$startDateInput.on("change",
function(){d.newTimeline.set({startDateString:d.$startDateInput.val()});d._validate()});this.$endDateInput.on("change",function(){d.newTimeline.set({endDateString:d.$endDateInput.val()});d._validate()})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-templates.soy' */
// This file was automatically generated from timeline-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.timeline = function(opt_data, opt_ignored) {
  var output = '';
  var displayTimelineList3 = opt_data.displayTimelines;
  var displayTimelineListLen3 = displayTimelineList3.length;
  for (var displayTimelineIndex3 = 0; displayTimelineIndex3 < displayTimelineListLen3; displayTimelineIndex3++) {
    var displayTimelineData3 = displayTimelineList3[displayTimelineIndex3];
    output += '<div class="roadmap-column-title">' + ((displayTimelineIndex3 == 0 || displayTimelineData3.year != opt_data.displayTimelines[displayTimelineIndex3 - 1].year) ? '<span class="roadmap-column-year">' + soy.$$escapeHtml(displayTimelineData3.year) + '</span><br/>' : '') + soy.$$escapeHtml(displayTimelineData3.month) + '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timeline.soyTemplateName = 'Confluence.Templates.Roadmap.timeline';
}


Confluence.Templates.Roadmap.timelineColumn = function(opt_data, opt_ignored) {
  var output = '';
  var iLimit14 = opt_data.numberOfColumns;
  for (var i14 = 0; i14 < iLimit14; i14++) {
    output += '<div class="roadmap-column-item">&nbsp;</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineColumn.soyTemplateName = 'Confluence.Templates.Roadmap.timelineColumn';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline.js' */
(function(d,c){window.Roadmap=window.Roadmap||{};var b=Confluence.Roadmap.Helper;Roadmap.TimelineView=Backbone.View.extend({className:"roadmap-frame-title",initialize:function(){c.bindAll(this,"render")},render:function(){this.model.calculateTimelineColumns();this.$el.html(Confluence.Templates.Roadmap.timeline({displayTimelines:this.model.get("displayTimelineColumns")}));return this},update:function(){this.render()},getBarPosition:function(a){return this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?
{left:b.getPosXOnMonthTimeline(this.model.attributes,a.startDate),width:b.getWidthTimeline(this.model.attributes,a)}:{left:b.getPosXOnWeekTimeline(this.model.attributes,a.startDate),width:b.getWidthTimeline(this.model.attributes,a)}},getBarDuration:function(a){return this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?a/Roadmap.MONTH_WIDTH:a/Roadmap.WEEK_WIDTH},getBarStartDate:function(a){return this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?b.getMonthStartDateByPosition(this.model.attributes,
a):b.getWeekStartDateByPosition(this.model.attributes,a)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-column.js' */
(function(c,b){window.Roadmap=window.Roadmap||{};Roadmap.TimelineColumnView=Backbone.View.extend({className:"roadmap-frame-content",initialize:function(){b.bindAll(this,"render")},render:function(){var a=this.model.get("displayTimelineColumns").length;this.$el.html(Confluence.Templates.Roadmap.timelineColumn({numberOfColumns:a}));return this},updateHeight:function(a){this.$el.height(a)},update:function(){this.render()},getSizeAndPosition:function(){return{width:this.$el.width(),height:this.$el.height(),
left:this.$el.position().left,top:this.$el.position().top}}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-dialog-resources', location = 'view/dialog-view.js' */
(function(l,n){window.Roadmap=window.Roadmap||{};Roadmap.InlineDialogView=Backbone.View.extend({initialize:function(a){n.bindAll(this,"_onDocumentClick","_onKeyDown","_shouldHide","_onHide");this._trigger=a.trigger;this._dialogOptions=a.dialogOptions;this._reset();var b=this;l(".roadmap-editor-popup, .roadmap-macro-view").scroll(function(){b.hide()})},_shouldHideWhenClick:function(a){return!l.contains(this._inlineDialog[0],a.target)},_createInlineDialog:function(a,b){var e=this,c={hideCallback:this._onHide,
initCallback:function(){e._onBeforeShow();n.delay(function(){AJS.InlineDialog.current=null;e._onShow();l(document).on({click:e._onDocumentClick,keydown:e._onKeyDown})},e._inlineDialog.getOptions().fadeTime)},noBind:!0,persistent:!0,preHideCallback:this._shouldHide};b&&b.isSideInlineDialog&&(n.extend(c,{calculatePositions:n.compose(this._calculateSidePositions,this._getSideDimensions),offsetX:8,offsetY:0}),Raphael.version&&n.extend(c,{getArrowPath:this._getSideArrowPath}));return new AJS.InlineDialog(a,
"roadmap-dialog",function(d,g,m){e._getContent(d);m()},n.extend({},c,b))},_onHide:function(){l(document).off({click:this._onDocumentClick,keydown:this._onKeyDown})},hide:function(){this._inlineDialog.remove()},_onDocumentClick:function(a){this._shouldHideWhenClick(a)&&this.hide()},_onBeforeShow:l.noop,_onKeyDown:function(a){var b=a.which===l.ui.keyCode.ESCAPE;a=l(a.target).is(":input");b&&!a&&this.hide()},_onShow:l.noop,_reset:function(){this._inlineDialog=this._createInlineDialog(this._trigger,this._dialogOptions);
this.setElement(this._inlineDialog)},_shouldHide:function(){return!0},show:function(){this._inlineDialog.show()},disable:function(){this.$el.find(":input").attr("disabled","disabled")},enable:function(){this.$el.find(":input").removeAttr("disabled")},_onSubmit:function(){throw Error("DialogView subclasses must implement _onSubmit().");},_getSideDimensions:function(a,b,e,c){var d="body"!==c.container.toLowerCase();e=AJS.$(c.container);var g=d?AJS.$(c.container).parent():AJS.$(window),m=d?e.offset():
{left:0,top:0};d=d?g.offset():{left:0,top:0};b=b.target;var h=b.offset(),k=b[0].getBoundingClientRect&&b[0].getBoundingClientRect(),f=k?k.width:b.outerWidth();if(c.timelineWidth){var p=b.position();p.left+f>c.timelineWidth&&(f=c.timelineWidth-p.left-1)}return{screenPadding:10,arrowMargin:5,window:{top:d.top,left:d.left,scrollTop:g.scrollTop(),scrollLeft:g.scrollLeft(),width:g.width(),height:g.height()},scrollContainer:{width:e.width(),height:e.height()},trigger:{top:h.top-m.top,left:h.left-m.left,
width:f,height:k?k.height:b.outerHeight()},dialog:{width:a.width(),height:a.height(),offset:{top:c.offsetY,left:c.offsetX}},arrow:{height:a.find(".arrow").outerHeight()}}},_calculateSidePositions:function(a){var b=a.screenPadding,e=a.window,c=a.trigger,d=a.dialog,g=a.arrow,m=c.top-e.scrollTop,h=c.left-e.scrollLeft,k=Math.floor(c.height/2),f=Math.floor(d.height/2),p=Math.floor(g.height/2),q=h-d.offset.left-b>=d.width;h=a.scrollContainer.width-h-c.width-d.offset.left-b>=d.width||!q?"right":"left";q=
m+k-p;g=e.height-q-g.height;b=Math.min(b,q-a.arrowMargin);b=Math.min(b,g-a.arrowMargin);a=Math.max(f-k+d.offset.top-Math.max(e.height-m-c.height-b,0),0);b=Math.max(f-k-d.offset.top-Math.max(m-b,0),0)||-a||0;c={top:c.top+k-f+d.offset.top+b,left:"right"===h?c.left+c.width+d.offset.left:c.left-d.width-d.offset.left};d="w";f={position:"absolute",top:f-p-b};"right"===h?(f.right="auto",f.left=Raphael.version?"-7px":"0px"):(f.right="-7px",f.left="auto",d="e");return{dialogLocation:h,popupCss:c,arrowCss:f,
gravity:d}},_getSideArrowPath:function(a){return"right"===a.dialogLocation?"M8,0L0,8,8,16":"M8,0L16,8,8,16"},refresh:function(){this._inlineDialog&&this._inlineDialog.refresh()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog-templates.soy' */
// This file was automatically generated from bar-dialog-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.barDialog = function(opt_data, opt_ignored) {
  var output = '';
  var hasPageLink__soy3 = opt_data.bar.pageLink != null && opt_data.bar.pageLink.id != null;
  output += '<h3 id="bar-title" class="editable-field">' + soy.$$escapeHtml(opt_data.bar.title) + '</h3><div class="information"><div class="bar-page-link-wrapper">' + ((opt_data.linkPageEditable) ? '<div class="link-update-page ' + ((hasPageLink__soy3) ? 'hidden-field' : '') + '"><a href="#">' + soy.$$escapeHtml('\u94fe\u63a5\u9875\u9762') + '</a></div>' : '') + '<div class="bar-page-link editable-field ' + ((! hasPageLink__soy3) ? 'hidden-field' : '') + '">' + ((hasPageLink__soy3) ? Confluence.Templates.Roadmap.buildPageLink({pageLink: opt_data.bar.pageLink, isEditMode: opt_data.renderOption.isEditMode}) : '') + '</div>' + ((opt_data.linkPageEditable) ? '<div class="link-new-page' + ((hasPageLink__soy3) ? ' hidden-field' : '') + '"><span class=\'page-link-separator\'>\u2022</span><a href="#">' + soy.$$escapeHtml('\u521b\u5efa\u9875\u9762') + '</a></div>' : '') + '</div><div class="clear"></div><div class="bar-description editable-field">' + soy.$$filterNoAutoescape(opt_data.bar.description) + '</div></div>' + ((opt_data.renderOption.isEditMode) ? '<div class="inner">' + aui.buttons.button({id: 'delete-button', text: '\u5220\u9664\u680f', type: 'link'}) + '</div>' : '');
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.barDialog.soyTemplateName = 'Confluence.Templates.Roadmap.barDialog';
}


Confluence.Templates.Roadmap.buildPageLink = function(opt_data, opt_ignored) {
  return '<a href=' + soy.$$escapeHtml("/confluence") + '/pages/viewpage.action?pageId=' + soy.$$escapeHtml(opt_data.pageLink.id) + ' ' + ((opt_data.isEditMode) ? 'target=\'_blank\'' : '') + ' class=\'confluence-link content-type-' + soy.$$escapeHtml(opt_data.pageLink.type) + '\'><span class="link-page-title">' + soy.$$escapeHtml(opt_data.pageLink.title) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.buildPageLink.soyTemplateName = 'Confluence.Templates.Roadmap.buildPageLink';
}


Confluence.Templates.Roadmap.inlineEditSaveButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-save', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u4fdd\u5b58'}, iconClass: 'aui-icon-small aui-iconfont-success'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditSaveButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditSaveButton';
}


Confluence.Templates.Roadmap.inlineEditCancelButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-cancel', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u53d6\u6d88'}, iconClass: 'aui-icon-small aui-iconfont-close-dialog'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditCancelButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditCancelButton';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/roadmap-editinplace.js' */
(function(d){function h(a,b){this.settings=a;this.dom=b;this.originalValue=null;this.shouldDelayReinit=this.didInsertDefaultText=!1}function l(a){""!==a&&((new Image).src=a)}function g(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function k(a){return void 0===a||null===a||0===a.length?!1:!0}d.fn.editInPlace=function(a){var b=d.extend({},d.fn.editInPlace.defaults,a);if(!b.url&&!b.callback)throw Error("Need to set either url: or callback: option for the inline editor to work.");l(b.saving_image);
return this.each(function(){var c=d(this);c.data("editInPlace")||(c.data("editInPlace",!0),(new h(b,c)).init())})};d.fn.editInPlace.defaults={url:"",bg_over:"#ffc",bg_out:"transparent",hover_class:"",form_extra_classes:[],show_buttons:!1,save_button:'\x3cbutton class\x3d"inplace_save"\x3eSave\x3c/button\x3e',cancel_button:'\x3cbutton class\x3d"inplace_cancel"\x3eCancel\x3c/button\x3e',params:"",field_type:"text",field_extra_classes:[],default_text:"(Click here to add text)",use_html:!1,textarea_rows:10,
textarea_cols:25,select_text:"Choose new value",select_options:"",text_size:null,saving_text:void 0,saving_image:"",saving_animation_color:"transparent",value_required:!1,disable_submit_when_empty:!1,element_id:"element_id",update_value:"update_value",original_value:"original_value",original_html:"original_html",save_if_nothing_changed:!1,on_blur:"save",cancel:"",callback:null,callback_skip_dom_reset:!1,success:null,error:null,error_sink:function(a,b){alert(b)},preinit:null,postclose:null,delegate:null,
isAutoCompleteField:!1};d.extend(h.prototype,{init:function(){this.setDefaultTextIfNeccessary();this.connectOpeningEvents()},reinit:function(){this.shouldDelayReinit||(this.triggerCallback(this.settings.postclose,this.dom),this.triggerDelegateCall("didCloseEditInPlace"),this.markEditorAsInactive(),this.connectOpeningEvents())},setDefaultTextIfNeccessary:function(){""===this.dom.html()&&(this.dom.html(this.settings.default_text),this.didInsertDefaultText=!0)},connectOpeningEvents:function(){var a=
this;this.dom.bind("mouseenter.editInPlace",function(){a.addHoverEffect()}).bind("mouseleave.editInPlace",function(){a.removeHoverEffect()}).bind("click.editInPlace",function(b){a.openEditor(b)})},disconnectOpeningEvents:function(){this.dom.unbind(".editInPlace")},addHoverEffect:function(){this.settings.hover_class?this.dom.addClass(this.settings.hover_class):this.dom.css("background-color",this.settings.bg_over)},removeHoverEffect:function(){this.settings.hover_class?this.dom.removeClass(this.settings.hover_class):
this.dom.css("background-color",this.settings.bg_out)},openEditor:function(a){this.shouldOpenEditor(a)&&(this.disconnectOpeningEvents(),this.removeHoverEffect(),this.removeInsertedDefaultTextIfNeccessary(),this.saveOriginalValue(),this.markEditorAsActive(),this.replaceContentWithEditor(),this.setInitialValue(),this.workAroundMissingBlurBug(),this.connectClosingEventsToEditor(),this.triggerDelegateCall("didOpenEditInPlace"))},shouldOpenEditor:function(a){return this.isClickedObjectCancelled(a.target)||
!1===this.triggerCallback(this.settings.preinit,this.dom)||!1===this.triggerDelegateCall("shouldOpenEditInPlace",!0,a)||this.settings.isAutoCompleteField&&d(a.target).hasClass("link-page-title")?!1:!0},removeInsertedDefaultTextIfNeccessary:function(){this.didInsertDefaultText&&this.dom.html()===this.settings.default_text&&(this.dom.html(""),this.didInsertDefaultText=!1)},isClickedObjectCancelled:function(a){return this.settings.cancel?0!==d(a).parents().andSelf().filter(this.settings.cancel).length:
!1},saveOriginalValue:function(){this.originalValue=this.settings.use_html?this.dom.html():g(this.dom.text())},restoreOriginalValue:function(){this.setClosedEditorContent(this.originalValue)},setClosedEditorContent:function(a){a=a||this.settings.default_text;this.settings.use_html?this.dom.html(a):this.dom.text(a)},workAroundMissingBlurBug:function(){var a=this.dom.find(":input");this.dom.parents(":last").find(".editInPlace-active :input").not(a).blur()},replaceContentWithEditor:function(){var a=
this.createEditorElement(),b="inplace_form";this.settings.form_extra_classes instanceof Array&&(b=b+" "+this.settings.form_extra_classes.join(" "));this.dom.html('\x3cform class\x3d"'+b+'" style\x3d"display: inline; margin: 0; padding: 0;"\x3e\x3c/form\x3e');b=this.dom.find("form");b.append(a);if(this.settings.show_buttons){a=d('\x3cdiv class\x3d"inline-edit-buttons"\x3e\x3c/div\x3e');var c=d(this.settings.save_button);c.addClass("inplace_save");a.append(c);c=d(this.settings.cancel_button);c.addClass("inplace_cancel");
a.append(c);b.append(a)}},createEditorElement:function(){if(-1===d.inArray(this.settings.field_type,["text","textarea","select"]))throw"Unknown field_type \x3cfnord\x3e, supported are 'text', 'textarea' and 'select'";var a=null;"select"===this.settings.field_type?a=this.createSelectEditor():"text"===this.settings.field_type?a=d('\x3cinput type\x3d"text" '+this.inputNameAndClass()+' size\x3d"'+this.settings.text_size+'" /\x3e'):"textarea"===this.settings.field_type&&(a=d("\x3ctextarea "+this.inputNameAndClass()+
' rows\x3d"'+this.settings.textarea_rows+'"  cols\x3d"'+this.settings.textarea_cols+'" /\x3e'));return a},setInitialValue:function(){var a=this.triggerDelegateCall("willOpenEditInPlace",this.originalValue),b=this.dom.find(":input");b.val(a);b.val()!==a&&b.val("")},inputNameAndClass:function(){var a="inplace_field";this.settings.field_extra_classes instanceof Array&&(a=a+" "+this.settings.field_extra_classes.join(" "));return' name\x3d"inplace_value" class\x3d"'+a+'"'},createSelectEditor:function(){var a=
d("\x3cselect"+this.inputNameAndClass()+'\x3e\x3coption disabled\x3d"true" value\x3d""\x3e'+this.settings.select_text+"\x3c/option\x3e\x3c/select\x3e"),b=this.settings.select_options;d.isArray(b)||(b=b.split(","));for(var c=0;c<b.length;c++){var e=b[c];d.isArray(e)||(e=e.split(":"));var f=g(e[1]||e[0]);e=g(e[0]);f=d("\x3coption\x3e").val(f).text(e);a.append(f)}return a},connectClosingEventsToEditor:function(){function a(f){c.settings.isAutoCompleteField||c.handleCancelEditor(f);return!1}function b(f){c.handleSaveEditor(f);
return!1}var c=this,e=this.dom.find("form");e.find(".inplace_field").focus().select();e.find(".inplace_cancel").click(a);e.find(".inplace_save").click(b);this.settings.show_buttons||("save"===this.settings.on_blur?e.find(".inplace_field").blur(b):e.find(".inplace_field").blur(a));e.keyup(function(f){if(27===f.which)return a()});this.bindInputKeyup();e.submit(b)},bindSubmitOnEnterInInput:function(){if("textarea"!==this.settings.field_type){var a=this;this.dom.find(":input").keyup(function(b){if(13===
b.which)return a.dom.find("form").submit()})}},bindInputKeyup:function(){if("textarea"!==this.settings.field_type){var a=this,b=this.dom.find(":input"),c=this.dom.find(".inplace_save");b.keyup(function(e){if(13===e.which)return a.dom.find("form").submit();a.settings.disable_submit_when_empty&&(d.trim(b.val()).length?c.removeAttr("disabled"):c.attr("disabled","disabled"))})}},handleCancelEditor:function(a){!1!==this.triggerDelegateCall("shouldCloseEditInPlace",!0,a)&&(a=this.dom.find(":input").val(),
this.triggerDelegateCall("willCloseEditInPlace",a),this.restoreOriginalValue(),this.reinit())},handleSaveEditor:function(a){if(!1!==this.triggerDelegateCall("shouldCloseEditInPlace",!0,a)){var b=d.trim(this.dom.find(":input").val());b=this.triggerDelegateCall("willCloseEditInPlace",b);this.isDisabledDefaultSelectChoice()||this.isUnchangedInput(b)?this.handleCancelEditor(a):this.didForgetRequiredText(b)?this.settings.disable_submit_when_empty||(this.handleCancelEditor(a),this.reportError("Error: You must enter a value to save this field")):
(this.showSaving(b),this.settings.callback?this.handleSubmitToCallback(b):this.handleSubmitToServer(b))}},didForgetRequiredText:function(a){return this.settings.value_required&&(""===a||void 0===a||null===a)},isDisabledDefaultSelectChoice:function(){return this.dom.find("option").eq(0).is(":selected:disabled")},isUnchangedInput:function(a){return!this.settings.save_if_nothing_changed&&this.originalValue===a},showSaving:function(a){this.settings.callback&&this.settings.callback_skip_dom_reset||(k(this.settings.saving_text)&&
(a=this.settings.saving_text),k(this.settings.saving_image)&&(a=d("\x3cimg /\x3e").attr("src",this.settings.saving_image).attr("alt",a)),this.dom.html(encodeURIComponent(a)))},handleSubmitToCallback:function(a){this.enableOrDisableAnimationCallbacks(!0,!1);var b=this.triggerCallback(this.settings.callback,this.id(),a,this.originalValue,this.settings.params,this.savingAnimationCallbacks());this.settings.callback_skip_dom_reset||(void 0===b?(this.reportError("Error: Failed to save value: "+a),this.restoreOriginalValue()):
this.dom.html(b));this.didCallNoCallbacks()&&(this.enableOrDisableAnimationCallbacks(!1,!1),this.reinit())},handleSubmitToServer:function(a){a=this.settings.update_value+"\x3d"+encodeURIComponent(a)+"\x26"+this.settings.element_id+"\x3d"+this.dom.attr("id")+(this.settings.params?"\x26"+this.settings.params:"")+"\x26"+this.settings.original_html+"\x3d"+encodeURIComponent(this.originalValue)+"\x26"+this.settings.original_value+"\x3d"+encodeURIComponent(this.originalValue);this.enableOrDisableAnimationCallbacks(!0,
!1);this.didStartSaving();var b=this;d.ajax({url:b.settings.url,type:"POST",data:a,dataType:"html",complete:function(c){b.didEndSaving()},success:function(c){b.dom.html(c||b.settings.default_text);b.triggerCallback(b.settings.success,c)},error:function(c){b.dom.html(b.originalHTML);b.settings.error?b.triggerCallback(b.settings.error,c):b.reportError("Failed to save value: "+c.responseText||"Unspecified Error")}})},triggerCallback:function(a){if(a){var b=Array.prototype.slice.call(arguments,1);return a.apply(this.dom[0],
b)}},triggerDelegateCall:function(a,b,c){if(!this.settings.delegate||!d.isFunction(this.settings.delegate[a]))return b;a=this.settings.delegate[a](this.dom,this.settings,c);return void 0===a?b:a},reportError:function(a){this.triggerCallback(this.settings.error_sink,this.id(),a)},id:function(){return this.dom.attr("id")},markEditorAsActive:function(){this.dom.addClass("editInPlace-active")},markEditorAsInactive:function(){this.dom.removeClass("editInPlace-active")},savingAnimationCallbacks:function(){var a=
this;return{didStartSaving:function(){a.didStartSaving()},didEndSaving:function(){a.didEndSaving()}}},enableOrDisableAnimationCallbacks:function(a,b){this.didStartSaving.enabled=a;this.didEndSaving.enabled=b},didCallNoCallbacks:function(){return this.didStartSaving.enabled&&!this.didEndSaving.enabled},assertCanCall:function(a){if(!this[a].enabled)throw Error("Cannot call "+a+" now. See documentation for details.");},didStartSaving:function(){this.assertCanCall("didStartSaving");this.shouldDelayReinit=
!0;this.enableOrDisableAnimationCallbacks(!1,!0);this.startSavingAnimation()},didEndSaving:function(){this.assertCanCall("didEndSaving");this.shouldDelayReinit=!1;this.enableOrDisableAnimationCallbacks(!1,!1);this.reinit();this.stopSavingAnimation()},startSavingAnimation:function(){var a=this;this.dom.animate({backgroundColor:this.settings.saving_animation_color},400).animate({backgroundColor:"transparent"},400,"swing",function(){setTimeout(function(){a.startSavingAnimation()},10)})},stopSavingAnimation:function(){this.dom.stop(!0).css({backgroundColor:""})},
missingCommaErrorPreventer:""})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog.js' */
(function(e,f){var h=Roadmap.InlineDialogView;Roadmap.BarDialogView=h.extend({events:{"click #delete-button":"_onDeleteClick","click .link-new-page":"_goToCreateLinkPage","click .link-update-page":"_goToUpdateLinkPage"},initialize:function(){f.bindAll(this,"_onPageLinkOpen","_onPageLinkSelectCompleted","_onPageLinkCallback","_onPageLinkBlur","_goToCreateLinkPage");this.options.dialogOptions={width:260,timelineWidth:this.options.timelineWidth,isSideInlineDialog:!0,renderOption:this.options.renderOption,
linkPageEditable:this.options.linkPageEditable,createLinkPageCallback:this.options.createLinkPageCallback};h.prototype.initialize.call(this,this.options)},_getContent:function(a){a.html(Confluence.Templates.Roadmap.barDialog({bar:f.extend({},this.model.attributes,{description:AJS.escapeHtml(this.model.attributes.description).replace(/\r?\n/g,"\x3cbr /\x3e")}),renderOption:this.options.dialogOptions.renderOption,linkPageEditable:this.options.dialogOptions.linkPageEditable}))},_onBeforeShow:function(){this.fields=
this._getFields();this._setupInlineEdit()},_getFields:function(){return{$title:this.$el.find("#bar-title"),$description:this.$el.find(".bar-description"),$pageLink:this.$el.find(".bar-page-link"),$pageLinkNew:this.$el.find(".link-new-page"),$pageLinkUpdate:this.$el.find(".link-update-page")}},_setupInlineEdit:function(){var a=this,b=this.fields,c=this.options.dialogOptions.renderOption.editInplace,g={form_extra_classes:["aui"],hover_class:"editable-field-hover aui-icon-small aui-iconfont-edit",field_extra_classes:["text"],
show_buttons:!0,save_button:Confluence.Templates.Roadmap.inlineEditSaveButton(),cancel_button:Confluence.Templates.Roadmap.inlineEditCancelButton(),error_sink:null,use_html:!0,default_text:"\u70b9\u51fb\u6dfb\u52a0\u63cf\u8ff0",delegate:{shouldOpenEditInPlace:function(){a.$el.find(".inplace_cancel").trigger("click")},didCloseEditInPlace:function(){setTimeout(function(){a.refresh()},0)}}};c.title&&b.$title.editInPlace(e.extend(!0,{},g,{callback:function(k,d){a.options.updateTitle(d);
return AJS.escapeHtml(d)},value_required:!0,disable_submit_when_empty:!0,delegate:{willOpenEditInPlace:function(){a.refresh();b.$title.find(".text").attr("maxlength",Roadmap.BarDialog.MAX_LENGTH_TITLE)}}}));""===e.trim(b.$description.text())?b.$description.addClass("empty-field"):b.$description.removeClass("empty-field");var l=e.extend(!0,{},g,{field_type:"textarea",field_extra_classes:["textarea"],value_required:!1,save_if_nothing_changed:!0,callback:function(k,d){d=e.trim(d);a.options.updateDescription(d);
""===d?(d="\u70b9\u51fb\u6dfb\u52a0\u63cf\u8ff0",e(this).addClass("empty-field")):(e(this).removeClass("empty-field"),Confluence.Roadmap.Analytics.addDescription());return AJS.escapeHtml(d).replace(/\r?\n/g,"\x3cbr /\x3e")},delegate:{willOpenEditInPlace:function(){a.refresh();b.$description.find(".textarea").attr("maxlength",Roadmap.BarDialog.MAX_LENGTH_DESCRIPTION);return a.model.attributes.description.replace(/<br\s*[\/]?>/gi,"\n")}}});c.description&&b.$description.editInPlace(l);
g=e.extend(!0,{},g,{isAutoCompleteField:!0,show_buttons:!1,default_text:"",field_extra_classes:["text","autocomplete-confluence-content"],delegate:{willOpenEditInPlace:a._onPageLinkOpen,didCloseEditInPlace:function(){f.isEmpty(b.$pageLink.data("linkData"))&&(b.$pageLink.hide(),b.$pageLinkNew.show(),b.$pageLinkUpdate.show())}},on_blur:null,callback:a._onPageLinkCallback});c.pageLink&&this.options.dialogOptions.linkPageEditable&&this.fields.$pageLink.editInPlace(g)},_onPageLinkOpen:function(a){var b=
this;a.append('\x3cdiv class\x3d"link-page-dropdown" /\x3e');var c=a.find(".autocomplete-confluence-content");c.attr({placeholder:"\u641c\u7d22\u9875\u9762","data-dropdown-target":"#inline-dialog-roadmap-dialog .link-page-dropdown","data-none-message":"\u6ca1\u6709\u5339\u914d\u7ed3\u679c"});Confluence.Binder.autocompleteConfluenceContent(a);c.bind("selected.autocomplete-content",this._onPageLinkSelectCompleted);c.on("blur",function(){setTimeout(b._onPageLinkBlur,
150)});a=this.model.attributes.pageLink;this.fields.$pageLink.data("linkData",a);return f.isEmpty(a)?!0:a.title},_onPageLinkSelectCompleted:function(a,b){a.stopPropagation();this.fields.$pageLink.find(".autocomplete-confluence-content").val(b.content.title);this.fields.$pageLink.data("linkData",b.content);f.defer(this._onPageLinkBlur)},_onPageLinkBlur:function(){var a=this.fields.$pageLink.find(".autocomplete-confluence-content"),b=e.Event("keyup");b.which=AJS.keyCode.ENTER;a.trigger(b)},_onPageLinkCallback:function(a,
b){a=""===b?{}:this.fields.$pageLink.data("linkData");return this._updatePageLink(a)},_updatePageLink:function(a){if(a.id!==this.model.attributes.pageLink.id){var b=this.fields;if(f.isEmpty(a))return this.options.updatePageLink({}),b.$pageLink.hide(),b.$pageLinkNew.show(),b.$pageLinkUpdate.show(),"\u6ca1\u6709\u94fe\u63a5\u9875\u9762";var c=f.pick(a,"id","title","type","spaceKey","wikiLink");a.spaceKey||(c.spaceKey=a.space.key);this.options.updatePageLink(c);b.$pageLink.show();b.$pageLinkNew.hide();
b.$pageLinkUpdate.hide();this.options.renderOption.isEditMode?Confluence.Roadmap.Analytics.addPageLinkEditMode({linkedPageId:a.id,pageId:0<AJS.Meta.get("page-id")?AJS.Meta.get("page-id"):AJS.Meta.get("draft-id"),isDraft:0>=AJS.Meta.get("page-id")}):Confluence.Roadmap.Analytics.addPageLinkViewMode({linkedPageId:a.id,pageId:AJS.Meta.get("page-id")});return Confluence.Templates.Roadmap.buildPageLink({pageLink:a,isEditMode:this.options.renderOption.isEditMode})}},_onDeleteClick:function(){this.options.deleteBar();
this.remove()},_goToCreateLinkPage:function(a){var b=this.options.dialogOptions;b.createLinkPageCallback&&f.bind(b.createLinkPageCallback,{me:this},a)()},_goToUpdateLinkPage:function(a){a.preventDefault();this.fields.$pageLink.show();this.fields.$pageLinkNew.hide();this.fields.$pageLinkUpdate.hide();this.fields.$pageLink.click()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-link-new-page.js' */
Confluence.RoadmapLink=function(b,f){function g(a){return b.ajax({contentType:"application/json",type:"PUT",url:AJS.contextPath()+"/rest/roadmap/1.0/bar/"+a+"/PENDING"})}function h(a){return b.ajax({contentType:"application/json",type:"GET",url:AJS.contextPath()+"/rest/roadmap/1.0/bar/"+a+"/status"})}Roadmap.trackingBars=[];return{addCreateLinkPageListener:function(a,k){0>=parseInt(a.pageId)&&(a.parentPageId=AJS.Meta.get("parent-page-id"));var l=b.param(a);window.open(AJS.contextPath()+"/plugins/roadmap/create-page.action?"+
l,"_blank").opener=null;g(a.roadmapBarId).done(function(c){Roadmap.trackingBars.push(a.roadmapBarId)});b(window).off("focus");b(window).on("focus",function(){Roadmap.trackingBars.length||b(window).off("focus");f.each(Roadmap.trackingBars,function(c){h(c).done(function(d){var e=d.status;"REDEEM"==e?(Roadmap.trackingBars.splice(Roadmap.trackingBars.indexOf(c),1),k({barId:c,pageLink:b.parseJSON(d.pageLink)})):"UNKNOWN"==e&&Roadmap.trackingBars.splice(Roadmap.trackingBars.indexOf(c),1)})})})}}}(AJS.$,
window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--825acd7236', location = 'aui.chunk.fc732d2f4ae07aa911a9--c1d71ea3b4c6752064f2.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--825acd7236"],{PTCr:function(e,t,i){var s,o,n;
/*!
 * jQuery UI Droppable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */o=[i("oDIA"),i("z+ct"),i("XPYc"),i("O+lX"),i("yIBB")],void 0===(n="function"==typeof(s=function(e){e.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){if(!arguments.length)return t||(t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});t=arguments[0]},this._addToManager(i.scope),i.addClasses&&this._addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t)},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this._addActiveClass(),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this._removeActiveClass(),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._addHoverClass(),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeHoverClass(),this._trigger("out",t,this.ui(i)))},_drop:function(i,s){var o=s||e.ui.ddmanager.current,n=!1;return!(!o||(o.currentItem||o.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var s=e(this).droppable("instance");if(s.options.greedy&&!s.options.disabled&&s.options.scope===o.options.scope&&s.accept.call(s.element[0],o.currentItem||o.element)&&t(o,e.extend(s,{offset:s.element.offset()}),s.options.tolerance,i))return n=!0,!1})),!n&&!!this.accept.call(this.element[0],o.currentItem||o.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",i,this.ui(o)),this.element))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var t=e.ui.intersect=function(){function e(e,t,i){return e>=t&&e<t+i}return function(t,i,s,o){if(!i.offset)return!1;var n=(t.positionAbs||t.position.absolute).left+t.margins.left,r=(t.positionAbs||t.position.absolute).top+t.margins.top,a=n+t.helperProportions.width,l=r+t.helperProportions.height,p=i.offset.left,c=i.offset.top,d=p+i.proportions().width,h=c+i.proportions().height;switch(s){case"fit":return p<=n&&a<=d&&c<=r&&l<=h;case"intersect":return p<n+t.helperProportions.width/2&&a-t.helperProportions.width/2<d&&c<r+t.helperProportions.height/2&&l-t.helperProportions.height/2<h;case"pointer":return e(o.pageY,c,i.proportions().height)&&e(o.pageX,p,i.proportions().width);case"touch":return(r>=c&&r<=h||l>=c&&l<=h||r<c&&l>h)&&(n>=p&&n<=d||a>=p&&a<=d||n<p&&a>d);default:return!1}}}();return e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,i){var s,o,n=e.ui.ddmanager.droppables[t.options.scope]||[],r=i?i.type:null,a=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;s<n.length;s++)if(!(n[s].options.disabled||t&&!n[s].accept.call(n[s].element[0],t.currentItem||t.element))){for(o=0;o<a.length;o++)if(a[o]===n[s].element[0]){n[s].proportions().height=0;continue e}n[s].visible="none"!==n[s].element.css("display"),n[s].visible&&("mousedown"===r&&n[s]._activate.call(n[s],i),n[s].offset=n[s].element.offset(),n[s].proportions({width:n[s].element[0].offsetWidth,height:n[s].element[0].offsetHeight}))}},drop:function(i,s){var o=!1;return e.each((e.ui.ddmanager.droppables[i.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&t(i,this,this.options.tolerance,s)&&(o=this._drop.call(this,s)||o),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,s)))})),o},dragStart:function(t,i){t.element.parentsUntil("body").on("scroll.droppable",(function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}))},drag:function(i,s){i.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(i,s),e.each(e.ui.ddmanager.droppables[i.options.scope]||[],(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var o,n,r,a=t(i,this,this.options.tolerance,s),l=!a&&this.isover?"isout":a&&!this.isover?"isover":null;l&&(this.options.greedy&&(n=this.options.scope,(r=this.element.parents(":data(ui-droppable)").filter((function(){return e(this).droppable("instance").options.scope===n}))).length&&((o=e(r[0]).droppable("instance")).greedyChild="isover"===l)),o&&"isover"===l&&(o.isover=!1,o.isout=!0,o._out.call(o,s)),this[l]=!0,this["isout"===l?"isover":"isout"]=!1,this["isover"===l?"_over":"_out"].call(this,s),o&&"isout"===l&&(o.isout=!1,o.isover=!0,o._over.call(o,s)))}}))},dragStop:function(t,i){t.element.parentsUntil("body").off("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},!1!==e.uiBackCompat&&e.widget("ui.droppable",e.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),e.ui.droppable})?s.apply(t,o):s)||(e.exports=n)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.droppable', location = 'aui.chunk.8214c015c6c7c75dde17--dadf7172b600f50e16fc.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.droppable"],{qe8r:function(u,i,n){"use strict";n.r(i);n("PTCr");i.default="jquery"}},[["qe8r","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.vendors--51504ebf10","aui.splitchunk.vendors--9c8c8c1546","aui.splitchunk.vendors--351ae504d7","aui.splitchunk.vendors--06bc6ae5d7","aui.splitchunk.vendors--825acd7236","aui.splitchunk.0d131bcbf1"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--85718a7eef', location = 'aui.chunk.02a22885178b14aefbb5--1b3f68af03cccd00218f.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--85718a7eef"],{"2V+C":function(t,i,e){"use strict";e.r(i)},XnJT:function(t,i,e){var s,h,n;
/*!
 * jQuery UI Resizable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */h=[e("oDIA"),e("XPYc"),e("zq/Y"),e("lSwU"),e("O+lX"),e("yIBB")],void 0===(n="function"==typeof(s=function(t){return t.widget("ui.resizable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(i,e){if("hidden"===t(i).css("overflow"))return!1;var s=e&&"left"===e?"scrollLeft":"scrollTop",h=!1;return i[s]>0||(i[s]=1,h=i[s]>0,i[s]=0,h)},_create:function(){var i,e=this.options,s=this;this._addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!e.aspectRatio,aspectRatio:e.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:e.helper||e.ghost||e.animate?e.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,i={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(i),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(i),this._proportionallyResize()),this._setupHandles(),e.autoHide&&t(this.element).on("mouseenter",(function(){e.disabled||(s._removeClass("ui-resizable-autohide"),s._handles.show())})).on("mouseleave",(function(){e.disabled||s.resizing||(s._addClass("ui-resizable-autohide"),s._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var i,e=function(i){t(i).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(e(this.element),i=this.element,this.originalElement.css({position:i.css("position"),width:i.outerWidth(),height:i.outerHeight(),top:i.css("top"),left:i.css("left")}).insertAfter(i),i.remove()),this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),this},_setOption:function(t,i){switch(this._super(t,i),t){case"handles":this._removeHandles(),this._setupHandles()}},_setupHandles:function(){var i,e,s,h,n,o=this.options,a=this;if(this.handles=o.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),s=this.handles.split(","),this.handles={},e=0;e<s.length;e++)h="ui-resizable-"+(i=t.trim(s[e])),n=t("<div>"),this._addClass(n,"ui-resizable-handle "+h),n.css({zIndex:o.zIndex}),this.handles[i]=".ui-resizable-"+i,this.element.append(n);this._renderAxis=function(i){var e,s,h,n;for(e in i=i||this.element,this.handles)this.handles[e].constructor===String?this.handles[e]=this.element.children(this.handles[e]).first().show():(this.handles[e].jquery||this.handles[e].nodeType)&&(this.handles[e]=t(this.handles[e]),this._on(this.handles[e],{mousedown:a._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=t(this.handles[e],this.element),n=/sw|ne|nw|se|n|s/.test(e)?s.outerHeight():s.outerWidth(),h=["padding",/ne|nw|n/.test(e)?"Top":/se|sw|s/.test(e)?"Bottom":/^e$/.test(e)?"Right":"Left"].join(""),i.css(h,n),this._proportionallyResize()),this._handles=this._handles.add(this.handles[e])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",(function(){a.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=n&&n[1]?n[1]:"se")})),o.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(i){var e,s,h=!1;for(e in this.handles)((s=t(this.handles[e])[0])===i.target||t.contains(s,i.target))&&(h=!0);return!this.options.disabled&&h},_mouseStart:function(i){var e,s,h,n=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),e=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),n.containment&&(e+=t(n.containment).scrollLeft()||0,s+=t(n.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:e,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:e,top:s},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof n.aspectRatio?n.aspectRatio:this.originalSize.width/this.originalSize.height||1,h=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===h?this.axis+"-resize":h),this._addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(i){var e,s,h=this.originalMousePosition,n=this.axis,o=i.pageX-h.left||0,a=i.pageY-h.top||0,l=this._change[n];return this._updatePrevProperties(),!!l&&(e=l.apply(this,[i,o,a]),this._updateVirtualBoundaries(i.shiftKey),(this._aspectRatio||i.shiftKey)&&(e=this._updateRatio(e,i)),e=this._respectSize(e,i),this._updateCache(e),this._propagate("resize",i),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",i,this.ui()),this._applyChanges()),!1)},_mouseStop:function(i){this.resizing=!1;var e,s,h,n,o,a,l,r=this.options,p=this;return this._helper&&(h=(s=(e=this._proportionallyResizeElements).length&&/textarea/i.test(e[0].nodeName))&&this._hasScroll(e[0],"left")?0:p.sizeDiff.height,n=s?0:p.sizeDiff.width,o={width:p.helper.width()-n,height:p.helper.height()-h},a=parseFloat(p.element.css("left"))+(p.position.left-p.originalPosition.left)||null,l=parseFloat(p.element.css("top"))+(p.position.top-p.originalPosition.top)||null,r.animate||this.element.css(t.extend(o,{top:l,left:a})),p.helper.height(p.size.height),p.helper.width(p.size.width),this._helper&&!r.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",i),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var i,e,s,h,n,o=this.options;n={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||t)&&(i=n.minHeight*this.aspectRatio,s=n.minWidth/this.aspectRatio,e=n.maxHeight*this.aspectRatio,h=n.maxWidth/this.aspectRatio,i>n.minWidth&&(n.minWidth=i),s>n.minHeight&&(n.minHeight=s),e<n.maxWidth&&(n.maxWidth=e),h<n.maxHeight&&(n.maxHeight=h)),this._vBoundaries=n},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var i=this.position,e=this.size,s=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===s&&(t.left=i.left+(e.width-t.width),t.top=null),"nw"===s&&(t.top=i.top+(e.height-t.height),t.left=i.left+(e.width-t.width)),t},_respectSize:function(t){var i=this._vBoundaries,e=this.axis,s=this._isNumber(t.width)&&i.maxWidth&&i.maxWidth<t.width,h=this._isNumber(t.height)&&i.maxHeight&&i.maxHeight<t.height,n=this._isNumber(t.width)&&i.minWidth&&i.minWidth>t.width,o=this._isNumber(t.height)&&i.minHeight&&i.minHeight>t.height,a=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,r=/sw|nw|w/.test(e),p=/nw|ne|n/.test(e);return n&&(t.width=i.minWidth),o&&(t.height=i.minHeight),s&&(t.width=i.maxWidth),h&&(t.height=i.maxHeight),n&&r&&(t.left=a-i.minWidth),s&&r&&(t.left=a-i.maxWidth),o&&p&&(t.top=l-i.minHeight),h&&p&&(t.top=l-i.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var i=0,e=[],s=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],h=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];i<4;i++)e[i]=parseFloat(s[i])||0,e[i]+=parseFloat(h[i])||0;return{height:e[0]+e[2],width:e[1]+e[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,i=0,e=this.helper||this.element;i<this._proportionallyResizeElements.length;i++)t=this._proportionallyResizeElements[i],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:e.height()-this.outerDimensions.height||0,width:e.width()-this.outerDimensions.width||0})},_renderProxy:function(){var i=this.element,e=this.options;this.elementOffset=i.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++e.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,i){return{width:this.originalSize.width+i}},w:function(t,i){var e=this.originalSize;return{left:this.originalPosition.left+i,width:e.width-i}},n:function(t,i,e){var s=this.originalSize;return{top:this.originalPosition.top+e,height:s.height-e}},s:function(t,i,e){return{height:this.originalSize.height+e}},se:function(i,e,s){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[i,e,s]))},sw:function(i,e,s){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[i,e,s]))},ne:function(i,e,s){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[i,e,s]))},nw:function(i,e,s){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[i,e,s]))}},_propagate:function(i,e){t.ui.plugin.call(this,i,[e,this.ui()]),"resize"!==i&&this._trigger(i,e,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(i){var e=t(this).resizable("instance"),s=e.options,h=e._proportionallyResizeElements,n=h.length&&/textarea/i.test(h[0].nodeName),o=n&&e._hasScroll(h[0],"left")?0:e.sizeDiff.height,a=n?0:e.sizeDiff.width,l={width:e.size.width-a,height:e.size.height-o},r=parseFloat(e.element.css("left"))+(e.position.left-e.originalPosition.left)||null,p=parseFloat(e.element.css("top"))+(e.position.top-e.originalPosition.top)||null;e.element.animate(t.extend(l,p&&r?{top:p,left:r}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseFloat(e.element.css("width")),height:parseFloat(e.element.css("height")),top:parseFloat(e.element.css("top")),left:parseFloat(e.element.css("left"))};h&&h.length&&t(h[0]).css({width:s.width,height:s.height}),e._updateCache(s),e._propagate("resize",i)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var i,e,s,h,n,o,a,l=t(this).resizable("instance"),r=l.options,p=l.element,d=r.containment,g=d instanceof t?d.get(0):/parent/.test(d)?p.parent().get(0):d;g&&(l.containerElement=t(g),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(i=t(g),e=[],t(["Top","Right","Left","Bottom"]).each((function(t,s){e[t]=l._num(i.css("padding"+s))})),l.containerOffset=i.offset(),l.containerPosition=i.position(),l.containerSize={height:i.innerHeight()-e[3],width:i.innerWidth()-e[1]},s=l.containerOffset,h=l.containerSize.height,n=l.containerSize.width,o=l._hasScroll(g,"left")?g.scrollWidth:n,a=l._hasScroll(g)?g.scrollHeight:h,l.parentData={element:g,left:s.left,top:s.top,width:o,height:a}))},resize:function(i){var e,s,h,n,o=t(this).resizable("instance"),a=o.options,l=o.containerOffset,r=o.position,p=o._aspectRatio||i.shiftKey,d={top:0,left:0},g=o.containerElement,u=!0;g[0]!==document&&/static/.test(g.css("position"))&&(d=l),r.left<(o._helper?l.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-l.left:o.position.left-d.left),p&&(o.size.height=o.size.width/o.aspectRatio,u=!1),o.position.left=a.helper?l.left:0),r.top<(o._helper?l.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-l.top:o.position.top),p&&(o.size.width=o.size.height*o.aspectRatio,u=!1),o.position.top=o._helper?l.top:0),h=o.containerElement.get(0)===o.element.parent().get(0),n=/relative|absolute/.test(o.containerElement.css("position")),h&&n?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),e=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-d.left:o.offset.left-l.left)),s=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-d.top:o.offset.top-l.top)),e+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-e,p&&(o.size.height=o.size.width/o.aspectRatio,u=!1)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,p&&(o.size.width=o.size.height*o.aspectRatio,u=!1)),u||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var i=t(this).resizable("instance"),e=i.options,s=i.containerOffset,h=i.containerPosition,n=i.containerElement,o=t(i.helper),a=o.offset(),l=o.outerWidth()-i.sizeDiff.width,r=o.outerHeight()-i.sizeDiff.height;i._helper&&!e.animate&&/relative/.test(n.css("position"))&&t(this).css({left:a.left-h.left-s.left,width:l,height:r}),i._helper&&!e.animate&&/static/.test(n.css("position"))&&t(this).css({left:a.left-h.left-s.left,width:l,height:r})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var i=t(this).resizable("instance").options;t(i.alsoResize).each((function(){var i=t(this);i.data("ui-resizable-alsoresize",{width:parseFloat(i.width()),height:parseFloat(i.height()),left:parseFloat(i.css("left")),top:parseFloat(i.css("top"))})}))},resize:function(i,e){var s=t(this).resizable("instance"),h=s.options,n=s.originalSize,o=s.originalPosition,a={height:s.size.height-n.height||0,width:s.size.width-n.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0};t(h.alsoResize).each((function(){var i=t(this),s=t(this).data("ui-resizable-alsoresize"),h={},n=i.parents(e.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(n,(function(t,i){var e=(s[i]||0)+(a[i]||0);e&&e>=0&&(h[i]=e||null)})),i.css(h)}))},stop:function(){t(this).removeData("ui-resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var i=t(this).resizable("instance"),e=i.size;i.ghost=i.originalElement.clone(),i.ghost.css({opacity:.25,display:"block",position:"relative",height:e.height,width:e.width,margin:0,left:0,top:0}),i._addClass(i.ghost,"ui-resizable-ghost"),!1!==t.uiBackCompat&&"string"==typeof i.options.ghost&&i.ghost.addClass(this.options.ghost),i.ghost.appendTo(i.helper)},resize:function(){var i=t(this).resizable("instance");i.ghost&&i.ghost.css({position:"relative",height:i.size.height,width:i.size.width})},stop:function(){var i=t(this).resizable("instance");i.ghost&&i.helper&&i.helper.get(0).removeChild(i.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var i,e=t(this).resizable("instance"),s=e.options,h=e.size,n=e.originalSize,o=e.originalPosition,a=e.axis,l="number"==typeof s.grid?[s.grid,s.grid]:s.grid,r=l[0]||1,p=l[1]||1,d=Math.round((h.width-n.width)/r)*r,g=Math.round((h.height-n.height)/p)*p,u=n.width+d,c=n.height+g,f=s.maxWidth&&s.maxWidth<u,m=s.maxHeight&&s.maxHeight<c,z=s.minWidth&&s.minWidth>u,w=s.minHeight&&s.minHeight>c;s.grid=l,z&&(u+=r),w&&(c+=p),f&&(u-=r),m&&(c-=p),/^(se|s|e)$/.test(a)?(e.size.width=u,e.size.height=c):/^(ne)$/.test(a)?(e.size.width=u,e.size.height=c,e.position.top=o.top-g):/^(sw)$/.test(a)?(e.size.width=u,e.size.height=c,e.position.left=o.left-d):((c-p<=0||u-r<=0)&&(i=e._getPaddingPlusBorderDimensions(this)),c-p>0?(e.size.height=c,e.position.top=o.top-g):(c=p-i.height,e.size.height=c,e.position.top=o.top+n.height-c),u-r>0?(e.size.width=u,e.position.left=o.left-d):(u=r-i.width,e.size.width=u,e.position.left=o.left+n.width-u))}}),t.ui.resizable})?s.apply(i,h):s)||(t.exports=n)},"zq/Y":function(t,i,e){var s,h,n;
/*!
 * jQuery UI Disable Selection 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */h=[e("oDIA"),e("O+lX")],void 0===(n="function"==typeof(s=function(t){return t.fn.extend({disableSelection:(i="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(i+".ui-disableSelection",(function(t){t.preventDefault()}))}),enableSelection:function(){return this.off(".ui-disableSelection")}});var i})?s.apply(i,h):s)||(t.exports=n)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.resizable', location = 'aui.chunk.1d90a28dade82944164d--39af490fb549187563a7.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.resizable"],{kW2n:function(u,i,n){"use strict";n.r(i);n("2V+C"),n("XnJT");i.default="jquery"}},[["kW2n","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.vendors--9c8c8c1546","aui.splitchunk.vendors--85718a7eef","aui.splitchunk.0d131bcbf1"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--7c76061134', location = 'aui.chunk.c2836e51a0ee32304449--2c05e867cf130e8d8ebe.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--7c76061134"],{TRfs:function(e,t,s){"use strict";s.r(t)},iCCw:function(e,t,s){var l,i,n;
/*!
 * jQuery UI Selectable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */i=[s("oDIA"),s("XPYc"),s("O+lX"),s("yIBB")],void 0===(n="function"==typeof(l=function(e){return e.widget("ui.selectable",e.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t.elementPos=e(t.element[0]).offset(),t.selectees=e(t.options.filter,t.element[0]),t._addClass(t.selectees,"ui-selectee"),t.selectees.each((function(){var s=e(this),l=s.offset(),i={left:l.left-t.elementPos.left,top:l.top-t.elementPos.top};e.data(this,"selectable-item",{element:this,$element:s,left:i.left,top:i.top,right:i.left+s.outerWidth(),bottom:i.top+s.outerHeight(),startselected:!1,selected:s.hasClass("ui-selected"),selecting:s.hasClass("ui-selecting"),unselecting:s.hasClass("ui-unselecting")})}))},this.refresh(),this._mouseInit(),this.helper=e("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(t){var s=this,l=this.options;this.opos=[t.pageX,t.pageY],this.elementPos=e(this.element[0]).offset(),this.options.disabled||(this.selectees=e(l.filter,this.element[0]),this._trigger("start",t),e(l.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),l.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each((function(){var l=e.data(this,"selectable-item");l.startselected=!0,t.metaKey||t.ctrlKey||(s._removeClass(l.$element,"ui-selected"),l.selected=!1,s._addClass(l.$element,"ui-unselecting"),l.unselecting=!0,s._trigger("unselecting",t,{unselecting:l.element}))})),e(t.target).parents().addBack().each((function(){var l,i=e.data(this,"selectable-item");if(i)return l=!t.metaKey&&!t.ctrlKey||!i.$element.hasClass("ui-selected"),s._removeClass(i.$element,l?"ui-unselecting":"ui-selected")._addClass(i.$element,l?"ui-selecting":"ui-unselecting"),i.unselecting=!l,i.selecting=l,i.selected=l,l?s._trigger("selecting",t,{selecting:i.element}):s._trigger("unselecting",t,{unselecting:i.element}),!1})))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var s,l=this,i=this.options,n=this.opos[0],c=this.opos[1],a=t.pageX,o=t.pageY;return n>a&&(s=a,a=n,n=s),c>o&&(s=o,o=c,c=s),this.helper.css({left:n,top:c,width:a-n,height:o-c}),this.selectees.each((function(){var s=e.data(this,"selectable-item"),r=!1,u={};s&&s.element!==l.element[0]&&(u.left=s.left+l.elementPos.left,u.right=s.right+l.elementPos.left,u.top=s.top+l.elementPos.top,u.bottom=s.bottom+l.elementPos.top,"touch"===i.tolerance?r=!(u.left>a||u.right<n||u.top>o||u.bottom<c):"fit"===i.tolerance&&(r=u.left>n&&u.right<a&&u.top>c&&u.bottom<o),r?(s.selected&&(l._removeClass(s.$element,"ui-selected"),s.selected=!1),s.unselecting&&(l._removeClass(s.$element,"ui-unselecting"),s.unselecting=!1),s.selecting||(l._addClass(s.$element,"ui-selecting"),s.selecting=!0,l._trigger("selecting",t,{selecting:s.element}))):(s.selecting&&((t.metaKey||t.ctrlKey)&&s.startselected?(l._removeClass(s.$element,"ui-selecting"),s.selecting=!1,l._addClass(s.$element,"ui-selected"),s.selected=!0):(l._removeClass(s.$element,"ui-selecting"),s.selecting=!1,s.startselected&&(l._addClass(s.$element,"ui-unselecting"),s.unselecting=!0),l._trigger("unselecting",t,{unselecting:s.element}))),s.selected&&(t.metaKey||t.ctrlKey||s.startselected||(l._removeClass(s.$element,"ui-selected"),s.selected=!1,l._addClass(s.$element,"ui-unselecting"),s.unselecting=!0,l._trigger("unselecting",t,{unselecting:s.element})))))})),!1}},_mouseStop:function(t){var s=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each((function(){var l=e.data(this,"selectable-item");s._removeClass(l.$element,"ui-unselecting"),l.unselecting=!1,l.startselected=!1,s._trigger("unselected",t,{unselected:l.element})})),e(".ui-selecting",this.element[0]).each((function(){var l=e.data(this,"selectable-item");s._removeClass(l.$element,"ui-selecting")._addClass(l.$element,"ui-selected"),l.selecting=!1,l.selected=!0,l.startselected=!0,s._trigger("selected",t,{selected:l.element})})),this._trigger("stop",t),this.helper.remove(),!1}})})?l.apply(t,i):l)||(e.exports=n)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.selectable', location = 'aui.chunk.e44f4e4256ae4032b5f4--d41b8c0fd130c843a8f9.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.selectable"],{FvNQ:function(u,i,n){"use strict";n.r(i);n("TRfs"),n("iCCw");i.default="jquery"}},[["FvNQ","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.vendors--7c76061134","aui.splitchunk.0d131bcbf1"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.roadmapPopupPanel = function(opt_data, opt_ignored) {
  return '<div class="roadmap-editor-popup"><div id=\'' + soy.$$escapeHtml(opt_data.roadmapPopupPanelId) + '\'></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapPopupPanel.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapPopupPanel';
}


Confluence.Templates.Roadmap.roadmapEditor = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-edit-area"><div id="roadmap-editor-edit-content"><!-- START GENERATE ROADMAP --><div id="roadmap-container"><div class="roadmap-drag-area"></div><div class="roadmap-frame"><div class="roadmap-marker"></div></div><div class="roadmap-content"></div></div><!-- END GENERATE ROADMAP --></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapEditor.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapEditor';
}


Confluence.Templates.Roadmap.lane = function(opt_data, opt_ignored) {
  return '<div class="roadmap-lane-title" style="background-color: ' + soy.$$escapeHtml(opt_data.color.lane) + '; color: ' + soy.$$escapeHtml(opt_data.color.text) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"><div class="title-outer"><div class="title-inner">' + soy.$$escapeHtml(opt_data.title) + '</div></div></div><div class="roadmap-separate-content">&nbsp;</div><div class="roadmap-lane-content"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.lane.soyTemplateName = 'Confluence.Templates.Roadmap.lane';
}


Confluence.Templates.Roadmap.marker = function(opt_data, opt_ignored) {
  return '<div class="marker-drag-placeholder"></div><div class="marker-title-wrapper"><span class="marker-title" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.title) + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.marker.soyTemplateName = 'Confluence.Templates.Roadmap.marker';
}


Confluence.Templates.Roadmap.bar = function(opt_data, opt_ignored) {
  return '<p class="roadmap-bar-title">' + soy.$$escapeHtml(opt_data.title) + '</p>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.bar.soyTemplateName = 'Confluence.Templates.Roadmap.bar';
}


Confluence.Templates.Roadmap.newRowLine = function(opt_data, opt_ignored) {
  return '<hr class="new-row-line" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowLine.soyTemplateName = 'Confluence.Templates.Roadmap.newRowLine';
}


Confluence.Templates.Roadmap.deprecationDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="' + soy.$$escapeHtml(opt_data.id) + '" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true"><header class="aui-dialog2-header"><h1 class="aui-dialog2-header-main">' + soy.$$escapeHtml('\u4e0d\u80fd\u8bbf\u95ee\u5b8f') + '</h1></header><div class="aui-dialog2-content">' + soy.$$filterNoAutoescape('\x3cp\x3e \u8def\u7ebf\u56fe\u5b8f\u6307\u4ee4\u5df2\u7ecf\u4f5c\u4e3a\u7248\u672c 1.2 \u88ab\u5f03\u7528\u4e86\u3002\u60a8\u4ecd\u7136\u53ef\u4ee5\u67e5\u770b\u60a8\u73b0\u6709\u7684\u8def\u7ebf\u56fe\u5b8f\u6307\u4ee4\uff0c\u4f46\u662f\u60a8\u5c06\u4e0d\u518d\u80fd\u591f\u7f16\u8f91\u5b83\u4eec\u6216\u521b\u5efa\u65b0\u7684\u3002\x3c/p\x3e\x3cp\x3e\u8bf7\u4f7f\u7528\u6211\u4eec\u65b0\u7684\u8def\u7ebf\u56fe\u8ba1\u5212\u5668\u5b8f\u6307\u4ee4\uff0c\u6765\u5b89\u6392\u60a8\u7684\u8def\u7ebf\u56fe\u3002\x3c/p\x3e') + '<div class="new-roadmap-thumb"></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button id="dialog-close-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('\u5173\u95ed') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.deprecationDialog.soyTemplateName = 'Confluence.Templates.Roadmap.deprecationDialog';
}


Confluence.Templates.Roadmap.newRowPlaceholder = function(opt_data, opt_ignored) {
  return '<hr class= "new-row-placeholder" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowPlaceholder.soyTemplateName = 'Confluence.Templates.Roadmap.newRowPlaceholder';
}


Confluence.Templates.Roadmap.laneDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'add-bar-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u6dfb\u52a0\u6a2a\u6761'}, iconClass: 'aui-icon-small aui-iconfont-add'}) + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u91cd\u547d\u540d\u9053'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + Confluence.Templates.Roadmap.laneColorSelect(opt_data) + ((opt_data.canDelete) ? aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u5220\u9664\u7ebf'}, iconClass: 'aui-icon-small delete-icon'}) : '');
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneDialog';
}


Confluence.Templates.Roadmap.markerDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u91cd\u547d\u540d\u6807\u8bb0'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u5220\u9664\u6807\u8bb0'}, iconClass: 'aui-icon-small delete-icon'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerDialog';
}


Confluence.Templates.Roadmap.markerRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'marker-title', name: 'marker-title', type: 'text', value: opt_data.markerTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: '\u4fdd\u5b58'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerRenameDialog';
}


Confluence.Templates.Roadmap.laneRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'lane-title', name: 'lane-title', type: 'text', value: opt_data.laneTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: '\u4fdd\u5b58'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneRenameDialog';
}


Confluence.Templates.Roadmap.laneColorSelect = function(opt_data, opt_ignored) {
  var output = '<a id="lane-color-select" href="#" aria-owns="lane-color-picker" aria-haspopup="true" class="aui-button aui-button-subtle aui-button-compact aui-dropdown2-trigger aui-style-default" title="' + soy.$$escapeHtml('\u9053\u7684\u989c\u8272') + '"><span class="color-item" style="background-color: ' + soy.$$escapeHtml(opt_data.laneColor) + ';">&nbsp;</span></a></a><div id="lane-color-picker" class="aui-dropdown2"><ul class="aui-list-truncate">';
  var colorList120 = opt_data.colors;
  var colorListLen120 = colorList120.length;
  for (var colorIndex120 = 0; colorIndex120 < colorListLen120; colorIndex120++) {
    var colorData120 = colorList120[colorIndex120];
    output += '<li class="color-display-item"><a href="#" ><span class="color-item ' + ((colorData120.lane == opt_data.laneColor) ? 'aui-icon aui-icon-small aui-iconfont-success' : '') + '" style="background-color: ' + soy.$$escapeHtml(colorData120.lane) + ';"></span></a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneColorSelect.soyTemplateName = 'Confluence.Templates.Roadmap.laneColorSelect';
}


Confluence.Templates.Roadmap.linkPageTitle = function(opt_data, opt_ignored) {
  return '<span class="link-page-title"></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.linkPageTitle.soyTemplateName = 'Confluence.Templates.Roadmap.linkPageTitle';
}


Confluence.Templates.Roadmap.footerActionContent = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({text: '\u63d2\u5165', id: 'roadmapInsertBtn'}) + aui.buttons.button({text: '\u53d6\u6d88', type: 'link', id: 'roadmapCancelBtn'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.footerActionContent.soyTemplateName = 'Confluence.Templates.Roadmap.footerActionContent';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar.js' */
(function(d,e){Roadmap.BarView=Backbone.View.extend({className:"roadmap-bar",events:{click:"_showDialog",dragstart:"_onDragstart",dragstop:"_onDragStop",dropover:"_onDropOver",dropout:"_onDropOut"},attributes:function(){return{cid:this.cid}},initialize:function(){e.bindAll(this,"render","_updateBar","_beforeResize","updateMaxWidth","_deleteBar","_updateTitle");this._addEvents()},_addEvents:function(){var a=this;this.$el.draggable({opacity:.3,cursor:"move",appendTo:".roadmap-drag-area",snap:".roadmap-bar-row, .new-bar-row",
snapMode:"inner",snapTolerance:17,scroll:!0,zIndex:4020,helper:function(){return a.$el.clone().addClass("roadmap-bar-clone").data("View",a)}});this.$el.droppable({accept:".roadmap-bar",tolerance:"touch",hoverClass:"bar-hover-bar"});this.$el.data("View",this)},render:function(){this.updateColor(this.options.color);var a=this.options.timelineView.getBarPosition(this.model.attributes);this.$el.css({left:a.left+"px",width:a.width+"px"});this.$el.attr("title",this.model.get("title"));this.$el.append(Confluence.Templates.Roadmap.bar({title:this.model.get("title")}));
this.$el.resizable({handles:"e, w",minWidth:Roadmap.barMinWidth,start:this._beforeResize,stop:this._updateBar});return this},updateMaxWidth:function(a){this.$el.resizable("option","maxWidth",a);var b=this.$el.resizable("option","minWidth");a<b&&this.$el.resizable("option","minWidth",a)},_beforeResize:function(a,b){this._barDialog&&this._barDialog.remove();this.trigger("beforeResize",this,this._checkHandleDirection(a))},_checkHandleDirection:function(a){a=d(a.toElement?a.toElement:a.originalEvent.target);
if(a.hasClass("ui-resizable-w"))return"left";if(a.hasClass("ui-resizable-e"))return"right";throw"Unsupport resize direction handling \x3d "+a;},_updateBar:function(a,b){b.originalPosition.left!=b.position.left?this.model.set({startDate:this.options.timelineView.getBarStartDate(b.position.left),duration:this.options.timelineView.getBarDuration(b.element.outerWidth())}):b.originalSize.width!=b.size.width&&this.model.set("duration",this.options.timelineView.getBarDuration(b.element.outerWidth()))},appendTo:function(a){this.$el.appendTo(a)},
updateColor:function(a){this.$el.css({"background-color":a.bar,"border-color":a.lane,color:a.text})},updatePositionLeft:function(a){this.$el.css("left",a)},_onDragStop:function(a,b){this.options.lane.cleanLaneAfterDrop();this.$el.trigger("BarView.dragstop")},updateDeleteBar:function(a){this.options.deleteBar=a},_showDialog:function(a){d(a.target).is(".ui-resizable-handle")||(this._barDialog&&this._barDialog.remove(),this._barDialog=this._createDialog(),this._barDialog.show(),Confluence.Roadmap.Analytics.openBarDialogInEdit())},
_createDialog:function(){return new Roadmap.BarDialogView({trigger:this.$el,model:this.model,timelineWidth:this.options.timelineView.$el.width(),renderOption:{isEditMode:!0,editInplace:{title:!0,pageLink:!0,description:!0}},linkPageEditable:!0,deleteBar:this._deleteBar,updateTitle:this._updateTitle,updateDescription:this._updateDescription,updatePageLink:this._updatePageLink,createLinkPageCallback:this._goToCreateLinkPage})},_deleteBar:function(){this.options.deleteBar(this)},_updateTitle:function(a){this.model.set("title",
a);this.$el.attr("title",a);this.$el.find(".roadmap-bar-title").html(AJS.escapeHtml(a))},_updateDescription:function(a){this.model.set("description",a)},_updatePageLink:function(a){this.model.set("pageLink",a)},_onDragstart:function(a,b){Roadmap.DragDrop.barDraggingOver={};this.$el.trigger("BarView.dragstart",[b])},_onDropOver:function(a,b){Roadmap.DragDrop.barDraggingOver[this.cid]=this.cid;Roadmap.DragDrop.barDraggingOver&&!0!==b.helper.data("isAddingNewRow")&&b.helper.addClass("roadmap-bar-overlapped")},
_onDropOut:function(a,b){delete Roadmap.DragDrop.barDraggingOver[this.cid];b.helper.removeClass("roadmap-bar-overlapped");e.each(Roadmap.DragDrop.barDraggingOver,function(c){!0!==b.helper.data("isAddingNewRow")&&("string"===typeof c?b.helper.addClass("roadmap-bar-overlapped"):"roadmap-bar-row"===c.className&&c.$el.addClass("roadmap-bar-drag-hover"))})},_goToCreateLinkPage:function(a){a.preventDefault();var b=this.me;a=parseInt(AJS.Meta.get("page-id"));a=0<a?a:AJS.Meta.get("parent-page-id");Confluence.RoadmapLink.addCreateLinkPageListener({roadmapBarId:b.model.id,
roadmapContentId:a,updateRoadmap:!1},function(c){c=b._updatePageLink(c.pageLink);b.fields.$pageLink.html(c)})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row.js' */
(function(c,e){Roadmap.BarRowView=Backbone.View.extend({className:"roadmap-bar-row",initialize:function(){e.bindAll(this,"_addEvents");this._addEvents();return this},attributes:function(){return{cid:this.cid}},_addEvents:function(){var d=this;this.$el.droppable({greedy:!0,tolerance:"pointer",hoverClass:"roadmap-bar-drag-hover",activeClass:"roadmap-bar-drag-active",accept:".roadmap-bar",over:function(b,a){Roadmap.DragDrop.barDraggingOver[d.cid]=d;!0!==a.helper.data("isAddingNewRow")?c(this).closest(".roadmap-content").find(".new-row-placeholder").remove():
d.$el.removeClass("roadmap-bar-drag-hover")},out:function(){var b=c(this);delete Roadmap.DragDrop.barDraggingOver[d.cid];b.closest(".roadmap-content").find(".new-row-placeholder").remove()},drop:function(b,a){b=0<e.reject(Roadmap.DragDrop.barDraggingOver,function(f){return"object"===typeof f}).length;a.helper.hasClass("roadmap-bar-overlapped")||b||c(this).trigger("BarView.drop",[{$barViewHelper:a.helper,$barViewOriginal:a.draggable,$barRow:c(this)},a])}})},isEmptyRow:function(){return this.$el.is(":empty")}})})(AJS.$,
window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row-new.js' */
(function(e,c){Roadmap.BarRowNewView=Backbone.View.extend({className:"new-bar-row",overlayTop:3,margin:5,events:{drop:"_onDrop",dropover:"_onDropOver",dropout:"_onDropOut"},initialize:function(){c.bindAll(this,"render","_addEvent");return this},render:function(){this.$el.append(Confluence.Templates.Roadmap.newRowLine());this._addEvent();this._setSizePosition();return this},_addEvent:function(){this.$el.droppable({accept:".roadmap-bar",tolerance:"pointer",hoverClass:"new-bar-row-hover"})},_setSizePosition:function(){var a=
this.options.$barRow,b=!1===this.options.renderBottom?-1*this.margin:a.height(),d=0===a.index()?this.overlayTop+this.margin:this.overlayTop;this.$el.css({top:a.position().top+b-d,width:a.width()})},_onDrop:function(a,b){this.$el.trigger("BarView.drop",[{barRowNewView:this},b])},_onDropOver:function(a,b){this.$el.trigger("BarRowNew.dropover",[this,b])},_onDropOut:function(a,b){this.$el.trigger("BarRowNew.dropout",[this,b])}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-dialog.js' */
(function(a,g){var d=Roadmap.InlineDialogView;Roadmap.LaneDialogView=d.extend({events:{"click #delete-button":"_onDeleteClick","click #rename-button":"_onRenameClick","click #add-bar-button":"_onAddBarClick"},initialize:function(){g.bindAll(this,"_onHide");this.options.dialogOptions={width:this._getDialogWidth(),hideCallback:this._onHide};a(".roadmap-editor-popup, .roadmap-macro-view").scroll(function(){a("#lane-color-picker").hide()});d.prototype.initialize.call(this,this.options)},_getContent:function(b){var e=
this.options.lane.model.get("color").lane;b.html(Confluence.Templates.Roadmap.laneDialog({canDelete:this.options.canDelete,colors:Roadmap.COLORS,laneColor:e}));this.$el.find(".aui-button").tooltip({gravity:"s"});var h=this,f=this.$el.find("#lane-color-picker .color-item");f.click(function(c){c.preventDefault();c=Roadmap.COLORS[f.index(this)];c.lane!=e&&h.options.changeColor(c);a("#lane-color-picker").hide()})},_getDialogWidth:function(){var b=2;this.options.canDelete&&b++;return 29*b+51},_onDeleteClick:function(){this.options.deleteLane();
this.remove()},_onRenameClick:function(){this._laneRenameDialog||(this._laneRenameDialog=new Roadmap.LaneRenameDialogView({trigger:this.options.trigger,lane:this.options.lane}));this._laneRenameDialog.show();this.hide()},_onAddBarClick:function(){this.options.addBar();this.remove()},_onHide:function(){a("#lane-color-picker").hide();d.prototype._onHide.call(this)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-rename-dialog.js' */
(function(d,e){var b=require("confluence/form-state-control"),c=Roadmap.InlineDialogView;Roadmap.LaneRenameDialogView=c.extend({events:{"click .rename-button":"_onRenameButtonClick","keyup .lane-title":"_onChangeLaneTitle"},initialize:function(){this.options.dialogOptions={width:this._getDialogWidth()};c.prototype.initialize.call(this,this.options)},_getContent:function(a){a.html(Confluence.Templates.Roadmap.laneRenameDialog({laneTitle:this.options.trigger.text()}));this.controls={$renameButton:this.$el.find(".rename-button"),
$laneTitle:this.$el.find(".lane-title")}},_getDialogWidth:function(){return 315},_onChangeLaneTitle:function(a){d.trim(this.controls.$laneTitle.val())?(b.enableElement(this.controls.$renameButton),a.which==AJS.$.ui.keyCode.ENTER&&this.controls.$renameButton.click()):b.disableElement(this.controls.$renameButton)},_onShow:function(a){this.controls.$laneTitle.select()},_onRenameButtonClick:function(a){a.preventDefault();this.hide();a=this.controls.$laneTitle.val();this.options.lane.renameTitle(a)}})})(AJS.$,
window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-dialog.js' */
(function(c,d){var a=Roadmap.InlineDialogView;Roadmap.MarkerDialogView=a.extend({events:{"click #rename-button":"_onRenameButtonClick","click #delete-button":"_onDeleteButtonClick"},initialize:function(){this.options.dialogOptions={width:60};a.prototype.initialize.call(this,this.options)},_getContent:function(b){b.html(Confluence.Templates.Roadmap.markerDialog());this.$el.find(".aui-button.aui-button-compact").tooltip({gravity:"s"})},_onRenameButtonClick:function(){this._markerRenameDialog||(this._markerRenameDialog=
new Roadmap.MarkerRenameDialogView({trigger:this.options.trigger,marker:this.options.marker}));this._markerRenameDialog.show();this.hide()},_onDeleteButtonClick:function(){this.options.marker.removeMarker();this.hide()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-rename-dialog.js' */
(function(d,e){var b=require("confluence/form-state-control"),c=Roadmap.InlineDialogView;Roadmap.MarkerRenameDialogView=c.extend({events:{"click .rename-button":"_onSaveButtonClick","keyup .marker-title":"_onChangeMarkerTitle"},initialize:function(){this.options.dialogOptions={width:315};c.prototype.initialize.call(this,this.options)},_getContent:function(a){a.html(Confluence.Templates.Roadmap.markerRenameDialog({markerTitle:this.options.marker.model.get("title")}));this.controls={$renameButton:this.$el.find(".rename-button"),
$title:this.$el.find(".marker-title")}},_onChangeMarkerTitle:function(a){d.trim(this.controls.$title.val())?(b.enableElement(this.controls.$renameButton),a.which==AJS.$.ui.keyCode.ENTER&&this.controls.$renameButton.click()):b.disableElement(this.controls.$renameButton)},_onShow:function(a){this.controls.$title.select()},_onSaveButtonClick:function(a){a.preventDefault();this.hide();this.options.marker.renameTitle(this.controls.$title.val())}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane.js' */
(function(k,f){window.Roadmap=window.Roadmap||{};Roadmap.LaneView=Backbone.View.extend({tagName:"div",className:"roadmap-lane",events:{"click .roadmap-lane-title":"_showDialog","BarView.drop":"_onBarDropped","BarRowNew.dropover":"_onBarRowNewDropover","BarRowNew.dropout":"_onBarRowNewDropout"},attributes:function(){return{cid:this.cid}},initialize:function(){f.bindAll(this,"render","renameTitle","updateRowIndex","removeEmptyRow","cleanLaneAfterDrop","_deleteLane","_updateLaneHeight","_renderComplete",
"_deleteBar","_addBar","_changeColor","addDefaultBarRow");this._barViews=[];this._barRowViews=[];this.listenTo(this.model.get("bars"),"add",function(a){var b=this._newBarRowView();a=this._newBarView(a);b.$el.append(a.render().$el);this._$laneContent.append(b.$el);this._barViews.push(a);this.$el.trigger("BarView.add",a);f.defer(this._updateLaneHeight)})},render:function(){var a=this;this.$el.append(Confluence.Templates.Roadmap.lane({title:this.model.get("title"),color:this.model.get("color")}));Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),
1);var b=this.model.get("bars").models;b=f.sortBy(b,function(c){return c.attributes.rowIndex});f.each(b,function(c){c=a._newBarView(c);a._barViews.push(c)});this._renderBars();f.defer(this._renderComplete);return this},_renderComplete:function(){this._updateLaneHeight()},renameTitle:function(a){this.model.set("title",a);this.$el.find(".roadmap-lane-title").attr("title",a);this.$el.find(".title-inner").html(AJS.escapeHtml(a));this._updateLaneHeight()},_updateLaneHeight:function(){var a=this.$el.find(".title-inner");
a.hide();var b=this._$laneContent.outerHeight();a.width(b-2*Roadmap.LANE_PADDING);a.show()},_barBeforeResize:function(a,b){var c=a.$el,d=Math.ceil(c.outerWidth()-c.width());"left"==b?(b=this._getNearestBarView(a,b),d=null==b?0:b.position().left+b.width()+d,d=c.position().left-d,c=c.width()+d):(b=this._getNearestBarView(a,b),c=(null==b?this._getLaneContentWidth()-d:b.position().left-d)-c.position().left);a.updateMaxWidth(c-Roadmap.BAR_MARGIN)},_renderBars:function(){var a=this;this._$laneContent=this.$el.find(".roadmap-lane-content");
var b={};f.each(this._barViews,function(c){var d="row-"+c.model.get("rowIndex"),e=b[d];e||(e=a._newBarRowView(c.model.get("rowIndex")),b[d]=e);e.$el.append(c.render().$el);a._$laneContent.append(e.$el)})},_newBarRowView:function(){var a=new Roadmap.BarRowView;this._barRowViews.push(a);return a},_newBarView:function(a){a=new Roadmap.BarView({model:a,lane:this,color:this.model.get("color"),timelineView:this.options.timelineView,deleteBar:this._deleteBar});a.on("beforeResize",f.bind(this._barBeforeResize,
this));return a},_getNearestBarView:function(a,b){var c=f.filter(a.options.lane._barViews,function(e){return e.model.get("rowIndex")===a.model.get("rowIndex")}),d=null;"left"==b?f.each(c,function(e){e.$el.position().left<a.$el.position().left&&(null==d||e.$el.position().left>d.$el.position().left)&&(d=e)}):f.each(c,function(e){e.$el.position().left>a.$el.position().left&&(null==d||e.$el.position().left<d.$el.position().left)&&(d=e)});return null!=d?d.$el:null},_getLaneContentWidth:function(){return this.$el.find(".roadmap-lane-content").width()},
_showDialog:function(){this._laneDialog&&this._laneDialog.remove();this._laneDialog=this._createLaneDialog();this._laneDialog.show()},_createLaneDialog:function(){return new Roadmap.LaneDialogView({trigger:this.$el.find(".title-outer"),canDelete:this.options.canDelete,deleteLane:this._deleteLane,addBar:this._addBar,changeColor:this._changeColor,lane:this})},_onBarDropped:function(a,b,c){var d=!!b.barRowNewView;a=c.draggable.data("View");var e=a.model,g=a.options.lane,h=g.cid===this.cid,l=this.model.get("bars"),
m=c.position.left,n=this.options.timelineView.getBarStartDate(m);h&&1===l.models.length&&d||(a.updatePositionLeft(m),a.updateColor(this.model.get("color")),e.attributes.startDate=n,d?(d=this._newBarRowView(),b.barRowNewView.$el.replaceWith(d.$el),a.appendTo(d.$el)):a.appendTo(b.$barRow),c.helper.remove(),h||(a.options.lane.removeEmptyRow(),l._byId[e.id]=e,this._barViews.push(a),a.updateDeleteBar(this._deleteBar),g.model.get("bars").remove(e),l.models.push(e),g._barViews.splice(f.indexOf(g._barViews,
a),1),this.updateRowIndex(g.$el),a.options=f.extend(a.options,{color:this.model.get("color"),lane:this}),g._updateLaneHeight()),this.removeEmptyRow(),this.updateRowIndex(this.$el),this._updateLaneHeight())},updateRowIndex:function(a){a.find(".roadmap-bar-row").each(function(b,c){k(c).find('.roadmap-bar:not(".roadmap-bar-clone")').each(function(d,e){if(d=k(e).data("View"))d.model.attributes.rowIndex=b})})},removeEmptyRow:function(){var a=0;f.each(this._barRowViews,function(b){b.isEmptyRow()&&(b.remove(),
a++)});return!!a},cleanLaneAfterDrop:function(){this._$laneContent.find(".roadmap-bar-drag-active").removeClass("roadmap-bar-drag-active");this._$laneContent.find(".new-row-placeholder").remove()},_deleteLane:function(){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),-1);this.$el.trigger("Lane.delete",this)},updateDeleteStatus:function(a){this._laneDialog&&(this._laneDialog.remove(),delete this._laneDialog);this.options.canDelete=a},_deleteBar:function(a){this.model.get("bars").remove(a.model);
this._barViews.splice(f.indexOf(this._barViews,a),1);a.remove();this.removeEmptyRow()&&(this.updateRowIndex(this.$el),this._updateLaneHeight(),this.$el.trigger("BarRowView.remove"))},_addBar:function(){const a=this.model.get("bars");var b=this.options.timelineView.model;const c=Confluence.Roadmap.DateUtilities.parseDate(b.get("startDate"));b=b.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.DateUtilities.getStartOfMonth(c):Confluence.Roadmap.DateUtilities.getStartOfIsoWeek(c);
a.add(new Roadmap.Bar({rowIndex:this.model.getNumberOfRows(),startDate:b}))},_changeColor:function(a){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),-1);this.model.set("color",a);Confluence.Roadmap.ColorHelper.adjustColorCount(a,1);this.$el.find(".roadmap-lane-title").css({"background-color":a.lane,color:a.text});f.each(this._barViews,function(b){b.updateColor(a)})},addNewBarRow:function(a){var b=this._$laneContent.find(".roadmap-bar-row"),c=[],d=function(){b.each(function(){var g=
k(this);if(0===g.index()){var h=new Roadmap.BarRowNewView({$barRow:g,renderBottom:!1});g.before(h.render().$el);c.push(h)}h=new Roadmap.BarRowNewView({$barRow:g});g.after(h.render().$el);c.push(h)})};if(0==b.length)this.addDefaultBarRow();else{var e=b.find(".roadmap-bar");0<e.length&&(0<e.length&&1==e.length&&e.attr("cid")===a.attr("cid")||d())}return c},addDefaultBarRow:function(){var a=this._newBarRowView();this._$laneContent.append(a.$el)},_onBarRowNewDropover:function(a,b,c){f.isEmpty(Roadmap.DragDrop.barDraggingOver)||
f.each(Roadmap.DragDrop.barDraggingOver,function(d){d.$el&&d.$el.removeClass("new-bar-row-hover roadmap-bar-drag-hover")});Roadmap.DragDrop.barDraggingOver[b.cid]=b;c.helper.removeClass("roadmap-bar-overlapped");c.helper.data("isAddingNewRow",!0)},_onBarRowNewDropout:function(a,b,c){c.helper.data("isAddingNewRow",!1);delete Roadmap.DragDrop.barDraggingOver[b.cid];f.each(Roadmap.DragDrop.barDraggingOver,function(d){"string"===typeof d?c.helper.addClass("roadmap-bar-overlapped"):"roadmap-bar-row"===
d.className&&!0!==c.helper.data("isAddingNewRow")&&d.$el.addClass("roadmap-bar-drag-hover")})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker.js' */
(function(d,c){window.Roadmap=window.Roadmap||{};Roadmap.MarkerView=Backbone.View.extend({className:"vertical-line",events:{dragstop:"_onDragStop",dragstart:"_onDragStart"},initialize:function(){c.bindAll(this,"render","updateHeight","renameTitle","_renderComplete","_onMarkerClick")},render:function(){var a=this.options.roadmap._timelineView.model;a=a.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.Helper.getPosXOnMonthTimeline(a.attributes,this.model.get("markerDate")):
Confluence.Roadmap.Helper.getPosXOnWeekTimeline(a.attributes,this.model.get("markerDate"));if(0>a||a>this.options.roadmap._timelineView.$el.width())return!1;this.$el.css({left:a+Roadmap.LANE_TITLE_WIDTH+"px"});this.$el.append(Confluence.Templates.Roadmap.marker({title:this.model.get("title")}));this.updateHeight(this.options.roadmap._getLaneHeight());c.defer(this._renderComplete);return this},_renderComplete:function(){this._setupMarkerDragging();this.$el.click(this._onMarkerClick);this.$el.find(".marker-title").ellipsis({row:Roadmap.MARKER_TITLE_LINE})},
_setupMarkerDragging:function(){this.$el.draggable({axis:"x",zIndex:4013,containment:".roadmap-frame-content",cursor:"move"})},_onDragStop:function(a,b){a=b.position.left-Roadmap.LANE_TITLE_WIDTH;b=this.options.roadmap._timelineView.model.attributes;a=b.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.Helper.getMonthStartDateByPosition(b,a):Confluence.Roadmap.Helper.getWeekStartDateByPosition(b,a);this.model.set("markerDate",a)},_onDragStart:function(a,b){this.options.roadmap.hideDialog()},
_onMarkerClick:function(a){d(a.target).hasClass("marker-title")&&(this._markerDialog&&this._markerDialog.remove(),this._markerDialog=this._createMarkerDialog(),this._markerDialog.show())},_createMarkerDialog:function(){return new Roadmap.MarkerDialogView({trigger:this.$el.find(".marker-title"),marker:this})},updateHeight:function(a){this.$el.height(a+Roadmap.MARKER_HEIGHT_PADDING)},renameTitle:function(a){this.model.set("title",a);var b=this.$el.find(".marker-title");b.attr("title",a);b.html(AJS.escapeHtml(a)).ellipsis({row:Roadmap.MARKER_TITLE_LINE})},
removeMarker:function(){this.model.collection.remove(this.model);this.remove()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/roadmap.js' */
(function(f,d){window.Roadmap=window.Roadmap||{};Roadmap.RoadmapEditorView=Backbone.View.extend({className:"roadmap-editor-container",events:{"BarView.add":"_onAddBar","BarView.dragstart":"_onBarDragstart","BarView.dragstop":"_onBarDragstop","BarView.drop":"_onBarDropped","LaneView.drop":"_onBarDropped","Lane.delete":"_onDeleteLane","BarRowView.remove":"_onBarRowViewRemove","sortstart .roadmap-content":"_onSortStart","sortstop .roadmap-content":"_onSortStop",remove:"_onRemove"},initialize:function(){d.bindAll(this,
"render");this.listenTo(this.model.get("lanes"),"add",function(a){a=new Roadmap.LaneView({model:a,timelineView:this._timelineView,canDelete:!0});1===this._laneViews.length&&this._laneViews[0].updateDeleteStatus(!0);this._laneViews.push(a);this.$roadmapContent.append(a.render().$el);this._updateTimelineColumnHeight();this._scrollToBottom()});this.listenTo(this.model.get("markers"),"add",function(a){a=new Roadmap.MarkerView({model:a,roadmap:this});this.$roadmapMarker.append(a.render().$el);this._markerViews.push(a)});
this.listenTo(this.model.get("timeline"),"change",function(){this._isTimelineChanged()&&(this._calculateMinWidthOfABar(),this._timelineView.update(),this._timelineColumnView.update(),this.$roadmapContent.empty(),d.each(this._laneViews,function(a){a.remove()}),this._laneViews=[],this._renderLanes(),this.$roadmapMarker.empty(),this._markerViews=[],this._renderMarkers(),this._updateDragArea())})},render:function(){this.$el.html(Confluence.Templates.Roadmap.roadmapEditor());this._calculateMinWidthOfABar();
this._initVariables();this._renderToolbar();this._renderTimeline();this._renderLanes();this._renderMarkers();this._renderTimelineColumn();this._updateDragArea();return this},_calculateMinWidthOfABar:function(){Roadmap.barMinWidth=this.model.get("timeline").get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Roadmap.MONTH_BAR_MIN_WIDTH:Roadmap.WEEK_BAR_MIN_WIDTH},_initVariables:function(){this.$roadmapContainer=this.$el.find("#roadmap-container");this.$roadmapTimeline=this.$roadmapContainer.find(".roadmap-frame");
this.$roadmapContent=this.$roadmapContainer.find(".roadmap-content");this.$roadmapMarker=this.$roadmapContainer.find(".roadmap-marker");this._timelineView=new Roadmap.TimelineView({model:this.model.get("timeline")});this._timelineColumnView=new Roadmap.TimelineColumnView({model:this.model.get("timeline")});this._laneViews=[];this._markerViews=[]},_renderTimeline:function(){this.$roadmapTimeline.prepend(this._timelineView.render().$el)},_renderTimelineColumn:function(){this._updateTimelineColumnHeight();
this.$roadmapTimeline.append(this._timelineColumnView.render().$el)},_renderMarkers:function(){var a=this;this.model.get("markers").each(function(b){b=new Roadmap.MarkerView({model:b,roadmap:a});a.$roadmapMarker.append(b.render().$el);a._markerViews.push(b)})},_renderLanes:function(){Confluence.Roadmap.ColorHelper.resetColorCounts();var a=this;this._updateLaneWidth();var b=1<this.model.get("lanes").models.length;this.model.get("lanes").each(function(c){c=new Roadmap.LaneView({model:c,timelineView:a._timelineView,
canDelete:b});a._laneViews.push(c);a.$roadmapContent.append(c.render().$el)});this._setupLaneReordering()},_onAddBar:function(a,b){this._updateTimelineColumnHeight();a=b.$el;this._isInViewScreen(a)||this._scrollToBar(a)},_renderToolbar:function(){var a=f("#"+this.options.dialogId+" .aui-dialog2-content");a.find(".roadmap-toolbar").remove();var b=new Roadmap.ToolbarView({model:this.model,timelineView:this._timelineView});a.prepend(b.render().$el)},_getTimelineWidth:function(){return this.$roadmapTimeline.find(".roadmap-frame-title").width()},
_getLaneHeight:function(){return this.$roadmapContent.height()},_updateLaneWidth:function(){this.$roadmapContent.width(this._getTimelineWidth()+Roadmap.LANE_TITLE_WIDTH)},_scrollToBottom:function(){this.options.roadmapEditorPopup.scrollTop(this._getLaneHeight())},_isInViewScreen:function(a){return f.inviewport(a,{threshold:-200})},_scrollToBar:function(a){this.options.roadmapEditorPopup.scrollTop(a.parent().position().top);this.options.roadmapEditorPopup.scrollLeft(0)},_onBarDropped:function(){this._updateTimelineColumnHeight()},
_onDeleteLane:function(a,b){this.model.get("lanes").remove(b.model);this._laneViews.splice(d.indexOf(this._laneViews,b),1);b.remove();this._updateTimelineColumnHeight();1===this._laneViews.length&&this._laneViews[0].updateDeleteStatus(!1)},_onBarRowViewRemove:function(){this._updateTimelineColumnHeight()},_updateTimelineColumnHeight:function(){var a=this._getLaneHeight();this._timelineColumnView.updateHeight(a);d.each(this._markerViews,function(b){b.updateHeight(a)})},hideDialog:function(){f("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").hide()},
removeDialog:function(){f("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").remove()},_onBarDragstart:function(a,b){var c=this;this.hideDialog();this._updateDragArea();this._barRowNewViewList=[];d.each(this._laneViews,function(e){c._barRowNewViewList.push(e.addNewBarRow(b.helper))})},_updateDragArea:function(){this.$roadmapContainer.find(".roadmap-drag-area").css(this._timelineColumnView.getSizeAndPosition())},_onBarDragstop:function(){d.each(d.flatten(this._barRowNewViewList),function(a){a.remove()});
delete this._barRowNewViewList;d.each(this._laneViews,function(a){a.removeEmptyRow()})},_setupLaneReordering:function(){this.$roadmapContent.sortable({axis:"y",cursor:"move",handle:".roadmap-lane-title",opacity:.3,placeholder:"roadmap-lane lane-sorting-placeholder",helper:function(a,b){return f(b).clone().addClass("lane-sorting-hepler")}})},_onSortStart:function(a,b){this.hideDialog();this._timelineColumnView.$el.hide();b.placeholder.css({height:Math.min(b.helper.height(),100),width:b.helper.width()}).html(Confluence.Templates.Roadmap.lane(Roadmap.TRANSPARENT_LANE));
b.helper.find(".roadmap-lane-content").css({width:b.helper.width()-(b.helper.find(".roadmap-lane-title").outerWidth()+b.helper.find(".roadmap-separate-content").outerWidth())})},_onSortStop:function(a,b){this._timelineColumnView.$el.show();var c=b.item.attr("cid");a=d.find(this._laneViews,function(g){return g.cid===c}).model;var e=this.model.get("lanes");e.remove(a);e.models.splice(b.item.index(),0,a);e._byId[a.cid]=a},_onRemove:function(){this.$roadmapTimeline.remove()},_isMonthYearChanged:function(){var a=
function(c,e){return c.getMonth()!==e.getMonth()||c.getYear()!==e.getYear()?!0:!1},b=this.model.get("timeline");return a(b._previousAttributes.startDate,b.attributes.startDate)||a(b._previousAttributes.endDate,b.attributes.endDate)},_isWeekChanged:function(){var a=this.model.get("timeline"),b=a._previousAttributes.endDate,c=a.attributes.endDate;return!(Confluence.Roadmap.DateUtilities.areInSameWeek(a._previousAttributes.startDate,a.attributes.startDate)&&Confluence.Roadmap.DateUtilities.areInSameWeek(b,
c))},_isTimelineChanged:function(){var a=this.model.get("timeline"),b=a.changed.displayOption;b?this.model.updateDurationUnit(a.get("displayOption")):b=a.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?this._isMonthYearChanged():this._isWeekChanged();return b},resize:function(){this._updateLaneWidth();this._updateTimelineColumnHeight();this.$roadmapContent.css({top:this.$roadmapTimeline.find(".roadmap-column-title:first").innerHeight()})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-analytics-resources', location = 'analytics/roadmap-analytics.js' */
Confluence.Roadmap=Confluence.Roadmap||{};
Confluence.Roadmap.Analytics=function(g,e){function b(a,c){AJS.trigger("analytics",{name:a,data:c})}function d(a){var c=0;e.each(a.lanes,function(f){c+=f.bars.length});return{lanes:a.lanes.length,bars:c,markers:a.markers.length,months:Confluence.Roadmap.DateUtilities.getNumberOfMonths(Confluence.Roadmap.DateUtilities.parseDate(a.timeline.startDate),Confluence.Roadmap.DateUtilities.parseDate(a.timeline.endDate))+1}}return{insertRoadmap:function(){b("confluence.roadmap.insert")},createRoadmap:function(a){a=
d(a);b("confluence.roadmap.create",a)},editRoadmap:function(a){a=d(a);b("confluence.roadmap.edit",a)},openBarDialogInEdit:function(){b("confluence.roadmap.editmode.open_bar_dialog")},addDescription:function(){b("confluence.roadmap.editmode.add_description")},addPageLinkEditMode:function(a){b("confluence.roadmap.editmode.add_page_link",a)},addPageLinkViewMode:function(a){b("confluence.roadmap.viewmode.add_page_link",a)},openBarDialogInView:function(){b("confluence.roadmap.viewmode.open_bar_dialog")},
clickPageLink:function(){b("confluence.roadmap.viewmode.click_page_link")}}}(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.viewport.js' */
(function(a){a.belowthefold=function(b,c){return a(window).height()+a(window).scrollTop()<=a(b).offset().top-c.threshold};a.abovethetop=function(b,c){return a(window).scrollTop()>=a(b).offset().top+a(b).height()-c.threshold};a.rightofscreen=function(b,c){return a(window).width()+a(window).scrollLeft()<=a(b).offset().left-c.threshold||0>a(b).offset().left};a.leftofscreen=function(b,c){return a(window).scrollLeft()>=a(b).offset().left+a(b).width()-c.threshold};a.inviewport=function(b,c){return!a.rightofscreen(b,
c)&&!a.leftofscreen(b,c)&&!a.belowthefold(b,c)&&!a.abovethetop(b,c)};a.extend(a.expr[":"],{"below-the-fold":function(b,c,d){return a.belowthefold(b,{threshold:0})},"above-the-top":function(b,c,d){return a.abovethetop(b,{threshold:0})},"left-of-screen":function(b,c,d){return a.leftofscreen(b,{threshold:0})},"right-of-screen":function(b,c,d){return a.rightofscreen(b,{threshold:0})},"in-viewport":function(b,c,d){return a.inviewport(b,{threshold:0})}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.ellipsis.min.js' */
/*! jQuery ellipsis - v1.1.1 - 2014-02-23
* https://github.com/STAR-ZERO/jquery-ellipsis
* Copyright (c) 2014 Kenji Abe; Licensed MIT */
!function(a){a.fn.ellipsis=function(b){var c={row:1,onlyFullWords:!1,"char":"...",callback:function(){},position:"tail"};return b=a.extend(c,b),this.each(function(){var c=a(this),d=c.text(),e=d,f=e.length,g=c.height();c.text("a");var h=parseFloat(c.css("lineHeight"),10),i=c.height(),j=h>i?h-i:0,k=j*(b.row-1)+i*b.row;if(k>=g)return c.text(d),void b.callback.call(this);var l=1,m=0,n=d.length;if("tail"===b.position){for(;n>l;)m=Math.ceil((l+n)/2),c.text(d.slice(0,m)+b["char"]),c.height()<=k?l=m:n=m-1;d=d.slice(0,l),b.onlyFullWords&&(d=d.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d+=b["char"]}else if("middle"===b.position){for(var o=0;n>l;)m=Math.ceil((l+n)/2),o=Math.max(f-m,0),c.text(e.slice(0,Math.floor((f-o)/2))+b["char"]+e.slice(Math.floor((f+o)/2),f)),c.height()<=k?l=m:n=m-1;o=Math.max(f-l,0);var p=e.slice(0,Math.floor((f-o)/2)),q=e.slice(Math.floor((f+o)/2),f);b.onlyFullWords&&(p=p.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d=p+b["char"]+q}c.text(d),b.callback.call(this)}),this}}(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/md5.js' */
var hexcase=0,b64pad="";function hex_md5(d){return rstr2hex(rstr_md5(str2rstr_utf8(d)))}function b64_md5(d){return rstr2b64(rstr_md5(str2rstr_utf8(d)))}function any_md5(d,a){return rstr2any(rstr_md5(str2rstr_utf8(d)),a)}function hex_hmac_md5(d,a){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(d),str2rstr_utf8(a)))}function b64_hmac_md5(d,a){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(d),str2rstr_utf8(a)))}
function any_hmac_md5(d,a,b){return rstr2any(rstr_hmac_md5(str2rstr_utf8(d),str2rstr_utf8(a)),b)}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc").toLowerCase()}function rstr_md5(d){return binl2rstr(binl_md5(rstr2binl(d),8*d.length))}
function rstr_hmac_md5(d,a){var b=rstr2binl(d);16<b.length&&(b=binl_md5(b,8*d.length));var c=Array(16);d=Array(16);for(var e=0;16>e;e++)c[e]=b[e]^909522486,d[e]=b[e]^1549556828;a=binl_md5(c.concat(rstr2binl(a)),512+8*a.length);return binl2rstr(binl_md5(d.concat(a),640))}function rstr2hex(d){try{hexcase}catch(f){hexcase=0}for(var a=hexcase?"0123456789ABCDEF":"0123456789abcdef",b="",c,e=0;e<d.length;e++)c=d.charCodeAt(e),b+=a.charAt(c>>>4&15)+a.charAt(c&15);return b}
function rstr2b64(d){try{b64pad}catch(g){b64pad=""}for(var a="",b=d.length,c=0;c<b;c+=3)for(var e=d.charCodeAt(c)<<16|(c+1<b?d.charCodeAt(c+1)<<8:0)|(c+2<b?d.charCodeAt(c+2):0),f=0;4>f;f++)a=8*c+6*f>8*d.length?a+b64pad:a+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6*(3-f)&63);return a}
function rstr2any(d,a){var b=a.length,c,e,f,g=Array(Math.ceil(d.length/2));for(c=0;c<g.length;c++)g[c]=d.charCodeAt(2*c)<<8|d.charCodeAt(2*c+1);var l=Math.ceil(8*d.length/(Math.log(a.length)/Math.log(2)));d=Array(l);for(e=0;e<l;e++){var h=[];for(c=f=0;c<g.length;c++){f=(f<<16)+g[c];var k=Math.floor(f/b);f-=k*b;if(0<h.length||0<k)h[h.length]=k}d[e]=f;g=h}b="";for(c=d.length-1;0<=c;c--)b+=a.charAt(d[c]);return b}
function str2rstr_utf8(d){for(var a="",b=-1,c,e;++b<d.length;)c=d.charCodeAt(b),e=b+1<d.length?d.charCodeAt(b+1):0,55296<=c&&56319>=c&&56320<=e&&57343>=e&&(c=65536+((c&1023)<<10)+(e&1023),b++),127>=c?a+=String.fromCharCode(c):2047>=c?a+=String.fromCharCode(192|c>>>6&31,128|c&63):65535>=c?a+=String.fromCharCode(224|c>>>12&15,128|c>>>6&63,128|c&63):2097151>=c&&(a+=String.fromCharCode(240|c>>>18&7,128|c>>>12&63,128|c>>>6&63,128|c&63));return a}
function str2rstr_utf16le(d){for(var a="",b=0;b<d.length;b++)a+=String.fromCharCode(d.charCodeAt(b)&255,d.charCodeAt(b)>>>8&255);return a}function str2rstr_utf16be(d){for(var a="",b=0;b<d.length;b++)a+=String.fromCharCode(d.charCodeAt(b)>>>8&255,d.charCodeAt(b)&255);return a}function rstr2binl(d){for(var a=Array(d.length>>2),b=0;b<a.length;b++)a[b]=0;for(b=0;b<8*d.length;b+=8)a[b>>5]|=(d.charCodeAt(b/8)&255)<<b%32;return a}
function binl2rstr(d){for(var a="",b=0;b<32*d.length;b+=8)a+=String.fromCharCode(d[b>>5]>>>b%32&255);return a}
function binl_md5(d,a){d[a>>5]|=128<<a%32;d[(a+64>>>9<<4)+14]=a;a=1732584193;for(var b=-271733879,c=-1732584194,e=271733878,f=0;f<d.length;f+=16){var g=a,l=b,h=c,k=e;a=md5_ff(a,b,c,e,d[f+0],7,-680876936);e=md5_ff(e,a,b,c,d[f+1],12,-389564586);c=md5_ff(c,e,a,b,d[f+2],17,606105819);b=md5_ff(b,c,e,a,d[f+3],22,-1044525330);a=md5_ff(a,b,c,e,d[f+4],7,-176418897);e=md5_ff(e,a,b,c,d[f+5],12,1200080426);c=md5_ff(c,e,a,b,d[f+6],17,-1473231341);b=md5_ff(b,c,e,a,d[f+7],22,-45705983);a=md5_ff(a,b,c,e,d[f+8],7,
1770035416);e=md5_ff(e,a,b,c,d[f+9],12,-1958414417);c=md5_ff(c,e,a,b,d[f+10],17,-42063);b=md5_ff(b,c,e,a,d[f+11],22,-1990404162);a=md5_ff(a,b,c,e,d[f+12],7,1804603682);e=md5_ff(e,a,b,c,d[f+13],12,-40341101);c=md5_ff(c,e,a,b,d[f+14],17,-1502002290);b=md5_ff(b,c,e,a,d[f+15],22,1236535329);a=md5_gg(a,b,c,e,d[f+1],5,-165796510);e=md5_gg(e,a,b,c,d[f+6],9,-1069501632);c=md5_gg(c,e,a,b,d[f+11],14,643717713);b=md5_gg(b,c,e,a,d[f+0],20,-373897302);a=md5_gg(a,b,c,e,d[f+5],5,-701558691);e=md5_gg(e,a,b,c,d[f+
10],9,38016083);c=md5_gg(c,e,a,b,d[f+15],14,-660478335);b=md5_gg(b,c,e,a,d[f+4],20,-405537848);a=md5_gg(a,b,c,e,d[f+9],5,568446438);e=md5_gg(e,a,b,c,d[f+14],9,-1019803690);c=md5_gg(c,e,a,b,d[f+3],14,-187363961);b=md5_gg(b,c,e,a,d[f+8],20,1163531501);a=md5_gg(a,b,c,e,d[f+13],5,-1444681467);e=md5_gg(e,a,b,c,d[f+2],9,-51403784);c=md5_gg(c,e,a,b,d[f+7],14,1735328473);b=md5_gg(b,c,e,a,d[f+12],20,-1926607734);a=md5_hh(a,b,c,e,d[f+5],4,-378558);e=md5_hh(e,a,b,c,d[f+8],11,-2022574463);c=md5_hh(c,e,a,b,d[f+
11],16,1839030562);b=md5_hh(b,c,e,a,d[f+14],23,-35309556);a=md5_hh(a,b,c,e,d[f+1],4,-1530992060);e=md5_hh(e,a,b,c,d[f+4],11,1272893353);c=md5_hh(c,e,a,b,d[f+7],16,-155497632);b=md5_hh(b,c,e,a,d[f+10],23,-1094730640);a=md5_hh(a,b,c,e,d[f+13],4,681279174);e=md5_hh(e,a,b,c,d[f+0],11,-358537222);c=md5_hh(c,e,a,b,d[f+3],16,-722521979);b=md5_hh(b,c,e,a,d[f+6],23,76029189);a=md5_hh(a,b,c,e,d[f+9],4,-640364487);e=md5_hh(e,a,b,c,d[f+12],11,-421815835);c=md5_hh(c,e,a,b,d[f+15],16,530742520);b=md5_hh(b,c,e,
a,d[f+2],23,-995338651);a=md5_ii(a,b,c,e,d[f+0],6,-198630844);e=md5_ii(e,a,b,c,d[f+7],10,1126891415);c=md5_ii(c,e,a,b,d[f+14],15,-1416354905);b=md5_ii(b,c,e,a,d[f+5],21,-57434055);a=md5_ii(a,b,c,e,d[f+12],6,1700485571);e=md5_ii(e,a,b,c,d[f+3],10,-1894986606);c=md5_ii(c,e,a,b,d[f+10],15,-1051523);b=md5_ii(b,c,e,a,d[f+1],21,-2054922799);a=md5_ii(a,b,c,e,d[f+8],6,1873313359);e=md5_ii(e,a,b,c,d[f+15],10,-30611744);c=md5_ii(c,e,a,b,d[f+6],15,-1560198380);b=md5_ii(b,c,e,a,d[f+13],21,1309151649);a=md5_ii(a,
b,c,e,d[f+4],6,-145523070);e=md5_ii(e,a,b,c,d[f+11],10,-1120210379);c=md5_ii(c,e,a,b,d[f+2],15,718787259);b=md5_ii(b,c,e,a,d[f+9],21,-343485551);a=safe_add(a,g);b=safe_add(b,l);c=safe_add(c,h);e=safe_add(e,k)}return[a,b,c,e]}function md5_cmn(d,a,b,c,e,f){return safe_add(bit_rol(safe_add(safe_add(a,d),safe_add(c,f)),e),b)}function md5_ff(d,a,b,c,e,f,g){return md5_cmn(a&b|~a&c,d,a,e,f,g)}function md5_gg(d,a,b,c,e,f,g){return md5_cmn(a&c|b&~c,d,a,e,f,g)}
function md5_hh(d,a,b,c,e,f,g){return md5_cmn(a^b^c,d,a,e,f,g)}function md5_ii(d,a,b,c,e,f,g){return md5_cmn(b^(a|~c),d,a,e,f,g)}function safe_add(d,a){var b=(d&65535)+(a&65535);return(d>>16)+(a>>16)+(b>>16)<<16|b&65535}function bit_rol(d,a){return d<<a|d>>>32-a};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor.js' */
AJS.toInit(function(){function u(){setTimeout(function(){if(d&&d.is(":visible")){var f=d.height(),p=d.find(".aui-dialog2-header").outerHeight(),q=d.find(".aui-dialog2-footer").outerHeight(),m=d.find("#roadmap-editor-toolbar").outerHeight();d.find(".roadmap-editor-popup").css("height",f-p-q-m)}},0)}var r,d,v,g,t;AJS.MacroBrowser.setMacroJsOverride("roadmap",{opener:function(f){var p=function(h,b,e,a){var c=e?e.split("~~~~~"):[];b=b?b.split("~~~~~"):[];_.isEmpty(c)?a&&a():$.ajax({type:"POST",contentType:"application/json",
url:AJS.contextPath()+"/rest/roadmap/1.0/extractPageLinks",data:JSON.stringify({wikiLinks:_.object(c,b),roadmapSpace:AJS.Meta.get("space-key")}),success:function(k){_.each(h.lanes,function(n){_.chain(n.bars).filter(function(l){return _.contains(c,l.id)}).each(function(l){k[l.id]&&(l.pageLink=k[l.id])})});a&&a()},error:function(k){AJS.log(k);a&&a()}})},q=function(h){var b=[],e=[];h.lanes.forEach(function(a){a.bars.forEach(function(c){if(!_.isEmpty(c.pageLink)){var k=c.pageLink.wikiLink.replace(/[\][]/g,
"");b.push(_.escape(k));e.push(c.id)}})});return{pageLinks:b.join("~~~~~"),mapLinks:e.join("~~~~~")}};if(f.params&&"true"!==f.params.timeline){var m=$(Confluence.Templates.Roadmap.deprecationDialog({id:"roadmap-deprecation-dialog"}));AJS.dialog2(m).on("hide",function(){$("#roadmap-deprecation-dialog").remove()}).on("show",function(){$("#dialog-close-button",m).click(function(h){h.preventDefault();AJS.dialog2("#roadmap-deprecation-dialog").hide()})}).show();return!1}var x=function(){"undefined"==typeof r&&
(r=aui.dialog.dialog2({id:"confluence-roadmap-dialog",size:"xlarge",titleText:"\u63d2\u5165\u8def\u7ebf\u56fe\u8ba1\u5212\u5668",content:Confluence.Templates.Roadmap.roadmapPopupPanel({roadmapPopupPanelId:"roadmap-popup-panel"}),footerActionContent:Confluence.Templates.Roadmap.footerActionContent(),modal:!0}),d=$(r).appendTo($("body")),d.find("#roadmapInsertBtn").on("click",function(a){g.removeDialog();a=g.model.toMacroData();var c=encodeURIComponent(JSON.stringify(a)),k=hex_md5(c),n=q(a);c={timeline:"true",
source:c,hash:k,title:encodeURIComponent(a.title),pagelinks:n.pageLinks,maplinks:n.mapLinks};tinymce.confluence.macrobrowser.macroBrowserComplete({name:"roadmap",params:c});g.remove();h.hide();t?Confluence.Roadmap.Analytics.createRoadmap(a):Confluence.Roadmap.Analytics.editRoadmap(a)}),d.find("#roadmapCancelBtn").on("click",function(a){g.removeDialog();g.remove();h.hide()}),v=d.find(".roadmap-editor-popup"));var h=AJS.dialog2("#confluence-roadmap-dialog").show();var b=$("#roadmap-popup-panel"),e=
b.find(".roadmap-view");e.length||(e=$('\x3cdiv class\x3d"roadmap-view"/\x3e'),b.append(e));b=new Roadmap.Roadmap(w,{parse:!0});g=new Roadmap.RoadmapEditorView({model:b,dialogId:"confluence-roadmap-dialog",el:e,roadmapEditorPopup:v});g.render();u()};if(f.params&&f.params.source){t=!1;var w=JSON.parse(decodeURIComponent(f.params.source));p(w,f.params.pagelinks,f.params.maplinks,x)}else t=!0,Confluence.Roadmap.Analytics.insertRoadmap(),x()}});$(window).resize(function(){u();g&&g.resize()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor-config.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.COLORS=[{lane:"#f6c342",bar:"#fadb8e",text:"#594300"},{lane:"#3b7fc4",bar:"#6c9fd3",text:"#ffffff"},{lane:"#d04437",bar:"#dc7369",text:"#ffffff"},{lane:"#8eb021",bar:"#aac459",text:"#ffffff"},{lane:"#ea632b",bar:"#ef8a60",text:"#ffffff"},{lane:"#654982",bar:"#8c77a1",text:"#ffffff"},{lane:"#f15c75",bar:"#f58598",text:"#ffffff"},{lane:"#815b3a",bar:"#a1846b",text:"#ffffff"}];Roadmap.TIMELINE_DISPLAY_OPTION={MONTH:"MONTH",WEEK:"WEEK"};Roadmap.SHORT_DATE_FORMAT=
"YYYY-MM-DD";Roadmap.WEEK_FORMAT="DD-MMM";Roadmap.MONTH_FORMAT="MMM";Roadmap.TIMELINE_YEARS_LIMIT=5;Roadmap.LANE_TITLE_WIDTH=45;Roadmap.MARKER_HEIGHT_PADDING=10;Roadmap.MARKER_TITLE_LINE=2;Roadmap.LANE_PADDING=11;Roadmap.BAR_PADDING=8;Roadmap.BAR_MARGIN=1;Roadmap.BAR_BORDER=1;Roadmap.MONTH_WIDTH=101;Roadmap.WEEK_WIDTH=101;Roadmap.EXTRA_SPACE_AROUND=2*Roadmap.BAR_PADDING+2*Roadmap.BAR_BORDER;Roadmap.MONTH_BAR_MIN_WIDTH=Roadmap.MONTH_WIDTH/4-Roadmap.EXTRA_SPACE_AROUND;Roadmap.WEEK_BAR_MIN_WIDTH=Roadmap.WEEK_WIDTH-
Roadmap.EXTRA_SPACE_AROUND;Roadmap.barMinWidth=Roadmap.MONTH_BAR_MIN_WIDTH;Roadmap.TRANSPARENT_LANE={title:"",color:{lane:"#ffffff",bar:"#ffffff",text:"#ffffff"}};Roadmap.DragDrop={};Roadmap.BarDialog={MAX_LENGTH_TITLE:100,MAX_LENGTH_DESCRIPTION:150};Roadmap.getDefaultRoadmapData=function(){const a=new Date((new Date).setHours(0,0,0,0)),b=new Date((new Date(a)).setMonth(a.getMonth()+11));return{title:"\u8def\u7ebf\u56fe\u7f16\u8f91\u5668",timeline:{startDate:new Date(a),endDate:b,displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH},
lanes:[{title:"\u9053 1",color:Roadmap.COLORS[0],bars:[{title:"\u6a2a\u67611",description:"\u8fd9\u662f\u7b2c\u4e00\u4e2a\u6a2a\u6761",startDate:new Date(a.setDate(1)),duration:2,rowIndex:0},{title:"\u680f 2",description:"\u8fd9\u662f\u7b2c\u4e8c\u680f\u3002",startDate:new Date(a),duration:1,rowIndex:1}]},{title:"\u9053 2",
color:Roadmap.COLORS[1],bars:[{title:"\u680f 3",description:"\u8fd9\u662f\u7b2c\u4e09\u680f\u3002",startDate:a,duration:2.5,rowIndex:0}]}],markers:[{title:"\u6807\u8bb0 1",markerDate:new Date((new Date(a)).setDate(15))}]}}})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd-slim', location = '/com/atlassian/confluence/extra/calendar3/amd/shim/dialogs-amd.js' */
define("tc/dialogs",function(){return Confluence.TeamCalendars.Dialogs});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd-slim', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/shim/backbone-amd.js' */
if(typeof Backbone!=="undefined"){define("tc-backbone",["underscore"],function(){return Backbone})};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd-slim', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/shim/wrm-amd.js' */
define("wrm",function(){return WRM});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:calendar-init-common', location = 'com/atlassian/confluence/extra/calendar3/components/initialiser/init-resources.js' */
define("tc/init-resources",["wrm","jquery"],function(a,c){var b=function(d){return d.removeClass("spinner").removeClass("aui-icon").removeClass("aui-icon-wait")};return{requireResources:function(){console.log("Init TC resources");a.require(["wrc!com.atlassian.confluence.extra.team-calendars.resources-batch"],function(){b(c("div.plugin-calendar"));require(["tc/calendar-plugin"],function(d){d.onTeamCalendarsLoaded()})}).fail(function(){b(c("div.plugin-calendar")).text("Failed to load calendar resources")})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:calendar-init-editor', location = 'com/atlassian/confluence/extra/calendar3/components/initialiser/initialiser-editor.js' */
define("tc/init-resources-unsupported-content-types",function(){var a=["comment","com.atlassian.confluence.plugins.confluence-questions:question"];return a});define("tc/wait-for-calendar-macro-browser-metadata",function(){var a;return function(){if(!a){a=new Promise(function(c){var b=setInterval(function(){if(AJS.MacroBrowser.getMacroMetadata("calendar")){clearInterval(b);c()}},100)})}return a}});define("tc/init-resources-function",["ajs","jquery","wrm","confluence/meta","confluence/api/logger","tc/init-resources-unsupported-content-types","tc/wait-for-calendar-macro-browser-metadata"],function(d,h,c,f,b,g,e){var a=function(){var i=f.get("content-type");if(g.indexOf(i)>=0){c.require(["wrc!com.atlassian.confluence.extra.team-calendars:editor"],function(){e().then(function(){d.MacroBrowser.getMacroMetadata("calendar").hidden=true;h(window).trigger("tc/init-resources-function--load-succeed");a.isEditorResourcesLoadSucceed=true;b.log("TC initialiser-editor: not loading TC editor resources for content-type="+i)})});return}b.log("TC initialiser-editor: Init TC resources in Editor. content-type="+i);c.require(["wrc!com.atlassian.confluence.extra.team-calendars:editor"],function(){require(["tc/init-resources","tc/macro-button-panel","tc/macro-browser","tc/macro-browser-event-macro","tc/editor-auto-convert"],function(l,o,k,j,n){try{o.init();k.init();j.init();n.init();l.requireResources();e().then(function(){d.MacroBrowser.getMacroMetadata("calendar").hidden=false;h(window).trigger("tc/init-resources-function--load-succeed");a.isEditorResourcesLoadSucceed=true})}catch(m){h(window).trigger("tc/init-resources-function--load-failed");a.isEditorResourcesLoadFailed=m;b.error("TC initialiser-editor: Could not init TC resources for editor",m)}})}).fail(function(j){h(window).trigger("tc/init-resources-function--load-failed");a.isEditorResourcesLoadFailed=j;b.error("TC initialiser-editor: Could not load TC resources for editor")})};return a});require(["tc/init-resources-function"],function(a){$(window).bind("rte-ready",a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'scripts/table-editor/tableplus-editor.js' */
// Todo - COPYRIGHT 
/*jshint esversion: 6 */
'use strict';

AJS.bind("init.rte", function(evt) {

    //console.log("appfire: event=" + evt.type + "; macro name=table-plus"); 
    
    (function ($) {
    //table-plus specific macro params
    //Total param count=26
    const tableplusParms = {
        autoNumberSort: false, 
        footing: 0,  
        heading: 1,
        hideHeader: false,
        border: "",
        width: "",
        multiple: true
    };
    
    var tableplusAllParms = $.extend({}, tablebasecme.commonTableParams, tableplusParms );
    appcme.setMacroJsOverride('table-plus', tableplusAllParms, function(macroDetails) {

        // merge specific ones with tableplusAllParms.
        var parms = appcme.parametersToObj(tableplusAllParms, macroDetails.params, tablebasecme.DELIMITER, tablebasecme.QUOTE);
        $.extend(parms, {macroName: macroDetails.name}); 
        
        return {
            icon: "/download/resources/org.swift.confluence.table/img/table-32x32.png",
            title: "Advanced Tables Editor - Table Plus",
            showPreview: true,
            dataAttributes: {commontableeditor: "true"}, // required for all apps built around the common table editors for common events
            navigation: {
                primary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-table-48-wht-on-clr.png"),
                        name: "Table settings",
                        panel: org.swift.confluence.table.editor.tableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-columns-48-wht-on-clr.png"),
                        name: "Column settings",
                        panel: org.swift.confluence.table.editor.columnSettingsPanel(parms),
                        /* Table Plus has the Column settings tab be the first tab when editor is opened.  */
                        activePanel: true 
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-rows-48-wht-on-clr.png"),
                        name: "Row formatting",
                        panel: org.swift.confluence.table.editor.rowSettingsPanel(parms)
                    }
                ],
                secondary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-guide-48-wht-on-clr.png"),
                        name: "Table Plus guide",
                        url: "https://apps.appf.re/tbl/doc/p2/userguide/tableplus"
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-docs-48-wht-on-clr.png"),
                        name: "Table Plus Documentation",
                        url: "https://apps.appf.re/tbl/doc/p2/userguide"
                    }
                ]
            },
            /**
             * Validate form fields. 
             * Input Parameters:
             *      dialog - The jQuery editor dialog 
             *      form - The jQuery form from the dialog 
             * Return Parameters:
             *      errors - This is a property array.  Each array element contains the message and an optinal jQuery element for the error.  
             * Return: 
             *      True if the form validates correctly and can be saved. False if there are any errors. The form will not be allowed to close in that case. 
             */
            validator: function (dialog, form, errors) {
                return tablebasecme.validateCommonTableParams(dialog, errors);
            }
        };
    });
    
    /**
     * On click of insert menu "table-plus" link, 1st native browser dialog shows up for a second until our opener code calls up. 
     * Workaround is to hide the native macro browser then.
     * "table-plus" -> its the linkid given in the atlassian-plugin.xml for the web-item key => "table-plus-macro-menu-link"
     */
    $(document).on("click", "#table-plus", function() {
        $("#macro-browser-dialog:visible").hide();
    });
    
    
    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'scripts/table-editor/csv-editor.js' */
// Todo - COPYRIGHT 
/*jshint esversion: 6 */
'use strict';

AJS.bind("init.rte", function(evt) {

    //console.log("appfire: event=" + evt.type + "; macro name=csv"); 
    
    (function ($) {
    //Total param count=43
    //csv Specific params here
    const csvParms = {
            output: "html",
            columns: "",
            script: "",
            profile:"",
            url: "",
            user: "",
            password: "",
            timeout: "",
            quote: "single",
            delimiter: ",",
            encoding: "",
            ignoreTrailingBlankRows: true,
            showWiki: false,
            escape: false,
            macros: false,
            augments: "",
            headingAugments: "",
            footingAugments: "",
            autoNumberSort: false,
            border: "",
            width: "",
            footing: 0,
            heading: 1,
            hideHeader: false,
            disableAntiXss: false
            
    }
    
    var csvAllParms = $.extend({}, tablebasecme.commonTableParams, csvParms );
    appcme.setMacroJsOverride('csv', csvAllParms, function(macroDetails) {

        // merge specific ones with csvAllParms.
        var parms = appcme.parametersToObj(csvAllParms, macroDetails.params, tablebasecme.DELIMITER, tablebasecme.QUOTE);
        $.extend(parms, {macroName: macroDetails.name, macroBody: (macroDetails.body ? macroDetails.body.trim() : ''), dataTypeToLocate: 'CSV' }); 
        parms = tablebasecme.splitScriptParam(parms);
        //if dataSource chosen is profile, then profileUrl shall be filled for soy to display
        if(parms.profile != ""){
            $.extend(parms, {profileUrl: parms.url, url : ''});
        }
        
        return {
            icon: "/download/resources/org.swift.confluence.table/img/table-32x32.png",
            title: "Advanced Tables Editor - CSV Table",
            showPreview: true,
            dataAttributes: {commontableeditor: "true", datalocationfields: "true"}, // required for all apps built around the common table editors for common event
            navigation: {
                primary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.table/editor-img/icon-nav-csv-48-wht-on-clr.png"),
                        name: "CSV settings",
                        panel: org.swift.confluence.table.csv.editor.csvSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-table-48-wht-on-clr.png"),
                        name: "Table settings",
                        panel: org.swift.confluence.table.editor.tableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-columns-48-wht-on-clr.png"),
                        name: "Column settings",
                        panel: org.swift.confluence.table.editor.columnSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-rows-48-wht-on-clr.png"),
                        name: "Row formatting",
                        panel: org.swift.confluence.table.editor.rowSettingsPanel(parms)
                    }
                ],
                secondary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-guide-48-wht-on-clr.png"),
                        name: "CSV guide",
                        url: "https://apps.appf.re/tbl/doc/p2/userguide/csv"
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-docs-48-wht-on-clr.png"),
                        name: "CSV documentation",
                        url: "https://apps.appf.re/tbl/doc/p2/userguide"
                    }
                ],
            },
            /**
             * Validate form fields. 
             * Input Parameters:
             *      dialog - The jQuery editor dialog 
             *      form - The jQuery form from the dialog 
             * Return Parameters:
             *      errors - This is a property array.  Each array element contains the message and an optinal jQuery element for the error.  
             * Return: 
             *      True if the form validates correctly and can be saved. False if there are any errors. The form will not be allowed to close in that case. 
             */
            validator: function (dialog, form, errors) {
                tablebasecme.validateDataLocationFields(dialog, errors);
                return tablebasecme.validateCommonTableParams(dialog, errors);
            }
        };
    });
    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'scripts/table-editor/jsontable-editor.js' */
// Todo - COPYRIGHT 
/*jshint esversion: 6 */
'use strict';

AJS.bind("init.rte", function(evt) {

    //console.log("appfire: event=" + evt.type + "; macro name=json-table");
    
    (function ($) {
    //json-table Specific params here
    //total param count=46
    const jsontableParms = {
            paths: "",
            fieldPaths: "",
            fieldOrderRegexPatterns: "",
            sortPaths: "",
            stripQualifiers: false,
            capitalize: true,
            output: "html",
            columns: "",
            script: "",
            profile: "",
            url: "",
            user: "",
            password: "",
            timeout: "",
            encoding: "",
            showWiki: false,
            escape: false,
            macros: false,
            augments: "",
            headingAugments: "",
            footingAugments: "",
            autoNumberSort: false,
            footing: 0, 
            heading: 1,
            hideHeader: false,
            border: "",
            width: "",
            disableAntiXss: false,
            table: true
    }
    
    var jsontableAllParms = $.extend({}, tablebasecme.commonTableParams, jsontableParms );
    appcme.setMacroJsOverride('json-table', jsontableAllParms, function(macroDetails) {

        // merge specific ones with jsontableAllParms.
        var parms = appcme.parametersToObj(jsontableAllParms, macroDetails.params, tablebasecme.DELIMITER, tablebasecme.QUOTE);
        $.extend(parms, {macroName: macroDetails.name, macroBody: (macroDetails.body ? macroDetails.body.trim() : ''), dataTypeToLocate: 'JSON'}); //NTBL-79:macroBody needed to indicate if data source is macroBody, if it contains data
        parms = tablebasecme.splitScriptParam(parms);
        //if dataSource chosen is profile, then profileUrl shall be filled for soy to display
        if(parms.profile != ""){
            $.extend(parms, {profileUrl: parms.url, url : ''});
        }
        return {
            icon: "/download/resources/org.swift.confluence.table/img/table-32x32.png",
            title: "Advanced Table Editor - JSON Table",
            showPreview: true,
            dataAttributes: {commontableeditor: "true", datalocationfields: "true"}, // required for all apps built around the common table editors for common event
            navigation: {
                primary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.table/editor-img/icon-nav-json-48-wht-on-clr.png"),
                        name: "JSON settings",
                        panel: org.swift.confluence.table.jsontable.editor.jsontableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-table-48-wht-on-clr.png"),
                        name: "Table settings",
                        panel: org.swift.confluence.table.editor.tableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-columns-48-wht-on-clr.png"),
                        name: "Column settings",
                        panel: org.swift.confluence.table.editor.columnSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-rows-48-wht-on-clr.png"),
                        name: "Row formatting",
                        panel: org.swift.confluence.table.editor.rowSettingsPanel(parms)
                    }
                ],
                secondary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-guide-48-wht-on-clr.png"),
                        name: "JSON Table guide",
                        url: "https://apps.appf.re/tbl/doc/p2/userguide/jsontable"
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-docs-48-wht-on-clr.png"),
                        name: "JSON Table Documentation",
                        url: "https://apps.appf.re/tbl/doc/p2/userguide"
                    }
                ]
            },
            /**
             * Validate form fields. 
             * Input Parameters:
             *      dialog - The jQuery editor dialog 
             *      form - The jQuery form from the dialog 
             * Return Parameters:
             *      errors - This is a property array.  Each array element contains the message and an optinal jQuery element for the error.  
             * Return: 
             *      True if the form validates correctly and can be saved. False if there are any errors. The form will not be allowed to close in that case. 
             */
            validator: function (dialog, form, errors) {
                tablebasecme.validateDataLocationFields(dialog, errors);
                return tablebasecme.validateCommonTableParams(dialog, errors);
            }
        };
    });
    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'scripts/table-editor/attachmenttable-editor.js' */
/*
 * Copyright (c) 2019, 2022 Appfire Technologies, LLC.
 * All rights reserved.
 *
 * This software is licensed under the provisions of the "Appfire EULA"
 * (https://appfire.com/eula/) as well as under the provisions of
 * the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
 * (http://www.atlassian.com/licensing/marketplace/termsofuse).
 *
 * See the LICENSE file for more details.
 */
/*jshint esversion: 6 */
'use strict';

$(document).on('appfireEditorBeforeSerialize appfireEditorBeforePreviewSerialize', "[data-appfire-macro-name='attachment-table']", 
        function(evt, dialog, form, defaultParms, errors) {
        //set data-atalocationfields false, so that the common handlers wont be called for attachment-table macro. 
        $(this).attr("data-datalocationfields", "false");
});


$(document).on('appfireEditorBeforeSave appfireEditorBeforePreview', "[data-appfire-macro-name='attachment-table']", function(evt, macroParms, dialog, form, defaultParms, macroName) {
    
    //console.log("appfire: event=" + evt.type + "; macro name=" + $(evt.target).closest("[data-appfire-macro-name]").data("appfireMacroName"));
    //construct attachmentPage param back from splitted params and remove the non macro params
    var attachmentSource = dialog.find("#attachmentSource").val();
    if (attachmentSource === "attachment"){
        var space = macroParms["attSpace"];
        var page = macroParms["attPage"];
        if(tablebasecme.specialPageValues.hasOwnProperty(page.toLowerCase())) {
            if ("@self" == page.toLowerCase()) {
                delete macroParms["attachmentPage"];
            } else {
                macroParms["attachmentPage"] = page;
            }
        }
        else{
            if(space !== tablebasecme.CURRENT_SPACE){
                macroParms["attachmentPage"] = space + ":" + page
            }
            else{//if current space
                //if current page, then need not save space or page to be backward compatible    
                if(page === tablebasecme.CURRENT_PAGE){
                    delete macroParms["attachmentPage"];
                }
                else{
                   //if current space but different page, then just save 'page' to be backward compatible   
                    macroParms["attachmentPage"] = page; 
                }
            }
        }

        //singlepage selected, hence remove spaceregex and pageregex. Checked behavior in marketplace version
        delete macroParms["spaceRegex"];
        delete macroParms["pageRegex"];
    }
    //To handle XSS injection for textForNone parameter.
    var textForNone = dialog.find("#textForNone").val();
    macroParms["textForNone"] = safeHtml(textForNone);
    
    delete macroParms["attSpace"];
    delete macroParms["attPage"];
    delete macroParms["attachmentSource"];
});

AJS.bind("init.rte", function(evt) {

    //console.log("appfire: event=" + evt.type + "; macro name=attachment-table"); 
    
    (function ($) {
    //attachment-table Specific params here
    //Total param count=33
    const attachmenttableParms = {
            attachmentPage: "",
            spaceRegex: "",
            includePersonalSpaces: false,
            fromAllChildPages: false,
            pageRegex: "",
            pageLabelRegex: "",
            attachmentRegex: "",
            commentRegex: "",
            labelRegex: "",
            labelMatchOption: "any",
            textForNone: "",
            dateFormat: AJS.Meta.get('date.format'),
            limit: 1000,
            columns: "",
    }
    
    var attachmenttableAllParms = $.extend({}, tablebasecme.commonTableParams, attachmenttableParms );
    appcme.setMacroJsOverride('attachment-table', attachmenttableAllParms, function(macroDetails) {

        // merge specific ones with attachmenttableAllParms.
        var parms = appcme.parametersToObj(attachmenttableAllParms, macroDetails.params, tablebasecme.DELIMITER, tablebasecme.QUOTE);
        $.extend(parms, {macroName: macroDetails.name}); 
        var page = parms.attachmentPage;
        var spaceKey;
        var pageTitle;
        if(page){
            //page is any of @self, @page or @parent, then default to current space
            if(tablebasecme.specialPageValues.hasOwnProperty(page.toLowerCase().trim())){
                 //Do not set current space by default
                pageTitle = page;
            }
            else{
              //if page param contains space:page name, then choose space default space
                if(page.indexOf(":") > 0){
                    spaceKey = page.substring(0, page.indexOf(":"));
                    pageTitle = page.substring(page.indexOf(":")+1, page.length);
                }
                else{
                    //if page param contains just page name, then choose space default space
                    spaceKey = tablebasecme.CURRENT_SPACE;
                    pageTitle = page;
                }
            }
        }
        else{
            spaceKey = tablebasecme.CURRENT_SPACE;
            pageTitle = tablebasecme.CURRENT_PAGE;
        }
        
        $.extend(parms, {attSpace: spaceKey, attPage: pageTitle});
        
        return {
            icon: "/download/resources/org.swift.confluence.table/img/table-32x32.png",
            title: "Advanced Tables Editor - Attachment Table",
            showPreview: true,
            dataAttributes: {commontableeditor: "true", datalocationfields: "true"}, // required for all apps built around the common table editors for common event
            navigation: {
                primary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.table/editor-img/icon-nav-attachment-48-wht-on-clr.png"),
                        name: "Attachment settings",
                        panel: org.swift.confluence.table.attachmenttable.editor.attachmentTableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-table-48-wht-on-clr.png"),
                        name: "Table settings",
                        panel: org.swift.confluence.table.editor.tableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-columns-48-wht-on-clr.png"),
                        name: "Column settings",
                        panel: org.swift.confluence.table.editor.columnSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-rows-48-wht-on-clr.png"),
                        name: "Row formatting",
                        panel: org.swift.confluence.table.editor.rowSettingsPanel(parms)
                    }
                ],
                secondary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-guide-48-wht-on-clr.png"),
                        name: "Attachment Table guide",
                        url: "https://apps.appf.re/tbl/doc/p2/userguide/attachmenttable"
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-docs-48-wht-on-clr.png"),
                        name: "Attachment Table Documentation",
                        url: "https://apps.appf.re/tbl/doc/p2/userguide"
                    }
                ]
            },
            /**
             * Validate form fields. 
             * Input Parameters:
             *      dialog - The jQuery editor dialog 
             *      form - The jQuery form from the dialog 
             * Return Parameters:
             *      errors - This is a property array.  Each array element contains the message and an optinal jQuery element for the error.  
             * Return: 
             *      True if the form validates correctly and can be saved. False if there are any errors. The form will not be allowed to close in that case. 
             */ 
            validator: function (dialog, form, errors) {
                tablebasecme.validateDataLocationFields(dialog, errors);
                return tablebasecme.validateCommonTableParams(dialog, errors);
            }
        };
    });
    }(AJS.$));
});
var safeHtml = function(unsafeHtml) {
    if (unsafeHtml) {
        return unsafeHtml
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;') 
            .replace(/\//g, '&#x2F;')
            .replace(/\(/g, '&lpar;')
            .replace(/\)/g, '&rpar;');
    }
    return '';
};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'soy/table-editor/csv-settings-panel.soy' */
// This file was automatically generated from csv-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.csv.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.csv == 'undefined') { org.swift.confluence.table.csv = {}; }
if (typeof org.swift.confluence.table.csv.editor == 'undefined') { org.swift.confluence.table.csv.editor = {}; }


org.swift.confluence.table.csv.editor.csvSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#data-source">Data source</a></li><li class="menu-item"><a href="#data-format">Data format</a></li><li class="menu-item"><a href="#data-settings">Data settings</a></li></ul><div class="tabs-pane active-pane" id="data-source"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.dataLocationFields(opt_data) + org.swift.confluence.table.editor.textElement({name: 'encoding', value: opt_data.encoding, label: 'File encoding', topLabel: 'true', helpContent: 'Specify encoding if different than Confluence default. For example, Windows-1252 or UTF-8. See \x3ca href\x3d\x22https://en.wikipedia.org/wiki/Character_encoding\x22 target\x3d\x22_blank\x22\x3eCharacter encoding\x3c/a\x3e for more information. '}) + org.swift.confluence.table.editor.macroBodyFilledMessage(opt_data) + '</fieldset></div></div><!-- tabs-pane data-source close--><div class="tabs-pane" id="data-format"><div class="scrollable-tab-content"><fieldset><h3>Parsing</h3>' + org.swift.confluence.table.editor.textElement({name: 'delimiter', value: opt_data.delimiter, label: 'Column delimiter', topLabel: 'true', helpContent: 'The character that delimits the columns in your data. Typically this is a comma. '}) + org.swift.confluence.table.editor.customToggleElement({name: 'quote', value1: 'single', value2: 'double', value: opt_data.quote, label: 'Quote character', helpContent: 'Character used to represent quoted data. Quoted data may contain delimiters or new lines.'}) + '</fieldset><fieldset><h3>Augmentation</h3>' + org.swift.confluence.table.editor.textElement({name: 'augments', value: opt_data.augments, label: 'Augments to data row values', topLabel: 'true', helpContent: 'Comma separated list of augments to the data row values, one for each column. Double quote values containing a comma. See the \x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/augments\x22 target\x3d\x22_blank\x22\x3edocumentation\x3c/a\x3e for additional information.'}) + org.swift.confluence.table.editor.textElement({name: 'headingAugments', value: opt_data.headingAugments, label: 'Augments to heading row values', topLabel: 'true', helpContent: 'Comma separated list of augments to heading row values, one for each column.'}) + org.swift.confluence.table.editor.textElement({name: 'footingAugments', value: opt_data.footingAugments, label: 'Augments to footer row values', topLabel: 'true', helpContent: 'Comma separated list of augments to footing row values, one for each column.'}) + '</fieldset></div></div><!-- tabs-pane data-format close--><div class="tabs-pane" id="data-settings"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.textElement({name: 'columns', value: opt_data.columns, label: 'Columns to display', topLabel: 'true', helpContent: 'Comma separated list of column names or numbers in any order. Default is to show all columns.'}) + org.swift.confluence.table.editor.customToggleElement({name: 'output', value1: 'html', value2: 'wiki', value: opt_data.output, label: 'Output format'}) + org.swift.confluence.table.editor.toggleElement({name: 'ignoreTrailingBlankRows', value: opt_data.ignoreTrailingBlankRows, label: 'Ignore trailing blank rows'}) + org.swift.confluence.table.editor.toggleElement({name: 'showWiki', value: opt_data.showWiki, label: 'Show non-formatted version of generated wiki'}) + org.swift.confluence.table.editor.toggleElement({name: 'escape', value: opt_data.escape, label: 'Escape special characters in wiki'}) + org.swift.confluence.table.editor.toggleElement({name: 'macros', value: opt_data.macros, label: 'Render wiki markup macros in body'}) + org.swift.confluence.table.editor.toggleElement({name: 'disableAntiXss', value: opt_data.disableAntiXss, label: 'Stop encoding of html characters in table content', helpContent: 'Requires Administrator to authorize use. Not available for Cloud.'}) + '</fieldset></div></div><!-- tabs-pane data-settings close--></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.csv.editor.csvSettingsPanel.soyTemplateName = 'org.swift.confluence.table.csv.editor.csvSettingsPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'soy/table-editor/jsontable-settings-panel.soy' */
// This file was automatically generated from jsontable-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.jsontable.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.jsontable == 'undefined') { org.swift.confluence.table.jsontable = {}; }
if (typeof org.swift.confluence.table.jsontable.editor == 'undefined') { org.swift.confluence.table.jsontable.editor = {}; }


org.swift.confluence.table.jsontable.editor.jsontableSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#data-source">Data source</a></li><li class="menu-item"><a href="#data-format">Data format</a></li><li class="menu-item"><a href="#data-settings">Data settings</a></li></ul><div class="tabs-pane active-pane" id="data-source"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.dataLocationFields(opt_data) + org.swift.confluence.table.editor.textElement({name: 'encoding', value: opt_data.encoding, label: 'File encoding', topLabel: 'true', helpContent: 'Specify encoding if different than Confluence default. For example, Windows-1252 or UTF-8. See \x3ca href\x3d\x22https://en.wikipedia.org/wiki/Character_encoding\x22 target\x3d\x22_blank\x22\x3eCharacter encoding\x3c/a\x3e for more information. '}) + org.swift.confluence.table.editor.macroBodyFilledMessage(opt_data) + '</fieldset></div></div><!-- tabs-pane data-source close--><div class="tabs-pane" id="data-format"><div class="scrollable-tab-content"><fieldset><h3>Parsing</h3>' + org.swift.confluence.table.editor.textElement({name: 'paths', value: opt_data.paths, label: 'Paths to fields', topLabel: 'true', helpContent: 'Normally, specify a single path to generate a single table. Simple form is a dot separated list of field names to reach the specific field within the JSON string. See the \x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/jsontable\x22 target\x3d\x22_blank\x22\x3edocumentation\x3c/a\x3e for more advanced support.'}) + org.swift.confluence.table.editor.textElement({name: 'fieldPaths', value: opt_data.fieldPaths, label: 'Paths to fields to be included', topLabel: 'true', helpContent: 'Comma separated list of paths to fields to be included in the output. Paths are relative to the JSON field specified in the paths parameter.  Defaults to all fields. '}) + org.swift.confluence.table.editor.textElement({name: 'fieldOrderRegexPatterns', value: opt_data.fieldOrderRegexPatterns, label: 'Regex patterns for ordering fields', topLabel: 'true', helpContent: 'Only used when defaulting to all fields and field order is important. Comma separated list of regular expression patterns. A field found by an earlier pattern is ordered before fields not found or found by a later pattern.'}) + org.swift.confluence.table.editor.textElement({name: 'sortPaths', value: opt_data.sortPaths, label: 'Paths used to determine sort order', topLabel: 'true', helpContent: 'Comma separated list of paths. Paths are relative to the JSON field specified in the paths parameter. If specified, JSON array elements will be sorted based on the comparison of field values represented by the paths.'}) + '</fieldset><fieldset><h3>Augmentation</h3>' + org.swift.confluence.table.editor.textElement({name: 'augments', value: opt_data.augments, label: 'Augments to data row values', topLabel: 'true', helpContent: 'Comma separated list of augments to the data row values, one for each column. Double quote values containing a comma. See the \x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/augments\x22 target\x3d\x22_blank\x22\x3edocumentation\x3c/a\x3e.'}) + org.swift.confluence.table.editor.textElement({name: 'headingAugments', value: opt_data.headingAugments, label: 'Augments to heading row values', topLabel: 'true', helpContent: 'Comma separated list of augments to heading row values, one for each column.'}) + org.swift.confluence.table.editor.textElement({name: 'footingAugments', value: opt_data.footingAugments, label: 'Augments to footer row values', topLabel: 'true', helpContent: 'Comma separated list of augments to footing row values, one for each column.'}) + '</fieldset></div></div><!-- tabs-pane data-format close--><div class="tabs-pane" id="data-settings"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.textElement({name: 'columns', value: opt_data.columns, label: 'Columns to display', topLabel: 'true', helpContent: 'Comma separated list of column names or numbers in any order. Default is to show all columns.'}) + org.swift.confluence.table.editor.customToggleElement({name: 'output', value1: 'html', value2: 'wiki', value: opt_data.output, label: 'Output format'}) + org.swift.confluence.table.editor.toggleElement({name: 'stripQualifiers', value: opt_data.stripQualifiers, label: 'Strip leading qualifiers from generated headings'}) + org.swift.confluence.table.editor.toggleElement({name: 'table', value: opt_data.table, label: 'Show result as table'}) + org.swift.confluence.table.editor.toggleElement({name: 'capitalize', value: opt_data.capitalize, label: 'Capitalize first character of generated headings'}) + org.swift.confluence.table.editor.toggleElement({name: 'showWiki', value: opt_data.showWiki, label: 'Show non-formatted version of generated wiki'}) + org.swift.confluence.table.editor.toggleElement({name: 'escape', value: opt_data.escape, label: 'Escape special characters in wiki'}) + org.swift.confluence.table.editor.toggleElement({name: 'macros', value: opt_data.macros, label: 'Render wiki markup macros in body'}) + org.swift.confluence.table.editor.toggleElement({name: 'disableAntiXss', value: opt_data.disableAntiXss, label: 'Stop encoding of html characters in table content', helpContent: 'Enable this parameter for tables that use html output and have html content, such as links. HTML content will only display correctly if this parameter is enabled.'}) + '</fieldset></div></div><!-- tabs-pane data-settings close--></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.jsontable.editor.jsontableSettingsPanel.soyTemplateName = 'org.swift.confluence.table.jsontable.editor.jsontableSettingsPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'soy/table-editor/attachmenttable-settings-panel.soy' */
// This file was automatically generated from attachmenttable-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.attachmenttable.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.attachmenttable == 'undefined') { org.swift.confluence.table.attachmenttable = {}; }
if (typeof org.swift.confluence.table.attachmenttable.editor == 'undefined') { org.swift.confluence.table.attachmenttable.editor = {}; }


org.swift.confluence.table.attachmenttable.editor.attachmentTableSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#page-filtering">Page filtering</a></li><li class="menu-item"><a href="#attachment-filtering">Attachment filtering</a></li><li class="menu-item"><a href="#data-settings">Data settings</a></li></ul><div class="tabs-pane active-pane" id="page-filtering"><div class="scrollable-tab-content"><fieldset><div class="aui-group"><div class="field-group"><label for="attachmentSource">Source</label><select class="select appfire-table-datalocation appfire-editor-select" id="attachmentSource"  name="attachmentSource" data-macroname="' + soy.$$escapeHtml(opt_data.macroName) + '"><option value="attachment" ' + ((opt_data.attPage && opt_data.attSpace) ? ' selected ' : '') + '>Single page</option><option value="regex" ' + ((opt_data.spaceRegex || opt_data.pageRegex) ? ' selected ' : '') + '>Regular expression</option></select></div></div><div class="aui-group attachment-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'attSpace', inputClass: 'datalocation-space long-field', value: opt_data.attSpace, label: 'Space', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'attPage', inputClass: 'datalocation-page long-field', value: opt_data.attPage, label: 'Page', topLabel: 'true', helpContent: 'The page to list attachments. Use the special values of @self, @home, or @parent if you plan to move or copy the page. Preview does not work for @parent page value if page is in draft state.'}) + '</div><!--regex fields --><div class="aui-group regex-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'spaceRegex', value: opt_data.spaceRegex, label: 'Filter by space key or space name', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/regularexpressions\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match space keys or names. Use @self for current space and @all for all spaces.'}) + org.swift.confluence.table.editor.toggleElement({name: 'includePersonalSpaces', value: opt_data.includePersonalSpaces, label: 'Include personal spaces'}) + org.swift.confluence.table.editor.textElement({name: 'pageRegex', value: opt_data.pageRegex, label: 'Filter by page name', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/regularexpressions\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match page names. Used in combination with the other regex parameters.'}) + org.swift.confluence.table.editor.textElement({name: 'pageLabelRegex', value: opt_data.pageLabelRegex, label: 'Filter by page label', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/regularexpressions\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match page labels. Used in combination with the other regex parameters.'}) + '</div><!-- regex fields --></fieldset></div></div><!-- tabs-pane data-source close--><div class="tabs-pane" id="attachment-filtering"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.textElement({name: 'attachmentRegex', value: opt_data.attachmentRegex, label: 'Attachment name regex', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/regularexpressions\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match attachment names. Used in combination with the other regex parameters.'}) + org.swift.confluence.table.editor.textElement({name: 'commentRegex', value: opt_data.commentRegex, label: 'Attachment comment regex', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/regularexpressions\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match attachment comments. Used in combination with the other regex parameters.'}) + org.swift.confluence.table.editor.customToggleElement({name: 'labelMatchOption', value1: 'any', value2: 'all', value: opt_data.labelMatchOption, label: 'Label match option'}) + org.swift.confluence.table.editor.textElement({name: 'labelRegex', value: opt_data.labelRegex, label: 'Attachment label regex', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/regularexpressions\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match attachment labels. Used in combination with the other regex parameters.'}) + '</fieldset></div></div><!-- tabs-pane data-source close--><div class="tabs-pane" id="data-settings"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.textElement({name: 'columns', value: opt_data.columns, label: 'Columns to display', topLabel: 'true', helpContent: 'Comma separated list of column names or numbers in any order. When blank, a default set of columns is shown. @all will show all available columns. Refer to \x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/attachmenttable/columnsavailablefordisplay\x22 target\x3d\x22_blank\x22\x3ethis article\x3c/a\x3e for more information.'}) + org.swift.confluence.table.editor.textElement({name: 'textForNone', value: opt_data.textForNone, label: 'Text to display when no attachments match', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'dateFormat', value: opt_data.dateFormat, label: 'Date format', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'limit', type: 'number', value: opt_data.limit, label: 'Limit number of attachments to retrieve', topLabel: 'true'}) + org.swift.confluence.table.editor.toggleElement({name: 'fromAllChildPages', value: opt_data.fromAllChildPages, label: 'Retrieve attachments from child pages'}) + '</fieldset></div></div><!-- tabs-pane data-settings close--></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.attachmenttable.editor.attachmentTableSettingsPanel.soyTemplateName = 'org.swift.confluence.table.attachmenttable.editor.attachmentTableSettingsPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'fr.spectrumgroupe.confluence.plugins.formatting.macros:expander-box-editor-resources', location = 'js/sfa/expander/expander.box.editor.js' */
AJS.$(document).ready(function(){AJS.$(document).ajaxComplete(function(d,e,b){var c=b.url;if(c.indexOf("horizontal-nav-group")>=0||c.indexOf("vertical-nav-group")>=0||c.indexOf("tabs-group")>=0){var a='<label for="macro-param-color">'+"Color"+"</label>";a+='<div id="colorPicker2">';a+='<input type="text" readonly="readonly" class="text macro-param-input colorInput" id="macro-param-color" />';a+='<a class="color"><div class="colorInner"></div></a>';a+='<div class="track"></div>';a+='<ul class="dropdown"><li></li></ul>';a+="</div>";setTimeout(function(){var f=$("#macro-param-color").val();AJS.$("#macro-param-div-color").html(a);if(""!=f){AJS.$("#macro-param-color").val(f);AJS.$("body").find(".colorInner").css({background:f})}AJS.$("#colorPicker2").tinycolorpicker()},50)}});AJS.$(document).ajaxComplete(function(d,e,b){var c=b.url;if(c.indexOf("/macro/preview")>=0||c.indexOf("browse-macros-details.action?id=sp-expander-box")>=0){if(AJS.$("#macro-param-paramboxColor").length){AJS.$("#macro-param-paramboxColor").addClass("color");AJS.$("#macro-param-paramboxFontColor").addClass("color");jscolor.install()}}if(c.indexOf("browse-macros-details.action?id=sp-macro-button")>=0){AJS.$("#macro-param-backgroundColor").addClass("color");AJS.$("#macro-param-fontColor").addClass("color");AJS.$("#macro-param-icon").fontIconPicker();jscolor.install()}if(c.indexOf("browse-macros-details.action?id=percentage-progress-bar")>=0){AJS.$("#macro-param-backgroundColor").addClass("color");$("#macro-param-backgroundColor").val("#0052CC");jscolor.install();jscolor.presets.myPreset={backgroundColor:"#0052CC"}}if(c.indexOf("browse-macros-details.action?id=sp-macro-panels")>=0){if(AJS.$("#macro-param-backgroundColor").length){AJS.$("#macro-param-backgroundColor").addClass("color");AJS.$("#macro-param-fontColor").addClass("color");AJS.$("#macro-param-icon").fontIconPicker();jscolor.install();var a=AJS.$("#macro-param-type").val();if(a!="customized"){AJS.$("#macro-param-div-icon").hide();AJS.$("#macro-param-div-fontColor").hide();AJS.$("#macro-param-div-backgroundColor").hide();AJS.$("#macro-param-div-fontSize").hide()}AJS.$("#macro-param-type").change(function(g){var f=AJS.$("#macro-param-type").val();if(f=="customized"){AJS.$("#macro-param-div-icon").show();AJS.$("#macro-param-div-fontColor").show();AJS.$("#macro-param-div-backgroundColor").show();AJS.$("#macro-param-div-fontSize").show()}else{AJS.$("#macro-param-div-icon").hide();AJS.$("#macro-param-div-fontColor").hide();AJS.$("#macro-param-div-backgroundColor").hide();AJS.$("#macro-param-div-fontSize").hide()}})}}if(c.indexOf("browse-macros-details.action?id=tab-pane")>=0){AJS.$("#macro-param-icon").fontIconPicker()}if(c.indexOf("browse-macros-details.action?id=horizontal-nav-item")>=0){AJS.$("#macro-param-icon").fontIconPicker()}if(c.indexOf("browse-macros-details.action?id=vertical-nav-item")>=0){AJS.$("#macro-param-icon").fontIconPicker()}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_react', location = 'react.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[23],{385:function(e,t,r){"use strict";r.r(t);var n=r(68),i=r.n(n),o=r(11);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object(o.a)("react",()=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({default:i.a},n))}},[[385,0,3,5,2]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-emoticons-plugin:confluence.emoticon.editor-plugin', location = 'confluence.emoticon.editor-plugin.js' */
!function(e){function n(n){for(var t,r,i=n[0],u=n[1],a=0,l=[];a<i.length;a++)r=i[a],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&l.push(o[r][0]),o[r]=0;for(t in u)Object.prototype.hasOwnProperty.call(u,t)&&(e[t]=u[t]);for(c&&c(n);l.length;)l.shift()()}var t={},o={"confluence.emoticon.editor-plugin":0};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.e=function(e){var n=[];return 0===o[e]?Promise.resolve():o[e]?o[e][2]:(n.push(new Promise((function(n,t){o[e]=[n,t]})),new Promise((function(n,t){WRM.require("wrc!com.atlassian.confluence.plugins.confluence-emoticons-plugin:"+e).then(n,t)}))),o[e][2]=Promise.all(n))},r.m=e,r.c=t,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)r.d(t,o,function(n){return e[n]}.bind(null,o));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r.oe=function(e){throw console.error(e),e},"undefined"!=typeof AJS&&(r.p=AJS.contextPath()+"/s/dac2fb29-1dde-4d98-99ff-6fb387def9a7/_/download/resources/com.atlassian.confluence.plugins.confluence-emoticons-plugin:assets-dac2fb29-1dde-4d98-99ff-6fb387def9a7/");var i=window.atlassianWebpackJsonpeca76e5ef4d162f55baedb6b81d3ee1f=window.atlassianWebpackJsonpeca76e5ef4d162f55baedb6b81d3ee1f||[],u=i.push.bind(i);i.push=n,i=i.slice();for(var a=0;a<i.length;a++)n(i[a]);var c=u;r(r.s=5)}([function(e,n,t){!function(e,n,o){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=r(n),u=r(o);const a=function(){try{return t(8)}catch(e){return null}}();function c(e,...t){let o=0;const r={};t=t.map(e=>{if(n.isValidElement(e)){const n=`!PLACEHOLDER_${++o}!`;return r[n]=e,n}return e});const a=u.default(e,...t).split(/(!PLACEHOLDER_\d+!)/g);if(1===a.length)return a.join("");const c=a.map((e,t)=>i.default.createElement(n.Fragment,{key:t},t%2?r[e]:e));return i.default.createElement(n.Fragment,null,c)}const l={getText:(...e)=>{if(!a)return console.warn('Call to "getText" function was not replaced with either raw translation or call to "format" function. Have you included the "jsI18n" transformation in Web Resource Manager?'),c(...e);let n;try{WRM.I18n.format=c,n=a.getText.apply(null,e)}finally{WRM.I18n.format=u.default}return n}};e.I18n=l,e.format=c,Object.defineProperty(e,"__esModule",{value:!0})}(n,t(4),t(7))},function(e,n){e.exports=require("tinymce")},function(e,n){e.exports=require("confluence/api/event")},function(e,n){e.exports=require("confluence-editor/loader/tinymce-bootstrap")},function(e,n){e.exports=require("react")},function(e,n,t){e.exports=t(9)},function(e,n,t){e.exports=void 0},function(e,n){e.exports=WRM.format},function(e,n){if(void 0===WRM.I18n){var t=new Error("Cannot find module 'WRM.I18n'");throw t.code="MODULE_NOT_FOUND",t}e.exports=WRM.I18n},function(e,n,t){"use strict";t.r(n);t(6);var o=t(2),r=t.n(o),i=t(0),u=t(1),a=t.n(u),c=t(3),l=t.n(c);a.a.PluginManager.add("confEmoticon",(function(e){var n=!1;return e.ui.registry.addButton("confluence-insert-emoticon",{text:"",tooltip:"\u63d2\u5165\u8868\u60c5",icon:"aui-icon aui-icon-small aui-iconfont-emoji",locationGroup:"rte-toolbar-group-table",onAction:function(){n||(Promise.all([t.e("vendors~emoticon-popup-manager"),t.e("emoticon-autoformat-manager~emoticon-popup-manager"),t.e("emoticon-popup-manager")]).then(t.bind(null,96)).then((function(e){(0,e.init)()})),n=!0)}}),{getMetadata:function(){return{name:"Confluence \u8868\u60c5\u63d2\u4ef6",url:"https://example.com/docs/customplugin"}}}})),l.a.addTinyMcePluginInit((function(e){e.plugins+=",confEmoticon"})),r.a.bind("rte-ready",(function(){Promise.all([t.e("emoticon-autoformat-manager~emoticon-popup-manager"),t.e("emoticon-autoformat-manager")]).then(t.bind(null,91)).then((function(e){(0,e.init)()}))}))}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:include_macro', location = 'com/atlassian/confluence/plugins/macros/advanced/js/include-macro.js' */
AJS.bind("init.rte",function(){var c=AJS.Meta.get("context-path"),d=AJS.Meta.get("content-id");AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("goto-page",function(a,b){a=AJS.$(b).attr("data-macro-default-parameter");a=c+"/plugins/servlet/confluence/include-page-macro/goto?location\x3d"+encodeURIComponent(a)+"\x26contentId\x3d"+d;(b=window.open(a,AJS.$.browser&&AJS.$.browser.msie?"_blank":"confluence-goto-link-include-macro-"+b.id))&&b.focus()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.multimedia:macro-browser-smart-fields', location = 'javascript/macro-fields.js' */
(function(a){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("multimedia","swf avi mov mp4 mpeg mpg wmv wma mp3 ram rm".split(" "))})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-portfolio-server-macro:jpos-editor', location = 'js/jpos-editor.js' */
define("jpos-editor",["ajs","aui/dialog2","confluence/templates","confluence/macro-js-overrides"],function(f,q,k,r){return{_validateUrl:function(a){return a.match(new RegExp(/^https?:\/\/.+\/secure\/PortfolioRoadmapConfluence\.jspa\?r=[a-zA-Z0-9]{0,30}$/))},_validateHeight:function(a){return 0<a.length&&300<=parseInt(a,10)},_renderPreview:function(){var a=this,c=a.previewContainer.offsetHeight,e=f.contextPath()+"/rest/tinymce/1/macro/preview";c={contentId:f.Meta.get("page-id"),macro:{name:a.macro.name,
params:{url:a.urlInput.value,planHeight:c}}};a._disablePreviewBtn.call(a,"Loading...");a._clearPreview.call(a);f.$.ajax({url:e,type:"POST",contentType:"application/json",data:JSON.stringify(c)}).done(function(b){a.previewContainer.innerHTML=k.JPOS.jposMacroIframe({height:a.heightInput.value});var h=document.querySelector(".jpos__iframe"),g=h.contentWindow.document;h&&(a.iframeLoadTimeout=setTimeout(a._iframeLoadTimeout.bind(a),2E4),h.addEventListener("load",function(){clearTimeout(a.iframeLoadTimeout);
a._enablePreviewBtn.call(a);g.querySelector("#main").setAttribute("style","padding: 0px; overflow: hidden");g.querySelector("body").style.overflow="hidden"}));b=b.replace("window.onload","var preventPreviewOnloadFnTrigger");b=b.replace("2px solid #efefef","none");g.open();g.write(b);g.close()})},_iframeLoadTimeout:function(){this.previewContainer.innerHTML=k.JPOS.jposIframeTimeout();this._enablePreviewBtn.call(this)},_clearPreview:function(){this.previewContainer.innerHTML="";clearTimeout(this.iframeLoadTimeout)},
_enablePreviewBtn:function(){this.previewBtn.innerHTML="Preview";this.previewBtn.removeAttribute("disabled")},_disablePreviewBtn:function(a){this.previewBtn.innerHTML=f.I18n.getText(a);this.previewBtn.setAttribute("disabled",!0)},_addListeners:function(){function a(d){b.heightInput.value=d.target.dataset.value;l.style.display="none";b._validateUrl(b.urlInput.value)&&b.insertBtn.removeAttribute("disabled")}function c(d,t){var n;return function(){var u=this,v=arguments;clearTimeout(n);
n=setTimeout(function(){d.apply(u,v);t})}}function e(){b.urlInput.value=b.urlInput.value.replace(/(%20|\s)/g,"")}for(var b=this,h=document.querySelectorAll(".jpos__size-button"),g=document.querySelector(".jpos__close-dialog"),p=document.querySelector(".jpos__field-error--url"),l=document.querySelector(".jpos__field-error--height"),m=0;m<h.length;m++)h[m].addEventListener("click",a);b.previewBtn.addEventListener("click",function(){e();b._renderPreview()});g.addEventListener("click",function(){b.dialog.hide()});
b.insertBtn.addEventListener("click",function(){e();tinymce.confluence.macrobrowser.macroBrowserComplete({name:b.macro.name,params:{url:b.urlInput.value,planHeight:b.heightInput.value}});b.dialog.hide()});b.urlInput.addEventListener("keydown",function(d){" "===d.key&&d.preventDefault()});b.urlInput.addEventListener("input",c(function(d){e();b._clearPreview();if(!b._validateUrl(this.value))return p.style.display="block",b._disablePreviewBtn.call(b,"Preview"),b.insertBtn.setAttribute("disabled",!0),
!1;p.style.display="none";b._enablePreviewBtn.call(b);b._validateHeight(b.heightInput.value)&&b.insertBtn.removeAttribute("disabled")},500));b.heightInput.addEventListener("input",c(function(d){if(!b._validateHeight(d.target.value))return l.style.display="block",b.insertBtn.setAttribute("disabled",!0),!1;l.style.display="none";b._validateUrl(b.urlInput.value)&&b.insertBtn.removeAttribute("disabled")},500))},init:function(){var a=this;r.put("portfolio-for-jira-plan",{opener:function(c){var e=document.createElement("div");
e.innerHTML=k.JPOS.jposMacroDialog();document.body.appendChild(e.firstChild);a.macro=c;a.dialog=q(".jpos__macro-dialog");a.dialog.show();a.urlInput=document.querySelector(".jpos__url-input");a.heightInput=document.querySelector(".jpos__height-input");a.insertBtn=document.querySelector(".jpos__insert-macro");a.previewBtn=document.querySelector(".jpos__preview-btn");a.previewContainer=document.querySelector(".jpos__preview-container");a._addListeners();c.params?(a.urlInput.value=c.params.url,a.heightInput.value=
c.params.planHeight||"700",a.previewBtn.focus()):(a.heightInput.value="700",a._disablePreviewBtn.call(a,"Preview"),a.insertBtn.setAttribute("disabled",!0),a.urlInput.focus())}})}}});require("confluence/module-exporter").safeRequire("jpos-editor",function(f){require("ajs").toInit(function(){f.init()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-portfolio-server-macro:jpos-editor', location = 'templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.JPOS.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.JPOS == 'undefined') { Confluence.Templates.JPOS = {}; }


Confluence.Templates.JPOS.jposMacroDialog = function(opt_data, opt_ignored) {
  return '<section class="jpos__macro-dialog aui-dialog2 aui-dialog2-xlarge aui-layer" role="dialog" aria-hidden="true" data-aui-remove-on-hide="true"><header class="jpos__macro-dialog-header aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('\u63d2\u5165\u9002\u7528\u4e8e Jira \u7684 Advanced Roadmaps \u8ba1\u5212') + '</h2></header><div class="jpos__macro-dialog-content aui-dialog2-content"><form action="" onsubmit="return false" class="aui jpos__form">' + soy.$$escapeHtml('\u6b64\u5b8f\u5f53\u524d\u652f\u6301\u9002\u7528\u4e8e Jira \u7684 Advanced Roadmaps \u8ba1\u5212\u7684\u5171\u4eab\u3002') + '<div class="jpos__form-fields"><div class="jpos__field-group jpos__field-group--url"><label for="url" class="jpos__field-label">' + soy.$$escapeHtml('URL') + '</label><div class="jpos__field-group jpos__field-group--flex"><input id="url" type="text" class="jpos__url-input text" /><button tabindex="0" class="jpos__preview-btn aui-button aui-button-primary">' + soy.$$escapeHtml('Preview') + '</button></div><div class="jpos__field-label jpos__field-label--inline">' + soy.$$escapeHtml('\u7c98\u8d34\u4ece\u9002\u7528\u4e8e Jira \u7684 Advanced Roadmaps \u4e2d\u7684 Confluence \u5171\u4eab\u9009\u9879\u6240\u590d\u5236\u7684\u94fe\u63a5') + '<a class="jpos__learn-more" href="https://confluence.atlassian.com/display/JIRAPortfolioServer/Sharing+roadmaps" target="_blank" rel="noopener noreferrer">' + soy.$$escapeHtml('\u4e86\u89e3\u66f4\u591a') + '</a></div><div class="jpos__field-error jpos__field-error--url"><span class="aui-icon aui-icon-small aui-iconfont-error"></span>' + soy.$$escapeHtml('\u60a8\u8f93\u5165\u7684 URL \u4f3c\u4e4e\u65e0\u6548\u3002\u8bf7\u68c0\u67e5\u9002\u7528\u4e8e Jira \u7684 Advanced Roadmaps \u4e2d\u7684 Confluence \u5171\u4eab\u94fe\u63a5\uff0c\u7136\u540e\u91cd\u8bd5') + '</div></div><div class="jpos__field-group jpos__field-group--height"><label for="height" class="jpos__field-label">' + soy.$$escapeHtml('\u9ad8\u5ea6') + '</label><div class="jpos__field-group jpos__field-group--flex"><div class="aui-buttons"><button tabindex="0" class="jpos__size-button aui-button" data-value="700" title="small"></button><button tabindex="0" class="jpos__size-button jpos__size-button--medium aui-button" data-value="900" title="medium"></button><button tabindex="0" class="jpos__size-button jpos__size-button--large aui-button" data-value="1100" title="large"></button></div><input id="height" type="number" step="10" min="300" class="jpos__height-input text" /><span class="jpos__height-unit">px</span></div><div class="jpos__field-label">' + soy.$$escapeHtml('\u9009\u62e9\u5728\u9875\u9762\u4e0a\u663e\u793a\u7684\u9ad8\u5ea6') + '</div><div class="jpos__field-error jpos__field-error--height">' + soy.$$escapeHtml('\u9ad8\u5ea6\u5fc5\u987b\u81f3\u5c11\u4e3a 300 \u50cf\u7d20') + '</div></div></div></form><div tabindex="-1" class="jpos__preview-container"></div></div><footer class="jpos__macro-dialog-footer aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><form onsubmit="return false" class="aui"><button tabindex="0" class="jpos__close-dialog aui-button aui-button-link">' + soy.$$escapeHtml('\u53d6\u6d88') + '</button><button tabindex="0" class="jpos__insert-macro aui-button aui-button-primary">' + soy.$$escapeHtml('Insert') + '</button></form></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.JPOS.jposMacroDialog.soyTemplateName = 'Confluence.Templates.JPOS.jposMacroDialog';
}


Confluence.Templates.JPOS.jposMacroIframe = function(opt_data, opt_ignored) {
  return '<div class="jpos__iframe-container"><iframe class="jpos__iframe" frameborder="none" src="' + soy.$$escapeHtml(opt_data.url) + '" width="100%" height="' + soy.$$escapeHtml(opt_data.height) + '"></iframe></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JPOS.jposMacroIframe.soyTemplateName = 'Confluence.Templates.JPOS.jposMacroIframe';
}


Confluence.Templates.JPOS.jposIframeTimeout = function(opt_data, opt_ignored) {
  return '<div class="jpos__iframe-load-timeout"><span class="aui-icon aui-icon-small aui-iconfont-error"></span>' + soy.$$escapeHtml('\u65e0\u6cd5\u5448\u73b0\u60a8\u7684\u9884\u89c8\u3002\u8bf7\u68c0\u67e5 URL \u5e76\u91cd\u8bd5') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JPOS.jposIframeTimeout.soyTemplateName = 'Confluence.Templates.JPOS.jposIframeTimeout';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:space-page-picker-shim', location = 'js/space-page-picker-shim.js' */
define("confluence-inline-tasks/space-page-picker-shim",["confluence-ui-components/js/space-page-picker"],function(e){function f(a){var c={page:[],space:[]};if(!a)return c;a.split(",").forEach(function(b){b=b.split(":");c[b[0]].push(b[1])});return c}return{build:function(a){return e.build(a)},setValue:function(a,c){return e.setValue(a,c)},splitStringToMap:f,combineMapToString:function(a){var c=a.space;a=a.page;var b=[];c&&(b=b.concat(_.map(c.split(","),function(d){return"space:"+d})));a&&(b=b.concat(_.map(a.split(","),
function(d){return"page:"+d})));return b.join(",")},getValueAsMap:function(a){return f(a.val())}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-macro-browser', location = 'js/macro-browser-overrides.js' */
define("confluence-inline-tasks/macro-browser-overrides",["jquery","ajs","confluence/templates","confluence-macro-browser/macro-browser","confluence-inline-tasks/space-page-picker-shim"],function(e,h,k,f,d){return{fields:{string:{spaceAndPage:function(a){var b=a.multiple?"autocomplete-multi-space-and-page":"autocomplete-space-and-page",g=e(k.MacroBrowser.macroParameter()),c=g.find("input[type\x3d'text']");c.addClass(b).attr("data-none-message","\u672a\u627e\u5230");
a.required&&c.keyup(f.processRequiredParameters);c.auiSelect2(d.build({multiple:a.multiple,orgElement:c,inputSpaceId:"legacy-macro-param-spaces",inputSpaceCatId:"legacy-macro-param-space-cats",inputPageId:"legacy-macro-param-pages"}));return f.Field(g,c,{setValue:function(l){d.setValue(l,c)}})}}},beforeParamsSet:function(a){var b=d.combineMapToString({page:a.pages,space:a.spaces});b&&(a.spaceAndPage=b);delete a.pages;delete a.spaces;return a},beforeParamsRetrieved:function(a){var b=d.splitStringToMap(a.spaceAndPage);
b.page.length&&(a.pages=b.page.join(","));b.space.length&&(a.spaces=b.space.join(","));delete a.spaceAndPage;return a}}});require("confluence/module-exporter").safeRequire("confluence-inline-tasks/macro-browser-overrides",function(e){require("confluence-macro-browser/macro-browser").setMacroJsOverride("tasks-report-macro",e)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:confluence-inlineTasks-utils', location = '/js/util.js' */
define("confluence-inline-tasks/util",["jquery"],function(a){return{NODE_TYPE:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},KEY:{BACKSPACE:8,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,INS:45,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91},addContentEditableIfApplicable:function(b){a(b).attr({contenteditable:!1,
class:"non-editable",onselectstart:"return false;"})}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-inline-tasks/util","Confluence.InlineTasks.Util");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:datepicker1', location = '/js/date-picker1.js' */
define("confluence-inline-tasks/date-picker1",["jquery","ajs","confluence-editor/utils/tinymce-node-utils"],function(d,k){function h(v,c){var n;var b={};var x=C++;var a=d(v);a.attr("data-aui-dp-uuid",x);c=d.extend(void 0,h.prototype.defaultOptions,c);b.getField=function(){return a};b.getOptions=function(){return c};var F=function(){var f,r,p;b.hide=function(){l.hide()};b.show=function(){l.show()};b.setDate=function(g){"undefined"!==typeof f&&f.datepicker("setDate",g)};b.getDate=function(){if("undefined"!==
typeof f)return f.datepicker("getDate")};var D=function(g){p.off();if(c.hint){var e=d("\x3cdiv/\x3e").addClass("aui-datepicker-hint");e.append("\x3cspan/\x3e").text(c.hint);p.append(e)}f=d("\x3cdiv/\x3e");f.attr("data-aui-dp-popup-uuid",x);p.append(f);e={dateFormat:c.dateFormat,defaultDate:a.val(),maxDate:a.attr("max"),minDate:a.attr("min"),nextText:"\x3e",onSelect:function(m){a.val(m);a.change();b.hide();r=!0;a.focus();c.onSelect&&c.onSelect.call(this,m)},onChangeMonthYear:function(){setTimeout(l.refresh,
0)},prevText:"\x3c"};d.extend(e,g);-1<c.firstDay&&(e.firstDay=c.firstDay);"undefined"!==typeof a.attr("step")&&k.debug("WARNING: The date picker polyfill currently does not support the step attribute!");f.datepicker(e);d("body").on("keydown",t);a.on("focusout keydown",y);a.on("propertychange keyup input paste",z)};var t=function(g){var e=d(g.target),m=e.closest(p).length||e.is(a),E=e.closest(".ui-datepicker-header").length;!m&&!E||g.keyCode===k.keyCode.ESCAPE?b.hide():e[0]!==a[0]&&g.preventDefault()};
var y=function(){w||(d("body").on("focus blur click mousedown","*",t),w=!0)};var A=function(){r?r=!1:b.show()};var z=function(){d(this).val()&&(f.datepicker("setDate",a.val()),f.datepicker("option",{maxDate:a.attr("max"),minDate:a.attr("min")}))};b.destroyPolyfill=function(){b.hide();a.attr("placeholder",null);a.off("propertychange keyup input paste",z);a.off("focus click",A);a.off("focusout keydown",y);d("body").off("keydown",t);h.prototype.browserSupportsDateField&&(a[0].type="date");"undefined"!==
typeof f&&f.datepicker("destroy");delete b.destroyPolyfill;delete b.show;delete b.hide};var w=r=!1;c.languageCode in h.prototype.localisations||(c.languageCode="");var B=h.prototype.localisations,u="",q=9>k.versionDetails.major?240:255;"large"===B.size&&(q=325,u="aui-datepicker-dialog-large");q={hideCallback:function(){d("body").off("focus blur click mousedown","*",t);w=!1;n&&n._datePickerPopup&&delete n._datePickerPopup},hideDelay:null,noBind:!0,persistent:!0,closeOthers:!1,width:q};c.position&&
(q.calculatePositions=function(g,e){g=d(g[0]);return c.position.call(this,g,e)});var l=k.InlineDialog(a,void 0,function(g,e,m){"undefined"===typeof f&&(p=g,D(B));if(n=d(e).closest(".aui-inline-dialog").get(0))n._datePickerPopup=l;m()},q);l.addClass("aui-datepicker-dialog");l.addClass(u);a.on("focus click",A);a.attr("placeholder",c.dateFormat);c.overrideBrowserDefault&&h.prototype.browserSupportsDateField&&(a[0].type="text",u=a[0].getAttribute("value"))&&(a[0].value=u)};b.reset=function(){"function"===
typeof b.destroyPolyfill&&b.destroyPolyfill();h.prototype.browserSupportsDateField&&!c.overrideBrowserDefault||F()};b.reset();return b}var C=0;h.prototype.browserSupportsDateField=k.DatePicker.prototype.browserSupportsDateField;h.prototype.defaultOptions={overrideBrowserDefault:!1,firstDay:-1,languageCode:d("html").attr("lang")||"en-AU",dateFormat:d.datepicker.W3C};h.prototype.localisations=k.DatePicker.prototype.localisations;d.fn.inlineTasksDatePicker1=function(v){return new h(this,v)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:dateutil', location = '/js/dateutil.js' */
define("confluence-inline-tasks/dateutil",["jquery","ajs","confluence/position","confluence-inline-tasks/util","confluence-inline-tasks/date-picker1"],function(m,n,t,v,y){const r=n.Meta.get("user-locale").replace("_","-"),w=function(a=r){const b=["de-DE","ja-JP"],c=["fi-FI","ko-KR"];c.push("is-IS");let e="short",d="numeric";c.includes(a)?e="numeric":b.includes(a)&&(d=e="2-digit");return{year:"numeric",month:e,day:d}},p={isDateStringValid:function(a){return isNaN(new Date(a))?!1:!0},parseDate:function(a){return p.isDateStringValid(a)?
(a=a.split("-"),new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2]))):null},getPatternByLocale:function(a=r){let b="";(new Intl.DateTimeFormat(a)).formatToParts().forEach(c=>{b="literal"===c.type?b+c.value:"year"===c.type?b+"yyyy":b+c.type[0]+c.type[0]});return b},getDateTime:function(a){return`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,0)}-${a.getDate().toString().padStart(2,0)}`},getLozengeTime:function(a,b=r){return(new Intl.DateTimeFormat(b,w(b))).format(a)},getInputDate:function(a,
b=r){return(new Intl.DateTimeFormat(b,{year:"numeric",month:"2-digit",day:"2-digit"})).format(a)},convertDateIntoHtml:function(a,b=""){var c=m("\x3cdiv\x3e"),e=p.getLozengeTime(a);a=m("\x3ctime\x3e",{datetime:p.getDateTime(a)});v.addContentEditableIfApplicable(a);b&&a.attr("class",b);a.text(e);c.append(a);return c.html()},insertDateIntoCurrentCursor:function(a,b,c){var e=require("tinymce"),d=require("confluence-editor/utils/tinymce-node-utils");e=e.activeEditor;a=p.convertDateIntoHtml(a,b);a=m(a,
e.getDoc())[0];d=d.replaceSelection(a);c&&e.execCommand("mceInsertContent",!1,c,{skip_undo:!0});c={context:m(e.selection.getRng(!0).startContainer).closest("li[data-inline-task-id]").length?"task":"page",trigger:"character"};n.trigger("analyticsEvent",{name:"confluence-spaces.date.added",data:c});return d},getDateByPartialString:function(a,b=new Date,c=r){if(""===a)return b;const e=a.match(/[\d]+/g);if(!e)return null;let d,h,g;const k=new Date(b);(new Intl.DateTimeFormat(c,{year:"numeric",month:"2-digit",
day:"2-digit"})).formatToParts(k).filter(f=>"literal"!==f.type).forEach((f,q)=>{"year"===f.type?(d=k.getFullYear().toString(),e[q]&&(d=d.substring(0,d.length-e[q].length)+e[q])):"month"===f.type?h=(parseInt(e[q])||parseInt(f.value))-1:"day"===f.type&&(g=e[q]||f.value)});k.setFullYear(d);k.setMonth(h);k.setDate(g);a=`${d}-${(h+1).toString().padStart(2,0)}-${g.toString().padStart(2,0)}`;return p.isDateStringValid(a)?k:null},datepicker:{POSITION_ABOVE:!0,POSITION_BELOW:!1,POSITION_RIGHT:!0,POSITION_LEFT:!1,
dropDownStillFitsVertically:function(a,b,c){return a===this.POSITION_ABOVE?b.above>=c:b.below>=c},dropDownStillFitsHorizontally:function(a,b,c){return a===this.POSITION_RIGHT?b.right>=c:b.left>=c},getPreferredHorizontalPosition:function(a,b){return a.right>=b?this.POSITION_RIGHT:a.left>=b?this.POSITION_LEFT:a.right>a.left?this.POSITION_RIGHT:this.POSITION_LEFT},getPreferredVerticalPosition:function(a,b){return a.below>=b?this.POSITION_BELOW:a.above>=b?this.POSITION_ABOVE:a.below>a.above?this.POSITION_BELOW:
this.POSITION_ABOVE},calculateDatepickerPosition:function(a){var b=this;return function(c,e){var d=require("confluence-editor/editor/atlassian-editor");e=require("confluence-editor/editor/atlassian-editor-content");d=d.Rte.getEditorFrame();void 0===t.spaceLeftRight&&(t.spaceLeftRight=function(x,u){u=u.position().left;return{left:u,right:m(x).width()-u}});var h=t.spaceAboveBelow(d,a);var g=t.spaceLeftRight(d,a);var k=e.offset(a);e=c.outerHeight(!0);c=c.outerWidth(!0);var f=e+16;var q=c+0;d=b.POSITION_BELOW;
var l=b.POSITION_RIGHT;d&&(b.dropDownStillFitsVertically(d,h,f)||(d=null));d||(d=b.getPreferredVerticalPosition(h,f));l&&(b.dropDownStillFitsHorizontally(l,g,f)||(l=null));l=b.getPreferredHorizontalPosition(g,q);h=d===b.POSITION_ABOVE?k.top-e-16:k.top+a.height()+16;g=l===b.POSITION_RIGHT?k.left-0:k.left+a.outerWidth()-c;h={top:h,left:g};l=l===b.POSITION_RIGHT?a.outerWidth()/2:c-a.outerWidth()/2;if(0>l||l>c)l=c/10;return{displayAbove:d,popupCss:h,arrowCss:{left:l,top:d===b.POSITION_ABOVE?e:-8}}}},
getHintTextOfDatePicker:function(a){return a?"\u4e3a\u6b64\u4efb\u52a1\u9009\u62e9\u5230\u671f\u65f6\u95f4":"\u9009\u62e9\u4e00\u4e2a\u65e5\u671f\u3002"},create:function(a){var b=a.$attachTo,c=a.$positionTo,e=a.startDate,d=a.onSelect;a=a.isSetDueDate;var h=m("\x3cinput\x3e").attr("type","date").addClass("aui-date-picker").css("display","none"),g=h.inlineTasksDatePicker1({overrideBrowserDefault:!0,dateFormat:"yy-mm-dd",languageCode:n.Meta.get("user-locale")&&n.Meta.get("user-locale").split("_")[0],
position:this.calculateDatepickerPosition(c),onSelect:function(f){d(f);k()},hint:this.getHintTextOfDatePicker(a)}),k=function(){g&&g.destroyPolyfill&&g.destroyPolyfill();h&&h.remove();m(".aui-datepicker-dialog").remove();h=g=null};g.show();g.setDate(e);m(".aui-datepicker-dialog .aui-datepicker-hint").addClass(a?"set-duedate":"set-date");b.before(h);return{die:function(){k()},show:function(){g.show()},hide:function(){g.hide()},getContainer:function(){return h},setDate:function(f){n.debug("Set date: "+
f);g.setDate(p.getDateByPartialString(f))},placeDatePicker:function(){var f=n.InlineDialog.current;(f=f&&f.popup)&&f.refresh()}}}}};return p});require("confluence/module-exporter").exportModuleAsGlobal("confluence-inline-tasks/dateutil","Confluence.InlineTasks.DateUtil");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete-help-dialog.js' */
AJS.toInit(function(){Confluence.KeyboardShortcuts&&Confluence.KeyboardShortcuts.Autoformat&&Confluence.KeyboardShortcuts.Autoformat.push({action:"//",context:"autoformat.autocomplete",description:"\u65e5\u671f"})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/autocomplete-manager.js' */
(function(g){var e=window.Confluence||{};e.Editor=e.Editor||{};e.Editor.AutoComplete=e.Editor.AutoComplete||{};var c=e.InlineTasks.Util.KEY,p=e.InlineTasks.DateUtil,h=e.Editor.AutoComplete;h.SETTING_DEFAULT={leadingChar:"",isDataValid:function(a){return!1},backWords:0,onBeforeDie:function(){},onAfterStart:function(){},onScroll:function(){}};h.Manager=function(a){this.ed=AJS.Rte.getEditor();this.settings=g.extend({},h.SETTING_DEFAULT,a);this.log=AJS.debug;this.control=null};h.Manager.prototype={start:function(a){AJS.trigger("synchrony.stop",
{id:"confluence.date-autocomplete-manager.plugin"});this.log("startAutoComplete - Started");var f=g.extend({},this.settings,a);this.control=e.Editor.Autocompleter.Control(this.ed,f);if(!this.control)return!1;this.attachEventsToControl();f.onAfterStart&&f.onAfterStart({date:a.date,isTriggerFromOrphan:a.isTriggerFromOrphan?!0:!1});return!0},attachEventsToControl:function(){var a=this,f=a.control,k=a.log,q=a.settings;if("function"===typeof this.settings.onBeforeDie){var l=this.control.die,m=!1;this.control.die=
function(){m||(m=!0,a.settings.onBeforeDie.apply(a.control,arguments),a.dateInserted()?(l.apply(a.control,[!0]),AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.killed"})):l.apply(a.control,arguments))}}var r=_.bind(_.throttle(a.settings.onScroll,40),this);g.extend(f,{onBeforeKey:function(b,d){b.keyCode!==c.ESCAPE&&b.keyCode!==c.ENTER&&a.control&&a.control.getContainer().addClass("isDirty");return b.keyCode===c.DOWN||b.keyCode===c.UP||b.keyCode===c.ENTER?(tinymce.dom.Event.cancel(b),
!1):b.keyCode===c.ESCAPE||b.keyCode===c.TAB||b.keyCode===c.BACKSPACE&&!d?(k("autoCompleteControl.onBeforeKey - killing autoCompleteControl"),this.die(b.keyCode===c.BACKSPACE),!1):!0},onKeyPress:function(b,d){d=b.which;if(b.keyCode===c.ENTER)return tinymce.dom.Event.cancel(b),!1;b=String.fromCharCode(d);this.settings.endChars.includes(b)&&(k("autoCompleteControl.onKeyPress - caught autocomplete-closing char - character"),f.die());return!0},onAfterKey:function(b,d){var n=g("#autocomplete-trigger",a.control.getContainer()),
t=n.text();return 0<n.length&&t!==a.settings.leadingChar?(k("after","dying because of: trigger text is modified"),a.reset(),!1):b.keyCode===c.ENTER?(q.isDataValid(d)?f.update(d):(k("autoCompleteControl.onAfterKey - closing autocomplete due to invalid data - "+d),f.die(!1)),!1):a.dateInserted()&&10<d.length&&!p.getDateByPartialString(d)?(a.reset(),!1):!0},onDeath:function(){a.reset()},onScroll:function(){a.isAlive()&&r()}})},isAlive:function(){return this.control&&!this.control.dying},reset:function(){this.control&&
(this.control.die(),this.control=null,AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete-manager.plugin"}))},dateInserted:function(a){return!0===a?this.control.getContainer().addClass("hasDateInserted"):!1===a?this.control.getContainer().removeClass("hasDateInserted"):this.control.getContainer().hasClass("hasDateInserted")},dirty:function(a){return!0===a?this.control.getContainer().addClass("isDirty"):this.control.getContainer().hasClass("isDirty")},reattach:function(){var a=e.Editor.Autocompleter.Control.removeOrphanedControl();
return a&&a.leadingChar===this.settings.leadingChar?(this.reset(),this.start({backWords:1,isTriggerFromOrphan:!0})):!1}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete.js' */
(function(g,n){var v=Confluence.InlineTasks.Util,p=v.NODE_TYPE,l=v.KEY,k=Confluence.InlineTasks.DateUtil,m=null,d=null,w=!1,x=n.dom.TreeWalker,f={initDateAutoCompleteObject:function(b){Confluence.Editor.Autocompleter.Settings["//"]={ch:"//",endChars:[],update:function(a,c){d.picker.die();(a=c===k.getPatternByLocale()?new Date:k.getDateByPartialString(c))&&k.insertDateIntoCurrentCursor(a,"","\x26nbsp;");d.dateInserted()&&AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.used"});
d.reset();b.undoManager.add();AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete.plugin"})}};d=new Confluence.Editor.AutoComplete.Manager({leadingChar:"//",isDataValid:function(a){return!d.dirty()||k.getDateByPartialString(a)},onBeforeDie:function(){d.picker&&d.picker.die();if(d.control){var a=g(d.control.getContainer());d.dirty()||a.find("#autocomplete-search-text").remove()}},onAfterStart:function(a){a&&a.date?(f.fillPlaceholderDateAutoComplete(b,a.date,!0),d.dirty(!0),d.dateInserted(!0)):
a&&!a.isTriggerFromOrphan&&(f.fillPlaceholderDateAutoComplete(b,k.getPatternByLocale(),!1),d.dateInserted(!1));a=d.control.text();a=k.getDateByPartialString(a)||new Date;f.bindDatePickerToAutoComplete(a)},onScroll:function(){d.picker&&d.picker.placeDatePicker()}})},activateDateAutocomplete:function(b,a,c){b=Object.assign({},c,a);b.hasOwnProperty("insertedFromMenu")||(b.insertedFromMenu=!1);if(!d.isAlive()&&!d.start(b)&&!b.insertedFromMenu)return m.execCommand("mceInsertContent",!1,"//",{skip_undo:!0}),
!1},bindDatePickerToAutoComplete:function(b){var a=d.control&&d.control.getContainer();if(a.length){a.addClass("date-autocomplete");a.find("#autocomplete-search-text span").addClass("inserting");var c=f.isInsideTaskAndFirstTimeNode(a);d.picker=k.datepicker.create({$attachTo:a,$positionTo:a,startDate:b,onSelect:function(e){d.control.update(k.getInputDate(k.parseDate(e)))},isSetDueDate:c})}},fillPlaceholderDateAutoComplete:function(b,a,c){var e=d.control.getContainer().find("#autocomplete-search-text span");
e.text(AJS.Rte.HIDDEN_CHAR+a);var h=b.dom.createRng();h.setStart(e[0].firstChild,1);h.setEnd(e[0].firstChild,a.length+1);c&&h.collapse(!1);b.selection.setRng(h)},autocompleteDoubleSlash:function(b,a){b=a.handlerManager;var c=a.ed;a=a.createHandler;a=a(/(?:\s|\xA0|^|\ufeff|\u200b)(\/)$/,function(){c.execCommand("mceConfInsertDateAutocomplete",!1,{},{skip_undo:!0})},!0,"#autocomplete");b.registerHandler(47,a)},registerTriggerDoubleSlash:function(b){b.addCommand("mceConfInsertDateAutocomplete",f.activateDateAutocomplete);
b.addCommand("confMenuInsertDate",function(){AJS.trigger("analytics",{name:"editor.insert-data-from-menu"});m.execCommand("mceConfInsertDateAutocomplete",!1,{insertedFromMenu:!0},{skip_undo:!0})}.bind(this));AJS.bind("confluence.editor.registerHandlers",this.autocompleteDoubleSlash)},isTimeNode:function(b){return b&&b.nodeType===p.ELEMENT_NODE&&"time"===b.tagName.toLowerCase()},getTimeNodeAtCursor:function(b){b||(b=m);var a=b.selection.getNode();if(f.isTimeNode(a))return a;a=b.selection.getStart();
if(f.isTimeNode(a))return a;a=b.selection.getEnd();if(f.isTimeNode(a))return a},makeTimeNodesUnEditable:function(b){b.each(function(){var a=g(this);""===g.trim(a.text())&&a.remove();n.isWebKit&&a.remove("br.Apple-interchange-newline");v.addContentEditableIfApplicable(this)})},wrapTimeNodesWithHiddenChar:function(b){b.each(function(){var a=g(this);this.previousSibling&&this.previousSibling.nodeType===p.TEXT_NODE&&""!==this.previousSibling.nodeValue||a.before(AJS.Rte.HIDDEN_CHAR);this.nextSibling&&
this.nextSibling.nodeType===p.TEXT_NODE&&""!==this.previousSibling.nodeValue||a.after(AJS.Rte.HIDDEN_CHAR)})},putCursorAtEdge:function(b,a,c){(c=!!c)?a.nextSibling&&a.nextSibling.nodeType===p.TEXT_NODE||g(a).after(b.dom.doc.createTextNode("")):a.previousSibling&&a.previousSibling.nodeType===p.TEXT_NODE||g(a).before(b.dom.doc.createTextNode(""));var e=b.selection.dom.createRng();e.selectNode(c?a.nextSibling:a.previousSibling);e.collapse(c);b.selection.setRng(e)},findFirstTimeNodeInClosestBlock:function(b,
a,c){var e=new x(a,b.getBody()),h=a,r=0;do{if(1===r&&f.isTimeNode(a))return a;var q=c?a.previousSibling:a.nextSibling;a!==h&&q&&(b.dom.isBlock(a)||b.dom.isBlock(q))&&r++}while((a=c?e.next():e.prev())&&2>r)},findFirstTimeNodeNearby:function(b,a,c){var e=a,h=new x(a,b.getBody());do{if(f.isTimeNode(a))return a;if(b.dom.isBlock(a)||a!==e&&a.nodeType===p.TEXT_NODE&&""!==a.nodeValue)break}while(a=c?h.next():h.prev())},convertInvalidTimeNodeToPlainText:function(b){b.each(function(){var a=g(this),c=a.attr("datetime");
k.isDateStringValid(c)||(a.before(a.text()),a.remove())})},isInsideTaskAndFirstTimeNode:function(b){b=g(b);var a=b.closest("ul.inline-task-list \x3e li[data-inline-task-id]");return a.length?a.find("time, span.date-autocomplete")[0]===b[0]:!1}},C=function(b){b=b.keyCode;if(b===l.BACKSPACE||b===l.DELETE){b=b===l.DELETE;var a=m.selection.getRng(!0),c=a.startContainer,e=c;if(c.nodeType!==p.TEXT_NODE||(b?a.startOffset===c.nodeValue.length:0===a.startOffset))c.nodeType===p.ELEMENT_NODE&&(e=b?c.childNodes.length===
a.startOffset?c:c.childNodes.item(a.startOffset):0===a.startOffset?c:c.childNodes.item(a.startOffset-1)),(b=f.findFirstTimeNodeNearby(m,e,b))&&m.dom.remove(b)}},D=function(b){var a=g(b.target);if(a.is("time")){AJS.trigger("synchrony.stop",{id:"confluence.date-autocomplete.plugin"});var c=a.closest("li[data-inline-task-id]").length?"task":"page";AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.clicked",data:{mode:"editor",context:c}});var e=a.closest("body"),h=function(){AJS.Rte.unbindScroll("date-lozenge-date-picker");
q.die();AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete.plugin"})};e.one("keydown click",h);b=k.parseDate(a.attr("datetime"));var r=f.isInsideTaskAndFirstTimeNode(a),q=k.datepicker.create({$attachTo:a,$positionTo:a,startDate:b,onSelect:function(t){var u=k.parseDate(t);t=k.getDateTime(u);u=k.getLozengeTime(u);t!==a.attr("datetime")&&AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.changed",data:{context:c}});a.attr("datetime",t);a.text(u);e.unbind("keydown click",h);AJS.trigger("synchrony.start",
{id:"confluence.date-autocomplete.plugin"})},isSetDueDate:r});b=_.bind(_.throttle(function(){q&&AJS.Rte.isAnyPartShown(a)?q.placeDatePicker():h()},40),this);AJS.Rte.bindScroll("date-lozenge-date-picker",b)}},E=function(b){var a=b.keyCode;a===l.UP||a===l.DOWN||a===l.LEFT||a===l.RIGHT||a===l.HOME||a===l.END||a===l.PAGEDOWN||a===l.PAGEUP||b.metaKey||b.ctrlKey||b.altKey||!d.control||!d.picker||(b=d.control.text(),d.picker.setDate(b))},F=function(){var b=g(m.dom.doc).find("time");f.makeTimeNodesUnEditable(b);
f.wrapTimeNodesWithHiddenChar(b)},y=function(b,a,c){f.convertInvalidTimeNodeToPlainText(g(c.node).find("time"))},z=function(b,a,c){b=g(c.node).find("time");f.makeTimeNodesUnEditable(b)},A=function(b,a,c){if(f.getTimeNodeAtCursor(m))return c.content="",!1},G=function(b){var a=b.keyCode;if(a===l.UP||a===l.DOWN){b=m.selection.getRng(!0);var c=b.startContainer,e=c;a=a===l.DOWN;c.nodeType===p.ELEMENT_NODE&&(e=a?c.childNodes.length===b.startOffset?c:c.childNodes.item(b.startOffset):0===b.startOffset?c:
c.childNodes.item(b.startOffset-1));(b=f.findFirstTimeNodeInClosestBlock(m,e,a))&&f.wrapTimeNodesWithHiddenChar(g(b))}},H=function(b){b=b.element.nodeType===p.TEXT_NODE?b.element.parentNode:b.element;f.isTimeNode(b)&&(w||1<m.selection.getRng().startOffset?f.putCursorAtEdge(m,b,!0):f.putCursorAtEdge(m,b,!1))},B=function(){d&&d.reattach()},I={init:function(b){f.initDateAutoCompleteObject(b);f.registerTriggerDoubleSlash(b);m=b;b.on("contextmenu",function(){d.reset()});b.on("SetContent",F);b.on("click",
D);b.on("keyup",E);n.isWebKit&&(b.on("keydown",G),b.on("init",function(){g(document).bind("postPaste",z)}),b.on("remove",function(){g(document).unbind("postPaste",z)}));b.on("keyup",function(a){w=a.keyCode===l.RIGHT;var c=b.selection.getRng(!0),e=c.commonAncestorContainer,h=!!e&&e.data;h&&!AJS.$(e).closest("pre,.text-placeholder").length&&(String.prototype.slice.apply(h,[-11]),48<=a.keyCode&&57>=a.keyCode||96<=a.keyCode&&105>=a.keyCode)&&(a=String.prototype.slice.apply(h,[-10]),/(^| )\d{2}[\/\-]\d{2}[\/\-]\d{4}$/.test(h)&&
k.getDateByPartialString(a)&&(c.setStart(c.commonAncestorContainer,c.endOffset-a.length),b.undoManager.add(),b.undoManager.beforeChange(),b.selection.setRng(c),b.execCommand("mceConfInsertDateAutocomplete",!1,{date:a},{skip_undo:!0}),AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.triggered"})))});n.isGecko&&(b.on("keydown",C),b.on("init",function(){g(document).bind("prePaste",A)}),b.on("remove",function(){g(document).unbind("prePaste",A)}));if(n.isWebKit||n.isGecko)b.on("NodeChange",
H);b.on("Undo",B);b.on("Redo",B);b.on("init",function(){g(document).bind("postPaste",y)});b.on("remove",function(){g(document).unbind("postPaste",y);AJS.unbind("confluence.editor.registerHandlers",f.autocompleteDoubleSlash)});AJS.bind("editor.remote.change",function(){f.makeTimeNodesUnEditable(g(b.dom.doc).find("time"))})},getInfo:function(){return{longname:"Insert Date Autocomplete",author:"Atlassian",authorurl:"http://www.atlassian.com",version:n.majorVersion+"."+n.minorVersion}}};(function(){n.create("tinymce.plugins.DateAutocomplete",
I);n.PluginManager.add("dateautocomplete",n.plugins.DateAutocomplete);AJS.Rte.BootstrapManager.addTinyMcePluginInit(function(b){b.plugins+=",dateautocomplete"})})()})(AJS.$,tinymce);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reconcile-unknown-attachments:property-panel-unknown-image-placeholder', location = 'js/unknown-image-placeholder-property-panel.js' */
define("confluence-editor/unknown-attachment/property-panel",["wrm/context-path","ajs"],function(d,a){a&&a.Rte&&a.Rte.BootstrapManager?a.Rte.BootstrapManager.addOnInitCallback(function(){const c=a.Rte.getEditor();c?c.onClick.add(function(e,b){b=b.target;"IMG"===b.nodeName&&b.hasAttribute("src")&&0<=b.getAttribute("src").indexOf(d()+"/plugins/servlet/confluence/placeholder/unknown-attachment")&&e.execCommand("mceConfimage")}):a.log("Could not get Editor from adapter")}):a.log("Could not initialize property panel onclick handler on Confluence.Editor")});
require("confluence-editor/unknown-attachment/property-panel");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-for-editor-v4', location = 'js/editor-v4-init.js' */
require(["ajs","jquery","wrm/require"],function(b,d,c){b.Rte.BootstrapManager.addOnInitCallback(function(){c(["wrc!com.atlassian.confluence.plugins.drag-and-drop:editor-drop-handler"]).then(function(){require(["confluence-drag-and-drop/editor-drop-handler"],function(a){a.initialiseOverlay();a.initialise()})})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){try{if(packet&&packet.origin&&packet.origin!=="null"&&typeof packet.data==="string"){if(packet.origin===location.origin){process(gadgets.json.parse(packet.data))}else{AJS.$.get(AJS.contextPath()+"/rest/whitelist/1/check",{url:packet.origin}).done(function(result){if(result&&result.inbound&&result.inbound===true){process(gadgets.json.parse(packet.data))}else{if(AJS.debug){AJS.log("RPC: request rejected (bad origin): "+(packet&&packet.origin?packet.origin:"undefined origin"))}}}).fail(function(jqXHR,textStatus,errorThrown){AJS.log("RPC: REST "+textStatus,errorThrown)})}}else{if(AJS.debug){AJS.log("RPC: request rejected (bad origin): "+(packet&&packet.origin?packet.origin:"undefined origin"))}}}catch(e){if(AJS.debug){var origin=packet&&packet.origin?packet.origin:"undefined origin";AJS.log("Error processing gadget rpc message from '"+origin+"': "+e)}}},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.gadgets:macro-browser-for-gadgetsplugin', location = 'script/gadget-macro-browser.js' */
AJS.toInit(function(l){AJS.MacroBrowser.setMacroJsOverride("gadget",{postPreview:function(b,c){b=b.contentWindow.AJS;for(var a={},d=l("#macro-param-div-preferences input").val().split("\x26"),e=0,f=d.length;e<f;e++){var g=d[e].split("\x3d");try{a[decodeURI(g[0])]=decodeURI(g[1])}catch(m){}}c.needsConfig&&b&&!a.isConfigured&&(c=l("#macro-browser-dialog .dialog-button-panel .ok"),l("#save-warning-span").addClass("gadget-not-configured-warning").text("\u8bf7\u9996\u5148\u4e8e\u9884\u89c8\u533a\u57df\u5b8c\u6210\u914d\u7f6e").removeClass("hidden"),
c.prop("disabled",!0))},beforeParamsSet:function(b,c){var a=b.preferences;if(!c&&a){c=a.split("\x26");a=0;for(var d=c.length;a<d;a++){var e=c[a].split("\x3d");b[decodeURI(e[0])]=decodeURI(e[1])}}return b},updateMacroParametersForPreview:function(b){b.forceWrite=!0;return b},manipulateMarkup:function(b){if(AJS.MacroBrowser.gadgetPrefsChanged){b=top.document.getElementById("macro-insert-container");b=l("#macro-param-div-preferences input",b);var c="",a;for(a in AJS.MacroBrowser.gadgetPrefs)0!=c.length&&
(c+="\x26"),c=c+encodeURI(a)+"\x3d"+encodeURI(AJS.MacroBrowser.gadgetPrefs[a]);b.val(c)}},getMacroDetailsFromSelectedMacro:function(b,c){for(var a=c.params.url,d=0,e=b.length;d<e;d++){var f=b[d];if(f.macroName===c.name&&f.gadgetUrl===a)return f}},beforeParamsRetrieved:function(b,c,a){var d="";if(c.nonHiddenUserPrefs){var e=!0,f={},g=b.preferences;if(g){g=g.split("\x26");for(var m=0,p=g.length;m<p;m++){var n=g[m].split("\x3d"),q=decodeURI(n[0]);n=decodeURI(n[1]);f[q]=n}}for(var h in a)f[h]=a[h];for(var k in f){a:{a=
c.formDetails.parameters;for(h=0;h<a.length;h++)if(a[h].name==k){a=f[k]==a[h].defaultValue;break a}AJS.log("Unable to find matching param for "+k);a=!1}a||(e||(d+="\x26"),e=!1,d=d+encodeURI(k)+"\x3d"+encodeURI(f[k]))}b.preferences=d}return b}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.pattern.help', location = 'aui.chunk.09fb29655ea68ba72c1b--56553e59e2ce00fc2629.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.pattern.help"],{H4sa:function(i,u,n){"use strict";n.r(u);n("FStl"),n("Q0fs"),n("nqD9"),n("0FWE"),n("VtiI")}},[["H4sa","runtime","aui.splitchunk.fbbef27525","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.d925afe2c0","aui.splitchunk.d727dd207f","aui.splitchunk.7da3927366"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.489a76bc13', location = 'aui.chunk.c54fc404e557006fc7e9--1288594a11832eebcb23.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.489a76bc13"],{Jqxc:function(t,e,i){"use strict";i.r(e);var s=i("QFBp"),r=i("qT0E"),u=i.n(r),a=i("KloK"),h=u.a.Collection.extend({initialize:function(t,e){e||(e={}),e.matcher&&(this.matcher=e.matcher),e.model&&(this.model=e.model),this._idAttribute=(new this.model).idAttribute,this._maxResults=e.maxResults||5,this._queryData=e.queryData||{},this._queryParamKey=e.queryParamKey||"q",this._queryEndpoint=e.queryEndpoint||"",this.value=null,this.queryCache={},this.activeQueryCount=0,Object(s.bindAll)(this,"query","respond")},url:function(){return this._queryEndpoint},query:function(t){var e,i;this.value=t,i=this.getFilteredResults(t),this.respond(t,i),t&&this._queryEndpoint&&!this.hasQueryCache(t)&&this.shouldGetMoreResults(i)&&(e=this.fetch(t),this.activeQueryCount++,this.trigger("activity",{activity:!0}),e.always((()=>{this.activeQueryCount--,this.trigger("activity",{activity:!!this.activeQueryCount})})),e.done(((e,i,s)=>{this.addQueryCache(t,e,s)})),e.done((()=>{t=this.value,i=this.getFilteredResults(t),this.respond(t,i)})))},getQueryData:function(t){var e=Object(s.isFunction)(this._queryData)?this._queryData(t):this._queryData,i=Object(s.extend)({},e);return i[this._queryParamKey]=t,i},fetch:function(t){var e={add:!0,update:!0,remove:!1,data:this.getQueryData(t)};return u.a.Collection.prototype.fetch.call(this,e)},respond:function(t,e){return this.trigger("respond",{query:t,results:e}),e},matcher:function(t,e){},getFilteredResults:function(t){var e=[];return t?(e=this.filter((function(e){return!!this.matcher(e,t)}),this),this._maxResults&&(e=Object(s.first)(e,this._maxResults)),e):e},addQueryCache:function(t,e,i){var r=this.queryCache,u=this.parse(e,i);r[t]=Object(s.pluck)(u,this._idAttribute)},hasQueryCache:function(t){return this.queryCache.hasOwnProperty(t)},findQueryCache:function(t){return this.queryCache[t]},shouldGetMoreResults:function(t){return t.length<this._maxResults},setMaxResults:function(t){this._maxResults=t,this.value&&this.respond(this.value,this.getFilteredResults(this.value))}});Object(a.default)("ProgressiveDataSet",h),e.default=h}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form.single-select', location = 'aui.chunk.4497f9d1ebeae9bd7303--e9164fa8dc9b5c097985.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form.single-select"],{lotK:function(e,t,i){"use strict";i.r(t),i.d(t,"SelectEl",(function(){return z}));i("6fSn");var n=i("+x/D"),u=(i("aGv7"),i("HH5i")),s=(i("oSOL"),i("4dFR")),a=i("l3AF"),l=Object(s.default)("aui-option",{created:function(e){Object.defineProperty(e,"value",{get:function(){return e.getAttribute("value")||Object(a.default)(this.textContent)},set:function(t){e.setAttribute("value",t)}})},prototype:{serialize:function(){var e={};return this.hasAttribute("img-src")&&(e["img-src"]=encodeURI(this.getAttribute("img-src"))),e.value=this.value,e.label=Object(a.default)(this.textContent),e}}}),o=i("TmQU"),c=i("P3rJ"),r=i("KloK"),d=i("+ay7"),h=i("Jqxc"),g=i("TK3y"),f=i("qT0E"),p=i.n(f).a.Model.extend({idAttribute:"label",getLabel:function(){return this.get("label")||this.get("value")}});function b(){this._suggestions=[],this._activeIndex=-1}b.prototype={onChange:function(){},onHighlightChange:function(){},get:function(e){return this._suggestions[e]},set:function(e){var t=this._suggestions;return this._suggestions=e||[],this.onChange(t),this},getNumberOfResults:function(){return this._suggestions.length},setHighlighted:function(e){if(e)for(var t=0;t<this._suggestions.length;t++)this._suggestions[t].id===e.id&&this.highlight(t);return this},highlight:function(e){return this._activeIndex=e,this.onHighlightChange(),this},highlightPrevious:function(){var e=this._activeIndex,t=0===e?e:e-1;return this.highlight(t),this},highlightNext:function(){var e=this._activeIndex,t=e===this._suggestions.length-1?e:e+1;return this.highlight(t),this},highlighted:function(){return this.get(this._activeIndex)},highlightedIndex:function(){return this._activeIndex}};var v=b,_=i("vbuG"),m=i("jEnx");function y(e,t){return e+"-"+t}function k(e,t){this.el=e,this.anchor=t}function w(e){Object(n.default)(e).find(".aui-select-active").removeClass("aui-select-active")}k.prototype={render:function(e,t,i){this.currListId=i;var n="";if(e.length){var s=t;e.forEach((function(e){var t=e.getLabel(),a=e.get("img-src"),l=a?'<img src="'.concat(encodeURI(a),'"/>'):"",o=e.get("new-value")?" (<em>".concat("\u65b0\u7684\u503c","</em>)"):"";n+='<li role="option" class="aui-select-suggestion" id="'.concat(y(i,s),'">').concat(l).concat(t).concat(o,"</li>"),s++})),t?this.el.querySelector("ul").innerHTML+=n:this.el.querySelector("ul").innerHTML=n}else t||(this.el.querySelector("ul").innerHTML='<li role="option" class="aui-select-no-suggestions">'.concat("\u6ca1\u6709\u5efa\u8bae","</li>"));return this},setActive:function(e){w(this.el),Object(n.default)(this.el).find("#"+y(this.currListId,e)).addClass("aui-select-active")},getActive:function(){return this.el.querySelector(".aui-select-active")},show:function(){var e;e=this,Object(n.default)(e.el).css("min-width",Object(n.default)(e.anchor).outerWidth()),Object(m.default)(this.el).show(),function(e){e.anchor&&!e._auiAlignment&&(e._auiAlignment=new _.default(e.el,e.anchor,{flipContainer:"scrollParent",positionFixed:!0,preventOverflow:!1,flip:!1})),e._auiAlignment&&(e._auiAlignment.enable(),e._auiAlignment.scheduleUpdate())}(this)},hide:function(){var e;w(this.el),Object(m.default)(this.el).hide(),(e=this)._auiAlignment&&e._auiAlignment.disable()},destroy:function(){var e;this.hide(),(e=this)._auiAlignment&&(e._auiAlignment.destroy(),delete e._auiAlignment),delete this.currListId},isVisible:function(){return Object(n.default)(this.el).is(":visible")}};var O=k,A=i("gjsO"),x=i.n(A)()('\n    <input type="text" class="text" autocomplete="off" role="combobox" aria-autocomplete="list" aria-haspopup="true" aria-expanded="false">\n    <select></select>\n    <datalist>\n        <content select="aui-option"></content>\n    </datalist>\n    <button class="aui-button" role="button" tabindex="-1" type="button"></button>\n    <div class="aui-popover" role="listbox" data-aui-alignment="bottom left" hidden>\n        <ul class="aui-optionlist" role="presentation"></ul>\n    </div>\n    <div class="aui-select-status assistive" aria-live="polite" role="status"></div>\n'),j=i("OEua"),S=i("LTUc"),C=i("I7um");function I(e){e._select.selectedIndex=-1,function(e){e._input.removeAttribute("style"),Object(n.default)(e._input).removeClass("aui-select-has-inline-image")}(e)}function M(e){return e._suggestionModel.getNumberOfResults()}function q(e,t){return 0===e.get("label").toLowerCase().indexOf(t.toLowerCase())}function E(e){e._suggestionsView.hide(),e._input.setAttribute("aria-expanded","false")}function T(e){var t=M(e)?0:-1;e._suggestionModel.highlight(t),E(e)}function V(e,t,i){e._autoHighlight=t,void 0===i&&(i=e._input.value),e._progressiveDataSet.query(i)}function D(e){var t=e._suggestionModel.highlighted()&&e._suggestionModel.highlighted().get("img-src");t&&function(e,t){Object(n.default)(e._input).addClass("aui-select-has-inline-image"),e._input.setAttribute("style","background-image: url("+encodeURI(t)+")")}(e,t)}function L(e,t){if(t){var i,n=document.createElement("option"),u=e._select,s=t.get("value")||t.get("label"),a=(i=t.getLabel(),(new DOMParser).parseFromString(i,"text/html").documentElement.textContent);n.setAttribute("selected",""),n.setAttribute("value",s),n.textContent=a,e._input.value=a,u.innerHTML="",u.options.add(n),u.dispatchEvent(new c.default("change",{bubbles:!0}))}}function H(e){L(e,e._suggestionModel.highlighted()),D(e),T(e)}function P(e){return new p(e.serialize())}function N(e){for(var t=[],i=0;i<e._datalist.children.length;i++){var n=e._datalist.children[i];t.push(P(n))}return t}function R(e){var t=e._dropdown.querySelector(".aui-select-active");return t&&t.id}function U(e,t){return n.default.map(t,(function(e){return e.id})).indexOf(e)}function F(e){e._progressiveDataSet=new h.default(N(e),{model:p,matcher:q,queryEndpoint:e._queryEndpoint,maxResults:20}),e._isSync=!e._queryEndpoint,e._progressiveDataSet.on("activity",(function(){e._progressiveDataSet.activeQueryCount&&!e._isSync?(!function(e){e._button.isBusy()||(e._button.busy(),e._input.setAttribute("aria-busy","true"),e._dropdown.setAttribute("aria-busy","true"))}(e),Object(g.default)(e).set("should-flag-new-suggestions",!1)):(!function(e){e._button.idle(),e._input.setAttribute("aria-busy","false"),e._dropdown.setAttribute("aria-busy","false")}(e),Object(g.default)(e).set("should-flag-new-suggestions",!0))})),e._progressiveDataSet.on("respond",(function(t){if(t.query&&!e._input.value)return;if(Object(g.default)(e).get("should-cancel-response"))return void(e._progressiveDataSet.activeQueryCount||Object(g.default)(e).set("should-cancel-response",!1));t.query||(t.results=N(e));var i=-1!==U(e._input.value,t.results),n=!e._input.value;if(!e.hasAttribute("can-create-values")||i||n||t.results.push(function(e){var t=new l;t.setAttribute("value",e._input.value);var i=P(t);return i.set("new-value",!0),i}(e)),!Object(g.default)(e).get("should-include-selected")){var s=U(e.value,t.results);s>=0&&t.results.splice(s,1)}const a=function(e,t){const i=e._suggestionModel.getNumberOfResults();return e._suggestionModel.set(),e._suggestionModel.set(t.results),i!==e._suggestionModel.getNumberOfResults()}(e,t),o=e._suggestionModel.highlighted()||t.results[0];e._autoHighlight&&(e._suggestionModel.setHighlighted(o),setTimeout((function(){e._input.setAttribute("aria-activedescendant",R(e))}),50)),e._input.setAttribute("aria-expanded","true"),!e._isSync&&a&&e._suggestionsView.getActive()&&Object(g.default)(e).get("should-flag-new-suggestions")&&(e.querySelector(".aui-select-status").innerHTML="\u5df2\u6dfb\u52a0\u65b0\u7684\u5efa\u8bae\u3002\u8bf7\u4f7f\u7528\u5411\u4e0a\u548c\u5411\u4e0b\u7bad\u5934\u9009\u62e9\u3002"),e._suggestionsView.show()}))}function K(e){var t=e.value?"":e._input.value,i=""===e._input.value;Object(g.default)(e).set("should-include-selected",i),V(e,!0,t)}function W(e){(function(e){return e._progressiveDataSet.activeQueryCount>0})(e)&&Object(g.default)(e).set("should-cancel-response",!0)}function J(e){if(e._select.selectedIndex>=0)return e._select.options[e._select.selectedIndex].textContent}function Q(e){W(e),function(e){var t=!e.hasAttribute("no-empty-values"),i=!e._input.value,n=e._input.value!==J(e);if(i||n)if(t)I(e);else{var u=J(e);void 0===u?I(e):e._input.value=u}}(e),function(e){e._suggestionModel.highlight(-1)}(e),E(e)}const G=Object(s.default)("aui-select",{template:x,created:function(e){e._listId=Object(j.default)(),e._input=e.querySelector("input"),e._select=e.querySelector("select"),e._dropdown=e.querySelector(".aui-popover"),e._datalist=e.querySelector("datalist"),e._button=e.querySelector("button"),e._suggestionsView=new O(e._dropdown,e._input),e._suggestionModel=new v,e._suggestionModel.onChange=function(t){var i=[];e._suggestionModel._suggestions.forEach((function(e){t.some((function(t){return e.id===t.id}))||i.push(e)})),e._suggestionsView.render(i,t.length,e._listId)},e._suggestionModel.onHighlightChange=function(){var t=e._suggestionModel.highlightedIndex();e._suggestionsView.setActive(t),e._input.setAttribute("aria-activedescendant",R(e))}},attached:function(e){s.default.init(e),F(e),function(e){e._dropdown.id=e._listId,e.querySelector("button").setAttribute("aria-controls",e._listId)}(e),e._input.setAttribute("aria-controls",e._listId),e.setAttribute("tabindex","-1"),function(e){Object(n.default)(e._dropdown).on("mouseover","li",(function(t){M(e)&&e._suggestionModel.highlight(Object(n.default)(t.target).index())}))}(e),function(e){let t=!1;Object(n.default)(document).on("aui-close-layers-on-outer-click.single-select",(e=>{t&&(e.preventDefault(),t=!1)})),Object(n.default)(e._dropdown).on("mousedown","li",(function(i){if(!M(e))return!1;e._suggestionModel.highlight(Object(n.default)(i.target).index()),H(e),e._suggestionsView.hide(),Object(n.default)(e).closest(".aui-layer").length>0&&(t=!0),e._input.removeAttribute("aria-activedescendant")}))}(e),function(e){var t=e._datalist.querySelector("aui-option[selected]");t&&L(e,P(t))}(e),T(e),D(e)},detached:function(e){Object(n.default)(document).off("aui-close-layers-on-outer-click"),Object(C.ifGone)(e).then((()=>{E(e),e._suggestionsView.destroy()}))},attributes:{id(e,t){e.id&&(e.querySelector("input").id=t.newValue+S.INPUT_SUFFIX)},name(e,t){e.querySelector("select").setAttribute("name",t.newValue)},placeholder(e,t){e.querySelector("input").setAttribute("placeholder",t.newValue)},src(e,t){e._queryEndpoint=t.newValue}},events:{"blur input":function(e){Q(e)},"mousedown button":function(e){document.activeElement!==e._input||e._dropdown.hasAttribute("hidden")||Object(g.default)(e).set("prevent-open-on-button-click",!0)},"click input":function(e){K(e)},"click button":function(e){var t=Object(g.default)(e);t.get("prevent-open-on-button-click")?t.set("prevent-open-on-button-click",!1):(Object(g.default)(e).set("button-clicked-prevent-dropdown-hide",!0),e.focus())},input:function(e){e._input.value?(Object(g.default)(e).set("should-include-selected",!0),V(e,!0)):Object(g.default)(e).get("button-clicked-prevent-dropdown-hide")?Object(g.default)(e).set("button-clicked-prevent-dropdown-hide",!1):E(e)},"keydown input":function(e,t){var i=e._input.value,n=!1;if(t.keyCode===d.default.ESCAPE)return W(e),void E(e);e._suggestionsView.isVisible()&&M(e)?t.keyCode===d.default.ENTER?(W(e),H(e),t.preventDefault()):t.keyCode===d.default.TAB?(!function(e){e._suggestionsView.isVisible()&&H(e)}(e),n=!0):t.keyCode===d.default.UP?(e._suggestionModel.highlightPrevious(),t.preventDefault()):t.keyCode===d.default.DOWN&&(e._suggestionModel.highlightNext(),t.preventDefault()):t.keyCode!==d.default.UP&&t.keyCode!==d.default.DOWN||(K(e),t.preventDefault()),n=n||t.defaultPrevented,setTimeout((function(){e._input.value===i||n||e.dispatchEvent(new c.default("input",{bubbles:!0}))}),0)}},prototype:{get value(){var e=this._select.options[this._select.selectedIndex];return e?e.value:""},set value(e){if(""===e)(n=this)._input.value="",n._select.innerHTML="";else if(e){var t=this._progressiveDataSet,i=t.findWhere({value:e})||t.findWhere({label:e});!i&&this.hasAttribute("can-create-values")&&(i=new p({value:e,label:e})),L(this,i)}var n;return this},get displayValue(){return this._input.value},blur:function(){return this._input.blur(),Q(this),this},focus:function(){return this._input.focus(),K(this),this}}});Object(o.default)("aui/select",G),Object(r.default)("select",G);var z=G}},[["lotK","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.vendors--084821f40b","aui.splitchunk.vendors--d2297af84a","aui.splitchunk.vendors--20e849aab3","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.dd803a46b4","aui.splitchunk.994e478d48","aui.splitchunk.d7c46c2734","aui.splitchunk.e54c7c7304","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.f1e06f97a4","aui.splitchunk.479fe6ee76","aui.splitchunk.f673ef53ac","aui.splitchunk.8659b532c1","aui.splitchunk.9c48cc20a9","aui.splitchunk.908fe798b4","aui.splitchunk.5f851f97df","aui.splitchunk.462ee5f9ef","aui.splitchunk.d0110a864f","aui.splitchunk.afa5039e04","aui.splitchunk.bff3715233","aui.splitchunk.26116b3cbd","aui.splitchunk.c750721820","aui.splitchunk.6d6f245ed3","aui.splitchunk.ed86a19e01","aui.splitchunk.50dca3e042","aui.splitchunk.084821f40b","aui.splitchunk.2e16019fb9","aui.splitchunk.baa83dbaf9","aui.splitchunk.f154095da3","aui.splitchunk.20e849aab3","aui.splitchunk.86ad04cc86","aui.splitchunk.4331a05956","aui.splitchunk.489a76bc13","aui.splitchunk.af1935061c"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/editor/soy/editor-main.soy' */
// This file was automatically generated from editor-main.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.editor == 'undefined') { org.swift.confluence.editor = {}; }


org.swift.confluence.editor.editorMain = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<section role="dialog" class="appfire aui-dialog2 aui-dialog2-xlarge aui-layer" data-aui-modal="true" aria-hidden="true"><form class="aui top-label"><!-- Dialog header -->' + org.swift.confluence.editor.editorHeader(opt_data) + '<div class="aui-dialog2-content"><div class="aui-group"><div class="aui-item appfire-navigation">' + org.swift.confluence.editor.editorNavigation(opt_data) + '</div><div class="aui-item appfire-content-panes">' + org.swift.confluence.editor.editorPanes(opt_data) + '</div>' + ((opt_data.showPreview) ? '<div class="aui-item appfire-preview-actions" style="position:relative">' + org.swift.confluence.editor.editorPreview(opt_data) + '</div><div class="aui-item appfire-preview-container" style="display:none"><div class="appfire-preview-header macro-preview-header"><span class="appfire-preview-title">Preview</span><button class="appfire-preview-refresh aui-button"><span class="aui-icon aui-icon-small aui-iconfont-refresh aui-iconfont-refresh-small"></span>&nbsp;&nbsp;Refresh</button></div><div class="appfire-preview-data"></div><div class="appfire-preview-loading" style="display:none"><span class="aui-icon aui-icon-large aui-icon-wait">Preview loading</span> Please wait while preview loads...</div></div>' : '') + '</div></div><!-- Dialog footer -->' + org.swift.confluence.editor.editorFooter({appVendor: 'Appfire'}) + '</form></section>';
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorMain.soyTemplateName = 'org.swift.confluence.editor.editorMain';
}


org.swift.confluence.editor.editorHeader = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml(opt_data.title) + '</h2></header>';
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorHeader.soyTemplateName = 'org.swift.confluence.editor.editorHeader';
}


org.swift.confluence.editor.editorNavigation = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<nav class="primary">';
  var itemList25 = opt_data.navigation.primary;
  var itemListLen25 = itemList25.length;
  for (var itemIndex25 = 0; itemIndex25 < itemListLen25; itemIndex25++) {
    var itemData25 = itemList25[itemIndex25];
    output += '<div class="nav-item" data-index="' + soy.$$escapeHtml(itemIndex25) + '" ' + ((itemData25.activePanel) ? 'data-active-panel' : '') + ' title="' + soy.$$escapeHtml(itemData25.name) + '"><img src="' + soy.$$escapeHtml(itemData25.icon) + '"/></div>';
  }
  output += '</nav><nav class="secondary">';
  var itemList39 = opt_data.navigation.secondary;
  var itemListLen39 = itemList39.length;
  for (var itemIndex39 = 0; itemIndex39 < itemListLen39; itemIndex39++) {
    var itemData39 = itemList39[itemIndex39];
    output += '<div class="nav-item" title="' + soy.$$escapeHtml(itemData39.name) + '" data-url="' + soy.$$escapeHtml(itemData39.url) + '"><img src="' + soy.$$escapeHtml(itemData39.icon) + '"/></div>';
  }
  output += '</nav>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorNavigation.soyTemplateName = 'org.swift.confluence.editor.editorNavigation';
}


org.swift.confluence.editor.editorPreview = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<nav class="primary"><a href="#" title="Show preview" class="appfire-preview-show"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/org.swift.confluence.tablesorter/editor/img/icon-preview-48.png")></a><a href="#" title="Hide preview" class="appfire-preview-hide"  style="display:none"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/org.swift.confluence.tablesorter/editor/img/icon-preview-48.png")></a></nav><nav class="secondary"><a href="#" title="Show Preview" class="appfire-preview-show"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/org.swift.confluence.tablesorter/editor/img/icon-expandLeft-48.png")></a><a href="#" title="Hide Preview" class="appfire-preview-hide" style="display:none"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/org.swift.confluence.tablesorter/editor/img/icon-expandRight-48.png")></a></nav>';
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorPreview.soyTemplateName = 'org.swift.confluence.editor.editorPreview';
}


org.swift.confluence.editor.editorPanes = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var itemList60 = opt_data.navigation.primary;
  var itemListLen60 = itemList60.length;
  for (var itemIndex60 = 0; itemIndex60 < itemListLen60; itemIndex60++) {
    var itemData60 = itemList60[itemIndex60];
    output += '<div class="content-panel"><h1>' + soy.$$escapeHtml(itemData60.name) + '</h1>' + soy.$$filterNoAutoescape(itemData60.panel) + '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorPanes.soyTemplateName = 'org.swift.confluence.editor.editorPanes';
}


org.swift.confluence.editor.editorFooter = function(opt_data, opt_ignored) {
  return '<footer class="aui-dialog2-footer"><!-- Actions to render on the right of the footer --><aui-inline-dialog id="editor-error-msg" class="aui-help" alignment="bottom center"><div id="default-error-content"><p class="title"><strong>' + soy.$$escapeHtml('Configuration error!') + '</strong></p><p class="body">And this is just content in a Default message.</p></div></aui-inline-dialog><div class="aui-dialog2-footer-actions"><span id="show-editor-error" aria-controls="editor-error-msg" data-aui-trigger class="aui-icon aui-icon-large ' + soy.$$escapeHtml('aui-iconfont-error') + '" style="display:none"></span><button id="editor-save-button" class="aui-button aui-button-primary">Save settings</button><button id="editor-close-button" class="editor-dialog-close aui-button aui-button-link">Cancel</button></div><!-- Hint text is rendered on the left of the footer --><div class="aui-dialog2-footer-hint">' + soy.$$escapeHtml(opt_data.appVendor) + '</div></footer>';
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorFooter.soyTemplateName = 'org.swift.confluence.editor.editorFooter';
}


org.swift.confluence.editor.commonGridRowActions = function(opt_data, opt_ignored) {
  var output = '';
  var menuItemName__soy77 = opt_data.itemName ? opt_data.itemName : 'formatting';
  output += '<div class="col-1 row-actions">   \t                <!-- row actions --><button aria-controls="' + soy.$$escapeHtml(opt_data.controlId) + '" class="aui-button aui-dropdown2-trigger aui-dropdown2-trigger-arrowless aui-button-subtle aui-button-compact"><span class="aui-icon aui-icon-small aui-iconfont-more">More</span></button><aui-dropdown-menu class="row-action" id="' + soy.$$escapeHtml(opt_data.controlId) + '"><aui-item-link class="add-grid-row-above">Add ' + soy.$$escapeHtml(menuItemName__soy77) + ' above</aui-item-link><aui-item-link class="add-grid-row-below">Add ' + soy.$$escapeHtml(menuItemName__soy77) + ' below</aui-item-link><aui-item-link class="copy-grid-row">Copy ' + soy.$$escapeHtml(menuItemName__soy77) + '</aui-item-link><aui-item-link class="paste-grid-row">Paste ' + soy.$$escapeHtml(menuItemName__soy77) + '</aui-item-link>' + ((opt_data.showMoveUpDown) ? '<aui-item-link class="move-grid-row-up">Move up</aui-item-link><aui-item-link class="move-grid-row-down">Move down</aui-item-link>' : '') + '<aui-item-link class="clear-grid-row">Clear</aui-item-link><aui-item-link class="delete-grid-row">Delete</aui-item-link></aui-dropdown-menu></div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.editor.commonGridRowActions.soyTemplateName = 'org.swift.confluence.editor.commonGridRowActions';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/editor/soy/fields-template.soy' */
// This file was automatically generated from fields-template.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.textElement = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var id__soy3 = opt_data.id ? opt_data.id : opt_data.name;
  var inputClass__soy4 = opt_data.inputClass ? opt_data.inputClass : 'long-field';
  output += (opt_data.topLabel) ? '<div class="field-group"><label for="' + soy.$$escapeHtml(opt_data.name) + '"><span class="appfire-editor-label-span">' + soy.$$escapeHtml(opt_data.label) + '</span>' + ((opt_data.required) ? '<span class="aui-icon icon-required appfire-icon-required">required</span>' : '') + ' ' + org.swift.confluence.table.editor.addHelpContent({id: id__soy3, helpContent: opt_data.helpContent}) + '</label><input class="text ' + soy.$$escapeHtml(inputClass__soy4) + ' ' + ((opt_data.required) ? ' appfire-editor-input-required' : '') + '" ' + ((opt_data.type) ? ' type="' + soy.$$escapeHtml(opt_data.type) + '" else type="text" ' : '') + '  id="' + soy.$$escapeHtml(id__soy3) + '" name="' + soy.$$escapeHtml(opt_data.name) + '" ' + ((opt_data.value || opt_data.value == 0 || opt_data.value == false) ? '  value=\'' + soy.$$escapeHtml(opt_data.value) + '\' ' : '') + '  ' + ((opt_data.type == 'number') ? ' min="0" ' : '') + ' autocomplete="new-password" />  ' + ((opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '') + '</div>' : '<div class="field-group"><div class="aui-group"><div class="aui-item toggle-label"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.label) + ((opt_data.required) ? '<span class="aui-icon icon-required appfire-icon-required">required</span>' : '') + ' ' + org.swift.confluence.table.editor.addHelpContent({id: id__soy3, helpContent: opt_data.helpContent}) + '</label></div><div class="aui-item"><input class="text ' + soy.$$escapeHtml(inputClass__soy4) + ((opt_data.required) ? ' appfire-editor-input-required ' : '') + '" ' + ((opt_data.type) ? ' type="' + soy.$$escapeHtml(opt_data.type) + '" else type="text" ' : '') + ' name="' + soy.$$escapeHtml(opt_data.name) + '" id="' + soy.$$escapeHtml(id__soy3) + '" ' + ((opt_data.value || opt_data.value == 0 || opt_data.value == false) ? '  value=\'' + soy.$$escapeHtml(opt_data.value) + '\' ' : '') + ' ' + ((opt_data.type == 'number') ? ' min="0" ' : '') + '/>  </div>' + ((opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '') + '</div></div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.textElement.soyTemplateName = 'org.swift.confluence.table.editor.textElement';
}


org.swift.confluence.table.editor.toggleElement = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var id__soy97 = opt_data.id ? opt_data.id : opt_data.name;
  output += '<div class="field-group"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.label) + '  ' + org.swift.confluence.table.editor.addHelpContent({id: id__soy97, helpContent: opt_data.helpContent}) + '</label><aui-toggle class="appfire-toggle" id="' + soy.$$escapeHtml(id__soy97) + '" name="' + soy.$$escapeHtml(opt_data.name) + '"  label="' + soy.$$escapeHtml(opt_data.label) + '"  ' + ((opt_data.value) ? ' checked ' : '') + '></aui-toggle>   ' + ((opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '') + '</div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.toggleElement.soyTemplateName = 'org.swift.confluence.table.editor.toggleElement';
}


org.swift.confluence.table.editor.customToggleElement = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var id__soy124 = opt_data.id ? opt_data.id : opt_data.name;
  output += '<div class="field-group"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.label) + '  ' + org.swift.confluence.table.editor.addHelpContent({id: id__soy124, helpContent: opt_data.helpContent}) + '</label><div id="' + soy.$$escapeHtml(opt_data.name) + '" class="aui-buttons  appfire-custom-toggle"><input class="appfire-toggle-aui-button aui-button" aria-pressed=' + ((opt_data.value == opt_data.value1) ? ' "true" ' : ' "false" ') + ' value=\'' + soy.$$escapeHtml(opt_data.value1) + '\' readonly="readonly"/><input class="appfire-toggle-aui-button aui-button" aria-pressed=' + ((opt_data.value == opt_data.value2) ? ' "true" ' : ' "false" ') + ' value=\'' + soy.$$escapeHtml(opt_data.value2) + '\' readonly="readonly"/>   <input type="hidden" id="' + soy.$$escapeHtml(id__soy124) + '" name="' + soy.$$escapeHtml(opt_data.name) + '" value=\'' + soy.$$escapeHtml(opt_data.value) + '\'></div>' + ((opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '') + '</div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.customToggleElement.soyTemplateName = 'org.swift.confluence.table.editor.customToggleElement';
}


org.swift.confluence.table.editor.addHelpContent = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '' + ((opt_data.helpContent) ? org.swift.confluence.table.editor.helpDialog({id: opt_data.id, content: opt_data.helpContent}) : '');
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.addHelpContent.soyTemplateName = 'org.swift.confluence.table.editor.addHelpContent';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/editor/soy/help-dialog.soy' */
// This file was automatically generated from help-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.helpDialog = function(opt_data, opt_ignored) {
  return '<a id="' + opt_data.id + 'HelpDialogLink" data-aui-trigger aria-controls="' + opt_data.id + 'HelpDialog" href="#"><span class="aui-icon aui-icon-small aui-iconfont-info">help</span></a><aui-inline-dialog id="' + opt_data.id + 'HelpDialog" class="aui-help appfire-help-dialogs" responds-to="hover"><p>' + opt_data.content + '</p></aui-inline-dialog>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.helpDialog.soyTemplateName = 'org.swift.confluence.table.editor.helpDialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/table-settings-panel.soy' */
// This file was automatically generated from table-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.tableSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#tabs-table-formatting">Formatting</a></li><li class="menu-item"><a href="#tabs-table-advanced-settings">Advanced settings</a></li></ul><div class="tabs-pane active-pane" id="tabs-table-formatting"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.textElement({name: 'id', value: opt_data.id, label: 'Table id', topLabel: 'true', helpContent: 'Specify a table id for use in chart macros, Javascript, and custom styles. '}) + org.swift.confluence.table.editor.textElement({id: 'tableClass', name: 'class', value: opt_data['class'], label: 'Table class', topLabel: 'true', helpContent: 'Create custom tables with a table class along with using, for example, Space Stylesheets. '}) + org.swift.confluence.table.editor.textElement({name: 'style', value: opt_data.style, label: 'Table style', topLabel: 'true', helpContent: 'Apply styles to the table using \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCascading Style Sheets (CSS)\x3c/a\x3e. CSS is a simple mechanism for adding formatting to tables.'}) + ((opt_data.width != null) ? org.swift.confluence.table.editor.textElement({name: 'width', value: opt_data.width, label: 'Table width', topLabel: 'true'}) : '') + ((opt_data.border != null) ? org.swift.confluence.table.editor.textElement({name: 'border', value: opt_data.border, label: 'Border width', topLabel: 'true'}) : '') + '</fieldset></div></div><div class="tabs-pane" id="tabs-table-advanced-settings"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.toggleElement({name: 'allowExport', value: opt_data.allowExport, label: 'Enable download and export as attachment'}) + '<!--TODO: Remove this condition when this feature is supported for AT App too-->';
  var otherDelim__soy43 = opt_data.exportFileDelimiter == 'Comma' || opt_data.exportFileDelimiter == 'Tab' || opt_data.exportFileDelimiter == 'Semicolon' || opt_data.exportFileDelimiter == 'Space' ? false : true;
  output += '<div class="field-group"><label for="exportFileDelimiter">' + soy.$$escapeHtml('File delimiter to use when download and export is enabled. Default value is comma.') + ' </label><select class="select  appfire-export-select" name="exportFileDelimiter" id="exportFileDelimiter"><option value="Comma" ' + ((opt_data.exportFileDelimiter == 'Comma') ? 'selected' : '') + '>Comma</option><option value="Tab" ' + ((opt_data.exportFileDelimiter == 'Tab') ? 'selected' : '') + '>Tab</option><option value="Semicolon" ' + ((opt_data.exportFileDelimiter == 'Semicolon') ? 'selected' : '') + '>Semicolon</option><option value="Space" ' + ((opt_data.exportFileDelimiter == 'Space') ? 'selected' : '') + '>Space</option><option value="Other" ' + ((otherDelim__soy43) ? ' selected ' : '') + '>Other</option></select>  <input class="text appfire-export-textbox" type="text" name="exportFileDelimiterOther" id="exportFileDelimiterOther"  maxlength="1" size="1" ' + ((! otherDelim__soy43) ? ' style="display:none;" ' : '') + ' ' + ((otherDelim__soy43) ? ' value="' + soy.$$escapeHtml(opt_data.exportFileDelimiter) + '" ' : '') + '/></div>' + ((opt_data.macroName == 'table-plus') ? org.swift.confluence.table.editor.toggleElement({name: 'multiple', value: opt_data.multiple, label: 'Apply settings to nested tables'}) : '') + org.swift.confluence.table.editor.toggleElement({name: 'displayDataFilter', value: opt_data.displayDataFilter, label: 'Display data filter', helpContent: 'Enable this to see filter panel above the table to filter the data.'}) + '</fieldset></div></div></div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.tableSettingsPanel.soyTemplateName = 'org.swift.confluence.table.editor.tableSettingsPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/column-settings-panel.soy' */
// This file was automatically generated from column-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.columnSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#column-formatting">Formatting</a></li><li class="menu-item"><a href="#column-totaling">Numbering & totaling</a></li><li class="menu-item"><a href="#column-sorting">Sorting</a></li></ul><div class="tabs-pane active-pane" id="column-formatting"><fieldset class="appfire-grid-set">';
  var dataColumnStylesLength__soy4 = opt_data.autoNumber ? opt_data.columnStyles.length - 1 : opt_data.columnStyles.length;
  var rowCount__soy5 = Math.max(0, Math.max(Math.max(opt_data.columnTypes.length, opt_data.columnCalculations.length), Math.max(dataColumnStylesLength__soy4, opt_data.columnAttributes.length)));
  output += '<div class="grid-bar"  ' + ((rowCount__soy5 == 0) ? ' style="display: none;" ' : '') + '><h3>Columns  ' + org.swift.confluence.table.editor.addHelpContent({name: 'columnFormatting', id: 'columnFormatting', helpContent: '\x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/columnandrowstyles\x22 target\x3d\x22Advanced Tables Help\x22 \x3eColumn styles\x3c/a\x3e accepts one or more \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCSS\x3c/a\x3e properties to control formatting. e.g. background:lightyellow \x3cbr/\x3e\x3cbr/\x3e\x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/formatdata\x22 target\x3d\x22Advanced Tables Help\x22 \x3eColumn type\x3c/a\x3e is used with \x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/formatdata\x22  target\x3d\x22Advanced Tables Help\x22 \x3eTotal type\x3c/a\x3e to summarize and format the data. e.g. C\x22\x26#36;0.00\x22. Total type works only when \x3ci\x3eAuto total numeric columns\x3c/i\x3e is enabled under Numbering \x26 totaling.'}) + '</h3><div class="grid-bar-actions"><button class="aui-button add-grid-row" data-grid="#column-positions"><span class="aui-icon aui-icon-small aui-iconfont-add"></span> Add formatting</button><button class="aui-button aui-dropdown2-trigger aui-dropdown2-trigger-arrowless" aria-controls="column-settings-dropdown"><span class="aui-icon aui-icon-small aui-iconfont-configure">Configure display</span></button><aui-dropdown-menu id="column-settings-dropdown"><aui-item-checkbox id="show-hide-col-attrs" ' + ((opt_data.columnAttributes.length > 0) ? 'checked' : '') + '>Show column attributes</aui-item-checkbox><aui-item-checkbox id ="show-hide-empty-pos-rows" checked>Show empty columns</aui-item-checkbox></aui-dropdown-menu></div></div><div id="column-positions" class="scrollable-area appfire-grid"><div class="grid-empty-msg" ' + ((rowCount__soy5 > 0) ? ' style="display: none;" ' : '') + '>' + org.swift.confluence.table.editor.columnSettingsEmpty(null) + '</div>';
  var positionLimit26 = rowCount__soy5;
  for (var position26 = 0; position26 < positionLimit26; position26++) {
    output += org.swift.confluence.table.editor.columnPositionRow({position: position26, columnAttributes: opt_data.columnAttributes, columnCalculations: opt_data.columnCalculations, columnStyles: opt_data.columnStyles, columnTypes: opt_data.columnTypes, autoNumber: opt_data.autoNumber});
  }
  output += '</div><fieldset></div><!-- tabs-pane column-formatting close--><div class="tabs-pane" id="column-totaling"><div class="scrollable-tab-content"><fieldset><h3>Numbering</h3>' + org.swift.confluence.table.editor.toggleElement({name: 'autoNumber', value: opt_data.autoNumber, label: 'Insert auto number column', helpContent: 'Column numbering adds a column to your table that includes row numbers and can affect column formatting on your data columns if you specified your formatting using column numbers. '}) + org.swift.confluence.table.editor.textElement({name: 'autoNumberColStyles', type: 'text', value: opt_data.autoNumber && opt_data.columnStyles[0] != '' ? opt_data.columnStyles[0] : opt_data.autoNumberColStyles, label: 'Auto number column styles', topLabel: 'true', helpContent: 'Apply styles to the auto number column using \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCascading Style Sheets (CSS)\x3c/a\x3e when auto number is enabled.'}) + ((opt_data.macroName != 'attachment-table') ? org.swift.confluence.table.editor.toggleElement({name: 'autoNumberSort', value: opt_data.autoNumberSort, label: 'Enable sorting on auto number column'}) : '') + '<!-- TODO: where will this fit?? -->' + org.swift.confluence.table.editor.toggleElement({name: 'enableHeadingAttributes', value: opt_data.enableHeadingAttributes, label: 'Apply column attributes to header rows'}) + org.swift.confluence.table.editor.toggleElement({name: 'applyColStyleToCell', value: opt_data.applyColStyleToCell, label: 'Apply Column styles to column cells', helpContent: 'Enable this option to override the default styles and apply your style settings to the cells directly in each column. '}) + '</fieldset><fieldset><h3>Totaling</h3>' + org.swift.confluence.table.editor.toggleElement({name: 'autoTotal', value: opt_data.autoTotal, label: 'Auto total numeric columns'}) + '</fieldset></div></div><!-- tabs-pane column-totaling close--><div class="tabs-pane" id="column-sorting"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.toggleElement({name: 'enableSorting', value: opt_data.enableSorting, label: 'Enable column sorting'}) + org.swift.confluence.table.editor.textElement({name: 'sortColumn', value: opt_data.sortColumn, label: 'Automatically sort by this column', topLabel: 'true', helpContent: 'Column name or number for automatic sorting on first display.'}) + org.swift.confluence.table.editor.toggleElement({name: 'sortDescending', value: opt_data.sortDescending, label: 'Automatically sort in descending order'}) + org.swift.confluence.table.editor.toggleElement({name: 'sortIcon', value: opt_data.sortIcon, label: 'Display sort icon'}) + org.swift.confluence.table.editor.textElement({name: 'sortTip', value: opt_data.sortTip, label: 'Sort tip text', topLabel: 'true'}) + '</fieldset></div></div><!-- tabs-pane column-sorting close--></div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.columnSettingsPanel.soyTemplateName = 'org.swift.confluence.table.editor.columnSettingsPanel';
}


org.swift.confluence.table.editor.columnSettingsEmpty = function(opt_data, opt_ignored) {
  return '<div class="appfire-empty"><div class="appfire-empty-image"><svg id="Col_ATEmptyState" class="play" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 258.25 153.8"><path id="Col_Shadow" fill="none" stroke="#F0F0F0" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M34.62 152.3h191"/><linearGradient id="Col_Background_1_" gradientUnits="userSpaceOnUse" x1="-6117.154" y1="-753.957" x2="-6117.154" y2="-879.877" gradientTransform="translate(6246.278 880.56)"><stop offset="0" stop-color="#FFF"/><stop offset="1" stop-color="#F0FAFA"/></linearGradient><path id="Col_Background" fill="url(#Col_Background_1_)" d="M242.85 78.08c7.07 17.84 27.54 32.36-3.62 45.7-9.64 4.13-43.39-11.37-59.51-7.56-15.94 3.76-28.46 8.47-45.22 9.91-25.3 2.18-33.96-3.53-55.41-8.23-13.6-2.98-26.78 2.31-38.83.43-32.54-5.06-55.01-45.29-28.7-70.77 8.61-8.34 23.02-7.13 33.42-15.45C61.9 18.56 52.73 2.14 83.04 2.98c30.15.85 47.19 16.44 80.72 9.89 22.14-4.33 78.27-28.17 92.7 5.69 9.57 22.45-22.73 34.76-13.61 59.52z"/><g id="Col_Socket"><linearGradient id="Col_SVGID_1_" gradientUnits="userSpaceOnUse" x1="41.204" y1="856.587" x2="52.996" y2="877.013" gradientTransform="translate(0 -738)"><stop offset="0" stop-color="#FFF"/><stop offset=".5" stop-color="#F9F9F9"/><stop offset="1" stop-color="#F0F0F0"/></linearGradient><path fill="url(#Col_SVGID_1_)" d="M51.1 139.8h-8c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h8c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path fill="none" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M45.1 121.8v2M49.1 121.8v2"/><circle fill="#333" cx="47.1" cy="126.8" r="1"/><path fill="none" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M45.1 131v2M49.1 131v2"/><circle fill="#333" cx="47.1" cy="136" r="1"/></g><g id="Col_Plug"><circle id="Col_PlugEnd" fill="#333" cx="47.1" cy="133.8" r="4"/><path id="Col_PlugCord" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M73.12 101.8h-4c-2.8 0-5 2.2-5 5l-.02 38c0 2.8-2.2 5-5 5h-7c-2.8 0-5-2.2-5-5v-10"/><path id="Col_PlugStart" fill="#333" d="M74.12 97.8c-2.2 0-4 1.8-4 4s1.8 4 4 4v-8z"/></g><g id="Col_Table"><g id="Col_TableHanger" fill="none" stroke="#F0F0F0" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"><path d="M90.12 22.8v-21M186.12 22.8v-21"/></g><g id="Col_TableBG"><linearGradient id="Col_SVGID_2_" gradientUnits="userSpaceOnUse" x1="156.612" y1="146.621" x2="131.637" y2="4.981"><stop offset="0" stop-color="#FFB672"/><stop offset="1" stop-color="#FCD9BE"/></linearGradient><path fill="url(#Col_SVGID_2_)" d="M210.12 14.8h-134a2 2 0 0 0-2 2v118a2 2 0 0 0 2 2h136a2 2 0 0 0 2-2v-118a2 2 0 0 0-2-2h-2z"/><path opacity=".1" fill="#FFF" d="M78.12 20.8a2 2 0 0 1 2-2h134v-2a2 2 0 0 0-2-2h-136a2 2 0 0 0-2 2v118c0 1.1.9 2 2 2h2v-116z"/></g><g id="Col_LightOff4"><path fill="#F2F2F2" d="M180.13 130.8v-94a2 2 0 0 1 2-2h26a2 2 0 0 1 2 2v94a2 2 0 0 1-2 2h-26c-1.11 0-2-.89-2-2z"/><path opacity=".25" fill="#CCC" d="M195.63 132.8v-4.5h9.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-20c-.28 0-.5.22-.5.5s.22.5.5.5h9.5v4.5h1zM194.63 34.8v4.5h-9.5c-.28 0-.5.22-.5.5s.22.5.5.5h20c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-9.5v-4.5h-1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M185.13 127.8V39.79M195.13 39.79v88.01M205.14 39.79v88.01"/></g><g id="Col_LightOff3"><path fill="#F2F2F2" d="M146.13 130.8v-94a2 2 0 0 1 2-2h26a2 2 0 0 1 2 2v94a2 2 0 0 1-2 2h-26c-1.11 0-2-.89-2-2z"/><path opacity=".25" fill="#CCC" d="M161.63 132.8v-4.5h9.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-20c-.28 0-.5.22-.5.5s.22.5.5.5h9.5v4.5h1zM160.63 34.8v4.5h-9.5c-.28 0-.5.22-.5.5s.22.5.5.5h20c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-9.5v-4.5h-1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M151.13 127.8V39.79M161.13 39.79v88.01M171.14 39.79v88.01"/></g><g id="Col_LightOff2"><path fill="#F2F2F2" d="M112.12 130.8v-94a2 2 0 0 1 2-2h26a2 2 0 0 1 2 2v94a2 2 0 0 1-2 2h-26a2 2 0 0 1-2-2z"/><path opacity=".25" fill="#CCC" d="M127.62 132.8v-4.5h9.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-20c-.28 0-.5.22-.5.5s.22.5.5.5h9.5v4.5h1zM126.62 34.8v4.5h-9.5c-.28 0-.5.22-.5.5s.22.5.5.5h20c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-9.5v-4.5h-1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M117.13 127.8V39.79M127.13 39.79v88.01M137.14 39.79v88.01"/></g><g id="Col_LightOff1"><path fill="#F2F2F2" d="M78.12 130.8v-94a2 2 0 0 1 2-2h26a2 2 0 0 1 2 2v94a2 2 0 0 1-2 2h-26a2 2 0 0 1-2-2z"/><path opacity=".25" fill="#CCC" d="M93.62 132.8v-4.5h9.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-20c-.28 0-.5.22-.5.5s.22.5.5.5h9.5v4.5h1zM92.62 34.8v4.5h-9.5c-.28 0-.5.22-.5.5s.22.5.5.5h20c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-9.5v-4.5h-1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M83.13 127.8V39.79M93.13 39.79v88.01M103.14 39.79v88.01"/></g><g id="Col_LightOn1"><linearGradient id="Col_SVGID_3_" gradientUnits="userSpaceOnUse" x1="-574.875" y1="874.802" x2="-574.875" y2="844.802" gradientTransform="rotate(90 147.124 805.802)"><stop offset="0" stop-color="#89D8E5"/><stop offset=".024" stop-color="#8CDCEB"/><stop offset=".099" stop-color="#94E5F6"/><stop offset=".205" stop-color="#98EBFD"/><stop offset=".5" stop-color="#99ECFF"/><stop offset=".795" stop-color="#98EBFD"/><stop offset=".901" stop-color="#94E5F6"/><stop offset=".976" stop-color="#8CDCEB"/><stop offset="1" stop-color="#89D8E5"/></linearGradient><path fill="url(#Col_SVGID_3_)" d="M78.12 130.8v-94a2 2 0 0 1 2-2h26a2 2 0 0 1 2 2v94a2 2 0 0 1-2 2h-26a2 2 0 0 1-2-2z"/><g opacity=".5"><linearGradient id="Col_SVGID_4_" gradientUnits="userSpaceOnUse" x1="-574.884" y1="863.829" x2="-574.884" y2="855.801" gradientTransform="rotate(90 147.124 805.802)"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Col_SVGID_4_)" d="M89.1 39.79h8.03v88.02H89.1z"/></g><g opacity=".5"><linearGradient id="Col_SVGID_5_" gradientUnits="userSpaceOnUse" x1="-574.884" y1="873.815" x2="-574.884" y2="865.787" gradientTransform="rotate(90 147.124 805.802)"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Col_SVGID_5_)" d="M79.11 39.79h8.03v88.02h-8.03z"/></g><path opacity=".1" fill="#3DB2CB" d="M93.62 132.8v-4.5h9.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-20c-.28 0-.5.22-.5.5s.22.5.5.5h9.5v4.5h1zM92.62 34.8v4.5h-9.5c-.28 0-.5.22-.5.5s.22.5.5.5h20c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-9.5v-4.5h-1z"/><path opacity=".25" fill="none" stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M83.12 127.8V39.79M93.12 39.79v88.01"/><g opacity=".5"><linearGradient id="Col_SVGID_6_" gradientUnits="userSpaceOnUse" x1="-574.884" y1="853.815" x2="-574.884" y2="845.787" gradientTransform="rotate(90 147.124 805.802)"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Col_SVGID_6_)" d="M99.11 39.79h8.03v88.02h-8.03z"/></g><path opacity=".25" fill="none" stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M103.14 39.79v88.01"/></g></g><path fill="#FFF" d="M11.56 47.55c8.61-8.34 23.02-7.13 33.42-15.45C61.9 18.56 52.73 2.14 83.04 2.98c30.15.85 47.19 16.44 80.72 9.89 22.14-4.33 78.27-28.17 92.7 5.69.92 2.15 1.45 4.23 1.67 6.25V0H.13v70.86c.66-8.19 4.2-16.3 11.43-23.31z" id="Col_Mask"/></svg></div><div class="appfire-empty-content"><h3>Power up your columns</h3><p>Give your columns some character by applying a few simple settings.</p><p>Start with column number <input class="rows-to-add" type="number" min="0" max="30" value="1"></input></p><p class="error" style="color:#de350b; display: none;"">Enter a number between 0 and 30.</p><button class="start-formatting aui-button aui-button-primary">Start formatting</button></div></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.columnSettingsEmpty.soyTemplateName = 'org.swift.confluence.table.editor.columnSettingsEmpty';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/column-position-row.soy' */
// This file was automatically generated from column-position-row.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.columnPositionRow = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<div class="grid appfire-row"> <!-- row --><div class="col-1 row-header row-header-narrow">  \t\t<!-- row thumb cell --><h4 class="row-number">' + soy.$$escapeHtml(opt_data.position + 1) + '</h4></div>                        \t\t                <!-- row thumb cell --><div class="col-auto row-data">                       <!-- row data --><div class="grid show-hide-empty"><div class="col-md-auto" data-collapsible="col-md-auto"><div class="field-group"><label for="text-input">Column styles</label>' + ((opt_data.autoNumber) ? '<input class="text full-width-field row-data-element" type="text" name="columnStyles" title="Text input" ' + ((opt_data.columnStyles[opt_data.position + 1]) ? ' value="' + soy.$$escapeHtml(opt_data.columnStyles[opt_data.position + 1]) + '" ' : '') + '/>' : '<input class="text full-width-field row-data-element" type="text" name="columnStyles" title="Text input" ' + ((opt_data.columnStyles[opt_data.position]) ? ' value="' + soy.$$escapeHtml(opt_data.columnStyles[opt_data.position]) + '" ' : '') + '/>') + '</div></div>';
  var colType__soy24 = opt_data.columnTypes[opt_data.position] ? opt_data.columnTypes[opt_data.position] : '';
  output += '<div class="col-md-auto" data-collapsible="col-md-auto"><div class="field-group"><label for="columnTypes">Column type</label><input type="hidden" name="columnTypes" ' + ((colType__soy24) ? ' value="' + soy.$$escapeHtml(colType__soy24) + '" ' : '') + '/><aui-select class="column-types-select" can-create-values="true" id="column-types-select-' + soy.$$escapeHtml(opt_data.position) + '" ><aui-option ' + ((colType__soy24 == 'I' || colType__soy24 == 'i') ? ' selected ' : '') + ' value="I">Integer (I)</aui-option><aui-option ' + ((colType__soy24 == 'S' || colType__soy24 == 's') ? ' selected ' : '') + ' value="S">String (S)</aui-option><aui-option ' + ((colType__soy24 == 'F' || colType__soy24 == 'f') ? ' selected ' : '') + ' value="F">Numeric and float values (F)</aui-option><aui-option ' + ((colType__soy24 == 'FF' || colType__soy24 == 'ff') ? ' selected ' : '') + ' value="FF">Numeric with data formatting (FF)</aui-option><aui-option ' + ((colType__soy24 == 'FC' || colType__soy24 == 'fc') ? ' selected ' : '') + ' value="FC">Float with comma as decimal point (FC)</aui-option><aui-option ' + ((colType__soy24 == 'C' || colType__soy24 == 'c') ? ' selected ' : '') + ' value="C">Currency (C)</aui-option><aui-option ' + ((colType__soy24 == 'CC' || colType__soy24 == 'cc') ? ' selected ' : '') + ' value="CC">Currency with comma as decimal points (CC)</aui-option><aui-option ' + ((colType__soy24 == 'M' || colType__soy24 == 'm') ? ' selected ' : '') + ' value="M">Date (M)</aui-option><aui-option ' + ((colType__soy24 == 'D' || colType__soy24 == 'd') ? ' selected ' : '') + ' value="D">Date in the browser date format (D)</aui-option><aui-option ' + ((colType__soy24 == 'E' || colType__soy24 == 'e') ? ' selected ' : '') + ' value="E">Complex HTML elements like emotions or similar (E)</aui-option><aui-option ' + ((colType__soy24 == 'X' || colType__soy24 == 'x') ? ' selected ' : '') + ' value="X">Exclude this column from user selectable sorting (X)</aui-option><aui-option ' + ((colType__soy24 == 'H' || colType__soy24 == 'h') ? ' selected ' : '') + ' value="H">Hide the column (H)</aui-option>' + ((colType__soy24 && ! (('|I|S|F|FF|FC|C|CC|M|D|E|X|H|').indexOf('' + ('|' + colType__soy24 + '|')) != -1) && ! (('|i|s|f|ff|fc|c|cc|m|d|e|x|h|').indexOf('' + ('|' + colType__soy24 + '|')) != -1)) ? '<aui-option value="' + soy.$$escapeHtml(colType__soy24) + '" selected>' + soy.$$escapeHtml(colType__soy24) + '</aui-option>' : '') + '</aui-select></div></div><div class="col-sm-auto" data-collapsible="col-sm-auto"><div class="field-group">';
  var val__soy90 = opt_data.columnCalculations && opt_data.columnCalculations.length > 0 && opt_data.position < opt_data.columnCalculations.length ? opt_data.columnCalculations[opt_data.position] : '';
  output += '<label for="columnCalculations">Total type</label><input type="hidden" name="columnCalculations" ' + ((val__soy90) ? ' value="' + soy.$$escapeHtml(val__soy90) + '" ' : '') + ' /><aui-select class="column-calculations-select" can-create-values="true"><aui-option value="sum" ' + ((val__soy90 == 'sum') ? ' selected ' : '') + '>' + soy.$$escapeHtml('Sum') + '</aui-option><aui-option value="avg" ' + ((val__soy90 == 'avg') ? ' selected ' : '') + '>' + soy.$$escapeHtml('Average') + '</aui-option><aui-option value="max" ' + ((val__soy90 == 'max') ? ' selected ' : '') + '>' + soy.$$escapeHtml('Max') + '</aui-option><aui-option value="min" ' + ((val__soy90 == 'min') ? ' selected ' : '') + '>' + soy.$$escapeHtml('Min') + '</aui-option><aui-option value="avgignorezero" ' + ((val__soy90 == 'avgignorezero') ? ' selected ' : '') + '>' + soy.$$escapeHtml('Average (ignore zeros and blanks)') + '</aui-option>' + ((val__soy90 && ! (('|sum|avg|avgignorezero|').indexOf('' + ('|' + val__soy90 + '|')) != -1)) ? '<aui-option value="' + soy.$$escapeHtml(val__soy90) + '" selected>' + soy.$$escapeHtml(val__soy90) + '</aui-option>' : '') + '</aui-select></div></div><div class="col-sm-auto column-attributes" data-collapsible="col-sm-auto"  ' + ((opt_data.columnAttributes.length == 0) ? ' style="display:none;" ' : '') + '><div class="field-group"><label for="text-input">Column attributes</label><input class="text full-width-field row-data-element" type="text" name="columnAttributes" title="Text input"  ' + ((opt_data.columnAttributes[opt_data.position]) ? ' value="' + soy.$$escapeHtml(opt_data.columnAttributes[opt_data.position]) + '" ' : '') + '/></div></div></div></div>                                              <!-- row data -->' + org.swift.confluence.editor.commonGridRowActions({controlId: 'col-position-action-' + opt_data.position}) + '</div>                                                              <!-- row -->';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.columnPositionRow.soyTemplateName = 'org.swift.confluence.table.editor.columnPositionRow';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/row-position-row.soy' */
// This file was automatically generated from row-position-row.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.rowPositionRow = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="grid appfire-row"> <!-- row --><div class="col-1 row-header row-header-narrow">  \t\t<!-- row thumb cell --><h4 class="row-number">' + soy.$$escapeHtml(opt_data.position) + '</h4></div>                        \t\t<!-- row thumb cell --><div class="col-auto row-data"> <!-- row content --><div class="grid"><div class="col-md-auto" data-collapsible="col-md-auto"><div class="field-group"><label for="text-input">Row styles</label><input class="text full-width-field row-data-element" type="text" name="rowStyles" title="Text input" ' + ((opt_data.rowStyles[opt_data.position]) ? ' value="' + soy.$$escapeHtml(opt_data.rowStyles[opt_data.position]) + '" ' : '') + '></div></div></div></div>                  <!-- row content -->' + org.swift.confluence.editor.commonGridRowActions({controlId: 'row-position-action-' + opt_data.position}) + '</div>                            \t<!-- row -->';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.rowPositionRow.soyTemplateName = 'org.swift.confluence.table.editor.rowPositionRow';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/row-settings-panel.soy' */
// This file was automatically generated from row-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.rowSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#data-row-formatting">' + soy.$$escapeHtml('Data rows') + '</a></li><li class="menu-item"><a href="#hdr-row-formatting">' + ((opt_data.footing >= 0) ? 'Header & Footer rows' : 'Header rows') + '</a></li><li class="menu-item"><a href="#row-advanced">Advanced settings</a></li></ul><div class="tabs-pane active-pane" id="data-row-formatting"><fieldset class="appfire-grid-set">';
  var rowCount__soy12 = Math.max(0, opt_data.rowStyles.length);
  output += '<div class="grid-bar" ' + ((rowCount__soy12 < 2) ? ' style="display: none;" ' : '') + '><h3>Repeating row formatting ' + org.swift.confluence.table.editor.addHelpContent({name: 'rowFormatting', id: 'rowFormatting', helpContent: '\x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/columnandrowstyles\x22 target\x3d\x22Advanced Tables Help\x22 \x3eRow styles\x3c/a\x3e accepts one or more \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCSS\x3c/a\x3e properties to control formatting. Row styles define a repeating style for your data rows when you specify two or more row styles.'}) + '</h3><div class="grid-bar-actions"><button class="aui-button add-grid-row" data-grid="#row-positions" resolved=""><span class="aui-icon aui-icon-small aui-iconfont-add"></span> Add formatting</button></div></div><div id="row-positions" class="scrollable-area appfire-grid"><div class="grid-empty-msg" ' + ((rowCount__soy12 > 1) ? ' style="display: none;" ' : '') + '>' + org.swift.confluence.table.editor.rowSettingsEmpty(null) + '</div>';
  var positionLimit29 = rowCount__soy12;
  for (var position29 = 1; position29 < positionLimit29; position29++) {
    output += org.swift.confluence.table.editor.rowPositionRow({position: position29, rowStyles: opt_data.rowStyles});
  }
  output += '</div></fieldset></div><div class="tabs-pane" id="hdr-row-formatting"><div class="scrollable-tab-content"><fieldset><h3>Header rows</h3>' + ((opt_data.macroName != 'attachment-table') ? '<!-- TODO: for number elements, add style to make it inline with design -->' + org.swift.confluence.table.editor.textElement({name: 'heading', type: 'number', value: opt_data.heading, label: 'Number of header rows', topLabel: 'true'}) : '') + org.swift.confluence.table.editor.textElement({name: 'headerRowStyles', type: 'text', value: opt_data.rowStyles[0], label: 'Header row styles', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://apps.appf.re/tbl/doc/p2/userguide/columnandrowstyles\x22 target\x3d\x22Advanced Tables Help\x22 \x3eHeader row styles\x3c/a\x3e accepts one or more \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCSS\x3c/a\x3e properties to control formatting.  Formatting is applied to all header rows in your table.'}) + ((opt_data.macroName == 'json-table' || opt_data.macroName == 'table-plus' || opt_data.macroName == 'csv') ? org.swift.confluence.table.editor.toggleElement({name: 'hideHeader', value: opt_data.hideHeader, label: 'Hide header row(s)'}) : '') + ((opt_data.footing >= 0) ? '<h3>Footer rows</h3>' + org.swift.confluence.table.editor.textElement({name: 'footing', type: 'number', value: opt_data.footing, label: 'Number of footer rows', topLabel: 'true'}) : '') + ((opt_data.macroName == 'attachment-table' || opt_data.macroName == 'json-table' || opt_data.macroName == 'table-plus' || opt_data.macroName == 'csv') ? org.swift.confluence.table.editor.textElement({name: 'autoTotalRowStyle', type: 'text', value: opt_data.autoTotalRowStyle, label: 'Auto total row styles', topLabel: 'true', helpContent: 'Apply styles to auto total row using \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCascading Style Sheets (CSS)\x3c/a\x3e when auto total is enabled.'}) : '') + '</fieldset></div></div><div class="tabs-pane" id="row-advanced"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.toggleElement({name: 'retainRowStyleOrder', value: opt_data.retainRowStyleOrder, label: 'Retain row style order after re-sorting'}) + org.swift.confluence.table.editor.toggleElement({name: 'applyRowStyleToCell', value: opt_data.applyRowStyleToCell, label: 'Apply Row styles to row cells', helpContent: 'Enable this option to override the default styles and apply your style settings to the cells directly in each row. '}) + org.swift.confluence.table.editor.toggleElement({name: 'enableHighlighting', value: opt_data.enableHighlighting, label: 'Enable row highlighting on mouse over'}) + org.swift.confluence.table.editor.textElement({name: 'highlightColor', type: 'text', value: opt_data.highlightColor, label: 'Highlight color', topLabel: 'true', helpContent: 'Highlight color shown when mouse is over a row. Use either color name or HEX value. \x3cbr\x3e \x3cb\x3eExample:\x3c/b\x3e lightgoldenrodyellow or #FAFAD2'}) + '</fieldset></div></div></div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.rowSettingsPanel.soyTemplateName = 'org.swift.confluence.table.editor.rowSettingsPanel';
}


org.swift.confluence.table.editor.rowSettingsEmpty = function(opt_data, opt_ignored) {
  return '<div class="appfire-empty"><div class="appfire-empty-image"><svg id="Row_ATEmptyState" class="play" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 258.2 159.8"><path id="Row_Shadow" fill="none" stroke="#F0F0F0" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M24.6 158.3h195"/><linearGradient id="Row_Background_1_" gradientUnits="userSpaceOnUse" x1="-6117.154" y1="-753.957" x2="-6117.154" y2="-880.561" gradientTransform="translate(6246.278 880.56)"><stop offset="0" stop-color="#FFF"/><stop offset="1" stop-color="#F0FAFA"/></linearGradient><path id="Row_Background" fill="url(#Row_Background_1_)" d="M242.8 78.1c7.1 17.8 27.5 32.4-3.6 45.7-9.6 4.1-43.4-11.4-59.5-7.6-15.9 3.8-28.5 8.5-45.2 9.9-25.3 2.2-34-3.5-55.4-8.2-13.6-3-26.8 2.3-38.8.4-32.5-5.1-55-45.3-28.7-70.8 8.6-8.3 23-7.1 33.4-15.5C61.9 18.6 52.7 2.1 83 3c30.1.8 47.2 18.4 80.7 11.9 22.1-4.3 78.3-32.2 92.7 1.7 9.6 22.4-22.7 36.7-13.6 61.5z"/><g id="Row_Socket"><linearGradient id="Row_SVGID_1_" gradientUnits="userSpaceOnUse" x1="35.227" y1="124.587" x2="47.022" y2="145.016"><stop offset="0" stop-color="#FFF"/><stop offset=".5" stop-color="#F9F9F9"/><stop offset="1" stop-color="#F0F0F0"/></linearGradient><path fill="url(#Row_SVGID_1_)" d="M45.1 145.8h-8c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h8c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path fill="none" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M39.1 127.8v2M43.1 127.8v2"/><circle fill="#333" cx="41.1" cy="132.8" r="1"/><path fill="none" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M39.1 137v2M43.1 137v2"/><circle fill="#333" cx="41.1" cy="142" r="1"/></g><g id="Row_Plug"><circle id="Row_PlugEnd" fill="#333" cx="41.1" cy="139.8" r="4"/><path id="Row_PlugCord" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M67.1 111.8h-4c-2.8 0-5 2.2-5 5v34c0 2.8-2.2 5-5 5h-7c-2.8 0-5-2.2-5-5v-10"/><path id="Row_PlugStart" fill="#333" d="M68.1 107.8c-2.2 0-4 1.8-4 4s1.8 4 4 4v-8z"/></g><g id="Row_Table"><g id="Row_TableHanger" fill="none" stroke="#F0F0F0" stroke-width="3" stroke-linejoin="round" stroke-miterlimit="10"><path d="M90.1 22.8v-23M186.1 22.8v-23"/></g><g id="Row_TableBG"><linearGradient id="Row_SVGID_2_" gradientUnits="userSpaceOnUse" x1="150.587" y1="12.381" x2="125.613" y2="154.019" gradientTransform="matrix(1 0 0 -1 0 162)"><stop offset="0" stop-color="#FFB672"/><stop offset="1" stop-color="#FCD9BE"/></linearGradient><path fill="url(#Row_SVGID_2_)" d="M204.1 17.8h-134c-1.1 0-2 .9-2 2v118c0 1.1.9 2 2 2h136c1.1 0 2-.9 2-2v-118c0-1.1-.9-2-2-2h-2z"/><path opacity=".1" fill="#FFF" d="M72.1 23.8c0-1.1.9-2 2-2h134v-2c0-1.1-.9-2-2-2h-136c-1.1 0-2 .9-2 2v118c0 1.1.9 2 2 2h2v-116z"/></g><g id="Row_Light4Off"><path fill="#F2F2F2" d="M202.1 135.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path opacity=".25" fill="#CCC" d="M204.1 124.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 125.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M199.1 129.8h-122M77.1 119.8h122"/></g><g id="Row_Light3Off"><path fill="#F2F2F2" d="M202.1 109.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path opacity=".25" fill="#CCC" d="M204.1 98.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 99.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M199.1 103.8h-122M77.1 93.8h122"/></g><g id="Row_Light2Off"><path fill="#F2F2F2" d="M202.1 83.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path opacity=".25" fill="#CCC" d="M204.1 72.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 73.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M199.1 77.8h-122M77.1 67.8h122"/></g><g id="Row_Light1Off"><path fill="#F2F2F2" d="M202.1 57.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path opacity=".25" fill="#CCC" d="M204.1 46.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 47.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M199.1 51.8h-122M77.1 41.8h122"/></g><g id="Row_LightOn3"><linearGradient id="Row_SVGID_3_" gradientUnits="userSpaceOnUse" x1="138.1" y1="109.8" x2="138.1" y2="87.8"><stop offset="0" stop-color="#89D8E5"/><stop offset=".024" stop-color="#8CDCEB"/><stop offset=".099" stop-color="#94E5F6"/><stop offset=".205" stop-color="#98EBFD"/><stop offset=".5" stop-color="#99ECFF"/><stop offset=".795" stop-color="#98EBFD"/><stop offset=".901" stop-color="#94E5F6"/><stop offset=".976" stop-color="#8CDCEB"/><stop offset="1" stop-color="#89D8E5"/></linearGradient><path fill="url(#Row_SVGID_3_)" d="M202.1 109.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><g opacity=".5"><linearGradient id="Row_SVGID_4_" gradientUnits="userSpaceOnUse" x1="138.092" y1="97.828" x2="138.092" y2="89.8"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Row_SVGID_4_)" d="M77.1 89.8h122v8h-122z"/></g><g opacity=".5"><linearGradient id="Row_SVGID_5_" gradientUnits="userSpaceOnUse" x1="138.092" y1="107.814" x2="138.092" y2="99.786"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Row_SVGID_5_)" d="M77.1 99.8h122v8h-122z"/></g><path opacity=".1" fill="#3DB2CB" d="M204.1 98.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 99.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path opacity=".25" fill="none" stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M199.1 103.8h-122M77.1 93.8h122"/></g><g id="Row_LightOn1"><linearGradient id="Row_SVGID_6_" gradientUnits="userSpaceOnUse" x1="138.1" y1="57.8" x2="138.1" y2="35.8"><stop offset="0" stop-color="#89D8E5"/><stop offset=".024" stop-color="#8CDCEB"/><stop offset=".099" stop-color="#94E5F6"/><stop offset=".205" stop-color="#98EBFD"/><stop offset=".5" stop-color="#99ECFF"/><stop offset=".795" stop-color="#98EBFD"/><stop offset=".901" stop-color="#94E5F6"/><stop offset=".976" stop-color="#8CDCEB"/><stop offset="1" stop-color="#89D8E5"/></linearGradient><path fill="url(#Row_SVGID_6_)" d="M202.1 57.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><g opacity=".5"><linearGradient id="Row_SVGID_7_" gradientUnits="userSpaceOnUse" x1="138.092" y1="45.828" x2="138.092" y2="37.8"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Row_SVGID_7_)" d="M77.1 37.8h122v8h-122z"/></g><g opacity=".5"><linearGradient id="Row_SVGID_8_" gradientUnits="userSpaceOnUse" x1="138.092" y1="55.814" x2="138.092" y2="47.786"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Row_SVGID_8_)" d="M77.1 47.8h122v8h-122z"/></g><path opacity=".1" fill="#3DB2CB" d="M204.1 46.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 47.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path opacity=".25" fill="none" stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M199.1 51.8h-122M77.1 41.8h122"/></g></g><path id="Row_Mask" fill="#FFF" d="M11.6 47.6c8.6-8.3 23-7.1 33.4-15.5C61.9 18.6 52.7 2.1 83 3c30.1.8 47.2 18.4 80.7 11.9 22.1-4.3 78.3-32.2 92.7 1.7.3.6.5 1.2.7 1.8V-.2H.1v68l.4-.1c1.3-7.1 4.8-14.1 11.1-20.1z"/></svg></div><div class="appfire-empty-content"><h3>Make your rows shine</h3><p>Adding some repeating row styles can brighten up your data and make it easier to read.</p><p>Start with <input class="rows-to-add" type="number" min="0" max="30" value="2"></input> alternating row styles.</p><p class="error" style="color:#de350b; display: none;"">Enter a number between 0 and 30.</p><button class="start-formatting aui-button aui-button-primary">Start styling</button></div></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.rowSettingsEmpty.soyTemplateName = 'org.swift.confluence.table.editor.rowSettingsEmpty';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/data-location-template.soy' */
// This file was automatically generated from data-location-template.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.dataLocationFields = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="aui-group"><div class="field-group"><label for="dataLocation">' + soy.$$escapeHtml('Method of locating script') + '</label><select class="select  appfire-table-datalocation  appfire-editor-select" id="dataLocation" name="dataLocation" data-macroname="' + soy.$$escapeHtml(opt_data.macroName) + '"><option value="" ' + ((! opt_data.attachmentPage && ! opt_data.filename && ! opt_data.template && ! opt_data.url) ? ' selected ' : '') + '>None</option>' + ((opt_data.url != null) ? ' <option value="url" ' + ((opt_data.url) ? ' selected ' : '') + '>URL</option> ' : '') + '<!-- If url supported, this option is shown. And if supported and url given i.e dataLocation = url, and if attachment also given, then attachment takes precedence -->' + ((opt_data.macroName == 'csv' || opt_data.macroName == 'json-table') ? '<option value="profile" ' + ((opt_data.profile) ? ' selected ' : '') + '>Profile</option>' : '') + '<option value="attachment" ' + ((opt_data.attachmentPage) ? ' selected ' : '') + '>Attachment</option><option value="filename" ' + ((opt_data.filename) ? ' selected ' : '') + '>Filename</option><option value="template" ' + ((opt_data.template) ? ' selected ' : '') + '>Template</option></select></div></div><!--  Profile related fields start-->' + ((opt_data.macroName == 'csv' || opt_data.macroName == 'json-table') ? '<div class="aui-group profile-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'profile', value: opt_data.profile, label: 'Profiles', topLabel: 'true', required: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'profileUrl', value: opt_data.profileUrl, label: 'URL of  ' + soy.$$escapeHtml(opt_data.dataTypeToLocate) + '  data', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'timeout', type: 'number', value: opt_data.timeout, label: 'Connection timeout (milliseconds)', topLabel: 'true'}) + '</div>' : '') + '<!-- Profile related fields done--><!-- if URL , then show url, username, pwd, connection timeout fields. Note that in some apps locating source data through Url is not supported, in those cases these fields wont be loaded. --><!-- URL related fields start-->' + ((opt_data.url != null) ? '<div class="aui-group url-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'url', value: opt_data.url, label: 'URL of  ' + soy.$$escapeHtml(opt_data.dataTypeToLocate) + '  data', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'user', value: opt_data.user, label: 'Username (if required)', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'password', type: 'password', value: opt_data.password, label: 'Password (if required)', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'timeout', type: 'number', value: opt_data.timeout, label: 'Connection timeout (milliseconds)', topLabel: 'true'}) + '</div>' : '') + '<!-- URL related fields done--><!-- attachment related fields start --><div class="aui-group attachment-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'attSpace', inputClass: 'datalocation-space long-field', value: opt_data.attSpace, label: 'Space', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'attPage', inputClass: 'datalocation-page long-field', value: opt_data.attPage, label: 'Page', topLabel: 'true', helpContent: 'The content can be loaded from a page attachment. You can also enter special values of @self, @home, or @parent. You cannot preview results for unsaved pages.'}) + org.swift.confluence.table.editor.textElement({name: 'attachment', inputClass: 'datalocation-attachment long-field', value: opt_data.attachment, label: 'Attachment', topLabel: 'true'}) + '</div><!-- attachment related fields end--><!-- filename related fields start--><div class="aui-group filename-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'filename', value: opt_data.filename, label: 'File name', topLabel: 'true', helpContent: 'The content can be loaded from files from the \x22script\x22 folder in your Confluence home directory. You can also specify the subdirectories.'}) + '</div><!-- filename related fields end --><!-- template related fields start--><div class="aui-group template-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'template', value: opt_data.template, label: 'Name of template', topLabel: 'true', helpContent: 'The content is read from either a global page template or from a space template. Enter \x22global_template_name\x22 or \x22space:template_name\x22. You cannot preview results for unsaved templates.'}) + '</div><!-- template related fields end-->';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.dataLocationFields.soyTemplateName = 'org.swift.confluence.table.editor.dataLocationFields';
}


org.swift.confluence.table.editor.macroBodyFilledMessage = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="field-group appfire-macroBody-filled-message" ' + ((opt_data.macroBody == '') ? ' style="display: none;" ' : '') + '><label><span class="aui-icon aui-icon-small  aui-iconfont-info">help</span><span> ' + soy.$$escapeHtml('Note that the data from the above data source will be appended to the data provided in macro body.') + ' </span></label></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.macroBodyFilledMessage.soyTemplateName = 'org.swift.confluence.table.editor.macroBodyFilledMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = 'editor/js/appfire-custom-editor.js' */
// TODO - copyright 
// 
(function(appcme, $, undefined) {
    'use strict';


    // ------------------------------------------------------------------------------------------
    //                  Common Editor Grid Handlers 
    // ------------------------------------------------------------------------------------------
    //
    //      The following handlers are available by default for all grid controls in the dialog.  
    //      You just need to be sure and apply the correct styles and you'll get the following 
    //      behaviors in your grid. 
    //      A row in the grid is demarked by a class of ".appfire-row".  It must be contained 
    //      in an ".appfire-grid".  
    //
    // Global Grid Handlers - act upon the full grid
    //      - Add a row: This requires an ".add-grid-row" action that is included 
    //        as part of the ".grid-bar".  The grid to work against must be added as a 
    //        data element(data-grid="#row-positions") to the button. This is the selector 
    //        for the grid.  
    //        The ".appfire-grid" must also have a jQuery data object with a "masterGridRow" 
    //        key on it. Ths is the grid row inserted at the end of the grid.    
    //
    // Grid Row Handlers- actions on each row of the grid
    //      - Add row above: Adds the "masterGridRow" above the current row
    //        and the grid is renumbered. 
    //      - Add row below: Adds the "masterGridRow" below the current row 
    //        and the grid is renumbered.  
    //      - Copy row: Copies the current row and stores it on the grid as a
    //        jQuery data object keyed with "copySourceGridRow" to be used later
    //        to paste a row. 
    //      - Paste row: If a row has been copied then it is pasted below the current
    //        row and the grid is renumbered.
    //      - Move row up: Moves the current row up one position.
    //      - Move row down: Moves the current row down one position. 
    //      - Clear row: Clears all input elements in the current row.  Checkboxes 
    //        are unchecked and select lists are unselected! 
    //      - Delete row: Deletes the current row and renumbers the grid. 
    // 
    // Common Editor Grid Behaviors - things that happen after commons actions on the grid occur. 
    //      - If the grid has ".row-number" elements they will get renumbered automatically.
    //      - If the grid has ".row-actions" they will be updated automatically to hook up 
    //        the aria-controls with the aui-dropdown-menu with a unique id.  Don't use the id 
    //        for anything but row actions.  
    //
    // Common Events - The following events are generated from the common editor.  Typically you 
    //        will want to filter these event using a selector based on the macro name.  The 
    //        macro name is available on the dialog as a data attribute. 
    //        e.g. [data-appfire-macro-name='csv']
    //
    //          appfireEditorAfterPreviewHide
    //          appfireEditorAfterPreviewShow
    //          appfireEditorBeforeSave
    //          appfireEditorBeforePreview
    //          appfireEditorBeforeSerialize
    //          appfireEditorBeforePreviewSerialize
    //          appfireEditorBeforeShow
    //          appfireEditorAfterShow
    //          appfireEditorGridAddRowAfterShow
    //          appfireEditorGridAddRowAfterShow
    //          appfireEditorGridAddRowAfterShow
    //          appfireEditorGridAddRowAfterShow
    //          appfireEditorGridAddRowBeforeShow
    //          appfireEditorGridAddRowBeforeShow
    //          appfireEditorGridAddRowBeforeShow
    //          appfireEditorGridAddRowBeforeShow
    //          appfireEditorGridDeleteRow
    //          appfireEditorGridMoveRowDown
    //          appfireEditorGridMoveRowUp
    // ------------------------------------------------------------------------------------------

    $(document).on("click", ".add-grid-row", function() {
        var $grid = $($(this).data("grid"));
        if ($grid){
            var $row = $grid.data("masterGridRow"); 
            appcme.addGridRow($grid, $row);
        }
        return false;
    });

    $(document).on("click", ".add-grid-row-above", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");            
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        var $grid = $currentRow.closest(".appfire-grid");
        var $row = $grid.data("masterGridRow"); 

        if ($row) {
            $row = $row.clone2().hide();

            var uniqueId = appcme.uniqueId();
            var rowActions = $row.find(".row-actions");
            rowActions.find("button[aria-controls]").attr("aria-controls", uniqueId);
            rowActions.find("aui-dropdown-menu").attr("id" , uniqueId);

            $currentRow.before($row);
            appcme.numberGridRows($grid);
            appcme.scrollAndFocusToNewRow($grid, $row);
            $row.trigger('appfireEditorGridAddRowBeforeShow', [$row]);
            $row.show().trigger('appfireEditorGridAddRowAfterShow', [$row]);    
        }
    });

    $(document).on("click", ".add-grid-row-below", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        var $grid = $currentRow.closest(".appfire-grid");
        var $row = $grid.data("masterGridRow"); 

        if ($row) {
            $row = $row.clone2().hide();

            var uniqueId = appcme.uniqueId();
            var rowActions = $row.find(".row-actions");
            rowActions.find("button[aria-controls]").attr("aria-controls", uniqueId);
            rowActions.find("aui-dropdown-menu").attr("id" , uniqueId);

            $currentRow.after($row);
            appcme.numberGridRows($grid);
            appcme.scrollAndFocusToNewRow($grid, $row);
            $row.trigger('appfireEditorGridAddRowBeforeShow', [$row]);
            $row.show().trigger('appfireEditorGridAddRowAfterShow', [$row]);    
        }
    });

    $(document).on("click", ".paste-grid-row", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        var $grid = $currentRow.closest(".appfire-grid");
        var $row = $grid.data("copySourceGridRow");

        if ($row) {     
            var $clone =  $row.clone2().hide();

            var uniqueId = appcme.uniqueId();
            var rowActions = $clone.find(".row-actions");
            rowActions.find("button[aria-controls]").attr("aria-controls", uniqueId);
            rowActions.find("aui-dropdown-menu").attr("id" , uniqueId);

            $currentRow.before($clone);
            appcme.numberGridRows($grid);
            appcme.scrollAndFocusToNewRow($grid, $row);
            $clone.trigger('appfireEditorGridAddRowBeforeShow', [$clone]);
            $clone.show().trigger('appfireEditorGridAddRowAfterShow', [$clone]); 
        }
    });

    $(document).on("click", ".copy-grid-row", function() {
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        var $grid = $currentRow.closest(".appfire-grid");
        $grid.data("copySourceGridRow", $currentRow.clone2());
    });

    $(document).on("click", ".clear-grid-row", function() {
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        $currentRow.find(":input").not(':button, :submit, :reset')
            .val('') 
            .prop('checked', false)
            .prop('selected', false);
    });

    $(document).on("click", ".delete-grid-row", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        var $grid = $currentRow.closest(".appfire-grid");
        $currentRow.remove();
        if ($grid.find(".appfire-row").length > 0 ) {
            appcme.numberGridRows($grid);
        }
        $grid.trigger('appfireEditorGridDeleteRow', [$currentRow]);
    });
    
    $(document).on("click", ".move-grid-row-up", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row");
        $currentRow.insertBefore($currentRow.prev());
        $currentRow.trigger('appfireEditorGridMoveRowUp', [$currentRow]);
    });
    
    $(document).on("click", ".move-grid-row-down", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row");
        $currentRow.insertAfter($currentRow.next());
        $currentRow.trigger('appfireEditorGridMoveRowDown', [$currentRow]);
    });

    /**
     * This handler is here for form validation. 
     */
    $(document).on("focus", ".form-error", function() {
        var $this = $(this);
        $this.removeClass("form-error");
        // if no other form errors clear the error icon 
        if ( !$this.closest("form").find(".form-error").length ) {
            $("#show-editor-error").hide();
        }
    });

    $(document).on('click', '.appfire-navigation [data-index]', function(evt) {
        var $this = $(this), panes = $this.closest('.aui-dialog2').find('.content-panel'), pane = $(panes.get($this.data('index')));

        $this.addClass('selected').siblings().removeClass('selected');
        panes.hide();
        pane.fadeIn();

        return false;
    }).on('click', '.appfire-navigation [data-url]', function(evt) {
        window.open($(this).data('url'), '_blank'); // open url in new tab
    });
    
    /**
     * Set the value of custom toggle element based on which option chosen
     */
    $(document).on('click', '.appfire-custom-toggle', function(evt) {
        evt.preventDefault();
        var $b = $(evt.target);
        $(this).find("#"+$b.parent().attr("id")).val($b.val());
        $b.attr("aria-pressed", "true");
        $b.siblings(".aui-button").attr("aria-pressed", "false");
    });

    $(document).on('appfireEditorAfterShow appfireEditorAfterPreviewShow appfireEditorAfterPreviewHide', function() {

        // TODO: revisit this hack work-around in order to get the preview icons in MS Edge to work correctly. 
        // Leaving this code here for now. 

        //$(".appfire .appfire-navigation .secondary").css("position", "absolute");
        //$(".appfire .appfire-preview-actions .secondary").css("position", "absolute");

        // $(".appfire .appfire-navigation .secondary").hide();
        // $(".appfire .appfire-preview-actions .secondary").hide();

        // $(".appfire .appfire-navigation .secondary").show();
        // $(".appfire .appfire-preview-actions .secondary").show();
    });
    
    //
    // I've been trying to enable and disabled the paste action if nothing has been copied 
    // but can't seem to get it working correctly. 
    //
    // $(document).on("hover", ".row-actions > button", function (evt) { 
    //     if ( evt.type == "mouseenter") {
    //         var $button = $(this);
    //         var id = $button.attr("aria-controls"); 
    //         var $pasteAction = $("#"+id).find(".paste-grid-row");
    //         var $grid = $button.closest(".appfire-grid");
    //         if ($pasteAction && $grid) {
    //             if ($grid.data("copySourceGridRow")) {
    //                 $pasteAction.prop("disabled", false);
    //                 $pasteAction.removeAttr("disabled");
    //             } else {
    //                 $pasteAction.prop("disabled", true);
    //                 $pasteAction.attr("disabled", "disabled");
    //             }
    //         } 
    //     }
    // });

    /**
     * This is basically the jQuery clone function but also takes care of cloning 
     * select lists and setting the proper selected values. For some reason jQuery
     * clone doesn't do that. 
     * We could have replaced the jquery clone but thought this was safer. 
     */
    (function($,undefined) {
        $.fn.clone2 = function(withDataAndEvents, deepWithDataAndEvents) {
            var $clone = this.clone(withDataAndEvents, deepWithDataAndEvents);
            var $origSelects = $('select', this);
            var $clonedSelects = $('select', $clone);
            $('select', this).each(function(i) {
                $clonedSelects.eq(i).val($(this).val());
            });
            return $clone;
        }
    })(jQuery);

    /**
     * Adds the $row to the $grid at the end.
     * @param {jQuery Object} $grid : Grid selector 
     * @param {jQuery Object} $row  : Row selector 
     */
    appcme.addGridRow = function($grid, $row) {
        appcme.clearValidationErrors($grid.closest("form"));
        
        if ($row) {
            $row = $row.clone2().hide();

            var uniqueId = appcme.uniqueId();
            var rowActions = $row.find(".row-actions");
            rowActions.find("button[aria-controls]").attr("aria-controls", uniqueId);
            rowActions.find("aui-dropdown-menu").attr("id" , uniqueId);

            $grid.append($row);
            appcme.numberGridRows($grid);
            appcme.scrollAndFocusToNewRow($grid, $row);
            $row.trigger('appfireEditorGridAddRowBeforeShow', [$row]);
            $row.show().trigger('appfireEditorGridAddRowAfterShow', [$row]);
        }
        return $row;
    }
    
    /**
     * Updates row numbers on the grid that is passed. 
     * @param {jQuery Object} $grid : Grid selector 
     */
    appcme.numberGridRows = function($grid) {
        $grid.find(".row-number").each(function(i) {
            $(this).text(i+1);
          });
    }
    
    /**
     * Generates a random unique id that can be used for element ids. 
     */
    appcme.uniqueId = function() {
        // Loop to be sure id is unique before returning 
        var id; 
        do {
            id = (Date.now().toString(36) + Math.random().toString(36).substr(2, 5)).toUpperCase();
        }
        while ($("#"+id).length);
        return id;
    }

    /**
     * Takes a text string in standard URL-encoded notation format and converts it into property list.  
     * If passed it uses the defaultParms to determine the native parameter type and default value
     * for each parm.  If a parm value matches the defaultValue it is removed from the map.
     * This handles all parm types except non-empty arrays for the default values. If you want support 
     * for arrays with something other than an empty array that support will need to be added 
     * at some point. An array type form element is typically a repeating id, such as columnStyles in AT. 
     * You actually get multiple parms by the same id in the serialized form. 
     * 
     * @param  {string}         parms           [Parameter string of form parms in URL-encoded format]
     * @param  {property list}  defaultParms    [Default values for the parms.  ]
     * @return {property list}                  [A cleansed list of formally typed parameters]
     */
    appcme.parseParameters = function(parms, defaultParms) {
        var result = {};
        var defaultMatches = [];
        if (parms) {
            var parmsAry = parms.split('&');
            $.each(parmsAry, function(i, pair) {
                if (pair) {
                    pair = appcme.splitFirst(pair, "="); //Split only by first occurrence of '='. Ex: columnAttributes=style="border:5px solid green;" fails with regular split.
                    var parmName = pair[0];
                    var val =  window.decodeURIComponent(pair[1].replace(/\++/g, '%20'));
     
                    /** 
                     * If the parm has already been processed and is in the results
                     * don't further process the parm.  
                     */
                    if (!result[parmName]) {
    
                        /** 
                         * if there are default parms sent in then check if the values from
                         * the form match the default vals. if there is match then don't add the form
                         * value to the results.  
                         */
    
                        if (defaultParms) {
    
                            /** grab the default value */
                            var defaultVal = defaultParms[parmName];
    
                            /** 
                             * Arrays have special processing. Because there could be multiple form 
                             * elements for an array we need to be sure and pull each one from the form and 
                             * create a comma-separated list for the return value.  
                             *
                             * Example: &a=1&a=2&a=3 results in a parm of "a=1,2,3"  
                             */
                            if ($.isArray(defaultVal)) {
    
                                var parmVals = "";
    
                                /** 
                                 * Loop through the parms again looking for only matching parms to the 
                                 * array parm.  
                                 *  
                                 * This is a bit of a hack since we are looping through the values in the form
                                 * and now we loop through them again looking for array matches.  
                                 */
                                var x = $.each(parmsAry, function(y, pairAry) {
                                    var valAry = appcme.splitFirst(pairAry, "="); //Split only by first occurrence of '='
                                    if (parmName == valAry[0]) {
                                        /**
                                         * Add a temp place holder for all missing parm values the replace 
                                         * it with a "". 
                                         * Example: a=1&a=&a=&a=4 results in a=1,,,4
                                         */
                                        var tempVal = valAry[1].length ? window.decodeURIComponent(valAry[1].replace(/\++/g, '%20')) : "*EMPTY*";
                                        parmVals += (parmVals.length) ? "," + tempVal : tempVal;
                                    }
    
                                });
    
                                parmVals = parmVals.replace(/\*EMPTY\*/g, "");
                                val = parmVals;
    
                            } else if (typeof(defaultVal) === "boolean") {
                                val = val === "on" ? true : false;
                            }
                            if (defaultVal == val) {
                                // Don't return a match to the default value
                                // Double-equal is intended here since we want values like "1" and 1 compared. 
                                defaultMatches.push(parmName);
                            } else {
                                // return the parm value
                                result[parmName] = String(val);
                            }
                        } else {
                            // no default so just return it
                            result[parmName] = val;
                        }
                    }
    
                }
            });
        }
        if (defaultParms) {
            $.each(defaultParms, function(key, val) {
                if (typeof(val) === "boolean" && val && !result[key] && !appcme.includes(defaultMatches, key)) {
                    /**
                     * This is special handling for checkboxes. When unchecked 
                     * its value will not be sent in the form data because it is a false checkbox.
                     * This hanldes any checkbox with a default value of true but has been set to 
                     * unchecked (false).
                     * It's expected that any checked (true/on) checkbox will have a value in the form data. 
                     */
                    result[key] = "false";
                } else if ($.isArray(val) && (typeof result[key] !== "undefined")) {
                    /**
                     * Any form parms that are arrays without values then remove them from the final result.
                     */
                    var stripped = result[key].toString().replace(/,/g, "");
                    if (stripped.length === 0) {
                        delete result[key];
                    }
                }
            });
        }

        return result;
    };

    /**
     * Converts the value to integer
     * 
     * @param {object} value            original value to be converted to int
     * @param {object} defaultValue     default value
     * @return {Number} Respective int value for proper data and default value for improper data 
     */
    appcme.convertToNumber = function(value, defaultValue) {

        // return default value for empty or null
        // ignore boolean value and 0 else false will always return default value
        if (!value && typeof(value) != "boolean" && value !== 0) {
            return defaultValue;
        }

        //if number just convert to number and return the same 
        if (!isNaN(value) || typeof(value) === "boolean") {
            return Number(value);
        }

        //string case
        if (typeof(value) === "string") {
            if (value === 'true' || value === 'false') {
                return value === 'false' ? 0 : 1;
            }
        }

        return defaultValue;
    };

    /**
     * Call this function to handle invalidating a form elements.  
     * Currently handles all form elements the same. We could do something custom for each
     * element if needed.  
     * Although you can call this directly it's also called automatically through the supported 
     * form validator that callers register. 
     * 
     * @param {jQuery object} $$elements The element(s) to be invalidated. 
     */
    appcme.invalidate = function($elements) { 
        if ($.isArray($elements)) {
            for (var index in $elements) {
                $elements[index].addClass("form-error");
            }
        } else {
            $elements.addClass("form-error");
        }
    }

    /**
     * Answers the question of a value is in the array. Shim for missing js function.
     * @param  {array} array1       the array to search
     * @param  {object} search      the value to search for
     * @param  {int} fromIndex      array index to start search from
     * @return {boolean}            true if it's in the array, false if not
     */
    appcme.includes = function(array1, search, fromIndex) {
        return array1.includes ? array1.includes(search, fromIndex) : array1.indexOf(search, fromIndex) >= 0;
    };

    /**
     * @param {string} relativePath the relative path to a resource
     * @return {string}             the absolute path
     */
    appcme.absolutePath = function(relativePath) {
        return AJS.contextPath() + relativePath; 
    };

    /**
     * Strictly types the list of parameters and fills out the list with any defaults that are missing.
     * This allows for the use of improved JS code when dealing with actual objects instead of strings 
     * for form parms.  
     * @param  {map}    defaults    [The default values for any parms]
     * @param  {[map]} parms        [The list of parms. ]
     * @return {[map]}              [Map of parms properly typed with defaults for all missing parms]
     */
    appcme.parametersToObj = function(defaults, parms, delimiter, quote) {
        //below code is to assign default values
        delimiter = delimiter || ",";
        quote = quote || "'";
        
        var opts = $.extend({}, {
            parms: parms,
            allowBlanks: []
        });

        var retVal = {};

        for (var key in opts.parms) {
            var val = opts.parms[key];

            //Handle case sensitive parameter names.
            //Update key if case does not match
            key = appcme.findCaseInsensitiveKeyAndUpdateParams(key, defaults, opts.parms);

            if (typeof defaults[key] !== 'undefined') { // key exists in both, check types and convert if needed:
                if (!val) { // value is empty, use default:
                    val = defaults[key];
                } else if (typeof defaults[key] === 'boolean') {
                    var booleanVal = opts.parms[key];
                    if (booleanVal === 'true' || booleanVal === 'false') {
                        val = eval(booleanVal);
                    } else if (booleanVal === 'on') {
                        val = true;
                    } else {
                        val = defaults[key];
                    }
                } else if ($.isNumeric(defaults[key])) { // number
                    //Any number parameter with true/false value will be mapped to 1/0 respectively. Eg: Heading and footing 
                    if(opts.parms[key] === "false"){
                        val = 0;
                    } else if (opts.parms[key] === "true") {
                        val = 1;
                    } else {
                        val = appcme.convertToNumber(opts.parms[key], defaults[key]);
                    }
                } else if ($.isArray(defaults[key])) { // array
                    val = $.map(appcme.split(opts.parms[key], delimiter, quote), function(ele) {
                        ele = ele.trim();
                        return $.isNumeric(ele) ? Number(ele) : ele;
                    });
                }
            }

            // convert blank value if specified:
            if (val === '@blank' && appcme.includes(opts.allowBlanks, key)) {
                val = '';
            }

            retVal[key] = val;
        }

        // iterate over defaults and add things not already present:
        for (var key in defaults) {
            if (typeof retVal[key] === 'undefined') {
                retVal[key] = defaults[key];
            }
        }

        return retVal;
    };

    appcme.buildMacroRenderRequest = function(macroDetails, macroParams ) {
        var macroRenderRequest = {
                contentId: Confluence.Editor.getContentId(),
                macro: {
                    name: macroDetails.name,
                    params: macroParams,
                    //defaultParameterValue: "", //TODO: I do not see this in native preview rest API call. Is this really needed??
                    body: macroDetails.body ? macroDetails.body : "" //if body is null, then send empty body eg: when macro inserted through insert macro dialog
                }
            };
        return macroRenderRequest;
    }
        
    appcme.refreshPreview = function(previewData, macroRenderRequest){

        $.ajax({
            url: AJS.contextPath()+"/rest/tinymce/1/macro/preview", 
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(macroRenderRequest),
            beforeSend: function() {
                previewData.find(".editor-preview-iframe").remove();
                previewData.find(".appfire-preview-data").hide(); 
                previewData.find(".appfire-preview-loading").show();
            },
            error: function(jqXHR,  textStatus,  errorThrown) {
                previewData.find(".appfire-preview-loading").hide();
                var preview = previewData.find(".appfire-preview-data");
                preview.show();
                preview.appendTo(errorThrown);
            },
            success: function(data, textStatus, jqXHR) {
                previewData.find(".appfire-preview-loading").hide();
                previewData.find(".appfire-preview-data").show();

                var $iframe = $('<iframe frameborder="0" class="appfire editor-preview-iframe"></iframe>');
                $iframe.appendTo(previewData.find(".appfire-preview-data"));

                var w = $iframe[0].contentWindow.document;
                $iframe.on('load', function() {

                    // setting height and width avoids the extra scrollbars on the dialog
                    var $frame = $(this);
                    $frame.width("99%");
                    $frame.height("99%");
                    // reach into the iframe and snug the preview contents a tad to better fill in the preview data area
                    var $main = $frame.contents().find("#main");
                    $main.css("padding-left", "0px");
                    $main.css("padding-top", "0px");

                });

                w.open();
                w.write(data);
                w.close();
            },
            complete: function(jqXHR, textStatus, errorThrown) {
            }
        });
    }

    appcme.showEditorDialog = function($ed, macroDetails) {

        $ed.hide().appendTo("#wysiwyg").trigger('appfireEditorBeforeShow', [$ed, macroDetails]);
        $ed.find('.content-panel').hide(); // hide all content panes before displaying
        AJS.tabs.setup(); // setup any tabs on any pages

        /* Select the first tab as the active tab. If the macro has set a different
        * panel to be active then override it.  If not set the click is ignored. 
        */
        $ed.find('.appfire-navigation [data-index="0"]').click(); 
        $ed.find('.appfire-navigation [data-active-panel]').click();
        
        AJS.dialog2($ed).show();    
        $ed.trigger('appfireEditorAfterShow', [$ed]);

        // TODO manually setting height of our internal content area:
        var content = $ed.find('.aui-dialog2-content');
        content.children(':first').height("520px"); // TODO pull height from data attribute.  content.height());

        return $ed;
    }

    appcme.setMacroJsOverride = function(macroName, defaultParms, editorGenerator) {
        var previewOnloadCache = null; // Setting to null to improve debugging experience to check for multiple calls 
        AJS.MacroBrowser.setMacroJsOverride(macroName, { 
            /**
             * When inserting a new macro,  since no params set, the macroDetails wont contain any of macro params except "atlassian-macro-output-type"
             */
            opener: function(macroDetails) {
                //SQL-908/TBLSORT-122 - grab their current place in page and save before dialog display and then restore bookmark before insert/replace
                AJS.Rte.BookmarkManager.storeBookmark();
                var editorGen = editorGenerator(macroDetails); 
                var validator = editorGen.validator;
                
                //pass contextPath to be used by preview icons
                editorGen["contextPath"]=AJS.contextPath();
                
                var editorDialog = $(org.swift.confluence.editor.editorMain(editorGen));

                // Place macro name on dialog.  This is primarly used in selector for event handling. 
                editorDialog.attr("data-appfire-macro-name", macroDetails.name);
                // For good measure add the macroDetails as a data object to the dialog.
                editorDialog.data("macroDetails", macroDetails);
                // apps can pass in any extra data attributes to be stashed on the dialog. 
                if (editorGen.dataAttributes) {
                    $.each( editorGen.dataAttributes, function( prop, value ) {
                        editorDialog.attr("data-"+prop, value);
                    });    
                }

                //Added macroDetails so that macro body can be checked in csv and json-table "appfireEditorBeforeShow" handlers
                appcme.showEditorDialog(editorDialog, macroDetails);

                editorDialog.find("#editor-save-button").click(function(e) {

                    var errors = []; // array of properties for errors
                    var $form = $(this).closest("form"); 

                    editorDialog.trigger("appfireEditorBeforeSerialize", [editorDialog, $form, defaultParms, errors]);
                    
                    if (!validate(validator, errors, editorDialog, $form)) {
                        return false;
                    }

                    var parms = appcme.parseParameters($form.serialize(), defaultParms);

                    editorDialog.trigger("appfireEditorBeforeSave", [parms, editorDialog, $form, defaultParms, macroName]); //macroName is needed in the trigger handler

                    var macroRenderRequest = appcme.buildMacroRenderRequest(macroDetails, parms);
                    //Update macro body before insertMacro in the editor
                    editorDialog.trigger("appfireEditorBeforeMacroRender", [macroRenderRequest]);
                    
                    //SQL-908/TBLSORT-122 - Restore bookmark before insert/replace
                    AJS.Rte.BookmarkManager.restoreBookmark();
                    tinymce.confluence.MacroUtils.insertMacro(macroRenderRequest);
                    AJS.dialog2(editorDialog).remove();

                    return false;
                });

                editorDialog.find(".editor-dialog-close").click(function(e) {
                    AJS.dialog2(editorDialog).remove();
                    return false;
                });

                AJS.dialog2(editorDialog).on("hide", function(evt) {
                    
                    // This is a hack for https://ecosystem.atlassian.net/servicedesk/customer/portal/14/DEVHELP-1605
                    // For some reason the aui control hide event is propogating to the dialog.  This causes the dialog
                    // to close unexpectedly.  
                    var $target = $(evt.target);
                    if ($target.is(".aui-dropdown2")) {
                        return false;
                    }
                    // Restore to cached original preview function 
                    AJS.MacroBrowser.previewOnload = previewOnloadCache;
                    previewOnloadCache = null; // maybe for sake of easier debugger reset to null value. 
                    
                    $(this).remove();
                    $('aui-inline-dialog').remove(); //On hiding editor dialog, remove the inline dialogs as well.
                }); 

                editorDialog.find(".appfire-preview-show").on('click', function(e) {

                    var previewActions = editorDialog.find(".appfire-preview-actions");            
                    previewActions.find(".appfire-preview-hide").show();
                    previewActions.find(".appfire-preview-show").hide();

                    var $form = $(this).closest("form");
                    $form.find(".appfire-empty-content").css("text-align", "center");
                    /* 
                    ** More bits of code to hande the open/close of preview. 
                    */
                    editorDialog.find('[data-collapsible]').each(function(i, ele) {
                        $(ele).removeClass($(ele).data('collapsible')).addClass('col-');
                    });

                    editorDialog.find(".appfire-grid").each( function () { 
                        var $masterRow = $(this).data("masterGridRow");
                        if ($masterRow){
                            $masterRow.find('[data-collapsible]').each(function(i, ele) {
                                $(ele).removeClass($(ele).data('collapsible')).addClass('col-');
                            });
                        }
                    });

                    editorDialog.find(".appfire-preview-refresh").click();
                    e.preventDefault();
                });

                editorDialog.find(".appfire-preview-refresh").on('click', function(e) {
                    
                    var errors = []; // array of properties for errors
                    var $form = $(this).closest("form"); 

                    editorDialog.trigger("appfireEditorBeforePreviewSerialize", [editorDialog, $form, defaultParms, errors]);

                    validate(validator, errors, editorDialog, $form);                    
                    var parms = appcme.parseParameters($form.serialize(), defaultParms);
                    editorDialog.trigger("appfireEditorBeforePreview", [parms, editorDialog, $form, defaultParms, macroName]);
                                        
                    var previewData = editorDialog.find(".appfire-preview-container");
                    previewData.show();
                    editorDialog.trigger("appfireEditorAfterPreviewShow", [editorDialog]);
                    
                    var macroRequest = appcme.buildMacroRenderRequest(macroDetails, parms);
                    
                    //Update macro body before calling preview
                    editorDialog.trigger("appfireEditorBeforeMacroRender", [macroRequest]); 
                    
                    appcme.refreshPreview(previewData, macroRequest);

                    e.preventDefault();
                });

                editorDialog.find(".appfire-preview-hide").on('click', function(e) {
                    var $form = $(this).closest("form"); 
                   
                    var $previewData = $form.find(".appfire-preview-container");
                    $previewData.hide();
                    editorDialog.trigger("appfireEditorAfterPreviewHide");

                    $previewData.find(".editor-preview-iframe").remove(); 
                    $form.find(".appfire-preview-hide").hide();
                    $form.find(".appfire-preview-show").show();

                    $form.find(".appfire-empty-content").css("text-align", "left");
            
                    /* The following bits of code are here to reformat the grid row contents that have the 
                    ** "data-collapsible" class.  This exists to get the responsiveness of the grid when the 
                    ** preview is opened and closed.  
                    */
                    $form.find('[data-collapsible]').each(function(i, ele) {
                        $(ele).removeClass('col-').addClass($(ele).data('collapsible'));
                    });
                    $form.find(".appfire-grid").each( function () { 
                        var $masterRow = $(this).data("masterGridRow");
                        if ($masterRow){
                            $masterRow.find('[data-collapsible]').each(function(i, ele) {
                                $(ele).removeClass('col-').addClass($(ele).data('collapsible'));
                            });
                        }
                    });
                
                    e.preventDefault();
                });
                
                //NTBL-60: Here is what suggested on https://jira.atlassian.com/browse/CONFSERVER-36767
                // We need to cache the preview inorder to restore it when the dialog goes away so other apps 
                // will continue to work. 
                previewOnloadCache = AJS.MacroBrowser.previewOnload;
                AJS.MacroBrowser.previewOnload = function(b) {
                    return;
                }
                
            }
        });
        
    }

    /**
     * This function validates the input fields with type=number and not allowed to carry -ve value.
     */
    appcme.validatePositiveInteger = function (errors){
        var contentPane = $(".appfire-content-panes");
        var numberFields = contentPane.find("input[type=number]:invalid");
        appcme.addValidationError(numberFields, errors);
    }
    
    /**
     * Find the associated labels of the elements which failed validation and push to errors.
     */
    appcme.addValidationError = function(elements, errors){
        elements.each(function(index, element) {
            var labelText = appcme.getDisplayLabelText($(this));
            var errorText = AJS.format("{0} must be a positive integer.", labelText)
            errors.push({ ele: $(element), msg: errorText }); 
        }); 
    }
    
    /**
     * Get the label text associated with the element
     */
    appcme.getDisplayLabelText = function(element){
        var contentPane = $(".appfire-content-panes");
        var elementName = contentPane.find("label[for='" + element.attr('id') + "']").find(".appfire-editor-label-span").text();
        if(elementName === ""){
            elementName = element.attr('name'); //if no label associated with this element, consider element's name attribute
        }
        return elementName;
    }
    
    /**
     * Customized string split method to ignore delimiter within given quotes.
     * Note: It does not handle nested single quotes. Single quote must be escaped with another single quote ('').
     * 
     * @param {string} $str The string to split. 
     * @param {string} $delimiter The delimiter on which split to be happened. 
     * @param {string} $quote The quote to be considered while spltting. 
     */
    appcme.split = function($str, $delimiter, $quote) {
        if ($str == null) {
            return [];
        }
        var regexPattern = $delimiter + "(?=(?:[^" + $quote + "]*" + $quote + "[^" + $quote + "]*" + $quote + ")*[^" + $quote + "]*$)";
        return $str.split(new RegExp(regexPattern, "gi"));
    };
    
    /**
     * Customized string split method to split on first occurrence of given delimiter.
     * 
     * @param {string} str The string to split. 
     * @param {string} delimiter The delimiter on which split to be happened. 
     */
    appcme.splitFirst = function(str, delimiter) {
        if (str == null || str.length == 0) {
            return [];
        }
        var index = str.indexOf(delimiter);
        if (index == -1) {
            return [str, ""];
        } else {
            return [str.substring(0, index), str.substring(index + 1)];
        }
    };
    
    /**
     * Decodes the given encoded HTML content.
     * @param {string} html The encoded html string. 
     */
    appcme.decodeHtml = function(html) {
        var txt = document.createElement("textarea");
        txt.innerHTML = html;
        return txt.value;
    }
    
    /**
     * This is a private function that is used to support form validation.  
     * 
     * @param {function} validator The caller's validation function. Returns a boolean. 
     * @param {array} errors An array of properties for each error. {ele: jQuery element, msg: message string with html}
     * @param {jQuery} $editorDialog The customer editor dialog. 
     * @param {jQuery} $form The form in the editor.  
     */
    var validate = function(validator, errors, $editorDialog, $form) { 
        appcme.clearValidationErrors($form);
        
        if (validator) {
            validator($editorDialog, $form, errors)
        }

        if  (errors.length) {
            var body = "";
            $(errors).each(function() {
                body += this.msg;
                if ( this.ele) {
                    appcme.invalidate(this.ele);
                }
            });
            var $icon = $("#show-editor-error");
            var $msg = $("#editor-error-msg");
            $msg.find(".body").html(body);
            $icon.show();
            $msg.attr("open", "");
            //focus the first error element's tab
            highlightFirstErrorElementTab(errors[0].ele);
        }

        return errors.length == 0; 
    }
    
    /**
     * Highlight the tab, where the 1st validation error element belongs to
     */
    var highlightFirstErrorElementTab = function($elements) {
        var firstErrorElement = $elements;
        if ($.isArray($elements)) {
            firstErrorElement = $elements[0];
        } 
        if(firstErrorElement){
            var targetContentPanelIndex = firstErrorElement.closest('.content-panel').index(); //get index of the .content-panel where the first error element belongs to
            $('.appfire-navigation [data-index='+targetContentPanelIndex+']').click(); //Go to corresponding nav pane
            var tabId = firstErrorElement.closest(".tabs-pane").attr("id"); //get the tabId where the first error element belongs to
            if(tabId){
                AJS.tabs.change($('a[href="#'+tabId+'"]')); 
            }
        }
    }
    
    /**
     * This function is used to clear form validation errors.  
     * 
     * @param {jQuery} $form The form in the editor.
     */
    appcme.clearValidationErrors = function ($form) {
        var $icon = $("#show-editor-error");
        var $msg = $("#editor-error-msg");
        $msg.find('#custom-error-content').remove(); //Remove custom error content added by any other app.
        $msg.find('#default-error-content').show();
        $icon.removeClass('aui-iconfont-warning');//Remove classes added by any other app.
        $icon.removeClass('custom-icon-align'); //If warning icon added, the default alignment doesnot look good, so to align custom class if added remove that.
        $icon.addClass("aui-iconfont-error");
        $icon.hide();
        $msg.removeAttr("open");
        
        $form.find(".form-error").removeClass("form-error");
    }

    /**
     * This is a private function to find key from default parameters with case insensitive match.
     * 
     * @param {jQuery} key - key to match in default parameters.
     * @param {jQuery} defaults - default parameters.
     * @param {jQuery} parms - actual parameters list to update key.
     */
    appcme.findCaseInsensitiveKeyAndUpdateParams = function (key, defaults, parms) {
        if (key != null && defaults != null && typeof defaults[key] === 'undefined') {
            for(var prop in defaults) {
                if(prop.toLowerCase() == key.toLowerCase()) {
                    if (parms != null && parms.hasOwnProperty(key)) {
                        parms[prop] = parms[key];
                        delete parms[key];
                    }
                    return prop;
                }
            }
        }
        return key;
    }
    
    /**
     * To scroll to bottom of grid and set focus to input field in given row.
     * 
     * @param {jQuery} $grid - Grid selector.
     * @param {jQuery} $row - Current row selector.
     */
    appcme.scrollAndFocusToNewRow = function ($grid, $row) {
        $grid.animate({
            scrollTop: $grid.scrollHeight
        }, 1000);
        $row.find(":input:visible:not([disabled]):first").focus();
    }
    
    /**
     * To scroll to top of the grid and set focus to first input field found in the grid.
     * 
     * @param {jQuery} $grid - Grid selector.
     */
    appcme.scrollAndFocusToFirstRow = function ($grid) {
        $grid.scrollTop(0);
        $grid.find(".appfire-row:first").find(":input:visible:not([disabled]):first").focus();
    }

}(window.appcme = window.appcme || {}, AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/js/common-table-editor.js' */
/*
 * Copyright (c) 2019 Appfire Technologies, Inc.
 * All rights reserved.
 *
 * This software is licensed under the provisions of the "Bob Swift Atlassian Add-ons EULA"
 * (https://bobswift.atlassian.net/wiki/x/WoDXBQ) as well as under the provisions of
 * the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
 * (http://www.atlassian.com/licensing/marketplace/termsofuse).
 *
 * See the LICENSE file for more details.
 */

//To make these props and functions accessible outside, embedded in namespace
//Note: Whenever we plan to release AT next, we can use these one and remove the duplicated ones from AT
(function(tablebasecme, $, undefined) {
    'use strict';
    
    /**
     * Macro params common to all table macros with default values
     * Param Count=20
     * TODO: AT (common-editor.js) has the duplicate of this, shall be deleted when plan to release next.
     */
    tablebasecme.commonTableParams = {
        allowExport: false,
        exportFileDelimiter: "Comma",
        displayDataFilter: false, //TBL-1147, TBL-1274
        autoNumber: false,
        autoTotal: false,
        class: "@default",
        columnAttributes: [],
        columnCalculations: [],
        columnStyles: [],
        columnTypes: [],
        enableHeadingAttributes: true,
        enableHighlighting: true,
        enableSorting: true,
        highlightColor: "lightgoldenrodyellow",
        id: "", 
        retainRowStyleOrder: true,
        rowStyles: [],
        autoTotalRowStyle: "",
        applyRowStyleToCell: false,
        applyColStyleToCell: false,
        sortColumn: "",
        sortDescending: false,
        sortIcon: false,
        sortTip: "", 
        style: ""
    }
    
    tablebasecme.DELIMITER = ',';
    tablebasecme.QUOTE = '"';
    
    //Any validation for common table params in Table settings, row settings and column settings panels is done in this method. 
    //As this is common set of params for all table related addons, any changes needed can be done locally and no need to pass selectors.
    tablebasecme.validateCommonTableParams = function(dialog, errors) {
        var contentPane = dialog.find(".appfire-content-panes");
      //columns which allow text and number as well, and when  -ve number is not allowed
        var elementsToValidate = "input[name=sortColumn], input[name=border], input[name=width]"; 
        var elements = contentPane.find(elementsToValidate).filter( function() { 
            if($.isNumeric($(this).val()) && !($(this).val() > 0)){
            return true;
            }
        });
        appcme.addValidationError(elements, errors); 
        
        validateExportFileDelimiter(dialog, errors);
        return appcme.validatePositiveInteger(errors);
    }
    
    function validateExportFileDelimiter(dialog, errors){
        if(dialog.find('#exportFileDelimiter').val() == 'Other' && dialog.find('#allowExport').prop('checked')){
            var otherDelim = dialog.find('#exportFileDelimiterOther');
            if(otherDelim.val() == '')
                errors.push({ ele: otherDelim, msg: "<p>" + AJS.format("{0} cannot be empty.",  'File delimiter') + "</p>"});
        }
    }
    
    $(document).on('appfireEditorGridAddRowBeforeShow', "[data-commontableeditor]", function(evt, newRow) {
        
        //If show col attrs menu item is checked when adding new row, display the col attr field.
        if($("#show-hide-col-attrs").attr("checked"))
            newRow.find(".column-attributes").attr("style","");
    });

    $(document).on('appfireEditorBeforeSave appfireEditorBeforePreview', "[data-commontableeditor]", function(evt, macroParms, dialog, form, defaultParms) {
        // Place code here to update the actual macro parms before the saving to the actual macro on the page
        // example: macroParms["newParm"] = "NewValue";
    
        // headerRowStyle shall be prefixed to rowStyles macro param
        if(macroParms.rowStyles || macroParms.headerRowStyles){
            macroParms.rowStyles = (macroParms.headerRowStyles ? macroParms.headerRowStyles : "") + (macroParms.rowStyles ? "," + macroParms.rowStyles : "");
        }
        delete macroParms["headerRowStyles"];
    
        /**
         * If autoNumber enabled, prepend autoNumberColStyles to columnStyles
         */
        var columnStyles = ''; //initalize it else undefined is taken when colStyles  appended in below code
        if(macroParms["autoNumber"]){
            if(macroParms["autoNumberColStyles"] && macroParms["autoNumberColStyles"].trim() !== ""){
                columnStyles = macroParms["autoNumberColStyles"] ;
            }
            
            if(macroParms["columnStyles"] && macroParms["columnStyles"].trim() !== "" ){
                columnStyles = columnStyles + "," + macroParms["columnStyles"];
            }
            macroParms["columnStyles"] = columnStyles;
        }
        //if there is no autoNumberColStyles then delete param
        if(!macroParms["autoNumberColStyles"]){
            delete macroParms["autoNumberColStyles"]; 
        }
        
        //if allowExport enabled, save the exportFileDelimiter
        if(macroParms["allowExport"]){
            if(macroParms["exportFileDelimiter"] == "Other" ){
                macroParms["exportFileDelimiter"] = encodeURIComponent(dialog.find("#exportFileDelimiterOther").val());
            }
        }
        else{
            delete macroParms["exportFileDelimiter"];
           
        }
        delete macroParms["exportFileDelimiterOther"];
    });
    
    function toggleOtherDelimTextbox (exportDelimiter, thisForm){
        var otherDelim = thisForm.find('#exportFileDelimiterOther');
        if(exportDelimiter.val() == 'Other'){
            var otherDelimVal = otherDelim.val();
            if(otherDelimVal && otherDelimVal.length > 1){ //decode only if its encoded
                otherDelim.val(decodeURIComponent(otherDelimVal));
            }
            otherDelim.show();
        }
        else{
            otherDelim.hide();
        }
    }
    $(document).on('change', '#exportFileDelimiter', function(evt) {
        var thisForm = $(this).closest("form");
        toggleOtherDelimTextbox($(this), thisForm);
    });

    /**
     * Event handler for all editors requiring common table macro support.
     */
    $(document).on('appfireEditorBeforeShow', "[data-commontableeditor]", function(evt, editor) {
    
        // Create the template row used for any new grid row adds and hang it off of each grid. 
        // This is the only step necessary to setup the different grids used.  
        //
        // Column positions grid
        var $row = $(org.swift.confluence.table.editor.columnPositionRow({position: 0, columnAttributes: "", columnCalculations: "", columnStyles: "", columnTypes: ""}));
        $("#column-positions").data("masterGridRow", $row); 
        // Row positions grid (data rows, not header rows since there is only at most one of those)
        $row = $(org.swift.confluence.table.editor.rowPositionRow({position: 0, rowStyles: ""}));
        $("#row-positions").data("masterGridRow", $row);  
        
        //If exportFileDelimiter is set to any other char i.e not comma, semicolon, tab or space, then display the other textbox
        var exportFileDelimiter = editor.find('#exportFileDelimiter');
        toggleOtherDelimTextbox(exportFileDelimiter, editor);
    });
 
    $(document).on('change', '.column-calculations-select, .column-types-select', function(event) {
        var $this = $(this);
        var thisVal = $this.val();
        var val = $this.find('aui-option').filter( function(){
            if( $(this).val() === (thisVal)){
                return true;
            }
        });
        if(val){
            val = val.html();
        }
        var displayVal = $this.find("input").val(); 
    
        // special code to handle when user types into the edit box.  
        if (displayVal == val) {
            // value selected from list to assign to parameter through hidden input.
            val = $this.val();
        } else if (appcme.decodeHtml(displayVal) == val) {
            //There is html encoding issue with aui-select
            //code to update the selected input text from option text.
            $this.find("input").val(val);
            $this.find("select").find(`option[value="${thisVal}"]`).text(val);
            
            //use value of selected option.
            val = thisVal;
        } else {
            // value typed into edit box 
            val = displayVal;
        }
        $this.siblings('input:hidden').val(val);
    });
    
    $(document).on("click", "#show-hide-empty-pos-rows", function(evt) {
        if (evt.target.isChecked()) {
            // Show all the empty rows
            $(".show-hide-empty").show();
        } else {
            $(".show-hide-empty").each( function () { 
                var inputs = $(this).find(":input").filter( function() { 
                    return this.value;
                });
                if (!inputs.length) {
                    $(this).hide();
                } 
            });
        }
    });
    
    
    $(document).on("click", "#show-hide-col-attrs", function(evt) {
        if (evt.target.isChecked()) {
            $(".column-attributes").show();
        } else {
            $(".column-attributes").hide();
        }
    });
    
    /**
     * Handles the transition from the empty state by adding rows to 
     * either the column formats or the data row formats. 
     * 
     * This could be common I think with a bit of refactoring.   
     */
    $(document).on("click", ".start-formatting", function(e) {
    
        var $empty = $(this).closest(".appfire-empty-content"); 
        var $error = $empty.find(".error");
        $error.hide(); 
    
        var rows = Number($empty.find(".rows-to-add").val()); 
        if (rows >= 0 && rows <= 30) {
    
            var $grid = $empty.closest(".appfire-grid");
            var $row = $grid.data("masterGridRow"); 
    
            for (var i = 0; i < rows; i++) {
                appcme.addGridRow($grid, $row);        
            }
    
            var $gridSet = $empty.closest(".appfire-grid-set");
            $gridSet.find(".grid-empty-msg").hide();
            $gridSet.find(".grid-bar").show(); 
            $grid.show();
            //To scroll to first row added.
            appcme.scrollAndFocusToFirstRow($grid);
        } else {
            $error.show(); 
        }
    
        e.preventDefault();
    });

}(window.tablebasecme = window.tablebasecme || {}, AJS.$));


}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/js/common-datalocation-editor.js' */
/*
 * Copyright (c) 2019 Appfire Technologies, Inc.
 * All rights reserved.
 *
 * This software is licensed under the provisions of the "Bob Swift Atlassian Add-ons EULA"
 * (https://bobswift.atlassian.net/wiki/x/WoDXBQ) as well as under the provisions of
 * the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
 * (http://www.atlassian.com/licensing/marketplace/termsofuse).
 *
 * See the LICENSE file for more details.
 */

//TODO: have a better namespace??
/**
 * This namespace contains all the event handlers and methods related to data location fields i.e space, page, attachment
 * @param tablebasecme
 * @param $
 * @param undefined
 * @returns
 */
(function(tablebasecme, $, undefined) {
    'use strict';
    
    tablebasecme.CURRENT_SPACE = "Current space";
    tablebasecme.CURRENT_SPACE_WITH_KEY = tablebasecme.CURRENT_SPACE + " (" + AJS.params.spaceKey + ")";
    tablebasecme.CURRENT_PAGE = "Current page" + " (@self)";
    tablebasecme.NO_ATTACHMENT_FOUND = "No attachments found";
    
    tablebasecme.specialPageValues = {
            "@parent" : "Current page parent" + " (@parent)",
            "@home" :  "Current space home page"  + " (@home)",
            "@self" : tablebasecme.CURRENT_PAGE
    }
    
    tablebasecme.specialSpaceValues = {
            "Current space": tablebasecme.CURRENT_SPACE_WITH_KEY
    }
    
    /**
     * This method is useful for macros which supports 'script' macro param (i.e supports attachment, filename, template through script param)
     */
    tablebasecme.splitScriptParam = function(macroParams){
        //For csv and json-table macro, split script param into (attachment,attachmentPage) or filename or template params if script val contains attachment reference
        if(macroParams.script){
            //if attachment
            if(macroParams.script.indexOf("^") >= 0){
                //split attachment page to space and page
                var spaceKey;
                var pageTitle;
                var attachment;
                var page = macroParams.script.substring(0, macroParams.script.indexOf("^"));
                if(page){
                    if(tablebasecme.specialPageValues.hasOwnProperty(page.toLowerCase().trim())){
                        spaceKey = ""; //Do not set current space by default
                        pageTitle = page;
                    }
                    else{
                        if(page.indexOf(":") > 0){
                            spaceKey = page.substring(0, page.indexOf(":"));
                            pageTitle = page.substring(page.indexOf(":") + 1, page.length);
                        }
                        else{
                            //space not given
                            spaceKey = tablebasecme.CURRENT_SPACE;
                            pageTitle = page;
                        }
                    }
                }
                else{ //page is empty
                    spaceKey = tablebasecme.CURRENT_SPACE;
                    pageTitle = tablebasecme.CURRENT_PAGE;
                }
                attachment = macroParams.script.substring(macroParams.script.indexOf("^")+1, macroParams.script.length);
                $.extend(macroParams, {attachmentPage: macroParams.script, attSpace: spaceKey, attPage: pageTitle, attachment: attachment});
            }
            //if filename
            else if(macroParams.script.indexOf("#") >= 0){
                var fileName = macroParams.script.substring(macroParams.script.indexOf("#")+1, macroParams.script.length)
                $.extend(macroParams, {filename: fileName});
            }
            else{ //template
                $.extend(macroParams, {template: macroParams.script});
            }
        }
        return macroParams;
    }

    //private method for validating select2 datalocation field
    var validateSelect2DataLocationField = function(contentPane, field, errors, elementName){
        var element = contentPane.find(field);
        if(element.length && element.val().trim() === ""){
            errors.push({ ele: element, msg: "<p>" + AJS.format("{0} cannot be empty.", elementName) + "</p>"});
        }
    }
    
   // TODO:  If we have more text fields that needs empty validation,  this can be refactored as a generic one, and then may be move to common-table-editor.js??
    var validateDataLocationField = function(contentPane, field, errors){
        var element = contentPane.find(field);
        if(element.length && element.val().trim() === ""){
            var elementName = appcme.getDisplayLabelText(element);
            errors.push({ ele: element, msg: "<p>" + AJS.format("{0} cannot be empty.", elementName) + "</p>"});
        }
    }
    
    tablebasecme.validateDataLocationFields = function(dialog, errors){
        var contentPane = dialog.find(".appfire-content-panes");
        
        var dataLocation = contentPane.find(".appfire-table-datalocation");
        if(dataLocation.val() === 'attachment'){
            validateSelect2DataLocationField(contentPane, "#attSpace", errors, "Space");
            validateSelect2DataLocationField(contentPane, "#attPage", errors, "Page"); //send element name for select2 fields 
            validateSelect2DataLocationField(contentPane, "#attachment", errors, "Attachment");
        }
        else if(dataLocation.val() === 'filename'){
            validateDataLocationField(contentPane, "#filename", errors);
        }
        else if(dataLocation.val() === 'template'){
            validateDataLocationField(contentPane, "#template", errors);
        }
        else if(dataLocation.val() === 'url'){
            validateDataLocationField(contentPane, "#url", errors);
        }
        else if(dataLocation.val() === 'profile'){
            validateSelect2DataLocationField(contentPane, "#profile", errors, "Profile");
        }
    }
    /**
     * On load of data source tab, display right fields based on chosen dataSource
     */
    var displayRightDataLocationFields = function(dataLocationFields, selectedDataSource){
        dataLocationFields.hide(); //hide all datasource fields
        $("." + selectedDataSource.val() + "-group").show(); //show only the required datasource fields 
    }
    /**
     * On datasource change, display right fields based on chosen dataSource
     */
    $(document).on('change', ".appfire-table-datalocation", function() {
        var dataLocationFields = $(this).closest("form").find(".datalocation-fields");
        displayRightDataLocationFields(dataLocationFields , $(this));
        // Set default values of space and page to current space and current page
        //if "attachment" chosen, set default values for space and page
        if($(this).val() === "attachment") {
            var space = dataLocationFields.find("#attSpace"); //TODO: think of better way instead of using id, not able to use class because with class name, more than 1 field found as select2 adds the class to dynamically created elements.
            var page = dataLocationFields.find("#attPage");
            if(space.val() === ""){
                space.auiSelect2("val",tablebasecme.CURRENT_SPACE);
            }
            if(page.val() === ""){
                page.auiSelect2("val",tablebasecme.CURRENT_PAGE);
            }
        }
     });
    
    /**
     * On change of space, empty page element, attachments element.
     */
    $(document).on('change', '.datalocation-space', function() {
        var dataLocationFields = $(this).closest(".datalocation-fields");
        dataLocationFields.find("#attPage").auiSelect2("val","");
        dataLocationFields.find("#attachment").auiSelect2("val","");
    });
    
   //Set space empty for special page values
    var setSpaceForSpecialPageValues = function(dataLocationFields, dataLocationSpace, dataLocationPage){
        var page = dataLocationPage.val();
        if(page && tablebasecme.specialPageValues.hasOwnProperty(page.toLowerCase())){ 
            dataLocationSpace.auiSelect2("val", AJS.params.spaceKey);
            dataLocationFields.find("#s2id_attSpace").find(".select2-chosen").text(tablebasecme.CURRENT_SPACE_WITH_KEY); 
        }
    }
    
    
    /**
     * On change of page, empty attachments field.
     * if its special value, then set space empty on UI, but space value is actually current space.
     * If page first selected special val, then chosen some other page, show space current space.
     * 
     */
    $(document).on('change', '.datalocation-page', function() {
        var dataLocationFields = $(this).closest(".datalocation-fields");
        dataLocationFields.find("#attachment").auiSelect2("val","");
        //if page changed to @self, @home or @parent then set space select2 value and text to current space
        setSpaceForSpecialPageValues(dataLocationFields, dataLocationFields.find("#attSpace"), $(this));
    });
    
    $(document).on('appfireEditorAfterShow', "[data-datalocationfields=true]", function(evt, editor) {

        //TODO: Find a better approach. 
        //Issue: When select2 field available on editor load, it does not allow to type in for search until an extra click is done.
        //Tried click other elements available around, but that does not work.
        // Workaround : Simply open and close the Space select2. 
        var dataLocationFields = editor.find(".datalocation-fields");
        var dataLocationSpace = dataLocationFields.find("#attSpace");
        if(dataLocationSpace.is(':visible')){
            dataLocationSpace.select2("open");
            dataLocationSpace.select2("close");
        }
        
        //For specialPageValues, set space blank
        setSpaceForSpecialPageValues(dataLocationFields, dataLocationSpace, dataLocationFields.find("#attPage"));
    });
    
    $(document).on('appfireEditorBeforeShow', "[data-datalocationfields=true]", function(evt, editor, macroDetails) {
        var dataLocationFields = editor.find(".datalocation-fields");
        var methodOfLocatingData = editor.find(".appfire-table-datalocation");
        displayRightDataLocationFields(dataLocationFields, methodOfLocatingData);
        
        //These elements are being referred multiple times hence the variables initialised so that it can be referred.
        var dataLocationFields = editor.find(".datalocation-fields");
        var dataLocationSpace = dataLocationFields.find("#attSpace"); //Using id here, because with class name, more than 1 field found as select2 add the class to dynamically created elements.
        var dataLocationPage = dataLocationFields.find("#attPage");
        var dataLocationAttachment = dataLocationFields.find("#attachment");
        
        //If profile to be supported in method of locating script, then load profiles. As of now its supported fro csv and json-table macros
        if(editor.find(".profile-group").length){
        //If no profiles configured, remove profile option from 'Method of locating script' select list
        //And If there are configured profiles, then load them to profile field
          $.getJSON(AJS.contextPath() + '/rest/bobswift/table/1.0/getprofiles').done(
              function(data){
              if(!(data && data.length)) {
                 //console.log("No profiles found"); 
                  methodOfLocatingData.find("option[value='profile']").remove();
              }else{
                      var profileList = $.map(data, function(item) {
                          return { id: item, text: item }; 
                      });
                      var profile = dataLocationFields.find("#profile");
                      if(profile.length){
                          profile.auiSelect2({
                              placeholder: "Select a profile...",
                              allowClear: true,
                              multiple: false,
                              data: profileList,
                              initSelection: function(element, callback) {
                                  callback({
                                       id: element.val(),
                                       text: element.val() ? element.val() : "Select a profile..."
                                   }); 
                              },
                              formatNoMatches: function (term) {
                                  return "No profiles found.";
                              },
                          });
                      }
                  }
              
              displayRightDataLocationFields(dataLocationFields, editor.find(".appfire-table-datalocation"));
          }); //end of ajax.done
        }
        /**
         * Below are the methods called by select2 
         */
         
        //This method builds the attachment rest url for attachment select2 field
        var getAttachmentSearchUrl = function(){
            var attachmentSearchUrl ;
            var page = dataLocationPage.val();
            var contentId;
            if(page && page.toLowerCase() === "@home"){
                contentId =  getHomePage();
            }
            else if(page && page.toLowerCase() === "@parent"){
                contentId = AJS.params.parentPageId ;
            }
            else if(page && page.toLowerCase() === "@self" || page.toLowerCase() === tablebasecme.CURRENT_PAGE.toLowerCase()){
                contentId = AJS.params.contentId ;
            }
            else{  
                if(page !== "" && dataLocationPage.auiSelect2('data').contentId){
                    contentId = dataLocationPage.auiSelect2('data').contentId;
                }
                else{
                    //When script filled, on load of editor, get pageId for given space and pagetitle
                    contentId = getPageId(dataLocationSpace, dataLocationPage);
                   //if no content id found, it may be a draft page. AJS.params.pageTitle do not provide pagetitle for a draft page, so use content-title element in the dom
                    if(!contentId && AJS.params.newPage && 
                            ($("#content-title.text.pagetitle").val() === dataLocationPage.val()) && (dataLocationSpace.val() === tablebasecme.CURRENT_SPACE || dataLocationSpace.val() === AJS.params.spaceKey)){ 
                        contentId = AJS.params.draftId;
                    }
                }
            }
            //Rest API to get all attachments irrespective of file type or extension
            attachmentSearchUrl = AJS.contextPath() + '/rest/api/content/'+ contentId +'/child/attachment';
            
            return attachmentSearchUrl;
        }
        
        //Get home page of current space
        var getHomePage = function(){
            var url = AJS.contextPath()+'/rest/api/space?spaceKey='+AJS.params.spaceKey+'&expand=homepage';
            var pageId ;
            
            AJS.$.when(AJS.$.ajax({
                url: url,
                type: 'GET',
                cache: true,
                async: false,
                success: function (data) {
                    if(data && data.results.length > 0)
                        pageId = data.results[0].homepage.id;
                },
                error: function (jqXHR, status, error) {
                    AJS.error(error);
                }
            })).done(function(data) {
                return pageId;
            });
            
            return pageId;
        }
        
        //Get the pageId of page being edited given space key and pagetitle. pageId is needed for fetching attachments of the page.
        var getPageId = function(dataLocationSpace, dataLocationPage){
            var space = dataLocationSpace.val();
            //if space not given or is "CurrentSpace", then consider current space key
            if(!space || space === tablebasecme.CURRENT_SPACE){
                space = AJS.params.spaceKey;
            }
            var url = "";
            if(dataLocationPage.val() != "")
                url = AJS.contextPath()+'/rest/api/search?cql=space="' + space + '"and type=page and title~"' + dataLocationPage.val() + '"';
            else
                url = AJS.contextPath()+'/rest/api/search?cql=space="' + space + '"and type=page';
            var pageId ;
            
            AJS.$.when(AJS.$.ajax({
                url: url,
                type: 'GET',
                cache: true,
                async: false,
                success: function (data) {
                    if(data && data.results.length > 0)
                        pageId = data.results[0].content.id;
                },
                error: function (jqXHR, status, error) {
                    AJS.error(error);
                }
            })).done(function(data) {
                return pageId;
            });
            
            return pageId;
        }
        
        //Return list of all spaces. Each entry will be in this form: spaceKey (space name)
        var formatSpaceResults = function(data) {
            var results = [];
            if (data && data.results.length > 0) {
                $.each(data.results, function(index, item){
                  //include all spaces, global and personal spaces
                    results.push({
                        id: item.space.key,
                        text: item.space.key + ' (' + item.space.name + ')'
                    });
                });
            }
            addToBeginOfList(results, tablebasecme.specialSpaceValues);
            return results;
        }
        
        //Return list of all page titles.
        var formatPageResults = function(data) {
            var results = [];
            if (data && data.results.length > 0) {
                $.each(data.results, function(index, item){
                    results.push({
                        id: item.content.title,
                        text: item.content.title,
                        contentId: item.content.id
                    });
                });
            }
            addToBeginOfList(results, tablebasecme.specialPageValues);
            return results;
        }
        
        var formatAttachmentResults = function(data){
            var results = [];
            if(data && data.results.length > 0){
                $.each(data.results, function(index, item){
                    results.push({
                        id: item.title,
                        text: item.title
                    });
                });
            }
            else{
                results.push({
                    id: "",
                    text: tablebasecme.NO_ATTACHMENT_FOUND
                });
            }
            return results;
        }
        
        var errorAttachmentResults = function(){
            var results = [];
            console.log("Error fetching attachments :"+error+ " "+ status);
            results.push({
                id: "",
                text: tablebasecme.NO_ATTACHMENT_FOUND
            });
            return results; 
        }
        
        var errorAttachmentParams = function(response){
            console.log("Error while fetching attachments :"+response.responseText);
            //If the url contains error for some reason, the select2 dropdown stays open and shows searching...
            //TODO: There shall be a better way to handle it. But this is what found for now.
            if(dataLocationAttachment.val() === ""){
                dataLocationAttachment.auiSelect2("val", tablebasecme.NO_ATTACHMENT_FOUND);
            }
            $("#select2-drop:visible").hide();
        }
        
        //add additionalResults to begin of results list
        var addToBeginOfList = function(sourceList, listToBeAdded){
            $.each(listToBeAdded, function(key, val){
                sourceList.unshift({
                    id: key,
                    text: val
                });
            });
            return sourceList;
        } 
        
        //TODO: Have a better name
        var select2AjaxData = function (term, page, defaultQuery, queryWithInput) { // page is the one-based page number tracked by Select2
            if(term !== ""){
                return {
                cql: queryWithInput 
               }
           }
           else{
             return {
                cql: defaultQuery 
               }  
           }
        }
        
        var searchUrl = function(){return AJS.contextPath() + '/rest/api/search';};
        var defaultSpaceQuery = function () {return "type=space";};
        var defaultPageQuery = function () { return 'type=page and space="'+ (dataLocationSpace.val() === "" || dataLocationSpace.val() === tablebasecme.CURRENT_SPACE ? AJS.params.spaceKey : dataLocationSpace.val()) + '"';};
        var pageQueryWithInput = function (term) { return 'type=page and title~"'+term+'*" and space="'+ (dataLocationSpace.val() === "" || dataLocationSpace.val() === tablebasecme.CURRENT_SPACE ? AJS.params.spaceKey : dataLocationSpace.val()) + '"';};
        var spaceQueryWithInput = function (term) { return 'type=space and space.title~"'+term+'*"';};
        var initSelectionSpace = function (element, callback) { 
            callback({
                id: element.val(),
                text: (element.val() === tablebasecme.CURRENT_SPACE  ? tablebasecme.CURRENT_SPACE_WITH_KEY : element.val())
            });
        };
        
        var initSelectionPage = function (element, callback) { 
            callback({
                id: element.val(),
                text: tablebasecme.specialPageValues.hasOwnProperty(element.val().toLowerCase()) ? tablebasecme.specialPageValues[element.val().toLowerCase()] : element.val()
            });
        };
        
        //This method enables given element select2 with dynamic search ability.
        var initSelect2 = function(element, placeHolderText, searchUrl, defaultQuery, queryWithInput, formatResults, errorResults, paramsError, initSelectionFunction ){
            element.auiSelect2({
             placeholder: placeHolderText,
             allowClear: true, //TODO: this is not working with auiselect2, but works with select2.
             ajax: {
                 url: function(){
                     return searchUrl(); //TODO: url need not be a function always, can be just a string. But to handle both string and function, we may need to add logic to check if searchUrl is of type func or not.
                 },
                 dataType: 'json',
                 type: 'GET',
                 delay: 250,
                 cache: true,
                 data: function (term, page) { // page is the one-based page number tracked by Select2 for pagination, we are not using page now.
                     if(defaultQuery != null){
                         return select2AjaxData(term, page, defaultQuery(), queryWithInput(term));
                     }
                 },
                 results: function(data, page) {
                     return {
                         results: formatResults(data)
                     };
                 },
                 error: function (jqXHR, status, error) {
                     if(errorResults != null){
                         return { results: errorResults()};
                     }
                     else {
                         return { results: formatResults(null)};
                    }
                 },
                 params: {
                     //Any error like url itself is not a valid one
                     error: function(response) {
                         console.log("Error while fetching data for "+element+ " : " + response.responseText);
                         if(paramsError != null)
                             paramsError(response);
                     }
                 }
             },
             initSelection: function(element, callback) {
                 if(initSelectionFunction != null){
                     initSelectionFunction(element, callback);
                 }
                 else{ //default initSelection implementation
                     callback({
                         id: element.val(),
                         text: element.val()
                     }); 
                 }
             },
             createSearchChoice:function(term, data) {
                 //This creates search choice with query/search term
                 return {id:term, text:term};
             },
             formatNoMatches: function (term) {
                 return "Keep typing...";
             },
         });
        }//end of function
        //enable space, page and attachment elements select2 dynamic searchable
        initSelect2(dataLocationSpace, "Select a space...", searchUrl, defaultSpaceQuery, spaceQueryWithInput, formatSpaceResults, null, null, initSelectionSpace);
        initSelect2(dataLocationPage, "Select a page...", searchUrl, defaultPageQuery, pageQueryWithInput, formatPageResults, null, null, initSelectionPage);
        initSelect2(dataLocationAttachment, "Select an attachment...", getAttachmentSearchUrl, null, null, formatAttachmentResults, errorAttachmentResults, errorAttachmentParams, null);
         
    });
    
    // Save handler code script macro param supported macrosat. 
    $(document).on('appfireEditorBeforeSave appfireEditorBeforePreview', "[data-datalocationfields=true]", function(evt, macroParms, dialog, form, defaultParms, macroName) {
        //construct script param back from splitted params and remove the non macro params
        var dataSource = dialog.find(".appfire-table-datalocation").val();
        if (dataSource === "attachment"){
            var space = macroParms["attSpace"];
            var page = macroParms["attPage"];
            var attachment = (macroParms["attachment"] !== tablebasecme.NO_ATTACHMENT_FOUND ?  "^"+macroParms["attachment"] : "");
            if(tablebasecme.specialPageValues.hasOwnProperty(page.toLowerCase())) {
                if ("@self" == page.toLowerCase()) {
                    macroParms["script"] = attachment;
                } else {
                    macroParms["script"] = page + attachment;
                }
            }
            else{
                if(space !== tablebasecme.CURRENT_SPACE){
                    macroParms["script"] = space + ":" + page + attachment;
                }
                else{//if current space
                    //if current page, then need not save space or page to be backward compatible    
                    if(page === tablebasecme.CURRENT_PAGE){
                        //delete macroParms["attachmentPage"];
                        macroParms["script"] = attachment;
                    }
                    else{
                       //if current space but different page, then just save 'page' to be backward compatible   
                        macroParms["script"] = page + attachment; 
                    }
                }
            }
        }
        else if (dataSource === "filename" && macroParms["filename"]){
            macroParms["script"] = "#"+macroParms["filename"];
        }
        else if (dataSource === "template" && macroParms["template"]){
            macroParms["script"] = macroParms["template"];
        }
        //if datasource is not url or profile then need not retain url and profile related params
        if (dataSource !== "url" && dataSource !== "profile"){
            delete macroParms["user"];
            delete macroParms["password"];
            delete macroParms["url"];
            delete macroParms["profileUrl"];
         }
        //If dataSource chosen is profile, then profileUrl has to be mapped with url param and unnecessary params user/password associated with dataSource 'URL' shall be cleaned 
        if (dataSource == "profile" ){
            delete macroParms["password"];
            delete macroParms["user"];
            delete macroParms["url"];
            if(macroParms["profileUrl"] !== ""){
                macroParms["url"] = macroParms["profileUrl"];
            }
         }
        //if dataSource chosen is url, then profile need not be considered.
        if (dataSource == "url" ){
            delete macroParms["profile"];
         }
        
        delete macroParms["template"];
        delete macroParms["filename"];
        delete macroParms["attSpace"];
        delete macroParms["attPage"];
        delete macroParms["attachment"];
        delete macroParms["dataLocation"];
        delete macroParms["profileUrl"];
    });
}(window.tablebasecme = window.tablebasecme || {}, AJS.$));


}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.profile-picture:profile-picture-editor_resources', location = 'js/profile-picture.js' */
AJS.bind("init.rte",function(){AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("viewProfile",function(a,d){a=AJS.$(d);var c={};a.attr("data-macro-parameters")&&AJS.$.each(a.attr("data-macro-parameters").split("|"),function(b,e){b=e.split("\x3d");c[b[0]]=b[1]});window.open(AJS.Confluence.getBaseUrl()+"/display/~"+c.User).opener=null})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = 'templates/view-file-macro-editor.soy' */
// This file was automatically generated from view-file-macro-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.ViewFileMacro.Templates.Editor.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.ViewFileMacro == 'undefined') { Confluence.ViewFileMacro = {}; }
if (typeof Confluence.ViewFileMacro.Templates == 'undefined') { Confluence.ViewFileMacro.Templates = {}; }
if (typeof Confluence.ViewFileMacro.Templates.Editor == 'undefined') { Confluence.ViewFileMacro.Templates.Editor = {}; }


Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader = function(opt_data, opt_ignored) {
  return '<div class="view-file-property-panel-header"><span class="file-name"><span class="aui-icon aui-icon-small ' + soy.$$escapeHtml(opt_data.fileIcon) + '"></span>' + soy.$$escapeHtml(opt_data.fileName) + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader.soyTemplateName = 'Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-properties-panel.js' */
define("vfm/components/view-file-macro-properties-panel","jquery underscore ajs confluence/legacy confluence/jsUri tinymce vfm/view-file-macro-utils".split(" "),function(h,m,e,r,x,l,n){function y(a,d){var b=m.find(Object.keys(p),function(z){return p[z]===d});if(b)for(var c=0,f=a.length;c<f;c++){var g=a[c],k=g.className.replace(" active","");-1!==k.indexOf("macro-property-panel-"+b)&&(k+=" active");g.className=k}}function A(a){var d=m.reject(a,function(c){return-1<c.className.indexOf("macro-placeholder-property-panel-edit-button")||
-1<c.className.indexOf("macro-placeholder-property-panel-remove-button")});a.splice(0,a.length);for(var b=0;b<d.length;b++)a.push(d[b])}function t(a,d){a=new x(a);""!==a.getQueryParamValue("height")&&a.replaceQueryParam("height",d);return a.toString()}function u(a){a=a.attr("data-macro-parameters");for(var d=[],b="",c=0;c<a.length;c++){var f=a[c];"\\"===f?(b+=f,c+1!==a.length&&(b+=a[++c])):"|"===f?(d.push(b),b=""):b+=f}d.push(b);return d}function v(a,d){a=u(a);return(a=m.find(a,function(b){return 0<=
b.indexOf(d+"\x3d")}))?a.split("\x3d")[1]:null}function q(a,d){if(-1===h(a).attr("class").indexOf("active")){e.Confluence.PropertyPanel.destroy();var b=Object.keys(p),c=h(a).attr("class");for(a=0;a<b.length;a++)if(-1!==c.indexOf(b[a])){var f=p[b[a]];c=h(d);c.attr("height",f);var g=c.attr("src");null!=g&&0<=g.indexOf("/servlet/view-file-macro/placeholder")&&(c.attr("src",t(c.attr("src"),f)),c.attr("data-mce-src",t(c.attr("data-mce-src"),f)),l.isGecko&&e.Rte.getEditor().execCommand("mceRepaint",!1));
f="height\x3d"+f;g=u(c);var k=v(c,"height");k?(k=m.indexOf(g,"height\x3d"+k),g[k]=f):g.push(f);c.attr("data-macro-parameters",g.join("|"));l.activeEditor.undoManager.add();h(d).click();c=l.activeEditor.getDoc().createRange();c.setStartBefore(d);c.setEndAfter(d);l.activeEditor.getDoc().getSelection().addRange(c);e.trigger("analyticsEvent",{name:"confluence.view-file.resize."+b[a].substring(b[a].lastIndexOf("-")+1,b[a].length)});break}}}function B(){e.bind("created.property-panel",function(a,d){var b=
h(d.anchor);if("view-file"===b.attr("data-macro-name")){a=r.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader;var c=v(b,"name");b=n.getParameterByName(b.attr("src"),"mimeType");b=e.Confluence.FileTypesUtils.getAUIIconFromMime(b);a=h(a({fileName:c,fileIcon:b}));d.panel.find(".aui-property-panel").prepend(a);d.shouldFlip&&d.tip.css({top:d.panel.outerHeight()})}})}var p={"view-file-size-small":"150","view-file-size-medium":"250","view-file-size-large":"400"},w=[{className:"macro-property-panel-view-file-size-small editor-resize resize-small",
text:"",tooltip:"\u5c0f\u578b\u7f29\u7565\u56fe",iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:q},{className:"macro-property-panel-view-file-size-medium editor-resize resize-medium",text:"",tooltip:"\u4e2d\u7f29\u7565\u56fe",iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:q},{className:"macro-property-panel-view-file-size-large editor-resize resize-large",text:"",tooltip:"\u5927\u7f29\u7565\u56fe",
iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:q},null,{className:"macro-property-panel-view-file-convert-to-link",text:"\u4f5c\u4e3a\u94fe\u63a5\u663e\u793a",tooltip:"\u4f5c\u4e3a\u94fe\u63a5\u663e\u793a",click:function(a,d){e.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-link-trigger"});e.Confluence.PropertyPanel.destroy();(function(b){b=n.getParameterByName(h(b).attr("src"),"attachmentId");
b=e.REST.makeUrl("attachment/"+b+".json");h.ajax({type:"GET",url:b,contentType:"application/json; charset\x3dutf-8",dataType:"json"}).success(function(c){c=r.Link.fromREST(c).insert();l.activeEditor.undoManager.add();l.activeEditor.focus();c.click()})})(d)}}];return{init:function(){e.Confluence.PropertyPanel.Macro.registerInitHandler(function(a,d,b){A(d);a=h(a);b=a.attr("data-mce-src");if(!(b&&-1<b.indexOf("placeholder/unknown-attachment"))){b=0;for(var c=w.length;b<c;b++)d.push(w[b]);(a=a.attr("height"))||
(a="comment"===e.Meta.get("content-type")?n.DEFAULT_HEIGHT_IN_COMMENT:n.DEFAULT_HEIGHT);y(d,a)}},"view-file");B()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-link-properties-panel.js' */
define("vfm/components/view-file-macro-link-properties-panel",["jquery","ajs","tinymce","vfm/view-file-macro-utils"],function(f,b,g,l){function m(c){if(c){var d=f(c);c=d.attr("data-linked-resource-type");d=d.attr("data-linked-resource-content-type");return b.MacroBrowser.getMacroMetadata("view-file")&&"attachment"===c&&!(d&&0===d.indexOf("image"))}return!1}function n(c){var d=b.REST.makeUrl("attachment/"+f(c).attr("data-linked-resource-id")+".json");f.ajax({type:"GET",url:d,contentType:"application/json; charset\x3dutf-8",
dataType:"json"}).success(function(a){var e={name:a.fileName};b.Data.get("content-id")!==a.ownerId&&(e.page=a.parentTitle,e.space=a.space.key,"blogpost"===a.parentContentType&&(a=a.createdDate.date.split("-"),e.date=a[0]+"/"+a[1]+"/"+a[2].substring(0,2)+"/"));e.height="comment"===b.Meta.get("content-type")?l.DEFAULT_HEIGHT_IN_COMMENT:l.DEFAULT_HEIGHT;e={contentId:b.Meta.get("content-id")||"0",macro:{name:"view-file",params:e}};g.confluence.MacroUtils.insertMacro(e,c).done(function(h){f(h).click();
const k=g.activeEditor.getDoc().createRange();k.setStartBefore(h);k.setEndAfter(h);g.activeEditor.getDoc().getSelection().addRange(k)})})}return{init:function(){b.bind("link-property-panel-buttons.created",function(c,d){c=d.buttons;var a=d.link;m(a)&&c.push({className:"link-property-panel-convert-to-thumbnail-button",text:"\u4f5c\u4e3a\u7f29\u7565\u56fe\u663e\u793a",tooltip:"\u4f5c\u4e3a\u7f29\u7565\u56fe\u663e\u793a",click:function(){b.Confluence.PropertyPanel.destroy();
n(a);b.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-thumbnail-trigger"})}})})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/vfm-editor-poller.js' */
define("vfm/components/vfm-editor-poller","ajs jquery underscore tinymce vfm/view-file-macro-utils vfm/services/conversion-service".split(" "),function(x,m,r,k,a,t){function v(){if(k.activeEditor&&l){var n=m("img[data-macro-name\x3d'view-file'][src*\x3d'thumbnailStatus\x3d"+a.THUMBNAIL_STATUS_IN_PROGRESS+"'][data-thumbnail-status!\x3d'"+a.THUMBNAIL_STATUS_ERROR+"']",k.activeEditor.dom.doc);if(0<n.length){var u=!1;n.each(function(){var d=m(this).attr("src"),c=a.getParameterByName(d,"attachmentId");
d=a.getParameterByName(d,"version");b[c]&&b[c].version===d||(b[c]={version:d},u=!0)});u&&(f=a.THUMBNAIL_POLLING_PERIOD);t.postThumbnailConversionResults(b).then(function(d){k.activeEditor&&l&&(r.each(d,function(c,e){if(b[e]){var p=m("img[data-macro-name\x3d'view-file'][src*\x3d'attachmentId\x3d"+e+"']",k.activeEditor.dom.doc),h=b[e].version;p.attr("data-thumbnail-status",c);c===a.THUMBNAIL_STATUS_CONVERTED?(c=p.attr("src"),h=t.getThumbnailUrl(e,h),h=a.addParamsToUrl(h,{attachmentId:e,mimeType:a.getParameterByName(c,
"mimeType")}),p.attr("src",h),delete b[e]):c===a.THUMBNAIL_STATUS_ERROR&&delete b[e]}}),f=r.isEmpty(b)?a.THUMBNAIL_POLLING_PERIOD:f*w,q())})}else 0===n.length&&(f=a.THUMBNAIL_POLLING_PERIOD,q())}}function q(){l=!0;g&&clearTimeout(g);g=setTimeout(v,f)}var g,l=!1,b={},f=a.THUMBNAIL_POLLING_PERIOD,w=a.THUMBNAIL_POLLING_BACKOFF_RATIO;return{startPolling:q,stopPolling:function(){g&&(clearTimeout(g),g=void 0);l=!1;b={};f=a.THUMBNAIL_POLLING_PERIOD}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/vfm-editor.js' */
require(["ajs","tinymce","vfm/components/view-file-macro-properties-panel","vfm/components/view-file-macro-link-properties-panel","vfm/components/vfm-editor-poller"],function(a,c,e,f,d){a.toInit(function(){a.MacroBrowser.setMacroJsOverride("view-file",{opener:function(b){}});e.init();f.init()});c.create("tinymce.plugins.ViewFilePoller",{init:function(b){a.bind("rte-ready",function(){d.startPolling()});a.bind("rte-destroyed",function(){d.stopPolling()})}});c.PluginManager.add("viewFilePoller",c.plugins.ViewFilePoller);
a.Rte.BootstrapManager.addTinyMcePluginInit(function(b){b.plugins+=",viewFilePoller"})},void 0,!0);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:fancy-box', location = '/includes/fancybox/jquery.fancybox-1.3.4.js' */
(function(a){var n,s,t,e,z,l,A,i,w,x,q=0,d={},o=[],p=0,b={},j=[],C=null,m=new Image,F=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,Q=/[^\.]\.(swf)\s*$/i,G,H=1,v=0,u="",r,g,k=!1,y=a.extend(a("<div></div>")[0],{prop:0}),I=a.browser.msie&&7>a.browser.version&&!window.XMLHttpRequest,J=function(){s.hide();m.onerror=m.onload=null;C&&C.abort();n.empty()},K=function(){!1===d.onError(o,q,d)?(s.hide(),k=!1):(d.titleShow=!1,d.width="auto",d.height="auto",n.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),
B())},E=function(){var c=o[q],b,f,e,g,j,i;J();d=a.extend({},a.fn.fancybox.defaults,"undefined"==typeof a(c).data("fancybox")?d:a(c).data("fancybox"));i=d.onStart(o,q,d);if(!1===i)k=!1;else{"object"==typeof i&&(d=a.extend(d,i));e=d.title||(c.nodeName?a(c).attr("title"):c.title)||"";d.orig=a(c).is("img")&&a(c);c.nodeName&&!d.orig&&(d.orig=a(c).children("img:first").length?a(c).children("img:first"):a(c));""===e&&(d.orig&&d.titleFromAlt)&&(e=d.orig.attr("alt"));b=d.href||(c.nodeName?a(c).attr("href"):
c.href)||null;if(/^(?:javascript)/i.test(b)||"#"==b)b=null;d.type?(f=d.type,b||(b=d.content)):d.content?f="html":d.dataAttr?(f="dataAttribute",b=d.orig.attr("data-"+d.dataAttr)):b&&(f=b.match(F)?"image":b.match(Q)?"swf":a(c).hasClass("iframe")?"iframe":0===b.indexOf("#")?"inline":"ajax");if(f)switch("inline"==f&&(c=b.substr(b.indexOf("#")),f=0<a(c).length?"inline":"ajax"),d.type=f,d.href=b,d.title=e,d.autoDimensions&&("html"==d.type||"inline"==d.type||"ajax"==d.type?(d.width="auto",d.height="auto"):
d.autoDimensions=!1),d.modal&&(d.overlayShow=!0,d.hideOnOverlayClick=!1,d.hideOnContentClick=!1,d.enableEscapeButton=!1,d.showCloseButton=!1),d.padding=parseInt(d.padding,10),d.margin=parseInt(d.margin,10),n.css("padding",d.padding+d.margin),a(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){a(this).replaceWith(l.children())}),f){case "html":n.html(d.content);B();break;case "inline":if(!0===a(c).parent().is("#fancybox-content")){k=!1;break}a('<div class="fancybox-inline-tmp"></div>').hide().insertBefore(a(c)).bind("fancybox-cleanup",
function(){a(this).replaceWith(l.children())}).bind("fancybox-cancel",function(){a(this).replaceWith(n.children())});a(c).appendTo(n);B();break;case "image":case "dataAttribute":k=!1;a.fancybox.showActivity();m=new Image;m.onerror=function(){K()};m.onload=function(){k=true;m.onerror=m.onload=null;d.width=m.width;d.height=m.height;a("<img />").attr({id:"fancybox-img",src:m.src,alt:d.title}).appendTo(n);L()};m.src=b;break;case "swf":d.scrolling="no";g='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+
d.width+'" height="'+d.height+'"><param name="movie" value="'+b+'"></param>';j="";a.each(d.swf,function(a,c){g=g+('<param name="'+a+'" value="'+c+'"></param>');j=j+(" "+a+'="'+c+'"')});g+='<embed src="'+b+'" type="application/x-shockwave-flash" width="'+d.width+'" height="'+d.height+'"'+j+"></embed></object>";n.html(g);B();break;case "ajax":k=!1;a.fancybox.showActivity();d.ajax.win=d.ajax.success;C=a.ajax(a.extend({},d.ajax,{url:b,data:d.ajax.data||{},error:function(a){a.status>0&&K()},success:function(a,
c,f){if((typeof f=="object"?f:C).status==200){if(typeof d.ajax.win=="function"){i=d.ajax.win(b,a,c,f);if(i===false){s.hide();return}if(typeof i=="string"||typeof i=="object")a=i}n.html(a);B()}}}));break;case "iframe":L()}else K()}},B=function(){var c=d.width,b=d.height,c=-1<c.toString().indexOf("%")?parseInt((a(window).width()-2*d.margin)*parseFloat(c)/100,10)+"px":"auto"==c?"auto":c+"px",b=-1<b.toString().indexOf("%")?parseInt((a(window).height()-2*d.margin)*parseFloat(b)/100,10)+"px":"auto"==b?
"auto":b+"px";n.wrapInner('<div style="width:'+c+";height:"+b+";overflow: "+("auto"==d.scrolling?"auto":"yes"==d.scrolling?"scroll":"hidden")+';position:relative;"></div>');d.width=n.width();d.height=n.height();L()},L=function(){var c,h;s.hide();if(e.is(":visible")&&!1===b.onCleanup(j,p,b))a.event.trigger("fancybox-cancel"),k=!1;else{k=!0;a(l.add(t)).unbind();a(window).unbind("resize.fb scroll.fb");a(document).unbind("keydown.fb");e.is(":visible")&&"outside"!==b.titlePosition&&e.css("height",e.height());
j=o;p=q;b=d;if(b.overlayShow){if(t.css({"background-color":b.overlayColor,opacity:b.overlayOpacity,cursor:b.hideOnOverlayClick?"pointer":"auto",height:a(document).height()}),!t.is(":visible")){if(I)a("select:not(#fancybox-tmp select)").filter(function(){return"hidden"!==this.style.visibility}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"});t.show()}}else t.hide();c=M();var f={},D=b.autoScale,m=2*b.padding;f.width=-1<b.width.toString().indexOf("%")?parseInt(c[0]*
parseFloat(b.width)/100,10):b.width+m;f.height=-1<b.height.toString().indexOf("%")?parseInt(c[1]*parseFloat(b.height)/100,10):b.height+m;if(D&&(f.width>c[0]||f.height>c[1]))if("image"==d.type||"dataAttribute"==d.type||"swf"==d.type){if(D=b.width/b.height,f.width>c[0]&&(f.width=c[0],f.height=parseInt((f.width-m)/D+m,10)),f.height>c[1])f.height=c[1],f.width=parseInt((f.height-m)*D+m,10)}else f.width=Math.min(f.width,c[0]),f.height=Math.min(f.height,c[1]);f.top=parseInt(Math.max(c[3]-20,c[3]+0.5*(c[1]-
f.height-40)),10);f.left=parseInt(Math.max(c[2]-20,c[2]+0.5*(c[0]-f.width-40)),10);g=f;u=b.title||"";v=0;i.empty().removeAttr("style").removeClass();if(!1!==b.titleShow&&(u=a.isFunction(b.titleFormat)?b.titleFormat(u,j,p,b):u&&u.length?"float"==b.titlePosition?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+u+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+
b.titlePosition+'">'+u+"</div>":!1)&&""!==u)switch(i.addClass("fancybox-title-"+b.titlePosition).html(u).appendTo("body").show(),b.titlePosition){case "inside":i.css({width:g.width-2*b.padding,marginLeft:b.padding,marginRight:b.padding});v=i.outerHeight(!0);i.appendTo(z);g.height+=v;break;case "over":i.css({marginLeft:b.padding,width:g.width-2*b.padding,bottom:b.padding}).appendTo(z);break;case "float":i.css("left",-1*parseInt((i.width()-g.width-40)/2,10)).appendTo(e);break;default:i.css({width:g.width-
2*b.padding,paddingLeft:b.padding,paddingRight:b.padding}).appendTo(e)}i.hide();e.is(":visible")?(a(A.add(w).add(x)).hide(),c=e.position(),r={top:c.top,left:c.left,width:e.width(),height:e.height()},h=r.width==g.width&&r.height==g.height,l.fadeTo(b.changeFade,0.3,function(){var c=function(){l.html(n.contents()).fadeTo(b.changeFade,1,N)};a.event.trigger("fancybox-change");l.empty().removeAttr("filter").css({"border-width":b.padding,width:g.width-2*b.padding,height:d.autoDimensions?"auto":g.height-
v-2*b.padding});h?c():(y.prop=0,a(y).animate({prop:1},{duration:b.changeSpeed,easing:b.easingChange,step:O,complete:c}))})):(e.removeAttr("style"),l.css("border-width",b.padding),"elastic"==b.transitionIn?(r=P(),l.html(n.contents()),e.show(),b.opacity&&(g.opacity=0),y.prop=0,a(y).animate({prop:1},{duration:b.speedIn,easing:b.easingIn,step:O,complete:N})):("inside"==b.titlePosition&&0<v&&i.show(),l.css({width:g.width-2*b.padding,height:d.autoDimensions?"auto":g.height-v-2*b.padding}).html(n.contents()),
e.css(g).fadeIn("none"==b.transitionIn?0:b.speedIn,N)))}},N=function(){a.support.opacity||(l.get(0).style.removeAttribute("filter"),e.get(0).style.removeAttribute("filter"));d.autoDimensions&&l.css("height","auto");e.css("height","auto");u&&u.length&&i.show();b.showCloseButton&&A.show();(b.enableEscapeButton||b.enableKeyboardNav)&&a(document).bind("keydown.fb",function(c){if(c.keyCode==27&&b.enableEscapeButton){c.preventDefault();a.fancybox.close()}else if((c.keyCode==37||c.keyCode==39)&&b.enableKeyboardNav&&
c.target.tagName!=="INPUT"&&c.target.tagName!=="TEXTAREA"&&c.target.tagName!=="SELECT"){c.preventDefault();a.fancybox[c.keyCode==37?"prev":"next"]()}});b.showNavArrows?((b.cyclic&&1<j.length||0!==p)&&w.show(),(b.cyclic&&1<j.length||p!=j.length-1)&&x.show()):(w.hide(),x.hide());b.hideOnContentClick&&l.bind("click",a.fancybox.close);b.hideOnOverlayClick&&t.bind("click",a.fancybox.close);a(window).bind("resize.fb",a.fancybox.resize);b.centerOnScroll&&a(window).bind("scroll.fb",a.fancybox.center);"iframe"==
b.type&&a('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(a.browser.msie?'allowtransparency="true""':"")+' scrolling="'+d.scrolling+'" src="'+b.href+'"></iframe>').appendTo(l);e.show();k=!1;a.fancybox.center();b.onComplete(j,p,b);var c,h;j.length-1>p&&(c=j[p+1].href,"undefined"!==typeof c&&c.match(F)&&(h=new Image,h.src=c));0<p&&(c=j[p-1].href,"undefined"!==typeof c&&c.match(F)&&(h=new Image,h.src=c))},O=function(a){var d={width:parseInt(r.width+
(g.width-r.width)*a,10),height:parseInt(r.height+(g.height-r.height)*a,10),top:parseInt(r.top+(g.top-r.top)*a,10),left:parseInt(r.left+(g.left-r.left)*a,10)};"undefined"!==typeof g.opacity&&(d.opacity=0.5>a?0.5:a);e.css(d);l.css({width:d.width-2*b.padding,height:d.height-v*a-2*b.padding})},M=function(){return[a(window).width()-2*b.margin,a(window).height()-2*b.margin,a(document).scrollLeft()+b.margin,a(document).scrollTop()+b.margin]},P=function(){var c=d.orig?a(d.orig):!1,h={};c&&c.length?(h=c.offset(),
h.top+=parseInt(c.css("paddingTop"),10)||0,h.left+=parseInt(c.css("paddingLeft"),10)||0,h.top+=parseInt(c.css("border-top-width"),10)||0,h.left+=parseInt(c.css("border-left-width"),10)||0,h.width=c.width(),h.height=c.height(),h={width:h.width+2*b.padding,height:h.height+2*b.padding,top:h.top-b.padding-20,left:h.left-b.padding-20}):(c=M(),h={width:2*b.padding,height:2*b.padding,top:parseInt(c[3]+0.5*c[1],10),left:parseInt(c[2]+0.5*c[0],10)});return h},R=function(){s.is(":visible")?(a("div",s).css("top",
-40*H+"px"),H=(H+1)%12):clearInterval(G)};a.fn.fancybox=function(c){AJS&&AJS.log("fancybox is deprecated, please use the previewer instead. E.g. $imageLink.previewer({ src: srcOfImage }); ");if(!a(this).length)return this;a(this).data("fancybox",a.extend({},c,a.metadata?a(this).metadata():{})).unbind("click.fb").bind("click.fb",function(c){c.preventDefault();k||(k=!0,a(this).blur(),o=[],q=0,c=a(this).attr("rel")||"",!c||""==c||"nofollow"===c?o.push(this):(o=a("a[rel="+c+"], area[rel="+c+"]"),q=o.index(this)),
E())});return this};a.fancybox=function(c,b){var d;if(!k){k=!0;d="undefined"!==typeof b?b:{};o=[];q=parseInt(d.index,10)||0;if(a.isArray(c)){for(var e=0,g=c.length;e<g;e++)"object"==typeof c[e]?a(c[e]).data("fancybox",a.extend({},d,c[e])):c[e]=a({}).data("fancybox",a.extend({content:c[e]},d));o=jQuery.merge(o,c)}else"object"==typeof c?a(c).data("fancybox",a.extend({},d,c)):c=a({}).data("fancybox",a.extend({content:c},d)),o.push(c);if(q>o.length||0>q)q=0;E()}};a.fancybox.showActivity=function(){clearInterval(G);
s.show();G=setInterval(R,66)};a.fancybox.hideActivity=function(){s.hide()};a.fancybox.next=function(){return a.fancybox.pos(p+1)};a.fancybox.prev=function(){return a.fancybox.pos(p-1)};a.fancybox.pos=function(a){k||(a=parseInt(a,10),o=j,-1<a&&a<j.length?(q=a,E()):b.cyclic&&1<j.length&&(q=a>=j.length?0:j.length-1,E()))};a.fancybox.cancel=function(){k||(k=!0,a.event.trigger("fancybox-cancel"),J(),d.onCancel(o,q,d),k=!1)};a.fancybox.close=function(){function c(){t.fadeOut("fast");i.empty().hide();e.hide();
a.event.trigger("fancybox-cleanup");l.empty();b.onClosed(j,p,b);j=d=[];p=q=0;b=d={};k=!1}if(!k&&!e.is(":hidden"))if(k=!0,b&&!1===b.onCleanup(j,p,b))k=!1;else if(J(),a(A.add(w).add(x)).hide(),a(l.add(t)).unbind(),a(window).unbind("resize.fb scroll.fb"),a(document).unbind("keydown.fb"),l.find("iframe").attr("src",I&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),"inside"!==b.titlePosition&&i.empty(),e.stop(),"elastic"==b.transitionOut){r=P();var h=e.position();g={top:h.top,
left:h.left,width:e.width(),height:e.height()};b.opacity&&(g.opacity=1);i.empty().hide();y.prop=1;a(y).animate({prop:0},{duration:b.speedOut,easing:b.easingOut,step:O,complete:c})}else e.fadeOut("none"==b.transitionOut?0:b.speedOut,c)};a.fancybox.resize=function(){t.is(":visible")&&t.css("height",a(document).height());a.fancybox.center(!0)};a.fancybox.center=function(a){var d,f;if(!k&&(f=!0===a?1:0,d=M(),f||!(e.width()>d[0]||e.height()>d[1])))e.stop().animate({top:""+parseInt(Math.max(d[3]-20,d[3]+
0.5*(d[1]-l.height()-40)-b.padding),10),left:""+parseInt(Math.max(d[2]-20,d[2]+0.5*(d[0]-l.width()-40)-b.padding),10)},"number"==typeof a?a:200)};a.fancybox.init=function(){a("#fancybox-wrap").length||(a("body").append(n=a('<div id="fancybox-tmp"></div>'),s=a('<div id="fancybox-loading"><div></div></div>'),t=a('<div id="fancybox-overlay"></div>'),e=a('<div id="fancybox-wrap"></div>')),z=a('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(e),
z.append(l=a('<div id="fancybox-content"></div>'),A=a('<a id="fancybox-close"></a>'),i=a('<div id="fancybox-title"></div>'),w=a('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),x=a('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')),A.click(a.fancybox.close),s.click(a.fancybox.cancel),w.click(function(c){c.preventDefault();a.fancybox.prev()}),x.click(function(c){c.preventDefault();a.fancybox.next()}),
a.fn.mousewheel&&e.bind("mousewheel.fb",function(c,b){if(k)c.preventDefault();else if(0==a(c.target).get(0).clientHeight||a(c.target).get(0).scrollHeight===a(c.target).get(0).clientHeight)c.preventDefault(),a.fancybox[0<b?"prev":"next"]()}),a.support.opacity||e.addClass("fancybox-ie"),I&&(s.addClass("fancybox-ie6"),e.addClass("fancybox-ie6"),a('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(z)))};
a.fn.fancybox.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:0.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,
showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};a(document).ready(function(){a.fancybox.init()})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-editor-iframe.js' */
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {

        var openDiagram = function (options) {

            var editorCloseCallbackFunctions = [];
            var editorCloseCallback = function(closeEvent) {
                editorCloseCallbackFunctions.forEach(function(currentValue/*, index, array*/) {
                    currentValue(closeEvent);
                });
            };

            // fire event on close
            editorCloseCallbackFunctions.push(function (closeEvent) {
                AJS.trigger("gliffy.confluence.inlineEditorClosed");
            });
            // Diagram JSON .gon data exists
            if(options.gonContent) {
                options.editor.html5Editor.open({
                    jsonObj: options.gonContent,
                    dirty: true
                });

            // Blank diagram template (new, empty diagram)
            } else if (options.template.category == "com.gliffy.templates.blank") {
                options.editor.html5Editor.create(null, options.template.panels);

            // Existing diagram attachment
            } else if (options.template.category == "com.gliffy.diagram") {

                options.editor.html5Editor.open({
                    url:AJS.format("/diagrams/{0}", options.attachmentId)
                });
            // Transform?
            } else if (options.template.category == "com.gliffy.transform.diagram") {
                options.editor.html5Editor.open({
                    url:AJS.format("/templates/transform/{0}", options.template.name),
                    dirty:true
                });

            // Open an html5 template?
            } else {
                options.editor.html5Editor.open({
                    url:AJS.format("/templates/{0}",
                        options.template.name),
                    useShapeStyles:false,
                    dirty:true
                });
            }

            options.editor.show();

            // GCONF-1941: editor focus problem
            GLIFFY.confluence.fixEditorFocus();

            // GCONF-1914: Attach close callback to base editor.
            options.editor.html5Editor.postCloseCallback = editorCloseCallback;
        };

        // Launches the editor when in page edit mode (not page view mode).
        var launchInlineEditor = function (options) {
            options = $.extend({
                diagramName:null,
                template:{category:"com.gliffy.templates.blank", name:"com.gliffy.template.blank"},
                attachmentId:null,
                panels:null
            }, options);

            options.editor.loadedCallback = function(draft) {
                if (draft) {
                    options.gonContent = draft;                    
                }
                openDiagram(options);
            }

            // Always update URL as it is used for pinned version dialog logic
            var url;
            if(options.ownerPageId) {
                url = AJS.format("{0}/plugins/gliffy/editor.action?ceoid={1}&inline=true&pageId={2}&attachmentVersion={3}&originalAttachmentVersion={4}&isPinned={5}&wootric={6}",
                    AJS.Confluence.getContextPath(), options.ownerPageId,
                    options.referencePageId, options.attachmentVersion,
                    options.originalAttachmentVersion || options.attachmentVersion || 0,
                    options.isPinned, options.wootric);
            } else {
                url = AJS.format("{0}/plugins/gliffy/editor.action?ceoid={1}&version={2}&pagePin={3}&wootric={4}",
                    AJS.Confluence.getContextPath(),
                    Confluence.Editor.getContentId(),
                    options.isPinned || 0, options.wootric);
            }
            url += options.diagramName ? '&name=' + encodeURIComponent(options.diagramName) : '';
            url += options.displayName ? '&displayName=' + encodeURIComponent(options.displayName) : '';
            url += options.macroId ? '&macroId=' + options.macroId : '';

            if (!options.editor.obj) {
                // setup the html5 editor iframe. the iframe will load the diagram via the GLIFFY._confluence.editor.loaded function
                // Wait blanket + spinner
                $("body").append($('<div class="gliffy-spinner gliffy-spinner-icon"></div><div class="gliffy-spinner gliffy-spinner-bg"></div>'));
                options.editor.obj = $("<iframe />", {src:url, id:"gliffy-editor"})
                    .css({
                        position:"absolute",
                        width:"100%",
                        height:"100%",
                        top:0,
                        left:0,
                        border:0
                    }).appendTo("body");
            } else {
                options.editor.obj.attr("src", url);
                openDiagram(options);
            }
        };

        AJS.bind("gliffy.confluence.launchInlineEditor", function (event, options) {
            launchInlineEditor(options);
        });

        // Launch the Editor with diagram JSON .gon data
        AJS.bind("gliffy.confluence.launchEditorWithGonData", function (event, gonContent) {
            try {
                if (GLIFFY._confluence.macroDialog) {
                    GLIFFY._confluence.macroDialog.hide();
                }
            }
            catch (e) {
                console.log("Error hiding Gliffy macro dialog on gliffy.confluence.launchEditorWithGonData: " + e);
            }
            launchInlineEditor({
                editor:GLIFFY._confluence.editor,
                gonContent:gonContent
            });
        });

        AJS.bind("gliffy.confluence.launchTemplate", function (event, category, name, panels) {
            try {
                if (GLIFFY._confluence.macroDialog) {
                    GLIFFY._confluence.macroDialog.hide();
                }
            }
            catch (e) {
                console.log("Error hiding Gliffy macro dialog on gliffy.confluence.launchTemplate: " + e);
            }
            launchInlineEditor({
                editor:GLIFFY._confluence.editor,
                template:{category:category, name:name, panels:panels}
            });
        });

        AJS.bind("gliffy.confluence.addGliffyDiagramToPage", function (event, category, name) {
            try {
                if (GLIFFY._confluence.macroDialog) {
                    GLIFFY._confluence.macroDialog.hide();
                }
            }
            catch (e) {
                console.log("Error hiding Gliffy macro dialog on gliffy.confluence.addGliffyDiagramToPage: " + e);
            }
            var macroRenderRequest = {
                contentId:Confluence.Editor.getContentId(),
                macro:{
                    name:"gliffy",
                    params:{name:name, blueprint:category},
                    defaultParameterValue:"",
                    body:""
                }
            };
            GLIFFY.confluence.insertMacro(macroRenderRequest);
        });
    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/PromiseJS.js' */
//Add generic support for Deferred/Promise since the oldest supported version of Confluence uses JQuery 1.4.2
//https://github.com/hemanshubhojak/PromiseJS
(function (global) {

    var states = {
        Pending: "Pending",
        Resolved: "Resolved",
        Rejected: "Rejected"
    };

    //http://jira.gliffy.com/browse/GCONF-1398 For each polyfill!
    if ( !Array.prototype.forEach ) {
        Array.prototype.forEach = function(fn, scope) {
            for(var i = 0, len = this.length; i < len; ++i) {
                if (i in this) {
                    fn.call(scope, this[i], i, this);
                }
            }
        };
    }

    /**
     * @constructor
     */
    function Deferred() {
        var self = this,
            successCallbacks = [],
            failCallbacks = [],
            progressCallbacks = [],
            state = states.Pending,
            value;

        /**
         * @constructor
         */
        function Promise() {
            var self = this;

            self.success = function (callback) {
                if (state === states.Resolved) {
                    callback.call(self, value);
                }
                else {
                    successCallbacks.push(callback);
                }

                return self;
            };

            self.fail = function (callback) {
                if (state === states.Rejected) {
                    callback.call(self, value);
                }
                else {
                    failCallbacks.push(callback);
                }

                return self;
            };

            self.progress = function (callback) {
                progressCallbacks.push(callback);
                return self;
            };

            self.always = function (callback) {
                return self.success(callback).fail(callback);
            };

            self.then = function (onSuccess, onError) {
                return self.success(onSuccess).fail(onError);
            };

            self.isPending = function () {
                return state === states.Pending;
            };

            self.isResolved = function () {
                return state === states.Resolved;
            };

            self.isRejected = function () {
                return state === states.Rejected;
            };

            self.value = function () {
                return value;
            };
        }

        self.promise = new Promise();

        self.resolve = function (result) {
            if (state === states.Pending) {
                state = states.Resolved;
                value = result;
                successCallbacks.forEach(function (cb) {
                    cb.call(self.promise, value);
                });
            }
        };

        self.reject = function (error) {
            if (state === states.Pending) {
                state = states.Rejected;
                value = error;
                failCallbacks.forEach(function (cb) {
                    cb.call(self.promise, value);
                });
            }
        };

        self.notify = function () {
            if (state === states.Pending) {
                progressCallbacks.forEach(function (cb) {
                    cb.call(self.promise);
                });
            }
        };
    }

    function isArray(value) {
        return Object.prototype.toString.call(value) === "[object Array]";
    }

    function when(array) {
        var promises = isArray(array) ? array : Array.prototype.slice.call(arguments, 0),
            total = promises.length, completed = 0,
            d = new Deferred();

        promises.forEach(function (p) {
            p.always(function () {
                completed += 1;

                if (completed === total) {
                    d.resolve(promises);
                }
            });
        });

        return d.promise;
    }

    function executeChain(funcs, deferred, promises) {
        if (funcs.length === 0) {
            deferred.resolve(promises);
        }
        else {
            var promise = funcs[0].call();

            promise.always(function () {
                executeChain(
                    Array.prototype.slice.call(funcs, 1),
                    deferred,
                    promises.concat([promise])
                );
            });
        }
    }

    function chain(array) {
        var funcs = isArray(array) ? array : Array.prototype.slice.call(arguments, 0),
            d = new Deferred();

        if (funcs.length === 0) {
            d.resolve();
        }
        else {
            executeChain(funcs, d, []);
        }

        return d.promise;
    }

    global.PromiseJS = {
        Deferred: Deferred,
        when: when,
        chain: chain
    };

    //  For CommonJS environments
    if( typeof exports !== "undefined" ){
        exports.PromiseJS = global.PromiseJS;
    }

}((function () { return this; }.call())));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-utils.js' */
(function($) {
    AJS.bind("init.rte", function() {
        AJS.trigger("gliffy.init.rte");
    });
}(AJS.$));

AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {

        window["GLIFFY"] = window["GLIFFY"] || {};
        GLIFFY._confluence = GLIFFY._confluence || {};
        GLIFFY._confluence.gvars = {
            gliffyApiEndpoint : AJS.format("{0}/rest/gliffy/1.0", AJS.Confluence.getContextPath()),
            isAutoSearchOn : true, //this should be more tightly coupled with actual logic
            spaces : []
        };
        GLIFFY._confluence.utils = {
            // GJIRA-1890: Enhanced to also handle DOM nodes from RTE.
            getMacroParams : function (macro) {
                var macroParams = {};
                // Look for data from jQuery node.
                var macroParamsString = macro.data && macro.data("macro-parameters");
                // If none, look for data from RTE DOM node.
                macroParamsString = macroParamsString || (macro.dataset && macro.dataset.macroParameters);
                // If string found, parse into params object (KEY1=Value1|KEY2=Value2|KEY3=Value|...)
                if (macroParamsString) {
                    $.each(macroParamsString.split("|"), function (idx, item) {
                        var param = item.split("=");
                        macroParams[param[0]] = param[1];
                    });
                }
                return macroParams;
            },
            getUrlVars : function () {
                var vars = [], hash;
                var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
                for (var i = 0; i < hashes.length; i++) {
                    hash = hashes[i].split('=');
                    vars.push(hash[0]);
                    vars[hash[0]] = decodeURIComponent(hash[1]);
                }
                return vars;
            },
            parseError : function (xhr) {
                if (xhr.responseText != null) {
                    try {
                        var responseObj = $.parseJSON(xhr.responseText);
                        return (responseObj.message != null) ? responseObj.message : xhr.responseText;
                    }
                    catch (e) {
                        return xhr.responseText;
                    }
                }
                return "";
            },
            analyticsEvent : function(type, options){
                $(window).trigger(type+'.gliffyAnalytics', options);
            },

            getAnalyticsLabel : function(){
                return 'none';
            },

            getAnalyticsProduct : function(){
                return 'Confluence';
            },

            getAnalyticsLicense : function(){
                return $('meta[name=gliffy-license-type]').attr("content");
            },

            getAnalyticsNumUsers : function(){
                return parseInt($('meta[name=gliffy-license-quantity]').attr("content"))
            },

            initAnalytics : function(){

                var analyticsLabel = GLIFFY._confluence.utils.getAnalyticsLabel(), deferred;

                //add support for deferred for old versions of confluence. use jQuery deferred once min version of jQuery is 1.5
                deferred = new PromiseJS.Deferred();
                $.ajax({
                    url : AJS.format("{0}/rest/gliffy/1.0/properties/com.gliffy.integration.confluence.ANALYTICS_OFF",
                        Confluence.getContextPath()),
                    type: "GET",
                    cache : false,
                    success: function(analyticsOff) {
                        if (!analyticsOff) {
                            GLIFFY._confluence.utils.analyticsEvent('init', {accountType:'google', accountID:'UA-248648-13', optPageName:'Gliffy Confluence RTE Init'});
                            // to debug analytics, uncomment the following line
                            //GLIFFY._confluence.utils.analyticsEvent('logEvents', {logEvents:true, logger:console});
                            GLIFFY._confluence.utils.analyticsEvent('setLabel', {label:analyticsLabel});
                            GLIFFY._confluence.utils.analyticsEvent('setCustomVariables', {
                                product : GLIFFY._confluence.utils.getAnalyticsProduct(),
                                license : GLIFFY._confluence.utils.getAnalyticsLicense(),
                                numUsers : (GLIFFY._confluence.utils.getAnalyticsNumUsers() + " Users")
                            });
                        }
                        deferred.resolve(data);
                    },
                    error: function(xhr, status, error) {
                        AJS.log('Error determining if analytics is available', error)
                        deferred.reject(xhr);
                    },
                    dataType : "json"
                });
                return deferred.promise;

            }
        };

        //confluence specific methods
        var CMeth = function () {
            var fixEditorFocus = function () {
                //remove this if chrome+mac gets rid of focus issue.
                if (AJS.Rte.getEditorFrame) {
                    $(AJS.Rte.getEditorFrame()).focus();
                }

                // GCONF-1941: fix editor focus. Perhaps AJS.Rte.getEditorFrame may not be set?
                var gliffyEditorIFrame = $("#gliffy-editor")[0];
                if(gliffyEditorIFrame) {
                    gliffyEditorIFrame.contentWindow.focus();
                }
            };
            var originalReplaceNodeFunction = tinymce.confluence.NodeUtils.replaceNode;
            var replaceNode = function (oldNode, newNode) {
                var that =  tinymce.confluence.NodeUtils,
                    ed = tinymce.activeEditor,
                    doc = that.getDoc(),
                    $newNode = $(newNode, doc),
                    $oldNode = $(oldNode, doc);
                /**
                 * Waiting for an image to be fully loaded into the DOM in the background is an asynchronous operation - hence use a jQuery.Deferred here.
                 */
                return $.Deferred(function () {
                    var deferred = this;
                    if ($newNode.is("img")) {
                        /**
                         * Here we're delaying the replacement of the node until the image's src has been
                         * fully loaded by the browser.
                         */
                        $newNode[0].onload = function() {
                            AJS.log("replaceNode: new node's src has been loaded by the browser.");
                            this.onload = null;
                            deferred.resolve(this);
                        };
// In Opera, the src has to be defined after the onLoad callback or it won't work.
                        if ($.browser.opera) {
                            $newNode[0].src = $newNode.attr('src');
                        }
                        //============ gliffy modification ===========//
                        setTimeout(function() {
                            //insert the macro anyway if the image fails to load
                            deferred.resolve($newNode[0]);
                        }, 3000);
                        //============ gliffy modification ===========//
                        /**
                         * Trigger rendering of the new DOM node, in turn requesting the image's src,
                         * ultimately triggering the onLoad event above.
                         */
                        doc.createDocumentFragment().appendChild($newNode[0]);
                    } else {
                        deferred.resolve($newNode[0]);
                    }
                }).done(function(newNode) {
                    $oldNode.replaceWith(newNode);
                }).promise();
            };
            var insertMacro = function (args, nodeToReplace) {
                var deferred, defaultParams = {
                    contentId : Confluence.Editor.getContentId(),
                    macro : { name : "gliffy", params : "", defaultParameterValue : "", body : ""}
                };

                if($.browser.msie && AJS.$.Deferred) {
                    //remove this once https://jira.atlassian.com/browse/CONF-28418 is fixed
                    tinymce.confluence.NodeUtils.replaceNode = replaceNode;
                }

                AJS.Rte.BookmarkManager.restoreBookmark();
                deferred = tinymce.confluence.MacroUtils.insertMacro($.extend(true, defaultParams, args), nodeToReplace);

                if(deferred && deferred.then) {
                    deferred.then(function() {
                        if($.browser.msie) {
                            //remove this once https://jira.atlassian.com/browse/CONF-28418 is fixed
                            tinymce.confluence.NodeUtils.replaceNode = originalReplaceNodeFunction;
                        }
                    }, function() {
                        if($.browser.msie) {
                            //remove this once https://jira.atlassian.com/browse/CONF-28418 is fixed
                            tinymce.confluence.NodeUtils.replaceNode = originalReplaceNodeFunction;
                        }
                    });
                }
                AJS.log("insert gliffy macro");
                fixEditorFocus();
                return deferred;
            };

            var setMacroParam = function(fieldName, fieldValue, param) {
                var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                    return $(this).data("macro-name") === 'gliffy' && $(this).attr("data-macro-parameters").indexOf(fieldName + '=' + fieldValue) != -1;
                });
                macros.each(function(index){
                    var macroData = {
                        contentId: Confluence.Editor.getContentId(),
                        macro:{
                            name:'gliffy',
                            params: GLIFFY._confluence.utils.getMacroParams(macros[index])
                        }
                    };
                    if (!macroData.macro.params.pageid) {
                        //GCONF-2730: Addresses IE10 issue
                        if (macroData.macro.params.name === undefined) {
                            macroData.macro.params.name = name;
                        }
                        macroData.macro.params = Object.assign(macroData.macro.params, param);
                        tinymce.confluence.MacroUtils.insertMacro(macroData, macros[index]);
                    }
                });
            };

            var setPagePin = function(name, version, displayName) {
                var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                    return $(this).data("macro-name") === 'gliffy' && $(this).attr("data-macro-parameters").indexOf('name=' + name) != -1;
                });
                macros.each(function(index){
                    var macroData = {
                        contentId: Confluence.Editor.getContentId(),
                        macro:{
                            name:'gliffy',
                            params: GLIFFY._confluence.utils.getMacroParams(macros[index])
                        }
                    };
                    if (!macroData.macro.params.pageid) {
                        //GCONF-2730: Addresses IE10 issue
                        if (macroData.macro.params.name === undefined) {
                            macroData.macro.params.name = name;
                            macroData.macro.params.displayName = displayName || name;
                        }
                        macroData.macro.params.pagePin = version;
                        macroData.macro.params.displayName = displayName || name;
                        tinymce.confluence.MacroUtils.insertMacro(macroData, macros[index]);
                    }
                });
            };

            var updatePagePinVersion = function(name, version) {
                var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                    return $(this).data("macro-name") === 'gliffy' && $(this).attr("data-macro-parameters").indexOf('name=' + name) != -1;
                });
                macros.each(function(index){
                    var macroData = {
                        contentId: Confluence.Editor.getContentId(),
                        macro:{
                            name:'gliffy',
                            params: GLIFFY._confluence.utils.getMacroParams(macros[index])
                        }
                    };
                    if (!macroData.macro.params.pageid) {
                        //GCONF-2730: Addresses IE10 issue
                        if (macroData.macro.params.name === undefined) {
                            macroData.macro.params.name = name;
                        }
                        macroData.macro.params.version = version;
                        macroData.macro.params.pagePin = version;
                        tinymce.confluence.MacroUtils.insertMacro(macroData, macros[index]);
                    }
                });

            };

            return {
                setMacroParam: setMacroParam,
                setPagePin: setPagePin,
                updatePagePinVersion: updatePagePinVersion,
                getMacroParams : GLIFFY._confluence.utils.getMacroParams,
                insertMacro : insertMacro,
                fixEditorFocus : fixEditorFocus,
                updateMacros : function (macroname) {
                    //find all matching macros in the editor iframe
                    var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                        return $(this).data("macro-name") === macroname;
                    });
                    macros.each(function (index, element) {
                        var macro = $(this);
                        var macroParams = GLIFFY._confluence.utils.getMacroParams(macro);
                        var dataJson = $.toJSON({contentId : Confluence.Editor.getContentId(), macro : {name : macro.data("macro-name"), params : macroParams, body : "", defaultParameterValue : ""}});

                        $.ajax({
                            type : "POST",
                            contentType : "application/json; charset=utf-8",
                            url : Confluence.getContextPath() + "/rest/tinymce/1/macro/placeholder",
                            data : dataJson,
                            dataType : "text",
                            success : function (macroplaceholder) {
                                macro.after(macroplaceholder);
                                macro.remove();
                            }
                        });
                    });
                }
            }
        };
        GLIFFY.confluence = CMeth();

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-editor-html5.js' */
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {
        GLIFFY._confluence.editor = {
            obj:null,
            parentOverflow:null,
            isHtml5:true,
            loadedCallback:null,
            show:function () {
                // GCONF-606 Update Editor position for Editor in inline comment
                $("#gliffy-editor").css("top", $(document).scrollTop());
                this.obj.parent().css("overflow", "hidden");

                if (GLIFFY._confluence.editor.hidden) {
                    if ($.browser.msie) { //GCONF-854 IE9 crashes on hidden iframe operations, see JIRA for details
                        GLIFFY._confluence.editor.obj.css('visibility', 'visible');
                    } else {
                        GLIFFY._confluence.editor.obj.show();
                    }
                    GLIFFY._confluence.editor.hidden = false;
                }

                // GCONF-1941: editor focus problem
                GLIFFY._confluence.editor.html5Editor.focus();

                $("#gliffy-close").show();
                $("#gliffy-load-buttons").hide();
            },

            hide:function () {

                if (!GLIFFY._confluence.editor.hidden) {
                    if ($.browser.msie) { //GCONF-854 IE9 crashes on hidden iframe operations, see JIRA for details
                        GLIFFY._confluence.editor.obj.css('visibility', 'hidden');
                    } else {
                        GLIFFY._confluence.editor.obj.hide();
                    }
                    GLIFFY._confluence.editor.hidden = true;
                }

                $("#gliffy-close").hide();
                $("#gliffy-load-buttons").show();

                // GCONF-606 Update Editor position for Editor in inline comment
                this.obj.parent().css({overflow:this.parentOverflow});
            },
            hidden:false,
            html5Editor:null,
            loaded:function (html5Editor, draft) {
                GLIFFY._confluence.editor.html5Editor = html5Editor;

                // GCONF-606 Update Editor position for Editor in inline comment
                this.parentOverflow = $("#gliffy-editor").parent().css("overflow");
                $(".gliffy-spinner").remove();

                if(this.loadedCallback) {
                    this.loadedCallback(draft);
                }
            },
            hideSpinner : function() {
                $(".gliffy-spinner").remove();
            }
        };

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-macro.js' */
/**
 * Gliffy RTE Macro v2
 * @author Kerry Liu
 */
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {

        //this will attempt to insert thr pagePin property into the macro so that all macros get pinned
        //if the page is saved.
        var pagePinAllUnpinnedMacros = function() {
            var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                return $(this).data("macro-name") === 'gliffy';
            });
            macros.each(function (m) {
                var paramArray = $(this).attr("data-macro-parameters").split('|');
                var params = {};
                _.each(paramArray, function(a) {
                    a = a.split('=');
                    params[a[0]] = a[1];
                });
                if (!params.pagePin && !params.pageid && params.name) {
                    var pageId = Confluence.Editor.getContentId();
                    $.ajax(AJS.contextPath() + '/rest/api/content/' + pageId + '/child/attachment?expand=version&filename=' + encodeURIComponent(params.name)).then(function(resp) {
                        GLIFFY.confluence.setPagePin(params.name, resp.results[0].version.number);
                    }).fail(function(err) {
                        console.log('could not get ' + params.name);
                    });
                }
            });
        };

        var setPagePinVersionForCopyPage = function() {
            var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                return $(this).data("macro-name") === 'gliffy';
            });
            macros.each(function() {
                var paramArray = $(this).attr("data-macro-parameters").split('|');
                var params = {};
                _.each(paramArray, function(a) {
                    a = a.split('=');
                    params[a[0]] = a[1];
                });
                if (params.name) {
                    var pageId = Confluence.Editor.getContentId();
                    $.ajax(AJS.contextPath() + '/rest/api/content/' + pageId + '/child/attachment?expand=version&filename=' + encodeURIComponent(params.name)).then(function(resp) {
                        var attVersion = resp.results[0].version.number;
                        if ( !params.version && params.pagePin > attVersion) {
                            GLIFFY.confluence.setPagePin(params.name, resp.results[0].version.number);
                        } else if (params.version && params.pagePin > attVersion) {
                            GLIFFY.confluence.updatePagePinVersion(params.name, resp.results[0].version.number);
                        }
                    }).fail(function(err) {
                        console.log('could not get ' + params.name);
                    });
                }
            });
        };

        //Ugly hack.  Doesn't seem to be a way to sync the editor content to be ready, so set an interval to
        // check for the page content to become available
        AJS.toInit(function() {

            var contentQuery = setTimeout(function () {
                var html = $(AJS.Rte.getEditor().dom.select('.mceContentBody'));
                if (html.length > 0) {
                    pagePinAllUnpinnedMacros();
                    setPagePinVersionForCopyPage();
                    clearInterval(contentQuery);
                }
            }, 500);
        });



        //note: old versions of confluence uses jQuery < 1.7 avoid using on/off until we no longer support these versions.
        var CreatePanel, Panel, TemplateCategoryPanel, ImportPanel, InsertPanel, BlueprintCategoryPanel,
        //RCB: temporary until we decide whether to launchEditor or drop a diagram directly on the page.
            skipLaunchEditor = false;

        var GliffySpinner = require('GliffySpinner');
        var recentSpinner;
        var importSpinner;
        function analyticsEvent(type, options) {
            $(window).trigger(type + '.gliffyAnalytics', options);
        }

        /******************************************************************/
        /*                         Panels                                 */
        /******************************************************************/
        /*
         Each panel should have the following methods:

         isTemplateCategory() - true if the panel is a template category
         getName() - name of the panel
         getPanelLink() - sidebar li markup
         getTemplate() - returns the html for the panel
         primaryAction(event, baseDialog) - what the panel does, when the primary button is clicked
         getPrimaryButtonText() - i18n text for the primary button ie, "Create" or "Insert Template"
         setup(baseDialog) - bind any necessary handlers/populate your panel (called whenever it is rendered)
         teardown(baseDialog) - unbind any events that were bound to the panel in bindEvents

         Note: Events for elements with class "gliffy-template" are already handled by the macro dialog, and do
         not need to be bound by your panel. Double clicking on a "gliffy-template element, will also trigger
         the primary action.
         */

        Panel = function (name) {
            this.name = name;
        };
        Panel.prototype.isTemplateCategory = function () {
            return false;
        };
        Panel.prototype.getName = function () {
            return this.name;
        };
        Panel.prototype.getPanelLink = function () {
            return gliffySoy.macro.dialog.panelLink({
                key:this.getName(),
                title:this.getPanelText()
            });
        };
        Panel.prototype.getTemplate = function () {
            return "";
        };
        Panel.prototype.getPanelText = function () {
            return "";
        };
        Panel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active");
            //Actual editor launch logic is in gliffy-rte-editor-html5.js
            AJS.trigger('createpagetemplate', [template.data("category"), template.data("name")]);
        };
        Panel.prototype.getPrimaryButtonText = function () {
            return "";
        };
        Panel.prototype.setup = function (baseDialog) {
        };
        Panel.prototype.teardown = function (baseDialog) {
        };

        /******************************************************************/
        /*                      Create Panel                              */
        /******************************************************************/

        CreatePanel = function () {
        };
        CreatePanel.prototype = new Panel("create");
        CreatePanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.createPanel();
        };
        CreatePanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active"),
                name = template.data("name"),
                panels = template.data("panels"),
                isRecent, blankName;
            //Actual editor launch logic is in gliffy-rte-editor-html5.js
            isRecent = name !== "blank";
            blankName = panels ? "blank_" + panels : "blank";
            analyticsEvent('trackEvent', {category:'panelCreate', action:isRecent ? "recent" : blankName});

            if (panels) {
                if (panels === "basic") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.swimlanes.swimlanes_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "cloud") {
                    panels = [
                        "glib.aws_v2.compute",
                        "glib.aws_v2.database",
                        "glib.aws_v2.application_services",
                        "glib.azure_v1",
                        "glib.gcp_v1.compute",
                        "glib.gcp_v1.storage_and_databases",
                        "glib.gcp_v1.big_data",
                        "com.gliffy.libraries.uml.uml_v2.use_case",
                        "com.gliffy.libraries.erd.erd_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default"
                    ]
                } else if (panels === "flowchart") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.swimlanes.swimlanes_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "software") {
                    panels = [
                        "com.gliffy.libraries.uml.uml_v2.class",
                        "com.gliffy.libraries.uml.uml_v2.sequence",
                        "com.gliffy.libraries.uml.uml_v2.activity",
                        "com.gliffy.libraries.uml.uml_v2.state_machine",
                        "com.gliffy.libraries.uml.uml_v2.deployment",
                        "com.gliffy.libraries.uml.uml_v2.component",
                        "com.gliffy.libraries.uml.uml_v2.use_case",
                        "com.gliffy.libraries.erd.erd_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "bpmn") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.bpmn.bpmn_v1.events",
                        "com.gliffy.libraries.bpmn.bpmn_v1.activities",
                        "com.gliffy.libraries.bpmn.bpmn_v1.data_artifacts",
                        "com.gliffy.libraries.bpmn.bpmn_v1.gateways",
                        "com.gliffy.libraries.bpmn.bpmn_v1.connectors",
                        "com.gliffy.libraries.swimlanes.swimlanes_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "network") {
                    panels = [
                        "com.gliffy.libraries.network.network_v4.rack",
                        "com.gliffy.libraries.network.network_v4.business",
                        "com.gliffy.libraries.network.network_v4.home",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "ui") {
                    panels = [
                        "com.gliffy.libraries.ui.ui_v3.containers_content",
                        "com.gliffy.libraries.ui.ui_v3.navigation",
                        "com.gliffy.libraries.ui.ui_v3.forms_controls",
                        "com.gliffy.libraries.ui.ui_v3.icon_symbols",
                        "com.gliffy.libraries.ui.ui_v2.forms_components",
                        "com.gliffy.libraries.ui.ui_v2.content",
                        "com.gliffy.libraries.ui.ui_v2.miscellaneous",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ]
                } else if (panels === "venn") {
                    panels = [
                        "com.gliffy.libraries.venn.outline.default",
                        "com.gliffy.libraries.venn.flat.default",
                        "com.gliffy.libraries.venn.radial.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ]
                } else if (panels === "org") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ]
                }
            }
            AJS.trigger("gliffy.confluence.launchTemplate", [template.data("category"), name, panels]);

        };
        CreatePanel.prototype.getPanelText = function () {
            return "Create a New Diagram";
        };
        CreatePanel.prototype.getPrimaryButtonText = function (event) {
            return "Create";
        };
        CreatePanel.prototype.setup = function (baseDialog) {
            //get most recent diagrams
            var params = { matchAll:true, sort:"modified", order:"descending", index:0, results:50, filterByUser:true},
                done = false;
            //stick in a spinner for recent results

            $.ajax({
                url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/diagrams.json",
                dataType:'json',
                data:params,
                cache:false,
                success:function (data) {
                    done = true;
                    recentSpinner.stop();
                    baseDialog.find(".gliffy-content .gliffy-recent-results").append(gliffySoy.macro.dialog.searchResults({
                        diagrams: data.diagrams,
                        rootApi: GLIFFY._confluence.gvars.gliffyApiEndpoint
                    }));
                },
                error:function (xhr) {
                    done = true;
                    recentSpinner.stop();
                    baseDialog.find(".gliffy-content .gliffy-recent-results").append(gliffySoy.macro.dialog.searchResults({
                        diagrams:[],
                        rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint
                    }));
                }
            });

            recentSpinner = new GliffySpinner(baseDialog.find(".gliffy-content .gliffy-recent-results").get(0), {
                radius:25,
                color:'#666',
                inline:true
            });

            //wait 100ms, then show the spinner if it's not done
            setTimeout(function () {
                if (!done) {
                    recentSpinner.start();
                }
            }, 100);


        };
        CreatePanel.prototype.teardown = function (baseDialog) {
        };

        /******************************************************************/
        /*       Insert/Search/Create from template Diagram Panel         */
        /******************************************************************/
        InsertPanel = function (insertOnly, message, blueprint) {
            var self = this;

            this.insertOnly = insertOnly || false; //if true, the user can only insert items
            this.message = message || null;
            this.blueprint = blueprint || false;

            //DO NOT translate shortName values! they are not displayed to the user.
            this.spaces = [
                {longName:"All Spaces", shortName:""}
            ];
            this.sort = [
                {longName:"Last Modified", shortName:"modified"},
                {longName:"Title", shortName:"title"},
                {longName:"Created", shortName:"created"}
            ];
            this.name = "insert";
            this.view = "grid";
            this.query = "";
            this.maxSpaces = 50;
            this.offset = 0;

            //query for spaces
            $.ajax({
                type:"GET",
                url:AJS.format("{0}/rest/api/space?start=0&limit=" + this.maxSpaces, Confluence.getContextPath()),
                dataType:"json",
                cache:false,
                success:function (data) {
                    self.offset += data.results.length;
                    for (var i = 0; i < data.results.length; i++) {
                        self.spaces.push({shortName: data.results[i].key, longName: data.results[i].name});
                    }
                },
                error:function (xhr, textstatus, errorThrown) {
                    AJS.log("space service unavailable " + textstatus);
                }
            });

        };
        InsertPanel.prototype = new Panel();
        InsertPanel.prototype.constructor = InsertPanel;
        InsertPanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.insertPanel({
                query:this.query,
                insertOnly:this.insertOnly,
                message:this.message
            });
        };
        InsertPanel.prototype.getPanelText = function () {
            return "Search for a Diagram";
        };
        InsertPanel.prototype.getPrimaryButtonText = function () {
            if (this.insertOnly) {
                return "Insert Diagram";
            } else {
                return "Use as a Template";
            }
        };
        InsertPanel.prototype.scroll = function(e, baseDialog) {

            var self = this,
                now = (new Date()).getTime();

            if(!self.__tempTime) {
                self.__scrolling = true;
                self.__tempTime = now;
            } else if (now - self.__tempTime > 200 && !self.__scrolling) {
                self.__scrolling = true;
                self.__tempTime = now;
            }

            clearTimeout(self.__scrollTimeout);
            self.__scrollTimeout = setTimeout(function () {
                if (self.__scrolling) {
                    self.__scrolling = false;
                    self.scrollEnd(e, baseDialog);
                }

            }, 200);
        };

        InsertPanel.prototype.scrollEnd = function(e, baseDialog) {
            var placeholder = $("#gliffy-macro-dialog .gliffy-placeholder"),
                data;
            if(placeholder.length>0 && this.isScrolledIntoView(placeholder) ) {
                //do render more results!
                data = placeholder.data();
                placeholder.remove();
                this.search(baseDialog, data.index, data.results);
            }

        };

        InsertPanel.prototype.isScrolledIntoView = function(elem) {
            var container = $("#gliffy-macro-dialog .gliffy-content"),
                docViewTop = 0,
                docViewBottom = docViewTop + container.height(),

                elemTop = $(elem).offset().top - container.offset().top,
                elemBottom = elemTop + $(elem).height();

            return (elemBottom >= docViewTop && elemBottom <= docViewBottom) || (elemTop >= docViewTop && elemTop <=docViewBottom);
        };

        InsertPanel.prototype.search = function (baseDialog, index, results) {
            //perform the search
            var spaceKey = baseDialog.find(".gliffy-space-dropdown").data("value"),
                sort = baseDialog.find(".gliffy-sort-dropdown").data("value"),
                toggleDefaultOrder = baseDialog.find(".gliffy-sort-dropdown").data("order") || false,
                params,
                defaultOrder = {"title":"ascending", "created":"descending", "modified":"descending"},
                toggleOrder = {"title":"descending", "created":"ascending", "modified":"ascending"},
                self = this,
                query = self.query,
                searchResultsContainer;

            if(!results || !index) {
                results = 20;
                index = 0;
            }

            params = {
                query:encodeURIComponent(query),
                index:index,
                results:results,
                spaceKey:spaceKey,
                sort:sort,
                order:(toggleDefaultOrder) ? toggleOrder[sort] : defaultOrder[sort]
            };

            $.ajax({
                url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/diagrams.json",
                dataType:'json',
                data:params,
                cache:false,
                success:function (data) {

                    searchResultsContainer = baseDialog.find(".gliffy-content .gliffy-search-results");

                    if(index === 0) {
                        searchResultsContainer.empty();
                    }

                    if (self.view === "grid") {
                        searchResultsContainer.append(gliffySoy.macro.dialog.searchResults({
                            diagrams:data.diagrams,
                            rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint,
                            index: index,
                            results: results
                        }));
                    } else {
                        searchResultsContainer.append(gliffySoy.macro.dialog.listSearchResults({
                            diagrams:data.diagrams,
                            rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint,
                            index: index,
                            results: results
                        }));
                    }
                    for(var i=0; i<data.diagrams.length; i++) {
                        $(".gliffy-template[data-name='"+data.diagrams[i].attachmentId+"']").data("diagram", data.diagrams[i]);
                    }
                }
            });

        };
        InsertPanel.prototype.setup = function (baseDialog) {

            var self = this, questionLink;

            //--------------------- add checkbox and help text ------------------//
            baseDialog.find(".button-container-right").append(
                gliffySoy.macro.dialog.insertPanelCheckbox({
                    insertOnly:self.insertOnly,
                    blueprint:self.blueprint
                })
            );

            baseDialog.find(".gliffy-toggle-checkbox").change(function (event) {
                //update button text
                var checked = $(this).is(":checked"), primaryButton = baseDialog.find(".gliffy-button.gliffy-primary");
                if (checked) {
                    primaryButton.text("Insert Diagram");
                } else {
                    primaryButton.text(self.getPrimaryButtonText());
                }
                analyticsEvent('trackEvent', {category:'panelSearchToggleInsert', action:checked});
            });

            questionLink = baseDialog.find(".gliffy-question-link").click(function () {
                return false;
            });
            if (questionLink.tooltip) {
                //This uses atlassian's tipsy tooltip. We do not include this.
                questionLink.tooltip({live:false, gravity:'s', title:"data-tooltip", delayIn:500, delayOut:0, offset:5});
            } else {
                //fallback to updating the link title
                questionLink.attr("title", questionLink.data("tooltip"));
            }

            //--------------------- table delegate events ------------------//

            baseDialog.delegate("table.gliffy-list-search-results tr", "click.gliffy-row-highlight", function (event) {
                var tr = $(this), template = tr.find(".gliffy-template");
                if (template.length > 0) {
                    baseDialog.find("table .gliffy-active").removeClass("gliffy-active");
                    tr.addClass("gliffy-active");
                    template.addClass("gliffy-active");
                }
            });

            baseDialog.delegate("table.gliffy-list-search-results tr", "dblclick.gliffy-row-highlight", function (event) {
                var tr = $(this), template = tr.find(".gliffy-template");
                if (template.length > 0) {
                    //perform main action
                    self.primaryAction(event, baseDialog);
                }
            });

            //--------------------- Setup dropdown state ------------------------//

            baseDialog.find(".gliffy-insert-search-form").append(
                gliffySoy.macro.dialog.insertDropdown({
                    items:this.spaces,
                    label:"",
                    name:"gliffy-space-dropdown"
                })
            );
            baseDialog.find(".gliffy-insert-search-form").append(
                gliffySoy.macro.dialog.insertDropdown({
                    items:this.sort,
                    label:"Sort by:",
                    name:"gliffy-sort-dropdown"
                })
            );

            //also add the list/grid toggle
            baseDialog.find(".gliffy-insert-search-form").append(
                gliffySoy.macro.dialog.listGridToggle({
                    view:self.view === "grid" ? "gliffy-icon-grid" : "gliffy-icon-list"
                })
            );

            baseDialog.find(".gliffy-list-grid-toggle").click(function () {
                var toggle = $(this);
                if (self.view === "grid") {
                    toggle.removeClass("gliffy-icon-grid").addClass("gliffy-icon-list");
                    self.view = "list";
                } else {
                    toggle.removeClass("gliffy-icon-list").addClass("gliffy-icon-grid");
                    self.view = "grid";
                }
                analyticsEvent('trackEvent', {category:'panelSearchToggleGridList', action:self.view});

                self.search(baseDialog);
            });

            baseDialog.find(".gliffy-btn.gliffy-dropdown,.gliffy-btn.gliffy-dropdown-toggle").click(function (event) {
                event.preventDefault();
                event.stopPropagation();
                $(this).closest(".gliffy-btn-group").find("ul.gliffy-dropdown-menu").toggle();

            });

            baseDialog.bind("click.gliffy-btn-dropdown", function () {
                baseDialog.find(".gliffy-btn.gliffy-dropdown,.gliffy-btn.gliffy-dropdown-toggle");
                baseDialog.find("ul.gliffy-dropdown-menu:visible").hide();
            });

            $(baseDialog).delegate("ul.gliffy-dropdown-menu li", 'click', function (event) {
                event.preventDefault();
                event.stopPropagation();
                var $this = $(this), longName = $this.find("a").text(), shortName = $this.find("a").data("value"),
                    buttonGroup = $this.closest(".gliffy-btn-group");
                buttonGroup.find("button.gliffy-dropdown").text(longName);
                if (buttonGroup.data("value") === shortName) {
                    buttonGroup.data("order", !(buttonGroup.data("order") == true));
                } else {
                    buttonGroup.data("value", shortName);
                    buttonGroup.data("order", false);
                }
                buttonGroup.find("ul.gliffy-dropdown-menu").toggle();
                self.search(baseDialog);
            });

            baseDialog.find("ul.gliffy-dropdown-menu").scroll(_.debounce(function() {
                var scroller = this;
                if($(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight) {
                    $.ajax({
                        type: "GET",
                        url: AJS.format("{0}/rest/api/space?start={1}&limit={2}",
                            Confluence.getContextPath(),
                            self.offset,
                            self.maxSpaces),
                        dataType: "json",
                        cache: false,
                        success: function (data) {
                            self.offset += data.results.length;
                            for (var i = 0; i < data.results.length; i++) {
                                var result = data.results[i];
                                var name = document.createElement('span');
                                name.textContent = result.name;
                                $(scroller).append('<li><a href="#" data-value="' + result.key + '">' + name.innerHTML + '</a></li>');
                            }
                        },
                        error: function (xhr, textstatus, errorThrown) {
                            AJS.log("space service unavailable " + textstatus);
                        }
                    });
                }
            }, 200));

            //--------------------- Search ------------------------//

            //search
            baseDialog.find(".gliffy-insert-search").keyup(function (event) {
                clearTimeout(self.timeout);
                self.query = $.trim(baseDialog.find(".gliffy-insert-search").val());
                self.timeout = setTimeout(function () {
                    self.search(baseDialog);
                }, 500);
            }).keydown(function (event) {
                if (event.which === 13) {
                    //dropdown toggles otherwise...
                    event.preventDefault();
                    self.query = $.trim(baseDialog.find(".gliffy-insert-search").val());
                    self.search(baseDialog);
                }
            });
            baseDialog.find(".gliffy-insert-search-form").submit(function (event) {
                event.stopPropagation();
                event.preventDefault();
            });


            baseDialog.find(".gliffy-content").scroll(function(e) {
                self.scroll(e, baseDialog);
            });

            //populate tab
            self.search(baseDialog);

        };
        InsertPanel.prototype.teardown = function (baseDialog) {

            //------- remove diagram link checkbox and help text ------//
            baseDialog.find(".gliffy-toggle-insert").remove();
            baseDialog.unbind("click.gliffy-row-highlight");
            baseDialog.unbind("dblclick.gliffy-row-highlight");
            baseDialog.unbind("click.gliffy-btn-dropdown");
            baseDialog.find(".gliffy-content").unbind("scroll");
        };
        InsertPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {

            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active"),
                checkbox = baseDialog.find(".gliffy-toggle-checkbox"),
                currentParams, diagram, isBlueprint =  macroDialog.isFromBlueprint();

            event.preventDefault();
            event.stopPropagation();

            if (template.length > 0) {

                if (this.insertOnly || checkbox.is(":checked") || isBlueprint) {

                    //insert
                    diagram = template.data("diagram");

                    if (diagram) {

                        currentParams = {};
                        currentParams.name = diagram.name;

                        //mark if is blueprint on page template
                        if(isBlueprint) {
                            //we need the attachment id to transform this later
                            currentParams.attachmentId = diagram.attachmentId;
                        }

                        // Let's not add the diagram version on the macro as we don't want to fix the displayed version unless
                        // the user explicitly chooses to
                        // currentParams.version = selectedDiagramVersion;
                        if (Confluence.Editor.getContentId() != diagram["pageId"]) {
                            currentParams.pageid = diagram["pageId"];
                        }

                        AJS.Rte.BookmarkManager.storeBookmark();
                        var macroRenderRequest = {
                            contentId:Confluence.Editor.getContentId(),
                            macro:{
                                name:"gliffy",
                                params:currentParams,
                                defaultParameterValue:"",
                                body:""
                            }
                        };

                        GLIFFY.confluence.insertMacro(macroRenderRequest);
                        GLIFFY._confluence.macroDialog.hide();

                        analyticsEvent('trackEvent', {category:'panelSearch', action:"insert"});


                    }
                } else {
                    analyticsEvent('trackEvent', {category:'panelSearch', action:"create"});
                    //create
                    AJS.trigger("gliffy.confluence.launchTemplate", [template.data("category"), template.data("name")]);
                }
            }

        };

        /******************************************************************/
        /*                      Import Panel                              */
        /******************************************************************/


        ImportPanel = function () {
            var self = this;

            this.name = "import";

            //supported transformers
            this.transformers = [];

            //check for available transformers
            $.ajax({
                url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/transform/config.json",
                type:"GET",
                cache:false,
                dataType:"json",
                success:function (data) {
                    AJS.log("gliffy-transform service available");
                    for (var i = 0; i < data.transformers.length; i++) {
                        AJS.log("supports " + data.transformers[i].name);
                        self.transformers.push(data.transformers[i]);
                    }
                },
                error:function () {
                    AJS.log("gliffy-transform service unavailable.");
                    self.transformers = [
                        {"name":"Gliffy XML", "ext":'gxml'}
                    ];
                }
            });
        };
        ImportPanel.prototype = new Panel();
        ImportPanel.prototype.constructor = ImportPanel;
        ImportPanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.importPanel({
                contextPath:AJS.Confluence.getContextPath()
            });
        };
        ImportPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
        };
        ImportPanel.prototype.getPanelText = function () {
            return "Import a Diagram";
        };
        ImportPanel.prototype.isExtensionSupported = function (extension) {
            return $.grep(this.transformers,function (transformer) {
                if (transformer.ext === "gliffy,gon") {
                    return "gon" === extension || "gliffy" === extension;
                } else if (transformer.ext === "xml,drawio,mxfile") {
                    return "xml" === extension || "drawio" === extension || "mxfile" === extension;
                } else {
                    return transformer.ext === extension;
                }
            }).length > 0;
        };
        ImportPanel.prototype.setupFormSubmit = function (baseDialog) {

            var errorContainer = $('#gliffy-create-import-error'), waitSpinner = $("#gliffy-import-wait"),
                fileImport = $("#gliffy-import-file"), form = $('#gliffy-create-import-form'), self = this,
                extension, token;

            //this uses confluence's ajaxForm jQuery plugin:
            baseDialog.find("#gliffy-create-import-form").ajaxForm({

                type: 'POST',
                timeout: 180000, // 3-minute timeout, for long file uploads
                beforeSubmit:function () {
                    //atlassian added a security token in 5.1.4
                    try {
                        token = AJS.Meta.get("atl-token");
                        if (token) {
                            $("#gliffy-security-token").val(token);
                        }
                    } catch (e) {
                        //let if fall through if older version
                    }

                    //you can't disable the input here, otherwise the form will not submit properly

                    if(fileImport.val().includes('.')) {
                        extension = fileImport.val().split(".").pop();
                    }
                    else {
                        extension = 'json'; // If file have no extension we treat it as json
                    }


                    if (!self.submitting && self.isExtensionSupported(extension)) {

                        //analytics on what type of file the user is attempting to upload
                        analyticsEvent('trackEvent', {category:'import', action:extension});

                        //clear errors, setup spinner
                        errorContainer.empty();
                        importSpinner = new GliffySpinner(waitSpinner.get(0), {
                            radius:10,
                            color:'#666',
                            inline:true
                        });
                        importSpinner.start();
                        self.submitting = true;
                        return true;
                    } else {
                        //notify user that the filetype is unsupported
                        AJS.messages.error("#gliffy-create-import-error", {title:"The file type is not supported for importing:" + " " + extension});
                        return false;
                    }
                },
                success: function (jsonTextResponse) {

                    self.submitting = false;

                    importSpinner.stop();
                    form.each(function () {
                        this.reset();
                    });

                    var parsedJsonResponse = $.parseJSON(jsonTextResponse);
                    var gonContent = parsedJsonResponse.gon;

                    try {
                        AJS.trigger("gliffy.confluence.launchEditorWithGonData", gonContent);
                        GLIFFY._confluence.macroDialog.hide();
                    } catch (e) {
                        errorContainer.empty();
                        AJS.messages.error("#gliffy-create-import-error", {
                            title: "Sorry, we could not import your file."
                        });
                    }
                },
                error:function (error) {
                    console.error(error);
                    self.submitting = false;

                    // reset state
                    importSpinner.stop();
                    form.each(function () {
                        this.reset();
                    });

                    AJS.messages.error("#gliffy-create-import-error", {
                        title:"Sorry, we could not import your file."
                    });
                }
            });

        };
        var importPanelInitialized = false;
        ImportPanel.prototype.setup = function (baseDialog) {
            var self = this;

            // Hide primary button
            baseDialog.find(".gliffy-button.gliffy-primary").hide();

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-gxml").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importGliffyHelpPanel({
                    contextPath:AJS.Confluence.getContextPath()
                }));
                return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-gon").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importGliffyGonHelpPanel({
                    contextPath:AJS.Confluence.getContextPath()
                }));
                return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-vdx").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importVisioHelpPanel());
                return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-drawio").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                        .append(gliffySoy.macro.dialog.importDrawIoHelpPanel());
                    return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-lucidchart").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importLucidchartHelpPanel());
                return false;
            });

            baseDialog.find("#gliffy-import-file").bind("change.gliffyImportPanel", function () {
                $(this).closest("form").submit();
            });

            //setup upload form
            self.setupFormSubmit(baseDialog);
            importPanelInitialized = true;
        };
        ImportPanel.prototype.teardown = function (baseDialog) {
            //show primary button
            baseDialog.find(".gliffy-button.gliffy-primary").show();

            //no delegate events were added in setup, so nothing else needs to be removed
        };


        /******************************************************************/
        /*                  Template Categories Panel                     */
        /******************************************************************/

        TemplateCategoryPanel = function (category) {
            this.category = category;
            this.name = category.uid || category.id; //key
        };
        TemplateCategoryPanel.prototype = new Panel();
        TemplateCategoryPanel.prototype.constructor = TemplateCategoryPanel;
        TemplateCategoryPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active"),
                name = template.data("name"), category = template.data("category");
            //Actual editor launch logic is in gliffy-rte-editor-html5.js
            analyticsEvent('trackEvent', {category:"panel." + category, action:name});

            AJS.trigger("gliffy.confluence.launchTemplate", [category, name]);


        };
        TemplateCategoryPanel.prototype.isTemplateCategory = function () {
            return true;
        };
        TemplateCategoryPanel.prototype.getTemplate = function () {

            return gliffySoy.macro.dialog.templatePanel({
                category:this.category.uid,
                templates:this.category.templates,
                contextPath:AJS.Confluence.getContextPath()
            });

        };
        TemplateCategoryPanel.prototype.getPanelText = function () {
            return this.category.desc;
        };
        TemplateCategoryPanel.prototype.getPrimaryButtonText = function (event) {
            return "Create";
        };


        /******************************************************************/
        /*                  Blueprint Categories Panel                    */
        /******************************************************************/

        BlueprintCategoryPanel = function (category) {
            this.category = category;
            this.name = category.uid || category.id;
        };
        BlueprintCategoryPanel.prototype = new Panel();
        BlueprintCategoryPanel.prototype.constructor = TemplateCategoryPanel;
        BlueprintCategoryPanel.prototype.isTemplateCategory = function () {
            return true;
        };
        BlueprintCategoryPanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.templatePanel({
                category:this.category.uid,
                templates:this.category.templates,
                contextPath:AJS.Confluence.getContextPath()
            });

        };
        BlueprintCategoryPanel.prototype.getPanelText = function () {
            return this.category.desc.charAt(0).toUpperCase() + this.category.desc.slice(1);
        };
        BlueprintCategoryPanel.prototype.getPrimaryButtonText = function (event) {
            return "Create";
        };

//      Add any custom logic/elements in the setup function, if you added any delegates, or
//      bound any events outside of your panel, remove it in teardown.
        BlueprintCategoryPanel.prototype.setup = function (baseDialog) {
        };
        BlueprintCategoryPanel.prototype.teardown = function (baseDialog) {
        };

        BlueprintCategoryPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active");
            analyticsEvent('trackEvent', {category:'macro', action:"addToConfluenceTemplate"});
            AJS.trigger('gliffy.confluence.addGliffyDiagramToPage', [template.data("category"), template.data("name")]);

        };


        /******************************************************************/
        /*                   Macro Dialog                                 */
        /******************************************************************/

        GLIFFY._confluence.macroDialog = {
            //true if, the dialog has already been init'd and appended to body
            initialized:false,
            //our normal panels
            panels:{},
            //what the panel should do when you click the primary button
            primaryActions:{},
            //primary button text
            primaryButtonText:{},
            //can the user create attachments?
            canCreateAttachmentPromise:null,

            //panel state (what panel is currently rendered)
            panelState:null,

            setPanelState:function (state) {
                this.panelState = state;
            },

            getPanelState:function () {
                return this.panelState;
            },

            /******************************************************************/
            /*                 Button Events and Styling                      */
            /******************************************************************/

            /**
             * Sets the correct style for the active panel link
             * @param link
             */
            setActivePanelLink:function (listItem) {
                this.baseDialog.find("li.gliffy-active").removeClass("gliffy-active");
                listItem.addClass("gliffy-active");
            },

            /**
             * Sets the correct style for the active template in gliffy-content
             * @param link
             */
            setActiveTemplate:function (template) {
                this.baseDialog.find(".gliffy-content .gliffy-template.gliffy-active").removeClass("gliffy-active");
                template.addClass("gliffy-active");
            },

            /**
             * Registers what a panel should do when the primary button is clicked
             * @param key
             * @param primaryAction
             */
            registerPrimaryAction:function (panel) {
                this.primaryActions[panel.getName()] = panel;
                if (panel.getPrimaryButtonText()) {
                    this.primaryButtonText[panel.getName()] = panel.getPrimaryButtonText();
                }
            },
            /**
             * Updates the primary button text
             * @param key
             */
            updatePrimaryButtonText:function (key) {
                this.baseDialog.find(".gliffy-button.gliffy-primary").text(this.primaryButtonText[key]);
            },

            /**
             * Binds the primary button click handler. Call this once.
             */
            bindPrimaryButtonClick:function () {
                var self = this;
                this.baseDialog.delegate(".gliffy-button.gliffy-primary", "click", function (event) {
                    if (self.getPanelState()) {
                        self.primaryActions[self.getPanelState()].primaryAction(event, self.baseDialog, self);
                    }
                });
            },

            /**
             * Binds the secondary button handler. Call this once.
             */
            bindSecondaryButtonClick:function () {
                var self = this;
                this.baseDialog.delegate(".gliffy-button.gliffy-secondary", "click", function (event) {
                    event.preventDefault();
                    self.hide();
                });
            },
            /**
             * Binds the click handler for the blanket. call this once.
             */
            bindBlanketClick:function () {
                var self = this;
                this.blanket.click(function () {
                    self.hide();
                });
            },

            bindPanelLinkClick:function () {
                var self = this;
                $(this.baseDialog).delegate("ul.gliffy-panel-links li", "click", function (event) {
                    event.preventDefault();
                    event.stopPropagation();
                    var listItem = $(this), key = listItem.data("key");
                    if (key) {
                        self.renderPanel(self.panels[key]);
                    }
                });
            },

            bindTemplateElementClick:function () {
                var self = this;

                //single click
                $(this.baseDialog).delegate(".gliffy-content .gliffy-template", "click", function (event) {
                    event.preventDefault();
                    self.setActiveTemplate($(this));
                });

                //double click
                $(this.baseDialog).delegate(".gliffy-content .gliffy-template", "dblclick", function (event) {
                    event.preventDefault();
                    //trigger primary action
                    if (self.getPanelState()) {
                        self.primaryActions[self.getPanelState()].primaryAction(event, self.baseDialog, self);
                    }
                });

            },

            /******************************************************************/
            /*                       Panels                                   */
            /******************************************************************/

            /**
             * Registers the panel and adds a new link in sidebar
             */
            registerPanel:function (panel) {

                this.panels[panel.getName()] = panel;

                //give panel a reference to it's inserted panel link
                panel.insertedPanelLink = $(panel.getPanelLink());

                if (panel.isTemplateCategory()) {
                    this.baseDialog.find(".gliffy-sidebar-templates ul").append(panel.insertedPanelLink);
                } else {
                    this.baseDialog.find(".gliffy-sidebar-panels ul.gliffy-panel-links").append(panel.insertedPanelLink);
                }
                //binds any required delegate events
                this.registerPrimaryAction(panel);
            },
            /**
             * Renders a panel
             * @param panel
             */
            renderPanel:function (panel) {
                if (this.getPanelState()) {
                    this.panels[this.getPanelState()].teardown(this.baseDialog);
                }
                this.baseDialog.find(".gliffy-content").empty().append(panel.getTemplate());
                this.setActivePanelLink(panel.insertedPanelLink);
                this.updatePrimaryButtonText(panel.getName());
                this.setPanelState(panel.getName());
                panel.setup(this.baseDialog);

            },
            /******************************************************************/
            /*                       Templates                                */
            /******************************************************************/

            /**
             * ajax call to get template categories
             */
            populateTemplateCategories:function (panelType) {
                var self = this;
                $.ajax({
                    url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/templateLibraries/com.gliffy.template_library.default",
                    type:"GET",
                    cache:false,
                    success:function (data, textStatus, xhr) {
                        //add blank category for blueprint
                        if (panelType === BlueprintCategoryPanel) {
                            var blankCategory = {
                                desc:"Blank",
                                template:[
                                    {
                                        desc:"Blank",
                                        uid:"com.gliffy.template.blank",
                                        previewLocation:"",
                                        templateLocation:""
                                    }
                                ],
                                uid:"com.gliffy.templates.blank"
                            }
                            data.categories.unshift(blankCategory);
                        }

                        for (var i = 0; i < data.categories.length; i++) {
                            var category = data.categories[i];
                            //Create and Register TemplateCategoryPanels
                            self.registerPanel(new panelType(category));
                        }
                    },
                    error:function (xhr) {
                        //remove template sidebar list
                        self.baseDialog.find(".gliffy-sidebar-templates").remove();
                    }
                });

            },
            /******************************************************************/
            /*                        Init                                    */
            /******************************************************************/

            init:function () {
                this.canCreateAttachmentPromise = this.canCreateAttachments()
            },

            /**
             * Check to see if the anon user is on a draft.
             * If the user has no attachment permissions.
             *
             * This returns a promise that is rejected if they don't have the right attachment permissions
             */
            canCreateAttachments:function () {

                var deferred = new PromiseJS.Deferred(), pageId = Confluence.Editor.getContentId(), message;

                if (pageId === "0") {
                    deferred.reject("Please save the page before creating a diagram.");
                } else {
                    $.ajax({
                        type:"GET",
                        url:AJS.format("{0}/ceo/{1}/permission", GLIFFY._confluence.gvars.gliffyApiEndpoint, pageId),
                        dataType:"json",
                        cache:false,
                        success:function () {
                            deferred.resolve();
                        },
                        error:function (xhr) {
                            // If it's a license error, be more aggressive
                            if (xhr.status === 402) {
                                message = "License Error. Please contact your Administrator.";
                            }
                            else if (xhr.status === 404) {
                                //unauthorized is 401, but we substitue with 404 here for: http://jira.gliffy.com/browse/GCONF-1642
                                message = "No create permission or you are not logged in.";
                            }
                            else {
                                message = "Error. Please contact your Administrator.";
                            }
                            deferred.reject(message);
                        }
                    });
                }

                return deferred.promise;
            },

            /**
             * Did we come in from the blueprint workflow?
             */
            isFromBlueprint:function () {
                return AJS.Meta.get('form-name') === 'createpagetemplate' || AJS.Meta.get('form-name') === 'editpagetemplate';
            },


            setupButtons:function () {
                this.bindPrimaryButtonClick();
                this.bindSecondaryButtonClick();
                this.bindBlanketClick();
                this.bindPanelLinkClick();
                this.bindTemplateElementClick();
            },

            buildDialog:function () {
                var i, self = this, panels, panel, analyticsPromise;

                //initialize analytics!
                analyticsPromise = GLIFFY._confluence.utils.initAnalytics();

                //create the blanket
                this.blanket = $(gliffySoy.macro.dialog.blanket());


                if (this.isFromBlueprint()) {

                    analyticsPromise.then(function () {
                        analyticsEvent('trackEvent', {category:'macroInit', action:"blueprint"});
                    });


                    self.baseDialog = $(gliffySoy.macro.dialog.base({insertOnly:false}));

                    //start the template request
                    self.populateTemplateCategories(BlueprintCategoryPanel);

                    //create a new panel that is insert only!
                    panel = new InsertPanel(true, "", true);

                    self.registerPanel(panel);

                    //setup button state
                    self.setupButtons();

                    //render the first panel
                    self.renderPanel(panel);

                    //append the modal and blanket to body
                    self.blanket.appendTo("body");
                    self.baseDialog.appendTo("body");

                    self.initialized = true;


                } else {
                    this.canCreateAttachmentPromise.then(function () {

                        analyticsPromise.then(function () {
                            analyticsEvent('trackEvent', {category:'macroInit', action:"normal"});
                        });

                        //we can create attachments!
                        self.baseDialog = $(gliffySoy.macro.dialog.base({insertOnly:false}));

                        //start the template request
                        self.populateTemplateCategories(TemplateCategoryPanel);

                        //our static panels
                        panels = [new CreatePanel(), new ImportPanel(), new InsertPanel()];

                        //register panels
                        for (i = 0; i < panels.length; i++) {
                            self.registerPanel(panels[i]);
                        }

                        //setup button state
                        self.setupButtons();

                        //render the first panel
                        self.renderPanel(panels[0]);

                        //append the modal and blanket to body
                        self.blanket.appendTo("body");
                        self.baseDialog.appendTo("body");

                        self.initialized = true;

                    }, function (message) {


                        analyticsPromise.then(function () {
                            analyticsEvent('trackEvent', {category:'macroInit', action:"noAttachPermissions"});
                        });

                        //show the InsertPanel (Search) only, and do not populate templates

                        self.baseDialog = $(gliffySoy.macro.dialog.base({insertOnly:true}));

                        //create a new panel that is insert only!
                        panel = new InsertPanel(true, message);

                        self.registerPanel(panel);

                        //setup button state
                        self.setupButtons();

                        //render the first panel
                        self.renderPanel(panel);

                        //append the modal and blanket to body
                        self.blanket.appendTo("body");
                        self.baseDialog.appendTo("body");

                        self.initialized = true;

                    });
                }

            },
            /******************************************************************/
            /*               'Public' Methods                                 */
            /******************************************************************/
            show:function () {
                if (!this.initialized) {
                    this.buildDialog();
                } else {
                    //GCONF 1847 re-position the dialog and remove margin if the dialog height is larger than the window height
                    //to prevent the top of the dialog from being trancated at the top
                    var heightDifference = ($('body').height() - $('#gliffy-macro-dialog').height())/2;
                    var minimumTopMargin = 20;
                    if (heightDifference < minimumTopMargin) {
                        //ie hides the srollbars, so we need to show them to be able to scroll to the create/cancel buttons
                        //later versions of IE user agent string do not contain MSIE so do a check for Wind
                        if (window.navigator.userAgent.indexOf('Trident') != -1) {
                            $('body').css('overflow-y', 'scroll');
                        }
                        $('#gliffy-macro-dialog').css('top', minimumTopMargin);
                        $('#gliffy-macro-dialog').css('margin-top', 0);
                    }

                    this.blanket.show();
                    this.baseDialog.show();
                }
            },
            hide:function () {
                if (this.initialized) {
                    var heightDifference = ($('body').height() - $('#gliffy-macro-dialog').height())/2;
                    if (window.navigator.userAgent.indexOf('Trident') != -1) {
                        //put back to the original state if we close
                        $('body').css('overflow-y', 'hidden');
                        window.scrollTo(0, 0);
                    }
                    //GCONF-2702: GCONF-2599 broke Import which is described in GCONF-2702. Following addresses the fix.
                    //In the future when the code in the else block is used, this if block can be removed.
                    if (importPanelInitialized) {
                        this.blanket.hide();
                        this.baseDialog.hide();
                    } else {
                        //This vomit fixes a bug with windows/Chrome continuing
                        // to render the blanket even when it's display:none
                        // TODO: remove when windows chrome is fixed
                        this.blanket.remove().hide().appendTo('body');
                        this.baseDialog.remove().hide().appendTo('body');
                        this.setupButtons();
                        //Replace with this
                        // this.blanket.hide();
                        // this.baseDialog.hide();
                    }
                }
            }
        };
        //any other things we should check before our macro dialog is displayed?
        GLIFFY._confluence.macroDialog.init();

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte.js' */
// http://docs.atlassian.com/aui/3.0/
// http://confluence.atlassian.com/display/AUI/Dialog
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {
        AJS.log("AJS.version=" + AJS.version);
        var CUTOFF_TIME = 1000*60*60*24*30; //30 days in ms.  We are filtering for drafts that are over 30 days old to encourage people to publish or remove them.
        var draftCutoff = Date.now() - CUTOFF_TIME;
        //check for drafts over 15 days since last edit and nag the user if any GliffyDocumentCondition
        AJS.$.ajax(AJS.format("{0}/rest/gliffy/1.0/diagrams/drafts?before={1}&limit=1", Confluence.getContextPath(), draftCutoff)).then(function(response) {
            if (response.drafts.length === 0) {
                return;
            }
            var message = "It appears you have open Gliffy drafts over {$numberDays} days old.  \u003ca href=\u0022{$contextPath}/plugins/gliffy/gliffyUserPage.action\u0022\u003eClick here\u003c/a\u003e to navigate to your drafts or remove them if you no longer plan to publish them."
                .replace('{$numberDays}', '30')
                .replace('{$contextPath}', Confluence.getContextPath());
            var draftDialog = gliffySoy.oldDrafts.popup({
                message: message
            });
            var flagContainer = AJS.$('#aui-flag-container');
            if (flagContainer.length === 0) {
                AJS.$('body').prepend('<div id="aui-flag-container" />')
            }
            AJS.$('#aui-flag-container').prepend(draftDialog);
            AJS.$('.gliffy-close-icon').click(function() {
                AJS.$('.gliffy-draft-message-popup').hide();
            });
        });

        //==============================================================================================================
        // Show our macro dialog
        //==============================================================================================================

        var showDialogFirstEntry = function (dialog) {
            dialog.show();
            dialog.gotoPanel(0, 0);
        };

        var showPanel = function (dialog, onSuccessFunc) {
            //query for spaces
            if (GLIFFY._confluence.gvars.spaces.length < 1) {
                $.ajax({
                    type : "GET",
                    url : AJS.format("{0}/rest/api/space", Confluence.getContextPath()),
                    dataType : "json",
                    cache : false,
                    success : function (data) {
                        GLIFFY._confluence.gvars.spaces = data.categoryList;

                        $(".gliffy-space-dropdown").append(
                            gliffySoy.macro.dialog.spaceOptions({spaces : data.categoryList})
                        );

                        showDialogFirstEntry(dialog);

                        if (onSuccessFunc){
                            onSuccessFunc();
                        }
                    },
                    error : function (xhr, textstatus, errorThrown) {
                        AJS.log("space service unavailable " + textstatus);
                        showDialogFirstEntry(dialog);
                    }
                });
            }
            else {
                showDialogFirstEntry(dialog);
            }
        };

        AJS.bind("gliffy.confluence.showMacroDialog", function (event, params) {


            //clear the current selection of {gliffy
            AJS.Rte.getEditor().selection.setContent("");
            //bookmark selection
            AJS.Rte.BookmarkManager.storeBookmark();

            GLIFFY._confluence.macroDialog.show();

            return false;
        });


        //can't use live here since we want to stop immediate propagation
        $('#gliffy').click(function () {
            AJS.trigger("gliffy.confluence.showMacroDialog");
        });
        //==============================================================================================================
        // Add Diagram Workflow Setup
        //==============================================================================================================
        // If gliffy is in the hash, launch our dialog or the inline editor
        var urlParams = GLIFFY._confluence.utils.getUrlVars();
        if (urlParams["showGliffyMacro"]) {

            var ed = AJS.Rte.getEditor();
            var tmp = ed.dom.create("p");
            var $body = $(ed.getBody());

            var firstP = $body.find("p:first");
            if (firstP.length > 0) {
                firstP.before(tmp);
            } else {
                $body.prepend(tmp);
            }
            ed.dom.add(tmp, "p", {"class" : "gliffy-caret"});

            ed.focus(); //for firefox weirdness

            ed.selection.select(ed.dom.select("p.gliffy-caret")[0]);
            var bookmark = ed.selection.getBookmark();
            ed.selection.moveToBookmark(bookmark);

            ed.dom.remove(ed.dom.select("p.gliffy-caret")[0]);

            AJS.trigger("gliffy.confluence.showMacroDialog", {createDiagramType: urlParams["createDiagramType"]});
        }

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = '/templates/gliffy-rte.soy' */
// This file was automatically generated from gliffy-rte.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.macro.dialog.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.macro == 'undefined') { gliffySoy.macro = {}; }
if (typeof gliffySoy.macro.dialog == 'undefined') { gliffySoy.macro.dialog = {}; }


gliffySoy.macro.dialog.blanket = function(opt_data, opt_ignored) {
  return '<div id="gliffy-macro-blanket"></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.blanket.soyTemplateName = 'gliffySoy.macro.dialog.blanket';
}


gliffySoy.macro.dialog.base = function(opt_data, opt_ignored) {
  return '<div id="gliffy-macro-dialog"><div class="gliffy-header"><div class="gliffy-logo"></div></div><div class="gliffy-dialog-body"><div class="gliffy-sidepanel"><div class="gliffy-sidebar-panels"><ul class="gliffy-panel-links"></ul></div>' + ((opt_data.insertOnly != true) ? '<div class="gliffy-sidebar-templates"><ul class="gliffy-panel-links"><li class="gliffy-panel-title"><b>' + soy.$$escapeHtml('Templates') + '</b></li></ul></div>' : '') + '</div><div class="gliffy-content"></div><div class="gliffy-clear"></div><div class="gliffy-footer"><div class="button-container-left"></div><div class="button-container-right"><ul class="gliffy-button-list"><li><a class="gliffy-button gliffy-primary" href="#">' + soy.$$escapeHtml('Create') + '</a></li><li><a class="gliffy-button gliffy-secondary" href="#">' + soy.$$escapeHtml('Cancel') + '</a></li></ul></div><div class="gliffy-clear"></div></div></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.base.soyTemplateName = 'gliffySoy.macro.dialog.base';
}


gliffySoy.macro.dialog.panelLink = function(opt_data, opt_ignored) {
  return '<li ' + ((opt_data.active == true) ? 'class="gliffy-active"' : '') + '  data-key="' + soy.$$escapeHtml(opt_data.key) + '"><a href="#">' + soy.$$escapeHtml(opt_data.title) + '</a></li>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.panelLink.soyTemplateName = 'gliffySoy.macro.dialog.panelLink';
}


gliffySoy.macro.dialog.templatePanel = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.category == 'com.gliffy.templates.blank') {
    output += '<div class="gliffy-template gliffy-active" data-category="com.gliffy.templates.blank" data-name="com.gliffy.template.blank"><div class="gliffy-image-placeholder"/><span>' + soy.$$escapeHtml('Blank') + '</span></div>';
  } else {
    var templateList33 = opt_data.templates;
    var templateListLen33 = templateList33.length;
    for (var templateIndex33 = 0; templateIndex33 < templateListLen33; templateIndex33++) {
      var templateData33 = templateList33[templateIndex33];
      output += '<div data-category="' + soy.$$escapeHtml(opt_data.category) + '" data-name="' + soy.$$escapeHtml(templateData33.uid) + '" class="gliffy-template ' + ((templateIndex33 == 0) ? 'gliffy-active' : '') + '"><div class="gliffy-image-placeholder" style="background-image:url(\'' + soy.$$escapeHtml(opt_data.contextPath) + '/rest/gliffy/1.0' + soy.$$escapeHtml(templateData33.thumbnailLocation) + '\')"></div><span>' + soy.$$escapeHtml(templateData33.desc) + '</span></div>';
    }
  }
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.templatePanel.soyTemplateName = 'gliffySoy.macro.dialog.templatePanel';
}


gliffySoy.macro.dialog.createPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-blank-container"><div class="gliffy-template gliffy-active" data-category="com.gliffy.templates.blank" data-panels="basic" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-basic"></div><span>' + soy.$$escapeHtml('Basic') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="cloud" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-cloud"></div><span>' + soy.$$escapeHtml('Cloud Services') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="bpmn" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-bpmn"></div><span>' + soy.$$escapeHtml('Flowchart \x26 BPMN') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="software" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-uml"></div><span>' + soy.$$escapeHtml('Software Design: UML \x26 ERD') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="network" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-network"></div><span>' + soy.$$escapeHtml('Network') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="ui" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-wireframe"></div><span>' + soy.$$escapeHtml('Wireframe') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="org" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-org"></div><span>' + soy.$$escapeHtml('Org Chart') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="venn" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-venn"></div><span>' + soy.$$escapeHtml('Venn Diagram') + '</span></div><div class="gliffy-template" data-category="com.gliffy.template.mindmap_blank" data-panels="mindmap" data-name="com.gliffy.template.mindmap_blank" ><div class="gliffy-image-placeholder gliffy-symbol-mindmap"></div><span>' + soy.$$escapeHtml('Mind Map') + '</span></div><div class="gliffy-clear"></div></div><div class="gliffy-recent-container"><div class="gliffy-recent-title">' + soy.$$escapeHtml('Use a Recent Diagram as a Template') + '</div><div class="gliffy-recent-results"><div class="gliffy-spinner-container"></div></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.createPanel.soyTemplateName = 'gliffySoy.macro.dialog.createPanel';
}


gliffySoy.macro.dialog.searchResults = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.diagrams.length > 0) {
    var diagramList75 = opt_data.diagrams;
    var diagramListLen75 = diagramList75.length;
    for (var diagramIndex75 = 0; diagramIndex75 < diagramListLen75; diagramIndex75++) {
      var diagramData75 = diagramList75[diagramIndex75];
      output += '<div data-category="com.gliffy.transform.diagram" data-name="' + soy.$$escapeHtml(diagramData75.attachmentId) + '" class="gliffy-template"><div class="gliffy-image-placeholder" style="background-image:url(\'' + soy.$$escapeHtml(opt_data.rootApi) + soy.$$escapeHtml(diagramData75.urls.thumbnail) + '\')"></div><span>' + soy.$$escapeHtml(diagramData75.displayName ? diagramData75.displayName : diagramData75.name) + '</span></div>';
    }
    output += (opt_data.results == opt_data.diagrams.length) ? '<div class="gliffy-placeholder" data-index="' + soy.$$escapeHtml(opt_data.index + opt_data.results) + '" data-results="' + soy.$$escapeHtml(opt_data.results) + '"></div>' : '';
  } else {
    output += '<div style="text-indent:7.5px;">' + soy.$$escapeHtml('No Diagrams Found') + '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.searchResults.soyTemplateName = 'gliffySoy.macro.dialog.searchResults';
}


gliffySoy.macro.dialog.listGridToggle = function(opt_data, opt_ignored) {
  return '<span class="gliffy-list-grid-toggle ' + soy.$$escapeHtml(opt_data.view) + '"></span>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.listGridToggle.soyTemplateName = 'gliffySoy.macro.dialog.listGridToggle';
}


gliffySoy.macro.dialog.listSearchResults = function(opt_data, opt_ignored) {
  var output = '<table class="gliffy-list-search-results">' + ((opt_data.index == 0) ? '<thead><tr><th class="gliffy-table-column-diagram"><div class="gliffy-background-f0"></div></th><th class="gliffy-table-column-space">' + soy.$$escapeHtml('Space') + '</th><th class="gliffy-table-column-date">' + soy.$$escapeHtml('Last Modified') + '</th></tr></thead>' : '') + '<tbody>';
  if (opt_data.diagrams.length > 0) {
    var diagramList112 = opt_data.diagrams;
    var diagramListLen112 = diagramList112.length;
    for (var diagramIndex112 = 0; diagramIndex112 < diagramListLen112; diagramIndex112++) {
      var diagramData112 = diagramList112[diagramIndex112];
      output += '<tr><td><div data-category="com.gliffy.transform.diagram" data-name="' + soy.$$escapeHtml(diagramData112.attachmentId) + '" class="gliffy-template"><div class="gliffy-image-placeholder" style="background-image:url(\'' + soy.$$escapeHtml(opt_data.rootApi) + soy.$$escapeHtml(diagramData112.urls.thumbnail) + '\')"></div></div><div class="gliffy-diagram-list-info">' + soy.$$escapeHtml(diagramData112.displayName ? diagramData112.displayName : diagramData112.name) + '<div class="gliffy-list-label">' + soy.$$escapeHtml('Last Modified by') + ' ' + soy.$$escapeHtml(diagramData112.lastModifier) + '</div></div></td><td>' + soy.$$escapeHtml(diagramData112.spaceName) + '</td><td>' + soy.$$escapeHtml(diagramData112.lastModifiedFriendly) + '</td></tr>';
    }
  } else {
    output += '<tr><td><div style="text-indent:7.5px;">' + soy.$$escapeHtml('No Diagrams Found') + '</div></td><td></td><td></td></tr>';
  }
  output += '</tbody></table>' + ((opt_data.results == opt_data.diagrams.length) ? '<div class="gliffy-placeholder" data-index="' + soy.$$escapeHtml(opt_data.index + opt_data.results) + '" data-results="' + soy.$$escapeHtml(opt_data.results) + '"></div>' : '');
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.listSearchResults.soyTemplateName = 'gliffySoy.macro.dialog.listSearchResults';
}


gliffySoy.macro.dialog.insertPanel = function(opt_data, opt_ignored) {
  return '<div><form class="gliffy-insert-search-form"><input class="gliffy-insert-search" type="text" placeholder="' + soy.$$escapeHtml('Search for a diagram') + '" value="' + soy.$$escapeHtml(opt_data.query) + '"></form>' + ((opt_data.message != null) ? '<div class="gliffy-warning-message"><div class="aui-message closeable shadowed warning"><p class="title"><span class="aui-icon icon-generic"></span><strong>' + soy.$$escapeHtml('Sorry, you cannot create new diagrams but you may insert existing ones.') + '</strong></p><p>' + soy.$$escapeHtml(opt_data.message) + '</p></div></div>' : '') + '<div class="gliffy-search-results ' + ((opt_data.insertOnly == true) ? 'gliffy-no-border' : '') + '"></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.insertPanel.soyTemplateName = 'gliffySoy.macro.dialog.insertPanel';
}


gliffySoy.macro.dialog.insertPanelCheckbox = function(opt_data, opt_ignored) {
  return '<form class="gliffy-toggle-insert">' + ((opt_data.blueprint != true) ? '<input class="gliffy-toggle-checkbox" type="checkbox" ' + ((opt_data.insertOnly == true) ? 'checked disabled' : '') + '/><span>' + soy.$$escapeHtml('Link to Original Diagram') + '</span><a class="gliffy-question-link" href="#" data-tooltip="' + soy.$$escapeHtml('Select this option to link and display the original diagram. Modifications to the original will be reflected in linked locations.') + '"><span class="gliffy-question-icon"></span></a>' : '') + '</form>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.insertPanelCheckbox.soyTemplateName = 'gliffySoy.macro.dialog.insertPanelCheckbox';
}


gliffySoy.macro.dialog.insertDropdown = function(opt_data, opt_ignored) {
  var output = ((opt_data.label.length > 0) ? '<span class="gliffy-dropdown-label">' + soy.$$escapeHtml(opt_data.label) + '</span>' : '') + '<div class="gliffy-btn-group ' + soy.$$escapeHtml(opt_data.name) + '" data-value="' + soy.$$escapeHtml(opt_data.items[0].shortName) + '"><button class="gliffy-btn gliffy-dropdown">' + soy.$$escapeHtml(opt_data.items[0].longName) + '</button><button class="gliffy-btn gliffy-dropdown-toggle"><span class="gliffy-caret"></span></button><ul class="gliffy-dropdown-menu">';
  var itemList187 = opt_data.items;
  var itemListLen187 = itemList187.length;
  for (var itemIndex187 = 0; itemIndex187 < itemListLen187; itemIndex187++) {
    var itemData187 = itemList187[itemIndex187];
    output += '<li><a href="#" data-value="' + soy.$$escapeHtml(itemData187.shortName) + '">' + soy.$$escapeHtml(itemData187.longName) + '</a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.insertDropdown.soyTemplateName = 'gliffySoy.macro.dialog.insertDropdown';
}


gliffySoy.macro.dialog.importPanel = function(opt_data, opt_ignored) {
  return '<div id="gliffy-upload-attachment"><form id="gliffy-create-import-form" class="aui" method="post" enctype="multipart/form-data" action="' + soy.$$escapeHtml(opt_data.contextPath) + '/rest/gliffy/1.0/diagrams/import"><fieldset class="inline"><div class="field gliffy-import-field-group"><input class="gliffy-import-text-input" type="text" placeholder="' + soy.$$escapeHtml('Upload a file from your computer') + '"/><a class="gliffy-import-browse">' + soy.$$escapeHtml('Browse') + '</a><div class="gliffy-file-input-wrapper"><input type="file" name="file" id="gliffy-import-file" class="gliffy-file-upload"/></div><input id="gliffy-security-token" type="hidden" name="atl_token" value=""></input><span id="gliffy-import-wait"></span><div class="gliffy-clear"></div><div id="gliffy-create-import-error" class="error gliffy-import-description"></div><div class="gliffy-create-import-type-description">' + soy.$$escapeHtml('The following file types are supported [click each for more info]:') + '</div><div id="gliffy-create-import-types" class="gliffy-create-import-types"><ul><li><a id="gliffy-file-type-gon" href="#">' + soy.$$escapeHtml('Gliffy Diagram') + ' (.gliffy, .gon)</a></li><li><a id="gliffy-file-type-gxml" href="#">' + soy.$$escapeHtml('Gliffy Diagram') + ' (.gxml)</a></li><li><a id="gliffy-file-type-vdx" href="#">' + soy.$$escapeHtml('Visio Diagram') + ' (.vsdx, .vdx)</a></li><li><a id="gliffy-file-type-drawio" href="#">' + soy.$$escapeHtml('Draw.io Diagram') + ' - ALPHA (.drawio, .xml)</a></li><li><a id="gliffy-file-type-lucidchart" href="#">' + soy.$$escapeHtml('Lucidchart Diagram - ALPHA') + '</a></li></ul></div></div></fieldset></form><div class="#gliffy-create-import-error"></div><div class="gliffy-import-help-container"></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importPanel.soyTemplateName = 'gliffySoy.macro.dialog.importPanel';
}


gliffySoy.macro.dialog.importGliffyHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-image"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/com.gliffy.integration.confluence/icons/gliffy_online_file_menu.png"/><p><sup>*</sup> ' + soy.$$escapeHtml('Gliffy Online File Menu') + '</p></div><div class="gliffy-help-text"><p>' + soy.$$escapeHtml('The import dialog supports the import of Gliffy Diagrams (.gxml) that are exported from the Gliffy Editor.') + '</p><p>' + soy.$$escapeHtml('This allows you to import a diagram from any Gliffy product be it the Gliffy JIRA Plugin, Gliffy Online *, or even from another Confluence page.') + '</p><p>' + soy.$$escapeHtml('From the Gliffy Editor, navigate to the \x27file\x27 menu and choose \x27Export as Gliffy XML\x27.') + '</p><div class="aui-message warning shadowed"><p class="title"><span class="aui-icon icon-warning"></span><strong>' + soy.$$escapeHtml('Using Gliffy Diagrams Attached to a Confluence Page or JIRA Issue') + '</strong></p><p>' + soy.$$escapeHtml('Gliffy Diagrams downloaded as an attachment from a Confluence Page or JIRA Issue are not guaranteed to work, unless it was exported using the method described above.') + '</p><p>' + soy.$$escapeHtml('An easy way to tell if your diagram will import is to look for the \x3ccode\x3e.gxml\x3c/code\x3e extension in your filename.') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importGliffyHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importGliffyHelpPanel';
}


gliffySoy.macro.dialog.importGliffyGonHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-image"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/com.gliffy.integration.confluence/icons/gliffy_export_file_menu.png"/><p><sup>*</sup> ' + soy.$$escapeHtml('Gliffy HTML5 File Menu') + '</p></div><div class="gliffy-help-text"><p>' + soy.$$escapeHtml('The import dialog supports the import of Gliffy Diagrams (.gon) that are exported from the Gliffy HTML5 Editor.') + '</p><p>' + soy.$$escapeHtml('From the Gliffy HTML5 Editor, navigate to the \x27File\x27 menu and choose \x27Export as Gliffy\x27.') + '</p><div class="aui-message info" style="width: 440px;"><p class="title"><span class="aui-icon icon-info"></span><strong>' + soy.$$escapeHtml('Gliffy HTML5 files are fully portable!') + '</strong></p><p>' + soy.$$escapeHtml('You can download a Gliffy HTML5 diagram directly from the attachments page. Make sure your diagram is of this content type:') + '</p><p><code>' + soy.$$escapeHtml('application/gliffy+json') + '</code></p><p>' + soy.$$escapeHtml('Just attach the diagram to any Confluence page, and you can immediately use \x27Insert Diagram\x27 from the macro dialog to show it on your wiki page.  No importing is necessary!') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importGliffyGonHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importGliffyGonHelpPanel';
}


gliffySoy.macro.dialog.importVisioHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-text"><span id="gliffy-visio-description-spinner"></span><p id="gliffy-visio-description">' + soy.$$escapeHtml('The import dialog supports the import of Visio diagrams (.vsdx, .vdx) that are saved from Microsoft Visio.') + '</p><h3 id="gliffy-import-visio-prep">' + soy.$$escapeHtml('Preparing the Visio File') + '</h3><ol><li>' + soy.$$escapeHtml('In Visio, open the file that you want to import into Gliffy.') + '</li><li>' + soy.$$escapeHtml('If this file has multiple worksheets, select the worksheet that you want to export.') + '</li><li>' + soy.$$escapeHtml('Select File \x3e Save As.') + '</li><li>' + soy.$$escapeHtml('Choose either \x22Visio Drawing (*.vsdx)\x22 or \x22XML Drawing (*.vdx)\x22.') + '</li><li>' + soy.$$escapeHtml('Save the file.') + '</li></ol><h3 id="gliffy-import-visio-reduce-size">' + soy.$$escapeHtml('Reducing the Visio File Size (Optional)') + '</h3><ol><li>' + soy.$$escapeHtml('Load the file into Visio.') + '</li><li>' + soy.$$escapeHtml('Select File \x3e Info.') + '</li><li>' + soy.$$escapeHtml('Click on the button \x22Reduce File Size\x22 and check the boxes.') + '</li><li>' + soy.$$escapeHtml('Save the file.') + '</li></ol><div class="aui-message warning shadowed"><p class="title"><span class="aui-icon icon-warning"></span><strong>' + soy.$$escapeHtml('Missing Shapes') + '</strong></p><div class="gliffy-import-missing-shape"></div><p>' + soy.$$escapeHtml('If you see a shape like the image on the right then you have encountered a shape that the importer was not able to convert. The most common reason for this occurs when using 3rd party symbols or Visio clip art. Feel free to contact support if you experience these at') + ' <a href="mailto:support@gliffy.com">support@gliffy.com</a>.</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importVisioHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importVisioHelpPanel';
}


gliffySoy.macro.dialog.importDrawIoHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-text"><p>' + soy.$$escapeHtml('The import dialog supports the import of Draw.io Diagrams (.drawio or .xml) that are exported from the Draw.io Editor.') + '</p><p>' + soy.$$escapeHtml('From the Draw.io Editor, navigate to the \x22File\x22 menu, choose \x22Save As...\x22 and select \x22Device\x22 to download the file.') + '</p><div class="aui-message warning" style="width: 420px;"><p class="title"><span class="aui-icon icon-info"></span><strong>' + soy.$$escapeHtml('Draw.io import is in Alpha stage') + '</strong></p><p>' + soy.$$escapeHtml('Please note that certain imported images and shapes may populate as a blank placeholder. We appreciate your patience as we continue to grow and improve this feature.') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importDrawIoHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importDrawIoHelpPanel';
}


gliffySoy.macro.dialog.importLucidchartHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-text"><p>' + soy.$$escapeHtml('Navigate to the Confluence page where the diagram is and download it as an attachment to your computer.') + '</p><p>' + soy.$$escapeHtml('From the import screen, click the \x22Choose file\x22 button and select your downloaded Lucidchart attachment.') + '</p><div class="aui-message warning" style="width: 420px;"><p class="title">' + soy.$$escapeHtml('Lucidchart import is in Alpha stage') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importLucidchartHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importLucidchartHelpPanel';
}


gliffySoy.macro.dialog.spaceOptions = function(opt_data, opt_ignored) {
  var output = '';
  var spaceList300 = opt_data.spaces;
  var spaceListLen300 = spaceList300.length;
  for (var spaceIndex300 = 0; spaceIndex300 < spaceListLen300; spaceIndex300++) {
    var spaceData300 = spaceList300[spaceIndex300];
    output += '<option value="' + soy.$$escapeHtml(spaceData300.shortName) + '">' + soy.$$escapeHtml(spaceData300.longName) + '</option>';
  }
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.spaceOptions.soyTemplateName = 'gliffySoy.macro.dialog.spaceOptions';
}


gliffySoy.macro.dialog.searchResult = function(opt_data, opt_ignored) {
  var output = '<table><thead><tr class="gliffy-data-table-header"><th class="gliffy-title-field">' + soy.$$escapeHtml('Title') + '</th><th class="gliffy-space-field">' + soy.$$escapeHtml('Space') + '</th><th class="gliffy-last-modified-field">' + soy.$$escapeHtml('Last Modified') + '</th></tr></thead><tbody>';
  var diagramList315 = opt_data.diagrams;
  var diagramListLen315 = diagramList315.length;
  if (diagramListLen315 > 0) {
    for (var diagramIndex315 = 0; diagramIndex315 < diagramListLen315; diagramIndex315++) {
      var diagramData315 = diagramList315[diagramIndex315];
      output += '<tr data-attachment-id="' + soy.$$escapeHtml(diagramData315.attachmentId) + '" data-name="' + soy.$$escapeHtml(diagramData315.name) + '" data-page-id="' + soy.$$escapeHtml(diagramData315.pageId) + '" data-version="' + soy.$$escapeHtml(diagramData315.version) + '" ' + ((diagramIndex315 == 0) ? 'class="gliffy-selected"' : '') + '><td class="gliffy-title-field">' + soy.$$escapeHtml(diagramData315.displayName ? diagramData315.displayName : diagramData315.name) + '</td><td class="gliffy-space-field">' + soy.$$escapeHtml(diagramData315.spaceName) + '</td><td class="gliffy-last-modified-field">' + soy.$$escapeHtml(diagramData315.lastModifiedFriendly) + '</td></tr>';
    }
  } else {
    output += '<tr data-empty="true"><td>' + soy.$$escapeHtml('No results') + '</td></tr>';
  }
  output += '</tbody></table>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.searchResult.soyTemplateName = 'gliffySoy.macro.dialog.searchResult';
}


gliffySoy.macro.dialog.importResult = function(opt_data, opt_ignored) {
  var output = '<ul id="gliffy-import-list" class="gliffy-image-list">';
  var attachmentList343 = opt_data.attachments;
  var attachmentListLen343 = attachmentList343.length;
  if (attachmentListLen343 > 0) {
    for (var attachmentIndex343 = 0; attachmentIndex343 < attachmentListLen343; attachmentIndex343++) {
      var attachmentData343 = attachmentList343[attachmentIndex343];
      output += gliffySoy.macro.dialog.importResultItem({attachment: attachmentData343, contextPath: opt_data.contextPath});
    }
  } else {
    output += '<li id="gliffy-import-empty" data-empty="true"><span>' + soy.$$escapeHtml('No results') + '</span></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importResult.soyTemplateName = 'gliffySoy.macro.dialog.importResult';
}


gliffySoy.macro.dialog.importResultItem = function(opt_data, opt_ignored) {
  return '<li class="gliffy-attached-image" data-attachment-id="' + soy.$$escapeHtml(opt_data.attachment.attachmentId) + '" data-name="' + soy.$$escapeHtml(opt_data.attachment.name) + '" data-page-id="' + soy.$$escapeHtml(opt_data.attachment.pageId) + '" data-version="' + soy.$$escapeHtml(opt_data.attachment.version) + '"><div class="gliffy-image-container"><img width="100" height="100" title="' + soy.$$escapeHtml(opt_data.attachment.name) + '" src="' + soy.$$escapeHtml(opt_data.contextPath) + '/rest/gliffy/1.0' + soy.$$escapeHtml(opt_data.attachment.urls.thumbnail) + '" class="thumbnail"/></div><span class="caption filename">' + soy.$$escapeHtml(opt_data.attachment.name) + '</span><span class="caption owner-title">' + soy.$$escapeHtml(opt_data.attachment.lastModifiedFriendly) + '</span></li>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importResultItem.soyTemplateName = 'gliffySoy.macro.dialog.importResultItem';
}


gliffySoy.macro.dialog.morePropertyPanel = function(opt_data, opt_ignored) {
  var output = '<form action="#" method="post" class="aui top-label" name="gliffy-more-form"><fieldset><div class="field-group"><label for="gliffy-dialog-more-size-field">' + soy.$$escapeHtml('Size') + '</label><input id="gliffy-dialog-more-size-field" name="gliffy-dialog-more-size-field" class="text" type="text" value="' + soy.$$escapeHtml(opt_data.size) + '"/><div id="gliffy-dialog-more-size-error-field" class="error"></div><div class="description">' + soy.$$escapeHtml('Width in #px | T (150px) | S (1:3) | M (2:3) | L (1:1)') + '</div></div><div class="field-group"><label for="gliffy-dialog-more-chrome">' + soy.$$escapeHtml('Viewer Toolbar') + '</label><select name="gliffy-chrome" id="gliffy-dialog-more-chrome-field">';
  var chromeOptionList383 = opt_data.chromeOptions;
  var chromeOptionListLen383 = chromeOptionList383.length;
  for (var chromeOptionIndex383 = 0; chromeOptionIndex383 < chromeOptionListLen383; chromeOptionIndex383++) {
    var chromeOptionData383 = chromeOptionList383[chromeOptionIndex383];
    output += (chromeOptionData383.key == opt_data.selectedChromeOption) ? '<option value="' + soy.$$escapeHtml(chromeOptionData383.key) + '" selected="selected">' + soy.$$escapeHtml(chromeOptionData383.value) + '</option>' : '<option value="' + soy.$$escapeHtml(chromeOptionData383.key) + '">' + soy.$$escapeHtml(chromeOptionData383.value) + '</option>';
  }
  output += '</select><div class="description">' + soy.$$escapeHtml('\x22Full\x22 displays Edit/Zoom controls') + '</div></div>' + ((! opt_data.isHtml5ViewerDisabledByAdmin) ? '<div class="field-group"><input class="gliffy-dialog-interactive-viewer-checkbox" type="checkbox" ' + ((opt_data.html5Viewer == true) ? 'checked' : '') + '/><span>' + soy.$$escapeHtml('Interactive HTML5 Viewer') + '</span><div class="description">' + soy.$$escapeHtml('Display preview image when disabled') + '</div></div>' : '') + '</fieldset></form>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.morePropertyPanel.soyTemplateName = 'gliffySoy.macro.dialog.morePropertyPanel';
}


gliffySoy.macro.dialog.versionPropertyPanel = function(opt_data, opt_ignored) {
  var output = '<form action="#" method="post" class="aui top-label" name="gliffy-version-form"><fieldset><div class="field-group"><div class="description">' + soy.$$escapeHtml('Select which diagram version to pin to the page.') + '</div><select name="gliffy-version" id="gliffy-dialog-version-field">';
  var versionList417 = opt_data.versions;
  var versionListLen417 = versionList417.length;
  for (var versionIndex417 = 0; versionIndex417 < versionListLen417; versionIndex417++) {
    var versionData417 = versionList417[versionIndex417];
    output += (versionData417.key == opt_data.selectedVersion) ? '<option value="' + soy.$$escapeHtml(versionData417.key) + '" selected="selected">' + soy.$$escapeHtml(versionData417.value) + '</option>' : '<option value="' + soy.$$escapeHtml(versionData417.key) + '">' + soy.$$escapeHtml(versionData417.value) + '</option>';
  }
  output += '</select><div id="gliffy-version-dialog-information" class="description"></div><a id="gliffy-diagram-preview"><img id="gliffy-diagram-thumbnail"></a></div></fieldset></form>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.versionPropertyPanel.soyTemplateName = 'gliffySoy.macro.dialog.versionPropertyPanel';
}


gliffySoy.macro.dialog.noSaveDialog = function(opt_data, opt_ignored) {
  return '<div>' + soy.$$escapeHtml(opt_data.pageUnsavedMessage) + '</div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.noSaveDialog.soyTemplateName = 'gliffySoy.macro.dialog.noSaveDialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = '/templates/gliffy-edit-linked-diagram.soy' */
// This file was automatically generated from gliffy-edit-linked-diagram.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.editLinkedDiagram.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.editLinkedDiagram == 'undefined') { gliffySoy.editLinkedDiagram = {}; }


gliffySoy.editLinkedDiagram.dialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="gliffy-dialog-edit-linked-diagram" class="aui-layer aui-dialog2 aui-dialog2-small" aria-hidden="true"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('You are being redirected') + '</h2><a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">X</span></a></header><div class="aui-dialog2-content"><p>' + soy.$$escapeHtml('You are being redirected to the source diagram page.') + '</p><p>' + soy.$$escapeHtml('Editing the original diagram will update all linked diagrams.') + '</p></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><a id="gliffy-dialog-edit-linked-diagram-ok" class="aui-button aui-button-primary" href="#" target="_blank">' + soy.$$escapeHtml('Go to source diagram page') + '</a></div></footer></section>';
};
if (goog.DEBUG) {
  gliffySoy.editLinkedDiagram.dialog.soyTemplateName = 'gliffySoy.editLinkedDiagram.dialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = '/templates/gliffy-old-draft-message.soy' */
// This file was automatically generated from gliffy-old-draft-message.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.oldDrafts.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.oldDrafts == 'undefined') { gliffySoy.oldDrafts = {}; }


gliffySoy.oldDrafts.popup = function(opt_data, opt_ignored) {
  return '<div class="gliffy-draft-message-popup aui-flag" aria-hidden="false"><div class="aui-message aui-message-info info closeable shadowed"><p class="title"></p><span class="draft-message">' + soy.$$filterNoAutoescape(opt_data.message) + '</span><span class="gliffy-close-icon aui-icon icon-close" role="button"></span></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.oldDrafts.popup.soyTemplateName = 'gliffySoy.oldDrafts.popup';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'gliffy/confluence/Analytics.js' */
define("gliffy/interface/analytics", [
    "jquery",
    "gliffy/confluence/rest/webRequestPromiseFactory"
], function($, webRequestPromiseFactory) {

    var isEnabled = false;

    var getAnalyticsDisabled = webRequestPromiseFactory.buildGetPropertyValuePromise("com.gliffy.integration.confluence.ANALYTICS_OFF");
    $.when(getAnalyticsDisabled).then(function(result) {
        isEnabled = !result;
        if(isEnabled) {
            analytics.event('init', {accountType:'google', accountID:'UA-248648-13', optPageName:'Gliffy Confluence Init'});
            // to debug analytics, uncomment the following line
            analytics.event('logEvents', {logEvents: true, logger: console});
            analytics.event('setLabel', {label: 'none'});
            analytics.event('setCustomVariables', {
                product: 'Confluence',
                license: $('meta[name=gliffy-license-type]').attr("content"),
                numUsers: parseInt($('meta[name=gliffy-license-quantity]').attr("content"))
            });
        }
    });

    var analytics = {
        event: function (type, options) {
            if (isEnabled) {
                $(window).trigger(type + '.gliffyAnalytics', options);
            }
        }
    };

    return analytics;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'gliffy/confluence/macro/controller/PropertyPanelController.js' */
// Register as apex module so this module can be instantiated after everybody is registered.
var apexModuleManager = require("gliffy/amd/apexModuleManager");
apexModuleManager.define("gliffy/confluence/macro/controller/PropertyPanelController", [
    "jquery",
    "GliffySpinner",
    "gliffy/confluence/rest/urlFactory",
    "gliffy/confluence/rest/webRequestPromiseFactory",
    "gliffy/confluence/editor/editorLauncher",
    "gliffy/confluence/pageFacade",
    "gliffy/interface/analytics"
], function($, GliffySpinner, urlFactory, webRequestPromiseFactory, editorLauncher, pageFacade, analytics, EmbedMacroController) {

    //======================================================================================================================
    // Property panel button handlers
    //======================================================================================================================

    var LATEST = 0;
    var isEditLinkedDialogCreated = false;

    function gliffyEdit (macroNode) {

        AJS.Rte.BookmarkManager.storeBookmark();
        var name = macroNode.params ? macroNode.params['name'] : null;
        var isNamed = name && name.length >0;

        if (macroNode["params"] && (isNamed || macroNode.params['macroId'])) {

            if (AJS.Meta.get('form-name') === 'createpagetemplate' || AJS.Meta.get('form-name') === 'editpagetemplate') {
                noEditingTemplateDiagramDialog();
            } else if (macroNode.params.blueprint) {
                AJS.trigger("gliffy.confluence.launchTemplate", [macroNode.params.blueprint, macroNode.params.name]);
            } else if (macroNode.params.attachmentId) {
                //GCONF-1573
                AJS.trigger("gliffy.confluence.launchTemplate", ["com.gliffy.transform.diagram", macroNode.params.attachmentId]);
            } else if (macroNode.params.page && macroNode.params.name && !macroNode.params.pageid) {
                //GCONF-1680 old style macro - this needs to be entered by hand to trigger this case!
                launchEditorForLegacyMacro(macroNode);
            } else if(macroNode.params.pageid){
                launchLinkedDiagramEditorFlow(macroNode.params.pageid);
            } else {
                //new macros should be using ceoid (page id). This is the main flow.
                launchEditor(macroNode);
            }
        }
        else {
            //show the gliffy choice dialog
            AJS.trigger("gliffy.confluence.showMacroDialog");
        }
    };

    function noEditingTemplateDiagramDialog(){
        var alertDialog = new AJS.Dialog({
            width: 450,
            height: 250,
            id: "gliffy-no-editing-template-message",
            closeOnOutsideClick: true
        });
        alertDialog.addHeader("Gliffy in Page Templates").
        addPanel("SinglePanel", '', "gliffy-no-editing-template-content");
        $('.gliffy-no-editing-template-content').html("Gliffy diagrams cannot be edited in page templates.  Please edit the diagram from the page where it is attached and changes will be reflected here.");

        alertDialog.addCancel("Close", function () {
            alertDialog.hide();
        });

        alertDialog.show();
    };

    function launchEditorForLegacyMacro(macroNode){
        if (macroNode.params.space == null) {
            // use the current space key
            macroNode.params.space = AJS.Meta.get('space-key');
        }

        var ceoFindUrl = AJS.format(
            "{0}/ceo/find/space/{1}/page/{2}/name/{3}",
            GLIFFY._confluence.gvars.gliffyApiEndpoint,
            encodeURIComponent(macroNode.params.space),
            encodeURIComponent(macroNode.params.page),
            encodeURIComponent(macroNode.params.name)
        );

        //lookup the ceo + attachment ids (this call also checks for permission at the same time to cut down on calls)
        $.ajax({
            type: "GET",
            url: ceoFindUrl,
            dataType: "json",
            cache: false,
            success: function (data) {

                // NOTE: this won't work with linked diagrams, but linked diagrams were not supported when
                // old-style macros were used.
                editorLauncher.launchEditorFromEditPage({
                    editor: GLIFFY._confluence.editor,
                    diagramName: macroNode.params.name,
                    ownerPageId: data.id,
                    referencePageId: data.id,
                    attachmentId: data.attachmentId,
                    attachmentVersion: data.attachmentVersion,
                    pagePin: LATEST,
                    macroId: macroNode.params.macroId,
                    template: {
                        category: "com.gliffy.diagram"
                    }
                });
            },
            error: function (xhr, textstatus, errorThrown) {
                alert(GLIFFY._confluence.utils.parseError(xhr));
            }
        });
    };

    function launchLinkedDiagramEditorFlow(pageId){
        if(!isEditLinkedDialogCreated){
            createEditLinkedDialog(pageId);
        }
        showEditLinkedDialog();
    };

    function launchEditor(macroNode){
        // Use the current pageId if a pageId when it is not specified
        macroNode.params.pageid = Confluence.Editor.getContentId();

        var getEditPermission;
        if (macroNode.params['name']) {
            getEditPermission = webRequestPromiseFactory.buildGetEditDiagramPermissionPromise(macroNode.params.pageid, macroNode.params.name);
        } else{
            getEditPermission = webRequestPromiseFactory.buildGetCreateAttachmentPermissionPromise(macroNode.params.pageid);
        }
        var getWootricState = $.ajax({url:AJS.Confluence.getContextPath() + '/rest/gliffy/1.0/qa/instrumentation/wootric'});
        $.when(getEditPermission, getWootricState).done(function (permissionResponse, wootric) {
            // Edit link
            var attachmentId = permissionResponse[0] ? permissionResponse[0].attachmentId : 0;
            var attachmentVersion = parseInt(macroNode.params.version) || LATEST;
            editorLauncher.launchEditorFromEditPage({
                editor: GLIFFY._confluence.editor,
                diagramName: macroNode.params.name,
                displayName: macroNode.params.displayName,
                ownerPageId: macroNode.params.pageid,
                referencePageId: Confluence.Editor.getContentId(),
                attachmentVersion: attachmentVersion,
                pagePin: macroNode.params.pagePin,
                macroId: macroNode.params.macroId,
                attachmentId: attachmentId,
                template: {
                    category: "com.gliffy.diagram"
                },
                wootric: (wootric[0] === 'true') ? 'true' : undefined
            });
        }).fail(function (xhr) {
            alert(GLIFFY._confluence.utils.parseError(xhr));
        });
    };

    function linkToSourceDiagramPage(pageId){
        var gotoLinkedPageButton = document.getElementById('gliffy-dialog-edit-linked-diagram-ok');

        gotoLinkedPageButton.href = AJS.Confluence.getContextPath()+'/pages/editpage.action?pageId='+ pageId;

        gotoLinkedPageButton.addEventListener('click', function() {
            AJS.dialog2('#gliffy-dialog-edit-linked-diagram').hide();
        });
    };

    function appendSoyTemplate(jsSelector, soyTemplate, opt_data, opt_ignored) {
        var node = document.createElement('template');
        node.innerHTML = soyTemplate(opt_data, opt_ignored);
        jsSelector.appendChild(node.firstChild || node.content.firstChild);
    };

    function createEditLinkedDialog(pageId) {
        appendSoyTemplate(document.body, gliffySoy.editLinkedDiagram.dialog);

        linkToSourceDiagramPage(pageId);

        isEditLinkedDialogCreated = true;
    };

    function showEditLinkedDialog(){
        AJS.dialog2('#gliffy-dialog-edit-linked-diagram').show();
    };

    function gliffyImageSize (macroNode, imageSize) {

        var macroDiv = AJS.$(macroNode);
        AJS.Rte.getEditor().selection.select(macroDiv[0]);
        AJS.Rte.BookmarkManager.storeBookmark();

        var diagramReference = pageFacade.getDiagramReference(macroDiv);
        diagramReference.size = imageSize;
        pageFacade.addDiagramReference(diagramReference, macroDiv[0]);
    };

    function gliffyBorderToggle (macroNode) {

        var macroDiv = AJS.$(macroNode);
        AJS.Rte.getEditor().selection.select(macroDiv[0]);
        AJS.Rte.BookmarkManager.storeBookmark();

        var diagramReference = pageFacade.getDiagramReference(macroDiv);
        diagramReference.border = !diagramReference.border;
        pageFacade.addDiagramReference(diagramReference, macroDiv[0]);
    };

    function gliffySubmitMoreDialog (dialog) {

        var LEGACY_MACRO_SIZE_OPTIONS = ["T", "S", "M", "L", "O"];

        var sanitizeSize = function (sizeFieldValue) {

            var size = $.trim(sizeFieldValue);
            if (size.length === 0) {
                return "";
            }

            if ($.inArray(size, LEGACY_MACRO_SIZE_OPTIONS) >= 0) {
                return size;
            }

            var sizeInt = parseInt(size);
            if (isNaN(sizeInt)) {
                return false;
            }
            var isValidNumericalSizeValue = sizeInt >= 150 && sizeInt <= 3000;
            if (isValidNumericalSizeValue) {
                return sizeInt;
            }

            return false;
        };

        var diagramReference = $(".gliffy-more-panel").data("diagramReference");
        var macroNode = $(".gliffy-more-panel").data("macroNode");
        var sizeField = $("#gliffy-dialog-more-size-field");

        var sanitizedSize = sanitizeSize(sizeField.val());
        if (sanitizedSize === false) {
            $("#gliffy-dialog-more-size-error-field").text("Invalid input (150 min, 3000 max)");
            return false;
        } else {
            ("" === sanitizedSize) ? delete diagramReference.size : diagramReference.size = sanitizedSize;
        }

        diagramReference.chrome = $("#gliffy-dialog-more-chrome-field").val();
        diagramReference.html5 = $(".gliffy-dialog-interactive-viewer-checkbox").is(':checked');

        pageFacade.addDiagramReference(diagramReference, macroNode);
        dialog.remove();
    };

    function setupMoreDialogOptions (diagramReference, isHtml5ViewerDisabledByAdmin) {
        return {
            size: (diagramReference.size == null) ? "" : diagramReference.size,
            chromeOptions: [
                {key: "full", value: "Full"},
                {key: "min", value: "None"}
            ],
            selectedChromeOption: (diagramReference.chrome == null) ? "full" : diagramReference.chrome,
            html5Viewer: (diagramReference.html5 === undefined || diagramReference.html5 === null) ? true : diagramReference.html5 == "true",
            isHtml5ViewerDisabledByAdmin: isHtml5ViewerDisabledByAdmin
        };
    };

    function showMoreDialog (diagramReference, macroNode, moreDialogData) {

        var moreDialog = new AJS.Dialog(340, 380, "gliffy-dialog-more");
        moreDialog.addHeader("Additional Options", "");

        moreDialog.addPanel("More Panel", gliffySoy.macro.dialog.morePropertyPanel(moreDialogData), "gliffy-more-panel", 0);
        $(".gliffy-more-panel").data("diagramReference", diagramReference).data("macroNode", macroNode);

        moreDialog.addButton("Update", gliffySubmitMoreDialog, "gliffy-more-update");

        moreDialog.addCancel("Cancel", function (dialog) {
            AJS.Rte.BookmarkManager.restoreBookmark();
            dialog.remove();
        });

        moreDialog.show();
    };

    function gliffyMoreButton (macroNode) {

        var macroDiv = AJS.$(macroNode);
        AJS.Rte.getEditor().selection.select(macroDiv[0]);
        AJS.Rte.BookmarkManager.storeBookmark();

        var diagramReference = pageFacade.getDiagramReference(macroDiv);

        var getProperty = webRequestPromiseFactory.buildGetPropertyValuePromise("com.gliffy.integration.confluence.HTML5_OFF");
        $.when(getProperty).then(function(result) {
            var moreDialogData = setupMoreDialogOptions(diagramReference, !!result);
            showMoreDialog(diagramReference, macroNode, moreDialogData);
        });
    };

    function updateVersionInformation (versionData, diagramName, pageId) {

        $("#gliffy-version-dialog-information").text("");

        var selectedVal = +$('#gliffy-dialog-version-field').val();
        var versionInfo = versionData.allVersionInformation[selectedVal - 1];

        if (selectedVal === LATEST) {
            versionInfo = versionData.allVersionInformation[versionData.allVersionInformation.length - 1];
        }

        if (versionInfo) {
            $("#gliffy-version-dialog-information").text(versionInfo);
        }

        $("#gliffy-diagram-preview").attr('href', urlFactory.buildDiagramPreviewImageUrl(pageId, diagramName, selectedVal));
        $("#gliffy-diagram-thumbnail").attr('src', urlFactory.buildDiagramThumbnailImageUrl(pageId, diagramName, selectedVal));

        var v = (selectedVal === 0) ? versionData.allVersionInformation.length : selectedVal;

        //GCONF-2013 fancybox is depricated.  check for previewer, but fallback to fancybox if not available
        var previewImage = $("#gliffy-diagram-thumbnail");
        if (previewImage.previewer) {
            $(previewImage).previewer({
                src: $("#gliffy-diagram-preview").attr('href'),
                type: "image/png",
                title: "v" + v,
                zindex: 10000
            }).closest('a').attr('href', '#').click(function (ev) {
                ev.preventDefault(); //supresses message warning that user is navigating from the page
            }); //we're keeping the <a> link to for legacy instances that use fancy box
        } else {
            $("#gliffy-diagram-preview").fancybox({
                type: 'image',
                showCloseButton: true,
                hideOnOverlayClick: true,
                hideOnContentClick: true,
                title: 'v' + v
            });
        }
    };

    function gliffyVersionButton (macroNode) {
        analytics.event('trackEvent', {category:'viewer', action:'showVersionPinningDialog'});

        var clickOutsideDialogHandler = function(event) {
            if (!$(event.target).closest('#gliffy-version-dialog').length) {
                $(document).off('click', clickOutsideDialogHandler);
                dialog.remove();
            }
        };

        $(document).on('click', clickOutsideDialogHandler);

        var $macroNode = AJS.$(macroNode);
        var diagramReference = pageFacade.getDiagramReference($macroNode);
        var pageid = diagramReference.ownerPageId;

        var dialog = new AJS.Dialog({
            width: 340,
            height: 430,
            id: 'gliffy-version-dialog',
            closeOnOutsideClick: false // GCONF-2194: don't set this to true. it can break dialog functionality
        });
        dialog.addHeader("Version");
        dialog.addPanel('Panel 1','<div/>', 'gliffy-version-body');
        dialog.addLink("Cancel", function (dialog) {
            $(document).off('click', clickOutsideDialogHandler);
            dialog.remove();
        }, '#');
        dialog.show();

        var versionDialog = AJS.$('#gliffy-version-dialog');
        var spinner = new GliffySpinner(versionDialog.get(0), {
            radius: 50,
            color: '#666'
        });
        spinner.start();

        var getVersions = webRequestPromiseFactory.buildGetDiagramVersionsPromise(pageid, diagramReference.name);
        var processVersionsResponse = function (response) {
            spinner.stop();
            var versions = [
                {key: '0', value: "Latest"}
            ];
            var index = 0;
            for (var i = response.numRevisions; i > 0; i--) {
                versions.push({
                    key: '' + response.revisions[index].version,
                    value: 'v' + response.revisions[index].version
                });
                index++;
            }

            var data = {
                versions: versions,
                selectedVersion: diagramReference.version || 0,
                allVersionInformation: response.revisions.map(function (value) {
                    return value.lastModifiedFriendly + " by " + value.creator;
                }).reverse()

            };

            $('.gliffy-version-body').html(gliffySoy.macro.dialog.versionPropertyPanel(data));
            dialog.addButton("Update", function (dialog) {
                $(document).off('click', clickOutsideDialogHandler);

                analytics.event('trackEvent', {category: 'viewer', action: 'pinToNewVersion'});

                var selectedVal = $('#gliffy-dialog-version-field').val();
                diagramReference.version = parseInt(selectedVal);
                pageFacade.addDiagramReference(diagramReference, macroNode);
                dialog.remove();
            });

            dialog.gotoPanel(0);

            updateVersionInformation(data, diagramReference.name, pageid);

            // add a handler for version selector, to display version information when changed
            $("#gliffy-dialog-version-field").change(function () {
                updateVersionInformation(data, diagramReference.name, pageid);
            });
        };

        function getVersionsFailed (xhr) {
            spinner.stop();
            $('#gliffy-version-dialog').remove();
            if (xhr.status === 404) {

                var dialog = new AJS.Dialog({
                    width: 340,
                    height: 190,
                    id: 'gliffy-version-dialog',
                    closeOnOutsideClick: true
                });

                var data = {
                    pageUnsavedMessage: "Sorry, version information is not available until the Confluence page has been saved."
                };

                dialog.addPanel('Diagram Version Selection', gliffySoy.macro.dialog.noSaveDialog(data), 'gliffy-version-body'); // ?
                dialog.addButton("Close", function (dialog) {
                    dialog.remove();
                });

                dialog.gotoPanel(0);
                dialog.show();
            }
        };

        $.when(getVersions).done(processVersionsResponse).fail(getVersionsFailed);
    };

    // Disable submit of form
    $("form[name='gliffy-more-form']").live("submit", function () {
        return false;
    });

    //======================================================================================================================
    // Override property panel style on create
    //======================================================================================================================
    //this is the atlassian custom event that is fired when a property panel is created.
    AJS.bind("created.property-panel", function (event, panel) {
        var macro = $(panel.anchor);
        if (macro.data("macro-name") === "gliffy") {
            //check if any buttons should be selected
            var diagramReference = pageFacade.getDiagramReference(macro);
            if (diagramReference.border) {
                panel.panel.find(".macro-property-panel-gliffy-button-image-border").addClass("selected");
            }
            //size
            if (diagramReference.size) {
                switch (diagramReference.size) {
                    case '300':
                        panel.panel.find(".macro-property-panel-gliffy-button-image-small").addClass("selected");
                        break;
                    case '600':
                        panel.panel.find(".macro-property-panel-gliffy-button-image-medium").addClass("selected");
                        break;
                    case '1200':
                        panel.panel.find(".macro-property-panel-gliffy-button-image-large").addClass("selected");
                        break;
                    default:
                        break;
                }
            }
            else {
                panel.panel.find(".macro-property-panel-gliffy-button-image-original").addClass("selected");
            }
        }
    });

    //======================================================================================================================
    // Override property panel macro when rte is ready
    //======================================================================================================================
    //override property panel

    // GCONF-809
    AJS.MacroBrowser.setMacroJsOverride('gliffy', {
        opener: gliffyEdit
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-small", function (e, macroNode) {
        gliffyImageSize(macroNode, "300");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-medium", function (e, macroNode) {
        gliffyImageSize(macroNode, "600");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-large", function (e, macroNode) {
        gliffyImageSize(macroNode, "1200");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-original", function (e, macroNode) {
        gliffyImageSize(macroNode, "O");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-border", function (e, macroNode) {
        gliffyBorderToggle(macroNode);
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-more", function (e, macroNode) {
        gliffyMoreButton(macroNode);
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-version", function (e, macroNode) {
        gliffyVersionButton(macroNode);
    });
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'gliffy/confluence/ContextFinalizer.js' */
/**
 * Exists to require, and therefore execute, application-level bits like DOM controllers.
 * This must be included as the final resource of the web-resource definition
 */
;(function($, apexModuleManager) {
    // Wait for DOM to be loaded before instantiating apex modules.
    $(function () {
        apexModuleManager.instantiateAll();
        apexModuleManager.reset();
    });
})(require('jquery'), require('gliffy/amd/apexModuleManager'));


}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.widgetconnector:widget-connector-autoconvert-web-resources-v4', location = 'com/atlassian/confluence/extra/widgetconnector/js/autoconvert-widget-links.js' */
define("confluence-widget-connector/autoconvert",["tinymce"],function(c){var d=[/open.spotify.com/,/facebook.com/,/linkedin.com\/embed/,/twitter.com/,/figma.com/,/prezi.com/,/microsoftstream.com/,/google([.a-z]+)\/(maps|calendar|presentation|document)/,/google([.a-z]+)\/spreadsheets(.*)(pubchart|pubhtml)/];return{WidgetAutoConvertFn:function(e,g,a){var b=decodeURI(e.source);d.find(function(f){return b.match(f)})?c.plugins.Autoconvert.convertMacroToDom({name:"widget",params:{url:b}},a,a):a()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.widgetconnector:widget-connector-autoconvert-web-resources-v4', location = 'com/atlassian/confluence/extra/widgetconnector/js/autoconvert-widget-links-editor-v4.js' */
define("confluence-widget-connector/autoconvert-plugin-v4",["tinymce","confluence-editor/loader/tinymce-bootstrap","confluence-widget-connector/autoconvert"],function(b,c,d){b.PluginManager.add("widgetconnector",function(a){a.on("init",function(){a.execCommand("addAutoconverter",!1,d.WidgetAutoConvertFn)})});c.addTinyMcePluginInit(function(a){a.plugins+=",widgetconnector"})});
try{require("confluence-widget-connector/autoconvert-plugin-v4")}catch(b){console.warn("Unable to load widget autoconvert",b)};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.officeconnector:macro-browser-smart-fields', location = 'javascript/office-connector-macro-fields.js' */
(function(d){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewdoc",["doc","docx"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewpdf",["pdf"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewxls",["xls","xlsx"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewppt",["ppt","pptx"]);AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro:function(b){var a=b.params[""]||b.params.name;if(a){var c=a.lastIndexOf(".");0<c&&(a=a.substring(c+1))&&("doc"==a&&"docx"==
a&&(b.name="viewdoc"),"pdf"==a&&(b.name="viewpdf"),"ppt"==a&&"pptx"==a&&(b.name="viewppt"),"xls"==a&&"xlsx"==a&&(b.name="viewxls"))}}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.masterdetail:master-details-macro-browser', location = 'com/atlassian/confluence/extra/masterdetail/js/macro-browser-options.js' */
AJS.toInit(function(a){AJS.MacroBrowser.setMacroJsOverride("detailssummary",{fields:{cqlSelect2CustomOptions:{maximumSelectionSize:"60"}}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.ext.newcode-macro-plugin:code-macro-editor', location = '/scripts/code-macro-languages.js' */
/**
 * Provides custom behaviour in the macro browser for the code macro.
 */
(function($) {

    var CodeMacroConfig = function() {};

    CodeMacroConfig.prototype.fields = {
        "string" : {
            "language" : function(param, options) {

                var paramDiv = $(Confluence.Templates.MacroBrowser.macroParameterSelect());
                var input = $("select", paramDiv);

                // we need to do some trickery when the value is first set, and when the value is subsequently changed,
                // so set this up.
                if (options == null)
                    options = {};
                options.setValue = function(value) {

                    var targetOption = input.find("option[value='" + value + "']");
                    if (targetOption.length == 0) {
                        var option = $("<option/>");
                        option.val(value);
                        option.text(value);
                        input.append(option);
                    }
                };

                bindAsyncDropDown(input);
                return new AJS.MacroBrowser.Field(paramDiv, input, options);
            }
        }
    };

    AJS.MacroBrowser.Macros["code"] = new CodeMacroConfig();

    /**
     * Populates an HTML Select element with the list of configured syntax highlighters.
     * @param dropDown JQuery selector for the HTML select element to be populated.
     */
    function bindAsyncDropDown(dropDown) {
        // Load the languages from Confluence
        getLanguagesAsync(function(languages) {
                    if (!languages.length)
                    {
                        AJS.log("Configured code macro languages result was not in the expected format.");
                        return;
                    }

                    var currentValue = dropDown.val();

                    dropDown.empty();
                    dropDown.append($("<option/>").attr("value", ""));

                    $.each(languages, function(index, lang) {
                        var option = $("<option />");
                        option.val(lang.aliases[0]);
                        option.text(lang.friendlyName);

                        dropDown.append(option);
                    });

                    // restore the currently selected value.
                    dropDown.val(currentValue);
                },
                function(xhr, textStatus, errorThrown) {
                    AJS.log("Failed to retrieve syntax highlighters from Confluence " + textStatus + " - " + errorThrown);
                });
    }

    /**
     * Asynchronously retrieves the current set of syntax highlighters currently installed for the Code macro.
     *
     * @param successHandler Callback to invoke if the retrieval is successful
     * @param errorHandler Callback to invoke if the retrieval fails.
     */
    function getLanguagesAsync(successHandler, errorHandler) {
        AJS.$.ajax({
            async: true,
            url: AJS.contextPath() + "/plugins/newcode/getlanguages.action",
            dataType: "json",
            timeout: 10000, // 10 seconds,
            error: function(xhr, textStatus, errorThrown) {
                if (errorHandler && typeof(errorHandler) == "function") {
                    errorHandler(xhr, textStatus, errorThrown);
                }
            },
            success: function(data) {
                if (successHandler && typeof(successHandler) == "function") {
                    successHandler(data);
                }
            }
        });
    }
})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'fr.spectrumgroupe.confluence.plugins.formatting.macros:hidden-field-parameter', location = 'js/hidden-parameter-field.js' */
(function(b){var a={fields:{string:{user:function(e,c){var d=AJS.MacroBrowser.ParameterFields._hidden(e,{});return d},status:function(e,c){var d=AJS.MacroBrowser.ParameterFields._hidden(e,{});return d},date:function(e,c){var d=AJS.MacroBrowser.ParameterFields._hidden(e,{});return d}}}};AJS.MacroBrowser.setMacroJsOverride("page-status",a)})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'fr.spectrumgroupe.confluence.plugins.formatting.macros:field-parameter-text', location = '/js/sfa/macro-edit.js' */
AJS.MacroBrowser.setMacroJsOverride("sp-notification",{beforeParamsRetrieved:function(c,d,b){if(c.text.length>253){var a=AJS.flag({type:"error",body:"The text must not exceed 255 characters",close:"auto"});return false}else{return c}}});
}catch(e){WRMCB(e)};